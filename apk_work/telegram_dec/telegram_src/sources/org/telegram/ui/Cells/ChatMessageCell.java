package org.telegram.ui.Cells;

import android.animation.Animator;
import android.animation.AnimatorListenerAdapter;
import android.animation.AnimatorSet;
import android.animation.Keyframe;
import android.animation.ObjectAnimator;
import android.animation.PropertyValuesHolder;
import android.animation.ValueAnimator;
import android.app.Activity;
import android.content.Context;
import android.content.res.ColorStateList;
import android.content.res.Resources;
import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.ColorFilter;
import android.graphics.ColorMatrix;
import android.graphics.ColorMatrixColorFilter;
import android.graphics.CornerPathEffect;
import android.graphics.LinearGradient;
import android.graphics.Paint;
import android.graphics.Path;
import android.graphics.PorterDuff;
import android.graphics.PorterDuffColorFilter;
import android.graphics.PorterDuffXfermode;
import android.graphics.Rect;
import android.graphics.RectF;
import android.graphics.Region;
import android.graphics.Shader;
import android.graphics.Typeface;
import android.graphics.drawable.BitmapDrawable;
import android.graphics.drawable.Drawable;
import android.graphics.drawable.GradientDrawable;
import android.os.Build;
import android.os.Bundle;
import android.os.SystemClock;
import android.text.Layout;
import android.text.Spannable;
import android.text.SpannableString;
import android.text.SpannableStringBuilder;
import android.text.Spanned;
import android.text.StaticLayout;
import android.text.TextPaint;
import android.text.TextUtils;
import android.text.style.CharacterStyle;
import android.text.style.ClickableSpan;
import android.text.style.LeadingMarginSpan;
import android.text.style.URLSpan;
import android.util.Pair;
import android.util.Property;
import android.util.SparseArray;
import android.util.StateSet;
import android.view.MotionEvent;
import android.view.View;
import android.view.ViewConfiguration;
import android.view.ViewGroup;
import android.view.ViewParent;
import android.view.ViewStructure;
import android.view.Window;
import android.view.accessibility.AccessibilityEvent;
import android.view.accessibility.AccessibilityManager;
import android.view.accessibility.AccessibilityNodeInfo;
import android.view.accessibility.AccessibilityNodeProvider;
import android.view.animation.OvershootInterpolator;
import android.widget.Toast;
import androidx.core.content.ContextCompat;
import androidx.core.graphics.ColorUtils;
import androidx.core.math.MathUtils;
import com.huawei.hms.location.LocationRequest;
import com.huawei.hms.maps.model.BitmapDescriptorFactory;
import com.huawei.wisesecurity.ucs.credential.nativelib.UcsLib;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Iterator;
import java.util.List;
import java.util.Locale;
import java.util.Stack;
import java.util.concurrent.atomic.AtomicReference;
import org.telegram.messenger.AccountInstance;
import org.telegram.messenger.AndroidUtilities;
import org.telegram.messenger.ApplicationLoader;
import org.telegram.messenger.BotInlineKeyboard;
import org.telegram.messenger.ChatMessageSharedResources;
import org.telegram.messenger.ChatObject;
import org.telegram.messenger.ContactsController;
import org.telegram.messenger.DialogObject;
import org.telegram.messenger.DownloadController;
import org.telegram.messenger.Emoji;
import org.telegram.messenger.FileLoader;
import org.telegram.messenger.FileLog;
import org.telegram.messenger.FlagSecureReason;
import org.telegram.messenger.ImageLoader;
import org.telegram.messenger.ImageLocation;
import org.telegram.messenger.ImageReceiver;
import org.telegram.messenger.LiteMode;
import org.telegram.messenger.LocaleController;
import org.telegram.messenger.MediaController;
import org.telegram.messenger.MediaDataController;
import org.telegram.messenger.MessageObject;
import org.telegram.messenger.MessagesController;
import org.telegram.messenger.NotificationCenter;
import org.telegram.messenger.R;
import org.telegram.messenger.SendMessagesHelper;
import org.telegram.messenger.SharedConfig;
import org.telegram.messenger.UserConfig;
import org.telegram.messenger.UserObject;
import org.telegram.messenger.Utilities;
import org.telegram.messenger.WebFile;
import org.telegram.messenger.browser.Browser;
import org.telegram.messenger.video.OldVideoPlayerRewinder;
import org.telegram.tgnet.ConnectionsManager;
import org.telegram.tgnet.TLObject;
import org.telegram.tgnet.TLRPC;
import org.telegram.tgnet.tl.TL_stories$StoryItem;
import org.telegram.tgnet.tl.TL_stories$TL_storyItemDeleted;
import org.telegram.ui.ActionBar.Theme;
import org.telegram.ui.AvatarSpan;
import org.telegram.ui.Cells.BaseCell;
import org.telegram.ui.Cells.DialogCell;
import org.telegram.ui.Cells.TextSelectionHelper;
import org.telegram.ui.ChatActivity;
import org.telegram.ui.Components.AnimatedEmojiDrawable;
import org.telegram.ui.Components.AnimatedEmojiSpan;
import org.telegram.ui.Components.AnimatedFileDrawable;
import org.telegram.ui.Components.AnimatedFloat;
import org.telegram.ui.Components.AnimatedNumberLayout;
import org.telegram.ui.Components.AnimatedTextView;
import org.telegram.ui.Components.AnimationProperties;
import org.telegram.ui.Components.AudioVisualizerDrawable;
import org.telegram.ui.Components.AvatarDrawable;
import org.telegram.ui.Components.AvatarsDrawable;
import org.telegram.ui.Components.BackgroundGradientDrawable;
import org.telegram.ui.Components.ButtonBounce;
import org.telegram.ui.Components.CheckBoxBase;
import org.telegram.ui.Components.ColoredImageSpan;
import org.telegram.ui.Components.CubicBezierInterpolator;
import org.telegram.ui.Components.EmptyStubSpan;
import org.telegram.ui.Components.FloatSeekBarAccessibilityDelegate;
import org.telegram.ui.Components.ForwardBackground;
import org.telegram.ui.Components.InfiniteProgress;
import org.telegram.ui.Components.LinkPath;
import org.telegram.ui.Components.LinkSpanDrawable;
import org.telegram.ui.Components.LoadingDrawable;
import org.telegram.ui.Components.MessageBackgroundDrawable;
import org.telegram.ui.Components.MotionBackgroundDrawable;
import org.telegram.ui.Components.MsgClockDrawable;
import org.telegram.ui.Components.Point;
import org.telegram.ui.Components.Premium.boosts.BoostCounterSpan;
import org.telegram.ui.Components.Premium.boosts.cells.msg.GiveawayMessageCell;
import org.telegram.ui.Components.Premium.boosts.cells.msg.GiveawayResultsMessageCell;
import org.telegram.ui.Components.QuoteHighlight;
import org.telegram.ui.Components.QuoteSpan;
import org.telegram.ui.Components.RLottieDrawable;
import org.telegram.ui.Components.RadialProgress2;
import org.telegram.ui.Components.Reactions.ReactionsLayoutInBubble;
import org.telegram.ui.Components.RecyclerListView;
import org.telegram.ui.Components.ReplyMessageLine;
import org.telegram.ui.Components.RoundVideoPlayingDrawable;
import org.telegram.ui.Components.SeekBar;
import org.telegram.ui.Components.SeekBarAccessibilityDelegate;
import org.telegram.ui.Components.SeekBarWaveform;
import org.telegram.ui.Components.SizeNotifierFrameLayout;
import org.telegram.ui.Components.SlotsDrawable;
import org.telegram.ui.Components.StaticLayoutEx;
import org.telegram.ui.Components.StickerSetLinkIcon;
import org.telegram.ui.Components.SuggestionOffer;
import org.telegram.ui.Components.Text;
import org.telegram.ui.Components.TextStyleSpan;
import org.telegram.ui.Components.TimerParticles;
import org.telegram.ui.Components.TopicSeparator;
import org.telegram.ui.Components.TranscribeButton;
import org.telegram.ui.Components.TypefaceSpan;
import org.telegram.ui.Components.URLSpanBotCommand;
import org.telegram.ui.Components.URLSpanBrowser;
import org.telegram.ui.Components.URLSpanMono;
import org.telegram.ui.Components.URLSpanNoUnderline;
import org.telegram.ui.Components.VideoForwardDrawable;
import org.telegram.ui.Components.VideoPlayer;
import org.telegram.ui.Components.spoilers.SpoilerEffect;
import org.telegram.ui.Components.spoilers.SpoilerEffect2;
import org.telegram.ui.GradientClip;
import org.telegram.ui.PhotoViewer;
import org.telegram.ui.PinchToZoomHelper;
import org.telegram.ui.SecretMediaViewer;
import org.telegram.ui.Stars.StarsIntroActivity;
import org.telegram.ui.Stories.StoriesUtilities;
import org.telegram.ui.Stories.StoryViewer;
import org.telegram.ui.Stories.recorder.CaptionContainerView;
import org.telegram.ui.Stories.recorder.DominantColors;

/* loaded from: /Users/liqi/android-frida-traces/apk_test/dex_files/classes4.dex */
public class ChatMessageCell extends BaseCell implements SeekBar.SeekBarDelegate, ImageReceiver.ImageReceiverDelegate, DownloadController.FileDownloadProgressListener, TextSelectionHelper.SelectableView, NotificationCenter.NotificationCenterDelegate {
    private static float[] radii = new float[8];
    private final boolean ALPHA_PROPERTY_WORKAROUND;
    public Property ANIMATION_OFFSET_X;
    private int TAG;
    CharSequence accessibilityText;
    private boolean accessibilityTextContentUnread;
    private long accessibilityTextFileSize;
    private boolean accessibilityTextUnread;
    private SparseArray accessibilityVirtualViewBounds;
    private float actionAlpha;
    private int[] adaptiveEmojiColor;
    private ColorFilter[] adaptiveEmojiColorFilter;
    private int addedCaptionHeight;
    private boolean addedForTest;
    private int additionalTimeOffsetY;
    private StaticLayout adminLayout;
    private boolean allowAssistant;
    private float alphaInternal;
    private int animateFromStatusDrawableParams;
    private boolean animatePollAnswer;
    private boolean animatePollAnswerAlpha;
    private boolean animatePollAvatars;
    private int animateToStatusDrawableParams;
    public AnimatedEmojiSpan.EmojiGroupedSpans animatedEmojiDescriptionStack;
    public AnimatedEmojiSpan.EmojiGroupedSpans animatedEmojiPollQuestion;
    public AnimatedEmojiSpan.EmojiGroupedSpans animatedEmojiReplyStack;
    public AnimatedEmojiSpan.EmojiGroupedSpans animatedEmojiStack;
    private AnimatedTextView.AnimatedTextDrawable animatedInfoLayout;
    private int animatingDrawVideoImageButton;
    private float animatingDrawVideoImageButtonProgress;
    private float animatingLoadingProgressProgress;
    private int animatingNoSound;
    private boolean animatingNoSoundPlaying;
    private float animatingNoSoundProgress;
    private float animationOffsetX;
    private boolean animationRunning;
    private boolean attachedToWindow;
    private StaticLayout authorLayout;
    private int authorLayoutLeft;
    private int authorLayoutWidth;
    private boolean autoPlayingMedia;
    private int availableTimeWidth;
    protected AvatarDrawable avatarDrawable;
    private ImageReceiver avatarImage;
    private boolean avatarPressed;
    private Theme.MessageDrawable.PathDrawParams backgroundCacheParams;
    private MessageBackgroundDrawable backgroundDrawable;
    private int backgroundDrawableBottom;
    private int backgroundDrawableLeft;
    private int backgroundDrawableRight;
    private int backgroundDrawableTop;
    public int backgroundHeight;
    public int backgroundWidth;
    private ImageReceiver blurredPhotoImage;
    public int blurredViewBottomOffset;
    public int blurredViewTopOffset;
    private RectF boostCounterBounds;
    private Drawable boostCounterLayoutSelector;
    private boolean boostCounterPressed;
    private int boostCounterSelectorColor;
    private BoostCounterSpan boostCounterSpan;
    private Path botButtonPath;
    private float[] botButtonRadii;
    private ArrayList botButtons;
    private HashMap botButtonsByData;
    private HashMap botButtonsByPosition;
    private String botButtonsLayout;
    private boolean bottomNearToSet;
    private int buttonPressed;
    private int buttonState;
    private int buttonX;
    private int buttonY;
    private final boolean canDrawBackgroundInParent;
    private boolean canStreamVideo;
    public boolean captionAbove;
    private int captionFullWidth;
    private int captionHeight;
    public MessageObject.TextLayoutBlocks captionLayout;
    private int captionOffsetX;
    private int captionWidth;
    private float captionX;
    public float captionY;
    public ChannelRecommendationsCell channelRecommendationsCell;
    private CheckBoxBase checkBox;
    private boolean checkBoxAnimationInProgress;
    private float checkBoxAnimationProgress;
    public int checkBoxTranslation;
    private boolean checkBoxVisible;
    private boolean checkOnlyButtonPressed;
    public int childPosition;
    private GradientClip clip;
    private Paint clipPaint;
    public boolean clipToGroupBounds;
    private ButtonBounce closeSponsoredBounce;
    private RectF closeSponsoredBounds;
    private String closeTimeText;
    private int closeTimeWidth;
    private int commentArrowX;
    private AvatarDrawable[] commentAvatarDrawables;
    private ImageReceiver[] commentAvatarImages;
    private boolean[] commentAvatarImagesVisible;
    private boolean commentButtonPressed;
    private Rect commentButtonRect;
    private boolean commentDrawUnread;
    private StaticLayout commentLayout;
    private LoadingDrawable commentLoading;
    private AnimatedNumberLayout commentNumberLayout;
    private int commentNumberWidth;
    private InfiniteProgress commentProgress;
    private float commentProgressAlpha;
    private long commentProgressLastUpadteTime;
    private int commentUnreadX;
    private int commentWidth;
    private int commentX;
    public MessageObject.TextLayoutBlocks computedCaptionLayout;
    public int computedGroupCaptionY;
    private AvatarDrawable contactAvatarDrawable;
    public ButtonBounce contactBounce;
    private ArrayList contactButtons;
    public ReplyMessageLine contactLine;
    private boolean contactPressed;
    private RectF contactRect;
    private float controlsAlpha;
    public final int currentAccount;
    public Theme.MessageDrawable currentBackgroundDrawable;
    private Theme.MessageDrawable currentBackgroundSelectedDrawable;
    private CharSequence currentCaption;
    private TLRPC.Chat currentChat;
    private int currentFocusedVirtualView;
    private TLRPC.Chat currentForwardChannel;
    private String currentForwardName;
    private String currentForwardNameString;
    private TLRPC.User currentForwardUser;
    private int currentMapProvider;
    private MessageObject currentMessageObject;
    private MessageObject.GroupedMessages currentMessagesGroup;
    private long currentNameBotVerificationId;
    public AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable currentNameEmojiStatusDrawable;
    private Object currentNameStatus;
    public AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable currentNameStatusDrawable;
    private String currentNameString;
    private TLRPC.FileLocation currentPhoto;
    private String currentPhotoFilter;
    private String currentPhotoFilterThumb;
    private ImageLocation currentPhotoLocation;
    private TLRPC.PhotoSize currentPhotoObject;
    private TLRPC.PhotoSize currentPhotoObjectThumb;
    private BitmapDrawable currentPhotoObjectThumbStripped;
    private ImageLocation currentPhotoThumbLocation;
    private MessageObject.GroupedMessagePosition currentPosition;
    private String currentRepliesString;
    private TLRPC.PhotoSize currentReplyPhoto;
    private float currentSelectedBackgroundAlpha;
    private CharSequence currentTimeString;
    private String currentUnlockString;
    private String currentUrl;
    private TLRPC.User currentUser;
    private TLRPC.User currentViaBotUser;
    private String currentViewsString;
    private WebFile currentWebFile;
    private ChatMessageCellDelegate delegate;
    private RectF deleteProgressRect;
    private StaticLayout descriptionLayout;
    private int descriptionLayoutLeft;
    private int descriptionLayoutWidth;
    private int descriptionX;
    private int descriptionY;
    private Runnable diceFinishCallback;
    private boolean disallowLongPress;
    public boolean doNotDraw;
    public int doNotDrawTaskId;
    private StaticLayout docTitleLayout;
    private int docTitleOffsetX;
    private int docTitleWidth;
    private TLRPC.Document documentAttach;
    private int documentAttachType;
    private boolean drawBackground;
    private boolean drawCommentButton;
    private boolean drawCommentNumber;
    private boolean drawContact;
    private boolean drawContactAdd;
    private boolean drawContactSendMessage;
    private boolean drawContactView;
    public boolean drawForBlur;
    private boolean drawForwardedName;
    public boolean drawFromPinchToZoom;
    private boolean drawImageButton;
    private boolean drawInstantView;
    public int drawInstantViewType;
    private boolean drawMediaCheckBox;
    private boolean drawName;
    private boolean drawNameAvatar;
    private boolean drawNameLayout;
    public boolean drawPhotoImage;
    public boolean drawPinnedBottom;
    public boolean drawPinnedTop;
    private boolean drawRadialCheckBackground;
    private boolean drawSelectionBackground;
    private int drawSideButton;
    private int drawSideButton2;
    private boolean drawTime;
    private float drawTimeX;
    private float drawTimeY;
    private boolean drawTopic;
    private boolean drawVideoImageButton;
    private boolean drawVideoSize;
    public boolean drawingToBitmap;
    private int drawnContactButtonsFlag;
    private Paint drillHolePaint;
    private Path drillHolePath;
    private StaticLayout durationLayout;
    private int durationWidth;
    private boolean edited;
    private AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable effectDrawable;
    private ButtonBounce effectDrawableBounce;
    private long effectId;
    private int effectMessageId;
    boolean enterTransitionInProgress;
    public ExpiredStoryView expiredStoryView;
    private Drawable factCheckArrow;
    private int factCheckArrowColor;
    private ButtonBounce factCheckBounce;
    private int factCheckHeight;
    private boolean factCheckLarge;
    public ReplyMessageLine factCheckLine;
    private LinkSpanDrawable.LinkCollector factCheckLinks;
    private boolean factCheckPressed;
    private StaticLayout factCheckText2Layout;
    private int factCheckText2LayoutLeft;
    private StaticLayout factCheckTextLayout;
    private int factCheckTextLayoutHeight;
    private boolean factCheckTextLayoutLastLineEnd;
    private int factCheckTextLayoutLeft;
    private Text factCheckTitle;
    private Text factCheckWhat;
    private ButtonBounce factCheckWhatBounce;
    private boolean factCheckWhatPressed;
    private int factCheckWidth;
    private int factCheckY;
    private ColorMatrixColorFilter fancyBlurFilter;
    private boolean firstCircleLength;
    public boolean firstInChat;
    private boolean firstInChatToSet;
    private int firstVisibleBlockNum;
    private boolean fitPhotoImage;
    private FlagSecureReason flagSecure;
    private boolean flipImage;
    private boolean forceNotDrawTime;
    private boolean forcedLayout;
    private Drawable foreverDrawable;
    private int foreverDrawableColor;
    private AvatarSpan forwardAvatar;
    private ForwardBackground forwardBg;
    private boolean forwardBotPressed;
    private int forwardHeight;
    private int forwardNameCenterX;
    private final float[] forwardNameOffsetX;
    private boolean forwardNamePressed;
    private float forwardNameX;
    private int forwardNameY;
    private final StaticLayout[] forwardedNameLayout;
    private int forwardedNameWidth;
    private boolean frozen;
    private boolean fullyDraw;
    private boolean gamePreviewPressed;
    public final GiveawayMessageCell giveawayMessageCell;
    public final GiveawayResultsMessageCell giveawayResultsMessageCell;
    private Drawable gradientDrawable;
    private LinearGradient gradientShader;
    private Drawable groupCallDrawable;
    private int groupCallDrawableColor;
    private AvatarsDrawable groupCallParticipantsAvatars;
    private Text groupCallParticipantsText;
    public GroupMedia groupMedia;
    private boolean groupPhotoInvisible;
    private MessageObject.GroupedMessages groupedMessagesToSet;
    private boolean hadLongPress;
    public boolean hasDiscussion;
    private boolean hasEmbed;
    private boolean hasFactCheck;
    private boolean hasGamePreview;
    private boolean hasInvoicePreview;
    private boolean hasInvoicePrice;
    private boolean hasLinkPreview;
    private int hasMiniProgress;
    private boolean hasNewLineForTime;
    private boolean hasOldCaptionPreview;
    private boolean hasPsaHint;
    public boolean hasReplyQuote;
    private boolean hideSideButtonByQuickShare;
    private int highlightCaptionToSetEnd;
    private int highlightCaptionToSetStart;
    private LinkPath highlightPath;
    private long highlightPathStart;
    private int highlightProgress;
    private boolean highlightedQuote;
    private float hintButtonProgress;
    private boolean hintButtonVisible;
    private int imageBackgroundColor;
    private int imageBackgroundGradientColor1;
    private int imageBackgroundGradientColor2;
    private int imageBackgroundGradientColor3;
    private int imageBackgroundGradientRotation;
    private float imageBackgroundIntensity;
    private int imageBackgroundSideColor;
    private int imageBackgroundSideWidth;
    private boolean imageDrawn;
    private boolean imagePressed;
    boolean imageReceiversAttachState;
    boolean imageReceiversVisibleState;
    private boolean inLayout;
    private boolean inQuickShareMode;
    private StaticLayout infoLayout;
    private int infoWidth;
    private ButtonBounce instantButtonBounce;
    private LoadingDrawable instantButtonLoading;
    private boolean instantButtonPressed;
    private RectF instantButtonRect;
    public Drawable instantDrawable;
    public int instantDrawableColor;
    private Paint instantLinkArrowPaint;
    private Path instantLinkArrowPath;
    private boolean instantPressed;
    private int instantTextLeftX;
    private boolean instantTextNewLine;
    private int instantTextX;
    public String instantViewButtonText;
    private StaticLayout instantViewLayout;
    private float instantViewLayoutLeft;
    private float instantViewLayoutWidth;
    private int instantWidth;
    private Runnable invalidateListener;
    private Runnable invalidateRunnable;
    private boolean invalidateSpoilersParent;
    private boolean invalidatesParent;
    public boolean isAllChats;
    public boolean isAvatarVisible;
    public boolean isBlurred;
    public boolean isBot;
    public boolean isChat;
    private boolean isCheckPressed;
    public boolean isForum;
    public boolean isForumGeneral;
    private boolean isHighlighted;
    private boolean isHighlightedAnimated;
    private boolean isMedia;
    public boolean isMegagroup;
    public boolean isMonoForum;
    public boolean isPinned;
    public boolean isPinnedChat;
    private boolean isPlayingRound;
    private boolean isPressed;
    public boolean isRepliesChat;
    public boolean isReplyQuote;
    public boolean isReplyTask;
    public boolean isReportChat;
    private boolean isRoundVideo;
    public boolean isSavedChat;
    public boolean isSavedPreviewChat;
    public boolean isSideMenuEnabled;
    public boolean isSideMenued;
    private boolean isSmallImage;
    private boolean isSpoilerRevealing;
    public boolean isThreadChat;
    private boolean isThreadPost;
    private boolean isTitleLabelPressed;
    private boolean isUpdating;
    private int keyboardHeight;
    private long lastAnimationTime;
    private long lastCheckBoxAnimationTime;
    private long lastControlsAlphaChangeTime;
    private int lastDeleteDate;
    private float lastDrawingAudioProgress;
    private int lastHeight;
    private long lastHighlightProgressTime;
    private long lastLoadingSizeTotal;
    private long lastNamesAnimationTime;
    private TLRPC.Poll lastPoll;
    private long lastPollCloseTime;
    private ArrayList lastPollResults;
    private int lastPollResultsVoters;
    private String lastPostAuthor;
    private TLRPC.TL_messageReactions lastReactions;
    private int lastRepliesCount;
    private TLRPC.Message lastReplyMessage;
    private long lastSeekUpdateTime;
    private int lastSendState;
    int lastSize;
    private double lastTime;
    private float lastTouchX;
    private float lastTouchY;
    private boolean lastTranslated;
    private int lastViewsCount;
    private int lastVisibleBlockNum;
    private WebFile lastWebFile;
    private int lastWidth;
    public int layoutHeight;
    public int layoutWidth;
    public int linkBlockNum;
    public ReplyMessageLine linkLine;
    public boolean linkPreviewAbove;
    private ButtonBounce linkPreviewBounce;
    public int linkPreviewHeight;
    private boolean linkPreviewPressed;
    private Drawable linkPreviewSelector;
    public int linkPreviewSelectorColor;
    private int linkPreviewY;
    private int linkSelectionBlockNum;
    public long linkedChatId;
    public LinkSpanDrawable.LinkCollector links;
    private StaticLayout loadingProgressLayout;
    private long loadingProgressLayoutHash;
    private boolean locationExpired;
    private ImageReceiver locationImageReceiver;
    private Drawable locationLoadingThumb;
    public boolean makeVisibleAfterChange;
    private boolean mediaBackground;
    private CheckBoxBase mediaCheckBox;
    private int mediaOffsetY;
    private SpoilerEffect mediaSpoilerEffect;
    private SpoilerEffect2 mediaSpoilerEffect2;
    private Integer mediaSpoilerEffect2Index;
    private Path mediaSpoilerPath;
    private float[] mediaSpoilerRadii;
    private float mediaSpoilerRevealMaxRadius;
    private float mediaSpoilerRevealProgress;
    private float mediaSpoilerRevealX;
    private float mediaSpoilerRevealY;
    private boolean mediaWasInvisible;
    private MessageObject messageObjectToSet;
    private int miniButtonPressed;
    private int miniButtonState;
    private MotionBackgroundDrawable motionBackgroundDrawable;
    private StaticLayout nameLayout;
    private boolean nameLayoutPressed;
    private Drawable nameLayoutSelector;
    private int nameLayoutSelectorColor;
    private int nameLayoutWidth;
    private float nameOffsetX;
    private boolean nameStatusPressed;
    private Drawable nameStatusSelector;
    private int nameStatusSelectorColor;
    private String nameStatusSlug;
    private int nameWidth;
    private float nameX;
    private float nameY;
    public int namesOffset;
    private boolean needNewVisiblePart;
    public boolean needReplyImage;
    private int noSoundCenterX;
    private final ArrayList oldPollButtons;
    private Paint onceClearPaint;
    private RLottieDrawable onceFire;
    private CaptionContainerView.PeriodDrawable oncePeriod;
    private Paint onceRadialCutPaint;
    private Paint onceRadialPaint;
    private Paint onceRadialStrokePaint;
    private boolean otherPressed;
    private int otherX;
    private int otherY;
    private int overideShouldDrawTimeOnMedia;
    private Runnable overrideInvalidate;
    private AudioVisualizerDrawable overridenAudioVisualizer;
    private long overridenDuration;
    public int parentBoundsBottom;
    public float parentBoundsTop;
    public int parentHeight;
    public float parentViewTopOffset;
    public int parentWidth;
    private StaticLayout performerLayout;
    private int performerX;
    private ImageReceiver photoImage;
    private Path photoImageClipPath;
    private float[] photoImageClipPathRadii;
    private boolean photoImageOutOfBounds;
    private boolean photoNotSet;
    private TLObject photoParentObject;
    private StaticLayout photosCountLayout;
    private int photosCountWidth;
    public boolean pinnedBottom;
    public boolean pinnedTop;
    private float pollAnimationProgress;
    private float pollAnimationProgressTime;
    private AvatarDrawable[] pollAvatarDrawables;
    private ImageReceiver[] pollAvatarImages;
    private boolean[] pollAvatarImagesVisible;
    private final ArrayList pollButtons;
    private CheckBoxBase[] pollCheckBox;
    private Paint pollCheckPaint;
    private Path pollCheckPath;
    private boolean pollClosed;
    private Paint pollCutAvatarPaint;
    private boolean pollHintPressed;
    private int pollHintX;
    private int pollHintY;
    private boolean pollInstantViewTouchesBottom;
    private boolean pollUnvoteInProgress;
    private boolean pollVoteInProgress;
    private int pollVoteInProgressNum;
    private boolean pollVoted;
    private int pressedBlock;
    private int pressedBotButton;
    private MessageObject.TextLayoutBlock pressedCopyCode;
    private boolean pressedEffect;
    private AnimatedEmojiSpan pressedEmoji;
    private LinkSpanDrawable pressedFactCheckLink;
    private LinkSpanDrawable pressedLink;
    private int pressedLinkType;
    private int pressedSideButton;
    private final int[] pressedState;
    private int pressedVoteButton;
    public MessageObject.TextLayoutBlocks prevCaptionLayout;
    private CharacterStyle progressLoadingLink;
    private LoadingDrawable progressLoadingLinkCurrentDrawable;
    private ArrayList progressLoadingLinkDrawables;
    private float psaButtonProgress;
    private boolean psaButtonVisible;
    private int psaHelpX;
    private int psaHelpY;
    private boolean psaHintPressed;
    public Drawable quoteArrow;
    public int quoteArrowColor;
    public Drawable[] quoteDrawable;
    public int[] quoteDrawableColor;
    public QuoteHighlight quoteHighlight;
    public ReplyMessageLine quoteLine;
    private RadialProgress2 radialProgress;
    protected float radialProgressAlpha;
    public final ReactionsLayoutInBubble reactionsLayoutInBubble;
    private RectF rect;
    private Path rectPath;
    private StaticLayout repliesLayout;
    private int repliesTextWidth;
    public ButtonBounce replyBounce;
    public float replyBounceX;
    public float replyBounceY;
    public float replyHeight;
    public ImageReceiver replyImageReceiver;
    public ReplyMessageLine replyLine;
    public StaticLayout replyNameLayout;
    private int replyNameOffset;
    private int replyNameWidth;
    private boolean replyPanelIsForward;
    private boolean replyPressed;
    private AnimatedFloat replyPressedFloat;
    public Drawable replyQuoteDrawable;
    public int replyQuoteDrawableColor;
    private Path replyRoundRectPath;
    public Drawable replySelector;
    private boolean replySelectorCanBePressed;
    public int replySelectorColor;
    private boolean replySelectorPressed;
    public float replySelectorRadLeft;
    public float replySelectorRadRight;
    public RectF replySelectorRect;
    public List replySpoilers;
    private final Stack replySpoilersPool;
    public int replyStartX;
    public int replyStartY;
    public CheckBoxBase replyTaskCheckbox;
    private int replyTextHeight;
    public StaticLayout replyTextLayout;
    public int replyTextOffset;
    public boolean replyTextRTL;
    private int replyTextWidth;
    private float replyTouchX;
    private float replyTouchY;
    private Theme.ResourcesProvider resourcesProvider;
    private float roundPlayingDrawableProgress;
    private float roundProgressAlpha;
    float roundSeekbarOutAlpha;
    float roundSeekbarOutProgress;
    int roundSeekbarTouched;
    private float roundToPauseProgress;
    private float roundToPauseProgress2;
    private AnimatedFloat roundVideoPlayPipFloat;
    private RoundVideoPlayingDrawable roundVideoPlayingDrawable;
    private final Path sPath;
    private boolean scheduledInvalidate;
    private Rect scrollRect;
    private SeekBar seekBar;
    private SeekBarAccessibilityDelegate seekBarAccessibilityDelegate;
    private int seekBarTranslateX;
    private SeekBarWaveform seekBarWaveform;
    private int seekBarWaveformTranslateX;
    private int seekBarX;
    private int seekBarY;
    float seekbarRoundX;
    float seekbarRoundY;
    private float selectedBackgroundProgress;
    private Paint selectionOverlayPaint;
    private final Drawable[] selectorDrawable;
    private int selectorDrawableColor;
    private int[] selectorDrawableMaskType;
    private final MaskDrawable[] selectorMaskDrawable;
    private Text sensitiveText;
    private Text sensitiveTextShort;
    private AnimatorSet shakeAnimation;
    private ChatMessageSharedResources sharedResources;
    public boolean shouldCheckVisibleOnScreen;
    public boolean showTopicSeparator;
    private Path sideButtonPath1;
    private Path sideButtonPath2;
    private float[] sideButtonPathCorners1;
    private float[] sideButtonPathCorners2;
    private boolean sideButtonPressed;
    private boolean sideButtonVisible;
    private ImageReceiver sideImage;
    public float sideMenuAlpha;
    public int sideMenuWidth;
    private int sideNameWidth;
    private float sideStartX;
    private float sideStartY;
    public int signWidth;
    private StaticLayout siteNameLayout;
    private float siteNameLayoutWidth;
    private float siteNameLeft;
    private int siteNameWidth;
    private boolean skipFrameUpdate;
    private float slidingOffsetX;
    private StaticLayout songLayout;
    private int songX;
    private SpoilerEffect spoilerPressed;
    private AtomicReference spoilersPatchedReplyTextLayout;
    private long starsPrice;
    private Text starsPriceText;
    private LinkPath starsPriceTextPath;
    private CornerPathEffect starsPriceTextPathEffect;
    public int starsPriceTopPadding;
    private boolean statusDrawableAnimationInProgress;
    private ValueAnimator statusDrawableAnimator;
    private float statusDrawableProgress;
    private StickerSetLinkIcon stickerSetIcons;
    private int substractBackgroundHeight;
    public SuggestionOffer suggestionOffer;
    private int suggestionOfferTopPadding;
    public int textX;
    public int textY;
    private float timeAlpha;
    private int timeAudioX;
    public StaticLayout timeLayout;
    private boolean timePressed;
    private int timeTextWidth;
    private boolean timeWasInvisible;
    public int timeWidth;
    private int timeWidthAudio;
    public int timeX;
    private TimerParticles timerParticles;
    private AnimatedFloat timerParticlesAlpha;
    private float timerTransitionProgress;
    private ButtonBounce titleLabelBounce;
    private StaticLayout titleLabelLayout;
    private float titleLabelLayoutHeight;
    private float titleLabelLayoutWidth;
    private float titleLabelX;
    private float titleLabelY;
    private StaticLayout titleLayout;
    private int titleLayoutLeft;
    private int titleLayoutWidth;
    private int titleX;
    private float toSeekBarProgress;
    private Runnable todoLongPressRunnable;
    private boolean topNearToSet;
    public TopicSeparator topicSeparator;
    public int topicSeparatorTopPadding;
    private long totalChangeTime;
    private int totalCommentWidth;
    public int totalHeight;
    private int totalVisibleBlocksCount;
    public TranscribeButton transcribeButton;
    private float transcribeX;
    private float transcribeY;
    public final TransitionParams transitionParams;
    public float transitionYOffsetForDrawables;
    private LoadingDrawable translationLoadingDrawable;
    private ArrayList translationLoadingDrawableText;
    private AnimatedFloat translationLoadingFloat;
    private LinkPath translationLoadingPath;
    private float unlockAlpha;
    private StaticLayout unlockLayout;
    private SpoilerEffect unlockSpoilerEffect;
    private Path unlockSpoilerPath;
    private float[] unlockSpoilerRadii;
    private int unlockTextWidth;
    private float unlockX;
    private float unlockY;
    private int unmovedTextX;
    private ArrayList urlPathCache;
    private ArrayList urlPathSelection;
    private boolean useSeekBarWaveform;
    private boolean useTranscribeButton;
    private int viaNameWidth;
    private boolean viaOnly;
    private TypefaceSpan viaSpan1;
    private TypefaceSpan viaSpan2;
    private int viaWidth;
    private boolean vibrateOnPollVote;
    private int videoButtonPressed;
    private int videoButtonX;
    private int videoButtonY;
    VideoForwardDrawable videoForwardDrawable;
    private StaticLayout videoInfoLayout;
    OldVideoPlayerRewinder videoPlayerRewinder;
    private RadialProgress2 videoRadialProgress;
    public float viewTop;
    private StaticLayout viewsLayout;
    private int viewsTextWidth;
    public int visibleHeight;
    private boolean visibleOnScreen;
    public int visibleParent;
    public float visibleParentOffset;
    public float visibleTop;
    private float voteCurrentCircleLength;
    private float voteCurrentProgressTime;
    private long voteLastUpdateTime;
    private float voteRadOffset;
    private boolean voteRisingCircleLength;
    private boolean wasAllChats;
    private boolean wasLayout;
    private boolean wasPinned;
    private boolean wasSending;
    private boolean wasTranscriptionOpen;
    private int widthBeforeNewTimeLine;
    private int widthForButtons;
    private boolean willRemoved;
    private boolean wouldBeInPip;

    /* JADX INFO: Access modifiers changed from: private */
    class BotButton {
        private int angle;
        private TLRPC.KeyboardButton button;
        private BotInlineKeyboard.ButtonCustom buttonCustom;
        private int height;
        private Drawable iconDrawable;
        private boolean isInviteButton;
        private boolean isLocked;
        private boolean isSeparator;
        private long lastUpdateTime;
        private LoadingDrawable loadingDrawable;
        private int positionFlags;
        private ValueAnimator pressAnimator;
        private float pressT;
        private boolean pressed;
        private float progressAlpha;
        private Drawable selectorDrawable;
        private Text title;
        private float width;
        private float x;
        private int y;

        private BotButton() {
        }

        static /* synthetic */ TLRPC.KeyboardButton access$1100(BotButton botButton) {
            return botButton.button;
        }

        static /* synthetic */ TLRPC.KeyboardButton access$1102(BotButton botButton, TLRPC.KeyboardButton keyboardButton) {
            botButton.button = keyboardButton;
            return keyboardButton;
        }

        static /* synthetic */ int access$1902(BotButton botButton, int i) {
            botButton.y = i;
            return i;
        }

        static /* synthetic */ float access$2000(BotButton botButton) {
            return botButton.x;
        }

        static /* synthetic */ float access$2002(BotButton botButton, float f) {
            botButton.x = f;
            return f;
        }

        static /* synthetic */ float access$2100(BotButton botButton) {
            return botButton.width;
        }

        static /* synthetic */ float access$2102(BotButton botButton, float f) {
            botButton.width = f;
            return f;
        }

        static /* synthetic */ int access$2202(BotButton botButton, int i) {
            botButton.height = i;
            return i;
        }

        static /* synthetic */ boolean access$2402(BotButton botButton, boolean z) {
            botButton.isLocked = z;
            return z;
        }

        static /* synthetic */ BotInlineKeyboard.ButtonCustom access$2600(BotButton botButton) {
            return botButton.buttonCustom;
        }

        static /* synthetic */ BotInlineKeyboard.ButtonCustom access$2602(BotButton botButton, BotInlineKeyboard.ButtonCustom buttonCustom) {
            botButton.buttonCustom = buttonCustom;
            return buttonCustom;
        }

        static /* synthetic */ Drawable access$4200(BotButton botButton) {
            return botButton.iconDrawable;
        }

        static /* synthetic */ Drawable access$4202(BotButton botButton, Drawable drawable) {
            botButton.iconDrawable = drawable;
            return drawable;
        }

        static /* synthetic */ float access$4300(BotButton botButton) {
            return botButton.progressAlpha;
        }

        static /* synthetic */ float access$4302(BotButton botButton, float f) {
            botButton.progressAlpha = f;
            return f;
        }

        static /* synthetic */ int access$4400(BotButton botButton) {
            return botButton.angle;
        }

        static /* synthetic */ int access$4402(BotButton botButton, int i) {
            botButton.angle = i;
            return i;
        }

        static /* synthetic */ long access$4500(BotButton botButton) {
            return botButton.lastUpdateTime;
        }

        static /* synthetic */ long access$4502(BotButton botButton, long j) {
            botButton.lastUpdateTime = j;
            return j;
        }

        static /* synthetic */ int access$4676(BotButton botButton, int i) {
            int i2 = i | botButton.positionFlags;
            botButton.positionFlags = i2;
            return i2;
        }

        static /* synthetic */ Text access$4700(BotButton botButton) {
            return botButton.title;
        }

        static /* synthetic */ Text access$4702(BotButton botButton, Text text) {
            botButton.title = text;
            return text;
        }

        static /* synthetic */ boolean access$4802(BotButton botButton, boolean z) {
            botButton.isInviteButton = z;
            return z;
        }

        static /* synthetic */ boolean access$4902(BotButton botButton, boolean z) {
            botButton.isSeparator = z;
            return z;
        }

        /* JADX INFO: Access modifiers changed from: private */
        public float getPressScale() {
            if (this.pressed) {
                float f = this.pressT;
                if (f != 1.0f) {
                    float fMin = f + (Math.min(40.0f, 1000.0f / AndroidUtilities.screenRefreshRate) / 100.0f);
                    this.pressT = fMin;
                    this.pressT = Utilities.clamp(fMin, 1.0f, BitmapDescriptorFactory.HUE_RED);
                    ChatMessageCell.this.invalidateOutbounds();
                }
            }
            return ((1.0f - this.pressT) * 0.04f) + 0.96f;
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$setPressed$0(ValueAnimator valueAnimator) {
            this.pressT = ((Float) valueAnimator.getAnimatedValue()).floatValue();
            ChatMessageCell.this.invalidateOutbounds();
        }

        /* JADX INFO: Access modifiers changed from: private */
        public void setPressed(boolean z) {
            ValueAnimator valueAnimator;
            if (this.pressed != z) {
                this.pressed = z;
                ChatMessageCell.this.invalidateOutbounds();
                if (z && (valueAnimator = this.pressAnimator) != null) {
                    valueAnimator.removeAllListeners();
                    this.pressAnimator.cancel();
                }
                if (z) {
                    return;
                }
                float f = this.pressT;
                if (f != BitmapDescriptorFactory.HUE_RED) {
                    ValueAnimator valueAnimatorOfFloat = ValueAnimator.ofFloat(f, BitmapDescriptorFactory.HUE_RED);
                    this.pressAnimator = valueAnimatorOfFloat;
                    valueAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.Cells.ChatMessageCell$BotButton$$ExternalSyntheticLambda0
                        @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                        public final void onAnimationUpdate(ValueAnimator valueAnimator2) {
                            this.f$0.lambda$setPressed$0(valueAnimator2);
                        }
                    });
                    this.pressAnimator.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.Cells.ChatMessageCell.BotButton.1
                        @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                        public void onAnimationEnd(Animator animator) {
                            super.onAnimationEnd(animator);
                            BotButton.this.pressAnimator = null;
                        }
                    });
                    this.pressAnimator.setInterpolator(new OvershootInterpolator(2.0f));
                    this.pressAnimator.setDuration(350L);
                    this.pressAnimator.start();
                }
            }
        }

        public boolean hasPositionFlag(int i) {
            return (this.positionFlags & i) == i;
        }
    }

    public interface ChatMessageCellDelegate {

        /* renamed from: org.telegram.ui.Cells.ChatMessageCell$ChatMessageCellDelegate$-CC, reason: invalid class name */
        public abstract /* synthetic */ class CC {
            public static boolean $default$canDrawOutboundsContent(ChatMessageCellDelegate chatMessageCellDelegate) {
                return true;
            }

            public static boolean $default$canPerformActions(ChatMessageCellDelegate chatMessageCellDelegate) {
                return false;
            }

            public static void $default$didLongPress(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, float f, float f2) {
            }

            public static void $default$didLongPressBotButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC.KeyboardButton keyboardButton) {
            }

            public static boolean $default$didLongPressChannelAvatar(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC.Chat chat, int i, float f, float f2) {
                return false;
            }

            public static void $default$didLongPressCustomBotButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, BotInlineKeyboard.ButtonCustom buttonCustom) {
            }

            public static boolean $default$didLongPressToDoButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC.TodoItem todoItem) {
                return false;
            }

            public static boolean $default$didLongPressUserAvatar(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC.User user, float f, float f2) {
                return false;
            }

            public static void $default$didPressAboutRevenueSharingAds(ChatMessageCellDelegate chatMessageCellDelegate) {
            }

            public static boolean $default$didPressAnimatedEmoji(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, AnimatedEmojiSpan animatedEmojiSpan) {
                return false;
            }

            public static void $default$didPressBoostCounter(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressBotButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC.KeyboardButton keyboardButton) {
            }

            public static void $default$didPressCancelSendButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressChannelAvatar(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC.Chat chat, int i, float f, float f2, boolean z) {
            }

            public static void $default$didPressChannelRecommendation(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLObject tLObject, boolean z) {
            }

            public static void $default$didPressChannelRecommendationsClose(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressCodeCopy(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, MessageObject.TextLayoutBlock textLayoutBlock) {
            }

            public static void $default$didPressCommentButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressCustomBotButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, BotInlineKeyboard.ButtonCustom buttonCustom) {
            }

            public static void $default$didPressEffect(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressExtendedMediaPreview(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC.KeyboardButton keyboardButton) {
            }

            public static void $default$didPressFactCheck(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressFactCheckWhat(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, int i, int i2) {
            }

            public static void $default$didPressGiveawayChatButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, int i) {
            }

            public static void $default$didPressGroupImage(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, ImageReceiver imageReceiver, TLRPC.MessageExtendedMedia messageExtendedMedia, float f, float f2) {
            }

            public static void $default$didPressHiddenForward(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressHint(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, int i) {
            }

            public static void $default$didPressImage(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, float f, float f2, boolean z) {
            }

            public static void $default$didPressInstantButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, int i) {
            }

            public static void $default$didPressMoreChannelRecommendations(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressOther(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, float f, float f2) {
            }

            public static void $default$didPressReaction(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC.ReactionCount reactionCount, boolean z, float f, float f2) {
            }

            public static void $default$didPressReplyMessage(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, int i, float f, float f2, boolean z) {
            }

            public static void $default$didPressRevealSensitiveContent(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressSideButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressSponsoredClose(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressSponsoredInfo(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, float f, float f2) {
            }

            public static void $default$didPressTime(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static boolean $default$didPressToDoButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC.TodoItem todoItem, boolean z) {
                return false;
            }

            public static void $default$didPressUrl(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, CharacterStyle characterStyle, boolean z) {
            }

            public static void $default$didPressUserAvatar(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC.User user, float f, float f2, boolean z) {
            }

            public static void $default$didPressUserStatus(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC.User user, TLRPC.Document document, String str) {
            }

            public static void $default$didPressViaBot(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, String str) {
            }

            public static void $default$didPressViaBotNotInline(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, long j) {
            }

            public static void $default$didPressVoteButtons(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, ArrayList arrayList, int i, int i2, int i3) {
            }

            public static void $default$didQuickShareEnd(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, float f, float f2) {
            }

            public static void $default$didQuickShareMove(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, float f, float f2) {
            }

            public static void $default$didQuickShareStart(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, float f, float f2) {
            }

            public static void $default$didStartVideoStream(ChatMessageCellDelegate chatMessageCellDelegate, MessageObject messageObject) {
            }

            public static boolean $default$doNotShowLoadingReply(ChatMessageCellDelegate chatMessageCellDelegate, MessageObject messageObject) {
                return messageObject != null && messageObject.getDialogId() == UserObject.REPLY_BOT;
            }

            public static void $default$forceUpdate(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, boolean z) {
            }

            public static String $default$getAdminRank(ChatMessageCellDelegate chatMessageCellDelegate, long j) {
                return null;
            }

            public static PinchToZoomHelper $default$getPinchToZoomHelper(ChatMessageCellDelegate chatMessageCellDelegate) {
                return null;
            }

            public static String $default$getProgressLoadingBotButtonUrl(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
                return null;
            }

            public static CharacterStyle $default$getProgressLoadingLink(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
                return null;
            }

            public static TextSelectionHelper.ChatListTextSelectionHelper $default$getTextSelectionHelper(ChatMessageCellDelegate chatMessageCellDelegate) {
                return null;
            }

            public static boolean $default$hasSelectedMessages(ChatMessageCellDelegate chatMessageCellDelegate) {
                return false;
            }

            public static void $default$invalidateBlur(ChatMessageCellDelegate chatMessageCellDelegate) {
            }

            public static boolean $default$isLandscape(ChatMessageCellDelegate chatMessageCellDelegate) {
                return false;
            }

            public static boolean $default$isProgressLoading(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, int i) {
                return false;
            }

            public static boolean $default$isReplyOrSelf(ChatMessageCellDelegate chatMessageCellDelegate) {
                return false;
            }

            public static boolean $default$keyboardIsOpened(ChatMessageCellDelegate chatMessageCellDelegate) {
                return false;
            }

            public static void $default$needOpenWebView(ChatMessageCellDelegate chatMessageCellDelegate, MessageObject messageObject, String str, String str2, String str3, String str4, int i, int i2) {
            }

            public static boolean $default$needPlayMessage(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, MessageObject messageObject, boolean z) {
                return false;
            }

            public static void $default$needReloadPolls(ChatMessageCellDelegate chatMessageCellDelegate) {
            }

            public static void $default$needShowPremiumBulletin(ChatMessageCellDelegate chatMessageCellDelegate, int i) {
            }

            public static boolean $default$onAccessibilityAction(ChatMessageCellDelegate chatMessageCellDelegate, int i, Bundle bundle) {
                return false;
            }

            public static void $default$onDiceFinished(ChatMessageCellDelegate chatMessageCellDelegate) {
            }

            public static void $default$setShouldNotRepeatSticker(ChatMessageCellDelegate chatMessageCellDelegate, MessageObject messageObject) {
            }

            public static boolean $default$shouldDrawThreadProgress(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, boolean z) {
                return false;
            }

            public static boolean $default$shouldRepeatSticker(ChatMessageCellDelegate chatMessageCellDelegate, MessageObject messageObject) {
                return true;
            }

            public static void $default$videoTimerReached(ChatMessageCellDelegate chatMessageCellDelegate) {
            }
        }

        boolean canDrawOutboundsContent();

        boolean canPerformActions();

        boolean canPerformReply();

        void didLongPress(ChatMessageCell chatMessageCell, float f, float f2);

        void didLongPressBotButton(ChatMessageCell chatMessageCell, TLRPC.KeyboardButton keyboardButton);

        boolean didLongPressChannelAvatar(ChatMessageCell chatMessageCell, TLRPC.Chat chat, int i, float f, float f2);

        void didLongPressCustomBotButton(ChatMessageCell chatMessageCell, BotInlineKeyboard.ButtonCustom buttonCustom);

        boolean didLongPressToDoButton(ChatMessageCell chatMessageCell, TLRPC.TodoItem todoItem);

        boolean didLongPressUserAvatar(ChatMessageCell chatMessageCell, TLRPC.User user, float f, float f2);

        void didPressAboutRevenueSharingAds();

        boolean didPressAnimatedEmoji(ChatMessageCell chatMessageCell, AnimatedEmojiSpan animatedEmojiSpan);

        void didPressBoostCounter(ChatMessageCell chatMessageCell);

        void didPressBotButton(ChatMessageCell chatMessageCell, TLRPC.KeyboardButton keyboardButton);

        void didPressCancelSendButton(ChatMessageCell chatMessageCell);

        void didPressChannelAvatar(ChatMessageCell chatMessageCell, TLRPC.Chat chat, int i, float f, float f2, boolean z);

        void didPressChannelRecommendation(ChatMessageCell chatMessageCell, TLObject tLObject, boolean z);

        void didPressChannelRecommendationsClose(ChatMessageCell chatMessageCell);

        void didPressCodeCopy(ChatMessageCell chatMessageCell, MessageObject.TextLayoutBlock textLayoutBlock);

        void didPressCommentButton(ChatMessageCell chatMessageCell);

        void didPressCustomBotButton(ChatMessageCell chatMessageCell, BotInlineKeyboard.ButtonCustom buttonCustom);

        void didPressEffect(ChatMessageCell chatMessageCell);

        void didPressExtendedMediaPreview(ChatMessageCell chatMessageCell, TLRPC.KeyboardButton keyboardButton);

        void didPressFactCheck(ChatMessageCell chatMessageCell);

        void didPressFactCheckWhat(ChatMessageCell chatMessageCell, int i, int i2);

        void didPressGiveawayChatButton(ChatMessageCell chatMessageCell, int i);

        void didPressGroupImage(ChatMessageCell chatMessageCell, ImageReceiver imageReceiver, TLRPC.MessageExtendedMedia messageExtendedMedia, float f, float f2);

        void didPressHiddenForward(ChatMessageCell chatMessageCell);

        void didPressHint(ChatMessageCell chatMessageCell, int i);

        void didPressImage(ChatMessageCell chatMessageCell, float f, float f2, boolean z);

        void didPressInstantButton(ChatMessageCell chatMessageCell, int i);

        void didPressMoreChannelRecommendations(ChatMessageCell chatMessageCell);

        void didPressOther(ChatMessageCell chatMessageCell, float f, float f2);

        void didPressReaction(ChatMessageCell chatMessageCell, TLRPC.ReactionCount reactionCount, boolean z, float f, float f2);

        void didPressReplyMessage(ChatMessageCell chatMessageCell, int i, float f, float f2, boolean z);

        void didPressRevealSensitiveContent(ChatMessageCell chatMessageCell);

        void didPressSideButton(ChatMessageCell chatMessageCell);

        void didPressSponsoredClose(ChatMessageCell chatMessageCell);

        void didPressSponsoredInfo(ChatMessageCell chatMessageCell, float f, float f2);

        void didPressTime(ChatMessageCell chatMessageCell);

        boolean didPressToDoButton(ChatMessageCell chatMessageCell, TLRPC.TodoItem todoItem, boolean z);

        void didPressUrl(ChatMessageCell chatMessageCell, CharacterStyle characterStyle, boolean z);

        void didPressUserAvatar(ChatMessageCell chatMessageCell, TLRPC.User user, float f, float f2, boolean z);

        void didPressUserStatus(ChatMessageCell chatMessageCell, TLRPC.User user, TLRPC.Document document, String str);

        void didPressViaBot(ChatMessageCell chatMessageCell, String str);

        void didPressViaBotNotInline(ChatMessageCell chatMessageCell, long j);

        void didPressVoteButtons(ChatMessageCell chatMessageCell, ArrayList arrayList, int i, int i2, int i3);

        void didPressWebPage(ChatMessageCell chatMessageCell, TLRPC.WebPage webPage, String str, boolean z);

        void didQuickShareEnd(ChatMessageCell chatMessageCell, float f, float f2);

        void didQuickShareMove(ChatMessageCell chatMessageCell, float f, float f2);

        void didQuickShareStart(ChatMessageCell chatMessageCell, float f, float f2);

        void didStartVideoStream(MessageObject messageObject);

        boolean doNotShowLoadingReply(MessageObject messageObject);

        void forceUpdate(ChatMessageCell chatMessageCell, boolean z);

        String getAdminRank(long j);

        PinchToZoomHelper getPinchToZoomHelper();

        String getProgressLoadingBotButtonUrl(ChatMessageCell chatMessageCell);

        CharacterStyle getProgressLoadingLink(ChatMessageCell chatMessageCell);

        TextSelectionHelper.ChatListTextSelectionHelper getTextSelectionHelper();

        boolean hasSelectedMessages();

        void invalidateBlur();

        boolean isLandscape();

        boolean isProgressLoading(ChatMessageCell chatMessageCell, int i);

        boolean isReplyOrSelf();

        boolean keyboardIsOpened();

        void needOpenWebView(MessageObject messageObject, String str, String str2, String str3, String str4, int i, int i2);

        boolean needPlayMessage(ChatMessageCell chatMessageCell, MessageObject messageObject, boolean z);

        void needReloadPolls();

        void needShowPremiumBulletin(int i);

        boolean onAccessibilityAction(int i, Bundle bundle);

        void onDiceFinished();

        void setShouldNotRepeatSticker(MessageObject messageObject);

        boolean shouldDrawThreadProgress(ChatMessageCell chatMessageCell, boolean z);

        boolean shouldRepeatSticker(MessageObject messageObject);

        void videoTimerReached();
    }

    private static class InstantViewButton {
        private ButtonBounce buttonBounce;
        private float buttonWidth;
        private StaticLayout layout;
        private final RectF rect;
        private Drawable selectorDrawable;
        private float textX;
        private int type;

        private InstantViewButton() {
            this.rect = new RectF();
        }

        static /* synthetic */ float access$6024(InstantViewButton instantViewButton, float f) {
            float f2 = instantViewButton.textX - f;
            instantViewButton.textX = f2;
            return f2;
        }
    }

    class LoadingDrawableLocation {
        int blockNum;
        LoadingDrawable drawable;

        LoadingDrawableLocation() {
        }
    }

    private static class MaskDrawable extends Drawable {
        protected final Paint maskPaint;
        public final Path path;
        public int pathX;
        public int pathY;
        public final RectF rect;

        private MaskDrawable() {
            Paint paint = new Paint(1);
            this.maskPaint = paint;
            paint.setColor(-1);
            this.rect = new RectF();
            this.path = new Path();
        }

        @Override // android.graphics.drawable.Drawable
        public void draw(Canvas canvas) {
            updatePath();
            canvas.drawPath(this.path, this.maskPaint);
        }

        @Override // android.graphics.drawable.Drawable
        public int getOpacity() {
            return -2;
        }

        @Override // android.graphics.drawable.Drawable
        public void setAlpha(int i) {
        }

        @Override // android.graphics.drawable.Drawable
        public void setColorFilter(ColorFilter colorFilter) {
        }

        public abstract void updatePath();
    }

    private class MessageAccessibilityNodeProvider extends AccessibilityNodeProvider {
        private Path linkPath;
        private Rect rect;
        private RectF rectF;

        private class ProfileSpan extends ClickableSpan {
            private TLRPC.User user;

            public ProfileSpan(TLRPC.User user) {
                this.user = user;
            }

            @Override // android.text.style.ClickableSpan
            public void onClick(View view) {
                if (ChatMessageCell.this.delegate != null) {
                    ChatMessageCell.this.delegate.didPressUserAvatar(ChatMessageCell.this, this.user, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, false);
                }
            }
        }

        private MessageAccessibilityNodeProvider() {
            this.linkPath = new Path();
            this.rectF = new RectF();
            this.rect = new Rect();
        }

        private ClickableSpan getLinkById(int i, boolean z) {
            if (i == 5000) {
                return null;
            }
            if (z) {
                int i2 = i - 3000;
                if (!(ChatMessageCell.this.currentMessageObject.caption instanceof Spannable) || i2 < 0) {
                    return null;
                }
                Spannable spannable = (Spannable) ChatMessageCell.this.currentMessageObject.caption;
                ClickableSpan[] clickableSpanArr = (ClickableSpan[]) spannable.getSpans(0, spannable.length(), ClickableSpan.class);
                if (clickableSpanArr.length <= i2) {
                    return null;
                }
                return clickableSpanArr[i2];
            }
            int i3 = i - 2000;
            if (!(ChatMessageCell.this.currentMessageObject.messageText instanceof Spannable) || i3 < 0) {
                return null;
            }
            Spannable spannable2 = (Spannable) ChatMessageCell.this.currentMessageObject.messageText;
            ClickableSpan[] clickableSpanArr2 = (ClickableSpan[]) spannable2.getSpans(0, spannable2.length(), ClickableSpan.class);
            if (clickableSpanArr2.length <= i3) {
                return null;
            }
            return clickableSpanArr2[i3];
        }

        /* JADX WARN: Removed duplicated region for block: B:104:0x02aa  */
        /* JADX WARN: Removed duplicated region for block: B:121:0x030b  */
        /* JADX WARN: Removed duplicated region for block: B:131:0x0358  */
        /* JADX WARN: Removed duplicated region for block: B:133:0x0369  */
        /* JADX WARN: Removed duplicated region for block: B:140:0x039d  */
        /* JADX WARN: Removed duplicated region for block: B:159:0x046d  */
        /* JADX WARN: Removed duplicated region for block: B:162:0x04a6  */
        /* JADX WARN: Removed duplicated region for block: B:167:0x04cf  */
        /* JADX WARN: Removed duplicated region for block: B:171:0x04f2  */
        /* JADX WARN: Removed duplicated region for block: B:194:0x05ab  */
        /* JADX WARN: Removed duplicated region for block: B:206:0x0622  */
        /* JADX WARN: Removed duplicated region for block: B:207:0x063c  */
        /* JADX WARN: Removed duplicated region for block: B:210:0x064e A[LOOP:7: B:209:0x064c->B:210:0x064e, LOOP_END] */
        /* JADX WARN: Removed duplicated region for block: B:245:0x073e  */
        @Override // android.view.accessibility.AccessibilityNodeProvider
        /*
            Code decompiled incorrectly, please refer to instructions dump.
        */
        public AccessibilityNodeInfo createAccessibilityNodeInfo(int i) {
            Rect rect;
            int i2;
            boolean z;
            int i3;
            int i4;
            String str;
            String shortNumber;
            int i5;
            String str2;
            int i6;
            String str3;
            int i7;
            String str4;
            boolean z2;
            CharSequence charSequence;
            long j;
            String str5;
            AccessibilityNodeInfo accessibilityNodeInfo;
            long j2;
            CharSequence charSequence2;
            int i8;
            String str6;
            String string;
            CharSequence voiceTranscription;
            String string2;
            int i9;
            String pluralString;
            boolean zIsUserSelf;
            TLRPC.MessagePeerReaction messagePeerReaction;
            int i10;
            String str7;
            int i11;
            String str8;
            AccessibilityNodeInfo accessibilityNodeInfo2;
            String str9;
            int i12;
            String str10;
            String string3;
            int i13;
            String str11;
            int[] iArr = {0, 0};
            ChatMessageCell.this.getLocationOnScreen(iArr);
            if (i != -1) {
                AccessibilityNodeInfo accessibilityNodeInfoObtain = AccessibilityNodeInfo.obtain();
                accessibilityNodeInfoObtain.setSource(ChatMessageCell.this, i);
                accessibilityNodeInfoObtain.setParent(ChatMessageCell.this);
                accessibilityNodeInfoObtain.setPackageName(ChatMessageCell.this.getContext().getPackageName());
                if (i != 5000) {
                    if (i >= 3000) {
                        if (!(ChatMessageCell.this.currentMessageObject.caption instanceof Spannable)) {
                            return null;
                        }
                        ChatMessageCell chatMessageCell = ChatMessageCell.this;
                        if (chatMessageCell.captionLayout == null) {
                            return null;
                        }
                        Spannable spannable = (Spannable) chatMessageCell.currentMessageObject.caption;
                        ClickableSpan linkById = getLinkById(i, false);
                        if (linkById == null) {
                            return null;
                        }
                        int[] realSpanStartAndEnd = ChatMessageCell.this.getRealSpanStartAndEnd(spannable, linkById);
                        accessibilityNodeInfoObtain.setText(spannable.subSequence(realSpanStartAndEnd[0], realSpanStartAndEnd[1]).toString());
                        Iterator<MessageObject.TextLayoutBlock> it = ChatMessageCell.this.captionLayout.textLayoutBlocks.iterator();
                        while (true) {
                            if (!it.hasNext()) {
                                break;
                            }
                            MessageObject.TextLayoutBlock next = it.next();
                            int length = next.textLayout.getText().length();
                            int i14 = next.charactersOffset;
                            int i15 = realSpanStartAndEnd[0];
                            if (i14 <= i15) {
                                int i16 = length + i14;
                                int i17 = realSpanStartAndEnd[1];
                                if (i16 >= i17) {
                                    next.textLayout.getSelectionPath(i15 - i14, i17 - i14, this.linkPath);
                                    this.linkPath.computeBounds(this.rectF, true);
                                    Rect rect2 = this.rect;
                                    RectF rectF = this.rectF;
                                    rect2.set((int) rectF.left, (int) rectF.top, (int) rectF.right, (int) rectF.bottom);
                                    Rect rect3 = this.rect;
                                    ChatMessageCell chatMessageCell2 = ChatMessageCell.this;
                                    rect3.offset(0, (int) next.textYOffset(chatMessageCell2.captionLayout.textLayoutBlocks, chatMessageCell2.transitionParams));
                                    Rect rect4 = this.rect;
                                    ChatMessageCell chatMessageCell3 = ChatMessageCell.this;
                                    rect4.offset(chatMessageCell3.textX, chatMessageCell3.textY);
                                    accessibilityNodeInfoObtain.setBoundsInParent(this.rect);
                                    if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null) {
                                        ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                                    }
                                    this.rect.offset(iArr[0], iArr[1]);
                                    accessibilityNodeInfoObtain.setBoundsInScreen(this.rect);
                                }
                            }
                        }
                    } else {
                        if (i < 2000) {
                            if (i < 1000) {
                                if (i >= 500) {
                                    int i18 = i - 500;
                                    if (i18 >= ChatMessageCell.this.pollButtons.size()) {
                                        return null;
                                    }
                                    PollButton pollButton = (PollButton) ChatMessageCell.this.pollButtons.get(i18);
                                    StringBuilder sb = new StringBuilder(pollButton.title.getText());
                                    if (ChatMessageCell.this.pollVoted) {
                                        accessibilityNodeInfoObtain.setSelected(pollButton.chosen);
                                        sb.append(", ");
                                        sb.append(pollButton.percent);
                                        sb.append("%");
                                        if (ChatMessageCell.this.lastPoll != null && ChatMessageCell.this.lastPoll.quiz && (pollButton.chosen || pollButton.correct)) {
                                            sb.append(", ");
                                            if (pollButton.correct) {
                                                i7 = R.string.AccDescrQuizCorrectAnswer;
                                                str4 = "AccDescrQuizCorrectAnswer";
                                            } else {
                                                i7 = R.string.AccDescrQuizIncorrectAnswer;
                                                str4 = "AccDescrQuizIncorrectAnswer";
                                            }
                                            sb.append(LocaleController.getString(str4, i7));
                                        }
                                    } else {
                                        accessibilityNodeInfoObtain.setClassName("android.widget.Button");
                                    }
                                    accessibilityNodeInfoObtain.setText(sb);
                                    accessibilityNodeInfoObtain.setEnabled(true);
                                    accessibilityNodeInfoObtain.addAction(16);
                                    int i19 = pollButton.y;
                                    ChatMessageCell chatMessageCell4 = ChatMessageCell.this;
                                    int i20 = i19 + chatMessageCell4.namesOffset;
                                    int iDp = chatMessageCell4.backgroundWidth - AndroidUtilities.dp(76.0f);
                                    Rect rect5 = this.rect;
                                    int i21 = pollButton.x;
                                    rect5.set(i21, i20, iDp + i21, pollButton.height + i20);
                                    accessibilityNodeInfoObtain.setBoundsInParent(this.rect);
                                    if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null) {
                                        ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                                    }
                                    rect = this.rect;
                                    i2 = iArr[0];
                                    z = true;
                                    i3 = iArr[1];
                                } else if (i == 495) {
                                    accessibilityNodeInfoObtain.setClassName("android.widget.Button");
                                    accessibilityNodeInfoObtain.setEnabled(true);
                                    accessibilityNodeInfoObtain.setText(LocaleController.getString("AccDescrQuizExplanation", R.string.AccDescrQuizExplanation));
                                    accessibilityNodeInfoObtain.addAction(16);
                                    this.rect.set(ChatMessageCell.this.pollHintX - AndroidUtilities.dp(8.0f), ChatMessageCell.this.pollHintY - AndroidUtilities.dp(8.0f), ChatMessageCell.this.pollHintX + AndroidUtilities.dp(32.0f), ChatMessageCell.this.pollHintY + AndroidUtilities.dp(32.0f));
                                    accessibilityNodeInfoObtain.setBoundsInParent(this.rect);
                                    if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null || !((Rect) ChatMessageCell.this.accessibilityVirtualViewBounds.get(i)).equals(this.rect)) {
                                        ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                                    }
                                    rect = this.rect;
                                    i2 = iArr[0];
                                    z = true;
                                    i3 = iArr[1];
                                } else if (i == 499) {
                                    accessibilityNodeInfoObtain.setClassName("android.widget.Button");
                                    accessibilityNodeInfoObtain.setEnabled(true);
                                    if (ChatMessageCell.this.instantViewLayout != null) {
                                        accessibilityNodeInfoObtain.setText(ChatMessageCell.this.instantViewLayout.getText());
                                    }
                                    accessibilityNodeInfoObtain.addAction(16);
                                    ChatMessageCell.this.instantButtonRect.round(this.rect);
                                    accessibilityNodeInfoObtain.setBoundsInParent(this.rect);
                                    if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null || !((Rect) ChatMessageCell.this.accessibilityVirtualViewBounds.get(i)).equals(this.rect)) {
                                        ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                                    }
                                    rect = this.rect;
                                    i2 = iArr[0];
                                    z = true;
                                    i3 = iArr[1];
                                } else {
                                    if (i != 492) {
                                        if (i == 491 || i == 490 || i == 489) {
                                            int i22 = i != 491 ? i == 490 ? 31 : 30 : 5;
                                            for (int i23 = 0; i23 < ChatMessageCell.this.contactButtons.size(); i23++) {
                                                InstantViewButton instantViewButton = (InstantViewButton) ChatMessageCell.this.contactButtons.get(i23);
                                                if (instantViewButton.type == i22) {
                                                    accessibilityNodeInfoObtain.setClassName("android.widget.Button");
                                                    accessibilityNodeInfoObtain.setEnabled(true);
                                                    if (instantViewButton.layout != null) {
                                                        accessibilityNodeInfoObtain.setText(instantViewButton.layout.getText());
                                                    }
                                                    accessibilityNodeInfoObtain.addAction(16);
                                                    instantViewButton.rect.round(this.rect);
                                                    accessibilityNodeInfoObtain.setBoundsInParent(this.rect);
                                                    if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null || !((Rect) ChatMessageCell.this.accessibilityVirtualViewBounds.get(i)).equals(this.rect)) {
                                                        ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                                                    }
                                                    rect = this.rect;
                                                    i2 = iArr[0];
                                                    z = true;
                                                    i3 = iArr[1];
                                                }
                                            }
                                        } else {
                                            if (i == 498) {
                                                accessibilityNodeInfoObtain.setClassName("android.widget.ImageButton");
                                                accessibilityNodeInfoObtain.setEnabled(true);
                                                ChatMessageCell chatMessageCell5 = ChatMessageCell.this;
                                                if (chatMessageCell5.isOpenChatByShare(chatMessageCell5.currentMessageObject)) {
                                                    i6 = R.string.AccDescrOpenChat;
                                                    str3 = "AccDescrOpenChat";
                                                } else {
                                                    i6 = R.string.ShareFile;
                                                    str3 = "ShareFile";
                                                }
                                                accessibilityNodeInfoObtain.setContentDescription(LocaleController.getString(str3, i6));
                                                accessibilityNodeInfoObtain.addAction(16);
                                                this.rect.set((int) ChatMessageCell.this.sideStartX, (int) ChatMessageCell.this.sideStartY, ((int) ChatMessageCell.this.sideStartX) + AndroidUtilities.dp(40.0f), ((int) ChatMessageCell.this.sideStartY) + AndroidUtilities.dp(32.0f));
                                                accessibilityNodeInfoObtain.setBoundsInParent(this.rect);
                                                if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null || !((Rect) ChatMessageCell.this.accessibilityVirtualViewBounds.get(i)).equals(this.rect)) {
                                                    ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                                                }
                                                rect = this.rect;
                                                i2 = iArr[0];
                                                i3 = iArr[1];
                                            } else if (i == 497) {
                                                accessibilityNodeInfoObtain.setEnabled(true);
                                                StringBuilder sb2 = new StringBuilder();
                                                sb2.append(LocaleController.getString("Reply", R.string.Reply));
                                                sb2.append(", ");
                                                StaticLayout staticLayout = ChatMessageCell.this.replyNameLayout;
                                                if (staticLayout != null) {
                                                    sb2.append(staticLayout.getText());
                                                    sb2.append(", ");
                                                }
                                                StaticLayout staticLayout2 = ChatMessageCell.this.replyTextLayout;
                                                if (staticLayout2 != null) {
                                                    sb2.append(staticLayout2.getText());
                                                }
                                                accessibilityNodeInfoObtain.setContentDescription(sb2.toString());
                                                accessibilityNodeInfoObtain.addAction(16);
                                                Rect rect6 = this.rect;
                                                ChatMessageCell chatMessageCell6 = ChatMessageCell.this;
                                                int i24 = chatMessageCell6.replyStartX;
                                                int i25 = chatMessageCell6.replyStartY;
                                                int iMax = Math.max(chatMessageCell6.replyNameWidth, ChatMessageCell.this.replyTextWidth) + i24;
                                                ChatMessageCell chatMessageCell7 = ChatMessageCell.this;
                                                rect6.set(i24, i25, iMax, chatMessageCell7.replyStartY + ((int) chatMessageCell7.replyHeight));
                                                accessibilityNodeInfoObtain.setBoundsInParent(this.rect);
                                                if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null || !((Rect) ChatMessageCell.this.accessibilityVirtualViewBounds.get(i)).equals(this.rect)) {
                                                    ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                                                }
                                                rect = this.rect;
                                                i2 = iArr[0];
                                                i3 = iArr[1];
                                            } else if (i == 494) {
                                                accessibilityNodeInfoObtain.setEnabled(true);
                                                StringBuilder sb3 = new StringBuilder();
                                                if (ChatMessageCell.this.forwardedNameLayout[0] != null && ChatMessageCell.this.forwardedNameLayout[1] != null) {
                                                    int i26 = 0;
                                                    while (i26 < 2) {
                                                        sb3.append(ChatMessageCell.this.forwardedNameLayout[i26].getText());
                                                        sb3.append(i26 == 0 ? " " : "\n");
                                                        i26++;
                                                    }
                                                }
                                                accessibilityNodeInfoObtain.setContentDescription(sb3.toString());
                                                accessibilityNodeInfoObtain.addAction(16);
                                                int iMin = (int) Math.min(ChatMessageCell.this.forwardNameX - ChatMessageCell.this.forwardNameOffsetX[0], ChatMessageCell.this.forwardNameX - ChatMessageCell.this.forwardNameOffsetX[1]);
                                                this.rect.set(iMin, ChatMessageCell.this.forwardNameY, ChatMessageCell.this.forwardedNameWidth + iMin, ChatMessageCell.this.forwardNameY + ChatMessageCell.this.forwardHeight);
                                                accessibilityNodeInfoObtain.setBoundsInParent(this.rect);
                                                if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null || !((Rect) ChatMessageCell.this.accessibilityVirtualViewBounds.get(i)).equals(this.rect)) {
                                                    ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                                                }
                                                rect = this.rect;
                                                i2 = iArr[0];
                                                i3 = iArr[1];
                                            } else if (i == 496) {
                                                accessibilityNodeInfoObtain.setClassName("android.widget.Button");
                                                accessibilityNodeInfoObtain.setEnabled(true);
                                                int repliesCount = ChatMessageCell.this.getRepliesCount();
                                                if (ChatMessageCell.this.currentMessageObject == null || ChatMessageCell.this.currentMessageObject.shouldDrawWithoutBackground() || ChatMessageCell.this.currentMessageObject.isAnimatedEmoji()) {
                                                    shortNumber = (ChatMessageCell.this.isRepliesChat || repliesCount <= 0) ? null : LocaleController.formatShortNumber(repliesCount, null);
                                                } else {
                                                    if (ChatMessageCell.this.isRepliesChat) {
                                                        i5 = R.string.ViewInChat;
                                                        str2 = "ViewInChat";
                                                    } else if (repliesCount == 0) {
                                                        i5 = R.string.LeaveAComment;
                                                        str2 = "LeaveAComment";
                                                    } else {
                                                        shortNumber = LocaleController.formatPluralString("CommentsCount", repliesCount, new Object[0]);
                                                    }
                                                    shortNumber = LocaleController.getString(str2, i5);
                                                }
                                                if (shortNumber != null) {
                                                    accessibilityNodeInfoObtain.setText(shortNumber);
                                                }
                                                accessibilityNodeInfoObtain.addAction(16);
                                                this.rect.set(ChatMessageCell.this.commentButtonRect);
                                                accessibilityNodeInfoObtain.setBoundsInParent(this.rect);
                                                if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null || !((Rect) ChatMessageCell.this.accessibilityVirtualViewBounds.get(i)).equals(this.rect)) {
                                                    ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                                                }
                                                rect = this.rect;
                                                i2 = iArr[0];
                                                i3 = iArr[1];
                                            } else if (i == 493) {
                                                accessibilityNodeInfoObtain.setClassName("android.widget.Button");
                                                accessibilityNodeInfoObtain.setEnabled(true);
                                                if (ChatMessageCell.this.currentMessageObject.isVoiceTranscriptionOpen()) {
                                                    i4 = R.string.AccActionCloseTranscription;
                                                    str = "AccActionCloseTranscription";
                                                } else {
                                                    i4 = R.string.AccActionOpenTranscription;
                                                    str = "AccActionOpenTranscription";
                                                }
                                                accessibilityNodeInfoObtain.setText(LocaleController.getString(str, i4));
                                                accessibilityNodeInfoObtain.addAction(16);
                                                ChatMessageCell chatMessageCell8 = ChatMessageCell.this;
                                                if (chatMessageCell8.transcribeButton != null) {
                                                    this.rect.set((int) chatMessageCell8.transcribeX, (int) ChatMessageCell.this.transcribeY, (int) (ChatMessageCell.this.transcribeX + ChatMessageCell.this.transcribeButton.width()), (int) (ChatMessageCell.this.transcribeY + ChatMessageCell.this.transcribeButton.height()));
                                                }
                                                accessibilityNodeInfoObtain.setBoundsInParent(this.rect);
                                                rect = this.rect;
                                                i2 = iArr[0];
                                                i3 = iArr[1];
                                            }
                                            z = true;
                                        }
                                        accessibilityNodeInfoObtain.setFocusable(z);
                                        accessibilityNodeInfoObtain.setVisibleToUser(z);
                                        return accessibilityNodeInfoObtain;
                                    }
                                    accessibilityNodeInfoObtain.setClassName("android.widget.Button");
                                    accessibilityNodeInfoObtain.setEnabled(true);
                                    if (ChatMessageCell.this.titleLayout != null) {
                                        accessibilityNodeInfoObtain.setText(ChatMessageCell.this.titleLayout.getText());
                                    }
                                    accessibilityNodeInfoObtain.addAction(16);
                                    ChatMessageCell.this.contactRect.round(this.rect);
                                    if (ChatMessageCell.this.contactButtons != null && ChatMessageCell.this.contactButtons.size() > 1) {
                                        InstantViewButton instantViewButton2 = (InstantViewButton) ChatMessageCell.this.contactButtons.get(0);
                                        if (!instantViewButton2.rect.isEmpty()) {
                                            Rect rect7 = this.rect;
                                            rect7.set(rect7.left, rect7.top, rect7.right, (int) (rect7.bottom - instantViewButton2.rect.height()));
                                        }
                                    }
                                    accessibilityNodeInfoObtain.setBoundsInParent(this.rect);
                                    if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null || !((Rect) ChatMessageCell.this.accessibilityVirtualViewBounds.get(i)).equals(this.rect)) {
                                        ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                                    }
                                    rect = this.rect;
                                    i2 = iArr[0];
                                    z = true;
                                    i3 = iArr[1];
                                }
                                rect.offset(i2, i3);
                                accessibilityNodeInfoObtain.setBoundsInScreen(this.rect);
                                accessibilityNodeInfoObtain.setClickable(z);
                                accessibilityNodeInfoObtain.setFocusable(z);
                                accessibilityNodeInfoObtain.setVisibleToUser(z);
                                return accessibilityNodeInfoObtain;
                            }
                            int i27 = i - 1000;
                            if (i27 >= ChatMessageCell.this.botButtons.size()) {
                                return null;
                            }
                            BotButton botButton = (BotButton) ChatMessageCell.this.botButtons.get(i27);
                            if (botButton.isSeparator) {
                                return null;
                            }
                            accessibilityNodeInfoObtain.setText(botButton.title.getText());
                            accessibilityNodeInfoObtain.setClassName("android.widget.Button");
                            accessibilityNodeInfoObtain.setEnabled(true);
                            accessibilityNodeInfoObtain.setClickable(true);
                            accessibilityNodeInfoObtain.addAction(16);
                            this.rect.set((int) (botButton.x * ChatMessageCell.this.widthForButtons), botButton.y, (int) ((botButton.x + botButton.width) * ChatMessageCell.this.widthForButtons), botButton.y + botButton.height);
                            this.rect.offset(ChatMessageCell.this.currentMessageObject.isOutOwner() ? (ChatMessageCell.this.getMeasuredWidth() - ChatMessageCell.this.getWidthForButtons()) - AndroidUtilities.dp(10.0f) : ChatMessageCell.this.backgroundDrawableLeft + AndroidUtilities.dp(ChatMessageCell.this.mediaBackground ? 1.0f : 7.0f), ChatMessageCell.this.layoutHeight);
                            accessibilityNodeInfoObtain.setBoundsInParent(this.rect);
                            if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null) {
                                ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                            }
                            this.rect.offset(iArr[0], iArr[1]);
                            accessibilityNodeInfoObtain.setBoundsInScreen(this.rect);
                            z = true;
                            accessibilityNodeInfoObtain.setFocusable(z);
                            accessibilityNodeInfoObtain.setVisibleToUser(z);
                            return accessibilityNodeInfoObtain;
                        }
                        if (!(ChatMessageCell.this.currentMessageObject.messageText instanceof Spannable)) {
                            return null;
                        }
                        Spannable spannable2 = (Spannable) ChatMessageCell.this.currentMessageObject.messageText;
                        ClickableSpan linkById2 = getLinkById(i, false);
                        if (linkById2 == null) {
                            return null;
                        }
                        int[] realSpanStartAndEnd2 = ChatMessageCell.this.getRealSpanStartAndEnd(spannable2, linkById2);
                        accessibilityNodeInfoObtain.setText(spannable2.subSequence(realSpanStartAndEnd2[0], realSpanStartAndEnd2[1]).toString());
                        Iterator<MessageObject.TextLayoutBlock> it2 = ChatMessageCell.this.currentMessageObject.textLayoutBlocks.iterator();
                        while (it2.hasNext()) {
                            MessageObject.TextLayoutBlock next2 = it2.next();
                            int length2 = next2.textLayout.getText().length();
                            int i28 = next2.charactersOffset;
                            int i29 = realSpanStartAndEnd2[0];
                            if (i28 <= i29) {
                                int i30 = length2 + i28;
                                int i31 = realSpanStartAndEnd2[1];
                                if (i30 >= i31) {
                                    next2.textLayout.getSelectionPath(i29 - i28, i31 - i28, this.linkPath);
                                    this.linkPath.computeBounds(this.rectF, true);
                                    Rect rect8 = this.rect;
                                    RectF rectF2 = this.rectF;
                                    rect8.set((int) rectF2.left, (int) rectF2.top, (int) rectF2.right, (int) rectF2.bottom);
                                    this.rect.offset(0, (int) next2.textYOffset(ChatMessageCell.this.currentMessageObject.textLayoutBlocks, ChatMessageCell.this.transitionParams));
                                    Rect rect9 = this.rect;
                                    ChatMessageCell chatMessageCell9 = ChatMessageCell.this;
                                    rect9.offset(chatMessageCell9.textX, chatMessageCell9.textY);
                                    accessibilityNodeInfoObtain.setBoundsInParent(this.rect);
                                    if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null) {
                                        ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                                    }
                                    z2 = true;
                                    this.rect.offset(iArr[0], iArr[1]);
                                    accessibilityNodeInfoObtain.setBoundsInScreen(this.rect);
                                    accessibilityNodeInfoObtain.setClassName("android.widget.TextView");
                                    accessibilityNodeInfoObtain.setEnabled(z2);
                                    accessibilityNodeInfoObtain.setClickable(z2);
                                    accessibilityNodeInfoObtain.setLongClickable(z2);
                                }
                            }
                        }
                    }
                    z2 = true;
                    accessibilityNodeInfoObtain.setClassName("android.widget.TextView");
                    accessibilityNodeInfoObtain.setEnabled(z2);
                    accessibilityNodeInfoObtain.setClickable(z2);
                    accessibilityNodeInfoObtain.setLongClickable(z2);
                } else {
                    if (ChatMessageCell.this.currentUser == null) {
                        return null;
                    }
                    accessibilityNodeInfoObtain.setText(UserObject.getUserName(ChatMessageCell.this.currentUser));
                    this.rect.set((int) ChatMessageCell.this.nameX, (int) ChatMessageCell.this.nameY, (int) (ChatMessageCell.this.nameX + ChatMessageCell.this.nameWidth), (int) (ChatMessageCell.this.nameY + (ChatMessageCell.this.nameLayout != null ? ChatMessageCell.this.nameLayout.getHeight() : 10)));
                    accessibilityNodeInfoObtain.setBoundsInParent(this.rect);
                    if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null) {
                        ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                    }
                    this.rect.offset(iArr[0], iArr[1]);
                    accessibilityNodeInfoObtain.setBoundsInScreen(this.rect);
                    accessibilityNodeInfoObtain.setClassName("android.widget.TextView");
                    accessibilityNodeInfoObtain.setEnabled(true);
                    accessibilityNodeInfoObtain.setClickable(true);
                    accessibilityNodeInfoObtain.setLongClickable(true);
                }
                accessibilityNodeInfoObtain.addAction(16);
                accessibilityNodeInfoObtain.addAction(32);
                z = true;
                accessibilityNodeInfoObtain.setFocusable(z);
                accessibilityNodeInfoObtain.setVisibleToUser(z);
                return accessibilityNodeInfoObtain;
            }
            AccessibilityNodeInfo accessibilityNodeInfoObtain2 = AccessibilityNodeInfo.obtain(ChatMessageCell.this);
            ChatMessageCell.this.onInitializeAccessibilityNodeInfo(accessibilityNodeInfoObtain2);
            boolean z3 = ChatMessageCell.this.currentMessageObject != null && ChatMessageCell.this.currentMessageObject.isOut() && !ChatMessageCell.this.currentMessageObject.scheduled && ChatMessageCell.this.currentMessageObject.isUnread();
            boolean z4 = ChatMessageCell.this.currentMessageObject != null && ChatMessageCell.this.currentMessageObject.isContentUnread();
            if (ChatMessageCell.this.currentMessageObject != null) {
                charSequence = ", ";
                j = ChatMessageCell.this.currentMessageObject.loadedFileSize;
            } else {
                charSequence = ", ";
                j = 0;
            }
            ChatMessageCell chatMessageCell10 = ChatMessageCell.this;
            if (chatMessageCell10.accessibilityText != null && chatMessageCell10.accessibilityTextUnread == z3 && ChatMessageCell.this.accessibilityTextContentUnread == z4 && ChatMessageCell.this.accessibilityTextFileSize == j) {
                accessibilityNodeInfo = accessibilityNodeInfoObtain2;
                str5 = "AccActionDownload";
            } else {
                SpannableStringBuilder spannableStringBuilder = new SpannableStringBuilder();
                ChatMessageCell chatMessageCell11 = ChatMessageCell.this;
                if (!chatMessageCell11.isChat || chatMessageCell11.currentUser == null || ChatMessageCell.this.currentMessageObject.isOut()) {
                    str5 = "AccActionDownload";
                } else {
                    spannableStringBuilder.append((CharSequence) UserObject.getUserName(ChatMessageCell.this.currentUser));
                    str5 = "AccActionDownload";
                    spannableStringBuilder.setSpan(new ProfileSpan(ChatMessageCell.this.currentUser), 0, spannableStringBuilder.length(), 33);
                    spannableStringBuilder.append('\n');
                }
                if (ChatMessageCell.this.drawForwardedName) {
                    int i32 = 0;
                    while (i32 < 2) {
                        if (ChatMessageCell.this.forwardedNameLayout[i32] != null && ChatMessageCell.this.forwardedNameLayout[i32].getText() != null) {
                            spannableStringBuilder.append(ChatMessageCell.this.forwardedNameLayout[i32].getText());
                            spannableStringBuilder.append(i32 == 0 ? " " : "\n");
                        }
                        i32++;
                    }
                }
                if (ChatMessageCell.this.documentAttach != null && ChatMessageCell.this.documentAttachType == 1) {
                    String attachFileName = FileLoader.getAttachFileName(ChatMessageCell.this.documentAttach);
                    if (attachFileName.indexOf(46) != -1) {
                        spannableStringBuilder.append((CharSequence) LocaleController.formatString(R.string.AccDescrDocumentType, attachFileName.substring(attachFileName.lastIndexOf(46) + 1).toUpperCase(Locale.ROOT)));
                    }
                }
                if (!TextUtils.isEmpty(ChatMessageCell.this.currentMessageObject.messageText)) {
                    spannableStringBuilder.append(ChatMessageCell.this.currentMessageObject.messageText);
                }
                if (ChatMessageCell.this.documentAttach == null || !((ChatMessageCell.this.documentAttachType == 1 || ChatMessageCell.this.documentAttachType == 2 || ChatMessageCell.this.documentAttachType == 4) && ChatMessageCell.this.buttonState == 1 && ChatMessageCell.this.loadingProgressLayout != null)) {
                    accessibilityNodeInfo = accessibilityNodeInfoObtain2;
                    j2 = j;
                } else {
                    spannableStringBuilder.append((CharSequence) "\n");
                    boolean zIsSending = ChatMessageCell.this.currentMessageObject.isSending();
                    accessibilityNodeInfo = accessibilityNodeInfoObtain2;
                    j2 = j;
                    spannableStringBuilder.append((CharSequence) LocaleController.formatString(zIsSending ? "AccDescrUploadProgress" : "AccDescrDownloadProgress", zIsSending ? R.string.AccDescrUploadProgress : R.string.AccDescrDownloadProgress, AndroidUtilities.formatFileSize(ChatMessageCell.this.currentMessageObject.loadedFileSize), AndroidUtilities.formatFileSize(ChatMessageCell.this.lastLoadingSizeTotal)));
                }
                if (ChatMessageCell.this.currentMessageObject.isMusic()) {
                    spannableStringBuilder.append((CharSequence) "\n");
                    spannableStringBuilder.append((CharSequence) LocaleController.formatString("AccDescrMusicInfo", R.string.AccDescrMusicInfo, ChatMessageCell.this.currentMessageObject.getMusicAuthor(), ChatMessageCell.this.currentMessageObject.getMusicTitle()));
                    charSequence2 = charSequence;
                    spannableStringBuilder.append(charSequence2);
                    string = LocaleController.formatDuration((int) ChatMessageCell.this.currentMessageObject.getDuration());
                } else {
                    charSequence2 = charSequence;
                    if (ChatMessageCell.this.currentMessageObject.isVoice() || ChatMessageCell.this.isRoundVideo) {
                        spannableStringBuilder.append(charSequence2);
                        spannableStringBuilder.append((CharSequence) LocaleController.formatDuration((int) ChatMessageCell.this.currentMessageObject.getDuration()));
                        spannableStringBuilder.append(charSequence2);
                        if (ChatMessageCell.this.currentMessageObject.isContentUnread()) {
                            i8 = R.string.AccDescrMsgNotPlayed;
                            str6 = "AccDescrMsgNotPlayed";
                        } else {
                            i8 = R.string.AccDescrMsgPlayed;
                            str6 = "AccDescrMsgPlayed";
                        }
                        string = LocaleController.getString(str6, i8);
                    }
                    if (ChatMessageCell.this.lastPoll != null) {
                        spannableStringBuilder.append(charSequence2);
                        spannableStringBuilder.append((CharSequence) ChatMessageCell.this.lastPoll.question.text);
                        spannableStringBuilder.append(charSequence2);
                        if (ChatMessageCell.this.pollClosed) {
                            i11 = R.string.FinalResults;
                            str8 = "FinalResults";
                        } else if (ChatMessageCell.this.lastPoll.quiz) {
                            if (ChatMessageCell.this.lastPoll.public_voters) {
                                i11 = R.string.QuizPoll;
                                str8 = "QuizPoll";
                            } else {
                                i11 = R.string.AnonymousQuizPoll;
                                str8 = "AnonymousQuizPoll";
                            }
                        } else if (ChatMessageCell.this.lastPoll.public_voters) {
                            i11 = R.string.PublicPoll;
                            str8 = "PublicPoll";
                        } else {
                            i11 = R.string.AnonymousPoll;
                            str8 = "AnonymousPoll";
                        }
                        spannableStringBuilder.append((CharSequence) LocaleController.getString(str8, i11));
                    }
                    if (ChatMessageCell.this.documentAttach != null) {
                        if (ChatMessageCell.this.documentAttachType == 4) {
                            spannableStringBuilder.append(charSequence2);
                            spannableStringBuilder.append((CharSequence) LocaleController.formatDuration((int) ChatMessageCell.this.currentMessageObject.getDuration()));
                        }
                        if (ChatMessageCell.this.buttonState == 0 || ChatMessageCell.this.documentAttachType == 1) {
                            spannableStringBuilder.append(charSequence2);
                            spannableStringBuilder.append((CharSequence) AndroidUtilities.formatFileSize(ChatMessageCell.this.documentAttach.size));
                        }
                    }
                    if (ChatMessageCell.this.currentMessageObject.isVoiceTranscriptionOpen()) {
                        if (MessageObject.getMedia(ChatMessageCell.this.currentMessageObject.messageOwner) != null && !TextUtils.isEmpty(ChatMessageCell.this.currentMessageObject.caption)) {
                            spannableStringBuilder.append((CharSequence) "\n");
                            voiceTranscription = ChatMessageCell.this.currentMessageObject.caption;
                        }
                        if (ChatMessageCell.this.currentMessageObject.isOut()) {
                            if (ChatMessageCell.this.currentMessageObject.isSent()) {
                                spannableStringBuilder.append((CharSequence) "\n");
                                if (ChatMessageCell.this.currentMessageObject.scheduled) {
                                    string2 = LocaleController.formatString("AccDescrScheduledDate", R.string.AccDescrScheduledDate, ChatMessageCell.this.currentTimeString);
                                } else {
                                    spannableStringBuilder.append((CharSequence) LocaleController.formatString("AccDescrSentDate", R.string.AccDescrSentDate, LocaleController.getString("TodayAt", R.string.TodayAt) + " " + ((Object) ChatMessageCell.this.currentTimeString)));
                                    spannableStringBuilder.append(charSequence2);
                                    if (ChatMessageCell.this.currentMessageObject.isUnread()) {
                                        i10 = R.string.AccDescrMsgUnread;
                                        str7 = "AccDescrMsgUnread";
                                    } else {
                                        i10 = R.string.AccDescrMsgRead;
                                        str7 = "AccDescrMsgRead";
                                    }
                                }
                            } else {
                                if (ChatMessageCell.this.currentMessageObject.isSending()) {
                                    spannableStringBuilder.append((CharSequence) "\n");
                                    spannableStringBuilder.append((CharSequence) LocaleController.getString("AccDescrMsgSending", R.string.AccDescrMsgSending));
                                    float progress = ChatMessageCell.this.radialProgress.getProgress();
                                    if (progress > BitmapDescriptorFactory.HUE_RED) {
                                        spannableStringBuilder.append((CharSequence) Integer.toString(Math.round(progress * 100.0f))).append((CharSequence) "%");
                                    }
                                } else if (ChatMessageCell.this.currentMessageObject.isSendError()) {
                                    spannableStringBuilder.append((CharSequence) "\n");
                                    i10 = R.string.AccDescrMsgSendingError;
                                    str7 = "AccDescrMsgSendingError";
                                }
                                if (ChatMessageCell.this.getRepliesCount() > 0 && !ChatMessageCell.this.hasCommentLayout()) {
                                    spannableStringBuilder.append((CharSequence) "\n");
                                    spannableStringBuilder.append((CharSequence) LocaleController.formatPluralString("AccDescrNumberOfReplies", ChatMessageCell.this.getRepliesCount(), new Object[0]));
                                }
                                if (ChatMessageCell.this.currentMessageObject.messageOwner.reactions != null && ChatMessageCell.this.currentMessageObject.messageOwner.reactions.results != null) {
                                    String firstName = "";
                                    if (ChatMessageCell.this.currentMessageObject.messageOwner.reactions.results.size() != 1) {
                                        TLRPC.ReactionCount reactionCount = (TLRPC.ReactionCount) ChatMessageCell.this.currentMessageObject.messageOwner.reactions.results.get(0);
                                        TLRPC.Reaction reaction = reactionCount.reaction;
                                        String str12 = reaction instanceof TLRPC.TL_reactionEmoji ? ((TLRPC.TL_reactionEmoji) reaction).emoticon : "";
                                        int i33 = reactionCount.count;
                                        if (i33 == 1) {
                                            spannableStringBuilder.append((CharSequence) "\n");
                                            if (ChatMessageCell.this.currentMessageObject.messageOwner.reactions.recent_reactions == null || ChatMessageCell.this.currentMessageObject.messageOwner.reactions.recent_reactions.size() != 1 || (messagePeerReaction = (TLRPC.MessagePeerReaction) ChatMessageCell.this.currentMessageObject.messageOwner.reactions.recent_reactions.get(0)) == null) {
                                                zIsUserSelf = false;
                                            } else {
                                                TLRPC.User user = MessagesController.getInstance(ChatMessageCell.this.currentAccount).getUser(Long.valueOf(MessageObject.getPeerId(messagePeerReaction.peer_id)));
                                                zIsUserSelf = UserObject.isUserSelf(user);
                                                if (user != null) {
                                                    firstName = UserObject.getFirstName(user);
                                                }
                                            }
                                            pluralString = zIsUserSelf ? LocaleController.formatString("AccDescrYouReactedWith", R.string.AccDescrYouReactedWith, str12) : LocaleController.formatString("AccDescrReactedWith", R.string.AccDescrReactedWith, firstName, str12);
                                        } else if (i33 > 1) {
                                            spannableStringBuilder.append((CharSequence) "\n");
                                            pluralString = LocaleController.formatPluralString("AccDescrNumberOfPeopleReactions", reactionCount.count, str12);
                                        }
                                        spannableStringBuilder.append((CharSequence) pluralString);
                                    } else {
                                        spannableStringBuilder.append((CharSequence) LocaleController.getString("Reactions", R.string.Reactions)).append((CharSequence) ": ");
                                        int size = ChatMessageCell.this.currentMessageObject.messageOwner.reactions.results.size();
                                        int i34 = 0;
                                        while (i34 < size) {
                                            TLRPC.ReactionCount reactionCount2 = (TLRPC.ReactionCount) ChatMessageCell.this.currentMessageObject.messageOwner.reactions.results.get(i34);
                                            TLRPC.Reaction reaction2 = reactionCount2.reaction;
                                            spannableStringBuilder.append((CharSequence) (reaction2 instanceof TLRPC.TL_reactionEmoji ? ((TLRPC.TL_reactionEmoji) reaction2).emoticon : "")).append((CharSequence) " ").append((CharSequence) (reactionCount2.count + ""));
                                            i34++;
                                            if (i34 < size) {
                                                spannableStringBuilder.append(charSequence2);
                                            }
                                        }
                                        spannableStringBuilder.append((CharSequence) "\n");
                                    }
                                }
                                if ((ChatMessageCell.this.currentMessageObject.messageOwner.flags & 1024) == 0) {
                                    spannableStringBuilder.append((CharSequence) "\n");
                                    i9 = 0;
                                    spannableStringBuilder.append((CharSequence) LocaleController.formatPluralString("AccDescrNumberOfViews", ChatMessageCell.this.currentMessageObject.messageOwner.views, new Object[0]));
                                } else {
                                    i9 = 0;
                                }
                                spannableStringBuilder.append((CharSequence) "\n");
                                for (final CharacterStyle characterStyle : (CharacterStyle[]) spannableStringBuilder.getSpans(i9, spannableStringBuilder.length(), ClickableSpan.class)) {
                                    int spanStart = spannableStringBuilder.getSpanStart(characterStyle);
                                    int spanEnd = spannableStringBuilder.getSpanEnd(characterStyle);
                                    spannableStringBuilder.removeSpan(characterStyle);
                                    spannableStringBuilder.setSpan(new ClickableSpan() { // from class: org.telegram.ui.Cells.ChatMessageCell.MessageAccessibilityNodeProvider.1
                                        @Override // android.text.style.ClickableSpan
                                        public void onClick(View view) {
                                            CharacterStyle characterStyle2 = characterStyle;
                                            if (characterStyle2 instanceof ProfileSpan) {
                                                ((ProfileSpan) characterStyle2).onClick(view);
                                            } else if (ChatMessageCell.this.delegate != null) {
                                                ChatMessageCell.this.delegate.didPressUrl(ChatMessageCell.this, characterStyle, false);
                                            }
                                        }
                                    }, spanStart, spanEnd, 33);
                                }
                                ChatMessageCell chatMessageCell12 = ChatMessageCell.this;
                                chatMessageCell12.accessibilityText = spannableStringBuilder;
                                chatMessageCell12.accessibilityTextUnread = z3;
                                ChatMessageCell.this.accessibilityTextContentUnread = z4;
                                ChatMessageCell.this.accessibilityTextFileSize = j2;
                            }
                            string2 = LocaleController.getString(str7, i10);
                        } else {
                            spannableStringBuilder.append((CharSequence) "\n");
                            string2 = LocaleController.formatString("AccDescrReceivedDate", R.string.AccDescrReceivedDate, LocaleController.getString("TodayAt", R.string.TodayAt) + " " + ((Object) ChatMessageCell.this.currentTimeString));
                        }
                        spannableStringBuilder.append((CharSequence) string2);
                        if (ChatMessageCell.this.getRepliesCount() > 0) {
                            spannableStringBuilder.append((CharSequence) "\n");
                            spannableStringBuilder.append((CharSequence) LocaleController.formatPluralString("AccDescrNumberOfReplies", ChatMessageCell.this.getRepliesCount(), new Object[0]));
                        }
                        if (ChatMessageCell.this.currentMessageObject.messageOwner.reactions != null) {
                            String firstName2 = "";
                            if (ChatMessageCell.this.currentMessageObject.messageOwner.reactions.results.size() != 1) {
                            }
                        }
                        if ((ChatMessageCell.this.currentMessageObject.messageOwner.flags & 1024) == 0) {
                        }
                        spannableStringBuilder.append((CharSequence) "\n");
                        while (i < r2) {
                        }
                        ChatMessageCell chatMessageCell122 = ChatMessageCell.this;
                        chatMessageCell122.accessibilityText = spannableStringBuilder;
                        chatMessageCell122.accessibilityTextUnread = z3;
                        ChatMessageCell.this.accessibilityTextContentUnread = z4;
                        ChatMessageCell.this.accessibilityTextFileSize = j2;
                    } else {
                        spannableStringBuilder.append((CharSequence) "\n");
                        voiceTranscription = ChatMessageCell.this.currentMessageObject.getVoiceTranscription();
                    }
                    spannableStringBuilder.append(voiceTranscription);
                    if (ChatMessageCell.this.currentMessageObject.isOut()) {
                    }
                    spannableStringBuilder.append((CharSequence) string2);
                    if (ChatMessageCell.this.getRepliesCount() > 0) {
                    }
                    if (ChatMessageCell.this.currentMessageObject.messageOwner.reactions != null) {
                    }
                    if ((ChatMessageCell.this.currentMessageObject.messageOwner.flags & 1024) == 0) {
                    }
                    spannableStringBuilder.append((CharSequence) "\n");
                    while (i < r2) {
                    }
                    ChatMessageCell chatMessageCell1222 = ChatMessageCell.this;
                    chatMessageCell1222.accessibilityText = spannableStringBuilder;
                    chatMessageCell1222.accessibilityTextUnread = z3;
                    ChatMessageCell.this.accessibilityTextContentUnread = z4;
                    ChatMessageCell.this.accessibilityTextFileSize = j2;
                }
                spannableStringBuilder.append((CharSequence) string);
                if (ChatMessageCell.this.lastPoll != null) {
                }
                if (ChatMessageCell.this.documentAttach != null) {
                }
                if (ChatMessageCell.this.currentMessageObject.isVoiceTranscriptionOpen()) {
                }
                spannableStringBuilder.append(voiceTranscription);
                if (ChatMessageCell.this.currentMessageObject.isOut()) {
                }
                spannableStringBuilder.append((CharSequence) string2);
                if (ChatMessageCell.this.getRepliesCount() > 0) {
                }
                if (ChatMessageCell.this.currentMessageObject.messageOwner.reactions != null) {
                }
                if ((ChatMessageCell.this.currentMessageObject.messageOwner.flags & 1024) == 0) {
                }
                spannableStringBuilder.append((CharSequence) "\n");
                while (i < r2) {
                }
                ChatMessageCell chatMessageCell12222 = ChatMessageCell.this;
                chatMessageCell12222.accessibilityText = spannableStringBuilder;
                chatMessageCell12222.accessibilityTextUnread = z3;
                ChatMessageCell.this.accessibilityTextContentUnread = z4;
                ChatMessageCell.this.accessibilityTextFileSize = j2;
            }
            int i35 = Build.VERSION.SDK_INT;
            if (i35 < 24) {
                accessibilityNodeInfo2 = accessibilityNodeInfo;
                accessibilityNodeInfo2.setContentDescription(ChatMessageCell.this.accessibilityText.toString());
            } else {
                accessibilityNodeInfo2 = accessibilityNodeInfo;
                accessibilityNodeInfo2.setText(ChatMessageCell.this.accessibilityText);
            }
            accessibilityNodeInfo2.setEnabled(true);
            AccessibilityNodeInfo.CollectionItemInfo collectionItemInfo = accessibilityNodeInfo2.getCollectionItemInfo();
            if (collectionItemInfo != null) {
                accessibilityNodeInfo2.setCollectionItemInfo(AccessibilityNodeInfo.CollectionItemInfo.obtain(collectionItemInfo.getRowIndex(), 1, 0, 1, false));
            }
            if (i35 >= 21) {
                accessibilityNodeInfo2.addAction(new AccessibilityNodeInfo.AccessibilityAction(R.id.acc_action_msg_options, LocaleController.getString("AccActionMessageOptions", R.string.AccActionMessageOptions)));
                int iconForCurrentState = ChatMessageCell.this.getIconForCurrentState();
                if (iconForCurrentState == 0) {
                    str9 = str5;
                    i12 = R.string.AccActionPlay;
                    str10 = "AccActionPlay";
                } else if (iconForCurrentState != 1) {
                    if (iconForCurrentState != 2) {
                        if (iconForCurrentState == 3) {
                            i13 = R.string.AccActionCancelDownload;
                            str11 = "AccActionCancelDownload";
                        } else if (iconForCurrentState == 5) {
                            i13 = R.string.AccActionOpenFile;
                            str11 = "AccActionOpenFile";
                        } else if (ChatMessageCell.this.currentMessageObject.type == 16) {
                            i13 = R.string.CallAgain;
                            str11 = "CallAgain";
                        } else {
                            str9 = str5;
                            string3 = null;
                        }
                        string3 = LocaleController.getString(str11, i13);
                        str9 = str5;
                    } else {
                        str9 = str5;
                        string3 = LocaleController.getString(str9, R.string.AccActionDownload);
                    }
                    accessibilityNodeInfo2.addAction(new AccessibilityNodeInfo.AccessibilityAction(16, string3));
                    accessibilityNodeInfo2.addAction(new AccessibilityNodeInfo.AccessibilityAction(32, LocaleController.getString("AccActionEnterSelectionMode", R.string.AccActionEnterSelectionMode)));
                    if (ChatMessageCell.this.getMiniIconForCurrentState() == 2) {
                        accessibilityNodeInfo2.addAction(new AccessibilityNodeInfo.AccessibilityAction(R.id.acc_action_small_button, LocaleController.getString(str9, R.string.AccActionDownload)));
                    }
                } else {
                    str9 = str5;
                    i12 = R.string.AccActionPause;
                    str10 = "AccActionPause";
                }
                string3 = LocaleController.getString(str10, i12);
                accessibilityNodeInfo2.addAction(new AccessibilityNodeInfo.AccessibilityAction(16, string3));
                accessibilityNodeInfo2.addAction(new AccessibilityNodeInfo.AccessibilityAction(32, LocaleController.getString("AccActionEnterSelectionMode", R.string.AccActionEnterSelectionMode)));
                if (ChatMessageCell.this.getMiniIconForCurrentState() == 2) {
                }
            } else {
                accessibilityNodeInfo2.addAction(16);
                accessibilityNodeInfo2.addAction(32);
            }
            if ((ChatMessageCell.this.currentMessageObject.isVoice() || ChatMessageCell.this.currentMessageObject.isRoundVideo() || ChatMessageCell.this.currentMessageObject.isMusic()) && MediaController.getInstance().isPlayingMessage(ChatMessageCell.this.currentMessageObject)) {
                ChatMessageCell.this.seekBarAccessibilityDelegate.onInitializeAccessibilityNodeInfoInternal(accessibilityNodeInfo2);
            }
            if (ChatMessageCell.this.useTranscribeButton) {
                ChatMessageCell chatMessageCell13 = ChatMessageCell.this;
                if (chatMessageCell13.transcribeButton != null) {
                    accessibilityNodeInfo2.addChild(chatMessageCell13, 493);
                }
            }
            if (i35 < 24) {
                ChatMessageCell chatMessageCell14 = ChatMessageCell.this;
                if (chatMessageCell14.isChat && chatMessageCell14.currentUser != null && !ChatMessageCell.this.currentMessageObject.isOut()) {
                    accessibilityNodeInfo2.addChild(ChatMessageCell.this, 5000);
                }
                if (ChatMessageCell.this.currentMessageObject.messageText instanceof Spannable) {
                    Spannable spannable3 = (Spannable) ChatMessageCell.this.currentMessageObject.messageText;
                    int i36 = 0;
                    for (CharacterStyle characterStyle2 : (CharacterStyle[]) spannable3.getSpans(0, spannable3.length(), ClickableSpan.class)) {
                        accessibilityNodeInfo2.addChild(ChatMessageCell.this, i36 + 2000);
                        i36++;
                    }
                }
                if (ChatMessageCell.this.currentMessageObject.caption instanceof Spannable) {
                    ChatMessageCell chatMessageCell15 = ChatMessageCell.this;
                    if (chatMessageCell15.captionLayout != null) {
                        Spannable spannable4 = (Spannable) chatMessageCell15.currentMessageObject.caption;
                        int i37 = 0;
                        for (CharacterStyle characterStyle3 : (CharacterStyle[]) spannable4.getSpans(0, spannable4.length(), ClickableSpan.class)) {
                            accessibilityNodeInfo2.addChild(ChatMessageCell.this, i37 + 3000);
                            i37++;
                        }
                    }
                }
            }
            Iterator it3 = ChatMessageCell.this.botButtons.iterator();
            int i38 = 0;
            while (it3.hasNext()) {
                accessibilityNodeInfo2.addChild(ChatMessageCell.this, i38 + 1000);
                i38++;
            }
            if (ChatMessageCell.this.hintButtonVisible && ChatMessageCell.this.pollHintX != -1 && ChatMessageCell.this.currentMessageObject.isPoll()) {
                accessibilityNodeInfo2.addChild(ChatMessageCell.this, 495);
            }
            Iterator it4 = ChatMessageCell.this.pollButtons.iterator();
            int i39 = 0;
            while (it4.hasNext()) {
                accessibilityNodeInfo2.addChild(ChatMessageCell.this, i39 + 500);
                i39++;
            }
            if (ChatMessageCell.this.drawInstantView && !ChatMessageCell.this.instantButtonRect.isEmpty()) {
                accessibilityNodeInfo2.addChild(ChatMessageCell.this, 499);
            }
            if (ChatMessageCell.this.drawContact && ChatMessageCell.this.contactRect != null && !ChatMessageCell.this.contactRect.isEmpty()) {
                accessibilityNodeInfo2.addChild(ChatMessageCell.this, 492);
                if (ChatMessageCell.this.contactButtons != null && ChatMessageCell.this.contactButtons.size() > 1) {
                    Iterator it5 = ChatMessageCell.this.contactButtons.iterator();
                    while (it5.hasNext()) {
                        InstantViewButton instantViewButton3 = (InstantViewButton) it5.next();
                        if (ChatMessageCell.this.drawContactView && instantViewButton3.type == 5 && !instantViewButton3.rect.isEmpty()) {
                            accessibilityNodeInfo2.addChild(ChatMessageCell.this, 491);
                        }
                        if (ChatMessageCell.this.drawContactAdd && instantViewButton3.type == 31 && !instantViewButton3.rect.isEmpty()) {
                            accessibilityNodeInfo2.addChild(ChatMessageCell.this, 490);
                        }
                        if (ChatMessageCell.this.drawContactSendMessage && instantViewButton3.type == 30 && !instantViewButton3.rect.isEmpty()) {
                            accessibilityNodeInfo2.addChild(ChatMessageCell.this, 489);
                        }
                    }
                }
            }
            if (ChatMessageCell.this.commentLayout != null) {
                accessibilityNodeInfo2.addChild(ChatMessageCell.this, 496);
            }
            if (ChatMessageCell.this.drawSideButton == 1 || ChatMessageCell.this.drawSideButton == 2) {
                accessibilityNodeInfo2.addChild(ChatMessageCell.this, 498);
            }
            ChatMessageCell chatMessageCell16 = ChatMessageCell.this;
            if (chatMessageCell16.replyNameLayout != null) {
                accessibilityNodeInfo2.addChild(chatMessageCell16, 497);
            }
            if (ChatMessageCell.this.forwardedNameLayout[0] != null && ChatMessageCell.this.forwardedNameLayout[1] != null) {
                if (Build.VERSION.SDK_INT >= 21) {
                    accessibilityNodeInfo2.addAction(new AccessibilityNodeInfo.AccessibilityAction(R.id.acc_action_open_forwarded_origin, LocaleController.getString("AccActionOpenForwardedOrigin", R.string.AccActionOpenForwardedOrigin)));
                } else {
                    accessibilityNodeInfo2.addChild(ChatMessageCell.this, 494);
                }
            }
            if (ChatMessageCell.this.drawSelectionBackground || ChatMessageCell.this.getBackground() != null) {
                accessibilityNodeInfo2.setSelected(true);
            }
            return accessibilityNodeInfo2;
        }

        /* JADX WARN: Code restructure failed: missing block: B:19:0x0046, code lost:
        
            if (r11 != null) goto L25;
         */
        /* JADX WARN: Code restructure failed: missing block: B:24:0x0051, code lost:
        
            if (r11 != null) goto L25;
         */
        /* JADX WARN: Code restructure failed: missing block: B:25:0x0053, code lost:
        
            r9.this$0.delegate.didPressUrl(r9.this$0, r11, false);
         */
        /* JADX WARN: Code restructure failed: missing block: B:64:0x013f, code lost:
        
            if (r9.this$0.delegate != null) goto L70;
         */
        /* JADX WARN: Code restructure failed: missing block: B:69:0x014c, code lost:
        
            if (r9.this$0.delegate != null) goto L70;
         */
        /* JADX WARN: Code restructure failed: missing block: B:70:0x014e, code lost:
        
            r10 = r9.this$0.delegate;
            r11 = r9.this$0;
            r12 = 5;
         */
        /* JADX WARN: Removed duplicated region for block: B:107:0x01f3  */
        @Override // android.view.accessibility.AccessibilityNodeProvider
        /*
            Code decompiled incorrectly, please refer to instructions dump.
        */
        public boolean performAction(int i, int i2, Bundle bundle) throws Resources.NotFoundException, NumberFormatException {
            ChatMessageCell chatMessageCell;
            int i3;
            TranscribeButton transcribeButton;
            ChatMessageCellDelegate chatMessageCellDelegate;
            ChatMessageCellDelegate chatMessageCellDelegate2;
            ChatMessageCell chatMessageCell2;
            TLRPC.User user;
            float f;
            float f2;
            boolean z;
            ChatMessageCellDelegate chatMessageCellDelegate3;
            ChatMessageCell chatMessageCell3;
            int i4;
            ClickableSpan linkById;
            if (i == -1) {
                ChatMessageCell.this.performAccessibilityAction(i2, bundle);
            } else {
                if (i2 == 64) {
                    chatMessageCell = ChatMessageCell.this;
                    i3 = LiteMode.FLAG_CHAT_SCALE;
                } else {
                    if (i2 == 16) {
                        if (i != 5000) {
                            if (i >= 3000) {
                                linkById = getLinkById(i, true);
                            } else if (i >= 2000) {
                                linkById = getLinkById(i, false);
                            } else if (i >= 1000) {
                                int i5 = i - 1000;
                                if (i5 >= ChatMessageCell.this.botButtons.size()) {
                                    return false;
                                }
                                BotButton botButton = (BotButton) ChatMessageCell.this.botButtons.get(i5);
                                if (ChatMessageCell.this.delegate != null && !botButton.isLocked) {
                                    if (botButton.buttonCustom != null) {
                                        ChatMessageCell.this.delegate.didPressCustomBotButton(ChatMessageCell.this, botButton.buttonCustom);
                                    } else if (botButton.button != null) {
                                        ChatMessageCell.this.delegate.didPressBotButton(ChatMessageCell.this, botButton.button);
                                    }
                                }
                            } else if (i >= 500) {
                                int i6 = i - 500;
                                if (i6 >= ChatMessageCell.this.pollButtons.size()) {
                                    return false;
                                }
                                PollButton pollButton = (PollButton) ChatMessageCell.this.pollButtons.get(i6);
                                if (ChatMessageCell.this.delegate != null) {
                                    ArrayList arrayList = new ArrayList();
                                    arrayList.add(pollButton.answer);
                                    ChatMessageCell.this.delegate.didPressVoteButtons(ChatMessageCell.this, arrayList, -1, 0, 0);
                                }
                            } else if (i == 495) {
                                if (ChatMessageCell.this.delegate != null) {
                                    ChatMessageCell.this.delegate.didPressHint(ChatMessageCell.this, 0);
                                }
                            } else if (i != 499) {
                                if (i != 492) {
                                    if (i != 491) {
                                        if (i == 490) {
                                            if (ChatMessageCell.this.delegate != null) {
                                                chatMessageCellDelegate3 = ChatMessageCell.this.delegate;
                                                chatMessageCell3 = ChatMessageCell.this;
                                                i4 = 31;
                                            }
                                        } else if (i == 489) {
                                            if (ChatMessageCell.this.delegate != null) {
                                                chatMessageCellDelegate3 = ChatMessageCell.this.delegate;
                                                chatMessageCell3 = ChatMessageCell.this;
                                                i4 = 30;
                                            }
                                        } else if (i == 498) {
                                            if (ChatMessageCell.this.delegate != null) {
                                                chatMessageCellDelegate = ChatMessageCell.this.delegate;
                                                chatMessageCellDelegate.didPressSideButton(ChatMessageCell.this);
                                            }
                                        } else if (i == 497) {
                                            if (ChatMessageCell.this.delegate != null) {
                                                ChatMessageCell chatMessageCell4 = ChatMessageCell.this;
                                                if (!chatMessageCell4.isThreadChat || chatMessageCell4.isMonoForum || chatMessageCell4.currentMessageObject.getReplyTopMsgId() != 0) {
                                                    if (!ChatMessageCell.this.currentMessageObject.hasValidReplyMessageObject()) {
                                                        ChatMessageCell chatMessageCell5 = ChatMessageCell.this;
                                                        if (chatMessageCell5.hasReplyQuote || (chatMessageCell5.currentMessageObject.messageOwner != null && ChatMessageCell.this.currentMessageObject.messageOwner.reply_to != null && ChatMessageCell.this.currentMessageObject.messageOwner.reply_to.reply_from != null)) {
                                                            ChatMessageCellDelegate chatMessageCellDelegate4 = ChatMessageCell.this.delegate;
                                                            ChatMessageCell chatMessageCell6 = ChatMessageCell.this;
                                                            chatMessageCellDelegate4.didPressReplyMessage(chatMessageCell6, chatMessageCell6.currentMessageObject.getReplyMsgId(), BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, false);
                                                        }
                                                    }
                                                }
                                            }
                                        } else if (i == 494) {
                                            if (ChatMessageCell.this.delegate != null) {
                                                if (ChatMessageCell.this.currentForwardChannel != null) {
                                                    ChatMessageCellDelegate chatMessageCellDelegate5 = ChatMessageCell.this.delegate;
                                                    ChatMessageCell chatMessageCell7 = ChatMessageCell.this;
                                                    chatMessageCellDelegate5.didPressChannelAvatar(chatMessageCell7, chatMessageCell7.currentForwardChannel, ChatMessageCell.this.currentMessageObject.messageOwner.fwd_from.channel_post, ChatMessageCell.this.lastTouchX, ChatMessageCell.this.lastTouchY, false);
                                                } else if (ChatMessageCell.this.currentForwardUser != null) {
                                                    chatMessageCellDelegate2 = ChatMessageCell.this.delegate;
                                                    chatMessageCell2 = ChatMessageCell.this;
                                                    user = chatMessageCell2.currentForwardUser;
                                                    f = ChatMessageCell.this.lastTouchX;
                                                    f2 = ChatMessageCell.this.lastTouchY;
                                                    z = false;
                                                    chatMessageCellDelegate2.didPressUserAvatar(chatMessageCell2, user, f, f2, z);
                                                } else if (ChatMessageCell.this.currentForwardName != null) {
                                                    ChatMessageCell.this.delegate.didPressHiddenForward(ChatMessageCell.this);
                                                }
                                            }
                                        } else if (i == 496) {
                                            if (ChatMessageCell.this.delegate != null) {
                                                ChatMessageCell chatMessageCell8 = ChatMessageCell.this;
                                                boolean z2 = chatMessageCell8.isRepliesChat;
                                                chatMessageCellDelegate = chatMessageCell8.delegate;
                                                if (z2) {
                                                    chatMessageCellDelegate.didPressSideButton(ChatMessageCell.this);
                                                } else {
                                                    chatMessageCellDelegate.didPressCommentButton(ChatMessageCell.this);
                                                }
                                            }
                                        } else if (i == 493 && (transcribeButton = ChatMessageCell.this.transcribeButton) != null) {
                                            transcribeButton.onTap();
                                        }
                                    }
                                }
                                chatMessageCellDelegate3.didPressInstantButton(chatMessageCell3, i4);
                            } else if (ChatMessageCell.this.delegate != null) {
                                chatMessageCellDelegate3 = ChatMessageCell.this.delegate;
                                chatMessageCell3 = ChatMessageCell.this;
                                i4 = chatMessageCell3.drawInstantViewType;
                                chatMessageCellDelegate3.didPressInstantButton(chatMessageCell3, i4);
                            }
                            ChatMessageCell.this.sendAccessibilityEventForVirtualView(i, 1);
                        } else if (ChatMessageCell.this.delegate != null) {
                            chatMessageCellDelegate2 = ChatMessageCell.this.delegate;
                            chatMessageCell2 = ChatMessageCell.this;
                            user = chatMessageCell2.currentUser;
                            f2 = BitmapDescriptorFactory.HUE_RED;
                            z = false;
                            f = BitmapDescriptorFactory.HUE_RED;
                            chatMessageCellDelegate2.didPressUserAvatar(chatMessageCell2, user, f, f2, z);
                        }
                    } else if (i2 == 32) {
                        ClickableSpan linkById2 = getLinkById(i, i >= 3000);
                        if (linkById2 != null && ChatMessageCell.this.delegate != null) {
                            ChatMessageCell.this.delegate.didPressUrl(ChatMessageCell.this, linkById2, true);
                            chatMessageCell = ChatMessageCell.this;
                            i3 = 2;
                        }
                    }
                }
                chatMessageCell.sendAccessibilityEventForVirtualView(i, i3);
            }
            return true;
        }
    }

    public class PollButton {
        public int animateHeight;
        private StaticLayout animateTitle;
        private AnimatedEmojiSpan.EmojiGroupedSpans animateTitleEmoji;
        public int animateY;
        public AnimatedEmojiSpan.EmojiGroupedSpans animatedEmoji;
        private TLRPC.PollAnswer answer;
        private Text author;
        private AvatarDrawable avatarDrawable;
        private ImageReceiver avatarImageReceiver;
        private boolean chosen;
        private boolean correct;
        private int count;
        private float decimal;
        public int height;
        private int percent;
        private float percentProgress;
        private boolean prevChosen;
        private int prevPercent;
        private float prevPercentProgress;
        public Drawable selectorDrawable;
        public int selectorDrawableColor;
        private TLRPC.TodoItem task;
        public StaticLayout title;
        public float titleX;
        public float titleY;
        private boolean translated;
        public int x;
        public int y;

        public PollButton() {
        }

        static /* synthetic */ TLRPC.PollAnswer access$1200(PollButton pollButton) {
            return pollButton.answer;
        }

        static /* synthetic */ TLRPC.PollAnswer access$1202(PollButton pollButton, TLRPC.PollAnswer pollAnswer) {
            pollButton.answer = pollAnswer;
            return pollAnswer;
        }

        static /* synthetic */ int access$1302(PollButton pollButton, int i) {
            pollButton.count = i;
            return i;
        }

        static /* synthetic */ TLRPC.TodoItem access$1400(PollButton pollButton) {
            return pollButton.task;
        }

        static /* synthetic */ TLRPC.TodoItem access$1402(PollButton pollButton, TLRPC.TodoItem todoItem) {
            pollButton.task = todoItem;
            return todoItem;
        }

        static /* synthetic */ boolean access$2700(PollButton pollButton) {
            return pollButton.chosen;
        }

        static /* synthetic */ boolean access$2702(PollButton pollButton, boolean z) {
            pollButton.chosen = z;
            return z;
        }

        static /* synthetic */ AvatarDrawable access$2800(PollButton pollButton) {
            return pollButton.avatarDrawable;
        }

        static /* synthetic */ AvatarDrawable access$2802(PollButton pollButton, AvatarDrawable avatarDrawable) {
            pollButton.avatarDrawable = avatarDrawable;
            return avatarDrawable;
        }

        static /* synthetic */ ImageReceiver access$2900(PollButton pollButton) {
            return pollButton.avatarImageReceiver;
        }

        static /* synthetic */ ImageReceiver access$2902(PollButton pollButton, ImageReceiver imageReceiver) {
            pollButton.avatarImageReceiver = imageReceiver;
            return imageReceiver;
        }

        static /* synthetic */ Text access$3000(PollButton pollButton) {
            return pollButton.author;
        }

        static /* synthetic */ Text access$3002(PollButton pollButton, Text text) {
            pollButton.author = text;
            return text;
        }

        static /* synthetic */ int access$3100(PollButton pollButton) {
            return pollButton.percent;
        }

        static /* synthetic */ int access$3102(PollButton pollButton, int i) {
            pollButton.percent = i;
            return i;
        }

        static /* synthetic */ int access$3112(PollButton pollButton, int i) {
            int i2 = pollButton.percent + i;
            pollButton.percent = i2;
            return i2;
        }

        static /* synthetic */ int access$3200(PollButton pollButton) {
            return pollButton.prevPercent;
        }

        static /* synthetic */ int access$3202(PollButton pollButton, int i) {
            pollButton.prevPercent = i;
            return i;
        }

        static /* synthetic */ float access$3300(PollButton pollButton) {
            return pollButton.percentProgress;
        }

        static /* synthetic */ float access$3302(PollButton pollButton, float f) {
            pollButton.percentProgress = f;
            return f;
        }

        static /* synthetic */ float access$3400(PollButton pollButton) {
            return pollButton.prevPercentProgress;
        }

        static /* synthetic */ float access$3402(PollButton pollButton, float f) {
            pollButton.prevPercentProgress = f;
            return f;
        }

        static /* synthetic */ boolean access$3500(PollButton pollButton) {
            return pollButton.translated;
        }

        static /* synthetic */ boolean access$3502(PollButton pollButton, boolean z) {
            pollButton.translated = z;
            return z;
        }

        static /* synthetic */ StaticLayout access$3600(PollButton pollButton) {
            return pollButton.animateTitle;
        }

        static /* synthetic */ StaticLayout access$3602(PollButton pollButton, StaticLayout staticLayout) {
            pollButton.animateTitle = staticLayout;
            return staticLayout;
        }

        static /* synthetic */ AnimatedEmojiSpan.EmojiGroupedSpans access$3700(PollButton pollButton) {
            return pollButton.animateTitleEmoji;
        }

        static /* synthetic */ AnimatedEmojiSpan.EmojiGroupedSpans access$3702(PollButton pollButton, AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans) {
            pollButton.animateTitleEmoji = emojiGroupedSpans;
            return emojiGroupedSpans;
        }

        static /* synthetic */ boolean access$3802(PollButton pollButton, boolean z) {
            pollButton.correct = z;
            return z;
        }

        static /* synthetic */ float access$3900(PollButton pollButton) {
            return pollButton.decimal;
        }

        static /* synthetic */ float access$3902(PollButton pollButton, float f) {
            pollButton.decimal = f;
            return f;
        }

        static /* synthetic */ float access$3924(PollButton pollButton, float f) {
            float f2 = pollButton.decimal - f;
            pollButton.decimal = f2;
            return f2;
        }

        static /* synthetic */ boolean access$4002(PollButton pollButton, boolean z) {
            pollButton.prevChosen = z;
            return z;
        }

        public void attach() {
            ImageReceiver imageReceiver = this.avatarImageReceiver;
            if (imageReceiver != null) {
                imageReceiver.onAttachedToWindow();
            }
        }

        public void destroy() {
            detach();
            AnimatedEmojiSpan.release(ChatMessageCell.this, this.animatedEmoji);
            this.animatedEmoji = null;
            AnimatedEmojiSpan.release(ChatMessageCell.this, this.animateTitleEmoji);
            this.animateTitleEmoji = null;
        }

        public void detach() {
            ImageReceiver imageReceiver = this.avatarImageReceiver;
            if (imageReceiver != null) {
                imageReceiver.onDetachedFromWindow();
            }
        }
    }

    public class TransitionParams {
        public boolean animateBackgroundBoundsInner;
        public boolean animateBackgroundWidth;
        boolean animateBotButtonsChanged;
        private boolean animateButton;
        public boolean animateChange;
        private int animateCommentArrowX;
        private boolean animateCommentDrawUnread;
        private int animateCommentUnreadX;
        private float animateCommentX;
        private boolean animateComments;
        private StaticLayout animateCommentsLayout;
        public boolean animateDrawAvatar;
        public boolean animateDrawBackground;
        private boolean animateDrawCommentNumber;
        public boolean animateDrawNameLayout;
        public boolean animateDrawTopic;
        public boolean animateDrawingSideMenuEnabled;
        public boolean animateDrawingTimeAlpha;
        private boolean animateEditedEnter;
        private StaticLayout animateEditedLayout;
        private int animateEditedWidthDiff;
        public boolean animateExpandedQuotes;
        public HashSet animateExpandedQuotesFrom;
        public boolean animateFactCheck;
        public boolean animateFactCheckExpanded;
        public boolean animateFactCheckHeight;
        public int animateFactCheckHeightFrom;
        int animateForwardNameWidth;
        float animateForwardNameX;
        public boolean animateForwardedLayout;
        public int animateForwardedNamesOffset;
        private float animateFromButtonX;
        private float animateFromButtonY;
        public int animateFromLinkPreviewHeight;
        public int animateFromLinkPreviewY;
        private int animateFromMediaOffsetY;
        public boolean animateFromRecommendationsExpanded;
        private float animateFromReplyTextHeight;
        public float animateFromReplyY;
        public float animateFromRoundVideoDotY;
        public float animateFromTextY;
        public int animateFromTimeX;
        public float animateFromTimeXPinned;
        private float animateFromTimeXReplies;
        private float animateFromTimeXViews;
        public int animateFromWidthForButton;
        public boolean animateLinkAbove;
        public boolean animateLinkPreviewHeight;
        public boolean animateLinkPreviewY;
        public boolean animateLocationIsExpired;
        public boolean animateMediaAbove;
        private boolean animateMediaOffsetY;
        public boolean animateMessageText;
        public boolean animateMonoforumPadding;
        public int animateMonoforumPaddingFrom;
        private float animateNameX;
        public boolean animateNamesOffset;
        public int animateNamesOffsetFrom;
        private AnimatedEmojiSpan.EmojiGroupedSpans animateOutAnimateEmoji;
        private AnimatedEmojiSpan.EmojiGroupedSpans animateOutAnimateEmojiReply;
        private MessageObject.TextLayoutBlocks animateOutCaptionLayout;
        private ArrayList animateOutTextBlocks;
        private float animateOutTextXOffset;
        private boolean animatePinned;
        public boolean animatePlayingRound;
        public boolean animateRadius;
        public boolean animateRecommendationsExpanded;
        boolean animateReplaceCaptionLayout;
        private boolean animateReplies;
        private StaticLayout animateRepliesLayout;
        private StaticLayout animateReplyTextLayout;
        public float animateReplyTextOffset;
        public boolean animateReplyY;
        public boolean animateRoundVideoDotY;
        private boolean animateShouldDrawMenuDrawable;
        private boolean animateShouldDrawTimeOnMedia;
        private boolean animateSign;
        public boolean animateSmallImage;
        public boolean animateText;
        private StaticLayout animateTimeLayout;
        private int animateTimeWidth;
        public StaticLayout animateTitleLayout;
        private AnimatedEmojiSpan.EmojiGroupedSpans animateTitleLayoutEmoji;
        public float animateToImageH;
        public float animateToImageW;
        public float animateToImageX;
        public float animateToImageY;
        public int[] animateToRadius;
        private int animateTotalCommentWidth;
        public boolean animateUseTranscribeButton;
        private StaticLayout animateViewsLayout;
        public boolean animateWidthForButton;
        public float captionFromX;
        public float captionFromY;
        public float deltaBottom;
        public float deltaLeft;
        public float deltaRight;
        public float deltaTop;
        public boolean drawPinnedBottomBackground;
        public boolean ignoreAlpha;
        public boolean imageChangeBoundsTransition;
        public int lastBackgroundLeft;
        public int lastBackgroundRight;
        public float lastButtonX;
        public float lastButtonY;
        public int lastCommentArrowX;
        public boolean lastCommentDrawUnread;
        public StaticLayout lastCommentLayout;
        public int lastCommentUnreadX;
        public float lastCommentX;
        public int lastCommentsCount;
        public boolean lastDrawAvatar;
        public boolean lastDrawBackground;
        public boolean lastDrawCommentNumber;
        public StaticLayout lastDrawDocTitleLayout;
        public StaticLayout lastDrawInfoLayout;
        public float lastDrawLocationExpireProgress;
        public String lastDrawLocationExpireText;
        public boolean lastDrawNameLayout;
        public float lastDrawReplyY;
        public float lastDrawRoundVideoDotY;
        public boolean lastDrawTime;
        public boolean lastDrawTopic;
        public MessageObject.TextLayoutBlocks lastDrawingCaptionLayout;
        public float lastDrawingCaptionX;
        public float lastDrawingCaptionY;
        public boolean lastDrawingEdited;
        public HashSet lastDrawingExpandedQuotes;
        public boolean lastDrawingFactCheck;
        public boolean lastDrawingFactCheckExpanded;
        public int lastDrawingFactCheckHeight;
        public float lastDrawingImageH;
        public float lastDrawingImageW;
        public float lastDrawingImageX;
        public float lastDrawingImageY;
        public boolean lastDrawingLinkAbove;
        public int lastDrawingLinkPreviewHeight;
        public int lastDrawingLinkPreviewY;
        public boolean lastDrawingMediaAbove;
        public boolean lastDrawingRecommendationsExpanded;
        public float lastDrawingReplyTextHeight;
        public boolean lastDrawingSideMenuEnabled;
        public boolean lastDrawingSmallImage;
        public ArrayList lastDrawingTextBlocks;
        private int lastDrawingTextWidth;
        public float lastDrawingTextX;
        public float lastDrawingTextY;
        public boolean lastDrawnForwardedName;
        public int lastDrawnMonoforumPadding;
        public StaticLayout lastDrawnReplyTextLayout;
        public StaticLayout lastDrawnTitleLayout;
        public boolean lastDrawnTranslated;
        public int lastDrawnWidthForButtons;
        public int lastForwardNameWidth;
        public float lastForwardNameX;
        public int lastForwardedNamesOffset;
        public boolean lastIsPinned;
        public boolean lastIsPlayingRound;
        public boolean lastLocatinIsExpired;
        public int lastMediaOffsetY;
        public int lastNamesOffset;
        public int lastRepliesCount;
        public StaticLayout lastRepliesLayout;
        public int lastReplyTextXOffset;
        public boolean lastShouldDrawMenuDrawable;
        public boolean lastShouldDrawTimeOnMedia;
        public String lastSignMessage;
        public float lastTextXOffset;
        public StaticLayout lastTimeLayout;
        public int lastTimeWidth;
        public int lastTimeX;
        public float lastTimeXPinned;
        private float lastTimeXReplies;
        private float lastTimeXViews;
        public int lastTopOffset;
        public int lastTotalCommentWidth;
        public boolean lastUseTranscribeButton;
        public int lastViewsCount;
        public StaticLayout lastViewsLayout;
        public boolean messageEntering;
        private boolean moveCaption;
        public boolean needsStopClipping;
        public float photoImageFromCenterX;
        public float photoImageFromCenterY;
        public float photoImageFromHeight;
        public float photoImageFromWidth;
        public boolean shouldAnimateTimeX;
        public float toDeltaLeft;
        public float toDeltaRight;
        public boolean transformGroupToSingleMessage;
        public boolean updatePhotoImageX;
        public boolean wasDraw;
        public int[] imageRoundRadius = new int[4];
        public float captionEnterProgress = 1.0f;
        public float changePinnedBottomProgress = 1.0f;
        public Rect lastDrawingBackgroundRect = new Rect();
        public float animateChangeProgress = 1.0f;
        private ArrayList lastDrawBotButtons = new ArrayList();
        private ArrayList transitionBotButtons = new ArrayList();
        public int lastStatusDrawableParams = -1;
        public StaticLayout[] lastDrawnForwardedNameLayout = new StaticLayout[2];
        public StaticLayout[] animatingForwardedNameLayout = new StaticLayout[2];

        public TransitionParams() {
        }

        /* JADX WARN: Code restructure failed: missing block: B:158:0x0377, code lost:
        
            if (r24.lastDrawingCaptionY == r24.this$0.captionY) goto L179;
         */
        /* JADX WARN: Code restructure failed: missing block: B:177:0x03c6, code lost:
        
            if (r24.lastDrawingCaptionY == r24.this$0.captionY) goto L179;
         */
        /* JADX WARN: Removed duplicated region for block: B:144:0x0349  */
        /* JADX WARN: Removed duplicated region for block: B:160:0x037a  */
        /* JADX WARN: Removed duplicated region for block: B:181:0x03db  */
        /* JADX WARN: Removed duplicated region for block: B:183:0x03e7  */
        /* JADX WARN: Removed duplicated region for block: B:185:0x03f9  */
        /* JADX WARN: Removed duplicated region for block: B:188:0x03ff  */
        /* JADX WARN: Removed duplicated region for block: B:206:0x0471  */
        /* JADX WARN: Removed duplicated region for block: B:209:0x0482  */
        /* JADX WARN: Removed duplicated region for block: B:212:0x0491  */
        /* JADX WARN: Removed duplicated region for block: B:216:0x04a2  */
        /* JADX WARN: Removed duplicated region for block: B:223:0x04d1  */
        /* JADX WARN: Removed duplicated region for block: B:226:0x04de  */
        /* JADX WARN: Removed duplicated region for block: B:227:0x04e5  */
        /* JADX WARN: Removed duplicated region for block: B:230:0x04ea  */
        /* JADX WARN: Removed duplicated region for block: B:232:0x04f0  */
        /* JADX WARN: Removed duplicated region for block: B:237:0x050a  */
        /* JADX WARN: Removed duplicated region for block: B:242:0x052a  */
        /* JADX WARN: Removed duplicated region for block: B:249:0x0551  */
        /* JADX WARN: Removed duplicated region for block: B:253:0x057c  */
        /* JADX WARN: Removed duplicated region for block: B:256:0x0591  */
        /* JADX WARN: Removed duplicated region for block: B:258:0x0597  */
        /* JADX WARN: Removed duplicated region for block: B:269:0x05e9  */
        /* JADX WARN: Removed duplicated region for block: B:272:0x05f5  */
        /* JADX WARN: Removed duplicated region for block: B:275:0x0601  */
        /* JADX WARN: Removed duplicated region for block: B:278:0x060f  */
        /* JADX WARN: Removed duplicated region for block: B:281:0x061c  */
        /* JADX WARN: Removed duplicated region for block: B:284:0x062d  */
        /* JADX WARN: Removed duplicated region for block: B:287:0x063e  */
        /* JADX WARN: Removed duplicated region for block: B:290:0x064a  */
        /* JADX WARN: Removed duplicated region for block: B:292:0x064d  */
        /* JADX WARN: Removed duplicated region for block: B:295:0x065a  */
        /* JADX WARN: Removed duplicated region for block: B:298:0x0667  */
        /* JADX WARN: Removed duplicated region for block: B:301:0x0675  */
        /* JADX WARN: Removed duplicated region for block: B:304:0x0684  */
        /* JADX WARN: Removed duplicated region for block: B:308:0x06ae  */
        /* JADX WARN: Removed duplicated region for block: B:310:0x06b6  */
        /* JADX WARN: Removed duplicated region for block: B:313:0x06ca  */
        /* JADX WARN: Removed duplicated region for block: B:316:0x06d7  */
        /* JADX WARN: Removed duplicated region for block: B:328:0x0708  */
        /* JADX WARN: Removed duplicated region for block: B:335:0x0721  */
        /* JADX WARN: Removed duplicated region for block: B:338:0x072d  */
        /* JADX WARN: Removed duplicated region for block: B:341:0x0732  */
        /* JADX WARN: Removed duplicated region for block: B:47:0x00eb  */
        /* JADX WARN: Removed duplicated region for block: B:48:0x0111  */
        /*
            Code decompiled incorrectly, please refer to instructions dump.
        */
        public boolean animateChange() {
            boolean z;
            int i;
            int i2;
            boolean z2;
            ChatMessageCell chatMessageCell;
            boolean z3;
            float f;
            ChatMessageCell chatMessageCell2;
            int i3;
            ChatMessageCell chatMessageCell3;
            StaticLayout staticLayout;
            StaticLayout staticLayout2;
            ChannelRecommendationsCell channelRecommendationsCell;
            if (!this.wasDraw) {
                return false;
            }
            this.needsStopClipping = false;
            this.animateDrawingSideMenuEnabled = false;
            boolean z4 = this.lastDrawingSideMenuEnabled;
            ChatMessageCell chatMessageCell4 = ChatMessageCell.this;
            if (z4 != chatMessageCell4.isSideMenuEnabled) {
                this.animateDrawingSideMenuEnabled = true;
                z = true;
            } else {
                z = false;
            }
            this.animateMessageText = false;
            if (chatMessageCell4.currentMessageObject.textLayoutBlocks != this.lastDrawingTextBlocks) {
                boolean z5 = ChatMessageCell.this.currentMessageObject.textWidth == this.lastDrawingTextWidth || this.lastDrawingSideMenuEnabled == ChatMessageCell.this.isSideMenuEnabled;
                if (ChatMessageCell.this.currentMessageObject.textLayoutBlocks == null || this.lastDrawingTextBlocks == null || ChatMessageCell.this.currentMessageObject.textLayoutBlocks.size() != this.lastDrawingTextBlocks.size()) {
                    z5 = false;
                    if (z5) {
                        this.animateMessageText = true;
                        ArrayList arrayList = this.lastDrawingTextBlocks;
                        this.animateOutTextBlocks = arrayList;
                        this.animateOutTextXOffset = this.lastTextXOffset;
                        this.animateOutAnimateEmoji = AnimatedEmojiSpan.update(0, (View) ChatMessageCell.this, this.animateOutAnimateEmoji, (ArrayList<MessageObject.TextLayoutBlock>) arrayList, true);
                        ChatMessageCell chatMessageCell5 = ChatMessageCell.this;
                        chatMessageCell5.animatedEmojiStack = AnimatedEmojiSpan.update(0, chatMessageCell5, chatMessageCell5.animatedEmojiStack, chatMessageCell5.currentMessageObject.textLayoutBlocks);
                        z = true;
                    } else {
                        ChatMessageCell chatMessageCell6 = ChatMessageCell.this;
                        chatMessageCell6.animatedEmojiStack = AnimatedEmojiSpan.update(0, chatMessageCell6, chatMessageCell6.animatedEmojiStack, chatMessageCell6.currentMessageObject.textLayoutBlocks);
                    }
                } else {
                    for (int i4 = 0; i4 < this.lastDrawingTextBlocks.size(); i4++) {
                        String string = ChatMessageCell.this.currentMessageObject.textLayoutBlocks.get(i4).textLayout == null ? null : ChatMessageCell.this.currentMessageObject.textLayoutBlocks.get(i4).textLayout.getText().toString();
                        String string2 = ((MessageObject.TextLayoutBlock) this.lastDrawingTextBlocks.get(i4)).textLayout == null ? null : ((MessageObject.TextLayoutBlock) this.lastDrawingTextBlocks.get(i4)).textLayout.getText().toString();
                        if ((string == null && string2 != null) || ((string != null && string2 == null) || !string.equals(string2))) {
                            z5 = false;
                            break;
                        }
                        ChatMessageCell chatMessageCell7 = ChatMessageCell.this;
                        AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans = chatMessageCell7.animatedEmojiStack;
                        if (emojiGroupedSpans != null) {
                            emojiGroupedSpans.replaceLayout(chatMessageCell7.currentMessageObject.textLayoutBlocks.get(i4).textLayout, ((MessageObject.TextLayoutBlock) this.lastDrawingTextBlocks.get(i4)).textLayout);
                        }
                    }
                    if (z5) {
                    }
                }
            }
            this.animateDrawNameLayout = false;
            if (ChatMessageCell.this.drawNameLayout != this.lastDrawNameLayout) {
                this.animateDrawNameLayout = true;
                z = true;
            }
            this.animateDrawAvatar = false;
            if (ChatMessageCell.this.drawNameAvatar != this.lastDrawAvatar) {
                this.animateDrawAvatar = true;
                z = true;
            }
            this.animateDrawTopic = false;
            if (ChatMessageCell.this.drawTopic != this.lastDrawTopic) {
                this.animateDrawTopic = true;
                z = true;
            }
            StaticLayout staticLayout3 = ChatMessageCell.this.replyTextLayout;
            if (staticLayout3 != this.lastDrawnReplyTextLayout) {
                CharSequence text = staticLayout3 != null ? staticLayout3.getText() : null;
                StaticLayout staticLayout4 = this.lastDrawnReplyTextLayout;
                if (!TextUtils.equals(text, staticLayout4 != null ? staticLayout4.getText() : null)) {
                    this.animateFromReplyTextHeight = this.lastDrawingReplyTextHeight;
                    StaticLayout staticLayout5 = this.lastDrawnReplyTextLayout;
                    this.animateReplyTextLayout = staticLayout5;
                    this.animateReplyTextOffset = this.lastReplyTextXOffset;
                    this.animateOutAnimateEmojiReply = AnimatedEmojiSpan.update(0, (View) ChatMessageCell.this, false, this.animateOutAnimateEmojiReply, true, staticLayout5);
                    z = true;
                }
            }
            if (ChatMessageCell.this.edited && !this.lastDrawingEdited && ChatMessageCell.this.timeLayout != null) {
                String string3 = LocaleController.getString("EditedMessage", R.string.EditedMessage);
                CharSequence text2 = ChatMessageCell.this.timeLayout.getText();
                int iIndexOf = text2.toString().indexOf(string3);
                if (iIndexOf >= 0) {
                    if (iIndexOf == 0) {
                        TextPaint textPaint = Theme.chat_timePaint;
                        int iDp = ChatMessageCell.this.timeTextWidth + AndroidUtilities.dp(100.0f);
                        Layout.Alignment alignment = Layout.Alignment.ALIGN_NORMAL;
                        this.animateEditedLayout = new StaticLayout(string3, textPaint, iDp, alignment, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                        SpannableStringBuilder spannableStringBuilder = new SpannableStringBuilder();
                        spannableStringBuilder.append((CharSequence) string3);
                        spannableStringBuilder.append(text2.subSequence(string3.length(), text2.length()));
                        spannableStringBuilder.setSpan(new EmptyStubSpan(), 0, string3.length(), 0);
                        this.animateTimeLayout = new StaticLayout(spannableStringBuilder, Theme.chat_timePaint, ChatMessageCell.this.timeTextWidth + AndroidUtilities.dp(100.0f), alignment, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                        this.animateEditedWidthDiff = ChatMessageCell.this.timeWidth - this.lastTimeWidth;
                    } else {
                        this.animateEditedWidthDiff = 0;
                        this.animateEditedLayout = null;
                        this.animateTimeLayout = this.lastTimeLayout;
                    }
                    this.animateEditedEnter = true;
                    this.animateTimeWidth = this.lastTimeWidth;
                    this.animateFromTimeX = this.lastTimeX;
                    this.shouldAnimateTimeX = true;
                    z = true;
                }
                ChatMessageCell.this.accessibilityText = null;
            } else if (!ChatMessageCell.this.edited && this.lastDrawingEdited) {
                ChatMessageCell chatMessageCell8 = ChatMessageCell.this;
                if (chatMessageCell8.timeLayout != null) {
                    this.animateTimeLayout = this.lastTimeLayout;
                    int i5 = chatMessageCell8.timeWidth;
                    int i6 = this.lastTimeWidth;
                    this.animateEditedWidthDiff = i5 - i6;
                    this.animateEditedEnter = true;
                    this.animateTimeWidth = i6;
                    this.animateFromTimeX = this.lastTimeX;
                    this.shouldAnimateTimeX = true;
                    z = true;
                }
            }
            this.animateDrawBackground = false;
            if (ChatMessageCell.this.drawBackground != this.lastDrawBackground) {
                this.animateDrawBackground = true;
                z = true;
            }
            this.animateSmallImage = false;
            if (ChatMessageCell.this.isSmallImage != this.lastDrawingSmallImage) {
                this.animateSmallImage = true;
                float f2 = this.lastDrawingImageW;
                this.photoImageFromWidth = f2;
                float f3 = this.lastDrawingImageH;
                this.photoImageFromHeight = f3;
                this.photoImageFromCenterX = this.lastDrawingImageX + (f2 / 2.0f);
                this.photoImageFromCenterY = this.lastDrawingImageY + (f3 / 2.0f);
                z = true;
            }
            this.animateMonoforumPadding = false;
            ChatMessageCell chatMessageCell9 = ChatMessageCell.this;
            int i7 = chatMessageCell9.topicSeparatorTopPadding;
            int i8 = this.lastDrawnMonoforumPadding;
            if (i7 != i8) {
                this.needsStopClipping = true;
                this.animateMonoforumPaddingFrom = i8;
                this.animateMonoforumPadding = true;
                z = true;
            }
            this.animateRecommendationsExpanded = false;
            boolean z6 = chatMessageCell9.currentMessageObject.type == 27 && (channelRecommendationsCell = ChatMessageCell.this.channelRecommendationsCell) != null && channelRecommendationsCell.isExpanded();
            boolean z7 = this.lastDrawingRecommendationsExpanded;
            if (z6 != z7) {
                this.animateRecommendationsExpanded = true;
                this.animateFromRecommendationsExpanded = z7;
                z = true;
            }
            this.animateLinkAbove = false;
            ChatMessageCell chatMessageCell10 = ChatMessageCell.this;
            if (chatMessageCell10.linkPreviewAbove != this.lastDrawingLinkAbove) {
                this.animateLinkAbove = true;
                z = true;
            }
            this.animateMediaAbove = false;
            if (chatMessageCell10.captionAbove != this.lastDrawingMediaAbove) {
                this.animateMediaAbove = true;
                z = true;
            }
            this.animateLinkPreviewHeight = false;
            if (chatMessageCell10.hasLinkPreview) {
                int i9 = ChatMessageCell.this.linkPreviewHeight;
                int i10 = this.lastDrawingLinkPreviewHeight;
                if (i9 != i10) {
                    this.animateLinkPreviewHeight = true;
                    this.animateFromLinkPreviewHeight = i10;
                    z = true;
                }
            }
            this.animateUseTranscribeButton = false;
            if (ChatMessageCell.this.useTranscribeButton != this.lastUseTranscribeButton) {
                this.animateUseTranscribeButton = true;
                z = true;
            }
            ChatMessageCell chatMessageCell11 = ChatMessageCell.this;
            MessageObject.TextLayoutBlocks textLayoutBlocks = chatMessageCell11.captionLayout;
            MessageObject.TextLayoutBlocks textLayoutBlocks2 = this.lastDrawingCaptionLayout;
            if (textLayoutBlocks == textLayoutBlocks2) {
                if (textLayoutBlocks != null && textLayoutBlocks2 != null) {
                    chatMessageCell11.updateCaptionLayout();
                    if (this.lastDrawingCaptionX == ChatMessageCell.this.captionX) {
                    }
                    this.moveCaption = true;
                    this.captionFromX = this.lastDrawingCaptionX;
                    this.captionFromY = this.lastDrawingCaptionY;
                }
                if (!this.lastDrawBotButtons.isEmpty()) {
                    if (this.lastDrawBotButtons.size() != ChatMessageCell.this.botButtons.size()) {
                    }
                    if (!this.animateBotButtonsChanged) {
                    }
                    if (this.animateBotButtonsChanged) {
                    }
                }
                if (this.lastDrawnWidthForButtons != ChatMessageCell.this.widthForButtons) {
                }
                if (ChatMessageCell.this.documentAttachType == 5) {
                    this.animateFromButtonX = this.lastButtonX;
                    this.animateFromButtonY = this.lastButtonY;
                    this.animateButton = true;
                    z = true;
                } else {
                    this.animateFromButtonX = this.lastButtonX;
                    this.animateFromButtonY = this.lastButtonY;
                    this.animateButton = true;
                    z = true;
                }
                i = ChatMessageCell.this.mediaOffsetY;
                i2 = this.lastMediaOffsetY;
                if (i != i2) {
                }
                z2 = this.lastIsPinned;
                chatMessageCell = ChatMessageCell.this;
                if (z2 != chatMessageCell.isPinned) {
                }
                if (this.lastRepliesLayout != null) {
                    this.animateRepliesLayout = this.lastRepliesLayout;
                    this.animateReplies = true;
                    ChatMessageCell.this.accessibilityText = null;
                    z = true;
                    z3 = true;
                } else {
                    this.animateRepliesLayout = this.lastRepliesLayout;
                    this.animateReplies = true;
                    ChatMessageCell.this.accessibilityText = null;
                    z = true;
                    z3 = true;
                }
                if (this.lastViewsLayout != null) {
                    this.animateViewsLayout = this.lastViewsLayout;
                    ChatMessageCell.this.accessibilityText = null;
                    z = true;
                    z3 = true;
                }
                if (ChatMessageCell.this.commentLayout != null) {
                    staticLayout2 = this.lastCommentLayout;
                    if (staticLayout2 != null) {
                        this.animateCommentsLayout = null;
                        this.animateTotalCommentWidth = this.lastTotalCommentWidth;
                        this.animateCommentX = this.lastCommentX;
                        this.animateCommentArrowX = this.lastCommentArrowX;
                        this.animateCommentUnreadX = this.lastCommentUnreadX;
                        this.animateCommentDrawUnread = this.lastCommentDrawUnread;
                        this.animateDrawCommentNumber = this.lastDrawCommentNumber;
                        this.animateComments = true;
                        z = true;
                    }
                }
                if (!TextUtils.equals(this.lastSignMessage, ChatMessageCell.this.lastPostAuthor)) {
                }
                if (this.lastDrawTime == ChatMessageCell.this.forceNotDrawTime) {
                }
                z = true;
                if (this.lastShouldDrawMenuDrawable != ChatMessageCell.this.shouldDrawMenuDrawable()) {
                }
                if (this.lastLocatinIsExpired != ChatMessageCell.this.locationExpired) {
                }
                if (this.lastIsPlayingRound != ChatMessageCell.this.isPlayingRound) {
                }
                f = this.lastDrawingTextY;
                chatMessageCell2 = ChatMessageCell.this;
                if (f != chatMessageCell2.textY) {
                }
                if (this.lastDrawingLinkPreviewY != chatMessageCell2.linkPreviewY) {
                }
                if (this.lastDrawingFactCheckHeight != ChatMessageCell.this.factCheckHeight) {
                }
                if (this.lastDrawingFactCheckExpanded != (ChatMessageCell.this.getPrimaryMessageObject() == null && ChatMessageCell.this.getPrimaryMessageObject().factCheckExpanded)) {
                }
                if (this.lastDrawingFactCheck != ChatMessageCell.this.hasFactCheck) {
                }
                if (!MessageObject.expandedQuotesEquals(this.lastDrawingExpandedQuotes, ChatMessageCell.this.currentMessageObject != null ? ChatMessageCell.this.currentMessageObject.expandedQuotes : null)) {
                }
                if (ChatMessageCell.this.currentMessageObject != null) {
                }
                ChatMessageCell.this.updateReactionLayoutPosition();
                if (ChatMessageCell.this.reactionsLayoutInBubble.animateChange()) {
                }
                if (ChatMessageCell.this.currentMessageObject.isRoundVideo()) {
                }
                chatMessageCell3 = ChatMessageCell.this;
                if (chatMessageCell3.replyNameLayout != null) {
                }
                if ((chatMessageCell3.currentMessageObject != null && ChatMessageCell.this.currentMessageObject.translated) != this.lastDrawnTranslated) {
                }
                return z;
            }
            String string4 = textLayoutBlocks2 == null ? null : textLayoutBlocks2.text.toString();
            MessageObject.TextLayoutBlocks textLayoutBlocks3 = ChatMessageCell.this.captionLayout;
            String string5 = textLayoutBlocks3 == null ? null : textLayoutBlocks3.text.toString();
            boolean z8 = this.lastDrawingSideMenuEnabled;
            ChatMessageCell chatMessageCell12 = ChatMessageCell.this;
            if (z8 == chatMessageCell12.isSideMenuEnabled) {
                if ((string5 == null) == (string4 == null) && (string4 == null || string4.equals(string5))) {
                    ChatMessageCell.this.updateCaptionLayout();
                    if (this.lastDrawingCaptionX == ChatMessageCell.this.captionX) {
                    }
                } else {
                    this.animateReplaceCaptionLayout = true;
                    MessageObject.TextLayoutBlocks textLayoutBlocks4 = this.lastDrawingCaptionLayout;
                    this.animateOutCaptionLayout = textLayoutBlocks4;
                    this.animateOutAnimateEmoji = AnimatedEmojiSpan.update(0, ChatMessageCell.this, (AnimatedEmojiSpan.EmojiGroupedSpans) null, textLayoutBlocks4 == null ? null : textLayoutBlocks4.textLayoutBlocks);
                    ChatMessageCell chatMessageCell13 = ChatMessageCell.this;
                    AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans2 = chatMessageCell13.animatedEmojiStack;
                    MessageObject.TextLayoutBlocks textLayoutBlocks5 = chatMessageCell13.captionLayout;
                    chatMessageCell13.animatedEmojiStack = AnimatedEmojiSpan.update(0, chatMessageCell13, emojiGroupedSpans2, textLayoutBlocks5 == null ? null : textLayoutBlocks5.textLayoutBlocks);
                    if (this.lastDrawingSideMenuEnabled != ChatMessageCell.this.isSideMenuEnabled) {
                    }
                }
                this.moveCaption = true;
                this.captionFromX = this.lastDrawingCaptionX;
                this.captionFromY = this.lastDrawingCaptionY;
            } else {
                MessageObject.TextLayoutBlocks textLayoutBlocks6 = chatMessageCell12.captionLayout;
                int i11 = textLayoutBlocks6 == null ? 0 : textLayoutBlocks6.textWidth;
                MessageObject.TextLayoutBlocks textLayoutBlocks7 = this.lastDrawingCaptionLayout;
                if (i11 == (textLayoutBlocks7 == null ? 0 : textLayoutBlocks7.textWidth)) {
                }
            }
            if (!this.lastDrawBotButtons.isEmpty() || !ChatMessageCell.this.botButtons.isEmpty()) {
                if (this.lastDrawBotButtons.size() != ChatMessageCell.this.botButtons.size()) {
                    this.animateBotButtonsChanged = true;
                }
                if (!this.animateBotButtonsChanged) {
                    for (int i12 = 0; i12 < ChatMessageCell.this.botButtons.size(); i12++) {
                        BotButton botButton = (BotButton) ChatMessageCell.this.botButtons.get(i12);
                        BotButton botButton2 = (BotButton) this.lastDrawBotButtons.get(i12);
                        if (!botButton.isSeparator && !botButton2.isSeparator && (Math.abs(botButton.x - botButton2.x) > 0.01f || Math.abs(botButton.width - botButton2.width) > 0.01f || !TextUtils.equals(botButton.title.getText(), botButton2.title.getText()))) {
                            this.animateBotButtonsChanged = true;
                            break;
                        }
                    }
                }
                if (this.animateBotButtonsChanged) {
                    this.transitionBotButtons.addAll(this.lastDrawBotButtons);
                }
            }
            if (this.lastDrawnWidthForButtons != ChatMessageCell.this.widthForButtons) {
                this.animateFromWidthForButton = this.lastDrawnWidthForButtons;
                this.animateWidthForButton = true;
            }
            if ((ChatMessageCell.this.documentAttachType == 5 || ChatMessageCell.this.documentAttachType == 3 || ChatMessageCell.this.documentAttachType == 1) && (ChatMessageCell.this.buttonX != this.lastButtonX || ChatMessageCell.this.buttonY != this.lastButtonY)) {
                this.animateFromButtonX = this.lastButtonX;
                this.animateFromButtonY = this.lastButtonY;
                this.animateButton = true;
                z = true;
            }
            i = ChatMessageCell.this.mediaOffsetY;
            i2 = this.lastMediaOffsetY;
            if (i != i2) {
                this.animateFromMediaOffsetY = i2;
                this.animateMediaOffsetY = true;
                z = true;
            }
            z2 = this.lastIsPinned;
            chatMessageCell = ChatMessageCell.this;
            if (z2 != chatMessageCell.isPinned) {
                this.animatePinned = true;
                chatMessageCell.accessibilityText = null;
                z = true;
                z3 = true;
            } else {
                z3 = false;
            }
            if ((this.lastRepliesLayout != null || chatMessageCell.repliesLayout != null) && this.lastRepliesCount != ChatMessageCell.this.getRepliesCount()) {
                this.animateRepliesLayout = this.lastRepliesLayout;
                this.animateReplies = true;
                ChatMessageCell.this.accessibilityText = null;
                z = true;
                z3 = true;
            }
            if (this.lastViewsLayout != null && this.lastViewsCount != ChatMessageCell.this.getMessageObject().messageOwner.views) {
                this.animateViewsLayout = this.lastViewsLayout;
                ChatMessageCell.this.accessibilityText = null;
                z = true;
                z3 = true;
            }
            if (ChatMessageCell.this.commentLayout != null && this.lastCommentsCount != ChatMessageCell.this.getRepliesCount()) {
                staticLayout2 = this.lastCommentLayout;
                if (staticLayout2 != null || TextUtils.equals(staticLayout2.getText(), ChatMessageCell.this.commentLayout.getText())) {
                    this.animateCommentsLayout = null;
                } else {
                    this.animateCommentsLayout = this.lastCommentLayout;
                }
                this.animateTotalCommentWidth = this.lastTotalCommentWidth;
                this.animateCommentX = this.lastCommentX;
                this.animateCommentArrowX = this.lastCommentArrowX;
                this.animateCommentUnreadX = this.lastCommentUnreadX;
                this.animateCommentDrawUnread = this.lastCommentDrawUnread;
                this.animateDrawCommentNumber = this.lastDrawCommentNumber;
                this.animateComments = true;
                z = true;
            }
            if (!TextUtils.equals(this.lastSignMessage, ChatMessageCell.this.lastPostAuthor)) {
                this.animateSign = true;
                this.animateNameX = ChatMessageCell.this.nameX;
                z = true;
            }
            if (this.lastDrawTime == ChatMessageCell.this.forceNotDrawTime) {
                this.animateDrawingTimeAlpha = true;
                this.animateViewsLayout = null;
            } else {
                if (this.lastShouldDrawTimeOnMedia == ChatMessageCell.this.shouldDrawTimeOnMedia()) {
                    if (z3 || (Math.abs(ChatMessageCell.this.timeX - this.lastTimeX) > 1 && this.lastDrawingSideMenuEnabled == ChatMessageCell.this.isSideMenuEnabled)) {
                        this.shouldAnimateTimeX = true;
                        this.animateTimeWidth = this.lastTimeWidth;
                        this.animateFromTimeX = this.lastTimeX;
                        this.animateFromTimeXViews = this.lastTimeXViews;
                        this.animateFromTimeXReplies = this.lastTimeXReplies;
                        this.animateFromTimeXPinned = this.lastTimeXPinned;
                    }
                    if (this.lastShouldDrawMenuDrawable != ChatMessageCell.this.shouldDrawMenuDrawable()) {
                        this.animateShouldDrawMenuDrawable = true;
                    }
                    if (this.lastLocatinIsExpired != ChatMessageCell.this.locationExpired) {
                        this.animateLocationIsExpired = true;
                    }
                    if (this.lastIsPlayingRound != ChatMessageCell.this.isPlayingRound) {
                        this.animatePlayingRound = true;
                        z = true;
                    }
                    f = this.lastDrawingTextY;
                    chatMessageCell2 = ChatMessageCell.this;
                    if (f != chatMessageCell2.textY) {
                        this.animateText = true;
                        this.animateFromTextY = f;
                        z = true;
                    }
                    if (this.lastDrawingLinkPreviewY != chatMessageCell2.linkPreviewY) {
                        this.animateLinkPreviewY = true;
                        this.animateFromLinkPreviewY = this.lastDrawingLinkPreviewY;
                        z = true;
                    }
                    if (this.lastDrawingFactCheckHeight != ChatMessageCell.this.factCheckHeight) {
                        this.animateFactCheckHeight = true;
                        this.animateFactCheckHeightFrom = this.lastDrawingFactCheckHeight;
                        z = true;
                    }
                    if (this.lastDrawingFactCheckExpanded != (ChatMessageCell.this.getPrimaryMessageObject() == null && ChatMessageCell.this.getPrimaryMessageObject().factCheckExpanded)) {
                        this.animateFactCheckExpanded = true;
                        z = true;
                    }
                    if (this.lastDrawingFactCheck != ChatMessageCell.this.hasFactCheck) {
                        this.animateFactCheck = true;
                        z = true;
                    }
                    if (!MessageObject.expandedQuotesEquals(this.lastDrawingExpandedQuotes, ChatMessageCell.this.currentMessageObject != null ? ChatMessageCell.this.currentMessageObject.expandedQuotes : null)) {
                        this.animateExpandedQuotes = true;
                        this.animateExpandedQuotesFrom = this.lastDrawingExpandedQuotes;
                        z = true;
                    }
                    if (ChatMessageCell.this.currentMessageObject != null || this.lastDrawnForwardedName == ChatMessageCell.this.currentMessageObject.needDrawForwarded()) {
                        i3 = this.lastNamesOffset;
                        if (i3 != ChatMessageCell.this.namesOffset) {
                            this.animateNamesOffset = true;
                            this.animateNamesOffsetFrom = i3;
                        }
                        ChatMessageCell.this.updateReactionLayoutPosition();
                        if (ChatMessageCell.this.reactionsLayoutInBubble.animateChange()) {
                            z = true;
                        }
                        if (ChatMessageCell.this.currentMessageObject.isRoundVideo()) {
                            ChatMessageCell chatMessageCell14 = ChatMessageCell.this;
                            float fDp = chatMessageCell14.layoutHeight - AndroidUtilities.dp(28 - (chatMessageCell14.drawPinnedBottom ? 2 : 0));
                            if (!ChatMessageCell.this.reactionsLayoutInBubble.isEmpty) {
                                fDp -= r5.totalHeight;
                            }
                            float f4 = this.lastDrawRoundVideoDotY;
                            if (fDp != f4) {
                                this.animateRoundVideoDotY = true;
                                this.animateFromRoundVideoDotY = f4;
                                z = true;
                            }
                        }
                        chatMessageCell3 = ChatMessageCell.this;
                        if (chatMessageCell3.replyNameLayout != null) {
                            float f5 = chatMessageCell3.replyStartX;
                            float f6 = this.lastDrawReplyY;
                            if (f5 != f6 && f6 != BitmapDescriptorFactory.HUE_RED) {
                                this.animateReplyY = true;
                                this.animateFromReplyY = f6;
                                z = true;
                            }
                        }
                        if ((chatMessageCell3.currentMessageObject != null && ChatMessageCell.this.currentMessageObject.translated) != this.lastDrawnTranslated || ChatMessageCell.this.titleLayout == null || (staticLayout = this.lastDrawnTitleLayout) == null) {
                            return z;
                        }
                        this.animateTitleLayout = staticLayout;
                        this.animateTitleLayoutEmoji = AnimatedEmojiSpan.update(0, (View) ChatMessageCell.this, false, this.animateTitleLayoutEmoji, staticLayout);
                        return true;
                    }
                    this.animateForwardedLayout = true;
                    StaticLayout[] staticLayoutArr = this.animatingForwardedNameLayout;
                    StaticLayout[] staticLayoutArr2 = this.lastDrawnForwardedNameLayout;
                    staticLayoutArr[0] = staticLayoutArr2[0];
                    staticLayoutArr[1] = staticLayoutArr2[1];
                    this.animateForwardNameX = this.lastForwardNameX;
                    this.animateForwardedNamesOffset = this.lastForwardedNamesOffset;
                    this.animateForwardNameWidth = this.lastForwardNameWidth;
                    z = true;
                    ChatMessageCell.this.updateReactionLayoutPosition();
                    if (ChatMessageCell.this.reactionsLayoutInBubble.animateChange()) {
                    }
                    if (ChatMessageCell.this.currentMessageObject.isRoundVideo()) {
                    }
                    chatMessageCell3 = ChatMessageCell.this;
                    if (chatMessageCell3.replyNameLayout != null) {
                    }
                    if ((chatMessageCell3.currentMessageObject != null && ChatMessageCell.this.currentMessageObject.translated) != this.lastDrawnTranslated) {
                    }
                    return z;
                }
                this.animateEditedEnter = false;
                this.animateShouldDrawTimeOnMedia = true;
                this.animateFromTimeX = this.lastTimeX;
                this.animateTimeLayout = this.lastTimeLayout;
                this.animateTimeWidth = this.lastTimeWidth;
            }
            z = true;
            if (this.lastShouldDrawMenuDrawable != ChatMessageCell.this.shouldDrawMenuDrawable()) {
            }
            if (this.lastLocatinIsExpired != ChatMessageCell.this.locationExpired) {
            }
            if (this.lastIsPlayingRound != ChatMessageCell.this.isPlayingRound) {
            }
            f = this.lastDrawingTextY;
            chatMessageCell2 = ChatMessageCell.this;
            if (f != chatMessageCell2.textY) {
            }
            if (this.lastDrawingLinkPreviewY != chatMessageCell2.linkPreviewY) {
            }
            if (this.lastDrawingFactCheckHeight != ChatMessageCell.this.factCheckHeight) {
            }
            if (this.lastDrawingFactCheckExpanded != (ChatMessageCell.this.getPrimaryMessageObject() == null && ChatMessageCell.this.getPrimaryMessageObject().factCheckExpanded)) {
            }
            if (this.lastDrawingFactCheck != ChatMessageCell.this.hasFactCheck) {
            }
            if (!MessageObject.expandedQuotesEquals(this.lastDrawingExpandedQuotes, ChatMessageCell.this.currentMessageObject != null ? ChatMessageCell.this.currentMessageObject.expandedQuotes : null)) {
            }
            if (ChatMessageCell.this.currentMessageObject != null) {
                i3 = this.lastNamesOffset;
                if (i3 != ChatMessageCell.this.namesOffset) {
                }
            }
            ChatMessageCell.this.updateReactionLayoutPosition();
            if (ChatMessageCell.this.reactionsLayoutInBubble.animateChange()) {
            }
            if (ChatMessageCell.this.currentMessageObject.isRoundVideo()) {
            }
            chatMessageCell3 = ChatMessageCell.this;
            if (chatMessageCell3.replyNameLayout != null) {
            }
            if ((chatMessageCell3.currentMessageObject != null && ChatMessageCell.this.currentMessageObject.translated) != this.lastDrawnTranslated) {
            }
            return z;
            z = true;
            if (!this.lastDrawBotButtons.isEmpty()) {
            }
            if (this.lastDrawnWidthForButtons != ChatMessageCell.this.widthForButtons) {
            }
            if (ChatMessageCell.this.documentAttachType == 5) {
            }
            i = ChatMessageCell.this.mediaOffsetY;
            i2 = this.lastMediaOffsetY;
            if (i != i2) {
            }
            z2 = this.lastIsPinned;
            chatMessageCell = ChatMessageCell.this;
            if (z2 != chatMessageCell.isPinned) {
            }
            if (this.lastRepliesLayout != null) {
            }
            if (this.lastViewsLayout != null) {
            }
            if (ChatMessageCell.this.commentLayout != null) {
            }
            if (!TextUtils.equals(this.lastSignMessage, ChatMessageCell.this.lastPostAuthor)) {
            }
            if (this.lastDrawTime == ChatMessageCell.this.forceNotDrawTime) {
            }
            z = true;
            if (this.lastShouldDrawMenuDrawable != ChatMessageCell.this.shouldDrawMenuDrawable()) {
            }
            if (this.lastLocatinIsExpired != ChatMessageCell.this.locationExpired) {
            }
            if (this.lastIsPlayingRound != ChatMessageCell.this.isPlayingRound) {
            }
            f = this.lastDrawingTextY;
            chatMessageCell2 = ChatMessageCell.this;
            if (f != chatMessageCell2.textY) {
            }
            if (this.lastDrawingLinkPreviewY != chatMessageCell2.linkPreviewY) {
            }
            if (this.lastDrawingFactCheckHeight != ChatMessageCell.this.factCheckHeight) {
            }
            if (this.lastDrawingFactCheckExpanded != (ChatMessageCell.this.getPrimaryMessageObject() == null && ChatMessageCell.this.getPrimaryMessageObject().factCheckExpanded)) {
            }
            if (this.lastDrawingFactCheck != ChatMessageCell.this.hasFactCheck) {
            }
            if (!MessageObject.expandedQuotesEquals(this.lastDrawingExpandedQuotes, ChatMessageCell.this.currentMessageObject != null ? ChatMessageCell.this.currentMessageObject.expandedQuotes : null)) {
            }
            if (ChatMessageCell.this.currentMessageObject != null) {
            }
            ChatMessageCell.this.updateReactionLayoutPosition();
            if (ChatMessageCell.this.reactionsLayoutInBubble.animateChange()) {
            }
            if (ChatMessageCell.this.currentMessageObject.isRoundVideo()) {
            }
            chatMessageCell3 = ChatMessageCell.this;
            if (chatMessageCell3.replyNameLayout != null) {
            }
            if ((chatMessageCell3.currentMessageObject != null && ChatMessageCell.this.currentMessageObject.translated) != this.lastDrawnTranslated) {
            }
            return z;
        }

        /* JADX WARN: Removed duplicated region for block: B:28:0x0080  */
        /* JADX WARN: Removed duplicated region for block: B:30:0x0085  */
        /* JADX WARN: Removed duplicated region for block: B:31:0x0087  */
        /* JADX WARN: Removed duplicated region for block: B:35:0x008c  */
        /* JADX WARN: Removed duplicated region for block: B:39:0x0091  */
        /*
            Code decompiled incorrectly, please refer to instructions dump.
        */
        public int createStatusDrawableParams() {
            int i;
            boolean z;
            boolean z2;
            boolean z3 = true;
            if (!ChatMessageCell.this.currentMessageObject.isOutOwner()) {
                if (!ChatMessageCell.this.currentMessageObject.isSending() && !ChatMessageCell.this.currentMessageObject.isEditing()) {
                    z3 = false;
                }
                return (z3 ? 4 : 0) | (ChatMessageCell.this.currentMessageObject.isSendError() ? 8 : 0);
            }
            if (ChatMessageCell.this.currentMessageObject.isSending() || ChatMessageCell.this.currentMessageObject.isEditing()) {
                i = 0;
                z3 = false;
                z = true;
            } else {
                if (ChatMessageCell.this.currentMessageObject.isSendError()) {
                    i = 0;
                    z3 = false;
                    z = false;
                    z2 = true;
                    if (!ChatMessageCell.this.currentMessageObject.notime || ChatMessageCell.this.currentMessageObject.isQuickReply()) {
                        i = 0;
                        z3 = false;
                        z = false;
                    }
                    return i | (!z3 ? 2 : 0) | (z ? 4 : 0) | (z2 ? 8 : 0);
                }
                if (ChatMessageCell.this.currentMessageObject.isSent()) {
                    i = (ChatMessageCell.this.currentMessageObject.scheduled || ChatMessageCell.this.currentMessageObject.isUnread()) ? 0 : 1;
                } else {
                    i = 0;
                    z3 = false;
                }
                z = false;
            }
            z2 = false;
            if (!ChatMessageCell.this.currentMessageObject.notime) {
                i = 0;
                z3 = false;
                z = false;
            }
            return i | (!z3 ? 2 : 0) | (z ? 4 : 0) | (z2 ? 8 : 0);
        }

        public void onDetach() {
            this.wasDraw = false;
        }

        public void recordDrawingState() {
            ChannelRecommendationsCell channelRecommendationsCell;
            this.wasDraw = true;
            this.lastDrawingImageX = ChatMessageCell.this.photoImage.getImageX();
            this.lastDrawingImageY = ChatMessageCell.this.photoImage.getImageY();
            this.lastDrawingImageW = ChatMessageCell.this.photoImage.getImageWidth();
            this.lastDrawingImageH = ChatMessageCell.this.photoImage.getImageHeight();
            System.arraycopy(ChatMessageCell.this.photoImage.getRoundRadius(), 0, this.imageRoundRadius, 0, 4);
            Theme.MessageDrawable messageDrawable = ChatMessageCell.this.currentBackgroundDrawable;
            if (messageDrawable != null) {
                this.lastDrawingBackgroundRect.set(messageDrawable.getBounds());
            }
            ChatMessageCell chatMessageCell = ChatMessageCell.this;
            this.lastDrawingSideMenuEnabled = chatMessageCell.isSideMenuEnabled;
            this.lastDrawingTextBlocks = chatMessageCell.currentMessageObject != null ? ChatMessageCell.this.currentMessageObject.textLayoutBlocks : null;
            this.lastDrawingTextWidth = ChatMessageCell.this.currentMessageObject != null ? ChatMessageCell.this.currentMessageObject.textWidth : 0;
            this.lastDrawingEdited = ChatMessageCell.this.edited;
            this.lastDrawingCaptionX = ChatMessageCell.this.captionX;
            ChatMessageCell chatMessageCell2 = ChatMessageCell.this;
            this.lastDrawingCaptionY = chatMessageCell2.captionY;
            this.lastDrawingCaptionLayout = chatMessageCell2.captionLayout;
            this.lastDrawBotButtons.clear();
            if (!ChatMessageCell.this.botButtons.isEmpty()) {
                this.lastDrawBotButtons.addAll(ChatMessageCell.this.botButtons);
            }
            this.lastDrawingSmallImage = ChatMessageCell.this.isSmallImage;
            ChatMessageCell chatMessageCell3 = ChatMessageCell.this;
            this.lastDrawnMonoforumPadding = chatMessageCell3.topicSeparatorTopPadding;
            this.lastDrawingLinkPreviewHeight = chatMessageCell3.linkPreviewHeight;
            this.lastDrawingLinkAbove = chatMessageCell3.linkPreviewAbove;
            this.lastDrawingMediaAbove = chatMessageCell3.captionAbove;
            this.lastDrawingRecommendationsExpanded = chatMessageCell3.currentMessageObject != null && ChatMessageCell.this.currentMessageObject.type == 27 && (channelRecommendationsCell = ChatMessageCell.this.channelRecommendationsCell) != null && channelRecommendationsCell.isExpanded();
            if (ChatMessageCell.this.commentLayout != null) {
                this.lastCommentsCount = ChatMessageCell.this.getRepliesCount();
                this.lastTotalCommentWidth = ChatMessageCell.this.totalCommentWidth;
                this.lastCommentLayout = ChatMessageCell.this.commentLayout;
                this.lastCommentArrowX = ChatMessageCell.this.commentArrowX;
                this.lastCommentUnreadX = ChatMessageCell.this.commentUnreadX;
                this.lastCommentDrawUnread = ChatMessageCell.this.commentDrawUnread;
                this.lastCommentX = ChatMessageCell.this.commentX;
                this.lastDrawCommentNumber = ChatMessageCell.this.drawCommentNumber;
            }
            this.lastRepliesCount = ChatMessageCell.this.getRepliesCount();
            this.lastViewsCount = ChatMessageCell.this.getMessageObject().messageOwner.views;
            this.lastRepliesLayout = ChatMessageCell.this.repliesLayout;
            this.lastViewsLayout = ChatMessageCell.this.viewsLayout;
            ChatMessageCell chatMessageCell4 = ChatMessageCell.this;
            this.lastIsPinned = chatMessageCell4.isPinned;
            this.lastSignMessage = chatMessageCell4.lastPostAuthor;
            this.lastDrawBackground = ChatMessageCell.this.drawBackground;
            this.lastUseTranscribeButton = ChatMessageCell.this.useTranscribeButton;
            this.lastButtonX = ChatMessageCell.this.buttonX;
            this.lastButtonY = ChatMessageCell.this.buttonY;
            this.lastMediaOffsetY = ChatMessageCell.this.mediaOffsetY;
            this.lastDrawTime = !ChatMessageCell.this.forceNotDrawTime;
            ChatMessageCell chatMessageCell5 = ChatMessageCell.this;
            this.lastTimeX = chatMessageCell5.timeX;
            this.lastTimeLayout = chatMessageCell5.timeLayout;
            this.lastTimeWidth = chatMessageCell5.timeWidth;
            this.lastShouldDrawTimeOnMedia = chatMessageCell5.shouldDrawTimeOnMedia();
            this.lastTopOffset = ChatMessageCell.this.getTopMediaOffset();
            this.lastShouldDrawMenuDrawable = ChatMessageCell.this.shouldDrawMenuDrawable();
            this.lastLocatinIsExpired = ChatMessageCell.this.locationExpired;
            this.lastIsPlayingRound = ChatMessageCell.this.isPlayingRound;
            ChatMessageCell chatMessageCell6 = ChatMessageCell.this;
            this.lastDrawingTextY = chatMessageCell6.textY;
            this.lastDrawingTextX = chatMessageCell6.textX;
            this.lastDrawingLinkPreviewY = chatMessageCell6.linkPreviewY;
            this.lastDrawnWidthForButtons = ChatMessageCell.this.widthForButtons;
            this.lastDrawnForwardedNameLayout[0] = ChatMessageCell.this.forwardedNameLayout[0];
            this.lastDrawnForwardedNameLayout[1] = ChatMessageCell.this.forwardedNameLayout[1];
            this.lastDrawnForwardedName = ChatMessageCell.this.currentMessageObject != null && ChatMessageCell.this.currentMessageObject.needDrawForwarded();
            this.lastForwardNameX = ChatMessageCell.this.forwardNameX;
            ChatMessageCell chatMessageCell7 = ChatMessageCell.this;
            int i = chatMessageCell7.namesOffset;
            this.lastForwardedNamesOffset = i;
            this.lastNamesOffset = i;
            this.lastForwardNameWidth = chatMessageCell7.forwardedNameWidth;
            this.lastBackgroundLeft = ChatMessageCell.this.getCurrentBackgroundLeft();
            Theme.MessageDrawable messageDrawable2 = ChatMessageCell.this.currentBackgroundDrawable;
            if (messageDrawable2 != null) {
                this.lastBackgroundRight = messageDrawable2.getBounds().right;
            }
            MessageObject messageObject = ChatMessageCell.this.currentMessageObject;
            float f = BitmapDescriptorFactory.HUE_RED;
            this.lastTextXOffset = messageObject != null ? ChatMessageCell.this.currentMessageObject.textXOffset : BitmapDescriptorFactory.HUE_RED;
            this.lastDrawingReplyTextHeight = ChatMessageCell.this.replyTextHeight;
            ChatMessageCell chatMessageCell8 = ChatMessageCell.this;
            this.lastDrawnReplyTextLayout = chatMessageCell8.replyTextLayout;
            this.lastReplyTextXOffset = chatMessageCell8.replyTextOffset;
            chatMessageCell8.reactionsLayoutInBubble.recordDrawingState();
            ChatMessageCell chatMessageCell9 = ChatMessageCell.this;
            if (chatMessageCell9.replyNameLayout != null) {
                f = chatMessageCell9.replyStartY;
            }
            this.lastDrawReplyY = f;
            this.lastDrawNameLayout = chatMessageCell9.drawNameLayout;
            this.lastDrawAvatar = ChatMessageCell.this.drawNameAvatar;
            this.lastDrawTopic = ChatMessageCell.this.drawTopic;
            this.lastDrawingFactCheckHeight = ChatMessageCell.this.factCheckHeight;
            this.lastDrawingFactCheckExpanded = ChatMessageCell.this.getPrimaryMessageObject() != null && ChatMessageCell.this.getPrimaryMessageObject().factCheckExpanded;
            this.lastDrawingFactCheck = ChatMessageCell.this.hasFactCheck;
            this.lastDrawingExpandedQuotes = ChatMessageCell.this.getPrimaryMessageObject() != null ? ChatMessageCell.this.getPrimaryMessageObject().expandedQuotes : null;
            this.lastDrawnTranslated = ChatMessageCell.this.currentMessageObject != null && ChatMessageCell.this.currentMessageObject.translated;
            this.lastDrawnTitleLayout = ChatMessageCell.this.titleLayout;
        }

        public void recordDrawingStatePreview() {
            this.lastDrawnForwardedNameLayout[0] = ChatMessageCell.this.forwardedNameLayout[0];
            this.lastDrawnForwardedNameLayout[1] = ChatMessageCell.this.forwardedNameLayout[1];
            this.lastDrawnForwardedName = ChatMessageCell.this.currentMessageObject.needDrawForwarded();
            this.lastForwardNameX = ChatMessageCell.this.forwardNameX;
            ChatMessageCell chatMessageCell = ChatMessageCell.this;
            int i = chatMessageCell.namesOffset;
            this.lastForwardedNamesOffset = i;
            this.lastNamesOffset = i;
            this.lastForwardNameWidth = chatMessageCell.forwardedNameWidth;
        }

        public void resetAnimation() {
            this.animateChange = false;
            this.animatePinned = false;
            this.animateBackgroundBoundsInner = false;
            this.animateBackgroundWidth = false;
            this.deltaLeft = BitmapDescriptorFactory.HUE_RED;
            this.deltaRight = BitmapDescriptorFactory.HUE_RED;
            this.deltaBottom = BitmapDescriptorFactory.HUE_RED;
            this.deltaTop = BitmapDescriptorFactory.HUE_RED;
            this.toDeltaLeft = BitmapDescriptorFactory.HUE_RED;
            this.toDeltaRight = BitmapDescriptorFactory.HUE_RED;
            if (this.imageChangeBoundsTransition && this.animateToImageW != BitmapDescriptorFactory.HUE_RED && this.animateToImageH != BitmapDescriptorFactory.HUE_RED) {
                ChatMessageCell.this.photoImage.setImageCoords(this.animateToImageX, this.animateToImageY, this.animateToImageW, this.animateToImageH);
            }
            if (this.animateRadius) {
                ChatMessageCell.this.photoImage.setRoundRadius(this.animateToRadius);
            }
            this.animateToImageX = BitmapDescriptorFactory.HUE_RED;
            this.animateToImageY = BitmapDescriptorFactory.HUE_RED;
            this.animateToImageW = BitmapDescriptorFactory.HUE_RED;
            this.animateToImageH = BitmapDescriptorFactory.HUE_RED;
            this.imageChangeBoundsTransition = false;
            this.changePinnedBottomProgress = 1.0f;
            this.captionEnterProgress = 1.0f;
            this.animateRadius = false;
            this.animateChangeProgress = 1.0f;
            this.animateMessageText = false;
            this.animateDrawingSideMenuEnabled = false;
            this.animateDrawNameLayout = false;
            this.animateDrawAvatar = false;
            this.animateDrawTopic = false;
            this.animateOutTextBlocks = null;
            this.animateEditedLayout = null;
            this.animateTimeLayout = null;
            this.animateEditedEnter = false;
            this.animateReplaceCaptionLayout = false;
            this.transformGroupToSingleMessage = false;
            this.animateOutCaptionLayout = null;
            AnimatedEmojiSpan.release(ChatMessageCell.this, this.animateOutAnimateEmoji);
            this.animateOutAnimateEmoji = null;
            this.moveCaption = false;
            this.animateDrawingTimeAlpha = false;
            this.transitionBotButtons.clear();
            this.animateButton = false;
            this.animateBotButtonsChanged = false;
            this.animateWidthForButton = false;
            this.animateMediaOffsetY = false;
            this.animateReplyTextLayout = null;
            this.animateReplies = false;
            this.animateRepliesLayout = null;
            this.animateComments = false;
            this.animateCommentsLayout = null;
            this.animateViewsLayout = null;
            this.animateShouldDrawTimeOnMedia = false;
            this.animateShouldDrawMenuDrawable = false;
            this.shouldAnimateTimeX = false;
            this.animateDrawBackground = false;
            this.animateSign = false;
            this.animateSmallImage = false;
            this.animateMonoforumPadding = false;
            this.needsStopClipping = false;
            this.animateLinkAbove = false;
            this.animateMediaAbove = false;
            this.animateRecommendationsExpanded = false;
            this.animateDrawingTimeAlpha = false;
            this.animateLocationIsExpired = false;
            this.animatePlayingRound = false;
            this.animateText = false;
            this.animateLinkPreviewY = false;
            this.animateFactCheckHeight = false;
            this.animateFactCheckExpanded = false;
            this.animateExpandedQuotes = false;
            this.animateFactCheck = false;
            this.animateForwardedLayout = false;
            this.animateNamesOffset = false;
            StaticLayout[] staticLayoutArr = this.animatingForwardedNameLayout;
            staticLayoutArr[0] = null;
            staticLayoutArr[1] = null;
            this.animateRoundVideoDotY = false;
            this.animateReplyY = false;
            ChatMessageCell.this.reactionsLayoutInBubble.resetAnimation();
            this.animateTitleLayout = null;
            AnimatedEmojiSpan.release(ChatMessageCell.this, this.animateTitleLayoutEmoji);
        }

        public boolean supportChangeAnimation() {
            return true;
        }
    }

    public ChatMessageCell(Context context, int i) {
        this(context, i, false, null, null);
    }

    public ChatMessageCell(Context context, int i, boolean z, ChatMessageSharedResources chatMessageSharedResources, Theme.ResourcesProvider resourcesProvider) {
        super(context);
        this.visibleOnScreen = true;
        this.reactionsLayoutInBubble = new ReactionsLayoutInBubble(this);
        this.giveawayMessageCell = new GiveawayMessageCell(this);
        this.giveawayResultsMessageCell = new GiveawayResultsMessageCell(this);
        this.scrollRect = new Rect();
        this.drawnContactButtonsFlag = 0;
        this.imageBackgroundGradientRotation = 45;
        this.selectorDrawable = new Drawable[2];
        this.selectorMaskDrawable = new MaskDrawable[2];
        this.selectorDrawableMaskType = new int[2];
        this.instantButtonRect = new RectF();
        this.pressedState = new int[]{android.R.attr.state_enabled, android.R.attr.state_pressed};
        this.highlightCaptionToSetStart = -1;
        this.highlightCaptionToSetEnd = -1;
        this.deleteProgressRect = new RectF();
        this.rect = new RectF();
        this.foreverDrawableColor = -1;
        this.timeAlpha = 1.0f;
        this.actionAlpha = 1.0f;
        this.controlsAlpha = 1.0f;
        this.pressedBlock = -1;
        this.links = new LinkSpanDrawable.LinkCollector(this);
        this.urlPathCache = new ArrayList();
        this.urlPathSelection = new ArrayList();
        this.rectPath = new Path();
        this.oldPollButtons = new ArrayList();
        this.pollButtons = new ArrayList();
        this.botButtons = new ArrayList();
        this.botButtonPath = new Path();
        this.botButtonRadii = new float[8];
        this.botButtonsByData = new HashMap();
        this.botButtonsByPosition = new HashMap();
        this.doNotDrawTaskId = -1;
        this.isCheckPressed = true;
        this.drawBackground = true;
        this.backgroundWidth = 100;
        this.commentButtonRect = new Rect();
        this.spoilersPatchedReplyTextLayout = new AtomicReference();
        this.forwardedNameLayout = new StaticLayout[2];
        this.forwardNameOffsetX = new float[2];
        this.drawTime = true;
        this.mediaSpoilerPath = new Path();
        this.mediaSpoilerRadii = new float[8];
        this.unlockAlpha = 1.0f;
        this.unlockSpoilerPath = new Path();
        this.unlockSpoilerRadii = new float[8];
        this.replySelectorRect = new RectF();
        this.ALPHA_PROPERTY_WORKAROUND = Build.VERSION.SDK_INT == 28;
        this.alphaInternal = 1.0f;
        this.transitionParams = new TransitionParams();
        this.roundVideoPlayPipFloat = new AnimatedFloat(this, 200L, CubicBezierInterpolator.EASE_OUT);
        this.diceFinishCallback = new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell.1
            @Override // java.lang.Runnable
            public void run() {
                if (ChatMessageCell.this.delegate != null) {
                    ChatMessageCell.this.delegate.onDiceFinished();
                }
            }
        };
        this.invalidateRunnable = new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell.2
            @Override // java.lang.Runnable
            public void run() throws Resources.NotFoundException, NumberFormatException {
                ChatMessageCell.this.checkLocationExpired();
                if (ChatMessageCell.this.locationExpired) {
                    ChatMessageCell.this.invalidate();
                    ChatMessageCell.this.scheduledInvalidate = false;
                    return;
                }
                ChatMessageCell.this.invalidate(((int) r0.rect.left) - 5, ((int) ChatMessageCell.this.rect.top) - 5, ((int) ChatMessageCell.this.rect.right) + 5, ((int) ChatMessageCell.this.rect.bottom) + 5);
                if (ChatMessageCell.this.scheduledInvalidate) {
                    AndroidUtilities.runOnUIThread(ChatMessageCell.this.invalidateRunnable, 1000L);
                }
            }
        };
        this.accessibilityVirtualViewBounds = new SparseArray();
        this.currentFocusedVirtualView = -1;
        this.backgroundCacheParams = new Theme.MessageDrawable.PathDrawParams();
        this.replySpoilers = new ArrayList();
        this.replySpoilersPool = new Stack();
        this.sPath = new Path();
        this.pressedEffect = false;
        this.overridenDuration = -1L;
        this.hadLongPress = false;
        this.showTopicSeparator = true;
        this.radialProgressAlpha = 1.0f;
        this.ANIMATION_OFFSET_X = new Property(Float.class, "animationOffsetX") { // from class: org.telegram.ui.Cells.ChatMessageCell.10
            @Override // android.util.Property
            public Float get(ChatMessageCell chatMessageCell) {
                return Float.valueOf(chatMessageCell.animationOffsetX);
            }

            @Override // android.util.Property
            public void set(ChatMessageCell chatMessageCell, Float f) {
                chatMessageCell.setAnimationOffsetX(f.floatValue());
            }
        };
        this.currentAccount = i;
        this.resourcesProvider = resourcesProvider;
        this.canDrawBackgroundInParent = z;
        this.sharedResources = chatMessageSharedResources;
        if (chatMessageSharedResources == null) {
            this.sharedResources = new ChatMessageSharedResources(context);
        }
        setClipChildren(false);
        setClipToPadding(false);
        this.backgroundDrawable = new MessageBackgroundDrawable(this);
        ImageReceiver imageReceiver = new ImageReceiver();
        this.avatarImage = imageReceiver;
        imageReceiver.setAllowLoadingOnAttachedOnly(true);
        this.avatarImage.setRoundRadius(AndroidUtilities.dp(21.0f));
        this.avatarDrawable = new AvatarDrawable();
        ImageReceiver imageReceiver2 = new ImageReceiver(this);
        this.replyImageReceiver = imageReceiver2;
        imageReceiver2.setAllowLoadingOnAttachedOnly(true);
        this.replyImageReceiver.setRoundRadius(AndroidUtilities.dp(4.0f));
        ImageReceiver imageReceiver3 = new ImageReceiver(this);
        this.locationImageReceiver = imageReceiver3;
        imageReceiver3.setAllowLoadingOnAttachedOnly(true);
        this.locationImageReceiver.setRoundRadius(AndroidUtilities.dp(26.1f));
        this.TAG = DownloadController.getInstance(i).generateObserverTag();
        this.contactAvatarDrawable = new AvatarDrawable();
        ImageReceiver imageReceiver4 = new ImageReceiver(this);
        this.photoImage = imageReceiver4;
        imageReceiver4.setAllowLoadingOnAttachedOnly(true);
        this.photoImage.setUseRoundForThumbDrawable(true);
        this.photoImage.setDelegate(this);
        ImageReceiver imageReceiver5 = new ImageReceiver(this);
        this.blurredPhotoImage = imageReceiver5;
        imageReceiver5.setAllowLoadingOnAttachedOnly(true);
        this.blurredPhotoImage.setUseRoundForThumbDrawable(true);
        this.radialProgress = new RadialProgress2(this, resourcesProvider);
        RadialProgress2 radialProgress2 = new RadialProgress2(this, resourcesProvider);
        this.videoRadialProgress = radialProgress2;
        radialProgress2.setDrawBackground(false);
        this.videoRadialProgress.setCircleRadius(AndroidUtilities.dp(15.0f));
        SeekBar seekBar = new SeekBar(this) { // from class: org.telegram.ui.Cells.ChatMessageCell.3
            @Override // org.telegram.ui.Components.SeekBar
            protected void onTimestampUpdate(URLSpanNoUnderline uRLSpanNoUnderline) {
                ChatMessageCell.this.setHighlightedSpan(uRLSpanNoUnderline);
            }
        };
        this.seekBar = seekBar;
        seekBar.setDelegate(this);
        SeekBarWaveform seekBarWaveform = new SeekBarWaveform(context);
        this.seekBarWaveform = seekBarWaveform;
        seekBarWaveform.setDelegate(this);
        this.seekBarWaveform.setParentView(this);
        this.seekBarAccessibilityDelegate = new FloatSeekBarAccessibilityDelegate() { // from class: org.telegram.ui.Cells.ChatMessageCell.4
            @Override // org.telegram.ui.Components.FloatSeekBarAccessibilityDelegate
            public float getProgress() {
                return ChatMessageCell.this.currentMessageObject.isMusic() ? ChatMessageCell.this.seekBar.getProgress() : ChatMessageCell.this.currentMessageObject.isVoice() ? ChatMessageCell.this.useSeekBarWaveform ? ChatMessageCell.this.seekBarWaveform.getProgress() : ChatMessageCell.this.seekBar.getProgress() : ChatMessageCell.this.currentMessageObject.isRoundVideo() ? ChatMessageCell.this.currentMessageObject.audioProgress : BitmapDescriptorFactory.HUE_RED;
            }

            /* JADX WARN: Removed duplicated region for block: B:10:0x002b  */
            @Override // org.telegram.ui.Components.FloatSeekBarAccessibilityDelegate
            /*
                Code decompiled incorrectly, please refer to instructions dump.
            */
            public void setProgress(float f) {
                if (!ChatMessageCell.this.currentMessageObject.isMusic()) {
                    if (ChatMessageCell.this.currentMessageObject.isVoice()) {
                        if (ChatMessageCell.this.useSeekBarWaveform) {
                            ChatMessageCell.this.seekBarWaveform.setProgress(f);
                        } else {
                            ChatMessageCell.this.seekBar.setProgress(f);
                        }
                    } else {
                        if (!ChatMessageCell.this.currentMessageObject.isRoundVideo()) {
                            return;
                        }
                        if (ChatMessageCell.this.useSeekBarWaveform) {
                            if (ChatMessageCell.this.seekBarWaveform != null) {
                                ChatMessageCell.this.seekBarWaveform.setProgress(f);
                            }
                        } else if (ChatMessageCell.this.seekBar != null) {
                            ChatMessageCell.this.seekBar.setProgress(f);
                        }
                        ChatMessageCell.this.currentMessageObject.audioProgress = f;
                    }
                }
                ChatMessageCell.this.onSeekBarDrag(f);
                ChatMessageCell.this.invalidate();
            }
        };
        this.roundVideoPlayingDrawable = new RoundVideoPlayingDrawable(this, resourcesProvider);
        setImportantForAccessibility(1);
    }

    private boolean allowDrawPhotoImage() {
        return !this.currentMessageObject.hasMediaSpoilers() || this.currentMessageObject.isMediaSpoilersRevealed || this.mediaSpoilerRevealProgress != BitmapDescriptorFactory.HUE_RED || this.blurredPhotoImage.getBitmap() == null;
    }

    private void animateCheckboxTranslation() {
        boolean z = this.checkBoxVisible;
        if (z || this.checkBoxAnimationInProgress) {
            if ((z && this.checkBoxAnimationProgress == 1.0f) || (!z && this.checkBoxAnimationProgress == BitmapDescriptorFactory.HUE_RED)) {
                this.checkBoxAnimationInProgress = false;
            }
            this.checkBoxTranslation = (int) Math.ceil((z ? CubicBezierInterpolator.EASE_OUT : CubicBezierInterpolator.EASE_IN).getInterpolation(this.checkBoxAnimationProgress) * AndroidUtilities.dp(35.0f));
            if (!this.currentMessageObject.isOutOwner() || this.currentMessageObject.hasWideCode) {
                updateTranslation();
            }
            if (this.checkBoxAnimationInProgress) {
                long jElapsedRealtime = SystemClock.elapsedRealtime();
                long j = jElapsedRealtime - this.lastCheckBoxAnimationTime;
                this.lastCheckBoxAnimationTime = jElapsedRealtime;
                if (this.checkBoxVisible) {
                    float f = this.checkBoxAnimationProgress + (j / 200.0f);
                    this.checkBoxAnimationProgress = f;
                    if (f > 1.0f) {
                        this.checkBoxAnimationProgress = 1.0f;
                    }
                } else {
                    float f2 = this.checkBoxAnimationProgress - (j / 200.0f);
                    this.checkBoxAnimationProgress = f2;
                    if (f2 <= BitmapDescriptorFactory.HUE_RED) {
                        this.checkBoxAnimationProgress = BitmapDescriptorFactory.HUE_RED;
                    }
                }
                invalidate();
                ((View) getParent()).invalidate();
            }
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:53:0x0089  */
    /* JADX WARN: Removed duplicated region for block: B:59:0x0097  */
    /* JADX WARN: Removed duplicated region for block: B:61:0x009d  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void calcBackgroundWidth(int i, int i2, int i3) {
        int i4;
        int iMax;
        if (this.currentMessageObject.isSponsored()) {
            this.backgroundWidth = i3 + AndroidUtilities.dp(31.0f);
            return;
        }
        ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
        boolean z = reactionsLayoutInBubble.isEmpty;
        int i5 = (z || reactionsLayoutInBubble.isSmall) ? this.currentMessageObject.lastLineWidth : reactionsLayoutInBubble.lastLineX;
        if (!z && !reactionsLayoutInBubble.isSmall) {
            z = i - i5 < i2 || this.currentMessageObject.hasRtl;
            if (this.hasInvoicePreview) {
                this.totalHeight += AndroidUtilities.dp(14.0f);
            }
        } else if ((!this.linkPreviewAbove && ((this.hasLinkPreview && !this.currentMessageObject.isSponsored()) || this.hasFactCheck || this.hasOldCaptionPreview || this.hasGamePreview || this.hasInvoicePreview)) || i - i5 < i2 || this.currentMessageObject.hasRtl) {
            z = true;
        }
        if (this.currentMessageObject.isUnsupported()) {
            z = true;
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject.hasCodeAtBottom) {
            ReactionsLayoutInBubble reactionsLayoutInBubble2 = this.reactionsLayoutInBubble;
            if (reactionsLayoutInBubble2.isEmpty || reactionsLayoutInBubble2.isSmall) {
                i4 = 18;
                z = true;
            } else if (messageObject.hasQuoteAtBottom) {
                ReactionsLayoutInBubble reactionsLayoutInBubble3 = this.reactionsLayoutInBubble;
                if (!reactionsLayoutInBubble3.isEmpty && !reactionsLayoutInBubble3.isSmall) {
                    if (!messageObject.isGiveawayOrGiveawayResults()) {
                        i4 = 14;
                    }
                }
            }
        }
        if (z) {
            this.totalHeight += AndroidUtilities.dp(i4);
            this.hasNewLineForTime = true;
            int iMax2 = Math.max(i3, i5) + AndroidUtilities.dp(31.0f);
            this.backgroundWidth = iMax2;
            iMax = Math.max(iMax2, (this.currentMessageObject.isOutOwner() ? this.timeWidth + AndroidUtilities.dp(17.0f) : this.timeWidth) + AndroidUtilities.dp(31.0f));
        } else {
            int extraTextX = (i3 - getExtraTextX()) - i5;
            if (extraTextX >= 0 && extraTextX <= i2) {
                this.backgroundWidth = ((i3 + i2) - extraTextX) + AndroidUtilities.dp(31.0f);
                return;
            }
            iMax = Math.max(i3, i5 + i2) + AndroidUtilities.dp(31.0f);
        }
        this.backgroundWidth = iMax;
    }

    private void calculateUnlockXY() {
        if (this.currentMessageObject.type != 20 || this.unlockLayout == null) {
            return;
        }
        this.unlockX = this.backgroundDrawableLeft + ((this.photoImage.getImageWidth() - this.unlockLayout.getWidth()) / 2.0f);
        this.unlockY = this.backgroundDrawableTop + this.photoImage.getImageY() + ((this.photoImage.getImageHeight() - this.unlockLayout.getHeight()) / 2.0f);
    }

    private void cancelLoading(MessageObject messageObject) {
        if (messageObject == null || messageObject.mediaExists || messageObject.putInDownloadsStore || DownloadController.getInstance(this.currentAccount).isDownloading(messageObject.messageOwner.id) || PhotoViewer.getInstance().isVisible()) {
            return;
        }
        TLRPC.Document document = messageObject.getDocument();
        if (MessageObject.isStickerDocument(document) || MessageObject.isAnimatedStickerDocument(document, true) || MessageObject.isGifDocument(document) || MessageObject.isRoundVideoDocument(document)) {
            return;
        }
        if (document != null) {
            FileLoader.getInstance(this.currentAccount).cancelLoadFile(document);
            return;
        }
        TLRPC.PhotoSize closestPhotoSizeWithSize = FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, AndroidUtilities.getPhotoSize());
        if (closestPhotoSizeWithSize != null) {
            FileLoader.getInstance(this.currentAccount).cancelLoadFile(closestPhotoSizeWithSize);
        }
    }

    private void cancelShakeAnimation() {
        AnimatorSet animatorSet = this.shakeAnimation;
        if (animatorSet != null) {
            animatorSet.cancel();
            this.shakeAnimation = null;
            setScaleX(1.0f);
            setScaleY(1.0f);
            setRotation(BitmapDescriptorFactory.HUE_RED);
        }
    }

    private boolean checkAdminMotionEvent(MotionEvent motionEvent) {
        RectF rectF;
        ChatMessageCellDelegate chatMessageCellDelegate;
        Drawable drawable;
        boolean z = false;
        if (this.adminLayout == null || (rectF = this.boostCounterBounds) == null || (this.currentUser == null && this.currentChat == null)) {
            this.boostCounterPressed = false;
            return false;
        }
        boolean zContains = rectF.contains((int) getEventX(motionEvent), (int) getEventY(motionEvent));
        if (motionEvent.getAction() == 0) {
            SpannableString spannableString = new SpannableString(this.adminLayout.getText());
            BoostCounterSpan[] boostCounterSpanArr = (BoostCounterSpan[]) spannableString.getSpans(0, spannableString.length(), BoostCounterSpan.class);
            if (zContains && boostCounterSpanArr != null && boostCounterSpanArr.length > 0) {
                z = true;
            }
            this.boostCounterPressed = z;
            if (z && (drawable = this.boostCounterLayoutSelector) != null) {
                if (Build.VERSION.SDK_INT >= 21) {
                    drawable.setHotspot((int) getEventX(motionEvent), (int) getEventY(motionEvent));
                }
                this.boostCounterLayoutSelector.setState(this.pressedState);
            }
        } else if (motionEvent.getAction() == 1 || motionEvent.getAction() == 3) {
            if (motionEvent.getAction() == 1 && this.boostCounterPressed && (chatMessageCellDelegate = this.delegate) != null) {
                chatMessageCellDelegate.didPressBoostCounter(this);
            }
            Drawable drawable2 = this.boostCounterLayoutSelector;
            if (drawable2 != null) {
                drawable2.setState(StateSet.NOTHING);
            }
            this.boostCounterPressed = false;
        }
        return this.boostCounterPressed;
    }

    /* JADX WARN: Removed duplicated region for block: B:100:0x0151  */
    /* JADX WARN: Removed duplicated region for block: B:106:0x0161  */
    /* JADX WARN: Removed duplicated region for block: B:96:0x0148  */
    /* JADX WARN: Removed duplicated region for block: B:97:0x014a  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkAudioMotionEvent(MotionEvent motionEvent) {
        MessageObject messageObject;
        boolean z;
        MessageObject messageObject2;
        int i;
        int i2;
        int iDp;
        int iDp2;
        int i3;
        MessageObject messageObject3;
        int i4 = this.documentAttachType;
        if ((i4 != 3 && i4 != 5 && (i4 != 7 || (i4 == 7 && (messageObject3 = this.currentMessageObject) != null && !messageObject3.isVoiceTranscriptionOpen()))) || AndroidUtilities.isAccessibilityScreenReaderEnabled()) {
            return false;
        }
        int eventX = (int) getEventX(motionEvent);
        int eventY = (int) getEventY(motionEvent);
        boolean zOnTouch = this.useSeekBarWaveform ? this.seekBarWaveform.onTouch(motionEvent.getAction(), (getEventX(motionEvent) - this.seekBarX) - AndroidUtilities.dp(13.0f), getEventY(motionEvent) - this.seekBarY) : (MediaController.getInstance().isPlayingMessage(this.currentMessageObject) || ((messageObject = this.currentMessageObject) != null && this.documentAttachType == 7 && messageObject.isVoiceTranscriptionOpen())) ? this.seekBar.onTouch(motionEvent.getAction(), getEventX(motionEvent) - this.seekBarX, getEventY(motionEvent) - this.seekBarY) : false;
        if (zOnTouch) {
            if (!this.useSeekBarWaveform && motionEvent.getAction() == 0) {
                getParent().requestDisallowInterceptTouchEvent(true);
            } else if (this.useSeekBarWaveform && !this.seekBarWaveform.isStartDraging() && motionEvent.getAction() == 1) {
                didPressButton(true, false);
            }
            this.disallowLongPress = true;
        } else {
            int iDp3 = AndroidUtilities.dp(36.0f);
            boolean z2 = this.miniButtonState >= 0 && eventX >= (iDp2 = this.buttonX + (iDp = AndroidUtilities.dp(27.0f))) && eventX <= iDp2 + iDp3 && eventY >= (i3 = this.buttonY + iDp) && eventY <= i3 + iDp3;
            if (z2 || !((messageObject2 = this.currentMessageObject) == null || !messageObject2.hasMediaSpoilers() || this.currentMessageObject.isVoice() || this.currentMessageObject.isMediaSpoilersRevealed)) {
                if (motionEvent.getAction() != 0) {
                    if (!z && !z2) {
                        return zOnTouch;
                    }
                    if (z) {
                        this.buttonPressed = 1;
                    } else {
                        this.miniButtonPressed = 1;
                    }
                    invalidate();
                    return true;
                }
                if (this.buttonPressed != 0) {
                    if (motionEvent.getAction() == 1) {
                        this.buttonPressed = 0;
                        playSoundEffect(0);
                        didPressButton(true, false);
                    } else {
                        if (motionEvent.getAction() != 3 && (motionEvent.getAction() != 2 || z)) {
                            return zOnTouch;
                        }
                        this.buttonPressed = 0;
                    }
                } else {
                    if (this.miniButtonPressed == 0) {
                        return zOnTouch;
                    }
                    if (motionEvent.getAction() == 1) {
                        this.miniButtonPressed = 0;
                        playSoundEffect(0);
                        didPressMiniButton(true);
                    } else {
                        if (motionEvent.getAction() != 3 && (motionEvent.getAction() != 2 || z2)) {
                            return zOnTouch;
                        }
                        this.miniButtonPressed = 0;
                    }
                }
            } else {
                int i5 = this.buttonState;
                if (i5 == 0 || i5 == 1 || i5 == 2) {
                    if (eventX >= this.buttonX - AndroidUtilities.dp(12.0f) && eventX <= (this.buttonX - AndroidUtilities.dp(12.0f)) + this.backgroundWidth) {
                        boolean z3 = this.drawInstantView;
                        if (eventY >= (z3 ? this.buttonY : this.namesOffset + this.mediaOffsetY)) {
                            if (z3) {
                                i = this.buttonY;
                            } else {
                                i = this.namesOffset + this.mediaOffsetY;
                                iDp3 = AndroidUtilities.dp(82.0f);
                            }
                            z = eventY <= i + iDp3;
                        }
                    }
                } else {
                    int i6 = this.buttonX;
                    if (eventX < i6 || eventX > i6 + iDp3 || eventY < (i2 = this.buttonY) || eventY > i2 + iDp3) {
                    }
                }
                if (motionEvent.getAction() != 0) {
                }
            }
        }
        invalidate();
        return zOnTouch;
    }

    private boolean checkBotButtonMotionEvent(MotionEvent motionEvent) {
        int i;
        if (this.botButtons.isEmpty()) {
            return false;
        }
        int eventX = (int) getEventX(motionEvent);
        int eventY = (int) getEventY(motionEvent);
        if (motionEvent.getAction() != 0) {
            if (motionEvent.getAction() == 1) {
                if (this.pressedBotButton == -1) {
                    return false;
                }
                playSoundEffect(0);
                BotButton botButton = (BotButton) this.botButtons.get(this.pressedBotButton);
                if (botButton.selectorDrawable != null) {
                    botButton.selectorDrawable.setState(StateSet.NOTHING);
                }
                botButton.setPressed(false);
                if (this.currentMessageObject.scheduled) {
                    Toast.makeText(getContext(), LocaleController.getString(R.string.MessageScheduledBotAction), 1).show();
                } else if (this.delegate != null && !botButton.isLocked) {
                    if (botButton.buttonCustom != null) {
                        this.delegate.didPressCustomBotButton(this, botButton.buttonCustom);
                    } else if (botButton.button != null) {
                        this.delegate.didPressBotButton(this, botButton.button);
                    }
                }
            } else {
                if (motionEvent.getAction() != 3 || (i = this.pressedBotButton) == -1) {
                    return false;
                }
                BotButton botButton2 = (BotButton) this.botButtons.get(i);
                if (botButton2.selectorDrawable != null) {
                    botButton2.selectorDrawable.setState(StateSet.NOTHING);
                }
                botButton2.setPressed(false);
            }
            this.pressedBotButton = -1;
            invalidateOutbounds();
            return false;
        }
        int widthForButtons = getWidthForButtons();
        int measuredWidth = this.currentMessageObject.isOutOwner() ? (getMeasuredWidth() - widthForButtons) - AndroidUtilities.dp(10.0f) : this.backgroundDrawableLeft + AndroidUtilities.dp(this.mediaBackground ? 1.0f : 7.0f);
        for (int i2 = 0; i2 < this.botButtons.size(); i2++) {
            BotButton botButton3 = (BotButton) this.botButtons.get(i2);
            int iDp = (botButton3.y + this.layoutHeight) - AndroidUtilities.dp(2.0f);
            float f = eventX;
            float f2 = widthForButtons;
            float f3 = measuredWidth;
            if (f >= (botButton3.x * f2) + f3 && f <= (botButton3.x * f2) + f3 + (botButton3.width * f2) && eventY >= iDp && eventY <= botButton3.height + iDp) {
                this.pressedBotButton = i2;
                invalidateOutbounds();
                if (botButton3.selectorDrawable == null) {
                    botButton3.selectorDrawable = Theme.createRadSelectorDrawable(getThemedColor(Theme.key_chat_serviceBackgroundSelector), 6, 6);
                    botButton3.selectorDrawable.setCallback(this);
                    botButton3.selectorDrawable.setBounds(((int) (botButton3.x * f2)) + measuredWidth, iDp, ((int) (botButton3.x * f2)) + measuredWidth + ((int) (botButton3.width * f2)), botButton3.height + iDp);
                }
                if (Build.VERSION.SDK_INT >= 21) {
                    botButton3.selectorDrawable.setHotspot(f, eventY);
                }
                botButton3.selectorDrawable.setState(this.pressedState);
                botButton3.setPressed(!botButton3.isLocked);
                final int i3 = this.pressedBotButton;
                postDelayed(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda10
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$checkBotButtonMotionEvent$4(i3);
                    }
                }, ViewConfiguration.getLongPressTimeout() - 1);
                return true;
            }
        }
        return false;
    }

    /* JADX WARN: Removed duplicated region for block: B:145:0x02bf A[Catch: Exception -> 0x025f, TryCatch #0 {Exception -> 0x025f, blocks: (B:120:0x020e, B:122:0x023e, B:123:0x0240, B:125:0x024a, B:127:0x0256, B:131:0x026a, B:133:0x026e, B:135:0x0271, B:138:0x027c, B:141:0x02b1, B:143:0x02b9, B:145:0x02bf, B:147:0x02c4, B:151:0x02d4, B:155:0x02e4, B:157:0x02e8, B:159:0x02eb, B:162:0x02f6, B:154:0x02dc, B:130:0x0262), top: B:271:0x020e }] */
    /* JADX WARN: Removed duplicated region for block: B:203:0x03b1  */
    /* JADX WARN: Removed duplicated region for block: B:205:0x03bf  */
    /* JADX WARN: Removed duplicated region for block: B:237:0x045f  */
    /* JADX WARN: Removed duplicated region for block: B:257:0x04b7  */
    /* JADX WARN: Removed duplicated region for block: B:269:0x04e1 A[ORIG_RETURN, RETURN] */
    /* JADX WARN: Removed duplicated region for block: B:302:? A[RETURN, SYNTHETIC] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkCaptionMotionEvent(MotionEvent motionEvent) {
        int i;
        boolean z;
        boolean z2;
        AnimatedEmojiSpan animatedEmojiSpan;
        boolean z3;
        int[] realSpanStartAndEnd;
        Object obj;
        Object[] spans;
        Object[] spans2;
        ReplyMessageLine replyMessageLine;
        ChatMessageCellDelegate chatMessageCellDelegate;
        if (!(this.currentCaption instanceof Spannable) || this.captionLayout == null) {
            return false;
        }
        if (motionEvent.getAction() == 0 || (motionEvent.getAction() == 1 && (this.pressedLinkType == 1 || this.pressedCopyCode != null))) {
            int eventX = (int) getEventX(motionEvent);
            int eventY = (int) getEventY(motionEvent);
            float f = eventX;
            float f2 = this.captionX;
            if (f >= f2) {
                float f3 = eventY;
                float f4 = this.captionY;
                if (f3 >= f4) {
                    MessageObject.TextLayoutBlocks textLayoutBlocks = this.captionLayout;
                    if (f <= f2 + textLayoutBlocks.textWidth && f3 <= f4 + textLayoutBlocks.textHeight(this.transitionParams)) {
                        int i2 = (int) (f3 - this.captionY);
                        int i3 = 0;
                        for (int i4 = 0; i4 < this.captionLayout.textLayoutBlocks.size() && this.captionLayout.textLayoutBlocks.get(i4).textYOffset(this.captionLayout.textLayoutBlocks, this.transitionParams) <= i2; i4++) {
                            i3 = i4;
                        }
                        try {
                            MessageObject.TextLayoutBlock textLayoutBlock = this.captionLayout.textLayoutBlocks.get(i3);
                            int i5 = (int) (f - (this.captionX - (textLayoutBlock.isRtl() ? this.captionLayout.textXOffset : BitmapDescriptorFactory.HUE_RED)));
                            int iTextYOffset = (int) (i2 - textLayoutBlock.textYOffset(this.captionLayout.textLayoutBlocks, this.transitionParams));
                            if (!textLayoutBlock.quote && textLayoutBlock.code && i5 > 0 && i5 <= this.captionLayout.textWidth && iTextYOffset >= ((textLayoutBlock.padTop + textLayoutBlock.height) + textLayoutBlock.padBottom) - AndroidUtilities.dp(38.0f) && iTextYOffset <= textLayoutBlock.padTop + textLayoutBlock.height + textLayoutBlock.padBottom) {
                                if (motionEvent.getAction() == 1) {
                                    if (textLayoutBlock == this.pressedCopyCode && (chatMessageCellDelegate = this.delegate) != null) {
                                        chatMessageCellDelegate.didPressCodeCopy(this, textLayoutBlock);
                                    }
                                    resetCodeSelectors();
                                    this.pressedCopyCode = null;
                                } else {
                                    this.pressedCopyCode = textLayoutBlock;
                                    if (Build.VERSION.SDK_INT >= 21) {
                                        textLayoutBlock.copySelector.setHotspot(i5, iTextYOffset);
                                    }
                                    textLayoutBlock.copySelector.setCallback(this);
                                    textLayoutBlock.copySelector.setState(this.pressedState);
                                }
                                return true;
                            }
                            int lineForVertical = textLayoutBlock.textLayout.getLineForVertical(iTextYOffset);
                            float f5 = i5;
                            int offsetForHorizontal = textLayoutBlock.charactersOffset + textLayoutBlock.textLayout.getOffsetForHorizontal(lineForVertical, f5);
                            float lineLeft = textLayoutBlock.textLayout.getLineLeft(lineForVertical);
                            if (lineLeft <= f5 && lineLeft + textLayoutBlock.textLayout.getLineWidth(lineForVertical) >= f5) {
                                Spannable spannable = (Spannable) this.currentCaption;
                                CharacterStyle[] characterStyleArr = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, ClickableSpan.class);
                                if (characterStyleArr == null || characterStyleArr.length == 0) {
                                    characterStyleArr = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, URLSpanMono.class);
                                    z = true;
                                } else {
                                    z = false;
                                }
                                if (characterStyleArr == null || characterStyleArr.length == 0) {
                                    characterStyleArr = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, AnimatedEmojiSpan.class);
                                    z2 = false;
                                } else {
                                    z2 = z;
                                }
                                if (characterStyleArr.length != 0 && ((!(characterStyleArr[0] instanceof URLSpanBotCommand) || URLSpanBotCommand.enabled) && !AndroidUtilities.isAccessibilityScreenReaderEnabled())) {
                                    if (motionEvent.getAction() == 0) {
                                        CharacterStyle characterStyle = characterStyleArr[0];
                                        if (!(characterStyle instanceof AnimatedEmojiSpan)) {
                                            LinkSpanDrawable linkSpanDrawable = this.pressedLink;
                                            if (linkSpanDrawable == null || linkSpanDrawable.getSpan() != characterStyleArr[0]) {
                                                this.links.removeLink(this.pressedLink);
                                                CharacterStyle characterStyle2 = characterStyleArr[0];
                                                Object obj2 = URLSpanMono.class;
                                                LinkSpanDrawable linkSpanDrawable2 = new LinkSpanDrawable(characterStyle2, this.resourcesProvider, f5, iTextYOffset, spanSupportsLongPress(characterStyle2));
                                                this.pressedLink = linkSpanDrawable2;
                                                linkSpanDrawable2.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outLinkSelectBackground : Theme.key_chat_linkSelectBackground));
                                                if (textLayoutBlock.quote && (replyMessageLine = this.quoteLine) != null) {
                                                    this.pressedLink.setColor(Theme.multAlpha(replyMessageLine.getColor(), Theme.isCurrentThemeDark() ? 0.13f : 0.1f));
                                                }
                                                this.linkBlockNum = i3;
                                                this.pressedLinkType = 1;
                                                try {
                                                    LinkPath linkPathObtainNewPath = this.pressedLink.obtainNewPath();
                                                    realSpanStartAndEnd = getRealSpanStartAndEnd(spannable, this.pressedLink.getSpan());
                                                    int i6 = realSpanStartAndEnd[0];
                                                    int i7 = textLayoutBlock.charactersOffset;
                                                    int i8 = i6 - i7;
                                                    realSpanStartAndEnd[0] = i8;
                                                    realSpanStartAndEnd[1] = realSpanStartAndEnd[1] - i7;
                                                    linkPathObtainNewPath.setCurrentLayout(textLayoutBlock.textLayout, i8, BitmapDescriptorFactory.HUE_RED);
                                                    textLayoutBlock.textLayout.getSelectionPath(realSpanStartAndEnd[0], realSpanStartAndEnd[1], linkPathObtainNewPath);
                                                } catch (Exception e) {
                                                    e = e;
                                                }
                                                if (realSpanStartAndEnd[1] >= textLayoutBlock.charactersEnd) {
                                                    int i9 = i3 + 1;
                                                    while (i9 < this.captionLayout.textLayoutBlocks.size()) {
                                                        MessageObject.TextLayoutBlock textLayoutBlock2 = this.captionLayout.textLayoutBlocks.get(i9);
                                                        if (z2) {
                                                            int i10 = textLayoutBlock2.charactersOffset;
                                                            obj = obj2;
                                                            spans2 = spannable.getSpans(i10, i10, obj);
                                                        } else {
                                                            obj = obj2;
                                                            int i11 = textLayoutBlock2.charactersOffset;
                                                            spans2 = spannable.getSpans(i11, i11, ClickableSpan.class);
                                                        }
                                                        CharacterStyle[] characterStyleArr2 = (CharacterStyle[]) spans2;
                                                        if (characterStyleArr2 == null || characterStyleArr2.length == 0 || characterStyleArr2[0] != this.pressedLink.getSpan()) {
                                                            break;
                                                        }
                                                        LinkPath linkPathObtainNewPath2 = this.pressedLink.obtainNewPath();
                                                        linkPathObtainNewPath2.setCurrentLayout(textLayoutBlock2.textLayout, 0, textLayoutBlock2.textYOffset(this.captionLayout.textLayoutBlocks, this.transitionParams) - textLayoutBlock.textYOffset(this.captionLayout.textLayoutBlocks, this.transitionParams));
                                                        int i12 = (realSpanStartAndEnd[1] + textLayoutBlock.charactersOffset) - textLayoutBlock2.charactersOffset;
                                                        textLayoutBlock2.textLayout.getSelectionPath(0, i12, linkPathObtainNewPath2);
                                                        if (i12 < textLayoutBlock2.charactersEnd - 1) {
                                                            break;
                                                        }
                                                        i9++;
                                                        obj2 = obj;
                                                    }
                                                    obj = obj2;
                                                    if (realSpanStartAndEnd[0] <= textLayoutBlock.charactersOffset) {
                                                        int i13 = 0;
                                                        for (int i14 = i3 - 1; i14 >= 0; i14--) {
                                                            MessageObject.TextLayoutBlock textLayoutBlock3 = this.captionLayout.textLayoutBlocks.get(i14);
                                                            if (z2) {
                                                                try {
                                                                    int i15 = textLayoutBlock3.charactersEnd - 1;
                                                                    spans = spannable.getSpans(i15, i15, obj);
                                                                } catch (Exception e2) {
                                                                    e = e2;
                                                                    FileLog.e(e);
                                                                    z3 = true;
                                                                    this.links.addLink(this.pressedLink, 1);
                                                                    invalidate();
                                                                    return z3;
                                                                }
                                                            } else {
                                                                int i16 = textLayoutBlock3.charactersEnd - 1;
                                                                spans = spannable.getSpans(i16, i16, ClickableSpan.class);
                                                            }
                                                            CharacterStyle[] characterStyleArr3 = (CharacterStyle[]) spans;
                                                            if (characterStyleArr3 == null || characterStyleArr3.length == 0 || characterStyleArr3[0] != this.pressedLink.getSpan()) {
                                                                break;
                                                            }
                                                            LinkPath linkPathObtainNewPath3 = this.pressedLink.obtainNewPath();
                                                            i13 -= textLayoutBlock3.height;
                                                            int i17 = realSpanStartAndEnd[0];
                                                            int i18 = textLayoutBlock.charactersOffset;
                                                            int i19 = textLayoutBlock3.charactersOffset;
                                                            int i20 = (i17 + i18) - i19;
                                                            int i21 = (realSpanStartAndEnd[1] + i18) - i19;
                                                            linkPathObtainNewPath3.setCurrentLayout(textLayoutBlock3.textLayout, i20, i13);
                                                            textLayoutBlock3.textLayout.getSelectionPath(i20, i21, linkPathObtainNewPath3);
                                                            if (i20 > textLayoutBlock3.charactersOffset) {
                                                                break;
                                                            }
                                                        }
                                                    }
                                                    z3 = true;
                                                    this.links.addLink(this.pressedLink, 1);
                                                } else {
                                                    obj = obj2;
                                                    if (realSpanStartAndEnd[0] <= textLayoutBlock.charactersOffset) {
                                                    }
                                                    z3 = true;
                                                    this.links.addLink(this.pressedLink, 1);
                                                }
                                            }
                                            invalidate();
                                            return z3;
                                        }
                                        AnimatedEmojiSpan animatedEmojiSpan2 = this.pressedEmoji;
                                        if (animatedEmojiSpan2 == null || animatedEmojiSpan2 != characterStyle) {
                                            resetPressedLink(1);
                                            this.pressedEmoji = (AnimatedEmojiSpan) characterStyleArr[0];
                                            this.pressedLinkType = 1;
                                        }
                                        z3 = true;
                                        invalidate();
                                        return z3;
                                    }
                                    CharacterStyle characterStyle3 = characterStyleArr[0];
                                    if ((characterStyle3 instanceof AnimatedEmojiSpan) && (animatedEmojiSpan = this.pressedEmoji) == characterStyle3) {
                                        if (this.delegate.didPressAnimatedEmoji(this, animatedEmojiSpan)) {
                                            resetPressedLink(1);
                                            this.pressedEmoji = null;
                                            return true;
                                        }
                                        resetPressedLink(1);
                                        this.pressedEmoji = null;
                                    } else {
                                        LinkSpanDrawable linkSpanDrawable3 = this.pressedLink;
                                        if (linkSpanDrawable3 != null && characterStyle3 == linkSpanDrawable3.getSpan()) {
                                            this.delegate.didPressUrl(this, this.pressedLink.getSpan(), false);
                                            resetPressedLink(1);
                                            return true;
                                        }
                                    }
                                }
                            }
                        } catch (Exception e3) {
                            FileLog.e(e3);
                        }
                    }
                }
            }
            i = 1;
            resetPressedLink(1);
            if (motionEvent.getAction() != 0 || motionEvent.getAction() == i) {
                int eventX2 = (int) getEventX(motionEvent);
                int eventY2 = (int) getEventY(motionEvent);
                if (this.pressedLink == null) {
                    float f6 = eventX2;
                    float f7 = this.captionX;
                    if (f6 >= f7) {
                        float f8 = eventY2;
                        float f9 = this.captionY;
                        if (f8 >= f9) {
                            MessageObject.TextLayoutBlocks textLayoutBlocks2 = this.captionLayout;
                            if (f6 <= f7 + textLayoutBlocks2.textWidth && f8 <= f9 + textLayoutBlocks2.textHeight(this.transitionParams)) {
                                int i22 = (int) (f8 - this.captionY);
                                int i23 = 0;
                                while (true) {
                                    if (i23 >= this.captionLayout.textLayoutBlocks.size()) {
                                        break;
                                    }
                                    MessageObject.TextLayoutBlock textLayoutBlock4 = this.captionLayout.textLayoutBlocks.get(i23);
                                    if (textLayoutBlock4.quoteCollapse && textLayoutBlock4.collapsedHeight < textLayoutBlock4.height) {
                                        float f10 = i22;
                                        if (f10 >= textLayoutBlock4.textYOffset(this.captionLayout.textLayoutBlocks, this.transitionParams) && f10 < textLayoutBlock4.textYOffset(this.captionLayout.textLayoutBlocks, this.transitionParams) + textLayoutBlock4.padTop + textLayoutBlock4.height(this.transitionParams) + textLayoutBlock4.padBottom) {
                                            this.pressedBlock = i23;
                                            ButtonBounce buttonBounce = textLayoutBlock4.collapsedBounce;
                                            if (buttonBounce == null || buttonBounce.getView() != this) {
                                                textLayoutBlock4.collapsedBounce = new ButtonBounce(this);
                                            }
                                            textLayoutBlock4.collapsedBounce.setPressed(motionEvent.getAction() == 0);
                                        }
                                    }
                                    i23++;
                                }
                            }
                        }
                    }
                }
                if (motionEvent.getAction() == 1) {
                    if (this.pressedBlock != -1) {
                        for (int i24 = 0; i24 < this.captionLayout.textLayoutBlocks.size(); i24++) {
                            MessageObject.TextLayoutBlock textLayoutBlock5 = this.captionLayout.textLayoutBlocks.get(i24);
                            if (i24 == this.pressedBlock && !this.transitionParams.animateExpandedQuotes) {
                                MessageObject primaryMessageObject = getPrimaryMessageObject();
                                boolean z4 = !textLayoutBlock5.collapsed();
                                HashSet<Integer> hashSet = primaryMessageObject.expandedQuotes == null ? new HashSet<>() : new HashSet<>(primaryMessageObject.expandedQuotes);
                                primaryMessageObject.expandedQuotes = hashSet;
                                Integer numValueOf = Integer.valueOf(textLayoutBlock5.index);
                                if (z4) {
                                    hashSet.remove(numValueOf);
                                } else {
                                    hashSet.add(numValueOf);
                                }
                                ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
                                if (chatMessageCellDelegate2 != null) {
                                    chatMessageCellDelegate2.forceUpdate(this, true);
                                }
                            }
                        }
                    }
                    for (int i25 = 0; i25 < this.captionLayout.textLayoutBlocks.size(); i25++) {
                        ButtonBounce buttonBounce2 = this.captionLayout.textLayoutBlocks.get(i25).collapsedBounce;
                        if (buttonBounce2 != null) {
                            buttonBounce2.setPressed(false);
                        }
                    }
                    this.pressedBlock = -1;
                }
            } else if (motionEvent.getAction() == 3) {
                for (int i26 = 0; i26 < this.captionLayout.textLayoutBlocks.size(); i26++) {
                    ButtonBounce buttonBounce3 = this.captionLayout.textLayoutBlocks.get(i26).collapsedBounce;
                    if (buttonBounce3 != null) {
                        buttonBounce3.setPressed(false);
                    }
                }
                this.pressedBlock = -1;
            }
            return this.pressedBlock == -1;
        }
        if (motionEvent.getAction() == 1) {
            this.pressedCopyCode = null;
            resetCodeSelectors();
        }
        i = 1;
        if (motionEvent.getAction() != 0) {
            int eventX22 = (int) getEventX(motionEvent);
            int eventY22 = (int) getEventY(motionEvent);
            if (this.pressedLink == null) {
            }
            if (motionEvent.getAction() == 1) {
            }
        }
        if (this.pressedBlock == -1) {
        }
    }

    private boolean checkCommentButtonMotionEvent(MotionEvent motionEvent) {
        Drawable drawable;
        Drawable drawable2;
        Drawable drawable3;
        if (!this.drawCommentButton) {
            return false;
        }
        int eventX = (int) getEventX(motionEvent);
        int eventY = (int) getEventY(motionEvent);
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if (groupedMessagePosition != null) {
            int i = groupedMessagePosition.flags;
            if ((i & 1) == 0 || (i & 8) == 0) {
                ViewGroup viewGroup = (ViewGroup) getParent();
                int childCount = viewGroup.getChildCount();
                for (int i2 = 0; i2 < childCount; i2++) {
                    View childAt = viewGroup.getChildAt(i2);
                    if (childAt != this && (childAt instanceof ChatMessageCell)) {
                        ChatMessageCell chatMessageCell = (ChatMessageCell) childAt;
                        if (chatMessageCell.drawCommentButton && chatMessageCell.currentMessagesGroup == this.currentMessagesGroup) {
                            int i3 = chatMessageCell.currentPosition.flags;
                            if ((i3 & 1) != 0 && (i3 & 8) != 0) {
                                MotionEvent motionEventObtain = MotionEvent.obtain(0L, 0L, motionEvent.getActionMasked(), (getEventX(motionEvent) + getLeft()) - chatMessageCell.getLeft(), (getEventY(motionEvent) + getTop()) - chatMessageCell.getTop(), 0);
                                boolean zCheckCommentButtonMotionEvent = chatMessageCell.checkCommentButtonMotionEvent(motionEventObtain);
                                motionEventObtain.recycle();
                                return zCheckCommentButtonMotionEvent;
                            }
                        }
                    }
                }
                return false;
            }
        }
        if (motionEvent.getAction() == 0) {
            if (this.commentButtonRect.contains(eventX, eventY)) {
                if (this.currentMessageObject.isSent()) {
                    this.selectorDrawableMaskType[1] = 2;
                    this.commentButtonPressed = true;
                    if (Build.VERSION.SDK_INT >= 21 && (drawable3 = this.selectorDrawable[1]) != null) {
                        drawable3.setHotspot(eventX, eventY);
                        this.selectorDrawable[1].setState(this.pressedState);
                    }
                    invalidateWithParent();
                }
                return true;
            }
        } else if (motionEvent.getAction() == 1) {
            if (this.commentButtonPressed) {
                ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
                if (chatMessageCellDelegate != null) {
                    if (this.isRepliesChat) {
                        chatMessageCellDelegate.didPressSideButton(this);
                    } else {
                        chatMessageCellDelegate.didPressCommentButton(this);
                    }
                }
                playSoundEffect(0);
                if (Build.VERSION.SDK_INT >= 21 && (drawable2 = this.selectorDrawable[1]) != null) {
                    drawable2.setState(StateSet.NOTHING);
                }
                this.commentButtonPressed = false;
                invalidateWithParent();
            }
        } else if (motionEvent.getAction() == 2 && this.commentButtonPressed && Build.VERSION.SDK_INT >= 21 && (drawable = this.selectorDrawable[1]) != null) {
            drawable.setHotspot(eventX, eventY);
        }
        return false;
    }

    private boolean checkContactMotionEvent(MotionEvent motionEvent) {
        Drawable drawable;
        Drawable drawable2;
        ChatMessageCellDelegate chatMessageCellDelegate;
        int i;
        Drawable drawable3;
        if (this.currentMessageObject.type != 12) {
            return false;
        }
        int eventX = (int) getEventX(motionEvent);
        int eventY = (int) getEventY(motionEvent);
        if (motionEvent.getAction() == 0) {
            ArrayList arrayList = this.contactButtons;
            if (arrayList != null && arrayList.size() > 1) {
                for (int i2 = 0; i2 < this.contactButtons.size(); i2++) {
                    InstantViewButton instantViewButton = (InstantViewButton) this.contactButtons.get(i2);
                    float f = eventX;
                    float f2 = eventY;
                    if (instantViewButton.rect.contains(f, f2)) {
                        if (instantViewButton.buttonBounce == null) {
                            instantViewButton.buttonBounce = new ButtonBounce(this);
                        }
                        instantViewButton.buttonBounce.setPressed(true);
                        if (Build.VERSION.SDK_INT >= 21 && instantViewButton.selectorDrawable != null) {
                            instantViewButton.selectorDrawable.setHotspot(f, f2);
                            instantViewButton.selectorDrawable.setState(this.pressedState);
                        }
                        invalidate();
                        return true;
                    }
                }
            }
            float f3 = eventX;
            float f4 = eventY;
            if (this.contactRect.contains(f3, f4)) {
                this.contactPressed = true;
                this.contactBounce.setPressed(true);
                if (Build.VERSION.SDK_INT >= 21 && (drawable3 = this.selectorDrawable[0]) != null) {
                    drawable3.setHotspot(f3, f4);
                    this.selectorDrawable[0].setState(this.pressedState);
                }
                invalidate();
                return true;
            }
        } else if (motionEvent.getAction() == 1) {
            if (this.contactPressed) {
                if (this.delegate != null) {
                    ArrayList arrayList2 = this.contactButtons;
                    if (arrayList2 == null || arrayList2.size() != 1) {
                        chatMessageCellDelegate = this.delegate;
                        i = 5;
                    } else {
                        chatMessageCellDelegate = this.delegate;
                        i = ((InstantViewButton) this.contactButtons.get(0)).type;
                    }
                    chatMessageCellDelegate.didPressInstantButton(this, i);
                }
                playSoundEffect(0);
                if (Build.VERSION.SDK_INT >= 21 && (drawable2 = this.selectorDrawable[0]) != null) {
                    drawable2.setState(StateSet.NOTHING);
                }
                this.contactPressed = false;
                this.contactBounce.setPressed(false);
                invalidate();
            } else {
                ArrayList arrayList3 = this.contactButtons;
                if (arrayList3 != null && arrayList3.size() > 1) {
                    for (int i3 = 0; i3 < this.contactButtons.size(); i3++) {
                        InstantViewButton instantViewButton2 = (InstantViewButton) this.contactButtons.get(i3);
                        if (instantViewButton2.buttonBounce != null && instantViewButton2.buttonBounce.isPressed()) {
                            ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
                            if (chatMessageCellDelegate2 != null) {
                                chatMessageCellDelegate2.didPressInstantButton(this, instantViewButton2.type);
                            }
                            if (Build.VERSION.SDK_INT >= 21 && instantViewButton2.selectorDrawable != null) {
                                instantViewButton2.selectorDrawable.setState(StateSet.NOTHING);
                            }
                            instantViewButton2.buttonBounce.setPressed(false);
                            playSoundEffect(0);
                            invalidate();
                        }
                    }
                }
            }
        } else if (motionEvent.getAction() == 2) {
            if (!this.contactPressed || Build.VERSION.SDK_INT < 21 || (drawable = this.selectorDrawable[0]) == null) {
                ArrayList arrayList4 = this.contactButtons;
                if (arrayList4 != null && arrayList4.size() > 1) {
                    int i4 = 0;
                    while (true) {
                        if (i4 >= this.contactButtons.size()) {
                            break;
                        }
                        InstantViewButton instantViewButton3 = (InstantViewButton) this.contactButtons.get(i4);
                        if (instantViewButton3.buttonBounce == null || !instantViewButton3.buttonBounce.isPressed()) {
                            i4++;
                        } else if (Build.VERSION.SDK_INT >= 21 && instantViewButton3.selectorDrawable != null) {
                            drawable = instantViewButton3.selectorDrawable;
                        }
                    }
                    drawable.setHotspot(eventX, eventY);
                }
            } else {
                drawable.setHotspot(eventX, eventY);
            }
        }
        return false;
    }

    private boolean checkDateMotionEvent(MotionEvent motionEvent) {
        if (!this.currentMessageObject.isImportedForward()) {
            return false;
        }
        int eventX = (int) getEventX(motionEvent);
        int eventY = (int) getEventY(motionEvent);
        if (motionEvent.getAction() == 0) {
            float f = eventX;
            float f2 = this.drawTimeX;
            if (f < f2 || f > f2 + this.timeWidth) {
                return false;
            }
            float f3 = eventY;
            float f4 = this.drawTimeY;
            if (f3 < f4 || f3 > f4 + AndroidUtilities.dp(20.0f)) {
                return false;
            }
            this.timePressed = true;
        } else {
            if (motionEvent.getAction() != 1 || !this.timePressed) {
                return false;
            }
            this.timePressed = false;
            playSoundEffect(0);
            this.delegate.didPressTime(this);
        }
        invalidate();
        return true;
    }

    private boolean checkEffectMotionEvent(MotionEvent motionEvent) {
        ChatMessageCellDelegate chatMessageCellDelegate;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || messageObject.getEffect() == null) {
            return false;
        }
        float timeX = getTimeX();
        long j = this.effectId;
        float f = BitmapDescriptorFactory.HUE_RED;
        float fDp = timeX - AndroidUtilities.dp(j == 0 ? BitmapDescriptorFactory.HUE_RED : 18.0f);
        float f2 = this.timeWidth;
        if (this.currentMessageObject.sendPreview) {
            f = 1.0f - this.timeAlpha;
        }
        int i = (int) (fDp + (f2 * f));
        int timeY = (int) getTimeY();
        int iDp = i - AndroidUtilities.dp(2.0f);
        int iDp2 = timeY - AndroidUtilities.dp(2.0f);
        RectF rectF = AndroidUtilities.rectTmp;
        rectF.set(iDp, iDp2, iDp + AndroidUtilities.dp(16.0f) + this.timeWidth, iDp2 + AndroidUtilities.dp(16.0f));
        boolean zContains = rectF.contains(getEventX(motionEvent), getEventY(motionEvent));
        if (motionEvent.getAction() == 0) {
            if (zContains) {
                if (this.effectDrawableBounce == null) {
                    this.effectDrawableBounce = new ButtonBounce(this);
                }
                this.pressedEffect = true;
            }
        } else if (motionEvent.getAction() == 2) {
            this.pressedEffect = zContains;
        } else {
            if (motionEvent.getAction() == 1) {
                if (this.pressedEffect && (chatMessageCellDelegate = this.delegate) != null) {
                    chatMessageCellDelegate.didPressEffect(this);
                }
            } else if (motionEvent.getAction() == 3) {
            }
            this.pressedEffect = false;
        }
        ButtonBounce buttonBounce = this.effectDrawableBounce;
        if (buttonBounce != null) {
            buttonBounce.setPressed(this.pressedEffect);
        }
        return this.pressedEffect;
    }

    private boolean checkFactCheckMotionEvent(MotionEvent motionEvent) {
        int i;
        int iDp;
        ChatMessageCellDelegate chatMessageCellDelegate;
        if (!this.hasFactCheck || this.factCheckTitle == null || this.factCheckWhat == null) {
            return false;
        }
        if (this.factCheckWhatBounce == null) {
            this.factCheckWhatBounce = new ButtonBounce(this);
        }
        if (this.factCheckBounce == null) {
            ButtonBounce buttonBounce = new ButtonBounce(this);
            this.factCheckBounce = buttonBounce;
            buttonBounce.setAdditionalInvalidate(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda14
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.invalidateOutbounds();
                }
            });
        }
        float backgroundDrawableRight = getBackgroundDrawableRight();
        TransitionParams transitionParams = this.transitionParams;
        float fDp = ((backgroundDrawableRight + (transitionParams != null ? transitionParams.deltaRight : BitmapDescriptorFactory.HUE_RED)) - AndroidUtilities.dp(10 + ((!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 0 : 6))) - getExtraTextX();
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages == null || groupedMessages.isDocuments) {
            float f = 12.0f;
            if (this.currentMessageObject.isOutOwner()) {
                iDp = this.backgroundDrawableLeft + AndroidUtilities.dp(12.0f) + getExtraTextX();
                if (this.currentMessageObject.type == 19) {
                    iDp -= Math.max(0, ((Math.max(this.replyNameWidth, this.replyTextWidth) + iDp) + AndroidUtilities.dp(14.0f)) - AndroidUtilities.displaySize.x);
                }
            } else {
                if (this.mediaBackground) {
                    i = this.backgroundDrawableLeft;
                } else {
                    i = this.backgroundDrawableLeft;
                    if (!this.drawPinnedBottom) {
                        f = 18.0f;
                    }
                }
                iDp = i + AndroidUtilities.dp(f) + getExtraTextX();
            }
        } else {
            iDp = (int) this.captionX;
        }
        int iDp2 = ((int) (iDp + this.transitionParams.deltaLeft)) - AndroidUtilities.dp(1.33f);
        int i2 = this.factCheckY;
        float f2 = iDp2;
        int i3 = (int) (fDp - f2);
        int eventX = (int) getEventX(motionEvent);
        int eventY = (int) getEventY(motionEvent);
        int iDp3 = (int) (AndroidUtilities.dp(10.0f) + iDp2 + this.factCheckTitle.getCurrentWidth() + AndroidUtilities.dp(4.0f));
        int iDp4 = AndroidUtilities.dp(4.33f) + i2;
        RectF rectF = AndroidUtilities.rectTmp;
        float f3 = iDp3;
        rectF.set(f3, iDp4, this.factCheckWhat.getCurrentWidth() + f3 + AndroidUtilities.dp(4.0f), AndroidUtilities.dp(17.33f) + iDp4);
        boolean zContains = rectF.contains(getEventX(motionEvent), getEventY(motionEvent));
        rectF.set(f2, i2, iDp2 + i3, this.factCheckHeight + i2);
        boolean z = !zContains && !this.hadLongPress && this.pressedFactCheckLink == null && rectF.contains(getEventX(motionEvent), getEventY(motionEvent));
        if (((z && !this.hadLongPress) || this.pressedFactCheckLink != null) && this.factCheckTextLayout != null) {
            if (this.factCheckLinks == null) {
                LinkSpanDrawable.LinkCollector linkCollector = new LinkSpanDrawable.LinkCollector(this);
                this.factCheckLinks = linkCollector;
                linkCollector.setAdditionalInvalidate(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda14
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.invalidateOutbounds();
                    }
                });
            }
            int iDp5 = (iDp2 + AndroidUtilities.dp(10.0f)) - this.factCheckTextLayoutLeft;
            int iDp6 = i2 + AndroidUtilities.dp(22.0f);
            if (motionEvent.getAction() == 0 || (motionEvent.getAction() == 1 && this.pressedFactCheckLink != null)) {
                if (eventX < iDp5 || eventY < iDp6 || eventX > i3 + iDp5 || eventY > this.factCheckTextLayout.getHeight() + iDp6) {
                    resetPressedLink(1);
                } else {
                    try {
                        int i4 = eventY - iDp6;
                        int lineForVertical = this.factCheckTextLayout.getLineForVertical(i4);
                        float f4 = eventX - iDp5;
                        int offsetForHorizontal = this.factCheckTextLayout.getOffsetForHorizontal(lineForVertical, f4);
                        float lineLeft = this.factCheckTextLayout.getLineLeft(lineForVertical);
                        if (lineLeft <= f4 && lineLeft + this.factCheckTextLayout.getLineWidth(lineForVertical) >= f4) {
                            Spannable spannable = (Spannable) this.factCheckTextLayout.getText();
                            CharacterStyle[] characterStyleArr = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, ClickableSpan.class);
                            if (characterStyleArr == null || characterStyleArr.length == 0) {
                                characterStyleArr = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, URLSpanMono.class);
                            }
                            if (characterStyleArr.length != 0 && ((!(characterStyleArr[0] instanceof URLSpanBotCommand) || URLSpanBotCommand.enabled) && !AndroidUtilities.isAccessibilityScreenReaderEnabled())) {
                                if (motionEvent.getAction() == 0) {
                                    LinkSpanDrawable linkSpanDrawable = this.pressedFactCheckLink;
                                    if (linkSpanDrawable == null || linkSpanDrawable.getSpan() != characterStyleArr[0]) {
                                        this.factCheckLinks.removeLink(this.pressedFactCheckLink);
                                        CharacterStyle characterStyle = characterStyleArr[0];
                                        LinkSpanDrawable linkSpanDrawable2 = new LinkSpanDrawable(characterStyle, this.resourcesProvider, f4, i4, spanSupportsLongPress(characterStyle));
                                        this.pressedFactCheckLink = linkSpanDrawable2;
                                        ReplyMessageLine replyMessageLine = this.factCheckLine;
                                        if (replyMessageLine != null) {
                                            linkSpanDrawable2.setColor(Theme.multAlpha(replyMessageLine.getColor(), 0.1f));
                                        }
                                        try {
                                            LinkPath linkPathObtainNewPath = this.pressedFactCheckLink.obtainNewPath();
                                            int[] realSpanStartAndEnd = getRealSpanStartAndEnd(spannable, this.pressedFactCheckLink.getSpan());
                                            linkPathObtainNewPath.setCurrentLayout(this.factCheckTextLayout, realSpanStartAndEnd[0], BitmapDescriptorFactory.HUE_RED);
                                            this.factCheckTextLayout.getSelectionPath(realSpanStartAndEnd[0], realSpanStartAndEnd[1], linkPathObtainNewPath);
                                        } catch (Exception e) {
                                            FileLog.e(e);
                                        }
                                        this.factCheckLinks.addLink(this.pressedFactCheckLink, 1);
                                        z = false;
                                    }
                                    invalidate();
                                } else {
                                    LinkSpanDrawable linkSpanDrawable3 = this.pressedFactCheckLink;
                                    if (linkSpanDrawable3 != null && characterStyleArr[0] == linkSpanDrawable3.getSpan()) {
                                        this.delegate.didPressUrl(this, this.pressedFactCheckLink.getSpan(), false);
                                        resetPressedLink(1);
                                        this.factCheckWhatPressed = false;
                                        this.factCheckPressed = false;
                                        this.pressedFactCheckLink = null;
                                    }
                                }
                            }
                        }
                    } catch (Exception e2) {
                        FileLog.e(e2);
                    }
                }
            }
        }
        boolean z2 = this.factCheckLarge && z;
        if (motionEvent.getAction() == 0 || motionEvent.getAction() == 2) {
            this.factCheckWhatPressed = zContains;
            this.factCheckPressed = z2;
        } else if (motionEvent.getAction() == 1) {
            if (this.factCheckWhatPressed) {
                ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
                if (chatMessageCellDelegate2 != null) {
                    chatMessageCellDelegate2.didPressFactCheckWhat(this, (int) (iDp3 + AndroidUtilities.dp(4.0f) + (this.factCheckWhat.getCurrentWidth() / 2.0f)), iDp4);
                }
            } else if (this.factCheckPressed && !this.transitionParams.animateFactCheckExpanded && (chatMessageCellDelegate = this.delegate) != null) {
                chatMessageCellDelegate.didPressFactCheck(this);
            }
            this.factCheckWhatPressed = false;
            this.factCheckPressed = false;
        } else if (motionEvent.getAction() == 3) {
            this.factCheckWhatPressed = false;
            this.factCheckPressed = false;
            LinkSpanDrawable.LinkCollector linkCollector2 = this.factCheckLinks;
            if (linkCollector2 != null) {
                linkCollector2.clear();
            }
            this.pressedFactCheckLink = null;
        }
        this.factCheckWhatBounce.setPressed(this.factCheckWhatPressed);
        this.factCheckBounce.setPressed(this.factCheckPressed);
        return this.factCheckWhatPressed || this.factCheckPressed || this.pressedFactCheckLink != null;
    }

    private boolean checkGameMotionEvent(MotionEvent motionEvent) {
        int i;
        int i2;
        if (!this.hasGamePreview) {
            return false;
        }
        int eventX = (int) getEventX(motionEvent);
        int eventY = (int) getEventY(motionEvent);
        if (motionEvent.getAction() == 0) {
            if (this.drawPhotoImage && this.drawImageButton && this.buttonState != -1 && eventX >= (i = this.buttonX) && eventX <= i + AndroidUtilities.dp(48.0f) && eventY >= (i2 = this.buttonY) && eventY <= i2 + AndroidUtilities.dp(48.0f) && this.radialProgress.getIcon() != 4) {
                this.buttonPressed = 1;
                invalidate();
                return true;
            }
            if (this.drawPhotoImage && this.photoImage.isInsideImage(eventX, eventY)) {
                this.gamePreviewPressed = true;
                return true;
            }
            if (this.descriptionLayout != null && eventY >= this.descriptionY) {
                try {
                    int iDp = eventX - ((this.unmovedTextX + AndroidUtilities.dp(10.0f)) + this.descriptionX);
                    int i3 = eventY - this.descriptionY;
                    int lineForVertical = this.descriptionLayout.getLineForVertical(i3);
                    float f = iDp;
                    int offsetForHorizontal = this.descriptionLayout.getOffsetForHorizontal(lineForVertical, f);
                    float lineLeft = this.descriptionLayout.getLineLeft(lineForVertical);
                    if (lineLeft <= f && lineLeft + this.descriptionLayout.getLineWidth(lineForVertical) >= f) {
                        Spannable spannable = (Spannable) this.currentMessageObject.linkDescription;
                        ClickableSpan[] clickableSpanArr = (ClickableSpan[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, ClickableSpan.class);
                        if (clickableSpanArr.length != 0 && ((!(clickableSpanArr[0] instanceof URLSpanBotCommand) || URLSpanBotCommand.enabled) && !AndroidUtilities.isAccessibilityScreenReaderEnabled())) {
                            LinkSpanDrawable linkSpanDrawable = this.pressedLink;
                            if (linkSpanDrawable == null || linkSpanDrawable.getSpan() != clickableSpanArr[0]) {
                                this.links.removeLink(this.pressedLink);
                                ClickableSpan clickableSpan = clickableSpanArr[0];
                                LinkSpanDrawable linkSpanDrawable2 = new LinkSpanDrawable(clickableSpan, this.resourcesProvider, f, i3, spanSupportsLongPress(clickableSpan));
                                this.pressedLink = linkSpanDrawable2;
                                linkSpanDrawable2.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outLinkSelectBackground : Theme.key_chat_linkSelectBackground));
                                this.linkBlockNum = -10;
                                this.pressedLinkType = 2;
                                try {
                                    LinkPath linkPathObtainNewPath = this.pressedLink.obtainNewPath();
                                    int[] realSpanStartAndEnd = getRealSpanStartAndEnd(spannable, this.pressedLink.getSpan());
                                    linkPathObtainNewPath.setCurrentLayout(this.descriptionLayout, realSpanStartAndEnd[0], BitmapDescriptorFactory.HUE_RED);
                                    this.descriptionLayout.getSelectionPath(realSpanStartAndEnd[0], realSpanStartAndEnd[1], linkPathObtainNewPath);
                                } catch (Exception e) {
                                    FileLog.e(e);
                                }
                                this.links.addLink(this.pressedLink, 2);
                            }
                            invalidate();
                            return true;
                        }
                    }
                } catch (Exception e2) {
                    FileLog.e(e2);
                }
            }
        } else if (motionEvent.getAction() == 1) {
            if (this.pressedLinkType != 2 && !this.gamePreviewPressed && this.buttonPressed == 0) {
                resetPressedLink(2);
            } else if (this.buttonPressed != 0) {
                this.buttonPressed = 0;
                playSoundEffect(0);
                didPressButton(true, false);
                invalidate();
            } else {
                LinkSpanDrawable linkSpanDrawable3 = this.pressedLink;
                if (linkSpanDrawable3 == null) {
                    this.gamePreviewPressed = false;
                    int i4 = 0;
                    while (true) {
                        if (i4 >= this.botButtons.size()) {
                            break;
                        }
                        BotButton botButton = (BotButton) this.botButtons.get(i4);
                        if (botButton.button instanceof TLRPC.TL_keyboardButtonGame) {
                            playSoundEffect(0);
                            this.delegate.didPressBotButton(this, botButton.button);
                            invalidate();
                            break;
                        }
                        i4++;
                    }
                    resetPressedLink(2);
                    return true;
                }
                if (linkSpanDrawable3.getSpan() instanceof URLSpan) {
                    Browser.openUrl(getContext(), ((URLSpan) this.pressedLink.getSpan()).getURL());
                } else if (this.pressedLink.getSpan() instanceof ClickableSpan) {
                    ((ClickableSpan) this.pressedLink.getSpan()).onClick(this);
                }
                resetPressedLink(2);
            }
        }
        return false;
    }

    private void checkImageReceiversAttachState() {
        boolean z = this.attachedToWindow;
        boolean z2 = false;
        if (z != this.imageReceiversAttachState) {
            this.imageReceiversAttachState = z;
            if (z) {
                this.radialProgress.onAttachedToWindow();
                this.videoRadialProgress.onAttachedToWindow();
                if (this.pollAvatarImages != null) {
                    int i = 0;
                    while (true) {
                        ImageReceiver[] imageReceiverArr = this.pollAvatarImages;
                        if (i >= imageReceiverArr.length) {
                            break;
                        }
                        imageReceiverArr[i].onAttachedToWindow();
                        i++;
                    }
                }
                if (this.commentAvatarImages != null) {
                    int i2 = 0;
                    while (true) {
                        ImageReceiver[] imageReceiverArr2 = this.commentAvatarImages;
                        if (i2 >= imageReceiverArr2.length) {
                            break;
                        }
                        imageReceiverArr2[i2].onAttachedToWindow();
                        i2++;
                    }
                }
                this.giveawayMessageCell.onAttachedToWindow();
                this.giveawayResultsMessageCell.onAttachedToWindow();
                this.replyImageReceiver.onAttachedToWindow();
                this.locationImageReceiver.onAttachedToWindow();
                this.blurredPhotoImage.onAttachedToWindow();
                if (!this.photoImage.onAttachedToWindow() || this.drawPhotoImage) {
                    updateButtonState(false, false, false);
                }
                this.animatedEmojiReplyStack = AnimatedEmojiSpan.update(0, (View) this, false, this.animatedEmojiReplyStack, this.replyTextLayout);
                this.animatedEmojiDescriptionStack = AnimatedEmojiSpan.update(0, (View) this, false, this.animatedEmojiDescriptionStack, this.descriptionLayout);
                updateAnimatedEmojis();
            } else {
                this.radialProgress.onDetachedFromWindow();
                this.videoRadialProgress.onDetachedFromWindow();
                if (this.pollAvatarImages != null) {
                    int i3 = 0;
                    while (true) {
                        ImageReceiver[] imageReceiverArr3 = this.pollAvatarImages;
                        if (i3 >= imageReceiverArr3.length) {
                            break;
                        }
                        imageReceiverArr3[i3].onDetachedFromWindow();
                        i3++;
                    }
                }
                if (this.commentAvatarImages != null) {
                    int i4 = 0;
                    while (true) {
                        ImageReceiver[] imageReceiverArr4 = this.commentAvatarImages;
                        if (i4 >= imageReceiverArr4.length) {
                            break;
                        }
                        imageReceiverArr4[i4].onDetachedFromWindow();
                        i4++;
                    }
                }
                this.replyImageReceiver.onDetachedFromWindow();
                this.locationImageReceiver.onDetachedFromWindow();
                this.photoImage.onDetachedFromWindow();
                this.blurredPhotoImage.onDetachedFromWindow();
                this.giveawayMessageCell.onDetachedFromWindow();
                this.giveawayResultsMessageCell.onDetachedFromWindow();
                AnimatedEmojiSpan.release(this, this.animatedEmojiDescriptionStack);
                AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                AnimatedEmojiSpan.release(this, this.animatedEmojiStack);
            }
        }
        if (this.attachedToWindow && (this.visibleOnScreen || !this.shouldCheckVisibleOnScreen)) {
            z2 = true;
        }
        if (z2 != this.imageReceiversVisibleState) {
            this.imageReceiversVisibleState = z2;
            if (z2) {
                fileAttach(true, this.currentMessageObject);
            } else {
                fileDetach(this.currentMessageObject);
            }
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:50:0x00cf  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkInstantButtonMotionEvent(MotionEvent motionEvent) {
        Drawable drawable;
        Drawable drawable2;
        if (!this.currentMessageObject.isSponsored() && !this.currentMessageObject.isUnsupported() && (!this.drawInstantView || this.currentMessageObject.type == 0)) {
            return false;
        }
        int eventX = (int) getEventX(motionEvent);
        int eventY = (int) getEventY(motionEvent);
        if (motionEvent.getAction() == 0) {
            if (this.drawInstantView) {
                float f = eventX;
                float f2 = eventY;
                if (this.instantButtonRect.contains(f, f2)) {
                    this.selectorDrawableMaskType[0] = this.lastPoll == null ? 0 : 2;
                    this.instantPressed = true;
                    if (Build.VERSION.SDK_INT >= 21 && this.selectorDrawable[0] != null && this.instantButtonRect.contains(f, f2)) {
                        this.selectorDrawable[0].setHotspot(f, f2);
                        this.selectorDrawable[0].setState(this.pressedState);
                        setInstantButtonPressed(true);
                    }
                    invalidate();
                    return true;
                }
            }
        } else if (motionEvent.getAction() == 1) {
            if (this.instantPressed) {
                ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
                if (chatMessageCellDelegate != null) {
                    if (this.lastPoll != null) {
                        MessageObject messageObject = this.currentMessageObject;
                        if (messageObject.scheduled) {
                            Toast.makeText(getContext(), LocaleController.getString(R.string.MessageScheduledVoteResults), 1).show();
                        } else if (this.pollVoted || this.pollClosed) {
                            chatMessageCellDelegate.didPressInstantButton(this, this.drawInstantViewType);
                        } else {
                            if (!messageObject.checkedVotes.isEmpty()) {
                                this.pollVoteInProgressNum = -1;
                                this.pollVoteInProgress = true;
                                this.vibrateOnPollVote = true;
                                this.voteCurrentProgressTime = BitmapDescriptorFactory.HUE_RED;
                                this.firstCircleLength = true;
                                this.voteCurrentCircleLength = 360.0f;
                                this.voteRisingCircleLength = false;
                            }
                            this.delegate.didPressVoteButtons(this, this.currentMessageObject.checkedVotes, -1, 0, this.namesOffset);
                        }
                    }
                }
                playSoundEffect(0);
                if (Build.VERSION.SDK_INT >= 21 && (drawable2 = this.selectorDrawable[0]) != null) {
                    drawable2.setState(StateSet.NOTHING);
                }
                this.instantPressed = false;
                setInstantButtonPressed(false);
                invalidate();
            }
        } else if (motionEvent.getAction() == 2 && this.instantButtonPressed && Build.VERSION.SDK_INT >= 21 && (drawable = this.selectorDrawable[0]) != null) {
            drawable.setHotspot(eventX, eventY);
        }
        return false;
    }

    private boolean checkLinkPreviewMotionEvent(MotionEvent motionEvent) throws Resources.NotFoundException, NumberFormatException {
        int i;
        MessageObject messageObject;
        TLRPC.TL_channelAdminLogEvent tL_channelAdminLogEvent;
        int i2;
        int i3;
        int i4;
        int i5;
        int iDp;
        int iDp2;
        int i6;
        int themedColor;
        MessageObject messageObject2;
        int i7 = this.currentMessageObject.type;
        if ((i7 != 0 && i7 != 24) || !this.hasLinkPreview) {
            return false;
        }
        int eventX = (int) getEventX(motionEvent);
        int eventY = (int) getEventY(motionEvent);
        int i8 = this.unmovedTextX;
        if (eventX >= i8 && eventX <= (i8 + this.backgroundWidth) - AndroidUtilities.dp(14.0f) && eventY >= (i = this.linkPreviewY)) {
            if (eventY <= i + this.linkPreviewHeight + AndroidUtilities.dp((this.drawInstantView ? 46 : 0) + 8)) {
                if (motionEvent.getAction() == 0) {
                    if (this.descriptionLayout != null && eventY >= this.descriptionY && !this.currentMessageObject.preview) {
                        try {
                            int iDp3 = eventX - ((this.unmovedTextX + AndroidUtilities.dp(10.0f)) + this.descriptionX);
                            int i9 = eventY - this.descriptionY;
                            if (i9 <= this.descriptionLayout.getHeight()) {
                                int lineForVertical = this.descriptionLayout.getLineForVertical(i9);
                                float f = iDp3;
                                int offsetForHorizontal = this.descriptionLayout.getOffsetForHorizontal(lineForVertical, f);
                                float lineLeft = this.descriptionLayout.getLineLeft(lineForVertical);
                                if (lineLeft <= f && lineLeft + this.descriptionLayout.getLineWidth(lineForVertical) >= f) {
                                    Spannable spannable = (Spannable) (this.currentMessageObject.isSponsored() ? this.currentMessageObject.messageText : this.currentMessageObject.linkDescription);
                                    ClickableSpan[] clickableSpanArr = (ClickableSpan[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, ClickableSpan.class);
                                    if (clickableSpanArr.length != 0 && ((!(clickableSpanArr[0] instanceof URLSpanBotCommand) || URLSpanBotCommand.enabled) && !AndroidUtilities.isAccessibilityScreenReaderEnabled())) {
                                        LinkSpanDrawable linkSpanDrawable = this.pressedLink;
                                        if (linkSpanDrawable == null || linkSpanDrawable.getSpan() != clickableSpanArr[0]) {
                                            this.links.removeLink(this.pressedLink);
                                            ClickableSpan clickableSpan = clickableSpanArr[0];
                                            LinkSpanDrawable linkSpanDrawable2 = new LinkSpanDrawable(clickableSpan, this.resourcesProvider, eventX, eventY, spanSupportsLongPress(clickableSpan));
                                            this.pressedLink = linkSpanDrawable2;
                                            if (!this.hasLinkPreview || this.linkLine == null || (messageObject2 = this.currentMessageObject) == null || messageObject2.isOutOwner()) {
                                                themedColor = getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outLinkSelectBackground : Theme.key_chat_linkSelectBackground);
                                            } else {
                                                themedColor = Theme.multAlpha(this.linkLine.getColor(), 0.1f);
                                            }
                                            linkSpanDrawable2.setColor(themedColor);
                                            this.linkBlockNum = -10;
                                            this.pressedLinkType = 2;
                                            startCheckLongPress();
                                            try {
                                                LinkPath linkPathObtainNewPath = this.pressedLink.obtainNewPath();
                                                int[] realSpanStartAndEnd = getRealSpanStartAndEnd(spannable, this.pressedLink.getSpan());
                                                linkPathObtainNewPath.setCurrentLayout(this.descriptionLayout, realSpanStartAndEnd[0], BitmapDescriptorFactory.HUE_RED);
                                                this.descriptionLayout.getSelectionPath(realSpanStartAndEnd[0], realSpanStartAndEnd[1], linkPathObtainNewPath);
                                            } catch (Exception e) {
                                                FileLog.e(e);
                                            }
                                            this.links.addLink(this.pressedLink, 2);
                                        }
                                        invalidate();
                                        return true;
                                    }
                                }
                            }
                        } catch (Exception e2) {
                            FileLog.e(e2);
                        }
                    }
                    if (this.pressedLink == null) {
                        int iDp4 = AndroidUtilities.dp(48.0f);
                        if (this.miniButtonState >= 0 && eventX >= (iDp2 = this.buttonX + (iDp = AndroidUtilities.dp(27.0f))) && eventX <= iDp2 + iDp4 && eventY >= (i6 = this.buttonY + iDp) && eventY <= i6 + iDp4) {
                            this.miniButtonPressed = 1;
                        } else {
                            if (!this.drawVideoImageButton || this.buttonState == -1 || eventX < (i4 = this.videoButtonX) || eventX > i4 + AndroidUtilities.dp(34.0f) + Math.max(this.infoWidth, this.docTitleWidth) || eventY < (i5 = this.videoButtonY) || eventY > i5 + AndroidUtilities.dp(30.0f)) {
                                if (!(this.drawPhotoImage && this.currentMessageObject.sponsoredMedia != null && this.photoImage.isInsideImage(eventX, eventY)) && (!this.drawPhotoImage || !this.drawImageButton || this.buttonState == -1 || ((this.checkOnlyButtonPressed || !this.photoImage.isInsideImage(eventX, eventY)) && (eventX < (i2 = this.buttonX) || eventX > i2 + AndroidUtilities.dp(48.0f) || eventY < (i3 = this.buttonY) || eventY > i3 + AndroidUtilities.dp(48.0f) || this.radialProgress.getIcon() == 4)))) {
                                    this.instantPressed = true;
                                    this.selectorDrawableMaskType[0] = 0;
                                    if (Build.VERSION.SDK_INT >= 21) {
                                        Drawable drawable = this.selectorDrawable[0];
                                        if (drawable != null && drawable.getBounds().contains(eventX, eventY)) {
                                            this.selectorDrawable[0].setHotspot(eventX, eventY);
                                            this.selectorDrawable[0].setState(this.pressedState);
                                        }
                                        Drawable drawable2 = this.linkPreviewSelector;
                                        if (drawable2 != null && drawable2.getBounds().contains(eventX, eventY)) {
                                            this.linkPreviewSelector.setHotspot(eventX, eventY);
                                            this.linkPreviewSelector.setState(this.pressedState);
                                        }
                                        setInstantButtonPressed(true);
                                    }
                                    ButtonBounce buttonBounce = this.linkPreviewBounce;
                                    if (buttonBounce != null) {
                                        buttonBounce.setPressed(true);
                                    }
                                    invalidate();
                                    return true;
                                }
                                this.buttonPressed = 1;
                                invalidate();
                                TLRPC.MessageMedia messageMedia = this.currentMessageObject.sponsoredMedia;
                                if (messageMedia != null && (MessageObject.isGifDocument(messageMedia.document) || this.currentMessageObject.sponsoredMedia.photo != null)) {
                                    if (Build.VERSION.SDK_INT >= 21) {
                                        Drawable drawable3 = this.selectorDrawable[0];
                                        if (drawable3 != null && drawable3.getBounds().contains(eventX, eventY)) {
                                            this.selectorDrawable[0].setHotspot(eventX, eventY);
                                            this.selectorDrawable[0].setState(this.pressedState);
                                        }
                                        Drawable drawable4 = this.linkPreviewSelector;
                                        if (drawable4 != null && drawable4.getBounds().contains(eventX, eventY)) {
                                            this.linkPreviewSelector.setHotspot(eventX, eventY);
                                            this.linkPreviewSelector.setState(this.pressedState);
                                        }
                                        setInstantButtonPressed(true);
                                    }
                                    ButtonBounce buttonBounce2 = this.linkPreviewBounce;
                                    if (buttonBounce2 != null) {
                                        buttonBounce2.setPressed(true);
                                    }
                                }
                                return true;
                            }
                            this.videoButtonPressed = 1;
                        }
                        invalidate();
                        return true;
                    }
                } else if (motionEvent.getAction() == 1) {
                    if (this.instantPressed) {
                        int i10 = this.documentAttachType;
                        if (i10 == 7) {
                            if (!MediaController.getInstance().isPlayingMessage(this.currentMessageObject) || MediaController.getInstance().isMessagePaused()) {
                                this.delegate.needPlayMessage(this, this.currentMessageObject, false);
                            } else {
                                MediaController.getInstance().lambda$startAudioAgain$7(this.currentMessageObject);
                            }
                        } else if (this.drawInstantView || !((messageObject = this.currentMessageObject) == null || (tL_channelAdminLogEvent = messageObject.currentEvent) == null || !(tL_channelAdminLogEvent.action instanceof TLRPC.TL_channelAdminLogEventActionEditMessage))) {
                            ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
                            if (chatMessageCellDelegate != null) {
                                chatMessageCellDelegate.didPressInstantButton(this, this.drawInstantViewType);
                            }
                        } else if (this.drawPhotoImage && (i10 == 2 || i10 == 4 || (this.authorLayout == null && this.titleLayout == null && this.descriptionLayout == null && this.siteNameLayout == null))) {
                            ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
                            if (chatMessageCellDelegate2 != null) {
                                chatMessageCellDelegate2.didPressImage(this, this.lastTouchX, this.lastTouchY, true);
                            }
                        } else if (!messageObject.preview) {
                            TLRPC.WebPage webPage = MessageObject.getMedia(messageObject.messageOwner).webpage;
                            if (webPage != null && !TextUtils.isEmpty(webPage.embed_url)) {
                                ChatMessageCellDelegate chatMessageCellDelegate3 = this.delegate;
                                if (chatMessageCellDelegate3 != null) {
                                    chatMessageCellDelegate3.needOpenWebView(this.currentMessageObject, webPage.embed_url, webPage.site_name, webPage.title, webPage.url, webPage.embed_width, webPage.embed_height);
                                }
                            } else if (webPage != null) {
                                ChatMessageCellDelegate chatMessageCellDelegate4 = this.delegate;
                                if (chatMessageCellDelegate4 != null) {
                                    chatMessageCellDelegate4.didPressWebPage(this, webPage, webPage.url, MessageObject.getMedia(this.currentMessageObject.messageOwner).safe);
                                } else {
                                    Browser.openUrl(getContext(), webPage.url);
                                }
                            }
                        }
                        playSoundEffect(0);
                        if (Build.VERSION.SDK_INT >= 21) {
                            Drawable drawable5 = this.selectorDrawable[0];
                            if (drawable5 != null) {
                                drawable5.setState(StateSet.NOTHING);
                            }
                            Drawable drawable6 = this.linkPreviewSelector;
                            if (drawable6 != null) {
                                drawable6.setState(StateSet.NOTHING);
                            }
                        }
                        ButtonBounce buttonBounce3 = this.linkPreviewBounce;
                        if (buttonBounce3 != null) {
                            buttonBounce3.setPressed(false);
                        }
                        this.instantPressed = false;
                        setInstantButtonPressed(false);
                    } else {
                        if (this.pressedLinkType != 2 && this.buttonPressed == 0 && this.miniButtonPressed == 0 && this.videoButtonPressed == 0 && !this.linkPreviewPressed) {
                            if (!this.hadLongPress) {
                                this.hadLongPress = false;
                            }
                        } else if (this.videoButtonPressed == 1) {
                            this.videoButtonPressed = 0;
                            playSoundEffect(0);
                            didPressButton(true, true);
                        } else if (this.buttonPressed != 0) {
                            this.buttonPressed = 0;
                            playSoundEffect(0);
                            if (this.drawVideoImageButton || this.currentMessageObject.sponsoredMedia != null) {
                                didClickedImage();
                            } else {
                                didPressButton(true, false);
                            }
                        } else if (this.miniButtonPressed != 0) {
                            this.miniButtonPressed = 0;
                            playSoundEffect(0);
                            didPressMiniButton(true);
                        } else {
                            LinkSpanDrawable linkSpanDrawable3 = this.pressedLink;
                            if (linkSpanDrawable3 == null) {
                                AnimatedEmojiSpan animatedEmojiSpan = this.pressedEmoji;
                                if (animatedEmojiSpan == null || !this.delegate.didPressAnimatedEmoji(this, animatedEmojiSpan)) {
                                    if (this.documentAttachType == 2 && this.drawImageButton) {
                                        int i11 = this.buttonState;
                                        if (i11 == -1) {
                                            if (!SharedConfig.isAutoplayGifs() || this.currentMessageObject.isRepostPreview) {
                                                this.buttonState = 2;
                                                this.currentMessageObject.gifState = 1.0f;
                                                this.photoImage.setAllowStartAnimation(false);
                                                this.photoImage.stopAnimation();
                                                this.radialProgress.setIcon(getIconForCurrentState(), false, true);
                                                invalidate();
                                                playSoundEffect(0);
                                            } else {
                                                this.delegate.didPressImage(this, this.lastTouchX, this.lastTouchY, false);
                                            }
                                        } else if (i11 == 2 || i11 == 0) {
                                            didPressButton(true, false);
                                            playSoundEffect(0);
                                        }
                                    } else {
                                        MessageObject messageObject3 = this.currentMessageObject;
                                        if (!messageObject3.preview) {
                                            TLRPC.WebPage webPage2 = MessageObject.getMedia(messageObject3.messageOwner).webpage;
                                            if (webPage2 == null || TextUtils.isEmpty(webPage2.embed_url)) {
                                                int i12 = this.buttonState;
                                                if (i12 == -1 || i12 == 3) {
                                                    this.delegate.didPressImage(this, this.lastTouchX, this.lastTouchY, false);
                                                    playSoundEffect(0);
                                                } else if (webPage2 != null) {
                                                    ChatMessageCellDelegate chatMessageCellDelegate5 = this.delegate;
                                                    if (chatMessageCellDelegate5 != null) {
                                                        chatMessageCellDelegate5.didPressWebPage(this, webPage2, webPage2.url, MessageObject.getMedia(this.currentMessageObject.messageOwner).safe);
                                                    } else {
                                                        Browser.openUrl(getContext(), webPage2.url);
                                                    }
                                                }
                                            } else {
                                                this.delegate.needOpenWebView(this.currentMessageObject, webPage2.embed_url, webPage2.site_name, webPage2.title, webPage2.url, webPage2.embed_width, webPage2.embed_height);
                                            }
                                        }
                                    }
                                    resetPressedLink(2);
                                    return true;
                                }
                                this.pressedEmoji = null;
                            } else if (linkSpanDrawable3.getSpan() instanceof URLSpan) {
                                this.delegate.didPressUrl(this, this.pressedLink.getSpan(), false);
                            } else if (this.pressedLink.getSpan() instanceof ClickableSpan) {
                                ((ClickableSpan) this.pressedLink.getSpan()).onClick(this);
                            }
                        }
                        resetPressedLink(2);
                    }
                    invalidate();
                } else if (motionEvent.getAction() == 2 && this.instantButtonPressed && Build.VERSION.SDK_INT >= 21) {
                    Drawable drawable7 = this.selectorDrawable[0];
                    if (drawable7 != null) {
                        drawable7.setHotspot(eventX, eventY);
                    }
                    Drawable drawable8 = this.linkPreviewSelector;
                    if (drawable8 != null) {
                        drawable8.setHotspot(eventX, eventY);
                    }
                }
            }
        }
        return false;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void checkLocationExpired() throws Resources.NotFoundException, NumberFormatException {
        boolean zIsCurrentLocationTimeExpired;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || (zIsCurrentLocationTimeExpired = isCurrentLocationTimeExpired(messageObject)) == this.locationExpired) {
            return;
        }
        this.locationExpired = zIsCurrentLocationTimeExpired;
        if (zIsCurrentLocationTimeExpired) {
            MessageObject messageObject2 = this.currentMessageObject;
            this.currentMessageObject = null;
            setMessageObject(messageObject2, this.currentMessagesGroup, this.pinnedBottom, this.pinnedTop, this.firstInChat);
        } else {
            AndroidUtilities.runOnUIThread(this.invalidateRunnable, 1000L);
            this.scheduledInvalidate = true;
            int iDp = this.backgroundWidth - AndroidUtilities.dp(91.0f);
            this.docTitleLayout = new StaticLayout(TextUtils.ellipsize(LocaleController.getString(R.string.AttachLiveLocation), Theme.chat_locationTitlePaint, iDp, TextUtils.TruncateAt.END), Theme.chat_locationTitlePaint, iDp, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
        }
    }

    private boolean checkNameMotionEvent(MotionEvent motionEvent) {
        Drawable drawable;
        ChatMessageCellDelegate chatMessageCellDelegate;
        TLRPC.Chat chat;
        int i;
        if (!this.drawNameLayout || this.nameLayout == null || (drawable = this.nameLayoutSelector) == null || (this.currentUser == null && this.currentChat == null)) {
            this.nameLayoutPressed = false;
            return false;
        }
        boolean zContains = drawable.getBounds().contains((int) getEventX(motionEvent), (int) getEventY(motionEvent));
        if (motionEvent.getAction() == 0) {
            this.nameLayoutPressed = zContains;
            if (zContains) {
                if (Build.VERSION.SDK_INT >= 21) {
                    this.nameLayoutSelector.setHotspot((int) getEventX(motionEvent), (int) getEventY(motionEvent));
                }
                this.nameLayoutSelector.setState(this.pressedState);
            }
        } else if (motionEvent.getAction() == 1 || motionEvent.getAction() == 3) {
            if (motionEvent.getAction() == 1 && this.nameLayoutPressed && (chatMessageCellDelegate = this.delegate) != null) {
                if (this.viaOnly) {
                    TLRPC.User user = this.currentViaBotUser;
                    if (user == null || user.bot_inline_placeholder != null) {
                        chatMessageCellDelegate.didPressViaBot(this, user != null ? user.username : this.currentMessageObject.messageOwner.via_bot_name);
                    } else {
                        chatMessageCellDelegate.didPressViaBotNotInline(this, user.id);
                    }
                } else {
                    TLRPC.User user2 = this.currentUser;
                    if (user2 != null) {
                        chatMessageCellDelegate.didPressUserAvatar(this, user2, getEventX(motionEvent), getEventY(motionEvent), false);
                    } else {
                        TLRPC.Chat chat2 = this.currentChat;
                        if (chat2 != null) {
                            TLRPC.MessageFwdHeader messageFwdHeader = this.currentMessageObject.messageOwner.fwd_from;
                            if (messageFwdHeader != null) {
                                int i2 = messageFwdHeader.channel_post;
                                chat = this.currentForwardChannel;
                                i = i2;
                            } else {
                                chat = chat2;
                                i = 0;
                            }
                            chatMessageCellDelegate.didPressChannelAvatar(this, chat != null ? chat : chat2, i, this.lastTouchX, this.lastTouchY, false);
                        }
                    }
                }
            }
            this.nameLayoutSelector.setState(StateSet.NOTHING);
            this.nameLayoutPressed = false;
        }
        return this.nameLayoutPressed;
    }

    private boolean checkNameStatusMotionEvent(MotionEvent motionEvent) {
        if (!this.drawNameLayout || this.nameLayout == null || this.nameLayoutSelector == null || ((this.currentUser == null && this.currentChat == null) || this.currentNameStatus == null || this.currentNameStatusDrawable == null)) {
            this.nameStatusPressed = false;
            return false;
        }
        boolean zContains = this.nameStatusSelector.getBounds().contains((int) getEventX(motionEvent), (int) getEventY(motionEvent));
        if (motionEvent.getAction() == 0) {
            this.nameStatusPressed = zContains;
            if (zContains) {
                if (Build.VERSION.SDK_INT >= 21) {
                    this.nameStatusSelector.setHotspot((int) getEventX(motionEvent), (int) getEventY(motionEvent));
                }
                this.nameStatusSelector.setState(this.pressedState);
            }
        } else if (motionEvent.getAction() == 1 || motionEvent.getAction() == 3) {
            if (motionEvent.getAction() == 1 && this.nameStatusPressed && this.delegate != null && this.currentUser != null) {
                this.delegate.didPressUserStatus(this, this.currentUser, this.currentNameStatusDrawable.getDrawable() instanceof AnimatedEmojiDrawable ? ((AnimatedEmojiDrawable) this.currentNameStatusDrawable.getDrawable()).getDocument() : null, this.nameStatusSlug);
                invalidateOutbounds();
            }
            this.nameStatusSelector.setState(StateSet.NOTHING);
            this.nameStatusPressed = false;
        }
        return this.nameStatusPressed;
    }

    private boolean checkOtherButtonMotionEvent(MotionEvent motionEvent) {
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        Drawable drawable;
        Drawable drawable2;
        int i = this.documentAttachType;
        if ((i == 5 || i == 1) && (groupedMessagePosition = this.currentPosition) != null && (groupedMessagePosition.flags & 4) == 0) {
            return false;
        }
        int i2 = this.currentMessageObject.type;
        boolean z = i2 == 16;
        if (!z) {
            z = ((i != 1 && i2 != 12 && i != 5 && i != 4 && i != 2 && i2 != 8) || this.hasGamePreview || this.hasInvoicePreview) ? false : true;
        }
        if (!z) {
            return false;
        }
        int eventX = (int) getEventX(motionEvent);
        int eventY = (int) getEventY(motionEvent);
        if (motionEvent.getAction() != 0) {
            if (motionEvent.getAction() == 1) {
                if (this.otherPressed) {
                    if (this.currentMessageObject.type == 16 && Build.VERSION.SDK_INT >= 21 && (drawable2 = this.selectorDrawable[0]) != null) {
                        drawable2.setState(StateSet.NOTHING);
                    }
                    this.otherPressed = false;
                    playSoundEffect(0);
                    this.delegate.didPressOther(this, this.otherX, this.otherY);
                    invalidate();
                    return true;
                }
            } else if (motionEvent.getAction() == 2 && this.currentMessageObject.type == 16 && this.otherPressed && Build.VERSION.SDK_INT >= 21 && (drawable = this.selectorDrawable[0]) != null) {
                drawable.setHotspot(eventX, eventY);
            }
            return false;
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject.type != 16) {
            if (eventX >= this.otherX - AndroidUtilities.dp(20.0f) && eventX <= this.otherX + AndroidUtilities.dp(20.0f) && eventY >= this.otherY - AndroidUtilities.dp(4.0f) && eventY <= this.otherY + AndroidUtilities.dp(30.0f)) {
                this.otherPressed = true;
                invalidate();
                return true;
            }
            return false;
        }
        boolean zIsVideoCall = messageObject.isVideoCall();
        int i3 = this.otherX;
        if (eventX >= i3) {
            if (eventX <= i3 + (LocaleController.isRTL ? 0 : this.backgroundWidth - AndroidUtilities.dp(70.0f)) + AndroidUtilities.dp((!zIsVideoCall ? 2 : 0) + 30) && eventY >= this.otherY - AndroidUtilities.dp(14.0f) && eventY <= this.otherY + AndroidUtilities.dp(50.0f)) {
                this.otherPressed = true;
                this.selectorDrawableMaskType[0] = 4;
                if (Build.VERSION.SDK_INT >= 21 && this.selectorDrawable[0] != null) {
                    int iDp = this.otherX + (LocaleController.isRTL ? 0 : this.backgroundWidth - AndroidUtilities.dp(70.0f)) + AndroidUtilities.dp(!zIsVideoCall ? 2 : 0) + (Theme.chat_msgInCallDrawable[zIsVideoCall ? 1 : 0].getIntrinsicWidth() / 2);
                    int intrinsicHeight = this.otherY + (Theme.chat_msgInCallDrawable[zIsVideoCall ? 1 : 0].getIntrinsicHeight() / 2);
                    this.selectorDrawable[0].setBounds(iDp - AndroidUtilities.dp(20.0f), intrinsicHeight - AndroidUtilities.dp(20.0f), iDp + AndroidUtilities.dp(20.0f), intrinsicHeight + AndroidUtilities.dp(20.0f));
                    this.selectorDrawable[0].setHotspot(eventX, eventY);
                    this.selectorDrawable[0].setState(this.pressedState);
                }
                invalidate();
                return true;
            }
        }
        return false;
    }

    /* JADX WARN: Removed duplicated region for block: B:101:0x019d  */
    /* JADX WARN: Removed duplicated region for block: B:104:0x01a6  */
    /* JADX WARN: Removed duplicated region for block: B:87:0x0122  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkPhotoImageMotionEvent(MotionEvent motionEvent) throws Resources.NotFoundException, NumberFormatException {
        MessageObject messageObject;
        int i;
        int i2;
        int i3;
        int i4;
        int iDp;
        int iDp2;
        int i5;
        boolean z = true;
        if ((!this.drawPhotoImage && this.documentAttachType != 1) || (this.currentMessageObject.isSending() && this.buttonState != 1)) {
            return false;
        }
        int eventX = (int) getEventX(motionEvent);
        int eventY = (int) getEventY(motionEvent);
        if (motionEvent.getAction() != 0) {
            if (motionEvent.getAction() != 1) {
                return false;
            }
            if (this.videoButtonPressed == 1) {
                this.videoButtonPressed = 0;
                playSoundEffect(0);
                didPressButton(true, true);
            } else if (this.buttonPressed == 1) {
                this.buttonPressed = 0;
                playSoundEffect(0);
                if (this.drawVideoImageButton) {
                    didClickedImage();
                } else {
                    didPressButton(true, false);
                }
            } else if (this.miniButtonPressed == 1) {
                this.miniButtonPressed = 0;
                playSoundEffect(0);
                didPressMiniButton(true);
            } else {
                if (!this.imagePressed) {
                    return false;
                }
                this.imagePressed = false;
                int i6 = this.buttonState;
                if (i6 == -1 || ((i6 == 1 && this.isRoundVideo) || i6 == 2 || i6 == 3 || this.drawVideoImageButton)) {
                    playSoundEffect(0);
                    didClickedImage();
                } else if (i6 == 0) {
                    playSoundEffect(0);
                    didPressButton(true, false);
                }
            }
            invalidate();
            return false;
        }
        int iDp3 = AndroidUtilities.dp(48.0f);
        boolean z2 = this.miniButtonState >= 0 && eventX >= (iDp2 = this.buttonX + (iDp = AndroidUtilities.dp(27.0f))) && eventX <= iDp2 + iDp3 && eventY >= (i5 = this.buttonY + iDp) && eventY <= i5 + iDp3;
        MessageObject messageObject2 = this.currentMessageObject;
        boolean z3 = messageObject2 == null || !messageObject2.hasMediaSpoilers() || this.currentMessageObject.isMediaSpoilersRevealed || this.buttonState == 1;
        if (z2) {
            this.miniButtonPressed = 1;
        } else if (this.buttonState != -1 && this.radialProgress.getIcon() != 4 && eventX >= (i3 = this.buttonX) && eventX <= i3 + iDp3 && eventY >= (i4 = this.buttonY) && eventY <= i4 + iDp3 && z3) {
            this.buttonPressed = 1;
        } else {
            if (!this.drawVideoImageButton || this.buttonState == -1 || eventX < (i = this.videoButtonX) || eventX > i + AndroidUtilities.dp(34.0f) + Math.max(this.infoWidth, this.docTitleWidth) || eventY < (i2 = this.videoButtonY) || eventY > i2 + AndroidUtilities.dp(30.0f) || !z3) {
                if (this.documentAttachType == 1) {
                    float f = eventX;
                    if (f < this.photoImage.getImageX() || f > (this.photoImage.getImageX() + this.backgroundWidth) - AndroidUtilities.dp(50.0f)) {
                        z = false;
                    } else {
                        float f2 = eventY;
                        if (f2 >= this.photoImage.getImageY() && f2 <= this.photoImage.getImageY() + this.photoImage.getImageHeight()) {
                            this.imagePressed = true;
                        }
                    }
                } else if (!this.currentMessageObject.isAnyKindOfSticker() || this.currentMessageObject.getInputStickerSet() != null || this.currentMessageObject.isAnimatedEmoji() || this.currentMessageObject.isDice()) {
                    float f3 = eventX;
                    if (f3 < this.photoImage.getImageX() || f3 > this.photoImage.getImageX() + this.photoImage.getImageWidth()) {
                        z = false;
                        messageObject = this.currentMessageObject;
                        if (messageObject.type == 12) {
                            long j = MessageObject.getMedia(messageObject.messageOwner).user_id;
                            if ((j != 0 ? MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(j)) : null) == null) {
                                this.imagePressed = false;
                                z = false;
                            }
                        }
                    } else {
                        float f4 = eventY;
                        if (f4 >= this.photoImage.getImageY() && f4 <= this.photoImage.getImageY() + this.photoImage.getImageHeight() && (!this.isRoundVideo || ((f3 - this.photoImage.getCenterX()) * (f3 - this.photoImage.getCenterX())) + ((f4 - this.photoImage.getCenterY()) * (f4 - this.photoImage.getCenterY())) < (this.photoImage.getImageWidth() / 2.0f) * (this.photoImage.getImageWidth() / 2.0f))) {
                            this.imagePressed = true;
                        }
                        messageObject = this.currentMessageObject;
                        if (messageObject.type == 12) {
                        }
                    }
                }
                if (this.imagePressed || !(this.currentMessageObject.isSendError() || (this.currentMessageObject.type == 8 && this.buttonState == -1 && SharedConfig.isAutoplayGifs() && !this.currentMessageObject.isRepostPreview && this.photoImage.getAnimation() == null))) {
                    return z;
                }
                this.imagePressed = false;
                return false;
            }
            this.videoButtonPressed = 1;
        }
        invalidate();
        if (this.imagePressed) {
        }
        return z;
    }

    private boolean checkPinchToZoom(MotionEvent motionEvent) {
        ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
        PinchToZoomHelper pinchToZoomHelper = chatMessageCellDelegate == null ? null : chatMessageCellDelegate.getPinchToZoomHelper();
        if (this.currentMessageObject == null || !this.photoImage.hasNotThumb() || pinchToZoomHelper == null || this.currentMessageObject.isSticker() || this.currentMessageObject.isAnimatedEmoji() || ((this.currentMessageObject.isVideo() && !this.autoPlayingMedia) || this.isRoundVideo || this.currentMessageObject.isAnimatedSticker() || ((this.currentMessageObject.isDocument() && !this.currentMessageObject.isGif()) || this.currentMessageObject.needDrawBluredPreview()))) {
            return false;
        }
        ImageReceiver imageReceiver = this.photoImage;
        MessageObject messageObject = this.currentMessageObject;
        SpoilerEffect2 spoilerEffect2 = this.mediaSpoilerEffect2;
        return pinchToZoomHelper.checkPinchToZoom(motionEvent, this, imageReceiver, null, null, messageObject, spoilerEffect2 == null ? 0 : spoilerEffect2.getAttachIndex(this));
    }

    /* JADX WARN: Removed duplicated region for block: B:97:0x020f A[PHI: r9
      0x020f: PHI (r9v3 boolean) = 
      (r9v2 boolean)
      (r9v2 boolean)
      (r9v2 boolean)
      (r9v2 boolean)
      (r9v2 boolean)
      (r9v4 boolean)
      (r9v2 boolean)
      (r9v2 boolean)
      (r9v2 boolean)
      (r9v2 boolean)
      (r9v2 boolean)
      (r9v2 boolean)
     binds: [B:51:0x011a, B:53:0x0122, B:55:0x0129, B:57:0x0130, B:59:0x0136, B:96:0x020c, B:62:0x0144, B:64:0x015b, B:66:0x0166, B:68:0x0179, B:77:0x018e, B:73:0x0185] A[DONT_GENERATE, DONT_INLINE]] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkPollButtonMotionEvent(MotionEvent motionEvent) {
        Drawable drawable;
        ArrayList arrayList;
        ChatMessageCellDelegate chatMessageCellDelegate;
        int i;
        int iDp;
        int i2;
        int i3;
        int i4;
        int i5;
        Drawable drawable2;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject.eventId != 0) {
            return false;
        }
        if (((this.pollVoteInProgress || this.pollUnvoteInProgress) && !messageObject.isTodo()) || this.pollButtons.isEmpty()) {
            return false;
        }
        MessageObject messageObject2 = this.currentMessageObject;
        if (messageObject2.type != 17 || !messageObject2.isSent()) {
            return false;
        }
        int eventX = (int) getEventX(motionEvent);
        int eventY = (int) getEventY(motionEvent);
        if (motionEvent.getAction() != 0) {
            if (motionEvent.getAction() != 1) {
                if (motionEvent.getAction() == 2) {
                    if ((this.pressedVoteButton == -1 && !this.pollHintPressed) || Build.VERSION.SDK_INT < 21 || (drawable = this.selectorDrawable[0]) == null) {
                        return false;
                    }
                    drawable.setHotspot(eventX, eventY);
                    return false;
                }
                if (motionEvent.getAction() != 3) {
                    return false;
                }
                for (int i6 = 0; i6 < this.pollButtons.size(); i6++) {
                    ((PollButton) this.pollButtons.get(i6)).selectorDrawable.setState(StateSet.NOTHING);
                }
                return false;
            }
            if (this.pollHintPressed) {
                playSoundEffect(0);
                this.delegate.didPressHint(this, 0);
                this.pollHintPressed = false;
                for (int i7 = 0; i7 < this.pollButtons.size(); i7++) {
                    ((PollButton) this.pollButtons.get(i7)).selectorDrawable.setState(StateSet.NOTHING);
                }
                return false;
            }
            LinkSpanDrawable linkSpanDrawable = this.pressedLink;
            if (linkSpanDrawable != null) {
                if (linkSpanDrawable.getSpan() instanceof URLSpan) {
                    this.delegate.didPressUrl(this, this.pressedLink.getSpan(), false);
                } else if (this.pressedLink.getSpan() instanceof ClickableSpan) {
                    ((ClickableSpan) this.pressedLink.getSpan()).onClick(this);
                }
                resetPressedLink(4);
                return false;
            }
            if (this.pressedVoteButton == -1) {
                return false;
            }
            playSoundEffect(0);
            for (int i8 = 0; i8 < this.pollButtons.size(); i8++) {
                ((PollButton) this.pollButtons.get(i8)).selectorDrawable.setState(StateSet.NOTHING);
            }
            if (this.currentMessageObject.scheduled) {
                Toast.makeText(getContext(), LocaleController.getString(this.currentMessageObject.isTodo() ? R.string.MessageScheduledTodo : R.string.MessageScheduledVote), 1).show();
            } else {
                PollButton pollButton = (PollButton) this.pollButtons.get(this.pressedVoteButton);
                TLRPC.PollAnswer pollAnswer = pollButton.answer;
                if (this.pollVoted || this.pollClosed) {
                    arrayList = new ArrayList();
                    arrayList.add(pollAnswer);
                    chatMessageCellDelegate = this.delegate;
                    i = pollButton.count;
                    iDp = AndroidUtilities.dp(50.0f) + pollButton.x;
                    i2 = pollButton.y + this.namesOffset;
                } else {
                    TLRPC.Poll poll = this.lastPoll;
                    if (poll == null || !poll.multiple_choice) {
                        this.pollVoteInProgressNum = this.pressedVoteButton;
                        this.pollVoteInProgress = true;
                        this.voteCurrentProgressTime = BitmapDescriptorFactory.HUE_RED;
                        this.firstCircleLength = true;
                        this.voteCurrentCircleLength = 360.0f;
                        this.voteRisingCircleLength = false;
                        if (pollButton.task != null) {
                            toggleTodoCheck(this.pressedVoteButton, true);
                        } else {
                            this.vibrateOnPollVote = true;
                            arrayList = new ArrayList();
                            arrayList.add(pollAnswer);
                            chatMessageCellDelegate = this.delegate;
                            iDp = 0;
                            i2 = 0;
                            i = -1;
                        }
                    } else if (this.currentMessageObject.checkedVotes.contains(pollAnswer)) {
                        this.currentMessageObject.checkedVotes.remove(pollAnswer);
                        this.pollCheckBox[this.pressedVoteButton].setChecked(false, true);
                    } else {
                        this.currentMessageObject.checkedVotes.add(pollAnswer);
                        this.pollCheckBox[this.pressedVoteButton].setChecked(true, true);
                    }
                }
                chatMessageCellDelegate.didPressVoteButtons(this, arrayList, i, iDp, i2);
            }
            this.pressedVoteButton = -1;
            invalidate();
            Runnable runnable = this.todoLongPressRunnable;
            if (runnable == null) {
                return false;
            }
            AndroidUtilities.cancelRunOnUIThread(runnable);
            this.todoLongPressRunnable = null;
            return false;
        }
        Runnable runnable2 = this.todoLongPressRunnable;
        if (runnable2 != null) {
            AndroidUtilities.cancelRunOnUIThread(runnable2);
            this.todoLongPressRunnable = null;
        }
        this.pressedVoteButton = -1;
        this.pollHintPressed = false;
        resetPressedLink(4);
        if (!this.hintButtonVisible || (i4 = this.pollHintX) == -1 || eventX < i4 || eventX > i4 + AndroidUtilities.dp(40.0f) || eventY < (i5 = this.pollHintY) || eventY > i5 + AndroidUtilities.dp(40.0f)) {
            for (int i9 = 0; i9 < this.pollButtons.size(); i9++) {
                ((PollButton) this.pollButtons.get(i9)).selectorDrawable.setState(StateSet.NOTHING);
            }
            boolean z = false;
            for (int i10 = 0; i10 < this.pollButtons.size(); i10++) {
                PollButton pollButton2 = (PollButton) this.pollButtons.get(i10);
                int iDp2 = (pollButton2.y + this.namesOffset) - AndroidUtilities.dp(13.0f);
                StaticLayout staticLayout = pollButton2.title;
                if (staticLayout == null || !(staticLayout.getText() instanceof Spannable)) {
                    i3 = pollButton2.x;
                    if (eventX < i3 && eventX <= (i3 + this.backgroundWidth) - AndroidUtilities.dp(31.0f) && eventY >= iDp2 && eventY <= iDp2 + pollButton2.height + AndroidUtilities.dp(26.0f)) {
                        this.pressedVoteButton = i10;
                        if (!this.pollVoted && !this.pollClosed) {
                            this.selectorDrawableMaskType[0] = 1;
                            if (Build.VERSION.SDK_INT >= 21) {
                                pollButton2.selectorDrawable.setHotspot(eventX, eventY);
                            }
                            pollButton2.selectorDrawable.setState(this.pressedState);
                        }
                    }
                } else {
                    float f = eventX;
                    float f2 = pollButton2.titleX;
                    if (f >= f2) {
                        float f3 = eventY;
                        float f4 = pollButton2.titleY;
                        if (f3 >= f4 && !this.currentMessageObject.preview) {
                            int i11 = eventX - ((int) f2);
                            int i12 = eventY - ((int) f4);
                            try {
                                if (i12 <= pollButton2.title.getHeight()) {
                                    int lineForVertical = pollButton2.title.getLineForVertical(i12);
                                    float f5 = i11;
                                    int offsetForHorizontal = pollButton2.title.getOffsetForHorizontal(lineForVertical, f5);
                                    float lineLeft = pollButton2.title.getLineLeft(lineForVertical);
                                    if (lineLeft <= f5 && lineLeft + pollButton2.title.getLineWidth(lineForVertical) >= f5) {
                                        Spannable spannable = (Spannable) pollButton2.title.getText();
                                        ClickableSpan[] clickableSpanArr = (ClickableSpan[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, ClickableSpan.class);
                                        if (clickableSpanArr.length != 0 && ((!(clickableSpanArr[0] instanceof URLSpanBotCommand) || URLSpanBotCommand.enabled) && !AndroidUtilities.isAccessibilityScreenReaderEnabled())) {
                                            LinkSpanDrawable linkSpanDrawable2 = this.pressedLink;
                                            if (linkSpanDrawable2 == null || linkSpanDrawable2.getSpan() != clickableSpanArr[0]) {
                                                this.links.removeLink(this.pressedLink);
                                                ClickableSpan clickableSpan = clickableSpanArr[0];
                                                LinkSpanDrawable linkSpanDrawable3 = new LinkSpanDrawable(clickableSpan, this.resourcesProvider, f, f3, spanSupportsLongPress(clickableSpan));
                                                this.pressedLink = linkSpanDrawable3;
                                                linkSpanDrawable3.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outLinkSelectBackground : Theme.key_chat_linkSelectBackground));
                                                this.linkBlockNum = i10;
                                                this.pressedLinkType = 4;
                                                startCheckLongPress();
                                                try {
                                                    LinkPath linkPathObtainNewPath = this.pressedLink.obtainNewPath();
                                                    int[] realSpanStartAndEnd = getRealSpanStartAndEnd(spannable, this.pressedLink.getSpan());
                                                    linkPathObtainNewPath.setCurrentLayout(pollButton2.title, realSpanStartAndEnd[0], BitmapDescriptorFactory.HUE_RED);
                                                    pollButton2.title.getSelectionPath(realSpanStartAndEnd[0], realSpanStartAndEnd[1], linkPathObtainNewPath);
                                                } catch (Exception e) {
                                                    FileLog.e(e);
                                                }
                                                this.links.addLink(this.pressedLink, 4);
                                            }
                                            try {
                                                invalidate();
                                            } catch (Exception e2) {
                                                e = e2;
                                                z = true;
                                                FileLog.e(e);
                                                i3 = pollButton2.x;
                                                if (eventX < i3) {
                                                }
                                            }
                                        }
                                    }
                                }
                            } catch (Exception e3) {
                                e = e3;
                            }
                        }
                    }
                }
                return true;
            }
            return z;
        }
        this.pollHintPressed = true;
        this.selectorDrawableMaskType[0] = 3;
        if (Build.VERSION.SDK_INT >= 21 && (drawable2 = this.selectorDrawable[0]) != null) {
            drawable2.setBounds(this.pollHintX - AndroidUtilities.dp(8.0f), this.pollHintY - AndroidUtilities.dp(8.0f), this.pollHintX + AndroidUtilities.dp(32.0f), this.pollHintY + AndroidUtilities.dp(32.0f));
            this.selectorDrawable[0].setHotspot(eventX, eventY);
            this.selectorDrawable[0].setState(this.pressedState);
        }
        for (int i13 = 0; i13 < this.pollButtons.size(); i13++) {
            ((PollButton) this.pollButtons.get(i13)).selectorDrawable.setState(StateSet.NOTHING);
        }
        invalidate();
        return true;
    }

    private boolean checkQuickShareMotionEvent(MotionEvent motionEvent) {
        ChatMessageCellDelegate chatMessageCellDelegate;
        if (!this.inQuickShareMode) {
            return false;
        }
        int action = motionEvent.getAction();
        if (action != 1 && action != 3) {
            if (action == 2 && (chatMessageCellDelegate = this.delegate) != null) {
                chatMessageCellDelegate.didQuickShareMove(this, getEventX(motionEvent), getEventY(motionEvent));
            }
            return true;
        }
        this.inQuickShareMode = false;
        ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
        if (chatMessageCellDelegate2 != null) {
            chatMessageCellDelegate2.didQuickShareEnd(this, getEventX(motionEvent), getEventY(motionEvent));
        }
        return true;
    }

    private boolean checkReactionsTouchEvent(MotionEvent motionEvent) {
        MessageObject.GroupedMessages groupedMessages;
        if (this.currentMessageObject.hasValidGroupId() && (groupedMessages = this.currentMessagesGroup) != null && !groupedMessages.isDocuments) {
            ViewGroup viewGroup = (ViewGroup) getParent();
            if (viewGroup == null) {
                return false;
            }
            for (int i = 0; i < viewGroup.getChildCount(); i++) {
                View childAt = viewGroup.getChildAt(i);
                if (childAt instanceof ChatMessageCell) {
                    ChatMessageCell chatMessageCell = (ChatMessageCell) childAt;
                    MessageObject.GroupedMessages currentMessagesGroup = chatMessageCell.getCurrentMessagesGroup();
                    MessageObject.GroupedMessagePosition currentPosition = chatMessageCell.getCurrentPosition();
                    if (currentMessagesGroup != null && currentMessagesGroup.groupId == this.currentMessagesGroup.groupId) {
                        int i2 = currentPosition.flags;
                        if ((i2 & 8) != 0 && (i2 & 1) != 0) {
                            if (chatMessageCell != this) {
                                motionEvent.offsetLocation(getLeft() - chatMessageCell.getLeft(), getTop() - chatMessageCell.getTop());
                                boolean zCheckTouchEvent = chatMessageCell.reactionsLayoutInBubble.checkTouchEvent(motionEvent);
                                motionEvent.offsetLocation(-(getLeft() - chatMessageCell.getLeft()), -(getTop() - chatMessageCell.getTop()));
                                return zCheckTouchEvent;
                            }
                        }
                    }
                }
            }
            return false;
        }
        return this.reactionsLayoutInBubble.checkTouchEvent(motionEvent);
    }

    /* JADX WARN: Removed duplicated region for block: B:103:0x01b1  */
    /* JADX WARN: Removed duplicated region for block: B:108:0x01c7 A[PHI: r15
      0x01c7: PHI (r15v19 org.telegram.ui.Components.ButtonBounce) = (r15v6 org.telegram.ui.Components.ButtonBounce), (r15v21 org.telegram.ui.Components.ButtonBounce) binds: [B:107:0x01c5, B:83:0x015f] A[DONT_GENERATE, DONT_INLINE]] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkReplyTouchEvent(MotionEvent motionEvent) {
        ChatMessageCellDelegate chatMessageCellDelegate;
        int i;
        int iMax;
        ButtonBounce buttonBounce;
        TLRPC.Message message;
        TLRPC.MessageReplyHeader messageReplyHeader;
        if (this.replyNameLayout == null || (chatMessageCellDelegate = this.delegate) == null || !chatMessageCellDelegate.canPerformReply()) {
            return false;
        }
        float eventX = getEventX(motionEvent);
        float eventY = getEventY(motionEvent);
        if (this.currentMessageObject.shouldDrawWithoutBackground()) {
            i = this.replyStartX;
            iMax = Math.max(this.replyNameWidth, this.replyTextWidth);
        } else {
            i = this.replyStartX;
            iMax = this.backgroundDrawableRight;
        }
        int i2 = i + iMax;
        if (motionEvent.getAction() == 0) {
            if (eventX >= this.replyStartX && eventX <= i2) {
                float f = this.replyStartY;
                if (eventY >= f && eventY <= f + this.replyHeight) {
                    this.replyPressed = true;
                    getParent().requestDisallowInterceptTouchEvent(false);
                    this.replyTouchX = eventX;
                    this.replyTouchY = getY() + eventY;
                    Drawable drawable = this.replySelector;
                    if (drawable != null) {
                        if (Build.VERSION.SDK_INT >= 21) {
                            drawable.setHotspot(eventX, eventY);
                        }
                        this.replySelectorPressed = false;
                        this.replySelectorCanBePressed = true;
                        postDelayed(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda11
                            @Override // java.lang.Runnable
                            public final void run() {
                                this.f$0.lambda$checkReplyTouchEvent$5();
                            }
                        }, ViewConfiguration.getTapTimeout() / 6);
                        invalidate();
                    }
                    ButtonBounce buttonBounce2 = this.replyBounce;
                    if (buttonBounce2 != null) {
                        buttonBounce2.setPressed(true);
                        this.replyBounceX = eventX;
                        this.replyBounceY = eventY;
                    }
                    startCheckLongPress();
                    return true;
                }
            }
        } else if (motionEvent.getAction() == 1) {
            if (this.replyPressed) {
                cancelCheckLongPress();
                this.replyPressed = false;
                Drawable drawable2 = this.replySelector;
                if (drawable2 != null) {
                    if (this.replySelectorPressed) {
                        drawable2.setState(new int[0]);
                    } else {
                        drawable2.setState(new int[]{android.R.attr.state_pressed, android.R.attr.state_enabled});
                        post(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda12
                            @Override // java.lang.Runnable
                            public final void run() {
                                this.f$0.lambda$checkReplyTouchEvent$6();
                            }
                        });
                    }
                    this.replySelectorPressed = false;
                    this.replySelectorCanBePressed = false;
                    invalidate();
                }
                ButtonBounce buttonBounce3 = this.replyBounce;
                if (buttonBounce3 != null) {
                    buttonBounce3.setPressed(false);
                }
                playSoundEffect(0);
                if (this.replyPanelIsForward) {
                    ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
                    if (chatMessageCellDelegate2 != null) {
                        TLRPC.Chat chat = this.currentForwardChannel;
                        if (chat != null) {
                            chatMessageCellDelegate2.didPressChannelAvatar(this, chat, this.currentMessageObject.messageOwner.fwd_from.channel_post, this.lastTouchX, this.lastTouchY, false);
                        } else {
                            TLRPC.User user = this.currentForwardUser;
                            if (user != null) {
                                chatMessageCellDelegate2.didPressUserAvatar(this, user, this.lastTouchX, this.lastTouchY, false);
                            } else if (this.currentForwardName != null) {
                                chatMessageCellDelegate2.didPressHiddenForward(this);
                            }
                        }
                    }
                } else if (this.delegate != null && (this.currentMessageObject.hasValidReplyMessageObject() || this.currentMessageObject.isReplyToStory() || this.hasReplyQuote || ((message = this.currentMessageObject.messageOwner) != null && (messageReplyHeader = message.reply_to) != null && messageReplyHeader.reply_from != null))) {
                    this.delegate.didPressReplyMessage(this, this.currentMessageObject.getReplyMsgId(), eventX, eventY, false);
                }
            }
        } else if (motionEvent.getAction() == 3) {
            this.replyPressed = false;
            this.replySelectorPressed = false;
            Drawable drawable3 = this.replySelector;
            if (drawable3 != null) {
                drawable3.setState(new int[0]);
            }
            invalidate();
            buttonBounce = this.replyBounce;
            if (buttonBounce != null) {
                buttonBounce.setPressed(false);
            }
        } else if (motionEvent.getAction() == 2) {
            if (eventX < this.replyStartX || eventX > i2) {
                this.replyPressed = false;
                this.replySelectorPressed = false;
                this.replySelectorCanBePressed = false;
                Drawable drawable4 = this.replySelector;
                if (drawable4 != null) {
                    drawable4.setState(new int[0]);
                }
                invalidate();
                buttonBounce = this.replyBounce;
                if (buttonBounce != null) {
                }
            } else {
                float f2 = this.replyStartY;
                if (eventY >= f2 && eventY <= f2 + this.replyHeight) {
                    if (this.replySelector != null && this.replySelectorCanBePressed && Math.sqrt(Math.pow(eventX - this.replyTouchX, 2.0d) + Math.pow((eventY + getY()) - this.replyTouchY, 2.0d)) > 0.75d) {
                        this.replySelectorCanBePressed = false;
                    }
                }
            }
        }
        return this.replyPressed;
    }

    /* JADX WARN: Removed duplicated region for block: B:18:0x0067  */
    /* JADX WARN: Removed duplicated region for block: B:22:0x00a6  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkRoundSeekbar(MotionEvent motionEvent) {
        if (!MediaController.getInstance().isPlayingMessage(this.currentMessageObject) || !MediaController.getInstance().isMessagePaused()) {
            return false;
        }
        int eventX = (int) getEventX(motionEvent);
        int eventY = (int) getEventY(motionEvent);
        if (motionEvent.getAction() == 0) {
            float f = eventX;
            if (f < this.seekbarRoundX - AndroidUtilities.dp(20.0f) || f > this.seekbarRoundX + AndroidUtilities.dp(20.0f)) {
                float centerX = f - this.photoImage.getCenterX();
                float centerY = eventY - this.photoImage.getCenterY();
                float imageWidth = (this.photoImage.getImageWidth() - AndroidUtilities.dp(64.0f)) / 2.0f;
                float f2 = (centerX * centerX) + (centerY * centerY);
                if (f2 < ((this.photoImage.getImageWidth() / 2.0f) * this.photoImage.getImageWidth()) / 2.0f && f2 > imageWidth * imageWidth) {
                    getParent().requestDisallowInterceptTouchEvent(true);
                    cancelCheckLongPress();
                    this.roundSeekbarTouched = 1;
                    invalidate();
                }
            } else {
                float f3 = eventY;
                if (f3 < this.seekbarRoundY - AndroidUtilities.dp(20.0f) || f3 > this.seekbarRoundY + AndroidUtilities.dp(20.0f)) {
                }
            }
        } else if (this.roundSeekbarTouched == 1 && motionEvent.getAction() == 2) {
            float degrees = ((float) Math.toDegrees(Math.atan2(eventY - this.photoImage.getCenterY(), eventX - this.photoImage.getCenterX()))) + 90.0f;
            if (degrees < BitmapDescriptorFactory.HUE_RED) {
                degrees += 360.0f;
            }
            float f4 = degrees / 360.0f;
            if (Math.abs(this.currentMessageObject.audioProgress - f4) > 0.9f) {
                if (this.roundSeekbarOutAlpha == BitmapDescriptorFactory.HUE_RED) {
                    try {
                        performHapticFeedback(3);
                    } catch (Exception unused) {
                    }
                }
                this.roundSeekbarOutAlpha = 1.0f;
                this.roundSeekbarOutProgress = this.currentMessageObject.audioProgress;
            }
            long jCurrentTimeMillis = System.currentTimeMillis();
            if (jCurrentTimeMillis - this.lastSeekUpdateTime > 100) {
                MediaController.getInstance().seekToProgress(this.currentMessageObject, f4);
                this.lastSeekUpdateTime = jCurrentTimeMillis;
            }
            this.currentMessageObject.audioProgress = f4;
            updatePlayingMessageProgress();
        }
        if ((motionEvent.getAction() == 1 || motionEvent.getAction() == 3) && this.roundSeekbarTouched != 0) {
            if (motionEvent.getAction() == 1) {
                float degrees2 = ((float) Math.toDegrees(Math.atan2(eventY - this.photoImage.getCenterY(), eventX - this.photoImage.getCenterX()))) + 90.0f;
                if (degrees2 < BitmapDescriptorFactory.HUE_RED) {
                    degrees2 += 360.0f;
                }
                float f5 = degrees2 / 360.0f;
                this.currentMessageObject.audioProgress = f5;
                MediaController.getInstance().seekToProgress(this.currentMessageObject, f5);
                updatePlayingMessageProgress();
            }
            MediaController.getInstance().playMessage(this.currentMessageObject);
            this.roundSeekbarTouched = 0;
            getParent().requestDisallowInterceptTouchEvent(false);
        }
        return this.roundSeekbarTouched != 0;
    }

    /* JADX WARN: Removed duplicated region for block: B:28:0x004b A[PHI: r5
      0x004b: PHI (r5v3 org.telegram.ui.Components.ButtonBounce) = (r5v2 org.telegram.ui.Components.ButtonBounce), (r5v7 org.telegram.ui.Components.ButtonBounce) binds: [B:27:0x0049, B:22:0x003d] A[DONT_GENERATE, DONT_INLINE]] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkSponsoredCloseMotionEvent(MotionEvent motionEvent) {
        ChatMessageCellDelegate chatMessageCellDelegate;
        RectF rectF;
        if (motionEvent.getAction() == 0 && (rectF = this.closeSponsoredBounds) != null && this.closeSponsoredBounce != null && rectF.contains(getEventX(motionEvent), getEventY(motionEvent))) {
            this.closeSponsoredBounce.setPressed(true);
            return true;
        }
        if (motionEvent.getAction() == 1) {
            ButtonBounce buttonBounce = this.closeSponsoredBounce;
            if (buttonBounce != null && buttonBounce.isPressed() && (chatMessageCellDelegate = this.delegate) != null) {
                chatMessageCellDelegate.didPressSponsoredClose(this);
            }
            ButtonBounce buttonBounce2 = this.closeSponsoredBounce;
            if (buttonBounce2 != null) {
                buttonBounce2.setPressed(false);
            }
        } else if (motionEvent.getAction() == 3 && (buttonBounce2 = this.closeSponsoredBounce) != null) {
        }
        ButtonBounce buttonBounce3 = this.closeSponsoredBounce;
        return buttonBounce3 != null && buttonBounce3.isPressed();
    }

    /* JADX WARN: Removed duplicated region for block: B:153:0x02cc A[Catch: Exception -> 0x026c, TryCatch #0 {Exception -> 0x026c, blocks: (B:128:0x021b, B:130:0x024b, B:131:0x024d, B:133:0x0257, B:135:0x0263, B:139:0x0277, B:141:0x027b, B:143:0x027e, B:146:0x0289, B:149:0x02be, B:151:0x02c6, B:153:0x02cc, B:155:0x02d1, B:159:0x02e1, B:163:0x02f1, B:165:0x02f5, B:167:0x02f8, B:170:0x0303, B:162:0x02e9, B:138:0x026f), top: B:283:0x021b }] */
    /* JADX WARN: Removed duplicated region for block: B:211:0x03be  */
    /* JADX WARN: Removed duplicated region for block: B:224:0x03f2  */
    /* JADX WARN: Removed duplicated region for block: B:245:0x045f  */
    /* JADX WARN: Removed duplicated region for block: B:269:0x04bf  */
    /* JADX WARN: Removed duplicated region for block: B:281:0x04e9 A[ORIG_RETURN, RETURN] */
    /* JADX WARN: Removed duplicated region for block: B:292:0x0458 A[EDGE_INSN: B:292:0x0458->B:243:0x0458 BREAK  A[LOOP:1: B:222:0x03e8->B:242:0x0455], SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:316:? A[RETURN, SYNTHETIC] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkTextBlockMotionEvent(MotionEvent motionEvent) {
        ArrayList<MessageObject.TextLayoutBlock> arrayList;
        int i;
        int i2;
        boolean z;
        boolean z2;
        AnimatedEmojiSpan animatedEmojiSpan;
        boolean z3;
        int[] realSpanStartAndEnd;
        Object obj;
        Object[] spans;
        Object[] spans2;
        ReplyMessageLine replyMessageLine;
        ChatMessageCellDelegate chatMessageCellDelegate;
        int eventX;
        int eventY;
        int i3;
        int i4;
        MessageObject messageObject;
        int i5;
        MessageObject messageObject2 = this.currentMessageObject;
        int i6 = messageObject2.type;
        if ((i6 != 0 && i6 != 19 && i6 != 24) || (arrayList = messageObject2.textLayoutBlocks) == null || arrayList.isEmpty() || !(this.currentMessageObject.messageText instanceof Spannable)) {
            return false;
        }
        if (motionEvent.getAction() == 0 || (motionEvent.getAction() == 1 && (this.pressedLinkType == 1 || this.pressedCopyCode != null))) {
            int eventX2 = (int) getEventX(motionEvent);
            int eventY2 = (int) getEventY(motionEvent);
            int i7 = this.textX;
            if (eventX2 >= i7 && eventY2 >= (i2 = this.textY)) {
                MessageObject messageObject3 = this.currentMessageObject;
                if (eventX2 <= i7 + messageObject3.textWidth && eventY2 <= i2 + messageObject3.textHeight(this.transitionParams)) {
                    int i8 = eventY2 - this.textY;
                    int i9 = 0;
                    for (int i10 = 0; i10 < this.currentMessageObject.textLayoutBlocks.size() && this.currentMessageObject.textLayoutBlocks.get(i10).textYOffset(this.currentMessageObject.textLayoutBlocks, this.transitionParams) <= i8; i10++) {
                        i9 = i10;
                    }
                    try {
                        MessageObject.TextLayoutBlock textLayoutBlock = this.currentMessageObject.textLayoutBlocks.get(i9);
                        int i11 = (int) (eventX2 - (this.textX - (textLayoutBlock.isRtl() ? this.currentMessageObject.textXOffset : BitmapDescriptorFactory.HUE_RED)));
                        int iTextYOffset = (int) (i8 - textLayoutBlock.textYOffset(this.currentMessageObject.textLayoutBlocks, this.transitionParams));
                        if (!textLayoutBlock.quote && textLayoutBlock.code && i11 > 0 && i11 <= this.currentMessageObject.textWidth && iTextYOffset >= ((textLayoutBlock.padTop + textLayoutBlock.height) + textLayoutBlock.padBottom) - AndroidUtilities.dp(38.0f) && iTextYOffset <= textLayoutBlock.padTop + textLayoutBlock.height + textLayoutBlock.padBottom) {
                            if (motionEvent.getAction() == 1) {
                                if (textLayoutBlock == this.pressedCopyCode && (chatMessageCellDelegate = this.delegate) != null) {
                                    chatMessageCellDelegate.didPressCodeCopy(this, textLayoutBlock);
                                }
                                resetCodeSelectors();
                                this.pressedCopyCode = null;
                            } else {
                                this.pressedCopyCode = textLayoutBlock;
                                if (Build.VERSION.SDK_INT >= 21) {
                                    textLayoutBlock.copySelector.setHotspot(i11, iTextYOffset);
                                }
                                textLayoutBlock.copySelector.setCallback(this);
                                textLayoutBlock.copySelector.setState(this.pressedState);
                            }
                            return true;
                        }
                        int lineForVertical = textLayoutBlock.textLayout.getLineForVertical(iTextYOffset);
                        float f = i11;
                        int offsetForHorizontal = textLayoutBlock.charactersOffset + textLayoutBlock.textLayout.getOffsetForHorizontal(lineForVertical, f);
                        float lineLeft = textLayoutBlock.textLayout.getLineLeft(lineForVertical);
                        if (lineLeft <= f && lineLeft + textLayoutBlock.textLayout.getLineWidth(lineForVertical) >= f) {
                            Spannable spannable = (Spannable) this.currentMessageObject.messageText;
                            CharacterStyle[] characterStyleArr = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, ClickableSpan.class);
                            if (characterStyleArr == null || characterStyleArr.length == 0) {
                                characterStyleArr = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, URLSpanMono.class);
                                z = true;
                            } else {
                                z = false;
                            }
                            if (characterStyleArr == null || characterStyleArr.length == 0) {
                                characterStyleArr = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, AnimatedEmojiSpan.class);
                                z2 = false;
                            } else {
                                z2 = z;
                            }
                            if (characterStyleArr.length != 0 && ((!(characterStyleArr[0] instanceof URLSpanBotCommand) || URLSpanBotCommand.enabled) && !AndroidUtilities.isAccessibilityScreenReaderEnabled())) {
                                if (motionEvent.getAction() == 0) {
                                    CharacterStyle characterStyle = characterStyleArr[0];
                                    if (!(characterStyle instanceof AnimatedEmojiSpan)) {
                                        LinkSpanDrawable linkSpanDrawable = this.pressedLink;
                                        if (linkSpanDrawable == null || linkSpanDrawable.getSpan() != characterStyleArr[0]) {
                                            this.links.removeLink(this.pressedLink);
                                            CharacterStyle characterStyle2 = characterStyleArr[0];
                                            Object obj2 = URLSpanMono.class;
                                            LinkSpanDrawable linkSpanDrawable2 = new LinkSpanDrawable(characterStyle2, this.resourcesProvider, f, iTextYOffset, spanSupportsLongPress(characterStyle2));
                                            this.pressedLink = linkSpanDrawable2;
                                            linkSpanDrawable2.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outLinkSelectBackground : Theme.key_chat_linkSelectBackground));
                                            if (textLayoutBlock.quote && (replyMessageLine = this.quoteLine) != null) {
                                                this.pressedLink.setColor(Theme.multAlpha(replyMessageLine.getColor(), Theme.isCurrentThemeDark() ? 0.13f : 0.1f));
                                            }
                                            this.linkBlockNum = i9;
                                            this.pressedLinkType = 1;
                                            try {
                                                LinkPath linkPathObtainNewPath = this.pressedLink.obtainNewPath();
                                                realSpanStartAndEnd = getRealSpanStartAndEnd(spannable, this.pressedLink.getSpan());
                                                int i12 = realSpanStartAndEnd[0];
                                                int i13 = textLayoutBlock.charactersOffset;
                                                int i14 = i12 - i13;
                                                realSpanStartAndEnd[0] = i14;
                                                realSpanStartAndEnd[1] = realSpanStartAndEnd[1] - i13;
                                                linkPathObtainNewPath.setCurrentLayout(textLayoutBlock.textLayout, i14, BitmapDescriptorFactory.HUE_RED);
                                                textLayoutBlock.textLayout.getSelectionPath(realSpanStartAndEnd[0], realSpanStartAndEnd[1], linkPathObtainNewPath);
                                            } catch (Exception e) {
                                                e = e;
                                            }
                                            if (realSpanStartAndEnd[1] >= textLayoutBlock.charactersEnd) {
                                                int i15 = i9 + 1;
                                                while (i15 < this.currentMessageObject.textLayoutBlocks.size()) {
                                                    MessageObject.TextLayoutBlock textLayoutBlock2 = this.currentMessageObject.textLayoutBlocks.get(i15);
                                                    if (z2) {
                                                        int i16 = textLayoutBlock2.charactersOffset;
                                                        obj = obj2;
                                                        spans2 = spannable.getSpans(i16, i16, obj);
                                                    } else {
                                                        obj = obj2;
                                                        int i17 = textLayoutBlock2.charactersOffset;
                                                        spans2 = spannable.getSpans(i17, i17, ClickableSpan.class);
                                                    }
                                                    CharacterStyle[] characterStyleArr2 = (CharacterStyle[]) spans2;
                                                    if (characterStyleArr2 == null || characterStyleArr2.length == 0 || characterStyleArr2[0] != this.pressedLink.getSpan()) {
                                                        break;
                                                    }
                                                    LinkPath linkPathObtainNewPath2 = this.pressedLink.obtainNewPath();
                                                    linkPathObtainNewPath2.setCurrentLayout(textLayoutBlock2.textLayout, 0, textLayoutBlock2.textYOffset(this.currentMessageObject.textLayoutBlocks, this.transitionParams) - textLayoutBlock.textYOffset(this.currentMessageObject.textLayoutBlocks, this.transitionParams));
                                                    int i18 = (realSpanStartAndEnd[1] + textLayoutBlock.charactersOffset) - textLayoutBlock2.charactersOffset;
                                                    textLayoutBlock2.textLayout.getSelectionPath(0, i18, linkPathObtainNewPath2);
                                                    if (i18 < textLayoutBlock2.charactersEnd - 1) {
                                                        break;
                                                    }
                                                    i15++;
                                                    obj2 = obj;
                                                }
                                                obj = obj2;
                                                if (realSpanStartAndEnd[0] <= textLayoutBlock.charactersOffset) {
                                                    int i19 = 0;
                                                    for (int i20 = i9 - 1; i20 >= 0; i20--) {
                                                        MessageObject.TextLayoutBlock textLayoutBlock3 = this.currentMessageObject.textLayoutBlocks.get(i20);
                                                        if (z2) {
                                                            try {
                                                                int i21 = textLayoutBlock3.charactersEnd - 1;
                                                                spans = spannable.getSpans(i21, i21, obj);
                                                            } catch (Exception e2) {
                                                                e = e2;
                                                                FileLog.e(e);
                                                                z3 = true;
                                                                this.links.addLink(this.pressedLink, 1);
                                                                invalidate();
                                                                return z3;
                                                            }
                                                        } else {
                                                            int i22 = textLayoutBlock3.charactersEnd - 1;
                                                            spans = spannable.getSpans(i22, i22, ClickableSpan.class);
                                                        }
                                                        CharacterStyle[] characterStyleArr3 = (CharacterStyle[]) spans;
                                                        if (characterStyleArr3 == null || characterStyleArr3.length == 0 || characterStyleArr3[0] != this.pressedLink.getSpan()) {
                                                            break;
                                                        }
                                                        LinkPath linkPathObtainNewPath3 = this.pressedLink.obtainNewPath();
                                                        i19 -= textLayoutBlock3.height;
                                                        int i23 = realSpanStartAndEnd[0];
                                                        int i24 = textLayoutBlock.charactersOffset;
                                                        int i25 = textLayoutBlock3.charactersOffset;
                                                        int i26 = (i23 + i24) - i25;
                                                        int i27 = (realSpanStartAndEnd[1] + i24) - i25;
                                                        linkPathObtainNewPath3.setCurrentLayout(textLayoutBlock3.textLayout, i26, i19);
                                                        textLayoutBlock3.textLayout.getSelectionPath(i26, i27, linkPathObtainNewPath3);
                                                        if (i26 > textLayoutBlock3.charactersOffset) {
                                                            break;
                                                        }
                                                    }
                                                }
                                                z3 = true;
                                                this.links.addLink(this.pressedLink, 1);
                                            } else {
                                                obj = obj2;
                                                if (realSpanStartAndEnd[0] <= textLayoutBlock.charactersOffset) {
                                                }
                                                z3 = true;
                                                this.links.addLink(this.pressedLink, 1);
                                            }
                                        }
                                        invalidate();
                                        return z3;
                                    }
                                    AnimatedEmojiSpan animatedEmojiSpan2 = this.pressedEmoji;
                                    if (animatedEmojiSpan2 == null || animatedEmojiSpan2 != characterStyle) {
                                        resetPressedLink(1);
                                        this.pressedEmoji = (AnimatedEmojiSpan) characterStyleArr[0];
                                        this.pressedLinkType = 1;
                                    }
                                    z3 = true;
                                    invalidate();
                                    return z3;
                                }
                                CharacterStyle characterStyle3 = characterStyleArr[0];
                                if ((characterStyle3 instanceof AnimatedEmojiSpan) && (animatedEmojiSpan = this.pressedEmoji) == characterStyle3) {
                                    if (this.delegate.didPressAnimatedEmoji(this, animatedEmojiSpan)) {
                                        resetPressedLink(1);
                                        this.pressedEmoji = null;
                                        return true;
                                    }
                                    resetPressedLink(1);
                                    this.pressedEmoji = null;
                                } else {
                                    LinkSpanDrawable linkSpanDrawable3 = this.pressedLink;
                                    if (linkSpanDrawable3 != null && characterStyle3 == linkSpanDrawable3.getSpan()) {
                                        this.delegate.didPressUrl(this, this.pressedLink.getSpan(), false);
                                        resetPressedLink(1);
                                        return true;
                                    }
                                }
                            }
                        }
                    } catch (Exception e3) {
                        FileLog.e(e3);
                    }
                }
            }
            i = 1;
            resetPressedLink(1);
            if (motionEvent.getAction() != 0 || motionEvent.getAction() == i) {
                eventX = (int) getEventX(motionEvent);
                eventY = (int) getEventY(motionEvent);
                if (this.pressedLink == null && eventX >= (i3 = this.textX) && eventY >= (i4 = this.textY)) {
                    messageObject = this.currentMessageObject;
                    if (eventX <= i3 + messageObject.textWidth && eventY <= i4 + messageObject.textHeight(this.transitionParams)) {
                        int i28 = eventY - this.textY;
                        i5 = 0;
                        while (true) {
                            if (i5 < this.currentMessageObject.textLayoutBlocks.size()) {
                                break;
                            }
                            MessageObject.TextLayoutBlock textLayoutBlock4 = this.currentMessageObject.textLayoutBlocks.get(i5);
                            if (textLayoutBlock4.quoteCollapse && textLayoutBlock4.collapsedHeight < textLayoutBlock4.height) {
                                float f2 = i28;
                                if (f2 >= textLayoutBlock4.textYOffset(this.currentMessageObject.textLayoutBlocks, this.transitionParams) && f2 < textLayoutBlock4.textYOffset(this.currentMessageObject.textLayoutBlocks, this.transitionParams) + textLayoutBlock4.padTop + textLayoutBlock4.height(this.transitionParams) + textLayoutBlock4.padBottom) {
                                    this.pressedBlock = i5;
                                    ButtonBounce buttonBounce = textLayoutBlock4.collapsedBounce;
                                    if (buttonBounce == null || buttonBounce.getView() != this) {
                                        textLayoutBlock4.collapsedBounce = new ButtonBounce(this);
                                    }
                                    textLayoutBlock4.collapsedBounce.setPressed(motionEvent.getAction() == 0);
                                }
                            }
                            i5++;
                        }
                    }
                }
                if (motionEvent.getAction() == 1) {
                    if (this.pressedBlock != -1) {
                        for (int i29 = 0; i29 < this.currentMessageObject.textLayoutBlocks.size(); i29++) {
                            MessageObject.TextLayoutBlock textLayoutBlock5 = this.currentMessageObject.textLayoutBlocks.get(i29);
                            if (i29 == this.pressedBlock && !this.transitionParams.animateExpandedQuotes) {
                                MessageObject primaryMessageObject = textLayoutBlock5.messageObject;
                                if (primaryMessageObject == null) {
                                    primaryMessageObject = getPrimaryMessageObject();
                                    textLayoutBlock5.messageObject = primaryMessageObject;
                                }
                                if (primaryMessageObject != null) {
                                    boolean z4 = !textLayoutBlock5.collapsed();
                                    HashSet<Integer> hashSet = primaryMessageObject.expandedQuotes == null ? new HashSet<>() : new HashSet<>(primaryMessageObject.expandedQuotes);
                                    primaryMessageObject.expandedQuotes = hashSet;
                                    Integer numValueOf = Integer.valueOf(textLayoutBlock5.index);
                                    if (z4) {
                                        hashSet.remove(numValueOf);
                                    } else {
                                        hashSet.add(numValueOf);
                                    }
                                    ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
                                    if (chatMessageCellDelegate2 != null) {
                                        chatMessageCellDelegate2.forceUpdate(this, true);
                                    }
                                }
                            }
                        }
                    }
                    for (int i30 = 0; i30 < this.currentMessageObject.textLayoutBlocks.size(); i30++) {
                        ButtonBounce buttonBounce2 = this.currentMessageObject.textLayoutBlocks.get(i30).collapsedBounce;
                        if (buttonBounce2 != null) {
                            buttonBounce2.setPressed(false);
                        }
                    }
                    this.pressedBlock = -1;
                }
            } else if (motionEvent.getAction() == 3) {
                for (int i31 = 0; i31 < this.currentMessageObject.textLayoutBlocks.size(); i31++) {
                    ButtonBounce buttonBounce3 = this.currentMessageObject.textLayoutBlocks.get(i31).collapsedBounce;
                    if (buttonBounce3 != null) {
                        buttonBounce3.setPressed(false);
                    }
                }
                this.pressedBlock = -1;
            }
            return this.pressedBlock == -1;
        }
        if (motionEvent.getAction() == 1) {
            this.pressedCopyCode = null;
            resetCodeSelectors();
        }
        i = 1;
        if (motionEvent.getAction() != 0) {
            eventX = (int) getEventX(motionEvent);
            eventY = (int) getEventY(motionEvent);
            if (this.pressedLink == null) {
                messageObject = this.currentMessageObject;
                if (eventX <= i3 + messageObject.textWidth) {
                    int i282 = eventY - this.textY;
                    i5 = 0;
                    while (true) {
                        if (i5 < this.currentMessageObject.textLayoutBlocks.size()) {
                        }
                        i5++;
                    }
                }
            }
            if (motionEvent.getAction() == 1) {
            }
        }
        if (this.pressedBlock == -1) {
        }
    }

    private boolean checkTextSelection(MotionEvent motionEvent) {
        TextSelectionHelper.ChatListTextSelectionHelper textSelectionHelper;
        int iDp;
        int iDp2;
        int i;
        int iDp3;
        MessageObject.GroupedMessages groupedMessages;
        ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
        if (chatMessageCellDelegate == null || (textSelectionHelper = chatMessageCellDelegate.getTextSelectionHelper()) == null || textSelectionHelper.isMenuEmpty()) {
            return false;
        }
        ArrayList<MessageObject.TextLayoutBlock> arrayList = this.currentMessageObject.textLayoutBlocks;
        if ((arrayList == null || arrayList.isEmpty()) && !hasCaptionLayout()) {
            return false;
        }
        if ((!this.drawSelectionBackground && this.currentMessagesGroup == null) || (this.currentMessagesGroup != null && !this.delegate.hasSelectedMessages())) {
            return false;
        }
        if (this.currentMessageObject.hasValidGroupId() && (groupedMessages = this.currentMessagesGroup) != null && !groupedMessages.isDocuments) {
            ViewGroup viewGroup = (ViewGroup) getParent();
            if (viewGroup == null) {
                return false;
            }
            for (int i2 = 0; i2 < viewGroup.getChildCount(); i2++) {
                View childAt = viewGroup.getChildAt(i2);
                if (childAt instanceof ChatMessageCell) {
                    ChatMessageCell chatMessageCell = (ChatMessageCell) childAt;
                    MessageObject.GroupedMessages currentMessagesGroup = chatMessageCell.getCurrentMessagesGroup();
                    MessageObject.GroupedMessagePosition currentPosition = chatMessageCell.getCurrentPosition();
                    if (currentMessagesGroup != null && currentMessagesGroup.groupId == this.currentMessagesGroup.groupId && (currentPosition.flags & captionFlag()) != 0 && (currentPosition.flags & 1) != 0) {
                        textSelectionHelper.setMaybeTextCord((int) chatMessageCell.captionX, (int) chatMessageCell.captionY);
                        textSelectionHelper.setMessageObject(chatMessageCell);
                        if (chatMessageCell == this) {
                            return textSelectionHelper.onTouchEvent(motionEvent);
                        }
                        motionEvent.offsetLocation(getLeft() - chatMessageCell.getLeft(), getTop() - chatMessageCell.getTop());
                        boolean zOnTouchEvent = textSelectionHelper.onTouchEvent(motionEvent);
                        motionEvent.offsetLocation(-(getLeft() - chatMessageCell.getLeft()), -(getTop() - chatMessageCell.getTop()));
                        return zOnTouchEvent;
                    }
                }
            }
            return false;
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && !messageObject.preview && this.factCheckTextLayout != null && getEventY(motionEvent) >= this.factCheckY) {
            textSelectionHelper.setIsDescription(false);
            textSelectionHelper.setIsFactCheck(true);
            MessageObject.GroupedMessages groupedMessages2 = this.currentMessagesGroup;
            if (groupedMessages2 == null || groupedMessages2.isDocuments) {
                float f = 12.0f;
                if (this.currentMessageObject.isOutOwner()) {
                    int iDp4 = this.backgroundDrawableLeft + AndroidUtilities.dp(12.0f) + getExtraTextX();
                    iDp3 = this.currentMessageObject.type == 19 ? iDp4 - Math.max(0, ((Math.max(this.replyNameWidth, this.replyTextWidth) + iDp4) + AndroidUtilities.dp(14.0f)) - AndroidUtilities.displaySize.x) : iDp4;
                } else {
                    if (this.mediaBackground) {
                        i = this.backgroundDrawableLeft;
                    } else {
                        i = this.backgroundDrawableLeft;
                        if (!this.drawPinnedBottom) {
                            f = 18.0f;
                        }
                    }
                    iDp3 = i + AndroidUtilities.dp(f) + getExtraTextX();
                }
            } else {
                iDp3 = (int) this.captionX;
            }
            int iDp5 = ((int) (iDp3 + this.transitionParams.deltaLeft)) - AndroidUtilities.dp(1.33f);
            int i3 = this.factCheckY;
            iDp = (iDp5 + AndroidUtilities.dp(10.0f)) - this.factCheckTextLayoutLeft;
            iDp2 = i3 + AndroidUtilities.dp(22.0f);
        } else if (hasCaptionLayout()) {
            textSelectionHelper.setIsDescription(false);
            textSelectionHelper.setIsFactCheck(false);
            iDp = (int) this.captionX;
            iDp2 = (int) this.captionY;
        } else {
            MessageObject messageObject2 = this.currentMessageObject;
            if (messageObject2 == null || messageObject2.preview || this.descriptionLayout == null || (!this.linkPreviewAbove ? getEventY(motionEvent) <= this.descriptionY : getEventY(motionEvent) >= this.textY)) {
                textSelectionHelper.setIsDescription(false);
                textSelectionHelper.setIsFactCheck(false);
                iDp = this.textX;
                iDp2 = this.textY;
            } else {
                textSelectionHelper.setIsDescription(true);
                textSelectionHelper.setIsFactCheck(false);
                iDp = (this.hasGamePreview ? this.unmovedTextX - AndroidUtilities.dp(10.0f) : this.unmovedTextX + AndroidUtilities.dp(1.0f)) + AndroidUtilities.dp(10.0f) + this.descriptionX;
                iDp2 = this.descriptionY;
            }
        }
        textSelectionHelper.setMaybeTextCord(iDp, iDp2);
        textSelectionHelper.setMessageObject(this);
        return textSelectionHelper.onTouchEvent(motionEvent);
    }

    private boolean checkTitleLabelMotion(MotionEvent motionEvent) {
        if (this.currentMessageObject.isSponsored() && this.currentMessageObject.sponsoredCanReport) {
            int eventX = (int) getEventX(motionEvent);
            int eventY = (int) getEventY(motionEvent);
            if (motionEvent.getAction() == 0) {
                float f = eventX;
                if (f >= this.titleLabelX - AndroidUtilities.dp(6.0f) && f <= this.titleLabelX + this.titleLabelLayoutWidth + AndroidUtilities.dp(6.0f)) {
                    float f2 = eventY;
                    if (f2 >= this.titleLabelY - AndroidUtilities.dp(2.0f) && f2 <= this.titleLabelY + this.titleLabelLayoutHeight + AndroidUtilities.dp(2.0f)) {
                        ButtonBounce buttonBounce = this.titleLabelBounce;
                        if (buttonBounce != null) {
                            buttonBounce.setPressed(true);
                        }
                        this.isTitleLabelPressed = true;
                        return true;
                    }
                }
            } else if (motionEvent.getAction() == 1 && this.isTitleLabelPressed) {
                ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
                if (chatMessageCellDelegate != null) {
                    chatMessageCellDelegate.didPressAboutRevenueSharingAds();
                }
                ButtonBounce buttonBounce2 = this.titleLabelBounce;
                if (buttonBounce2 != null) {
                    buttonBounce2.setPressed(false);
                }
                playSoundEffect(0);
                this.isTitleLabelPressed = false;
            }
        }
        return false;
    }

    private boolean checkTranscribeButtonMotionEvent(MotionEvent motionEvent) {
        TranscribeButton transcribeButton;
        return this.useTranscribeButton && (!this.isPlayingRound || getVideoTranscriptionProgress() > BitmapDescriptorFactory.HUE_RED || this.wasTranscriptionOpen) && (transcribeButton = this.transcribeButton) != null && transcribeButton.onTouch(motionEvent.getAction(), getEventX(motionEvent), getEventY(motionEvent));
    }

    private void createCommentUI() {
        if (this.commentAvatarImages != null) {
            return;
        }
        this.commentAvatarImages = new ImageReceiver[3];
        this.commentAvatarDrawables = new AvatarDrawable[3];
        this.commentAvatarImagesVisible = new boolean[3];
        int i = 0;
        while (true) {
            ImageReceiver[] imageReceiverArr = this.commentAvatarImages;
            if (i >= imageReceiverArr.length) {
                return;
            }
            imageReceiverArr[i] = new ImageReceiver(this);
            this.commentAvatarImages[i].setRoundRadius(AndroidUtilities.dp(12.0f));
            this.commentAvatarDrawables[i] = new AvatarDrawable();
            this.commentAvatarDrawables[i].setTextSize(AndroidUtilities.dp(18.0f));
            i++;
        }
    }

    /* JADX WARN: Multi-variable type inference failed */
    private void createContactButtons() {
        int i;
        boolean z;
        if (Build.VERSION.SDK_INT >= 21) {
            createSelectorDrawable(0);
        }
        if (this.drawContact) {
            boolean z2 = this.drawContactView;
            if (this.drawContactSendMessage) {
                boolean z3 = (z2 ? 1 : 0) | 2;
                i = (z2 ? 1 : 0) + 1;
                z = z3;
            } else {
                i = z2 ? 1 : 0;
                z = z2;
            }
            boolean z4 = z;
            if (this.drawContactAdd) {
                i++;
                z4 = (z ? 1 : 0) | 4;
            }
            if (i == 0) {
                this.contactButtons = null;
                this.drawnContactButtonsFlag = 0;
                return;
            }
            this.totalHeight += AndroidUtilities.dp(60.0f);
            if (z4 != this.drawnContactButtonsFlag) {
                this.drawnContactButtonsFlag = 0;
                int iDp = (this.backgroundWidth - AndroidUtilities.dp(75.0f)) / i;
                float fDpf2 = (this.backgroundWidth - AndroidUtilities.dpf2(37.0f)) / i;
                ArrayList arrayList = this.contactButtons;
                if (arrayList == null) {
                    this.contactButtons = new ArrayList(i);
                } else {
                    arrayList.clear();
                }
                if (this.drawContactView) {
                    this.drawnContactButtonsFlag |= 1;
                    this.contactButtons.add(createInstantViewButton(5, LocaleController.getString("ViewContact", R.string.ViewContact), iDp, fDpf2));
                }
                if (this.drawContactSendMessage) {
                    this.drawnContactButtonsFlag |= 2;
                    this.contactButtons.add(createInstantViewButton(30, LocaleController.getString("SharedContactMessage", R.string.SharedContactMessage), iDp, fDpf2));
                }
                if (this.drawContactAdd) {
                    this.drawnContactButtonsFlag |= 4;
                    this.contactButtons.add(createInstantViewButton(31, LocaleController.getString("SharedContactAdd", R.string.SharedContactAdd), iDp, fDpf2));
                }
            }
        }
    }

    private int createDocumentLayout(int i, MessageObject messageObject) {
        TLRPC.Document document;
        int iMin;
        int iDp = i;
        int i2 = 0;
        TLRPC.MessageMedia messageMedia = messageObject.sponsoredMedia;
        if (messageMedia != null) {
            document = messageMedia.document;
        } else if (messageObject.type == 0) {
            TLRPC.MessageMedia media = MessageObject.getMedia(messageObject.messageOwner);
            TLRPC.WebPage webPage = media == null ? null : media.webpage;
            document = webPage == null ? null : webPage.document;
        } else {
            document = messageObject.getDocument();
        }
        this.documentAttach = document;
        TLRPC.Document document2 = this.documentAttach;
        if (document2 == null) {
            return 0;
        }
        double d = 0.0d;
        if (MessageObject.isVoiceDocument(document2)) {
            this.documentAttachType = 3;
            int i3 = 0;
            while (true) {
                if (i3 >= this.documentAttach.attributes.size()) {
                    break;
                }
                TLRPC.DocumentAttribute documentAttribute = this.documentAttach.attributes.get(i3);
                if (documentAttribute instanceof TLRPC.TL_documentAttributeAudio) {
                    d = documentAttribute.duration;
                    break;
                }
                i3++;
            }
            this.widthBeforeNewTimeLine = (iDp - AndroidUtilities.dp(94.0f)) - ((int) Math.ceil(Theme.chat_audioTimePaint.measureText("00:00")));
            this.availableTimeWidth = iDp - AndroidUtilities.dp(18.0f);
            measureTime(messageObject);
            int iDp2 = AndroidUtilities.dp(174.0f) + this.timeWidth;
            if (!this.hasLinkPreview) {
                this.backgroundWidth = Math.min(iDp, iDp2 + ((int) Math.ceil(Theme.chat_audioTimePaint.measureText(AndroidUtilities.formatLongDuration((int) d)))));
            }
            this.seekBarWaveform.setMessageObject(messageObject);
            return 0;
        }
        if (MessageObject.isVideoDocument(this.documentAttach)) {
            this.documentAttachType = 4;
            if (!messageObject.needDrawBluredPreview()) {
                updatePlayingMessageProgress();
                String str = String.format("%s", AndroidUtilities.formatFileSize(this.documentAttach.size));
                this.docTitleWidth = (int) Math.ceil(Theme.chat_infoPaint.measureText(str));
                this.docTitleLayout = new StaticLayout(str, Theme.chat_infoPaint, this.docTitleWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
            }
            return 0;
        }
        if (MessageObject.isMusicDocument(this.documentAttach)) {
            this.documentAttachType = 5;
            int iDp3 = iDp - AndroidUtilities.dp(92.0f);
            if (iDp3 < 0) {
                iDp3 = AndroidUtilities.dp(100.0f);
            }
            String strReplace = messageObject.getMusicTitle().replace('\n', ' ');
            TextPaint textPaint = Theme.chat_audioTitlePaint;
            float fDp = iDp3 - AndroidUtilities.dp(12.0f);
            TextUtils.TruncateAt truncateAt = TextUtils.TruncateAt.END;
            CharSequence charSequenceEllipsize = TextUtils.ellipsize(strReplace, textPaint, fDp, truncateAt);
            TextPaint textPaint2 = Theme.chat_audioTitlePaint;
            Layout.Alignment alignment = Layout.Alignment.ALIGN_NORMAL;
            StaticLayout staticLayout = new StaticLayout(charSequenceEllipsize, textPaint2, iDp3, alignment, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
            this.songLayout = staticLayout;
            if (staticLayout.getLineCount() > 0) {
                this.songX = -((int) Math.ceil(this.songLayout.getLineLeft(0)));
            }
            StaticLayout staticLayout2 = new StaticLayout(TextUtils.ellipsize(messageObject.getMusicAuthor().replace('\n', ' '), Theme.chat_audioPerformerPaint, iDp3, truncateAt), Theme.chat_audioPerformerPaint, iDp3, alignment, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
            this.performerLayout = staticLayout2;
            if (staticLayout2.getLineCount() > 0) {
                this.performerX = -((int) Math.ceil(this.performerLayout.getLineLeft(0)));
            }
            while (true) {
                if (i2 >= this.documentAttach.attributes.size()) {
                    break;
                }
                TLRPC.DocumentAttribute documentAttribute2 = this.documentAttach.attributes.get(i2);
                if (documentAttribute2 instanceof TLRPC.TL_documentAttributeAudio) {
                    d = documentAttribute2.duration;
                    break;
                }
                i2++;
            }
            int i4 = (int) d;
            int iCeil = (int) Math.ceil(Theme.chat_audioTimePaint.measureText(AndroidUtilities.formatShortDuration(i4, i4)));
            this.widthBeforeNewTimeLine = (this.backgroundWidth - AndroidUtilities.dp(86.0f)) - iCeil;
            this.availableTimeWidth = this.backgroundWidth - AndroidUtilities.dp(28.0f);
            return iCeil;
        }
        if (MessageObject.isGifDocument(this.documentAttach, messageObject.hasValidGroupId())) {
            this.documentAttachType = 2;
            if (!messageObject.needDrawBluredPreview()) {
                String string = LocaleController.getString("AttachGif", R.string.AttachGif);
                this.infoWidth = (int) Math.ceil(Theme.chat_infoPaint.measureText(string));
                TextPaint textPaint3 = Theme.chat_infoPaint;
                int i5 = this.infoWidth;
                Layout.Alignment alignment2 = Layout.Alignment.ALIGN_NORMAL;
                this.infoLayout = new StaticLayout(string, textPaint3, i5, alignment2, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                String str2 = String.format("%s", AndroidUtilities.formatFileSize(this.documentAttach.size));
                this.docTitleWidth = (int) Math.ceil(Theme.chat_infoPaint.measureText(str2));
                this.docTitleLayout = new StaticLayout(str2, Theme.chat_infoPaint, this.docTitleWidth, alignment2, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
            }
            return 0;
        }
        String str3 = this.documentAttach.mime_type;
        boolean z = (str3 != null && (str3.toLowerCase().startsWith("image/") || this.documentAttach.mime_type.toLowerCase().startsWith("video/mp4"))) || MessageObject.isDocumentHasThumb(this.documentAttach);
        this.drawPhotoImage = z;
        if (!z) {
            iDp += AndroidUtilities.dp(30.0f);
        }
        this.documentAttachType = 1;
        String documentFileName = FileLoader.getDocumentFileName(this.documentAttach);
        if (documentFileName.length() == 0) {
            documentFileName = LocaleController.getString("AttachDocument", R.string.AttachDocument);
        }
        StaticLayout staticLayoutCreateStaticLayout = StaticLayoutEx.createStaticLayout(documentFileName, Theme.chat_docNamePaint, iDp, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false, TextUtils.TruncateAt.MIDDLE, iDp, 2, false);
        this.docTitleLayout = staticLayoutCreateStaticLayout;
        this.docTitleOffsetX = Integer.MIN_VALUE;
        if (staticLayoutCreateStaticLayout == null || staticLayoutCreateStaticLayout.getLineCount() <= 0) {
            this.docTitleOffsetX = 0;
            iMin = iDp;
        } else {
            int iMax = 0;
            while (i2 < this.docTitleLayout.getLineCount()) {
                iMax = Math.max(iMax, (int) Math.ceil(this.docTitleLayout.getLineWidth(i2)));
                this.docTitleOffsetX = Math.max(this.docTitleOffsetX, (int) Math.ceil(-this.docTitleLayout.getLineLeft(i2)));
                i2++;
            }
            iMin = Math.min(iDp, iMax);
        }
        String str4 = AndroidUtilities.formatFileSize(this.documentAttach.size) + " " + FileLoader.getDocumentExtension(this.documentAttach);
        int iDp4 = iDp - AndroidUtilities.dp(30.0f);
        TextPaint textPaint4 = Theme.chat_infoPaint;
        int iMin2 = Math.min(iDp4, (int) Math.ceil(textPaint4.measureText("000.0 mm / " + AndroidUtilities.formatFileSize(this.documentAttach.size))));
        this.infoWidth = iMin2;
        CharSequence charSequenceEllipsize2 = TextUtils.ellipsize(str4, Theme.chat_infoPaint, (float) iMin2, TextUtils.TruncateAt.END);
        try {
            if (this.infoWidth < 0) {
                this.infoWidth = AndroidUtilities.dp(10.0f);
            }
            this.infoLayout = new StaticLayout(charSequenceEllipsize2, Theme.chat_infoPaint, this.infoWidth + AndroidUtilities.dp(6.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
        } catch (Exception e) {
            FileLog.e(e);
        }
        if (this.drawPhotoImage) {
            this.currentPhotoObject = FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, 320);
            this.currentPhotoObjectThumb = FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, 40);
            if (this.currentMessageObject.isHiddenSensitive() || (DownloadController.getInstance(this.currentAccount).getAutodownloadMask() & 1) == 0) {
                this.currentPhotoObject = null;
            }
            TLRPC.PhotoSize photoSize = this.currentPhotoObject;
            if (photoSize == null || photoSize == this.currentPhotoObjectThumb) {
                this.currentPhotoObject = null;
                this.photoImage.setNeedsQualityThumb(true);
                this.photoImage.setShouldGenerateQualityThumb(true);
            } else {
                BitmapDrawable bitmapDrawable = this.currentMessageObject.strippedThumb;
                if (bitmapDrawable != null) {
                    this.currentPhotoObjectThumb = null;
                    this.currentPhotoObjectThumbStripped = bitmapDrawable;
                }
            }
            this.currentPhotoFilter = "86_86_b";
            this.photoImage.setImage(ImageLocation.getForObject(this.currentPhotoObject, messageObject.photoThumbsObject), "86_86", ImageLocation.getForObject(this.currentPhotoObjectThumb, messageObject.photoThumbsObject), this.currentPhotoFilter, this.currentPhotoObjectThumbStripped, 0L, null, messageObject, 1);
        }
        return iMin;
    }

    private InstantViewButton createInstantViewButton(int i, String str, int i2, float f) {
        InstantViewButton instantViewButton = new InstantViewButton();
        instantViewButton.type = i;
        instantViewButton.layout = new StaticLayout(TextUtils.ellipsize(str, Theme.chat_instantViewPaint, i2, TextUtils.TruncateAt.END), Theme.chat_instantViewPaint, i2 + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
        instantViewButton.buttonWidth = f;
        if (instantViewButton.layout.getLineCount() > 0) {
            double d = instantViewButton.buttonWidth;
            double dCeil = Math.ceil(instantViewButton.layout.getLineWidth(0));
            Double.isNaN(d);
            instantViewButton.textX = ((float) (d - dCeil)) / 2.0f;
            InstantViewButton.access$6024(instantViewButton, (int) instantViewButton.layout.getLineLeft(0));
        }
        return instantViewButton;
    }

    /* JADX WARN: Removed duplicated region for block: B:104:0x0112  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void createInstantViewButton() {
        int iMeasureText;
        int i;
        int i2;
        if (Build.VERSION.SDK_INT >= 21 && this.drawInstantView) {
            createSelectorDrawable(0);
        }
        if (this.drawInstantView && this.instantViewLayout == null) {
            this.instantWidth = AndroidUtilities.dp(33.0f);
            String upperCase = this.instantViewButtonText;
            if (upperCase == null) {
                int i3 = this.drawInstantViewType;
                if (i3 == 12) {
                    i = R.string.OpenChannelPost;
                } else if (i3 == 1) {
                    i = R.string.OpenChannel;
                } else {
                    if (i3 == 13) {
                        i2 = R.string.SendMessage;
                    } else if (i3 == 32) {
                        i2 = R.string.OpenProfile;
                    } else if (i3 == 10) {
                        i = R.string.OpenBot;
                    } else if (i3 == 2) {
                        i = R.string.OpenGroup;
                    } else if (i3 == 3) {
                        i = R.string.OpenMessage;
                    } else if (i3 == 5) {
                        i = R.string.ViewContact;
                    } else if (i3 == 6) {
                        i = R.string.OpenBackground;
                    } else if (i3 == 7) {
                        i = R.string.OpenTheme;
                    } else if (i3 == 8) {
                        i = (this.pollVoted || this.pollClosed) ? R.string.PollViewResults : R.string.PollSubmitVotes;
                    } else if (i3 == 9 || i3 == 11) {
                        TLRPC.TL_webPage tL_webPage = (TLRPC.TL_webPage) MessageObject.getMedia(this.currentMessageObject.messageOwner).webpage;
                        i = (tL_webPage == null || !tL_webPage.url.contains("voicechat=")) ? R.string.VoipGroupJoinAsLinstener : R.string.VoipGroupJoinAsSpeaker;
                    } else if (i3 != 25) {
                        if (i3 == 14) {
                            i2 = R.string.ViewChatList;
                        } else if (i3 == 15) {
                            i2 = R.string.BotWebAppInstantViewOpen;
                        } else if (i3 == 16) {
                            i2 = R.string.OpenLink;
                        } else if (i3 == 17) {
                            i2 = R.string.ViewStory;
                        } else if (i3 == 18 || i3 == 22) {
                            i = R.string.BoostLinkButton;
                        } else if (i3 == 19) {
                            i = R.string.BoostingHowItWork;
                        } else if (i3 == 20) {
                            i = R.string.OpenGift;
                        } else if (i3 == 21) {
                            i = R.string.AppUpdate;
                        } else if (i3 == 23) {
                            i = R.string.OpenStickerSet;
                        } else if (i3 == 24) {
                            i = R.string.OpenEmojiSet;
                        } else if (i3 == 26) {
                            i = R.string.OpenUniqueGift;
                        } else if (i3 == 27) {
                            i2 = R.string.JoinCall;
                        } else {
                            i = R.string.InstantView;
                        }
                    }
                    upperCase = LocaleController.getString(i2).toUpperCase();
                }
                upperCase = LocaleController.getString(i);
            }
            if (this.currentMessageObject.isSponsored() && this.backgroundWidth < (iMeasureText = (int) (Theme.chat_instantViewPaint.measureText(upperCase) + AndroidUtilities.dp(75.0f)))) {
                this.backgroundWidth = iMeasureText;
            }
            int iDp = this.backgroundWidth - AndroidUtilities.dp(75.0f);
            StaticLayout staticLayout = new StaticLayout(TextUtils.ellipsize(upperCase, Theme.chat_instantViewPaint, iDp, TextUtils.TruncateAt.END), Theme.chat_instantViewPaint, iDp + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
            this.instantViewLayout = staticLayout;
            int lineCount = staticLayout.getLineCount();
            float lineLeft = BitmapDescriptorFactory.HUE_RED;
            this.instantViewLayoutWidth = lineCount > 0 ? this.instantViewLayout.getLineWidth(0) : BitmapDescriptorFactory.HUE_RED;
            if (this.instantViewLayout.getLineCount() > 0) {
                lineLeft = this.instantViewLayout.getLineLeft(0);
            }
            this.instantViewLayoutLeft = lineLeft;
            this.instantWidth = this.backgroundWidth - AndroidUtilities.dp(this.drawInstantViewType == 8 ? 13.0f : 34.0f);
            int iDp2 = this.totalHeight + AndroidUtilities.dp(46.0f);
            this.totalHeight = iDp2;
            if (this.currentMessageObject.type == 12) {
                this.totalHeight = iDp2 + AndroidUtilities.dp(14.0f);
            }
            if (this.currentMessageObject.isSponsored()) {
                this.totalHeight += AndroidUtilities.dp(2.0f);
            }
            StaticLayout staticLayout2 = this.instantViewLayout;
            if (staticLayout2 == null || staticLayout2.getLineCount() <= 0) {
                return;
            }
            double d = this.instantWidth;
            double dCeil = Math.ceil(this.instantViewLayout.getLineWidth(0));
            Double.isNaN(d);
            this.instantTextX = (((int) (d - dCeil)) / 2) + (this.drawInstantViewType == 0 ? AndroidUtilities.dp(8.0f) : 0);
            int lineLeft2 = (int) this.instantViewLayout.getLineLeft(0);
            this.instantTextLeftX = lineLeft2;
            this.instantTextX += -lineLeft2;
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:22:0x005e  */
    /* JADX WARN: Removed duplicated region for block: B:27:0x007d  */
    /* JADX WARN: Removed duplicated region for block: B:48:0x0103  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void createLoadingProgressLayout(long j, long j2) {
        StaticLayout staticLayout;
        boolean z;
        String fileSize;
        int iCeil;
        String str;
        int iCeil2;
        long j3 = j2;
        if (j3 <= 0 || this.documentAttach == null) {
            staticLayout = null;
        } else {
            long j4 = (j << 16) + j3;
            if (this.loadingProgressLayout != null && this.loadingProgressLayoutHash == j4) {
                return;
            }
            this.loadingProgressLayoutHash = j4;
            long j5 = this.lastLoadingSizeTotal;
            if (j5 == 0) {
                this.lastLoadingSizeTotal = j3;
            } else if (j > j5) {
                j3 = j5;
                String fileSize2 = AndroidUtilities.formatFileSize(j3);
                int iCeil3 = (int) Math.ceil(Theme.chat_infoPaint.measureText(String.format("000.0 mm / %s", fileSize2)));
                if (this.documentAttachType != 1) {
                    fileSize = iCeil3 <= Math.max(this.infoWidth, this.docTitleWidth) ? String.format("%s / %s", AndroidUtilities.formatFileSize(j5), fileSize2) : AndroidUtilities.formatFileSize(j5);
                    z = true;
                } else {
                    MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
                    z = groupedMessagePosition == null || (groupedMessagePosition.flags & 3) == 3;
                    if (z) {
                        fileSize = String.format("%s / %s", AndroidUtilities.formatFileSize(j5), fileSize2);
                    } else {
                        int iMin = (int) (Math.min(1.0f, j5 / j3) * 100.0f);
                        fileSize = iMin >= 100 ? "100%" : String.format(Locale.US, "%2d%%", Integer.valueOf(iMin));
                    }
                }
                iCeil = (int) Math.ceil(Theme.chat_infoPaint.measureText(fileSize));
                if (z || iCeil <= this.backgroundWidth - AndroidUtilities.dp(48.0f)) {
                    str = fileSize;
                    iCeil2 = iCeil;
                } else {
                    int iMin2 = (int) (Math.min(1.0f, j5 / j3) * 100.0f);
                    String str2 = iMin2 < 100 ? String.format(Locale.US, "%2d%%", Integer.valueOf(iMin2)) : "100%";
                    iCeil2 = (int) Math.ceil(Theme.chat_infoPaint.measureText(str2));
                    str = str2;
                }
                staticLayout = new StaticLayout(str, Theme.chat_infoPaint, iCeil2, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
            } else {
                j3 = j5;
            }
            j5 = j;
            String fileSize22 = AndroidUtilities.formatFileSize(j3);
            int iCeil32 = (int) Math.ceil(Theme.chat_infoPaint.measureText(String.format("000.0 mm / %s", fileSize22)));
            if (this.documentAttachType != 1) {
            }
            iCeil = (int) Math.ceil(Theme.chat_infoPaint.measureText(fileSize));
            if (z) {
                str = fileSize;
                iCeil2 = iCeil;
                staticLayout = new StaticLayout(str, Theme.chat_infoPaint, iCeil2, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
            }
        }
        this.loadingProgressLayout = staticLayout;
    }

    private void createLoadingProgressLayout(TLRPC.Document document) {
        if (document == null) {
            return;
        }
        long[] fileProgressSizes = ImageLoader.getInstance().getFileProgressSizes(FileLoader.getDocumentFileName(document));
        if (fileProgressSizes != null) {
            createLoadingProgressLayout(fileProgressSizes[0], fileProgressSizes[1]);
        } else {
            createLoadingProgressLayout(this.currentMessageObject.loadedFileSize, document.size);
        }
    }

    private void createPollUI(int i) {
        CheckBoxBase[] checkBoxBaseArr = this.pollCheckBox;
        int i2 = 0;
        if (checkBoxBaseArr == null || checkBoxBaseArr.length != i) {
            if (checkBoxBaseArr != null) {
                int i3 = 0;
                while (true) {
                    CheckBoxBase[] checkBoxBaseArr2 = this.pollCheckBox;
                    if (i3 >= checkBoxBaseArr2.length) {
                        break;
                    }
                    checkBoxBaseArr2[i3].onDetachedFromWindow();
                    i3++;
                }
            }
            this.pollCheckBox = new CheckBoxBase[i];
            int i4 = 0;
            while (true) {
                CheckBoxBase[] checkBoxBaseArr3 = this.pollCheckBox;
                if (i4 >= checkBoxBaseArr3.length) {
                    break;
                }
                checkBoxBaseArr3[i4] = new CheckBoxBase(this, 20, this.resourcesProvider);
                this.pollCheckBox[i4].setDrawUnchecked(false);
                this.pollCheckBox[i4].setBackgroundType(9);
                i4++;
            }
        }
        if (this.pollAvatarImages != null) {
            return;
        }
        this.pollAvatarImages = new ImageReceiver[3];
        this.pollAvatarDrawables = new AvatarDrawable[3];
        this.pollAvatarImagesVisible = new boolean[3];
        while (true) {
            ImageReceiver[] imageReceiverArr = this.pollAvatarImages;
            if (i2 >= imageReceiverArr.length) {
                return;
            }
            imageReceiverArr[i2] = new ImageReceiver(this);
            this.pollAvatarImages[i2].setRoundRadius(AndroidUtilities.dp(8.0f));
            this.pollAvatarDrawables[i2] = new AvatarDrawable();
            this.pollAvatarDrawables[i2].setTextSize(AndroidUtilities.dp(22.0f));
            i2++;
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void createStatusDrawableAnimator(int i, int i2, final boolean z) {
        boolean z2 = false;
        boolean z3 = (i2 & 1) != 0;
        boolean z4 = (i2 & 2) != 0;
        boolean z5 = (i & 1) != 0;
        boolean z6 = (i & 2) != 0;
        if ((i & 4) == 0 && z6 && z4 && !z5 && z3) {
            z2 = true;
        }
        if (!this.transitionParams.messageEntering || z2) {
            this.statusDrawableProgress = BitmapDescriptorFactory.HUE_RED;
            ValueAnimator valueAnimatorOfFloat = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f);
            this.statusDrawableAnimator = valueAnimatorOfFloat;
            valueAnimatorOfFloat.setDuration(z2 ? 220L : 150L);
            this.statusDrawableAnimator.setInterpolator(CubicBezierInterpolator.DEFAULT);
            this.animateFromStatusDrawableParams = i;
            this.animateToStatusDrawableParams = i2;
            this.statusDrawableAnimator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda1
                @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                    this.f$0.lambda$createStatusDrawableAnimator$14(z, valueAnimator);
                }
            });
            this.statusDrawableAnimator.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.Cells.ChatMessageCell.9
                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                public void onAnimationEnd(Animator animator) {
                    int iCreateStatusDrawableParams = ChatMessageCell.this.transitionParams.createStatusDrawableParams();
                    if (ChatMessageCell.this.animateToStatusDrawableParams != iCreateStatusDrawableParams) {
                        ChatMessageCell chatMessageCell = ChatMessageCell.this;
                        chatMessageCell.createStatusDrawableAnimator(chatMessageCell.animateToStatusDrawableParams, iCreateStatusDrawableParams, z);
                    } else {
                        ChatMessageCell.this.statusDrawableAnimationInProgress = false;
                        ChatMessageCell chatMessageCell2 = ChatMessageCell.this;
                        chatMessageCell2.transitionParams.lastStatusDrawableParams = chatMessageCell2.animateToStatusDrawableParams;
                    }
                }
            });
            this.statusDrawableAnimationInProgress = true;
            this.statusDrawableAnimator.start();
        }
    }

    private void didClickedImage() throws Resources.NotFoundException, NumberFormatException {
        ChatMessageCellDelegate chatMessageCellDelegate;
        MessageObject messageObject;
        ChatMessageCellDelegate chatMessageCellDelegate2;
        TLRPC.WebPage webPage;
        TLRPC.MessageMedia messageMedia;
        TLRPC.ReplyMarkup replyMarkup;
        if (this.currentMessageObject.hasMediaSpoilers() && !this.currentMessageObject.needDrawBluredPreview()) {
            MessageObject messageObject2 = this.currentMessageObject;
            if (!messageObject2.isMediaSpoilersRevealed) {
                if (this.delegate == null || !messageObject2.isSensitive()) {
                    startRevealMedia(this.lastTouchX, this.lastTouchY);
                    return;
                } else {
                    this.delegate.didPressRevealSensitiveContent(this);
                    return;
                }
            }
        }
        MessageObject messageObject3 = this.currentMessageObject;
        int i = messageObject3.type;
        if (i == 20) {
            TLRPC.Message message = messageObject3.messageOwner;
            if (message == null || (messageMedia = message.media) == null || messageMedia.extended_media.isEmpty() || (replyMarkup = this.currentMessageObject.messageOwner.reply_markup) == null) {
                return;
            }
            Iterator it = replyMarkup.rows.iterator();
            while (it.hasNext()) {
                Iterator it2 = ((TLRPC.TL_keyboardButtonRow) it.next()).buttons.iterator();
                if (it2.hasNext()) {
                    this.delegate.didPressExtendedMediaPreview(this, (TLRPC.KeyboardButton) it2.next());
                    return;
                }
            }
            return;
        }
        if (i != 1 && !messageObject3.isAnyKindOfSticker()) {
            MessageObject messageObject4 = this.currentMessageObject;
            int i2 = messageObject4.type;
            if (i2 == 12) {
                long j = MessageObject.getMedia(messageObject4.messageOwner).user_id;
                this.delegate.didPressUserAvatar(this, j != 0 ? MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(j)) : null, this.lastTouchX, this.lastTouchY, false);
                return;
            }
            if (i2 == 5) {
                if (this.buttonState == -1) {
                    if (!MediaController.getInstance().isPlayingMessage(this.currentMessageObject) || MediaController.getInstance().isMessagePaused()) {
                        this.delegate.needPlayMessage(this, this.currentMessageObject, false);
                        return;
                    } else {
                        MediaController.getInstance().lambda$startAudioAgain$7(this.currentMessageObject);
                        return;
                    }
                }
            } else if (i2 == 8) {
                int i3 = this.buttonState;
                if (i3 != -1 && (i3 != 1 || !this.canStreamVideo || !this.autoPlayingMedia)) {
                    if (i3 != 2 && i3 != 0) {
                        return;
                    }
                }
                chatMessageCellDelegate = this.delegate;
            } else {
                if (this.documentAttachType != 4 && !messageObject4.hasVideoQualities()) {
                    MessageObject messageObject5 = this.currentMessageObject;
                    int i4 = messageObject5.type;
                    if (i4 != 4 && i4 != 23 && i4 != 24) {
                        int i5 = this.documentAttachType;
                        if (i5 == 1) {
                            if (this.buttonState != -1) {
                                return;
                            }
                        } else if (messageObject5.sponsoredMedia != null) {
                            chatMessageCellDelegate = this.delegate;
                            if (chatMessageCellDelegate == null) {
                                return;
                            }
                        } else {
                            if (i5 == 2) {
                                if (this.buttonState != -1 || (webPage = MessageObject.getMedia(messageObject5.messageOwner).webpage) == null) {
                                    return;
                                }
                                String str = webPage.embed_url;
                                if (str == null || str.length() == 0) {
                                    Browser.openUrl(getContext(), webPage.url);
                                    return;
                                } else {
                                    this.delegate.needOpenWebView(this.currentMessageObject, webPage.embed_url, webPage.site_name, webPage.description, webPage.url, webPage.embed_width, webPage.embed_height);
                                    return;
                                }
                            }
                            if (!this.hasInvoicePreview) {
                                if (Build.VERSION.SDK_INT < 26 || (chatMessageCellDelegate2 = this.delegate) == null) {
                                    return;
                                }
                                if (i4 == 16) {
                                    chatMessageCellDelegate2.didLongPress(this, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED);
                                    return;
                                } else {
                                    chatMessageCellDelegate2.didPressOther(this, this.otherX, this.otherY);
                                    return;
                                }
                            }
                            if (this.buttonState != -1) {
                                return;
                            }
                        }
                    }
                } else if (this.buttonState != -1 && (!this.drawVideoImageButton || (!this.autoPlayingMedia && (((messageObject = this.currentMessageObject) == null || !messageObject.hasVideoQualities()) && (!SharedConfig.streamMedia || !this.canStreamVideo))))) {
                    if (this.drawVideoImageButton) {
                        didPressButton(true, true);
                        return;
                    }
                    int i6 = this.buttonState;
                    if (i6 != 0 && i6 != 3) {
                        return;
                    }
                }
                chatMessageCellDelegate = this.delegate;
            }
            didPressButton(true, false);
            return;
        }
        int i7 = this.buttonState;
        if (i7 != -1) {
            if (i7 != 0) {
                return;
            }
            didPressButton(true, false);
            return;
        }
        chatMessageCellDelegate = this.delegate;
        chatMessageCellDelegate.didPressImage(this, this.lastTouchX, this.lastTouchY, false);
    }

    /* JADX WARN: Code restructure failed: missing block: B:65:0x00cf, code lost:
    
        if (r30.currentMessageObject.loadedFileSize > 0) goto L81;
     */
    /* JADX WARN: Code restructure failed: missing block: B:80:0x013d, code lost:
    
        if (r30.currentMessageObject.loadedFileSize > 0) goto L81;
     */
    /* JADX WARN: Code restructure failed: missing block: B:81:0x013f, code lost:
    
        r2 = r30.documentAttach;
     */
    /* JADX WARN: Code restructure failed: missing block: B:82:0x0141, code lost:
    
        createLoadingProgressLayout(r2);
     */
    /* JADX WARN: Code restructure failed: missing block: B:86:0x015d, code lost:
    
        if (r2.loadedFileSize > 0) goto L93;
     */
    /* JADX WARN: Code restructure failed: missing block: B:92:0x019c, code lost:
    
        if (r2.loadedFileSize > 0) goto L93;
     */
    /* JADX WARN: Code restructure failed: missing block: B:93:0x019e, code lost:
    
        r2 = r2.getDocument();
     */
    /* JADX WARN: Removed duplicated region for block: B:102:0x024a  */
    /* JADX WARN: Removed duplicated region for block: B:160:0x032c  */
    /* JADX WARN: Removed duplicated region for block: B:161:0x0333  */
    /* JADX WARN: Removed duplicated region for block: B:56:0x00ab  */
    /* JADX WARN: Removed duplicated region for block: B:57:0x00ad  */
    /* JADX WARN: Removed duplicated region for block: B:99:0x020b  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void didPressButton(boolean z, boolean z2) {
        ChatMessageCellDelegate chatMessageCellDelegate;
        MessageObject messageObject;
        MessageObject playingMessageObject;
        RadialProgress2 radialProgress2;
        int iconForCurrentState;
        FileLoader fileLoader;
        TLRPC.Document document;
        MessageObject messageObject2;
        TLRPC.PhotoSize photoSize;
        String str;
        int i;
        int i2;
        MessageObject messageObject3;
        MessageObject messageObject4;
        if (this.delegate != null && this.currentMessageObject.isSensitive() && this.currentMessageObject.hasMediaSpoilers() && !this.currentMessageObject.needDrawBluredPreview() && !this.currentMessageObject.isMediaSpoilersRevealed) {
            this.delegate.didPressRevealSensitiveContent(this);
            return;
        }
        MessageObject messageObject5 = this.currentMessageObject;
        if (messageObject5 != null && !messageObject5.isAnyKindOfSticker()) {
            this.currentMessageObject.putInDownloadsStore = true;
        }
        int i3 = this.buttonState;
        if (i3 != 0 || (this.drawVideoImageButton && !z2)) {
            if (i3 != 1 || (this.drawVideoImageButton && !z2)) {
                if (i3 == 2) {
                    MessageObject messageObject6 = this.currentMessageObject;
                    if (messageObject6 != null && messageObject6.type == 23) {
                        chatMessageCellDelegate = this.delegate;
                    } else if (this.documentAttachType == 7 && messageObject6 != null && messageObject6.isVoiceTranscriptionOpen()) {
                        if (this.miniButtonState == 0) {
                            FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 2, 0);
                            this.currentMessageObject.loadingCancelled = false;
                        }
                        if (this.delegate.needPlayMessage(this, this.currentMessageObject, false)) {
                            if (this.hasMiniProgress == 2 && this.miniButtonState != 1) {
                                this.miniButtonState = 1;
                                this.radialProgress.setProgress(BitmapDescriptorFactory.HUE_RED, false);
                                this.radialProgress.setMiniIcon(getMiniIconForCurrentState(), false, true);
                            }
                            updatePlayingMessageProgress();
                            this.buttonState = 1;
                            this.radialProgress.setIcon(getIconForCurrentState(), false, true);
                            invalidate();
                        }
                        if (!this.isRoundVideo) {
                            return;
                        } else {
                            this.wouldBeInPip = true;
                        }
                    } else {
                        int i4 = this.documentAttachType;
                        if (i4 != 3 && i4 != 5) {
                            if (!this.isRoundVideo || (playingMessageObject = MediaController.getInstance().getPlayingMessageObject()) == null || !playingMessageObject.isRoundVideo()) {
                                this.photoImage.setAllowStartAnimation(true);
                                this.photoImage.startAnimation();
                            }
                            this.currentMessageObject.gifState = BitmapDescriptorFactory.HUE_RED;
                            this.buttonState = -1;
                            this.radialProgress.setIcon(getIconForCurrentState(), false, z);
                            return;
                        }
                        this.radialProgress.setProgress(BitmapDescriptorFactory.HUE_RED, false);
                        FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 2, 0);
                        this.currentMessageObject.loadingCancelled = false;
                        this.buttonState = 4;
                        this.radialProgress.setIcon(getIconForCurrentState(), true, z);
                    }
                } else if (i3 == 3 || i3 == 0) {
                    if (this.hasMiniProgress == 2 && this.miniButtonState != 1) {
                        this.miniButtonState = 1;
                        this.radialProgress.setProgress(BitmapDescriptorFactory.HUE_RED, false);
                        this.radialProgress.setMiniIcon(getMiniIconForCurrentState(), false, z);
                    }
                    chatMessageCellDelegate = this.delegate;
                    if (chatMessageCellDelegate == null) {
                        return;
                    }
                } else {
                    if (i3 != 4) {
                        return;
                    }
                    int i5 = this.documentAttachType;
                    if (i5 != 3 && i5 != 5 && (i5 != 7 || (messageObject = this.currentMessageObject) == null || !messageObject.isVoiceTranscriptionOpen())) {
                        return;
                    }
                    if ((this.currentMessageObject.isOut() && (this.currentMessageObject.isSending() || this.currentMessageObject.isEditing())) || this.currentMessageObject.isSendError()) {
                        if (this.delegate == null || this.radialProgress.getIcon() == 6) {
                            return;
                        }
                        this.delegate.didPressCancelSendButton(this);
                        return;
                    }
                    this.currentMessageObject.loadingCancelled = true;
                    FileLoader.getInstance(this.currentAccount).cancelLoadFile(this.documentAttach);
                    this.buttonState = 2;
                    radialProgress2 = this.radialProgress;
                    iconForCurrentState = getIconForCurrentState();
                }
                chatMessageCellDelegate.didPressImage(this, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, false);
                return;
            }
            this.photoImage.setForceLoading(false);
            int i6 = this.documentAttachType;
            if (i6 == 3 || i6 == 5 || (i6 == 7 && (messageObject2 = this.currentMessageObject) != null && messageObject2.isVoiceTranscriptionOpen())) {
                if (!MediaController.getInstance().lambda$startAudioAgain$7(this.currentMessageObject)) {
                    return;
                }
                this.buttonState = 0;
                radialProgress2 = this.radialProgress;
                iconForCurrentState = getIconForCurrentState();
            } else {
                if (this.currentMessageObject.isOut() && !this.drawVideoImageButton && (this.currentMessageObject.isSending() || this.currentMessageObject.isEditing())) {
                    if (this.radialProgress.getIcon() == 6) {
                        return;
                    }
                    this.delegate.didPressCancelSendButton(this);
                    return;
                }
                MessageObject messageObject7 = this.currentMessageObject;
                messageObject7.loadingCancelled = true;
                int i7 = this.documentAttachType;
                if (i7 == 2 || i7 == 4 || i7 == 1 || i7 == 8) {
                    fileLoader = FileLoader.getInstance(this.currentAccount);
                    document = this.documentAttach;
                } else {
                    int i8 = messageObject7.type;
                    if (i8 == 0 || i8 == 1 || i8 == 20 || i8 == 8 || i8 == 5) {
                        ImageLoader.getInstance().cancelForceLoadingForImageReceiver(this.photoImage);
                        this.photoImage.cancelLoadImage();
                    } else if (i8 == 9) {
                        fileLoader = FileLoader.getInstance(this.currentAccount);
                        document = this.currentMessageObject.getDocument();
                    }
                    this.buttonState = 0;
                    if (z2) {
                        this.videoRadialProgress.setIcon(2, false, z);
                    }
                    radialProgress2 = this.radialProgress;
                    iconForCurrentState = getIconForCurrentState();
                }
                fileLoader.cancelLoadFile(document);
                this.buttonState = 0;
                if (z2) {
                }
                radialProgress2 = this.radialProgress;
                iconForCurrentState = getIconForCurrentState();
            }
            radialProgress2.setIcon(iconForCurrentState, false, z);
        } else {
            int i9 = this.documentAttachType;
            if (i9 == 3 || i9 == 5 || (i9 == 7 && (messageObject4 = this.currentMessageObject) != null && messageObject4.isVoiceTranscriptionOpen() && this.currentMessageObject.mediaExists)) {
                if (this.miniButtonState == 0) {
                    FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 2, 0);
                    this.currentMessageObject.loadingCancelled = false;
                }
                if (!this.delegate.needPlayMessage(this, this.currentMessageObject, false)) {
                    return;
                }
                if (this.hasMiniProgress == 2 && this.miniButtonState != 1) {
                    this.miniButtonState = 1;
                    this.radialProgress.setProgress(BitmapDescriptorFactory.HUE_RED, false);
                    this.radialProgress.setMiniIcon(getMiniIconForCurrentState(), false, true);
                }
                updatePlayingMessageProgress();
                this.buttonState = 1;
                this.radialProgress.setIcon(getIconForCurrentState(), false, true);
            } else {
                (z2 ? this.videoRadialProgress : this.radialProgress).setProgress(BitmapDescriptorFactory.HUE_RED, false);
                if (this.currentPhotoObject == null || !(this.photoImage.hasNotThumb() || this.currentPhotoObjectThumb == null)) {
                    photoSize = this.currentPhotoObjectThumb;
                } else {
                    photoSize = this.currentPhotoObject;
                    if (!(photoSize instanceof TLRPC.TL_photoStrippedSize) && !"s".equals(photoSize.type)) {
                        str = this.currentPhotoFilter;
                    }
                    String str2 = str;
                    i = !this.currentMessageObject.shouldEncryptPhotoOrVideo() ? 2 : 0;
                    MessageObject messageObject8 = this.currentMessageObject;
                    i2 = messageObject8.type;
                    if (i2 != 1 || i2 == 20) {
                        this.photoImage.setForceLoading(true);
                        this.photoImage.setImage(ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, this.currentPhotoObject.size, null, this.currentMessageObject, i);
                    } else if (i2 == 8) {
                        FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 2, 0);
                    } else if (this.isRoundVideo) {
                        if (messageObject8.isSecretMedia()) {
                            FileLoader fileLoader2 = FileLoader.getInstance(this.currentAccount);
                            TLRPC.Document document2 = this.currentMessageObject.getDocument();
                            MessageObject messageObject9 = this.currentMessageObject;
                            fileLoader2.loadFile(document2, messageObject9, 2, messageObject9.shouldEncryptPhotoOrVideo() ? 2 : 1);
                        } else {
                            MessageObject messageObject10 = this.currentMessageObject;
                            messageObject10.gifState = 2.0f;
                            TLRPC.Document document3 = messageObject10.getDocument();
                            this.photoImage.setForceLoading(true);
                            this.photoImage.setImage(ImageLocation.getForDocument(document3), null, ImageLocation.getForObject(photoSize, document3), str2, document3.size, null, this.currentMessageObject, 0);
                        }
                        this.wouldBeInPip = true;
                        invalidate();
                    } else if (i2 == 9) {
                        FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 2, 0);
                    } else {
                        int i10 = this.documentAttachType;
                        if (i10 == 4) {
                            FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 1, i);
                            messageObject3 = this.currentMessageObject;
                        } else if (i2 != 0 || i10 == 0) {
                            this.photoImage.setForceLoading(true);
                            this.photoImage.setImage(ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, 0L, null, this.currentMessageObject, 0);
                        } else if (i10 == 2) {
                            this.photoImage.setForceLoading(true);
                            this.photoImage.setImage(ImageLocation.getForDocument(this.documentAttach), null, ImageLocation.getForDocument(this.currentPhotoObject, this.documentAttach), this.currentPhotoFilterThumb, this.documentAttach.size, null, this.currentMessageObject, i);
                            messageObject3 = this.currentMessageObject;
                            messageObject3.gifState = 2.0f;
                        } else if (i10 == 1) {
                            FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 2, 0);
                        } else if (i10 == 8) {
                            this.photoImage.setImage(ImageLocation.getForDocument(this.documentAttach), this.currentPhotoFilter, ImageLocation.getForDocument(this.currentPhotoObject, this.documentAttach), "b1", 0L, "jpg", this.currentMessageObject, 1);
                        }
                    }
                    this.currentMessageObject.loadingCancelled = false;
                    this.buttonState = 1;
                    if (z2) {
                        radialProgress2 = this.radialProgress;
                        iconForCurrentState = getIconForCurrentState();
                    } else {
                        radialProgress2 = this.videoRadialProgress;
                        iconForCurrentState = 14;
                    }
                    radialProgress2.setIcon(iconForCurrentState, false, z);
                }
                str = this.currentPhotoFilterThumb;
                String str22 = str;
                if (!this.currentMessageObject.shouldEncryptPhotoOrVideo()) {
                }
                MessageObject messageObject82 = this.currentMessageObject;
                i2 = messageObject82.type;
                if (i2 != 1) {
                    this.photoImage.setForceLoading(true);
                    this.photoImage.setImage(ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, this.currentPhotoObject.size, null, this.currentMessageObject, i);
                    this.currentMessageObject.loadingCancelled = false;
                    this.buttonState = 1;
                    if (z2) {
                    }
                    radialProgress2.setIcon(iconForCurrentState, false, z);
                }
            }
        }
        invalidate();
    }

    /* JADX WARN: Removed duplicated region for block: B:21:0x0052 A[PHI: r0 r1 r7
      0x0052: PHI (r0v5 org.telegram.tgnet.TLRPC$Document) = (r0v4 org.telegram.tgnet.TLRPC$Document), (r0v8 org.telegram.tgnet.TLRPC$Document) binds: [B:20:0x0050, B:17:0x003f] A[DONT_GENERATE, DONT_INLINE]
      0x0052: PHI (r1v2 org.telegram.messenger.MessageObject) = (r1v1 org.telegram.messenger.MessageObject), (r1v6 org.telegram.messenger.MessageObject) binds: [B:20:0x0050, B:17:0x003f] A[DONT_GENERATE, DONT_INLINE]
      0x0052: PHI (r7v15 org.telegram.messenger.FileLoader) = (r7v14 org.telegram.messenger.FileLoader), (r7v21 org.telegram.messenger.FileLoader) binds: [B:20:0x0050, B:17:0x003f] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:22:0x0054 A[PHI: r0 r1 r7
      0x0054: PHI (r0v7 org.telegram.tgnet.TLRPC$Document) = (r0v4 org.telegram.tgnet.TLRPC$Document), (r0v8 org.telegram.tgnet.TLRPC$Document) binds: [B:20:0x0050, B:17:0x003f] A[DONT_GENERATE, DONT_INLINE]
      0x0054: PHI (r1v4 org.telegram.messenger.MessageObject) = (r1v1 org.telegram.messenger.MessageObject), (r1v6 org.telegram.messenger.MessageObject) binds: [B:20:0x0050, B:17:0x003f] A[DONT_GENERATE, DONT_INLINE]
      0x0054: PHI (r7v18 org.telegram.messenger.FileLoader) = (r7v14 org.telegram.messenger.FileLoader), (r7v21 org.telegram.messenger.FileLoader) binds: [B:20:0x0050, B:17:0x003f] A[DONT_GENERATE, DONT_INLINE]] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void didPressMiniButton(boolean z) {
        FileLoader fileLoader;
        TLRPC.Document document;
        MessageObject messageObject;
        int i;
        int i2 = this.miniButtonState;
        if (i2 == 0) {
            this.miniButtonState = 1;
            this.radialProgress.setProgress(BitmapDescriptorFactory.HUE_RED, false);
            MessageObject messageObject2 = this.currentMessageObject;
            if (messageObject2 != null && !messageObject2.isAnyKindOfSticker()) {
                this.currentMessageObject.putInDownloadsStore = true;
            }
            int i3 = this.documentAttachType;
            if (i3 == 3 || i3 == 5) {
                fileLoader = FileLoader.getInstance(this.currentAccount);
                document = this.documentAttach;
                messageObject = this.currentMessageObject;
                i = messageObject.shouldEncryptPhotoOrVideo() ? 2 : 0;
            } else if (i3 == 4 || i3 == 7) {
                createLoadingProgressLayout(this.documentAttach);
                fileLoader = FileLoader.getInstance(this.currentAccount);
                document = this.documentAttach;
                messageObject = this.currentMessageObject;
                if (messageObject.shouldEncryptPhotoOrVideo()) {
                }
            }
            fileLoader.loadFile(document, messageObject, 2, i);
            this.currentMessageObject.loadingCancelled = false;
        } else {
            if (i2 != 1) {
                return;
            }
            int i4 = this.documentAttachType;
            if ((i4 == 3 || i4 == 5 || i4 == 7) && MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                MediaController.getInstance().cleanupPlayer(true, true);
            }
            this.miniButtonState = 0;
            this.currentMessageObject.loadingCancelled = true;
            FileLoader.getInstance(this.currentAccount).cancelLoadFile(this.documentAttach);
        }
        this.radialProgress.setMiniIcon(getMiniIconForCurrentState(), false, true);
        invalidate();
    }

    /* JADX WARN: Multi-variable type inference failed */
    /* JADX WARN: Removed duplicated region for block: B:48:0x00c0  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void drawAnimatedEmojiMessageText(float f, float f2, Canvas canvas, ArrayList arrayList, AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans, boolean z, float f3, float f4, boolean z2) {
        int size;
        int i;
        float backgroundDrawableRight;
        int i2;
        int i3;
        int i4;
        float f5;
        int i5;
        int i6;
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        ArrayList arrayList2 = arrayList;
        if (this.currentMessageObject == null || arrayList2 == null || arrayList.isEmpty()) {
            return;
        }
        float f6 = BitmapDescriptorFactory.HUE_RED;
        if (f3 == BitmapDescriptorFactory.HUE_RED) {
            return;
        }
        if (!z || z2) {
            size = arrayList.size();
            i = 0;
        } else {
            if (this.fullyDraw) {
                this.firstVisibleBlockNum = 0;
                this.lastVisibleBlockNum = arrayList.size();
            }
            i = this.firstVisibleBlockNum;
            size = this.lastVisibleBlockNum;
        }
        if (this.currentMessagesGroup == null || (groupedMessagePosition = this.currentPosition) == null) {
            backgroundDrawableRight = getBackgroundDrawableRight() + this.transitionParams.deltaRight;
        } else {
            int i7 = groupedMessagePosition.flags;
            if ((i7 & 1) == 0 || (i7 & 2) == 0) {
                int minTabletSide = AndroidUtilities.isTablet() ? AndroidUtilities.getMinTabletSide() : getParentWidth();
                int i8 = 0;
                for (int i9 = 0; i9 < this.currentMessagesGroup.posArray.size(); i9++) {
                    if (this.currentMessagesGroup.posArray.get(i9).minY != 0) {
                        break;
                    }
                    double d = i8;
                    double dCeil = Math.ceil(((r5.pw + r5.leftSpanOffset) / 1000.0f) * minTabletSide);
                    Double.isNaN(d);
                    i8 = (int) (d + dCeil);
                }
                backgroundDrawableRight = ((this.mediaBackground || !this.currentMessageObject.isOutOwner()) ? this.backgroundDrawableLeft + i8 : (this.backgroundDrawableLeft + i8) - AndroidUtilities.dp(6.0f)) - (getExtraTextX() + AndroidUtilities.dp((this.isAvatarVisible ? 48 : 0) + 8));
            }
        }
        float fDp = (backgroundDrawableRight - (AndroidUtilities.dp(10 + ((!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 0 : 6)) + getExtraTextX())) - f;
        int i10 = i;
        while (i10 <= size && i10 < arrayList.size()) {
            if (i10 < 0) {
                i5 = i10;
                i6 = size;
            } else {
                MessageObject.TextLayoutBlock textLayoutBlock = (MessageObject.TextLayoutBlock) arrayList2.get(i10);
                int saveCount = canvas.getSaveCount();
                canvas.save();
                canvas.translate(f - (textLayoutBlock.isRtl() ? (int) Math.ceil(f4) : 0), f2 + textLayoutBlock.padTop + textLayoutBlock.textYOffset(arrayList2, this.transitionParams) + this.transitionYOffsetForDrawables);
                float fTextYOffset = f2 + textLayoutBlock.textYOffset(arrayList2, this.transitionParams) + this.transitionYOffsetForDrawables;
                boolean z3 = this.transitionParams.messageEntering;
                int i11 = this.currentMessageObject.isOutOwner() ? Theme.key_chat_messageTextOut : Theme.key_chat_messageTextIn;
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    i11 = Theme.key_windowBackgroundWhiteBlackText;
                }
                int i12 = i11;
                int iDp = (int) (textLayoutBlock.maxRight + ((float) AndroidUtilities.dp(24.0f)) > 0.7f * fDp ? fDp : textLayoutBlock.maxRight + AndroidUtilities.dp(24.0f));
                if (textLayoutBlock.quoteCollapse) {
                    RectF rectF = AndroidUtilities.rectTmp;
                    rectF.set(f6, (-textLayoutBlock.padTop) + AndroidUtilities.dp(textLayoutBlock.first ? 4.66f : 3.0f), iDp, textLayoutBlock.height(this.transitionParams) + AndroidUtilities.dp(4.0f));
                    rectF.offset(textLayoutBlock.isRtl() ? f4 - AndroidUtilities.dp(10.0f) : BitmapDescriptorFactory.HUE_RED, f6);
                    ButtonBounce buttonBounce = textLayoutBlock.collapsedBounce;
                    if (buttonBounce != null) {
                        float scale = buttonBounce.getScale(0.01f);
                        canvas.scale(scale, scale, rectF.centerX(), rectF.centerY());
                    }
                }
                if (!textLayoutBlock.quoteCollapse || textLayoutBlock.height <= textLayoutBlock.collapsedHeight) {
                    i2 = iDp;
                    i3 = i12;
                    i4 = saveCount;
                    f5 = 1.0f;
                } else {
                    float fCollapsed = textLayoutBlock.collapsed(this.transitionParams);
                    i2 = iDp;
                    i3 = i12;
                    i4 = saveCount;
                    canvas.saveLayerAlpha(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, iDp, textLayoutBlock.height(this.transitionParams) - 1, 255, 31);
                    f5 = fCollapsed;
                }
                StaticLayout staticLayout = textLayoutBlock.textLayout;
                List<SpoilerEffect> list = textLayoutBlock.spoilers;
                ColorFilter adaptiveEmojiColorFilter = getAdaptiveEmojiColorFilter(0, getThemedColor(i3));
                float f7 = f5;
                i5 = i10;
                i6 = size;
                AnimatedEmojiSpan.drawAnimatedEmojis(canvas, staticLayout, emojiGroupedSpans, BitmapDescriptorFactory.HUE_RED, list, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, fTextYOffset, f3, adaptiveEmojiColorFilter);
                if (textLayoutBlock.quoteCollapse && textLayoutBlock.height > textLayoutBlock.collapsedHeight) {
                    if (this.clip == null) {
                        this.clip = new GradientClip();
                    }
                    canvas.save();
                    RectF rectF2 = AndroidUtilities.rectTmp;
                    rectF2.set(BitmapDescriptorFactory.HUE_RED, textLayoutBlock.height(this.transitionParams) - AndroidUtilities.dp(24.0f), i2, textLayoutBlock.height(this.transitionParams));
                    this.clip.draw(canvas, rectF2, 3, f7);
                    canvas.restore();
                }
                canvas.restoreToCount(i4);
            }
            i10 = i5 + 1;
            arrayList2 = arrayList;
            size = i6;
            f6 = BitmapDescriptorFactory.HUE_RED;
        }
    }

    private void drawAnimatedEmojiMessageText(Canvas canvas, float f) {
        float f2;
        int iDp;
        int iDp2;
        int i;
        int iDp3;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || messageObject.isSponsored()) {
            return;
        }
        float f3 = this.textY;
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateText) {
            float f4 = transitionParams.animateFromTextY;
            float f5 = transitionParams.animateChangeProgress;
            f2 = (f4 * (1.0f - f5)) + (f3 * f5);
        } else {
            f2 = f3;
        }
        if (transitionParams.animateChangeProgress == 1.0f || !transitionParams.animateMessageText) {
            float f6 = this.textX;
            MessageObject messageObject2 = this.currentMessageObject;
            drawAnimatedEmojiMessageText(f6, f2, canvas, messageObject2.textLayoutBlocks, this.animatedEmojiStack, true, f, messageObject2.textXOffset, false);
            return;
        }
        canvas.save();
        Theme.MessageDrawable messageDrawable = this.currentBackgroundDrawable;
        if (messageDrawable != null) {
            Rect bounds = messageDrawable.getBounds();
            if (!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.pinnedBottom) {
                iDp = bounds.left + AndroidUtilities.dp(4.0f);
                iDp2 = bounds.top + AndroidUtilities.dp(4.0f);
                i = bounds.right;
                iDp3 = AndroidUtilities.dp(4.0f);
            } else {
                iDp = bounds.left + AndroidUtilities.dp(4.0f);
                iDp2 = bounds.top + AndroidUtilities.dp(4.0f);
                i = bounds.right;
                iDp3 = AndroidUtilities.dp(10.0f);
            }
            canvas.clipRect(iDp, iDp2, i - iDp3, bounds.bottom - AndroidUtilities.dp(4.0f));
        }
        drawAnimatedEmojiMessageText(this.textX, f2, canvas, this.transitionParams.animateOutTextBlocks, this.transitionParams.animateOutAnimateEmoji, false, f * (1.0f - this.transitionParams.animateChangeProgress), this.currentMessageObject.textXOffset, false);
        float f7 = this.textX;
        MessageObject messageObject3 = this.currentMessageObject;
        drawAnimatedEmojiMessageText(f7, f2, canvas, messageObject3.textLayoutBlocks, this.animatedEmojiStack, true, f * this.transitionParams.animateChangeProgress, messageObject3.textXOffset, false);
        canvas.restore();
    }

    /* JADX WARN: Removed duplicated region for block: B:107:0x0313 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:111:0x0320  */
    /* JADX WARN: Removed duplicated region for block: B:115:0x0394  */
    /* JADX WARN: Removed duplicated region for block: B:116:0x03ca  */
    /* JADX WARN: Removed duplicated region for block: B:119:0x03d8  */
    /* JADX WARN: Removed duplicated region for block: B:120:0x03df  */
    /* JADX WARN: Removed duplicated region for block: B:123:0x03fd  */
    /* JADX WARN: Removed duplicated region for block: B:124:0x0402  */
    /* JADX WARN: Removed duplicated region for block: B:127:0x0412  */
    /* JADX WARN: Removed duplicated region for block: B:132:0x0460  */
    /* JADX WARN: Removed duplicated region for block: B:135:0x0493  */
    /* JADX WARN: Removed duplicated region for block: B:136:0x0496  */
    /* JADX WARN: Removed duplicated region for block: B:139:0x04a4  */
    /* JADX WARN: Removed duplicated region for block: B:145:0x04db  */
    /* JADX WARN: Removed duplicated region for block: B:92:0x02a1  */
    /* JADX WARN: Removed duplicated region for block: B:99:0x02ee  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void drawBotButtons(Canvas canvas, ArrayList arrayList, int i) {
        int i2;
        String str;
        Drawable themedDrawable;
        ChatMessageCellDelegate chatMessageCellDelegate;
        ArrayList arrayList2 = arrayList;
        if (SizeNotifierFrameLayout.drawingBlur) {
            return;
        }
        int widthForButtons = getWidthForButtons();
        MessageObject messageObject = this.currentMessageObject;
        float f = 1.0f;
        int iDp = (messageObject == null || !messageObject.isOutOwner()) ? this.backgroundDrawableLeft + AndroidUtilities.dp((this.mediaBackground || this.drawPinnedBottom) ? 1.0f : 7.0f) : (getMeasuredWidth() - widthForButtons) - AndroidUtilities.dp(10.0f);
        float f2 = 2.0f;
        float fDp = (this.layoutHeight - AndroidUtilities.dp(2.0f)) + this.transitionParams.deltaBottom;
        float f3 = BitmapDescriptorFactory.HUE_RED;
        for (int i3 = 0; i3 < arrayList.size(); i3++) {
            BotButton botButton = (BotButton) arrayList2.get(i3);
            float f4 = botButton.y + botButton.height;
            if (f4 > f3) {
                f3 = f4;
            }
        }
        this.rect.set(BitmapDescriptorFactory.HUE_RED, fDp, getMeasuredWidth(), f3 + fDp);
        if (i != 255) {
            canvas.saveLayerAlpha(this.rect, i, 31);
        } else {
            canvas.save();
        }
        int i4 = 0;
        while (i4 < arrayList.size()) {
            BotButton botButton2 = (BotButton) arrayList2.get(i4);
            float fDp2 = ((botButton2.y + this.layoutHeight) - AndroidUtilities.dp(f2)) + this.transitionParams.deltaBottom;
            float pressScale = botButton2.getPressScale();
            if (botButton2.isSeparator) {
                float f5 = widthForButtons;
                float f6 = iDp;
                float f7 = (botButton2.x * f5) + f6;
                float f8 = (((botButton2.x * f5) + f6) + (botButton2.width * f5)) - f7;
                float fDp3 = AndroidUtilities.dp(3.66f);
                float f9 = f8 - fDp3;
                int iRound = Math.round(f9 / AndroidUtilities.dp(8.66f));
                float f10 = f9 / iRound;
                applyServiceShaderMatrix();
                float fDp4 = AndroidUtilities.dp(f);
                int i5 = 0;
                while (i5 < iRound + 1) {
                    float f11 = (i5 * f10) + f7;
                    float f12 = fDp3;
                    this.rect.set(f11, fDp2, f11 + fDp3, botButton2.height + fDp2);
                    canvas.drawRoundRect(this.rect, fDp4, fDp4, getThemedPaint("paintChatActionBackground"));
                    if (hasGradientService()) {
                        canvas.drawRoundRect(this.rect, fDp4, fDp4, Theme.chat_actionBackgroundGradientDarkenPaint);
                    }
                    i5++;
                    fDp3 = f12;
                }
                i2 = widthForButtons;
            } else {
                float f13 = widthForButtons;
                float f14 = iDp;
                this.rect.set((botButton2.x * f13) + f14, fDp2, (botButton2.x * f13) + f14 + (botButton2.width * f13), botButton2.height + fDp2);
                canvas.save();
                if (pressScale != 1.0f) {
                    canvas.scale(pressScale, pressScale, this.rect.centerX(), this.rect.centerY());
                }
                applyServiceShaderMatrix();
                Arrays.fill(this.botButtonRadii, AndroidUtilities.dp(Math.min(6.75f, SharedConfig.bubbleRadius)));
                if (botButton2.hasPositionFlag(9)) {
                    float[] fArr = this.botButtonRadii;
                    float fDp5 = AndroidUtilities.dp(SharedConfig.bubbleRadius);
                    fArr[7] = fDp5;
                    fArr[6] = fDp5;
                }
                if (botButton2.hasPositionFlag(10)) {
                    float[] fArr2 = this.botButtonRadii;
                    float fDp6 = AndroidUtilities.dp(SharedConfig.bubbleRadius);
                    fArr2[5] = fDp6;
                    fArr2[4] = fDp6;
                }
                this.botButtonPath.rewind();
                this.botButtonPath.addRoundRect(this.rect, this.botButtonRadii, Path.Direction.CW);
                canvas.drawPath(this.botButtonPath, getThemedPaint("paintChatActionBackground"));
                if (hasGradientService()) {
                    canvas.drawPath(this.botButtonPath, Theme.chat_actionBackgroundGradientDarkenPaint);
                }
                boolean zIsSendingSuggestedMessageApproval = (((botButton2.button instanceof TLRPC.TL_keyboardButtonCallback) || (botButton2.button instanceof TLRPC.TL_keyboardButtonGame) || (botButton2.button instanceof TLRPC.TL_keyboardButtonBuy) || (botButton2.button instanceof TLRPC.TL_keyboardButtonUrlAuth)) && SendMessagesHelper.getInstance(this.currentAccount).isSendingCallback(this.currentMessageObject, botButton2.button)) || ((botButton2.button instanceof TLRPC.TL_keyboardButtonRequestGeoLocation) && SendMessagesHelper.getInstance(this.currentAccount).isSendingCurrentLocation(this.currentMessageObject, botButton2.button)) || ((botButton2.button instanceof TLRPC.TL_keyboardButtonUrl) && (chatMessageCellDelegate = this.delegate) != null && chatMessageCellDelegate.isProgressLoading(this, 3) && this.delegate.getProgressLoadingBotButtonUrl(this) == botButton2.button.url);
                if (botButton2.buttonCustom == null || this.currentMessageObject == null) {
                    canvas.save();
                    canvas.clipPath(this.botButtonPath);
                    LoadingDrawable loadingDrawable = botButton2.loadingDrawable;
                    if (zIsSendingSuggestedMessageApproval) {
                        if (loadingDrawable == null) {
                            botButton2.loadingDrawable = new LoadingDrawable();
                            botButton2.loadingDrawable.setRadiiDp(5.5f);
                            botButton2.loadingDrawable.setAppearByGradient(true);
                            botButton2.loadingDrawable.strokePaint.setStrokeWidth(AndroidUtilities.dpf2(1.25f));
                        } else if (botButton2.loadingDrawable.isDisappeared() || botButton2.loadingDrawable.isDisappearing()) {
                            botButton2.loadingDrawable.reset();
                            botButton2.loadingDrawable.resetDisappear();
                        }
                    } else if (loadingDrawable != null && !botButton2.loadingDrawable.isDisappearing() && !botButton2.loadingDrawable.isDisappeared()) {
                        botButton2.loadingDrawable.disappear();
                    }
                    if (botButton2.loadingDrawable != null && (zIsSendingSuggestedMessageApproval || botButton2.loadingDrawable.isDisappearing())) {
                        this.rect.inset(AndroidUtilities.dpf2(0.625f), AndroidUtilities.dpf2(0.625f));
                        botButton2.loadingDrawable.setRadii(this.botButtonRadii);
                        botButton2.loadingDrawable.setBounds(this.rect);
                        LoadingDrawable loadingDrawable2 = botButton2.loadingDrawable;
                        int i6 = Theme.key_chat_serviceBackgroundSelector;
                        loadingDrawable2.setColors(Theme.multAlpha(Theme.getColor(i6, this.resourcesProvider), 1.0f), Theme.multAlpha(Theme.getColor(i6, this.resourcesProvider), 2.5f), Theme.multAlpha(Theme.getColor(i6, this.resourcesProvider), 3.0f), Theme.multAlpha(Theme.getColor(i6, this.resourcesProvider), 10.0f));
                        botButton2.loadingDrawable.setAlpha(255);
                        botButton2.loadingDrawable.draw(canvas);
                        invalidateOutbounds();
                    }
                    if (botButton2.selectorDrawable == null) {
                        int i7 = (int) fDp2;
                        botButton2.selectorDrawable.setBounds(((int) (botButton2.x * f13)) + iDp, i7, ((int) (botButton2.x * f13)) + iDp + ((int) (botButton2.width * f13)), botButton2.height + i7);
                        botButton2.selectorDrawable.setAlpha(255);
                        botButton2.selectorDrawable.draw(canvas);
                    }
                    canvas.restore();
                    canvas.save();
                    float fDp7 = botButton2.iconDrawable == null ? AndroidUtilities.dp(26.0f) : 0;
                    float width = (botButton2.x * f13) + f14 + ((((botButton2.width * f13) - (botButton2.title.getWidth() + (botButton2.iconDrawable == null ? AndroidUtilities.dp(4.0f) : 0))) - fDp7) / 2.0f);
                    if (botButton2.iconDrawable == null) {
                        int i8 = (int) width;
                        i2 = widthForButtons;
                        botButton2.iconDrawable.setBounds(i8, (int) (((botButton2.height - AndroidUtilities.dp(24.0f)) / 2.0f) + fDp2), i8 + AndroidUtilities.dp(24.0f), ((int) (((botButton2.height - AndroidUtilities.dp(24.0f)) / 2.0f) + fDp2)) + AndroidUtilities.dp(24.0f));
                        botButton2.iconDrawable.setAlpha(botButton2.isLocked ? 128 : 255);
                        botButton2.iconDrawable.draw(canvas);
                        width += fDp7;
                    } else {
                        i2 = widthForButtons;
                    }
                    botButton2.title.ellipsize(Math.max(1, (((int) (botButton2.width * f13)) - AndroidUtilities.dp(15.0f)) - r2));
                    botButton2.title.draw(canvas, width, (AndroidUtilities.dp(44.0f) / 2.0f) + fDp2, !botButton2.isLocked ? 0.5f : 1.0f);
                    canvas.restore();
                    if (botButton2.buttonCustom == null) {
                        if (botButton2.isLocked) {
                            str = "drawableBotLock";
                            themedDrawable = getThemedDrawable(str);
                            BaseCell.setDrawableBounds(themedDrawable, (((((int) (botButton2.x * f13)) + ((int) (botButton2.width * f13))) - AndroidUtilities.dp(3.0f)) - themedDrawable.getIntrinsicWidth()) + iDp, fDp2 + AndroidUtilities.dp(3.0f));
                        }
                        canvas.restore();
                    } else {
                        if (!(botButton2.button instanceof TLRPC.TL_keyboardButtonWebView)) {
                            if (botButton2.button instanceof TLRPC.TL_keyboardButtonUrl) {
                                if (!AndroidUtilities.isWebAppLink(botButton2.button.url)) {
                                    str = botButton2.isInviteButton ? "drawable_botInvite" : "drawableBotLink";
                                }
                            } else if ((botButton2.button instanceof TLRPC.TL_keyboardButtonSwitchInline) || (botButton2.button instanceof TLRPC.TL_keyboardButtonRequestPeer)) {
                                str = "drawableBotInline";
                            } else {
                                if ((botButton2.button instanceof TLRPC.TL_keyboardButtonBuy) && this.hasInvoicePreview && this.hasInvoicePrice) {
                                    BaseCell.setDrawableBounds(Theme.chat_botCardDrawable, (((((int) (botButton2.x * f13)) + ((int) (botButton2.width * f13))) - AndroidUtilities.dp(5.0f)) - Theme.chat_botCardDrawable.getIntrinsicWidth()) + iDp, fDp2 + AndroidUtilities.dp(4.0f));
                                    themedDrawable = Theme.chat_botCardDrawable;
                                }
                                canvas.restore();
                            }
                            themedDrawable = getThemedDrawable(str);
                            BaseCell.setDrawableBounds(themedDrawable, (((((int) (botButton2.x * f13)) + ((int) (botButton2.width * f13))) - AndroidUtilities.dp(3.0f)) - themedDrawable.getIntrinsicWidth()) + iDp, fDp2 + AndroidUtilities.dp(3.0f));
                        }
                        themedDrawable = getThemedDrawable("drawableBotWebView");
                        BaseCell.setDrawableBounds(themedDrawable, (((((int) (botButton2.x * f13)) + ((int) (botButton2.width * f13))) - AndroidUtilities.dp(3.0f)) - themedDrawable.getIntrinsicWidth()) + iDp, fDp2 + AndroidUtilities.dp(3.0f));
                    }
                    themedDrawable.draw(canvas);
                    canvas.restore();
                } else {
                    if (botButton2.buttonCustom.id == 2) {
                        zIsSendingSuggestedMessageApproval |= MessagesController.getInstance(this.currentAccount).isSendingSuggestedMessageApproval(this.currentMessageObject.getDialogId(), this.currentMessageObject.getId(), true);
                    } else {
                        if (botButton2.buttonCustom.id == 1) {
                            zIsSendingSuggestedMessageApproval |= MessagesController.getInstance(this.currentAccount).isSendingSuggestedMessageApproval(this.currentMessageObject.getDialogId(), this.currentMessageObject.getId(), false);
                        }
                        canvas.save();
                        canvas.clipPath(this.botButtonPath);
                        LoadingDrawable loadingDrawable3 = botButton2.loadingDrawable;
                        if (zIsSendingSuggestedMessageApproval) {
                        }
                        if (botButton2.loadingDrawable != null) {
                            if (botButton2.selectorDrawable == null) {
                            }
                            canvas.restore();
                            canvas.save();
                            if (botButton2.iconDrawable == null) {
                            }
                            float fDp72 = botButton2.iconDrawable == null ? AndroidUtilities.dp(26.0f) : 0;
                            float width2 = (botButton2.x * f13) + f14 + ((((botButton2.width * f13) - (botButton2.title.getWidth() + (botButton2.iconDrawable == null ? AndroidUtilities.dp(4.0f) : 0))) - fDp72) / 2.0f);
                            if (botButton2.iconDrawable == null) {
                            }
                            botButton2.title.ellipsize(Math.max(1, (((int) (botButton2.width * f13)) - AndroidUtilities.dp(15.0f)) - r2));
                            botButton2.title.draw(canvas, width2, (AndroidUtilities.dp(44.0f) / 2.0f) + fDp2, !botButton2.isLocked ? 0.5f : 1.0f);
                            canvas.restore();
                            if (botButton2.buttonCustom == null) {
                            }
                            themedDrawable.draw(canvas);
                            canvas.restore();
                        }
                    }
                    canvas.save();
                    canvas.clipPath(this.botButtonPath);
                    LoadingDrawable loadingDrawable32 = botButton2.loadingDrawable;
                    if (zIsSendingSuggestedMessageApproval) {
                    }
                    if (botButton2.loadingDrawable != null) {
                    }
                }
            }
            i4++;
            arrayList2 = arrayList;
            widthForButtons = i2;
            f = 1.0f;
            f2 = 2.0f;
        }
        canvas.restore();
    }

    private void drawCaptionLayout(Canvas canvas, MessageObject.TextLayoutBlocks textLayoutBlocks, boolean z, boolean z2, float f) {
        float f2;
        int iSaveLayerAlpha;
        Rect rect;
        int i;
        int i2;
        int i3;
        ArrayList<MessageObject.TextLayoutBlock> arrayList;
        boolean z3;
        boolean z4;
        boolean z5;
        ChatMessageCell chatMessageCell;
        float f3;
        float f4;
        Canvas canvas2;
        float f5;
        boolean z6;
        float f6;
        float fDp;
        float imageHeight;
        int iDp;
        int i4;
        Path path;
        float f7 = 12.0f;
        if (!this.mediaBackground && !this.drawPinnedBottom) {
            f7 = 18.0f;
        }
        AndroidUtilities.dp(f7);
        getExtraTextX();
        getExtraTextX();
        if (this.currentMessagesGroup != null && !this.currentMessageObject.isMusic() && !this.currentMessageObject.isDocument()) {
            int groupPhotosWidth = getGroupPhotosWidth();
            if ((this.currentPosition.flags & 1) == 0) {
                Math.ceil((r4.pw / 1000.0f) * groupPhotosWidth);
            } else {
                for (int i5 = 0; i5 < this.currentMessagesGroup.posArray.size(); i5++) {
                    if (this.currentMessagesGroup.posArray.get(i5).minY != 0) {
                        break;
                    }
                    Math.ceil(((r5.pw + r5.leftSpanOffset) / 1000.0f) * groupPhotosWidth);
                }
                AndroidUtilities.dp(9.0f);
            }
        } else if (!this.mediaBackground) {
            AndroidUtilities.dp(9.0f);
        }
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if (groupedMessagePosition != null && (groupedMessagePosition.flags & 1) == 0 && !this.currentMessagesGroup.hasSibling) {
            AndroidUtilities.dp(14.0f);
        }
        drawCommentLayout(canvas, f);
        if (textLayoutBlocks != null) {
            if (z2 && this.links.isEmpty()) {
                return;
            }
            if ((!this.currentMessageObject.deleted || this.drawingToBitmap || this.currentPosition == null) && f != BitmapDescriptorFactory.HUE_RED) {
                setupTextColors();
                canvas.save();
                MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
                float f8 = groupedMessages != null ? groupedMessages.transitionParams.captionEnterProgress * f : f;
                if (f8 == BitmapDescriptorFactory.HUE_RED) {
                    return;
                }
                float videoTranscriptionProgress = this.captionY;
                float f9 = this.captionX;
                TransitionParams transitionParams = this.transitionParams;
                if (transitionParams.animateBackgroundBoundsInner) {
                    if (transitionParams.transformGroupToSingleMessage) {
                        videoTranscriptionProgress -= getTranslationY();
                    } else if (transitionParams.moveCaption) {
                        float f10 = this.captionX;
                        TransitionParams transitionParams2 = this.transitionParams;
                        float f11 = transitionParams2.animateChangeProgress;
                        float f12 = 1.0f - f11;
                        f2 = (f10 * f11) + (transitionParams2.captionFromX * f12);
                        videoTranscriptionProgress = (transitionParams2.captionFromY * f12) + (this.captionY * f11);
                    } else {
                        if ((!this.currentMessageObject.isVoice() && !this.currentMessageObject.isRoundVideo()) || !TextUtils.isEmpty(this.currentMessageObject.caption)) {
                        }
                        f2 = f9;
                    }
                    f9 += this.transitionParams.deltaLeft;
                    f2 = f9;
                } else {
                    f2 = f9;
                }
                if (this.isRoundVideo && this.transitionParams.animateDrawBackground) {
                    videoTranscriptionProgress += (1.0f - getVideoTranscriptionProgress()) * AndroidUtilities.roundMessageSize;
                }
                if (f8 != 1.0f) {
                    this.rect.set(f2, videoTranscriptionProgress, textLayoutBlocks.textWidth + f2, textLayoutBlocks.textHeight(this.transitionParams) + videoTranscriptionProgress);
                    iSaveLayerAlpha = canvas.saveLayerAlpha(this.rect, (int) (f8 * 255.0f), 31);
                } else {
                    iSaveLayerAlpha = Integer.MIN_VALUE;
                }
                if (this.isRoundVideo && this.transitionParams.animateDrawBackground) {
                    Theme.MessageDrawable.PathDrawParams pathDrawParams = this.backgroundCacheParams;
                    if (pathDrawParams != null && (path = pathDrawParams.getPath()) != null && !path.isEmpty()) {
                        canvas.translate(BitmapDescriptorFactory.HUE_RED, this.transitionYOffsetForDrawables);
                        canvas.clipPath(path);
                        canvas.translate(BitmapDescriptorFactory.HUE_RED, -this.transitionYOffsetForDrawables);
                    }
                } else {
                    TransitionParams transitionParams3 = this.transitionParams;
                    if ((transitionParams3.animateBackgroundBoundsInner && this.currentBackgroundDrawable != null && this.currentMessagesGroup == null) || (transitionParams3.animateMediaAbove && this.currentMessagesGroup == null)) {
                        int iHeight = (!this.drawCommentButton || (rect = this.commentButtonRect) == null) ? 0 : rect.height();
                        ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                        int i6 = iHeight + ((reactionsLayoutInBubble == null || reactionsLayoutInBubble.isSmall) ? 0 : reactionsLayoutInBubble.height);
                        if (!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.pinnedBottom) {
                            canvas.clipRect(getBackgroundDrawableLeft() + this.transitionParams.deltaLeft + AndroidUtilities.dp(4.0f), getBackgroundDrawableTop() + this.transitionParams.deltaTop + AndroidUtilities.dp(4.0f), (getBackgroundDrawableRight() + this.transitionParams.deltaRight) - AndroidUtilities.dp(4.0f), ((getBackgroundDrawableBottom() + this.transitionParams.deltaBottom) - AndroidUtilities.dp(4.0f)) - i6);
                        } else {
                            canvas.clipRect(getBackgroundDrawableLeft() + this.transitionParams.deltaLeft + AndroidUtilities.dp(4.0f), getBackgroundDrawableTop() + this.transitionParams.deltaTop + AndroidUtilities.dp(4.0f), (getBackgroundDrawableRight() + this.transitionParams.deltaRight) - AndroidUtilities.dp(10.0f), ((getBackgroundDrawableBottom() + this.transitionParams.deltaBottom) - AndroidUtilities.dp(4.0f)) - i6);
                        }
                    }
                }
                canvas.save();
                canvas.translate(f2, videoTranscriptionProgress);
                if (this.highlightPath != null) {
                    float fCurrentTimeMillis = (System.currentTimeMillis() - this.highlightPathStart) / 850.0f;
                    if (fCurrentTimeMillis > 1.0f) {
                        this.highlightPath = null;
                    } else {
                        int alpha = Theme.chat_textSearchSelectionPaint.getAlpha();
                        float f13 = fCurrentTimeMillis * 4.0f;
                        Theme.chat_textSearchSelectionPaint.setAlpha((int) (alpha * 0.8f * (1.0f - fCurrentTimeMillis) * f13));
                        canvas.save();
                        float interpolation = (AndroidUtilities.overshootInterpolator.getInterpolation(Math.min(1.0f, f13)) * 0.6f) + 0.4f;
                        LinkPath linkPath = this.highlightPath;
                        canvas.scale(interpolation, interpolation, linkPath.centerX, linkPath.centerY);
                        canvas.drawPath(this.highlightPath, Theme.chat_textSearchSelectionPaint);
                        canvas.restore();
                        Theme.chat_textSearchSelectionPaint.setAlpha(alpha);
                    }
                    invalidate();
                }
                canvas.restore();
                if (this.currentMessageObject.type == 5) {
                    Theme.chat_timePaint.setColor(ColorUtils.blendARGB(getThemedColor(Theme.key_chat_serviceText), getThemedColor(isDrawSelectionBackground() ? this.currentMessageObject.isOutOwner() ? Theme.key_chat_outTimeSelectedText : Theme.key_chat_inTimeSelectedText : this.currentMessageObject.isOutOwner() ? Theme.key_chat_outTimeText : Theme.key_chat_inTimeText), getVideoTranscriptionProgress()));
                }
                if (z2) {
                    i = Integer.MIN_VALUE;
                    i2 = iSaveLayerAlpha;
                } else {
                    TransitionParams transitionParams4 = this.transitionParams;
                    if (!transitionParams4.animateMediaAbove || transitionParams4.animateChangeProgress == 1.0f) {
                        i3 = iSaveLayerAlpha;
                        i = Integer.MIN_VALUE;
                        arrayList = textLayoutBlocks.textLayoutBlocks;
                        z3 = false;
                        z4 = true;
                        z5 = true;
                        chatMessageCell = this;
                        f3 = f2;
                        f4 = videoTranscriptionProgress;
                        canvas2 = canvas;
                        f5 = textLayoutBlocks.textXOffset;
                        z6 = z;
                        f6 = f;
                    } else {
                        int i7 = this.currentMessageObject.type;
                        if (i7 == 1 || i7 == 20 || this.documentAttachType == 4 || i7 == 8 || i7 == 23) {
                            float imageY = this.photoImage.getImageY();
                            fDp = (imageY + (-textLayoutBlocks.textHeight(this.transitionParams))) - AndroidUtilities.dp(4.0f);
                            imageHeight = this.photoImage.getImageHeight() + imageY + AndroidUtilities.dp(6.0f);
                        } else {
                            float f14 = 43.0f;
                            if (this.hasOldCaptionPreview) {
                                int iDp2 = ((this.totalHeight - AndroidUtilities.dp(this.drawPinnedTop ? 9.0f : 10.0f)) - this.linkPreviewHeight) - AndroidUtilities.dp(17.0f);
                                if (!this.drawCommentButton || this.drawSideButton == 3) {
                                    f14 = BitmapDescriptorFactory.HUE_RED;
                                } else if (shouldDrawTimeOnMedia()) {
                                    f14 = 41.3f;
                                }
                                iDp = iDp2 - AndroidUtilities.dp(f14);
                                i4 = this.captionHeight;
                            } else {
                                int iDp3 = (this.totalHeight - this.captionHeight) - AndroidUtilities.dp(this.drawPinnedTop ? 9.0f : 10.0f);
                                if (!this.drawCommentButton || this.drawSideButton == 3) {
                                    f14 = BitmapDescriptorFactory.HUE_RED;
                                } else if (shouldDrawTimeOnMedia()) {
                                    f14 = 41.3f;
                                }
                                iDp = iDp3 - AndroidUtilities.dp(f14);
                                ReactionsLayoutInBubble reactionsLayoutInBubble2 = this.reactionsLayoutInBubble;
                                i4 = (reactionsLayoutInBubble2.isEmpty || reactionsLayoutInBubble2.isSmall) ? 0 : reactionsLayoutInBubble2.totalHeight;
                            }
                            imageHeight = iDp - i4;
                            fDp = AndroidUtilities.dp(9.0f);
                        }
                        i3 = iSaveLayerAlpha;
                        i = Integer.MIN_VALUE;
                        drawMessageText(f2, this.captionAbove ? imageHeight : fDp, canvas, textLayoutBlocks.textLayoutBlocks, textLayoutBlocks.textXOffset, z, f * (1.0f - this.transitionParams.animateChangeProgress), true, false, true);
                        f4 = this.captionAbove ? fDp : imageHeight;
                        arrayList = textLayoutBlocks.textLayoutBlocks;
                        f5 = textLayoutBlocks.textXOffset;
                        f6 = f * this.transitionParams.animateChangeProgress;
                        z3 = false;
                        z4 = true;
                        z5 = true;
                        chatMessageCell = this;
                        f3 = f2;
                        canvas2 = canvas;
                        z6 = z;
                    }
                    chatMessageCell.drawMessageText(f3, f4, canvas2, arrayList, f5, z6, f6, z5, z3, z4);
                    i2 = i3;
                }
                if (i2 != i) {
                    canvas.restoreToCount(i2);
                }
                canvas.restore();
            }
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:37:0x0091  */
    /* JADX WARN: Removed duplicated region for block: B:40:0x00a8  */
    /* JADX WARN: Removed duplicated region for block: B:66:0x0148  */
    /* JADX WARN: Removed duplicated region for block: B:72:? A[RETURN, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:75:? A[RETURN, SYNTHETIC] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void drawClockOrErrorLayout(Canvas canvas, boolean z, boolean z2, float f, float f2, float f3, float f4, float f5, boolean z3) {
        float fDp;
        float currentTotalHeight;
        float fDp2;
        float fDp3;
        boolean z4 = f5 != 1.0f;
        float f6 = (f5 * 0.5f) + 0.5f;
        float f7 = f2 * f5;
        if (z) {
            if (this.currentMessageObject.isOutOwner()) {
                return;
            }
            MsgClockDrawable msgClockDrawable = Theme.chat_msgClockDrawable;
            msgClockDrawable.setColor(getThemedColor((!shouldDrawTimeOnMedia() && z3) ? Theme.key_chat_outSentClockSelected : Theme.key_chat_mediaSentClock));
            if (shouldDrawTimeOnMedia()) {
                fDp2 = getPhotoBottom() + this.additionalTimeOffsetY;
                fDp3 = AndroidUtilities.dp(9.0f);
            } else {
                fDp2 = (f - AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 9.5f : 8.5f)) + f3;
                if (this.isRoundVideo) {
                    fDp3 = (AndroidUtilities.dp(this.drawPinnedBottom ? 4.0f : 5.0f) + this.reactionsLayoutInBubble.getCurrentTotalHeight(this.transitionParams.animateChangeProgress)) * (1.0f - getVideoTranscriptionProgress());
                }
                BaseCell.setDrawableBounds(msgClockDrawable, f4 + (this.currentMessageObject.scheduled ? 0 : AndroidUtilities.dp(11.0f)), fDp2 - msgClockDrawable.getIntrinsicHeight());
                msgClockDrawable.setAlpha((int) (f7 * 255.0f));
                if (z4) {
                    canvas.save();
                    canvas.scale(f6, f6, msgClockDrawable.getBounds().centerX(), msgClockDrawable.getBounds().centerY());
                }
                msgClockDrawable.draw(canvas);
                msgClockDrawable.setAlpha(255);
                invalidate();
                if (!z4) {
                    return;
                }
            }
            fDp2 -= fDp3;
            BaseCell.setDrawableBounds(msgClockDrawable, f4 + (this.currentMessageObject.scheduled ? 0 : AndroidUtilities.dp(11.0f)), fDp2 - msgClockDrawable.getIntrinsicHeight());
            msgClockDrawable.setAlpha((int) (f7 * 255.0f));
            if (z4) {
            }
            msgClockDrawable.draw(canvas);
            msgClockDrawable.setAlpha(255);
            invalidate();
            if (!z4) {
            }
        } else {
            if (!z2 || this.currentMessageObject.isOutOwner()) {
                return;
            }
            float fDp4 = f4 + (this.currentMessageObject.scheduled ? 0 : AndroidUtilities.dp(11.0f));
            float f8 = 21.5f;
            if (shouldDrawTimeOnMedia()) {
                fDp = getPhotoBottom() + this.additionalTimeOffsetY;
                currentTotalHeight = AndroidUtilities.dp(21.5f);
            } else {
                if (!this.pinnedBottom && !this.pinnedTop) {
                    f8 = 20.5f;
                }
                fDp = (f - AndroidUtilities.dp(f8)) + f3;
                if (this.isRoundVideo) {
                    currentTotalHeight = this.reactionsLayoutInBubble.getCurrentTotalHeight(this.transitionParams.animateChangeProgress) * (1.0f - getVideoTranscriptionProgress());
                }
                this.rect.set(fDp4, fDp, AndroidUtilities.dp(14.0f) + fDp4, AndroidUtilities.dp(14.0f) + fDp);
                int alpha = Theme.chat_msgErrorPaint.getAlpha();
                int i = (int) (f7 * 255.0f);
                Theme.chat_msgErrorPaint.setAlpha(i);
                if (z4) {
                    canvas.save();
                    canvas.scale(f6, f6, this.rect.centerX(), this.rect.centerY());
                }
                canvas.drawRoundRect(this.rect, AndroidUtilities.dp(1.0f), AndroidUtilities.dp(1.0f), Theme.chat_msgErrorPaint);
                Theme.chat_msgErrorPaint.setAlpha(alpha);
                Drawable themedDrawable = getThemedDrawable("drawableMsgError");
                BaseCell.setDrawableBounds(themedDrawable, fDp4 + AndroidUtilities.dp(6.0f), fDp + AndroidUtilities.dp(2.0f));
                themedDrawable.setAlpha(i);
                themedDrawable.draw(canvas);
                themedDrawable.setAlpha(255);
                if (!z4) {
                    return;
                }
            }
            fDp -= currentTotalHeight;
            this.rect.set(fDp4, fDp, AndroidUtilities.dp(14.0f) + fDp4, AndroidUtilities.dp(14.0f) + fDp);
            int alpha2 = Theme.chat_msgErrorPaint.getAlpha();
            int i2 = (int) (f7 * 255.0f);
            Theme.chat_msgErrorPaint.setAlpha(i2);
            if (z4) {
            }
            canvas.drawRoundRect(this.rect, AndroidUtilities.dp(1.0f), AndroidUtilities.dp(1.0f), Theme.chat_msgErrorPaint);
            Theme.chat_msgErrorPaint.setAlpha(alpha2);
            Drawable themedDrawable2 = getThemedDrawable("drawableMsgError");
            BaseCell.setDrawableBounds(themedDrawable2, fDp4 + AndroidUtilities.dp(6.0f), fDp + AndroidUtilities.dp(2.0f));
            themedDrawable2.setAlpha(i2);
            themedDrawable2.draw(canvas);
            themedDrawable2.setAlpha(255);
            if (!z4) {
            }
        }
        canvas.restore();
    }

    private void drawContact(Canvas canvas) {
        TextPaint textPaint;
        int i;
        boolean z;
        float scale;
        Drawable drawable;
        if (this.contactLine == null) {
            this.contactLine = new ReplyMessageLine(this);
        }
        int iCheck = this.contactLine.check(this.currentMessageObject, this.currentUser, this.currentChat, this.resourcesProvider, 4);
        if (this.contactBounce == null) {
            this.contactBounce = new ButtonBounce(this, 2.0f, 2.0f);
        }
        int imageX = (int) (this.photoImage.getImageX() - AndroidUtilities.dp(13.0f));
        int iDp = this.layoutHeight - AndroidUtilities.dp(62.0f);
        ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
        if (!reactionsLayoutInBubble.isEmpty && !reactionsLayoutInBubble.isSmall) {
            iDp -= reactionsLayoutInBubble.totalHeight;
        }
        if (this.drawCommentButton) {
            iDp -= AndroidUtilities.dp(shouldDrawTimeOnMedia() ? 39.3f : 41.0f);
        }
        int i2 = iDp;
        if (this.contactRect == null) {
            this.contactRect = new RectF();
        }
        float backgroundDrawableRight = (getBackgroundDrawableRight() - (AndroidUtilities.dp(10.0f) + ((!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 0 : AndroidUtilities.dp(6.0f)))) - getExtraTextX();
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateBackgroundBoundsInner) {
            backgroundDrawableRight += transitionParams.deltaRight;
        }
        this.contactRect.set(imageX, this.photoImage.getImageY() - AndroidUtilities.dp(9.0f), backgroundDrawableRight, AndroidUtilities.dp(38.0f) + i2);
        float scale2 = this.contactBounce.getScale(0.0125f);
        boolean z2 = scale2 != 1.0f;
        if (z2) {
            canvas.save();
            canvas.scale(scale2, scale2, this.contactRect.centerX(), this.contactRect.centerY());
        }
        if (Build.VERSION.SDK_INT >= 21 && (drawable = this.selectorDrawable[0]) != null) {
            this.selectorDrawableMaskType[0] = 0;
            drawable.setBounds(imageX, (int) (this.photoImage.getImageY() - AndroidUtilities.dp(9.0f)), (int) backgroundDrawableRight, AndroidUtilities.dp(38.0f) + i2);
            if (this.selectorDrawableColor != Theme.multAlpha(this.contactLine.getColor(), 0.1f)) {
                Drawable drawable2 = this.selectorDrawable[0];
                int iMultAlpha = Theme.multAlpha(this.contactLine.getColor(), 0.1f);
                this.selectorDrawableColor = iMultAlpha;
                Theme.setSelectorDrawableColor(drawable2, iMultAlpha, true);
            }
            this.selectorDrawable[0].draw(canvas);
        }
        float fFloor = (float) Math.floor(SharedConfig.bubbleRadius / 3.0f);
        int i3 = (int) fFloor;
        this.contactLine.drawBackground(canvas, this.contactRect, fFloor, fFloor, fFloor, 1.0f);
        this.contactLine.drawLine(canvas, this.contactRect, 1.0f);
        Theme.chat_contactNamePaint.setColor(iCheck);
        Theme.chat_contactPhonePaint.setColor(getThemedColor(Theme.key_chat_inContactPhoneSelectedText));
        if (this.currentMessageObject.isOutOwner()) {
            textPaint = Theme.chat_contactPhonePaint;
            i = Theme.key_chat_messageTextOut;
        } else {
            textPaint = Theme.chat_contactPhonePaint;
            i = Theme.key_chat_messageTextIn;
        }
        textPaint.setColor(getThemedColor(i));
        if (this.titleLayout != null) {
            canvas.save();
            canvas.translate(this.photoImage.getImageX() + this.photoImage.getImageWidth() + AndroidUtilities.dp(9.0f), AndroidUtilities.dp(27.0f) + this.namesOffset);
            SpoilerEffect.layoutDrawMaybe(this.titleLayout, canvas);
            canvas.restore();
        }
        if (this.docTitleLayout != null) {
            canvas.save();
            canvas.translate(this.photoImage.getImageX() + this.photoImage.getImageWidth() + AndroidUtilities.dp(9.0f), AndroidUtilities.dp(50.0f) + this.namesOffset);
            SpoilerEffect.layoutDrawMaybe(this.docTitleLayout, canvas);
            canvas.restore();
        }
        ArrayList arrayList = this.contactButtons;
        if (arrayList != null && arrayList.size() > 0) {
            Theme.chat_instantViewPaint.setColor(iCheck);
            Theme.chat_instantViewButtonPaint.setColor(Theme.multAlpha(iCheck, 0.1f));
            int alpha = Theme.chat_instantViewPaint.getAlpha();
            Theme.chat_instantViewPaint.setAlpha((int) (alpha * 0.18f));
            canvas.drawRect(AndroidUtilities.dp(10.0f) + this.contactRect.left, AndroidUtilities.dp(2.0f) + i2, this.contactRect.right - AndroidUtilities.dp(7.0f), AndroidUtilities.dp(2.0f) + i2 + Math.max(1, AndroidUtilities.dp(0.66f)), Theme.chat_instantViewPaint);
            Theme.chat_instantViewPaint.setAlpha(alpha);
            int iDp2 = i2 + AndroidUtilities.dp(2.0f);
            float fDp = imageX + AndroidUtilities.dp(3.0f);
            ArrayList arrayList2 = this.contactButtons;
            boolean z3 = arrayList2 != null && arrayList2.size() > 1;
            int backgroundColor = this.contactLine.getBackgroundColor();
            int i4 = 0;
            while (i4 < this.contactButtons.size()) {
                InstantViewButton instantViewButton = (InstantViewButton) this.contactButtons.get(i4);
                float fMin = Math.min(instantViewButton.buttonWidth + fDp, this.contactRect.right);
                instantViewButton.rect.set(fDp, iDp2, fMin, AndroidUtilities.dp(36.0f) + iDp2);
                if (z3 && instantViewButton.selectorDrawable == null) {
                    this.linkPreviewSelectorColor = backgroundColor;
                    instantViewButton.selectorDrawable = Theme.createRadSelectorDrawable(backgroundColor, 0, 0, i4 == this.contactButtons.size() - 1 ? i3 : 0, 0);
                    instantViewButton.selectorDrawable.setCallback(this);
                }
                if (instantViewButton.selectorDrawable != null) {
                    instantViewButton.selectorDrawable.setBounds((int) fDp, iDp2, (int) fMin, AndroidUtilities.dp(36.0f) + iDp2);
                    instantViewButton.selectorDrawable.draw(canvas);
                }
                if (z2 || instantViewButton.buttonBounce == null) {
                    z = false;
                    scale = 1.0f;
                } else {
                    scale = instantViewButton.buttonBounce.getScale(0.02f);
                    z = scale != 1.0f;
                }
                if (z) {
                    canvas.save();
                    canvas.scale(scale, scale, instantViewButton.rect.centerX(), instantViewButton.rect.centerY());
                }
                if (instantViewButton.layout != null) {
                    canvas.save();
                    canvas.translate(instantViewButton.textX + fDp, AndroidUtilities.dp(10.5f) + iDp2);
                    instantViewButton.layout.draw(canvas);
                    canvas.restore();
                }
                if (z) {
                    canvas.restore();
                }
                fDp += instantViewButton.buttonWidth;
                i4++;
            }
        }
        if (z2) {
            canvas.restore();
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:133:0x02e3 A[PHI: r15
      0x02e3: PHI (r15v18 android.graphics.drawable.Drawable) = (r15v3 android.graphics.drawable.Drawable), (r15v37 android.graphics.drawable.Drawable) binds: [B:132:0x02e1, B:96:0x0225] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:170:0x03b0 A[PHI: r7
      0x03b0: PHI (r7v20 android.graphics.drawable.Drawable) = 
      (r7v19 android.graphics.drawable.Drawable)
      (r7v19 android.graphics.drawable.Drawable)
      (r7v25 android.graphics.drawable.Drawable)
      (r7v25 android.graphics.drawable.Drawable)
     binds: [B:168:0x03ac, B:169:0x03ae, B:150:0x0348, B:151:0x034a] A[DONT_GENERATE, DONT_INLINE]] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void drawStatusDrawable(Canvas canvas, boolean z, boolean z2, boolean z3, boolean z4, float f, boolean z5, float f2, float f3, float f4, boolean z6, boolean z7) {
        float photoBottom;
        int iDp;
        int iDp2;
        Drawable themedDrawable;
        Drawable themedDrawable2;
        Drawable themedDrawable3;
        Drawable drawable;
        int i;
        int iDp3;
        int i2;
        int iDp4;
        int themedColor;
        float f5;
        MessageObject messageObject;
        boolean z8 = (f4 == 1.0f || z6) ? false : true;
        float f6 = (f4 * 0.5f) + 0.5f;
        float f7 = z8 ? f * f4 : f;
        if (this.documentAttachType != 7 || ((messageObject = this.currentMessageObject) != null && messageObject.isRoundOnce())) {
            photoBottom = getPhotoBottom() + this.additionalTimeOffsetY;
        } else {
            photoBottom = f3 - ((AndroidUtilities.dp(this.drawPinnedBottom ? 4.0f : 5.0f) + this.reactionsLayoutInBubble.getCurrentTotalHeight(this.transitionParams.animateChangeProgress)) * (1.0f - getVideoTranscriptionProgress()));
        }
        float fDp = photoBottom - AndroidUtilities.dp(8.5f);
        MessageObject messageObject2 = this.currentMessageObject;
        float fDp2 = (messageObject2 == null || !messageObject2.isAnyKindOfSticker()) ? BitmapDescriptorFactory.HUE_RED : AndroidUtilities.dp(-6.0f);
        if (z3) {
            MsgClockDrawable msgClockDrawable = Theme.chat_msgClockDrawable;
            if (shouldDrawTimeOnMedia()) {
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    themedColor = getThemedColor(Theme.key_chat_serviceText);
                    BaseCell.setDrawableBounds(msgClockDrawable, ((this.layoutWidth - AndroidUtilities.dp(z5 ? 24.0f : 22.0f)) - msgClockDrawable.getIntrinsicWidth()) + fDp2, (fDp - msgClockDrawable.getIntrinsicHeight()) + f2);
                    f5 = this.timeAlpha * 255.0f * f7;
                } else {
                    themedColor = getThemedColor(Theme.key_chat_mediaSentClock);
                    BaseCell.setDrawableBounds(msgClockDrawable, ((this.layoutWidth - AndroidUtilities.dp(z5 ? 24.0f : 22.0f)) - msgClockDrawable.getIntrinsicWidth()) + fDp2, (fDp - msgClockDrawable.getIntrinsicHeight()) + f2);
                    f5 = f7 * 255.0f;
                }
                msgClockDrawable.setAlpha((int) f5);
            } else {
                int themedColor2 = getThemedColor(Theme.key_chat_outSentClock);
                BaseCell.setDrawableBounds(msgClockDrawable, (this.layoutWidth - AndroidUtilities.dp(18.5f)) - msgClockDrawable.getIntrinsicWidth(), ((f3 - AndroidUtilities.dp(8.5f)) - msgClockDrawable.getIntrinsicHeight()) + f2);
                msgClockDrawable.setAlpha((int) (f7 * 255.0f));
                themedColor = themedColor2;
            }
            msgClockDrawable.setColor(themedColor);
            if (z8) {
                canvas.save();
                canvas.scale(f6, f6, msgClockDrawable.getBounds().centerX(), msgClockDrawable.getBounds().centerY());
            }
            msgClockDrawable.draw(canvas);
            msgClockDrawable.setAlpha(255);
            if (z8) {
                canvas.restore();
            }
            invalidate();
        }
        if (z2) {
            if (shouldDrawTimeOnMedia()) {
                if (z6) {
                    canvas.save();
                }
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    themedDrawable3 = getThemedDrawable("drawableMsgStickerCheck");
                    if (z) {
                        if (z6) {
                            canvas.translate(AndroidUtilities.dp(4.8f) * (1.0f - f4), BitmapDescriptorFactory.HUE_RED);
                        }
                        i2 = this.layoutWidth;
                        iDp4 = AndroidUtilities.dp(z5 ? 28.3f : 26.3f);
                    } else {
                        i2 = this.layoutWidth;
                        iDp4 = AndroidUtilities.dp(z5 ? 23.5f : 21.5f);
                    }
                    BaseCell.setDrawableBounds(themedDrawable3, ((i2 - iDp4) - themedDrawable3.getIntrinsicWidth()) + fDp2, (fDp - themedDrawable3.getIntrinsicHeight()) + f2);
                    themedDrawable3.setAlpha((int) (this.timeAlpha * 255.0f * f7));
                } else {
                    if (z) {
                        if (z6) {
                            canvas.translate(AndroidUtilities.dp(4.8f) * (1.0f - f4), BitmapDescriptorFactory.HUE_RED);
                        }
                        drawable = Theme.chat_msgMediaCheckDrawable;
                        i = this.layoutWidth;
                        iDp3 = AndroidUtilities.dp(z5 ? 28.3f : 26.3f);
                    } else {
                        drawable = Theme.chat_msgMediaCheckDrawable;
                        i = this.layoutWidth;
                        iDp3 = AndroidUtilities.dp(z5 ? 23.5f : 21.5f);
                    }
                    BaseCell.setDrawableBounds(drawable, (i - iDp3) - Theme.chat_msgMediaCheckDrawable.getIntrinsicWidth(), (fDp - Theme.chat_msgMediaCheckDrawable.getIntrinsicHeight()) + f2);
                    Theme.chat_msgMediaCheckDrawable.setAlpha((int) (this.timeAlpha * 255.0f * f7));
                    themedDrawable3 = Theme.chat_msgMediaCheckDrawable;
                }
                if (z8) {
                    canvas.save();
                    canvas.scale(f6, f6, themedDrawable3.getBounds().centerX(), themedDrawable3.getBounds().centerY());
                }
                themedDrawable3.draw(canvas);
                if (z8) {
                    canvas.restore();
                }
                if (z6) {
                    canvas.restore();
                }
                themedDrawable3.setAlpha(255);
            } else {
                if (z6) {
                    canvas.save();
                }
                if (z) {
                    if (z6) {
                        canvas.translate(AndroidUtilities.dp(4.0f) * (1.0f - f4), BitmapDescriptorFactory.HUE_RED);
                    }
                    themedDrawable2 = getThemedDrawable(z7 ? "drawableMsgOutCheckReadSelected" : "drawableMsgOutCheckRead");
                    BaseCell.setDrawableBounds(themedDrawable2, ((this.layoutWidth - AndroidUtilities.dp(22.5f)) - themedDrawable2.getIntrinsicWidth()) + fDp2, ((f3 - AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 9.0f : 8.0f)) - themedDrawable2.getIntrinsicHeight()) + f2);
                } else {
                    themedDrawable2 = getThemedDrawable(z7 ? "drawableMsgOutCheckSelected" : "drawableMsgOutCheck");
                    BaseCell.setDrawableBounds(themedDrawable2, ((this.layoutWidth - AndroidUtilities.dp(18.5f)) - themedDrawable2.getIntrinsicWidth()) + fDp2, ((f3 - AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 9.0f : 8.0f)) - themedDrawable2.getIntrinsicHeight()) + f2);
                }
                themedDrawable3 = themedDrawable2;
                themedDrawable3.setAlpha((int) (f7 * 255.0f));
                if (z8) {
                    canvas.save();
                    canvas.scale(f6, f6, themedDrawable3.getBounds().centerX(), themedDrawable3.getBounds().centerY());
                }
                themedDrawable3.draw(canvas);
                if (z8) {
                    canvas.restore();
                }
                if (z6) {
                }
                themedDrawable3.setAlpha(255);
            }
        }
        if (z) {
            if (shouldDrawTimeOnMedia()) {
                themedDrawable = this.currentMessageObject.shouldDrawWithoutBackground() ? getThemedDrawable("drawableMsgStickerHalfCheck") : Theme.chat_msgMediaHalfCheckDrawable;
                BaseCell.setDrawableBounds(themedDrawable, ((this.layoutWidth - AndroidUtilities.dp(z5 ? 23.5f : 21.5f)) - themedDrawable.getIntrinsicWidth()) + fDp2, (fDp - themedDrawable.getIntrinsicHeight()) + f2);
                themedDrawable.setAlpha((int) (this.timeAlpha * 255.0f * f7));
                if (z8 || z6) {
                    canvas.save();
                    canvas.scale(f6, f6, themedDrawable.getBounds().centerX(), themedDrawable.getBounds().centerY());
                }
                themedDrawable.draw(canvas);
                if (z8 || z6) {
                    canvas.restore();
                }
                themedDrawable.setAlpha(255);
            } else {
                themedDrawable = getThemedDrawable(z7 ? "drawableMsgOutHalfCheckSelected" : "drawableMsgOutHalfCheck");
                BaseCell.setDrawableBounds(themedDrawable, (this.layoutWidth - AndroidUtilities.dp(18.0f)) - themedDrawable.getIntrinsicWidth(), ((f3 - AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 9.0f : 8.0f)) - themedDrawable.getIntrinsicHeight()) + f2);
                themedDrawable.setAlpha((int) (f7 * 255.0f));
                if (z8 || z6) {
                    canvas.save();
                    canvas.scale(f6, f6, themedDrawable.getBounds().centerX(), themedDrawable.getBounds().centerY());
                }
                themedDrawable.draw(canvas);
                if (z8 || z6) {
                }
                themedDrawable.setAlpha(255);
            }
        }
        if (z4) {
            if (shouldDrawTimeOnMedia()) {
                iDp = this.layoutWidth - AndroidUtilities.dp(34.5f);
                iDp2 = AndroidUtilities.dp(26.5f);
            } else {
                iDp = this.layoutWidth - AndroidUtilities.dp(32.0f);
                iDp2 = AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 22.0f : 21.0f);
            }
            float f8 = (f3 - iDp2) + f2;
            this.rect.set((int) (iDp + fDp2), f8, AndroidUtilities.dp(14.0f) + r6, AndroidUtilities.dp(14.0f) + f8);
            int alpha = Theme.chat_msgErrorPaint.getAlpha();
            Theme.chat_msgErrorPaint.setAlpha((int) (alpha * f7));
            canvas.drawRoundRect(this.rect, AndroidUtilities.dp(1.0f), AndroidUtilities.dp(1.0f), Theme.chat_msgErrorPaint);
            Theme.chat_msgErrorPaint.setAlpha(alpha);
            BaseCell.setDrawableBounds(Theme.chat_msgErrorDrawable, r6 + AndroidUtilities.dp(6.0f), f8 + AndroidUtilities.dp(2.0f));
            Theme.chat_msgErrorDrawable.setAlpha((int) (f7 * 255.0f));
            if (z8) {
                canvas.save();
                canvas.scale(f6, f6, Theme.chat_msgErrorDrawable.getBounds().centerX(), Theme.chat_msgErrorDrawable.getBounds().centerY());
            }
            Theme.chat_msgErrorDrawable.draw(canvas);
            Theme.chat_msgErrorDrawable.setAlpha(255);
            if (z8) {
                canvas.restore();
            }
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:212:0x0407  */
    /* JADX WARN: Removed duplicated region for block: B:218:0x042d  */
    /* JADX WARN: Removed duplicated region for block: B:403:0x087b  */
    /* JADX WARN: Removed duplicated region for block: B:471:0x0997  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void drawTimeInternal(Canvas canvas, float f, boolean z, float f2, StaticLayout staticLayout, float f3, boolean z2) {
        int i;
        TextPaint textPaint;
        int i2;
        int themedColor;
        float f4;
        String str;
        char c;
        char c2;
        char c3;
        int iDp;
        float f5;
        int i3;
        boolean z3;
        float f6;
        char c4;
        float fDp;
        boolean z4;
        float f7;
        float f8;
        boolean z5;
        ChatMessageCell chatMessageCell;
        Canvas canvas2;
        boolean z6;
        boolean z7;
        boolean z8;
        boolean z9;
        float f9;
        boolean z10;
        float f10;
        boolean z11;
        float fIsNotEmpty;
        int iDp2;
        boolean z12;
        String str2;
        float photoBottom;
        int i4;
        int i5;
        String str3;
        int i6;
        float f11;
        MessageObject messageObject;
        boolean z13 = z;
        if (((!this.drawTime || this.groupPhotoInvisible) && shouldDrawTimeOnMedia()) || staticLayout == null) {
            return;
        }
        MessageObject messageObject2 = this.currentMessageObject;
        if ((!messageObject2.deleted || this.currentPosition == null) && (i = messageObject2.type) != 16) {
            if (i == 5) {
                textPaint = Theme.chat_timePaint;
                themedColor = ColorUtils.blendARGB(getThemedColor(Theme.key_chat_serviceText), getThemedColor(isDrawSelectionBackground() ? this.currentMessageObject.isOutOwner() ? Theme.key_chat_outTimeSelectedText : Theme.key_chat_inTimeSelectedText : this.currentMessageObject.isOutOwner() ? Theme.key_chat_outTimeText : Theme.key_chat_inTimeText), getVideoTranscriptionProgress());
            } else {
                if (shouldDrawTimeOnMedia()) {
                    if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                        textPaint = Theme.chat_timePaint;
                        i2 = Theme.key_chat_serviceText;
                    } else {
                        textPaint = Theme.chat_timePaint;
                        i2 = Theme.key_chat_mediaTimeText;
                    }
                } else if (this.currentMessageObject.isOutOwner()) {
                    textPaint = Theme.chat_timePaint;
                    i2 = z2 ? Theme.key_chat_outTimeSelectedText : Theme.key_chat_outTimeText;
                } else {
                    textPaint = Theme.chat_timePaint;
                    i2 = z2 ? Theme.key_chat_inTimeSelectedText : Theme.key_chat_inTimeText;
                }
                themedColor = getThemedColor(i2);
            }
            textPaint.setColor(themedColor);
            float f12 = getTransitionParams().animateDrawingTimeAlpha ? getTransitionParams().animateChangeProgress * f : f;
            if (f12 != 1.0f) {
                Theme.chat_timePaint.setAlpha((int) (r0.getAlpha() * f12));
            }
            canvas.save();
            if (this.drawPinnedBottom && !shouldDrawTimeOnMedia()) {
                canvas.translate(BitmapDescriptorFactory.HUE_RED, AndroidUtilities.dp(2.0f));
            }
            float translationY = this.layoutHeight;
            TransitionParams transitionParams = this.transitionParams;
            if (transitionParams.animateBackgroundBoundsInner) {
                translationY += transitionParams.deltaBottom;
            }
            MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
            if (groupedMessages == null || !groupedMessages.transitionParams.backgroundChangeBounds) {
                f4 = f2;
            } else {
                translationY -= getTranslationY();
                f4 = f2 + this.currentMessagesGroup.transitionParams.offsetRight;
            }
            float fDp2 = translationY;
            float currentWidth = f4;
            if (this.drawPinnedBottom && shouldDrawTimeOnMedia()) {
                fDp2 += AndroidUtilities.dp(1.0f);
            }
            float f13 = fDp2;
            if (this.transitionParams.animateBackgroundBoundsInner) {
                float f14 = this.animationOffsetX;
                f4 += f14;
                currentWidth += f14;
            }
            float f15 = f4;
            if (this.currentMessageObject.shouldDrawReactions()) {
                ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                if (reactionsLayoutInBubble.isSmall) {
                    TransitionParams transitionParams2 = this.transitionParams;
                    currentWidth += (!transitionParams2.animateBackgroundBoundsInner || transitionParams2.deltaRight == BitmapDescriptorFactory.HUE_RED) ? reactionsLayoutInBubble.getCurrentWidth(transitionParams2.animateChangeProgress) : reactionsLayoutInBubble.getCurrentWidth(1.0f);
                }
            }
            if (this.transitionParams.animateEditedEnter) {
                currentWidth -= this.transitionParams.animateEditedWidthDiff * (1.0f - this.transitionParams.animateChangeProgress);
            }
            float f16 = currentWidth;
            boolean z14 = true;
            if (shouldDrawTimeOnMedia()) {
                int i7 = -(this.drawCommentButton ? AndroidUtilities.dp(41.3f) : 0);
                Paint themedPaint = this.currentMessageObject.shouldDrawWithoutBackground() ? getThemedPaint("paintChatActionBackground") : getThemedPaint("paintChatTimeBackground");
                int alpha = themedPaint.getAlpha();
                Theme.chat_timePaint.setAlpha((int) (this.timeAlpha * 255.0f * f12));
                MessageObject messageObject3 = this.currentMessageObject;
                if (messageObject3 == null || messageObject3.type != 4) {
                    fIsNotEmpty = f12;
                } else {
                    float currentAlpha = this.photoImage.isCrossfadingWithOldImage() ? 1.0f : this.photoImage.getCurrentAlpha();
                    if (!this.photoImage.hasNotThumb()) {
                        currentAlpha = BitmapDescriptorFactory.HUE_RED;
                    }
                    fIsNotEmpty = AndroidUtilities.lerp(0.35f, 1.0f, currentAlpha);
                }
                MessageObject messageObject4 = this.currentMessageObject;
                if (messageObject4 != null && messageObject4.sendPreview) {
                    AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable = this.effectDrawable;
                    fIsNotEmpty *= swapAnimatedEmojiDrawable == null ? BitmapDescriptorFactory.HUE_RED : swapAnimatedEmojiDrawable.isNotEmpty();
                }
                themedPaint.setAlpha((int) (alpha * this.timeAlpha * fIsNotEmpty * 0.6f));
                int i8 = this.documentAttachType;
                if (i8 == 7 || i8 == 6 || this.currentMessageObject.type == 19) {
                    int iDp3 = AndroidUtilities.dp(4.0f);
                    MessageObject messageObject5 = this.currentMessageObject;
                    iDp2 = iDp3 + ((messageObject5 == null || !messageObject5.isAnyKindOfSticker()) ? 0 : AndroidUtilities.dp(8.0f));
                    z12 = false;
                } else {
                    int[] roundRadius = this.photoImage.getRoundRadius();
                    iDp2 = Math.min(AndroidUtilities.dp(8.0f), Math.max(roundRadius[2], roundRadius[3]));
                    z12 = SharedConfig.bubbleRadius >= 10;
                }
                MessageObject messageObject6 = this.currentMessageObject;
                float fDp3 = f15 + ((messageObject6 == null || !messageObject6.isAnyKindOfSticker()) ? 0 : AndroidUtilities.dp(-6.0f));
                if (this.effectId != 0) {
                    fDp3 -= AndroidUtilities.dp(18.0f);
                }
                float fDp4 = fDp3 - AndroidUtilities.dp(z12 ? 6.0f : 4.0f);
                MessageObject messageObject7 = this.currentMessageObject;
                float fDp5 = (messageObject7 == null || !messageObject7.isAnyKindOfSticker()) ? BitmapDescriptorFactory.HUE_RED : AndroidUtilities.dp(2.0f);
                if (this.documentAttachType != 7 || ((messageObject = this.currentMessageObject) != null && messageObject.isRoundOnce())) {
                    str2 = "paintChatTimeBackground";
                    photoBottom = getPhotoBottom() + this.additionalTimeOffsetY;
                } else {
                    str2 = "paintChatTimeBackground";
                    photoBottom = f13 - ((AndroidUtilities.dp(this.drawPinnedBottom ? 4.0f : 5.0f) + this.reactionsLayoutInBubble.getCurrentTotalHeight(this.transitionParams.animateChangeProgress)) * (1.0f - getVideoTranscriptionProgress()));
                }
                float f17 = photoBottom;
                float fDp6 = f17 - AndroidUtilities.dp(23.0f);
                float fMax = Math.max(AndroidUtilities.dp(17.0f), Theme.chat_timePaint.getTextSize() + AndroidUtilities.dp(5.0f));
                RectF rectF = this.rect;
                float f18 = fDp4 - fDp5;
                float f19 = fDp5 + fDp4 + f3;
                if (z12) {
                    i4 = 12;
                    z3 = z12;
                } else {
                    z3 = z12;
                    i4 = 8;
                }
                if (this.currentMessageObject.isOutOwner()) {
                    i5 = (this.currentMessageObject.type == 19 ? 4 : 0) + 20;
                } else {
                    i5 = 0;
                }
                rectF.set(f18, fDp6, f19 + AndroidUtilities.dp(i4 + i5), fMax + fDp6);
                GroupMedia groupMedia = this.groupMedia;
                if (groupMedia != null) {
                    groupMedia.drawBlurRect(canvas, this.rect, iDp2, this.timeAlpha * 0.5f * fIsNotEmpty);
                } else {
                    if (!this.currentMessageObject.isQuickReply()) {
                        if (!this.currentMessageObject.hasMediaSpoilers() || this.currentMessageObject.type == 5) {
                            str3 = str2;
                            applyServiceShaderMatrix();
                            float f20 = iDp2;
                            canvas.drawRoundRect(this.rect, f20, f20, themedPaint);
                            if (themedPaint == getThemedPaint("paintChatActionBackground") && hasGradientService()) {
                                int alpha2 = Theme.chat_actionBackgroundGradientDarkenPaint.getAlpha();
                                Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha((int) (alpha2 * this.timeAlpha * fIsNotEmpty));
                                canvas.drawRoundRect(this.rect, f20, f20, Theme.chat_actionBackgroundGradientDarkenPaint);
                                Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha(alpha2);
                            }
                        } else {
                            this.rectPath.rewind();
                            float f21 = iDp2;
                            this.rectPath.addRoundRect(this.rect, f21, f21, Path.Direction.CW);
                            canvas.save();
                            canvas.clipPath(this.rectPath);
                            ImageReceiver imageReceiver = this.currentMessageObject.needDrawBluredPreview() ? this.photoImage : this.blurredPhotoImage;
                            float alpha3 = imageReceiver.getAlpha();
                            imageReceiver.setAlpha(0.5f * alpha3);
                            imageReceiver.draw(canvas);
                            imageReceiver.setAlpha(alpha3);
                            canvas.restore();
                            str3 = str2;
                            Paint themedPaint2 = getThemedPaint(str3);
                            int alpha4 = themedPaint2.getAlpha();
                            themedPaint2.setAlpha((int) (alpha4 * this.controlsAlpha * 0.4f));
                            canvas.drawRoundRect(this.rect, f21, f21, themedPaint2);
                            themedPaint2.setAlpha(alpha4);
                        }
                    }
                    themedPaint.setAlpha(alpha);
                    float f22 = -staticLayout.getLineLeft(0);
                    MessageObject messageObject8 = this.currentMessageObject;
                    float fDp7 = f22 + ((messageObject8 == null && messageObject8.isAnyKindOfSticker()) ? AndroidUtilities.dp(-6.0f) : 0);
                    if (!this.currentMessageObject.shouldDrawReactions() && this.reactionsLayoutInBubble.isSmall) {
                        updateReactionLayoutPosition();
                        this.reactionsLayoutInBubble.setScrimProgress(BitmapDescriptorFactory.HUE_RED, false);
                        this.reactionsLayoutInBubble.draw(canvas, this.transitionParams.animateChangeProgress, null);
                    }
                    if ((ChatObject.isChannel(this.currentChat) || this.currentChat.megagroup) && (this.currentMessageObject.messageOwner.flags & 1024) == 0 && this.repliesLayout == null && !this.isPinned) {
                        z13 = z;
                        str = str3;
                        i6 = i7;
                        c = 4;
                        c2 = 6;
                        c3 = 7;
                    } else {
                        float lineWidth = fDp7 + (this.timeWidth - staticLayout.getLineWidth(0));
                        ReactionsLayoutInBubble reactionsLayoutInBubble2 = this.reactionsLayoutInBubble;
                        if (reactionsLayoutInBubble2.isSmall && !reactionsLayoutInBubble2.isEmpty) {
                            lineWidth -= reactionsLayoutInBubble2.width;
                        }
                        float f23 = lineWidth;
                        int iCreateStatusDrawableParams = this.transitionParams.createStatusDrawableParams();
                        int i9 = this.transitionParams.lastStatusDrawableParams;
                        if (i9 < 0 || i9 == iCreateStatusDrawableParams || this.statusDrawableAnimationInProgress) {
                            z13 = z;
                        } else {
                            z13 = z;
                            createStatusDrawableAnimator(i9, iCreateStatusDrawableParams, z13);
                        }
                        boolean z15 = this.statusDrawableAnimationInProgress;
                        if (z15) {
                            iCreateStatusDrawableParams = this.animateToStatusDrawableParams;
                        }
                        boolean z16 = (iCreateStatusDrawableParams & 4) != 0;
                        boolean z17 = (iCreateStatusDrawableParams & 8) != 0;
                        if (z15) {
                            int i10 = this.animateFromStatusDrawableParams;
                            boolean z18 = (i10 & 4) != 0;
                            boolean z19 = (i10 & 8) != 0;
                            float f24 = i7;
                            c = 4;
                            f11 = f23;
                            float f25 = f12;
                            str = str3;
                            i6 = i7;
                            c3 = 7;
                            float f26 = fDp3;
                            c2 = 6;
                            drawClockOrErrorLayout(canvas, z18, z19, f13, f25, f24, f26, 1.0f - this.statusDrawableProgress, z2);
                            drawClockOrErrorLayout(canvas, z16, z17, f13, f25, f24, f26, this.statusDrawableProgress, z2);
                            if (!this.currentMessageObject.isOutOwner()) {
                                if (!z18 && !z19) {
                                    drawViewsAndRepliesLayout(canvas, f13, f12, f24, fDp3, 1.0f - this.statusDrawableProgress, z2);
                                }
                                if (!z16 && !z17) {
                                    drawViewsAndRepliesLayout(canvas, f13, f12, f24, fDp3, this.statusDrawableProgress, z2);
                                }
                            }
                        } else {
                            str = str3;
                            f11 = f23;
                            i6 = i7;
                            c = 4;
                            c2 = 6;
                            c3 = 7;
                            if (!this.currentMessageObject.isOutOwner() && !z16 && !z17) {
                                drawViewsAndRepliesLayout(canvas, f13, f12, i6, fDp3, 1.0f, z2);
                            }
                            drawClockOrErrorLayout(canvas, z16, z17, f13, f12, i6, fDp3, 1.0f, z2);
                        }
                        if (this.currentMessageObject.isOutOwner()) {
                            drawViewsAndRepliesLayout(canvas, f13, f12, i6, fDp3, 1.0f, z2);
                        }
                        TransitionParams transitionParams3 = this.transitionParams;
                        transitionParams3.lastStatusDrawableParams = transitionParams3.createStatusDrawableParams();
                        if (z16 && z13 && getParent() != null) {
                            ((View) getParent()).invalidate();
                        }
                        fDp7 = f11;
                    }
                    canvas.save();
                    float f27 = f16 + fDp7;
                    this.drawTimeX = f27;
                    float fDp8 = (f17 - AndroidUtilities.dp(7.3f)) - staticLayout.getHeight();
                    this.drawTimeY = fDp8;
                    canvas.translate(f27, fDp8);
                    SpoilerEffect.layoutDrawMaybe(staticLayout, canvas);
                    canvas.restore();
                    Theme.chat_timePaint.setAlpha(255);
                    i3 = i6;
                    f5 = BitmapDescriptorFactory.HUE_RED;
                }
                str3 = str2;
                themedPaint.setAlpha(alpha);
                float f222 = -staticLayout.getLineLeft(0);
                MessageObject messageObject82 = this.currentMessageObject;
                if (messageObject82 == null) {
                    float fDp72 = f222 + ((messageObject82 == null && messageObject82.isAnyKindOfSticker()) ? AndroidUtilities.dp(-6.0f) : 0);
                    if (!this.currentMessageObject.shouldDrawReactions()) {
                        if (ChatObject.isChannel(this.currentChat)) {
                            z13 = z;
                            str = str3;
                            i6 = i7;
                            c = 4;
                            c2 = 6;
                            c3 = 7;
                            canvas.save();
                            float f272 = f16 + fDp72;
                            this.drawTimeX = f272;
                            float fDp82 = (f17 - AndroidUtilities.dp(7.3f)) - staticLayout.getHeight();
                            this.drawTimeY = fDp82;
                            canvas.translate(f272, fDp82);
                            SpoilerEffect.layoutDrawMaybe(staticLayout, canvas);
                            canvas.restore();
                            Theme.chat_timePaint.setAlpha(255);
                            i3 = i6;
                            f5 = BitmapDescriptorFactory.HUE_RED;
                        } else {
                            z13 = z;
                            str = str3;
                            i6 = i7;
                            c = 4;
                            c2 = 6;
                            c3 = 7;
                            canvas.save();
                            float f2722 = f16 + fDp72;
                            this.drawTimeX = f2722;
                            float fDp822 = (f17 - AndroidUtilities.dp(7.3f)) - staticLayout.getHeight();
                            this.drawTimeY = fDp822;
                            canvas.translate(f2722, fDp822);
                            SpoilerEffect.layoutDrawMaybe(staticLayout, canvas);
                            canvas.restore();
                            Theme.chat_timePaint.setAlpha(255);
                            i3 = i6;
                            f5 = BitmapDescriptorFactory.HUE_RED;
                        }
                    }
                }
            } else {
                str = "paintChatTimeBackground";
                c = 4;
                c2 = 6;
                c3 = 7;
                if (this.currentMessageObject.isSponsored()) {
                    iDp = -AndroidUtilities.dp(48.0f);
                    if (this.hasNewLineForTime) {
                        iDp -= AndroidUtilities.dp(4.0f);
                    }
                } else {
                    iDp = -(this.drawCommentButton ? AndroidUtilities.dp(43.0f) : 0);
                }
                int i11 = iDp;
                float f28 = -staticLayout.getLineLeft(0);
                if (this.currentMessageObject.shouldDrawReactions() && this.reactionsLayoutInBubble.isSmall) {
                    updateReactionLayoutPosition();
                    this.reactionsLayoutInBubble.setScrimProgress(BitmapDescriptorFactory.HUE_RED, false);
                    this.reactionsLayoutInBubble.draw(canvas, this.transitionParams.animateChangeProgress, null);
                }
                if ((!ChatObject.isChannel(this.currentChat) || this.currentChat.megagroup) && (this.currentMessageObject.messageOwner.flags & 1024) == 0 && this.repliesLayout == null && !this.transitionParams.animateReplies && !this.isPinned && !this.transitionParams.animatePinned) {
                    f5 = BitmapDescriptorFactory.HUE_RED;
                } else {
                    float lineWidth2 = f28 + (f3 - staticLayout.getLineWidth(0));
                    ReactionsLayoutInBubble reactionsLayoutInBubble3 = this.reactionsLayoutInBubble;
                    if (reactionsLayoutInBubble3.isSmall && !reactionsLayoutInBubble3.isEmpty) {
                        lineWidth2 -= reactionsLayoutInBubble3.width;
                    }
                    float f29 = lineWidth2;
                    int iCreateStatusDrawableParams2 = this.transitionParams.createStatusDrawableParams();
                    int i12 = this.transitionParams.lastStatusDrawableParams;
                    if (i12 >= 0 && i12 != iCreateStatusDrawableParams2 && !this.statusDrawableAnimationInProgress) {
                        createStatusDrawableAnimator(i12, iCreateStatusDrawableParams2, z13);
                    }
                    boolean z20 = this.statusDrawableAnimationInProgress;
                    if (z20) {
                        iCreateStatusDrawableParams2 = this.animateToStatusDrawableParams;
                    }
                    boolean z21 = (iCreateStatusDrawableParams2 & 4) != 0;
                    boolean z22 = (iCreateStatusDrawableParams2 & 8) != 0;
                    if (z20) {
                        int i13 = this.animateFromStatusDrawableParams;
                        boolean z23 = (i13 & 4) != 0;
                        boolean z24 = (i13 & 8) != 0;
                        float f30 = i11;
                        float f31 = 1.0f - this.statusDrawableProgress;
                        float f32 = f12;
                        f5 = BitmapDescriptorFactory.HUE_RED;
                        drawClockOrErrorLayout(canvas, z23, z24, f13, f32, f30, f15, f31, z2);
                        drawClockOrErrorLayout(canvas, z21, z22, f13, f32, f30, f15, this.statusDrawableProgress, z2);
                        if (!this.currentMessageObject.isOutOwner()) {
                            if (!z23 && !z24) {
                                drawViewsAndRepliesLayout(canvas, f13, f12, f30, f15, 1.0f - this.statusDrawableProgress, z2);
                            }
                            if (!z21 && !z22) {
                                drawViewsAndRepliesLayout(canvas, f13, f12, f30, f15, this.statusDrawableProgress, z2);
                            }
                        }
                    } else {
                        f5 = BitmapDescriptorFactory.HUE_RED;
                        if (!this.currentMessageObject.isOutOwner() && !z21 && !z22) {
                            drawViewsAndRepliesLayout(canvas, f13, f12, i11, f15, 1.0f, z2);
                        }
                        drawClockOrErrorLayout(canvas, z21, z22, f13, f12, i11, f15, 1.0f, z2);
                    }
                    if (this.currentMessageObject.isOutOwner()) {
                        drawViewsAndRepliesLayout(canvas, f13, f12, i11, f15, 1.0f, z2);
                    }
                    TransitionParams transitionParams4 = this.transitionParams;
                    transitionParams4.lastStatusDrawableParams = transitionParams4.createStatusDrawableParams();
                    if (z21 && z13 && getParent() != null) {
                        ((View) getParent()).invalidate();
                    }
                    f28 = f29;
                }
                canvas.save();
                float f33 = 7.5f;
                if (this.transitionParams.animateEditedEnter) {
                    TransitionParams transitionParams5 = this.transitionParams;
                    if (transitionParams5.animateChangeProgress == 1.0f) {
                        float f34 = f16 + f28;
                        this.drawTimeX = f34;
                        if (!this.pinnedBottom && !this.pinnedTop) {
                            f33 = 6.5f;
                        }
                        float fDp9 = ((f13 - AndroidUtilities.dp(f33)) - staticLayout.getHeight()) + i11;
                        this.drawTimeY = fDp9;
                        canvas.translate(f34, fDp9);
                        SpoilerEffect.layoutDrawMaybe(staticLayout, canvas);
                    } else if (transitionParams5.animateEditedLayout != null) {
                        float f35 = f16 + f28;
                        if (!this.pinnedBottom && !this.pinnedTop) {
                            f33 = 6.5f;
                        }
                        canvas.translate(f35, ((f13 - AndroidUtilities.dp(f33)) - staticLayout.getHeight()) + i11);
                        int alpha5 = Theme.chat_timePaint.getAlpha();
                        Theme.chat_timePaint.setAlpha((int) (alpha5 * this.transitionParams.animateChangeProgress));
                        this.transitionParams.animateEditedLayout.draw(canvas);
                        Theme.chat_timePaint.setAlpha(alpha5);
                        SpoilerEffect.layoutDrawMaybe(this.transitionParams.animateTimeLayout, canvas);
                    } else {
                        int alpha6 = Theme.chat_timePaint.getAlpha();
                        canvas.save();
                        float f36 = i11;
                        canvas.translate(this.transitionParams.animateFromTimeX + f28, ((f13 - AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 7.5f : 6.5f)) - staticLayout.getHeight()) + f36);
                        float f37 = alpha6;
                        Theme.chat_timePaint.setAlpha((int) ((1.0f - this.transitionParams.animateChangeProgress) * f37));
                        SpoilerEffect.layoutDrawMaybe(this.transitionParams.animateTimeLayout, canvas);
                        canvas.restore();
                        float f38 = f16 + f28;
                        if (!this.pinnedBottom && !this.pinnedTop) {
                            f33 = 6.5f;
                        }
                        canvas.translate(f38, ((f13 - AndroidUtilities.dp(f33)) - staticLayout.getHeight()) + f36);
                        Theme.chat_timePaint.setAlpha((int) (f37 * this.transitionParams.animateChangeProgress));
                        SpoilerEffect.layoutDrawMaybe(staticLayout, canvas);
                        Theme.chat_timePaint.setAlpha(alpha6);
                    }
                    canvas.restore();
                    i3 = i11;
                    z3 = false;
                }
            }
            if (this.currentMessageObject.isOutOwner()) {
                int iCreateStatusDrawableParams3 = this.transitionParams.createStatusDrawableParams();
                int i14 = this.transitionParams.lastStatusDrawableParams;
                if (i14 >= 0 && i14 != iCreateStatusDrawableParams3 && !this.statusDrawableAnimationInProgress) {
                    createStatusDrawableAnimator(i14, iCreateStatusDrawableParams3, z13);
                }
                if (this.statusDrawableAnimationInProgress) {
                    iCreateStatusDrawableParams3 = this.animateToStatusDrawableParams;
                }
                boolean z25 = (iCreateStatusDrawableParams3 & 1) != 0;
                boolean z26 = (iCreateStatusDrawableParams3 & 2) != 0;
                boolean z27 = (iCreateStatusDrawableParams3 & 4) != 0;
                boolean z28 = (iCreateStatusDrawableParams3 & 8) != 0;
                if (this.transitionYOffsetForDrawables != f5) {
                    canvas.save();
                    canvas.translate(f5, this.transitionYOffsetForDrawables);
                    z4 = true;
                } else {
                    z4 = false;
                }
                if (this.statusDrawableAnimationInProgress) {
                    int i15 = this.animateFromStatusDrawableParams;
                    boolean z29 = (i15 & 1) != 0;
                    boolean z30 = (i15 & 2) != 0;
                    boolean z31 = (i15 & 4) != 0;
                    boolean z32 = (i15 & 8) != 0;
                    if (!z31 && z30 && z26 && !z29 && z25) {
                        f7 = i3;
                        f8 = this.statusDrawableProgress;
                        chatMessageCell = this;
                        canvas2 = canvas;
                        z6 = z25;
                        z7 = z26;
                        z8 = z27;
                        z9 = z28;
                        f9 = f12;
                        z10 = z3;
                        f10 = f13;
                        f6 = BitmapDescriptorFactory.HUE_RED;
                        z5 = true;
                        c4 = 5;
                    } else {
                        f6 = BitmapDescriptorFactory.HUE_RED;
                        c4 = 5;
                        float f39 = i3;
                        z5 = false;
                        chatMessageCell = this;
                        canvas2 = canvas;
                        boolean z33 = z29;
                        boolean z34 = z30;
                        boolean z35 = z31;
                        boolean z36 = z32;
                        f9 = f12;
                        z10 = z3;
                        f10 = f13;
                        z11 = z2;
                        chatMessageCell.drawStatusDrawable(canvas2, z33, z34, z35, z36, f9, z10, f39, f10, 1.0f - this.statusDrawableProgress, false, z11);
                        f8 = this.statusDrawableProgress;
                        z6 = z25;
                        z7 = z26;
                        z8 = z27;
                        z9 = z28;
                        f7 = f39;
                        chatMessageCell.drawStatusDrawable(canvas2, z6, z7, z8, z9, f9, z10, f7, f10, f8, z5, z11);
                        if (z4) {
                            canvas.restore();
                        }
                        TransitionParams transitionParams6 = this.transitionParams;
                        transitionParams6.lastStatusDrawableParams = transitionParams6.createStatusDrawableParams();
                        if (z13 && z27 && getParent() != null) {
                            ((View) getParent()).invalidate();
                        }
                    }
                } else {
                    f6 = BitmapDescriptorFactory.HUE_RED;
                    c4 = 5;
                    f7 = i3;
                    f8 = 1.0f;
                    z5 = false;
                    chatMessageCell = this;
                    canvas2 = canvas;
                    z6 = z25;
                    z7 = z26;
                    z8 = z27;
                    z9 = z28;
                    f9 = f12;
                    z10 = z3;
                    f10 = f13;
                }
                z11 = z2;
                chatMessageCell.drawStatusDrawable(canvas2, z6, z7, z8, z9, f9, z10, f7, f10, f8, z5, z11);
                if (z4) {
                }
                TransitionParams transitionParams62 = this.transitionParams;
                transitionParams62.lastStatusDrawableParams = transitionParams62.createStatusDrawableParams();
                if (z13) {
                    ((View) getParent()).invalidate();
                }
            } else {
                f6 = BitmapDescriptorFactory.HUE_RED;
                c4 = 5;
            }
            canvas.restore();
            if (this.unlockLayout != null) {
                if (this.unlockX == f6 || this.unlockY == f6) {
                    calculateUnlockXY();
                }
                this.unlockSpoilerPath.rewind();
                RectF rectF2 = AndroidUtilities.rectTmp;
                rectF2.set(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX2(), this.photoImage.getImageY2());
                int[] roundRadius2 = this.photoImage.getRoundRadius();
                float[] fArr = this.unlockSpoilerRadii;
                float f40 = roundRadius2[0];
                fArr[1] = f40;
                fArr[0] = f40;
                float f41 = roundRadius2[1];
                fArr[3] = f41;
                fArr[2] = f41;
                float f42 = roundRadius2[2];
                fArr[c4] = f42;
                fArr[c] = f42;
                float f43 = roundRadius2[3];
                fArr[c3] = f43;
                fArr[c2] = f43;
                Path path = this.unlockSpoilerPath;
                Path.Direction direction = Path.Direction.CW;
                path.addRoundRect(rectF2, fArr, direction);
                canvas.save();
                canvas.clipPath(this.unlockSpoilerPath);
                this.unlockSpoilerPath.rewind();
                rectF2.set(this.unlockX - AndroidUtilities.dp(12.0f), this.unlockY - AndroidUtilities.dp(8.0f), this.unlockX + Theme.chat_msgUnlockDrawable.getIntrinsicWidth() + AndroidUtilities.dp(14.0f) + this.unlockLayout.getWidth() + AndroidUtilities.dp(12.0f), this.unlockY + this.unlockLayout.getHeight() + AndroidUtilities.dp(8.0f));
                this.unlockSpoilerPath.addRoundRect(rectF2, AndroidUtilities.dp(32.0f), AndroidUtilities.dp(32.0f), direction);
                canvas.clipPath(this.unlockSpoilerPath, Region.Op.DIFFERENCE);
                if (this.mediaSpoilerEffect2 == null) {
                    if (this.unlockSpoilerEffect == null) {
                        this.unlockSpoilerEffect = new SpoilerEffect();
                    }
                    this.unlockSpoilerEffect.setColor(ColorUtils.setAlphaComponent(-1, (int) (Color.alpha(-1) * 0.325f)));
                    this.unlockSpoilerEffect.setBounds((int) this.photoImage.getImageX(), (int) this.photoImage.getImageY(), (int) this.photoImage.getImageX2(), (int) this.photoImage.getImageY2());
                    this.unlockSpoilerEffect.draw(canvas);
                }
                invalidate();
                canvas.restore();
                canvas.saveLayerAlpha(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, getWidth(), getHeight(), (int) (this.unlockAlpha * 255.0f), 31);
                int alpha7 = Theme.chat_timeBackgroundPaint.getAlpha();
                Theme.chat_timeBackgroundPaint.setAlpha((int) (alpha7 * 0.7f));
                canvas.drawRoundRect(rectF2, AndroidUtilities.dp(32.0f), AndroidUtilities.dp(32.0f), Theme.chat_timeBackgroundPaint);
                Theme.chat_timeBackgroundPaint.setAlpha(alpha7);
                canvas.translate(this.unlockX + AndroidUtilities.dp(4.0f), this.unlockY);
                Drawable drawable = Theme.chat_msgUnlockDrawable;
                drawable.setBounds(0, 0, drawable.getIntrinsicWidth(), Theme.chat_msgUnlockDrawable.getIntrinsicHeight());
                Theme.chat_msgUnlockDrawable.draw(canvas);
                canvas.translate(AndroidUtilities.dp(6.0f) + Theme.chat_msgUnlockDrawable.getIntrinsicWidth(), BitmapDescriptorFactory.HUE_RED);
                SpoilerEffect.layoutDrawMaybe(this.unlockLayout, canvas);
                canvas.restore();
                if (this.videoInfoLayout != null && this.photoImage.getVisible() && this.imageBackgroundSideColor == 0) {
                    int i16 = SharedConfig.bubbleRadius;
                    if (i16 > 2) {
                        fDp = AndroidUtilities.dp(i16 - 2);
                        if (SharedConfig.bubbleRadius < 10) {
                            z14 = false;
                        }
                    } else {
                        fDp = AndroidUtilities.dp(i16);
                        z14 = z3;
                    }
                    int imageX = (int) (this.photoImage.getImageX() + AndroidUtilities.dp(9.0f));
                    int imageY = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(6.0f));
                    this.rect.set(imageX - AndroidUtilities.dp(4.0f), imageY - AndroidUtilities.dp(1.5f), this.durationWidth + imageX + AndroidUtilities.dp(4.0f) + AndroidUtilities.dp(z14 ? 2.0f : BitmapDescriptorFactory.HUE_RED), this.videoInfoLayout.getHeight() + imageY + AndroidUtilities.dp(1.5f));
                    canvas.drawRoundRect(this.rect, fDp, fDp, getThemedPaint(str));
                    canvas.save();
                    canvas.translate(imageX + (z14 ? 2 : 0), imageY);
                    SpoilerEffect.layoutDrawMaybe(this.videoInfoLayout, canvas);
                    canvas.restore();
                }
            }
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:100:0x01c6  */
    /* JADX WARN: Removed duplicated region for block: B:102:0x01d5  */
    /* JADX WARN: Removed duplicated region for block: B:105:0x01e0  */
    /* JADX WARN: Removed duplicated region for block: B:144:0x0276  */
    /* JADX WARN: Removed duplicated region for block: B:145:0x0298  */
    /* JADX WARN: Removed duplicated region for block: B:148:0x02ae  */
    /* JADX WARN: Removed duplicated region for block: B:151:0x0305  */
    /* JADX WARN: Removed duplicated region for block: B:154:0x031d  */
    /* JADX WARN: Removed duplicated region for block: B:218:0x040e  */
    /* JADX WARN: Removed duplicated region for block: B:221:0x0428  */
    /* JADX WARN: Removed duplicated region for block: B:77:0x010c  */
    /* JADX WARN: Removed duplicated region for block: B:79:0x0113  */
    /* JADX WARN: Removed duplicated region for block: B:84:0x0125  */
    /* JADX WARN: Removed duplicated region for block: B:87:0x014f  */
    /* JADX WARN: Removed duplicated region for block: B:91:0x0196  */
    /* JADX WARN: Removed duplicated region for block: B:94:0x01ac A[PHI: r3
      0x01ac: PHI (r3v25 android.text.StaticLayout) = (r3v11 android.text.StaticLayout), (r3v15 android.text.StaticLayout) binds: [B:93:0x01aa, B:97:0x01b8] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:95:0x01b0  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void drawViewsAndRepliesLayout(Canvas canvas, float f, float f2, float f3, float f4, float f5, boolean z) {
        String str;
        Drawable themedDrawable;
        float f6;
        float f7;
        float f8;
        float f9;
        StaticLayout staticLayout;
        float f10;
        String str2;
        Drawable themedDrawable2;
        float f11;
        float f12;
        float textSize;
        String str3;
        Drawable themedDrawable3;
        boolean z2 = f5 != 1.0f;
        float f13 = (f5 * 0.5f) + 0.5f;
        float f14 = f2 * f5;
        ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
        float currentWidth = reactionsLayoutInBubble.isSmall ? reactionsLayoutInBubble.getCurrentWidth(1.0f) : BitmapDescriptorFactory.HUE_RED;
        int alpha = Theme.chat_timePaint.getAlpha();
        float timeY = getTimeY(f3);
        if (this.repliesLayout != null || this.transitionParams.animateReplies) {
            TransitionParams transitionParams = this.transitionParams;
            float f15 = (transitionParams.shouldAnimateTimeX ? this.timeX : f4) + currentWidth;
            boolean z3 = transitionParams.animateReplies && this.transitionParams.animateRepliesLayout == null && this.repliesLayout != null;
            boolean z4 = this.transitionParams.animateReplies && this.transitionParams.animateRepliesLayout != null && this.repliesLayout == null;
            boolean z5 = (!this.transitionParams.animateReplies || this.transitionParams.animateRepliesLayout == null || this.repliesLayout == null) ? false : true;
            if (!this.isRoundVideo || !this.transitionParams.animateDrawBackground) {
                TransitionParams transitionParams2 = this.transitionParams;
                if (transitionParams2.shouldAnimateTimeX && !z3) {
                    if (z4) {
                        f15 = transitionParams2.animateFromTimeXReplies;
                    } else {
                        float f16 = transitionParams2.animateFromTimeXReplies;
                        float f17 = this.transitionParams.animateChangeProgress;
                        f15 = (f15 * f17) + (f16 * (1.0f - f17));
                    }
                }
            }
            MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
            if (groupedMessages != null) {
                MessageObject.GroupedMessages.TransitionParams transitionParams3 = groupedMessages.transitionParams;
                if (transitionParams3.backgroundChangeBounds) {
                    f15 += transitionParams3.offsetRight;
                }
            }
            if (this.transitionParams.animateBackgroundBoundsInner) {
                f15 += this.animationOffsetX;
            }
            if (shouldDrawTimeOnMedia()) {
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    str = "drawableMsgStickerReplies";
                    themedDrawable = getThemedDrawable(str);
                    float drawableBounds = BaseCell.setDrawableBounds(themedDrawable, f15, timeY, Theme.chat_timePaint.getTextSize());
                    if (!z3) {
                        f7 = this.transitionParams.animateChangeProgress;
                    } else if (z4) {
                        f7 = 1.0f - this.transitionParams.animateChangeProgress;
                    } else {
                        f6 = f14;
                        themedDrawable.setAlpha((int) (f6 * 255.0f));
                        if (z2) {
                            canvas.save();
                            canvas.scale(f13, f13, (((AndroidUtilities.dp(3.0f) + drawableBounds) + this.repliesTextWidth) / 2.0f) + f15, themedDrawable.getBounds().centerY());
                        }
                        themedDrawable.draw(canvas);
                        themedDrawable.setAlpha(255);
                        if (this.transitionParams.animateReplies) {
                            if (z5) {
                                canvas.save();
                                TextPaint textPaint = Theme.chat_timePaint;
                                double d = alpha;
                                f8 = f14;
                                f9 = f13;
                                double d2 = this.transitionParams.animateChangeProgress;
                                Double.isNaN(d2);
                                Double.isNaN(d);
                                textPaint.setAlpha((int) (d * (1.0d - d2)));
                                canvas.translate(f15 + drawableBounds + AndroidUtilities.dp(3.0f), timeY);
                                this.transitionParams.animateRepliesLayout.draw(canvas);
                                canvas.restore();
                            } else {
                                f8 = f14;
                                f9 = f13;
                            }
                            Theme.chat_timePaint.setAlpha((int) (alpha * f6));
                        } else {
                            f8 = f14;
                            f9 = f13;
                        }
                        canvas.save();
                        canvas.translate(f15 + drawableBounds + AndroidUtilities.dp(3.0f), timeY);
                        staticLayout = this.repliesLayout;
                        if (staticLayout == null) {
                            if (this.transitionParams.animateRepliesLayout != null) {
                                staticLayout = this.transitionParams.animateRepliesLayout;
                                staticLayout.draw(canvas);
                            }
                            canvas.restore();
                            if (this.repliesLayout != null) {
                                currentWidth += drawableBounds + this.repliesTextWidth + AndroidUtilities.dp(10.0f);
                            }
                            if (z2) {
                                canvas.restore();
                            }
                            if (this.transitionParams.animateReplies) {
                                Theme.chat_timePaint.setAlpha(alpha);
                            }
                            this.transitionParams.lastTimeXReplies = f15;
                        } else {
                            staticLayout.draw(canvas);
                            canvas.restore();
                            if (this.repliesLayout != null) {
                            }
                            if (z2) {
                            }
                            if (this.transitionParams.animateReplies) {
                            }
                            this.transitionParams.lastTimeXReplies = f15;
                        }
                    }
                    f6 = f7 * f14;
                    themedDrawable.setAlpha((int) (f6 * 255.0f));
                    if (z2) {
                    }
                    themedDrawable.draw(canvas);
                    themedDrawable.setAlpha(255);
                    if (this.transitionParams.animateReplies) {
                    }
                    canvas.save();
                    canvas.translate(f15 + drawableBounds + AndroidUtilities.dp(3.0f), timeY);
                    staticLayout = this.repliesLayout;
                    if (staticLayout == null) {
                    }
                } else {
                    themedDrawable = Theme.chat_msgMediaRepliesDrawable;
                    float drawableBounds2 = BaseCell.setDrawableBounds(themedDrawable, f15, timeY, Theme.chat_timePaint.getTextSize());
                    if (!z3) {
                    }
                    f6 = f7 * f14;
                    themedDrawable.setAlpha((int) (f6 * 255.0f));
                    if (z2) {
                    }
                    themedDrawable.draw(canvas);
                    themedDrawable.setAlpha(255);
                    if (this.transitionParams.animateReplies) {
                    }
                    canvas.save();
                    canvas.translate(f15 + drawableBounds2 + AndroidUtilities.dp(3.0f), timeY);
                    staticLayout = this.repliesLayout;
                    if (staticLayout == null) {
                    }
                }
            } else if (this.currentMessageObject.isOutOwner()) {
                str = "drawableMsgOutReplies";
                themedDrawable = getThemedDrawable(str);
                float drawableBounds22 = BaseCell.setDrawableBounds(themedDrawable, f15, timeY, Theme.chat_timePaint.getTextSize());
                if (!z3) {
                }
                f6 = f7 * f14;
                themedDrawable.setAlpha((int) (f6 * 255.0f));
                if (z2) {
                }
                themedDrawable.draw(canvas);
                themedDrawable.setAlpha(255);
                if (this.transitionParams.animateReplies) {
                }
                canvas.save();
                canvas.translate(f15 + drawableBounds22 + AndroidUtilities.dp(3.0f), timeY);
                staticLayout = this.repliesLayout;
                if (staticLayout == null) {
                }
            } else {
                themedDrawable = z ? Theme.chat_msgInRepliesSelectedDrawable : Theme.chat_msgInRepliesDrawable;
                float drawableBounds222 = BaseCell.setDrawableBounds(themedDrawable, f15, timeY, Theme.chat_timePaint.getTextSize());
                if (!z3) {
                }
                f6 = f7 * f14;
                themedDrawable.setAlpha((int) (f6 * 255.0f));
                if (z2) {
                }
                themedDrawable.draw(canvas);
                themedDrawable.setAlpha(255);
                if (this.transitionParams.animateReplies) {
                }
                canvas.save();
                canvas.translate(f15 + drawableBounds222 + AndroidUtilities.dp(3.0f), timeY);
                staticLayout = this.repliesLayout;
                if (staticLayout == null) {
                }
            }
        } else {
            f8 = f14;
            f9 = f13;
        }
        if (this.viewsLayout != null) {
            TransitionParams transitionParams4 = this.transitionParams;
            boolean z6 = transitionParams4.shouldAnimateTimeX;
            float f18 = (z6 ? this.timeX : f4) + currentWidth;
            if ((!this.isRoundVideo || !transitionParams4.animateDrawBackground) && z6) {
                float f19 = transitionParams4.animateFromTimeXViews;
                float f20 = this.transitionParams.animateChangeProgress;
                f18 = (f18 * f20) + (f19 * (1.0f - f20));
            }
            MessageObject.GroupedMessages groupedMessages2 = this.currentMessagesGroup;
            if (groupedMessages2 != null) {
                MessageObject.GroupedMessages.TransitionParams transitionParams5 = groupedMessages2.transitionParams;
                if (transitionParams5.backgroundChangeBounds) {
                    f18 += transitionParams5.offsetRight;
                }
            }
            if (this.transitionParams.animateBackgroundBoundsInner) {
                f18 += this.animationOffsetX;
            }
            if (shouldDrawTimeOnMedia()) {
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    str3 = "drawableMsgStickerViews";
                    themedDrawable3 = getThemedDrawable(str3);
                    float drawableBounds3 = BaseCell.setDrawableBounds(themedDrawable3, f18, AndroidUtilities.dp(1.5f) + timeY, Theme.chat_timePaint.getTextSize() - AndroidUtilities.dp(2.0f));
                    if (z2) {
                        f10 = f9;
                    } else {
                        canvas.save();
                        f10 = f9;
                        canvas.scale(f10, f10, (((themedDrawable3.getIntrinsicWidth() + AndroidUtilities.dp(3.0f)) + this.viewsTextWidth) / 2.0f) + f18, themedDrawable3.getBounds().centerY());
                    }
                    themedDrawable3.setAlpha((int) (f8 * 255.0f));
                    themedDrawable3.draw(canvas);
                    themedDrawable3.setAlpha(255);
                    if (this.transitionParams.animateViewsLayout != null) {
                        canvas.save();
                        TextPaint textPaint2 = Theme.chat_timePaint;
                        double d3 = alpha;
                        double d4 = this.transitionParams.animateChangeProgress;
                        Double.isNaN(d4);
                        Double.isNaN(d3);
                        textPaint2.setAlpha((int) (d3 * (1.0d - d4)));
                        canvas.translate(f18 + drawableBounds3 + AndroidUtilities.dp(3.0f), timeY);
                        SpoilerEffect.layoutDrawMaybe(this.transitionParams.animateViewsLayout, canvas);
                        canvas.restore();
                        Theme.chat_timePaint.setAlpha((int) (alpha * this.transitionParams.animateChangeProgress));
                    }
                    canvas.save();
                    canvas.translate(f18 + drawableBounds3 + AndroidUtilities.dp(3.0f), timeY);
                    SpoilerEffect.layoutDrawMaybe(this.viewsLayout, canvas);
                    canvas.restore();
                    if (z2) {
                        canvas.restore();
                    }
                    currentWidth += this.viewsTextWidth + drawableBounds3 + AndroidUtilities.dp(10.0f);
                    if (this.transitionParams.animateViewsLayout != null) {
                        Theme.chat_timePaint.setAlpha(alpha);
                    }
                    this.transitionParams.lastTimeXViews = f18;
                } else {
                    themedDrawable3 = Theme.chat_msgMediaViewsDrawable;
                    float drawableBounds32 = BaseCell.setDrawableBounds(themedDrawable3, f18, AndroidUtilities.dp(1.5f) + timeY, Theme.chat_timePaint.getTextSize() - AndroidUtilities.dp(2.0f));
                    if (z2) {
                    }
                    themedDrawable3.setAlpha((int) (f8 * 255.0f));
                    themedDrawable3.draw(canvas);
                    themedDrawable3.setAlpha(255);
                    if (this.transitionParams.animateViewsLayout != null) {
                    }
                    canvas.save();
                    canvas.translate(f18 + drawableBounds32 + AndroidUtilities.dp(3.0f), timeY);
                    SpoilerEffect.layoutDrawMaybe(this.viewsLayout, canvas);
                    canvas.restore();
                    if (z2) {
                    }
                    currentWidth += this.viewsTextWidth + drawableBounds32 + AndroidUtilities.dp(10.0f);
                    if (this.transitionParams.animateViewsLayout != null) {
                    }
                    this.transitionParams.lastTimeXViews = f18;
                }
            } else if (this.currentMessageObject.isOutOwner()) {
                str3 = z ? "drawableMsgOutViewsSelected" : "drawableMsgOutViews";
                themedDrawable3 = getThemedDrawable(str3);
                float drawableBounds322 = BaseCell.setDrawableBounds(themedDrawable3, f18, AndroidUtilities.dp(1.5f) + timeY, Theme.chat_timePaint.getTextSize() - AndroidUtilities.dp(2.0f));
                if (z2) {
                }
                themedDrawable3.setAlpha((int) (f8 * 255.0f));
                themedDrawable3.draw(canvas);
                themedDrawable3.setAlpha(255);
                if (this.transitionParams.animateViewsLayout != null) {
                }
                canvas.save();
                canvas.translate(f18 + drawableBounds322 + AndroidUtilities.dp(3.0f), timeY);
                SpoilerEffect.layoutDrawMaybe(this.viewsLayout, canvas);
                canvas.restore();
                if (z2) {
                }
                currentWidth += this.viewsTextWidth + drawableBounds322 + AndroidUtilities.dp(10.0f);
                if (this.transitionParams.animateViewsLayout != null) {
                }
                this.transitionParams.lastTimeXViews = f18;
            } else {
                themedDrawable3 = z ? Theme.chat_msgInViewsSelectedDrawable : Theme.chat_msgInViewsDrawable;
                float drawableBounds3222 = BaseCell.setDrawableBounds(themedDrawable3, f18, AndroidUtilities.dp(1.5f) + timeY, Theme.chat_timePaint.getTextSize() - AndroidUtilities.dp(2.0f));
                if (z2) {
                }
                themedDrawable3.setAlpha((int) (f8 * 255.0f));
                themedDrawable3.draw(canvas);
                themedDrawable3.setAlpha(255);
                if (this.transitionParams.animateViewsLayout != null) {
                }
                canvas.save();
                canvas.translate(f18 + drawableBounds3222 + AndroidUtilities.dp(3.0f), timeY);
                SpoilerEffect.layoutDrawMaybe(this.viewsLayout, canvas);
                canvas.restore();
                if (z2) {
                }
                currentWidth += this.viewsTextWidth + drawableBounds3222 + AndroidUtilities.dp(10.0f);
                if (this.transitionParams.animateViewsLayout != null) {
                }
                this.transitionParams.lastTimeXViews = f18;
            }
        } else {
            f10 = f9;
        }
        if (this.isPinned || this.transitionParams.animatePinned) {
            TransitionParams transitionParams6 = this.transitionParams;
            float f21 = (transitionParams6.shouldAnimateTimeX ? this.timeX : f4) + currentWidth;
            boolean z7 = transitionParams6.animatePinned && this.isPinned;
            boolean z8 = this.transitionParams.animatePinned && !this.isPinned;
            if (!this.isRoundVideo) {
                TransitionParams transitionParams7 = this.transitionParams;
                if (transitionParams7.shouldAnimateTimeX && !z7) {
                    if (z8) {
                        f21 = transitionParams7.animateFromTimeXPinned;
                    } else {
                        float f22 = transitionParams7.animateFromTimeXPinned;
                        float f23 = transitionParams7.animateChangeProgress;
                        f21 = (f21 * f23) + (f22 * (1.0f - f23));
                    }
                }
            }
            MessageObject.GroupedMessages groupedMessages3 = this.currentMessagesGroup;
            if (groupedMessages3 != null) {
                MessageObject.GroupedMessages.TransitionParams transitionParams8 = groupedMessages3.transitionParams;
                if (transitionParams8.backgroundChangeBounds) {
                    f21 += transitionParams8.offsetRight;
                }
            }
            if (this.transitionParams.animateBackgroundBoundsInner) {
                f21 += this.animationOffsetX;
            }
            if (shouldDrawTimeOnMedia()) {
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    str2 = "drawableMsgStickerPinned";
                    themedDrawable2 = getThemedDrawable(str2);
                } else {
                    themedDrawable2 = Theme.chat_msgMediaPinnedDrawable;
                }
            } else if (this.currentMessageObject.isOutOwner()) {
                str2 = z ? "drawableMsgOutPinnedSelected" : "drawableMsgOutPinned";
                themedDrawable2 = getThemedDrawable(str2);
            } else {
                themedDrawable2 = z ? Theme.chat_msgInPinnedSelectedDrawable : Theme.chat_msgInPinnedDrawable;
            }
            if (!this.transitionParams.animatePinned) {
                f11 = 1.0f;
                f12 = f8 * 255.0f;
            } else {
                if (this.isPinned) {
                    themedDrawable2.setAlpha((int) (f8 * 255.0f * this.transitionParams.animateChangeProgress));
                    textSize = Theme.chat_timePaint.getTextSize();
                    f11 = 1.0f;
                    float drawableBounds4 = BaseCell.setDrawableBounds(themedDrawable2, f21, timeY, textSize + AndroidUtilities.dp(f11));
                    if (z2) {
                        canvas.save();
                        canvas.scale(f10, f10, (drawableBounds4 / 2.0f) + f21, themedDrawable2.getBounds().centerY());
                    }
                    themedDrawable2.draw(canvas);
                    themedDrawable2.setAlpha(255);
                    if (z2) {
                        canvas.restore();
                    }
                    this.transitionParams.lastTimeXPinned = f21;
                }
                f11 = 1.0f;
                f12 = f8 * 255.0f * (1.0f - this.transitionParams.animateChangeProgress);
            }
            themedDrawable2.setAlpha((int) f12);
            textSize = Theme.chat_timePaint.getTextSize();
            float drawableBounds42 = BaseCell.setDrawableBounds(themedDrawable2, f21, timeY, textSize + AndroidUtilities.dp(f11));
            if (z2) {
            }
            themedDrawable2.draw(canvas);
            themedDrawable2.setAlpha(255);
            if (z2) {
            }
            this.transitionParams.lastTimeXPinned = f21;
        }
    }

    private void fileAttach(boolean z, MessageObject messageObject) {
        ImageReceiver imageReceiver = this.photoImage;
        if (imageReceiver != null) {
            imageReceiver.setFileLoadingPriority(1);
        }
        if (z && messageObject != null && (this.isRoundVideo || messageObject.isVideo())) {
            checkVideoPlayback(true, null);
        }
        if (messageObject == null || messageObject.mediaExists) {
            return;
        }
        int iCanDownloadMediaType = DownloadController.getInstance(this.currentAccount).canDownloadMediaType(messageObject);
        TLRPC.Document document = messageObject.getDocument();
        if (!MessageObject.isStickerDocument(document) && !MessageObject.isAnimatedStickerDocument(document, true) && !MessageObject.isGifDocument(document) && !MessageObject.isRoundVideoDocument(document) && !messageObject.hasVideoQualities() && !this.isSmallImage) {
            TLRPC.PhotoSize closestPhotoSizeWithSize = document == null ? FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, AndroidUtilities.getPhotoSize()) : null;
            if (iCanDownloadMediaType == 2 || (iCanDownloadMediaType == 1 && messageObject.isVideo())) {
                if (iCanDownloadMediaType != 2 && document != null && !messageObject.shouldEncryptPhotoOrVideo() && messageObject.canStreamVideo()) {
                    FileLoader.getInstance(this.currentAccount).loadFile(document, messageObject, 1, 0);
                }
            } else if (iCanDownloadMediaType != 0) {
                if (document != null) {
                    FileLoader.getInstance(this.currentAccount).loadFile(document, messageObject, 1, ((MessageObject.isVideoDocument(document) || messageObject.isVoiceOnce() || messageObject.isRoundOnce()) && messageObject.shouldEncryptPhotoOrVideo()) ? 2 : 0);
                } else if (closestPhotoSizeWithSize != null) {
                    FileLoader.getInstance(this.currentAccount).loadFile(ImageLocation.getForObject(closestPhotoSizeWithSize, messageObject.photoThumbsObject), messageObject, null, 1, messageObject.shouldEncryptPhotoOrVideo() ? 2 : 0);
                }
            }
            if (z) {
                updateButtonState(false, false, false);
            }
        }
        if (messageObject.hasVideoQualities()) {
            VideoPlayer.VideoUri videoUri = messageObject.highestQuality;
            if (videoUri != null && !videoUri.isManifestCached()) {
                FileLoader.getInstance(this.currentAccount).loadFile(messageObject.highestQuality.manifestDocument, messageObject, 1, 0);
            }
            VideoPlayer.VideoUri videoUri2 = messageObject.thumbQuality;
            if (videoUri2 == null || videoUri2.isManifestCached()) {
                return;
            }
            FileLoader.getInstance(this.currentAccount).loadFile(messageObject.thumbQuality.manifestDocument, messageObject, 1, 0);
        }
    }

    private void fileDetach(MessageObject messageObject) {
        ImageReceiver imageReceiver = this.photoImage;
        if (imageReceiver != null) {
            imageReceiver.setFileLoadingPriority(0);
        }
        cancelLoading(messageObject);
    }

    private boolean findProgressLoadingLink(LoadingDrawableLocation loadingDrawableLocation, LinkPath linkPath, Layout layout, float f, int i) {
        if (layout == null || !(layout.getText() instanceof Spanned)) {
            return false;
        }
        Spanned spanned = (Spanned) layout.getText();
        CharacterStyle[] characterStyleArr = (CharacterStyle[]) spanned.getSpans(0, spanned.length(), CharacterStyle.class);
        if (characterStyleArr != null) {
            int i2 = 0;
            while (true) {
                if (i2 >= characterStyleArr.length) {
                    break;
                }
                if (characterStyleArr[i2] == this.progressLoadingLink) {
                    loadingDrawableLocation.blockNum = i;
                    break;
                }
                i2++;
            }
        }
        if (loadingDrawableLocation.blockNum != i) {
            return false;
        }
        linkPath.rewind();
        int spanStart = spanned.getSpanStart(this.progressLoadingLink);
        int spanEnd = spanned.getSpanEnd(this.progressLoadingLink);
        linkPath.setUseCornerPathImplementation(true);
        linkPath.setCurrentLayout(layout, spanStart, f);
        layout.getSelectionPath(spanStart, spanEnd, linkPath);
        linkPath.closeRects();
        this.progressLoadingLinkCurrentDrawable.updateBounds();
        return true;
    }

    private boolean findProgressLoadingLink(LoadingDrawableLocation loadingDrawableLocation, LinkPath linkPath, ArrayList arrayList) {
        if (arrayList == null) {
            return false;
        }
        for (int i = 0; i < arrayList.size(); i++) {
            if (findProgressLoadingLink(loadingDrawableLocation, linkPath, ((MessageObject.TextLayoutBlock) arrayList.get(i)).textLayout, BitmapDescriptorFactory.HUE_RED, i)) {
                return true;
            }
        }
        return false;
    }

    public static StaticLayout generateStaticLayout(CharSequence charSequence, TextPaint textPaint, int i, int i2, int i3, int i4) {
        SpannableStringBuilder spannableStringBuilder = new SpannableStringBuilder(charSequence);
        StaticLayout staticLayout = new StaticLayout(charSequence, textPaint, i2, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
        int i5 = i;
        int i6 = 0;
        for (int i7 = 0; i7 < i3; i7++) {
            staticLayout.getLineDirections(i7);
            if (staticLayout.getLineLeft(i7) != BitmapDescriptorFactory.HUE_RED || staticLayout.isRtlCharAt(staticLayout.getLineStart(i7)) || staticLayout.isRtlCharAt(staticLayout.getLineEnd(i7))) {
                i5 = i2;
            }
            int lineEnd = staticLayout.getLineEnd(i7);
            if (lineEnd == charSequence.length()) {
                break;
            }
            int i8 = (lineEnd - 1) + i6;
            if (spannableStringBuilder.charAt(i8) == ' ') {
                spannableStringBuilder.replace(i8, i8 + 1, (CharSequence) "\n");
            } else if (spannableStringBuilder.charAt(i8) != '\n') {
                spannableStringBuilder.insert(i8, (CharSequence) "\n");
                i6++;
            }
            if (i7 == staticLayout.getLineCount() - 1 || i7 == i4 - 1) {
                break;
            }
        }
        int i9 = i5;
        return StaticLayoutEx.createStaticLayout(spannableStringBuilder, textPaint, i9, Layout.Alignment.ALIGN_NORMAL, 1.0f, AndroidUtilities.dp(1.0f), false, TextUtils.TruncateAt.END, i9, i4, true);
    }

    private ColorFilter getAdaptiveEmojiColorFilter(int i, int i2) {
        if (this.adaptiveEmojiColorFilter == null) {
            this.adaptiveEmojiColor = new int[3];
            this.adaptiveEmojiColorFilter = new ColorFilter[3];
        }
        if (i2 != this.adaptiveEmojiColor[i] || this.adaptiveEmojiColorFilter[i] == null) {
            ColorFilter[] colorFilterArr = this.adaptiveEmojiColorFilter;
            this.adaptiveEmojiColor[i] = i2;
            colorFilterArr[i] = new PorterDuffColorFilter(i2, PorterDuff.Mode.SRC_IN);
        }
        return this.adaptiveEmojiColorFilter[i];
    }

    private int getAdditionalWidthForPosition(MessageObject.GroupedMessagePosition groupedMessagePosition) {
        if (groupedMessagePosition == null) {
            return 0;
        }
        int iDp = (groupedMessagePosition.flags & 2) == 0 ? AndroidUtilities.dp(4.0f) : 0;
        return (groupedMessagePosition.flags & 1) == 0 ? iDp + AndroidUtilities.dp(4.0f) : iDp;
    }

    private long getAuthorBotVerificationId() {
        MessageObject messageObject;
        TLRPC.User user = this.currentUser;
        if (user != null) {
            return DialogObject.getBotVerificationIcon(user);
        }
        if (this.currentChat != null && (messageObject = this.currentMessageObject) != null && messageObject.getDialogId() != UserObject.REPLY_BOT && this.currentChat.signature_profiles) {
            long peerDialogId = DialogObject.getPeerDialogId(this.currentMessageObject.messageOwner.from_id);
            if (peerDialogId >= 0) {
                TLRPC.User user2 = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(peerDialogId));
                if (user2 != null) {
                    return DialogObject.getBotVerificationIcon(user2);
                }
            } else {
                TLRPC.Chat chat = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(-peerDialogId));
                if (chat != null) {
                    return DialogObject.getBotVerificationIcon(chat);
                }
            }
        }
        return 0L;
    }

    private String getAuthorName() {
        TLRPC.User user = this.currentUser;
        if (user != null) {
            return UserObject.getUserName(user);
        }
        if (this.currentChat == null) {
            MessageObject messageObject = this.currentMessageObject;
            return (messageObject == null || !messageObject.isSponsored()) ? "DELETED" : this.currentMessageObject.sponsoredTitle;
        }
        MessageObject messageObject2 = this.currentMessageObject;
        if (messageObject2 != null && messageObject2.getDialogId() != UserObject.REPLY_BOT && this.currentChat.signature_profiles) {
            long peerDialogId = DialogObject.getPeerDialogId(this.currentMessageObject.messageOwner.from_id);
            MessagesController messagesController = MessagesController.getInstance(this.currentAccount);
            if (peerDialogId >= 0) {
                TLRPC.User user2 = messagesController.getUser(Long.valueOf(peerDialogId));
                if (user2 != null) {
                    return UserObject.getUserName(user2);
                }
            } else {
                TLRPC.Chat chat = messagesController.getChat(Long.valueOf(-peerDialogId));
                if (chat != null) {
                    return chat.title;
                }
            }
        }
        return this.currentChat.title;
    }

    private Object getAuthorStatus() {
        MessageObject messageObject;
        TLRPC.User user = this.currentUser;
        if (user != null) {
            Long emojiStatusDocumentId = UserObject.getEmojiStatusDocumentId(user);
            if (emojiStatusDocumentId == null) {
                if (this.currentUser.premium) {
                    return ContextCompat.getDrawable(ApplicationLoader.applicationContext, R.drawable.msg_premium_liststar).mutate();
                }
                return null;
            }
            TLRPC.EmojiStatus emojiStatus = this.currentUser.emoji_status;
            if (emojiStatus instanceof TLRPC.TL_emojiStatusCollectible) {
                this.nameStatusSlug = ((TLRPC.TL_emojiStatusCollectible) emojiStatus).slug;
            }
            return emojiStatusDocumentId;
        }
        if (this.currentChat == null || (messageObject = this.currentMessageObject) == null || messageObject.getDialogId() == UserObject.REPLY_BOT || !this.currentChat.signature_profiles) {
            return null;
        }
        long peerDialogId = DialogObject.getPeerDialogId(this.currentMessageObject.messageOwner.from_id);
        MessagesController messagesController = MessagesController.getInstance(this.currentAccount);
        if (peerDialogId >= 0) {
            TLRPC.User user2 = messagesController.getUser(Long.valueOf(peerDialogId));
            if (user2 != null) {
                TLRPC.EmojiStatus emojiStatus2 = user2.emoji_status;
                if (emojiStatus2 instanceof TLRPC.TL_emojiStatusCollectible) {
                    this.nameStatusSlug = ((TLRPC.TL_emojiStatusCollectible) emojiStatus2).slug;
                }
            }
            return UserObject.getEmojiStatusDocumentId(user2);
        }
        TLRPC.Chat chat = messagesController.getChat(Long.valueOf(-peerDialogId));
        if (chat == null) {
            return null;
        }
        TLRPC.EmojiStatus emojiStatus3 = chat.emoji_status;
        if (emojiStatus3 instanceof TLRPC.TL_emojiStatusCollectible) {
            this.nameStatusSlug = ((TLRPC.TL_emojiStatusCollectible) emojiStatus3).slug;
        }
        return Long.valueOf(DialogObject.getEmojiStatusDocumentId(emojiStatus3));
    }

    private int getExtraTimeX() {
        int i;
        if (!this.currentMessageObject.isOutOwner() && ((!this.mediaBackground || this.captionLayout != null) && (i = SharedConfig.bubbleRadius) > 11)) {
            return AndroidUtilities.dp((i - 11) / 1.5f);
        }
        if (!this.currentMessageObject.isOutOwner() && this.isPlayingRound && this.isAvatarVisible && this.currentMessageObject.type == 5) {
            return (int) ((AndroidUtilities.roundPlayingMessageSize(this.isSideMenued) - AndroidUtilities.roundMessageSize) * 0.7f);
        }
        return 0;
    }

    private ColorMatrixColorFilter getFancyBlurFilter() {
        if (this.fancyBlurFilter == null) {
            ColorMatrix colorMatrix = new ColorMatrix();
            AndroidUtilities.multiplyBrightnessColorMatrix(colorMatrix, 0.9f);
            AndroidUtilities.adjustSaturationColorMatrix(colorMatrix, 0.6f);
            this.fancyBlurFilter = new ColorMatrixColorFilter(colorMatrix);
        }
        return this.fancyBlurFilter;
    }

    private String getForwardedMessageText(MessageObject messageObject) {
        if (!this.hasPsaHint) {
            return LocaleController.getString(R.string.ForwardedFrom);
        }
        String string = LocaleController.getString("PsaMessage_" + messageObject.messageOwner.fwd_from.psa_type);
        return string == null ? LocaleController.getString("PsaMessageDefault", R.string.PsaMessageDefault) : string;
    }

    private int getGroupPhotosWidth() {
        int parentWidth = getParentWidth();
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && messageObject.preview) {
            parentWidth = this.parentWidth;
        }
        if (AndroidUtilities.isInMultiwindow || !AndroidUtilities.isTablet()) {
            return parentWidth;
        }
        if (AndroidUtilities.isSmallTablet() && getResources().getConfiguration().orientation != 2) {
            return parentWidth;
        }
        int iDp = (parentWidth / 100) * 35;
        if (iDp < AndroidUtilities.dp(320.0f)) {
            iDp = AndroidUtilities.dp(320.0f);
        }
        return parentWidth - iDp;
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:102:0x016b A[RETURN] */
    /* JADX WARN: Removed duplicated region for block: B:103:0x016c  */
    /* JADX WARN: Removed duplicated region for block: B:39:0x009a A[RETURN] */
    /* JADX WARN: Removed duplicated region for block: B:40:0x009b  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public int getIconForCurrentState() {
        RadialProgress2 radialProgress2;
        int i;
        int i2;
        int i3;
        int i4;
        int i5;
        RadialProgress2 radialProgress22;
        int i6;
        int i7;
        int i8;
        int i9;
        int i10;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || messageObject.hasExtendedMedia()) {
            return 4;
        }
        if (this.documentAttachType == 7 && this.currentMessageObject.isVoiceTranscriptionOpen() && this.canStreamVideo) {
            int i11 = this.buttonState;
            return (i11 == 1 || i11 == 4) ? 1 : 0;
        }
        int i12 = this.documentAttachType;
        if (i12 != 3 && i12 != 5) {
            if (i12 != 1 || this.drawPhotoImage) {
                RadialProgress2 radialProgress23 = this.radialProgress;
                int i13 = Theme.key_chat_mediaLoaderPhoto;
                int i14 = Theme.key_chat_mediaLoaderPhotoSelected;
                int i15 = Theme.key_chat_mediaLoaderPhotoIcon;
                int i16 = Theme.key_chat_mediaLoaderPhotoIconSelected;
                radialProgress23.setColorKeys(i13, i14, i15, i16);
                this.videoRadialProgress.setColorKeys(i13, i14, i15, i16);
                int i17 = this.buttonState;
                if (i17 >= 0 && i17 < 4) {
                    if (i17 == 0) {
                        return 2;
                    }
                    if (i17 == 1) {
                        return 3;
                    }
                    return (i17 != 2 && this.autoPlayingMedia) ? 4 : 0;
                }
                if (i17 == -1) {
                    if (this.documentAttachType == 1) {
                        return (!this.drawPhotoImage || (this.currentPhotoObject == null && this.currentPhotoObjectThumb == null) || !(this.photoImage.hasBitmapImage() || this.currentMessageObject.mediaExists() || this.currentMessageObject.attachPathExists)) ? 5 : 4;
                    }
                    if (this.currentMessageObject.needDrawBluredPreview()) {
                        return 7;
                    }
                    if (this.hasEmbed) {
                        return 0;
                    }
                }
            } else {
                if (this.currentMessageObject.isOutOwner()) {
                    radialProgress22 = this.radialProgress;
                    i6 = Theme.key_chat_outLoader;
                    i7 = Theme.key_chat_outLoaderSelected;
                    i8 = Theme.key_chat_outMediaIcon;
                    i9 = Theme.key_chat_outMediaIconSelected;
                } else {
                    ReplyMessageLine replyMessageLine = this.linkLine;
                    if (replyMessageLine == null || !this.hasLinkPreview) {
                        radialProgress22 = this.radialProgress;
                        i6 = Theme.key_chat_inLoader;
                        i7 = Theme.key_chat_inLoaderSelected;
                        i8 = Theme.key_chat_inMediaIcon;
                        i9 = Theme.key_chat_inMediaIconSelected;
                    } else {
                        this.radialProgress.setColors(replyMessageLine.getColor(), this.linkLine.getColor(), Theme.blendOver(-1, Theme.multAlpha(this.linkLine.getColor(), 0.01f)), Theme.blendOver(-1, Theme.multAlpha(this.linkLine.getColor(), 0.05f)));
                        i10 = this.buttonState;
                        if (i10 != -1) {
                            return 5;
                        }
                        if (i10 == 0) {
                            return 2;
                        }
                        if (i10 == 1) {
                            return 3;
                        }
                    }
                }
                radialProgress22.setColorKeys(i6, i7, i8, i9);
                i10 = this.buttonState;
                if (i10 != -1) {
                }
            }
            MessageObject messageObject2 = this.currentMessageObject;
            return (messageObject2 != null && this.isRoundVideo && messageObject2.isVoiceTranscriptionOpen()) ? 0 : 4;
        }
        if (this.currentMessageObject.isOutOwner()) {
            radialProgress2 = this.radialProgress;
            i = Theme.key_chat_outLoader;
            i2 = Theme.key_chat_outLoaderSelected;
            i3 = Theme.key_chat_outMediaIcon;
            i4 = Theme.key_chat_outMediaIconSelected;
        } else {
            ReplyMessageLine replyMessageLine2 = this.linkLine;
            if (replyMessageLine2 != null && this.hasLinkPreview) {
                this.radialProgress.setColors(replyMessageLine2.getColor(), this.linkLine.getColor(), Theme.blendOver(-1, Theme.multAlpha(this.linkLine.getColor(), 0.01f)), Theme.blendOver(-1, Theme.multAlpha(this.linkLine.getColor(), 0.05f)));
                i5 = this.buttonState;
                if (i5 != 1) {
                    return 1;
                }
                if (i5 == 2) {
                    return 2;
                }
                return i5 == 4 ? 3 : 0;
            }
            radialProgress2 = this.radialProgress;
            i = Theme.key_chat_inLoader;
            i2 = Theme.key_chat_inLoaderSelected;
            i3 = Theme.key_chat_inMediaIcon;
            i4 = Theme.key_chat_inMediaIconSelected;
        }
        radialProgress2.setColorKeys(i, i2, i3, i4);
        i5 = this.buttonState;
        if (i5 != 1) {
        }
    }

    public static Point getMessageSize(int i, int i2) {
        return getMessageSize(i, i2, 0, 0);
    }

    /* JADX WARN: Removed duplicated region for block: B:14:0x0040  */
    /* JADX WARN: Removed duplicated region for block: B:17:0x004a  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private static Point getMessageSize(int i, int i2, int i3, int i4) {
        int iMin;
        if (i4 == 0 || i3 == 0) {
            if (AndroidUtilities.isTablet()) {
                iMin = AndroidUtilities.getMinTabletSide();
            } else {
                android.graphics.Point point = AndroidUtilities.displaySize;
                if (i >= i2) {
                    i3 = Math.min(point.x, point.y) - AndroidUtilities.dp(64.0f);
                    i4 = AndroidUtilities.dp(100.0f) + i3;
                    if (i3 > AndroidUtilities.getPhotoSize()) {
                        i3 = AndroidUtilities.getPhotoSize();
                    }
                    if (i4 > AndroidUtilities.getPhotoSize()) {
                        i4 = AndroidUtilities.getPhotoSize();
                    }
                } else {
                    iMin = Math.min(point.x, point.y);
                }
            }
            i3 = (int) (iMin * 0.7f);
            i4 = AndroidUtilities.dp(100.0f) + i3;
            if (i3 > AndroidUtilities.getPhotoSize()) {
            }
            if (i4 > AndroidUtilities.getPhotoSize()) {
            }
        }
        float f = i;
        float f2 = i3;
        float f3 = f / f2;
        int iDp = (int) (f / f3);
        float f4 = i2;
        int iDp2 = (int) (f4 / f3);
        if (iDp == 0) {
            iDp = AndroidUtilities.dp(150.0f);
        }
        if (iDp2 == 0) {
            iDp2 = AndroidUtilities.dp(150.0f);
        }
        if (iDp2 > i4) {
            iDp = (int) (iDp / (iDp2 / i4));
        } else if (iDp2 < AndroidUtilities.dp(120.0f)) {
            i4 = AndroidUtilities.dp(120.0f);
            float f5 = f / (f4 / i4);
            if (f5 < f2) {
                iDp = (int) f5;
            }
        } else {
            i4 = iDp2;
        }
        return new Point(iDp, i4);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int getMiniIconForCurrentState() {
        int i = this.miniButtonState;
        if (i < 0) {
            return 4;
        }
        return i == 0 ? 2 : 3;
    }

    private String getNameFromDialogId(long j) {
        TLRPC.Chat chat;
        if (j > 0) {
            TLRPC.User user = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(j));
            if (user != null) {
                return UserObject.getUserName(user);
            }
        } else if (j < 0 && (chat = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(-j))) != null) {
            return chat.title;
        }
        return null;
    }

    private int getNameHeight() {
        return this.drawNameAvatar ? this.adminLayout == null ? AndroidUtilities.dp(31.0f) : AndroidUtilities.dp(37.66f) : (int) (AndroidUtilities.dp(5.0f) + Theme.chat_namePaint.getTextSize());
    }

    private float getNameHeightAnimated() {
        float fLerp;
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateDrawAvatar) {
            boolean z = this.drawNameAvatar;
            fLerp = AndroidUtilities.lerp(!z, z, transitionParams.animateChangeProgress);
        } else {
            fLerp = this.drawNameAvatar ? 1.0f : BitmapDescriptorFactory.HUE_RED;
        }
        return AndroidUtilities.lerp(AndroidUtilities.dp(5.0f) + Theme.chat_namePaint.getTextSize(), AndroidUtilities.dp(this.adminLayout == null ? 31.0f : 35.0f), fLerp);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int[] getRealSpanStartAndEnd(Spannable spannable, CharacterStyle characterStyle) {
        int spanStart;
        int spanEnd;
        boolean z;
        TextStyleSpan.TextStyleRun style;
        TLRPC.MessageEntity messageEntity;
        if (!(characterStyle instanceof URLSpanBrowser) || (style = ((URLSpanBrowser) characterStyle).getStyle()) == null || (messageEntity = style.urlEntity) == null) {
            spanStart = 0;
            spanEnd = 0;
            z = false;
        } else {
            spanStart = messageEntity.offset;
            spanEnd = messageEntity.length + spanStart;
            z = true;
        }
        if (!z) {
            spanStart = spannable.getSpanStart(characterStyle);
            spanEnd = spannable.getSpanEnd(characterStyle);
        }
        return new int[]{spanStart, spanEnd};
    }

    private ArrayList<TLRPC.Peer> getRecentRepliers() {
        TLRPC.MessageReplies messageReplies;
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages != null && !groupedMessages.messages.isEmpty() && (messageReplies = this.currentMessagesGroup.messages.get(0).messageOwner.replies) != null) {
            return messageReplies.recent_repliers;
        }
        TLRPC.MessageReplies messageReplies2 = this.currentMessageObject.messageOwner.replies;
        if (messageReplies2 != null) {
            return messageReplies2.recent_repliers;
        }
        return null;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int getRepliesCount() {
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        return ((groupedMessages == null || groupedMessages.messages.isEmpty()) ? this.currentMessageObject : this.currentMessagesGroup.messages.get(0)).getRepliesCount();
    }

    private int getSelectionOverlayColor() {
        Theme.ResourcesProvider resourcesProvider = this.resourcesProvider;
        if (resourcesProvider == null) {
            return 0;
        }
        MessageObject messageObject = this.currentMessageObject;
        return resourcesProvider.getColor((messageObject == null || !messageObject.isOut()) ? Theme.key_chat_inBubbleSelectedOverlay : Theme.key_chat_outBubbleSelectedOverlay);
    }

    private Drawable getThemedDrawable(String str) {
        Theme.ResourcesProvider resourcesProvider = this.resourcesProvider;
        Drawable drawable = resourcesProvider != null ? resourcesProvider.getDrawable(str) : null;
        return drawable != null ? drawable : Theme.getThemeDrawable(str);
    }

    private float getUseTranscribeButtonProgress() {
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateUseTranscribeButton) {
            boolean z = this.useTranscribeButton;
            float f = transitionParams.animateChangeProgress;
            return z ? f : 1.0f - f;
        }
        if (this.useTranscribeButton) {
            return 1.0f;
        }
        return BitmapDescriptorFactory.HUE_RED;
    }

    private boolean hasSelectionOverlay() {
        int selectionOverlayColor = getSelectionOverlayColor();
        return (selectionOverlayColor == 0 || selectionOverlayColor == -65536) ? false : true;
    }

    private void highlight(int i, int i2, ArrayList arrayList) {
        if (arrayList == null) {
            return;
        }
        int i3 = i2 - i;
        int i4 = 0;
        while (true) {
            if (i4 >= arrayList.size()) {
                break;
            }
            MessageObject.TextLayoutBlock textLayoutBlock = (MessageObject.TextLayoutBlock) arrayList.get(i4);
            if (i < textLayoutBlock.charactersOffset || i >= textLayoutBlock.charactersEnd) {
                i4++;
            } else {
                this.linkSelectionBlockNum = i4;
                resetUrlPaths();
                try {
                    LinkPath linkPathObtainNewUrlPath = obtainNewUrlPath();
                    linkPathObtainNewUrlPath.setUseCornerPathImplementation(true);
                    linkPathObtainNewUrlPath.setCurrentLayout(textLayoutBlock.textLayout, i, BitmapDescriptorFactory.HUE_RED);
                    textLayoutBlock.textLayout.getSelectionPath(i, i2, linkPathObtainNewUrlPath);
                    linkPathObtainNewUrlPath.closeRects();
                    float f = textLayoutBlock.height + textLayoutBlock.padBottom;
                    if (i2 >= textLayoutBlock.charactersOffset + i3) {
                        for (int i5 = i4 + 1; i5 < arrayList.size(); i5++) {
                            MessageObject.TextLayoutBlock textLayoutBlock2 = (MessageObject.TextLayoutBlock) arrayList.get(i5);
                            int i6 = textLayoutBlock2.charactersEnd - textLayoutBlock2.charactersOffset;
                            LinkPath linkPathObtainNewUrlPath2 = obtainNewUrlPath();
                            linkPathObtainNewUrlPath2.setUseCornerPathImplementation(true);
                            float f2 = f + textLayoutBlock2.padTop;
                            linkPathObtainNewUrlPath2.setCurrentLayout(textLayoutBlock2.textLayout, 0, f2);
                            f = f2 + textLayoutBlock2.height + textLayoutBlock2.padBottom;
                            textLayoutBlock2.textLayout.getSelectionPath(0, i2 - textLayoutBlock2.charactersOffset, linkPathObtainNewUrlPath2);
                            linkPathObtainNewUrlPath2.closeRects();
                            if (i2 < (textLayoutBlock.charactersOffset + i6) - 1) {
                                break;
                            }
                        }
                    }
                    if (this.highlightedQuote) {
                        this.isHighlightedAnimated = true;
                        this.highlightProgress = 2500;
                    }
                } catch (Exception e) {
                    FileLog.e(e);
                }
                invalidate();
            }
        }
        this.highlightCaptionToSetStart = -1;
        this.highlightCaptionToSetEnd = -1;
    }

    private boolean intersect(float f, float f2, float f3, float f4) {
        return f <= f3 ? f2 >= f3 : f <= f4;
    }

    private boolean invalidateParentForce() {
        MessageObject messageObject;
        return (this.links.isEmpty() && this.reactionsLayoutInBubble.isEmpty && ((messageObject = this.currentMessageObject) == null || !messageObject.preview)) ? false : true;
    }

    private void invalidateWithParent() {
        if (this.currentMessagesGroup != null && getParent() != null) {
            ((ViewGroup) getParent()).invalidate();
        }
        invalidate();
    }

    private boolean isCurrentLocationTimeExpired(MessageObject messageObject) {
        int i = MessageObject.getMedia(this.currentMessageObject.messageOwner).period;
        int currentTime = ConnectionsManager.getInstance(this.currentAccount).getCurrentTime();
        if (i == Integer.MAX_VALUE) {
            return false;
        }
        int i2 = i % 60;
        int iAbs = Math.abs(currentTime - messageObject.messageOwner.date);
        return i2 == 0 ? iAbs > i : iAbs > i + (-5);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public boolean isOpenChatByShare(MessageObject messageObject) {
        ChatMessageCellDelegate chatMessageCellDelegate;
        TLRPC.MessageFwdHeader messageFwdHeader = messageObject.messageOwner.fwd_from;
        return (messageFwdHeader == null || messageFwdHeader.saved_from_peer == null || ((chatMessageCellDelegate = this.delegate) != null && !chatMessageCellDelegate.isReplyOrSelf())) ? false : true;
    }

    /* JADX WARN: Removed duplicated region for block: B:21:0x0039  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean isPhotoDataChanged(MessageObject messageObject) {
        int i;
        int i2;
        int iDp;
        String strFormapMapUrl;
        int i3;
        int i4 = messageObject.type;
        if (i4 == 0 || i4 == 14) {
            return false;
        }
        if (i4 != 4) {
            TLRPC.PhotoSize photoSize = this.currentPhotoObject;
            if (photoSize == null || (photoSize.location instanceof TLRPC.TL_fileLocationUnavailable)) {
                return i4 == 1 || i4 == 20 || i4 == 5 || i4 == 3 || i4 == 8 || messageObject.isAnyKindOfSticker();
            }
            if (this.currentMessageObject == null || !this.photoNotSet) {
                return false;
            }
            return FileLoader.getInstance(this.currentAccount).getPathToMessage(this.currentMessageObject.messageOwner).exists();
        }
        if (this.currentUrl == null) {
            return true;
        }
        TLRPC.GeoPoint geoPoint = messageObject.messageOwner.media.geo;
        double d = geoPoint.lat;
        double d2 = geoPoint._long;
        if (((int) messageObject.getDialogId()) != 0 || (i3 = SharedConfig.mapPreviewType) == 0) {
            i = -1;
        } else if (i3 == 1) {
            i = 4;
        } else if (i3 == 3) {
            i = 1;
        }
        TLRPC.MessageMedia messageMedia = messageObject.messageOwner.media;
        if (messageMedia instanceof TLRPC.TL_messageMediaGeoLive) {
            int iDp2 = this.backgroundWidth - AndroidUtilities.dp(21.0f);
            int iDp3 = AndroidUtilities.dp(195.0f);
            double d3 = 268435456;
            Double.isNaN(d3);
            double d4 = d3 / 3.141592653589793d;
            double d5 = (d * 3.141592653589793d) / 180.0d;
            double dLog = (Math.log((Math.sin(d5) + 1.0d) / (1.0d - Math.sin(d5))) * d4) / 2.0d;
            Double.isNaN(d3);
            double dRound = Math.round(d3 - dLog) - (AndroidUtilities.dp(10.3f) << 6);
            Double.isNaN(dRound);
            Double.isNaN(d3);
            double dAtan = ((1.5707963267948966d - (Math.atan(Math.exp((dRound - d3) / d4)) * 2.0d)) * 180.0d) / 3.141592653589793d;
            int i5 = this.currentAccount;
            float f = AndroidUtilities.density;
            strFormapMapUrl = AndroidUtilities.formapMapUrl(i5, dAtan, d2, (int) (iDp2 / f), (int) (iDp3 / f), false, 15, i);
        } else {
            if (TextUtils.isEmpty(messageMedia.title)) {
                i2 = this.backgroundWidth;
                iDp = AndroidUtilities.dp(12.0f);
            } else {
                i2 = this.backgroundWidth;
                iDp = AndroidUtilities.dp(21.0f);
            }
            int i6 = i2 - iDp;
            int iDp4 = AndroidUtilities.dp(195.0f);
            int i7 = this.currentAccount;
            float f2 = AndroidUtilities.density;
            strFormapMapUrl = AndroidUtilities.formapMapUrl(i7, d, d2, (int) (i6 / f2), (int) (iDp4 / f2), true, 15, i);
        }
        return !strFormapMapUrl.equals(this.currentUrl);
    }

    private boolean isSideMenuLeftMargin() {
        MessageObject messageObject;
        return this.isSideMenuEnabled && (messageObject = this.currentMessageObject) != null && !messageObject.isOutOwner() && this.currentPosition == null;
    }

    private boolean isSideMenuPossibleLeftMargin() {
        MessageObject messageObject;
        return this.isSideMenued && (messageObject = this.currentMessageObject) != null && !messageObject.isOutOwner() && this.currentPosition == null;
    }

    private float isSmallImage() {
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateSmallImage) {
            boolean z = this.isSmallImage;
            float f = transitionParams.animateChangeProgress;
            return z ? f : 1.0f - f;
        }
        if (this.isSmallImage) {
            return 1.0f;
        }
        return BitmapDescriptorFactory.HUE_RED;
    }

    /* JADX WARN: Removed duplicated region for block: B:45:0x0078  */
    /* JADX WARN: Removed duplicated region for block: B:77:0x00cc  */
    /* JADX WARN: Removed duplicated region for block: B:84:0x00da  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean isUserDataChanged() {
        TLRPC.FileLocation fileLocation;
        TLRPC.FileLocation fileLocation2;
        TLRPC.PhotoSize closestPhotoSizeWithSize;
        String str;
        String forwardedName;
        String str2;
        MessageObject messageObject;
        MessageObject messageObject2;
        TLRPC.MessageFwdHeader messageFwdHeader;
        TLRPC.ChatPhoto chatPhoto;
        TLRPC.UserProfilePhoto userProfilePhoto;
        MessageObject messageObject3 = this.currentMessageObject;
        if (messageObject3 != null && !this.hasLinkPreview && MessageObject.getMedia(messageObject3.messageOwner) != null && (MessageObject.getMedia(this.currentMessageObject.messageOwner).webpage instanceof TLRPC.TL_webPage)) {
            return true;
        }
        MessageObject messageObject4 = this.currentMessageObject;
        if (messageObject4 != null && (this.currentUser != null || this.currentChat != null)) {
            int i = this.lastSendState;
            TLRPC.Message message = messageObject4.messageOwner;
            if (i != message.send_state || this.lastDeleteDate != message.destroyTime || this.lastViewsCount != message.views || this.lastRepliesCount != getRepliesCount() || this.lastReactions != this.currentMessageObject.messageOwner.reactions) {
                return true;
            }
            updateCurrentUserAndChat();
            if (this.isAvatarVisible) {
                TLRPC.User user = this.currentUser;
                if (user == null || (userProfilePhoto = user.photo) == null) {
                    TLRPC.Chat chat = this.currentChat;
                    if (chat != null && (chatPhoto = chat.photo) != null) {
                        fileLocation = chatPhoto.photo_small;
                    }
                } else {
                    fileLocation = userProfilePhoto.photo_small;
                }
                if (this.replyTextLayout != null) {
                }
                fileLocation2 = this.currentPhoto;
                if (fileLocation2 != null) {
                }
                if (this.replyNameLayout != null) {
                    closestPhotoSizeWithSize = null;
                    if (this.currentReplyPhoto != null) {
                    }
                    if (isNeedAuthorName()) {
                    }
                    str = this.currentNameString;
                    if (str != null) {
                    }
                    if (this.drawForwardedName) {
                        forwardedName = this.currentMessageObject.getForwardedName();
                        str2 = this.currentForwardNameString;
                        if (str2 != null) {
                        }
                        if (str2 == null) {
                        }
                        if (str2 == null) {
                        }
                    }
                }
            } else {
                fileLocation = null;
                if (this.replyTextLayout != null && (messageObject2 = this.currentMessageObject.replyMessageObject) != null && (!this.isThreadChat || (messageFwdHeader = messageObject2.messageOwner.fwd_from) == null || messageFwdHeader.channel_post == 0)) {
                    return true;
                }
                fileLocation2 = this.currentPhoto;
                if ((fileLocation2 != null && fileLocation != null) || ((fileLocation2 != null && fileLocation == null) || (fileLocation2 != null && (fileLocation2.local_id != fileLocation.local_id || fileLocation2.volume_id != fileLocation.volume_id)))) {
                    return true;
                }
                if (this.replyNameLayout != null || (messageObject = this.currentMessageObject.replyMessageObject) == null || (closestPhotoSizeWithSize = FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, 40)) == null || this.currentMessageObject.replyMessageObject.isAnyKindOfSticker()) {
                    closestPhotoSizeWithSize = null;
                }
                if (this.currentReplyPhoto != null && closestPhotoSizeWithSize != null) {
                    return true;
                }
                String authorName = isNeedAuthorName() ? getAuthorName() : null;
                str = this.currentNameString;
                if ((str != null && authorName != null) || ((str != null && authorName == null) || (str != null && !str.equals(authorName)))) {
                    return true;
                }
                if (this.drawForwardedName && this.currentMessageObject.needDrawForwarded()) {
                    forwardedName = this.currentMessageObject.getForwardedName();
                    str2 = this.currentForwardNameString;
                    if (str2 != null && forwardedName != null) {
                        return true;
                    }
                    if (str2 == null && forwardedName == null) {
                        return true;
                    }
                    return str2 == null && !str2.equals(forwardedName);
                }
            }
        }
        return false;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$checkBotButtonMotionEvent$4(int i) {
        int i2 = this.pressedBotButton;
        if (i == i2) {
            BotButton botButton = (BotButton) this.botButtons.get(i2);
            if (botButton != null) {
                if (botButton.selectorDrawable != null) {
                    botButton.selectorDrawable.setState(StateSet.NOTHING);
                }
                botButton.setPressed(false);
                if (!this.currentMessageObject.scheduled) {
                    if (botButton.buttonCustom != null) {
                        cancelCheckLongPress();
                        ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
                        if (chatMessageCellDelegate != null) {
                            chatMessageCellDelegate.didLongPressCustomBotButton(this, botButton.buttonCustom);
                        }
                    } else if (botButton.button != null) {
                        cancelCheckLongPress();
                        ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
                        if (chatMessageCellDelegate2 != null) {
                            chatMessageCellDelegate2.didLongPressBotButton(this, botButton.button);
                        }
                    }
                }
            }
            this.pressedBotButton = -1;
            invalidateOutbounds();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$checkReplyTouchEvent$5() {
        if (this.replyPressed && !this.replySelectorPressed && this.replySelectorCanBePressed) {
            this.replySelectorPressed = true;
            this.replySelector.setState(new int[]{android.R.attr.state_pressed, android.R.attr.state_enabled});
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$checkReplyTouchEvent$6() {
        this.replySelector.setState(new int[0]);
        invalidate();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$checkSpoilersMotionEvent$0() {
        this.isSpoilerRevealing = false;
        getMessageObject().isSpoilersRevealed = true;
        MessageObject.TextLayoutBlocks textLayoutBlocks = this.captionLayout;
        if (textLayoutBlocks != null) {
            Iterator<MessageObject.TextLayoutBlock> it = textLayoutBlocks.textLayoutBlocks.iterator();
            while (it.hasNext()) {
                it.next().spoilers.clear();
            }
        } else {
            ArrayList<MessageObject.TextLayoutBlock> arrayList = this.currentMessageObject.textLayoutBlocks;
            if (arrayList != null) {
                Iterator<MessageObject.TextLayoutBlock> it2 = arrayList.iterator();
                while (it2.hasNext()) {
                    it2.next().spoilers.clear();
                }
            }
        }
        invalidate();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$checkSpoilersMotionEvent$1() {
        post(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda15
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$checkSpoilersMotionEvent$0();
            }
        });
    }

    /* JADX INFO: Access modifiers changed from: private */
    public static /* synthetic */ void lambda$checkSpoilersMotionEvent$2(ChatMessageCell chatMessageCell) {
        chatMessageCell.getMessageObject().replyMessageObject.isSpoilersRevealed = true;
        chatMessageCell.replySpoilers.clear();
        chatMessageCell.invalidate();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$checkSpoilersMotionEvent$3(final ChatMessageCell chatMessageCell) {
        post(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda16
            @Override // java.lang.Runnable
            public final void run() {
                ChatMessageCell.lambda$checkSpoilersMotionEvent$2(this.f$0);
            }
        });
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$createStatusDrawableAnimator$14(boolean z, ValueAnimator valueAnimator) {
        this.statusDrawableProgress = ((Float) valueAnimator.getAnimatedValue()).floatValue();
        invalidate();
        if (!z || getParent() == null) {
            return;
        }
        ((View) getParent()).invalidate();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$drawContent$12(Canvas canvas) {
        this.radialProgress.draw(canvas);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$onLongPress$11() {
        this.replySelector.setState(new int[0]);
        invalidate();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setMessageContent$7(TLRPC.User user, int i, TLRPC.Chat chat, long j) {
        if (user != null) {
            this.commentAvatarDrawables[i].setInfo(this.currentAccount, user);
            this.commentAvatarImages[i].setForUserOrChat(user, this.commentAvatarDrawables[i]);
            return;
        }
        AvatarDrawable[] avatarDrawableArr = this.commentAvatarDrawables;
        if (chat == null) {
            avatarDrawableArr[i].setInfo(j, "", "");
        } else {
            avatarDrawableArr[i].setInfo(this.currentAccount, chat);
            this.commentAvatarImages[i].setForUserOrChat(chat, this.commentAvatarDrawables[i]);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public static /* synthetic */ int lambda$setMessageContent$8(PollButton pollButton, PollButton pollButton2) {
        if (pollButton.decimal > pollButton2.decimal) {
            return -1;
        }
        if (pollButton.decimal < pollButton2.decimal) {
            return 1;
        }
        if (pollButton.decimal != pollButton2.decimal) {
            return 0;
        }
        if (pollButton.percent > pollButton2.percent) {
            return 1;
        }
        return pollButton.percent < pollButton2.percent ? -1 : 0;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setMessageContent$9() {
        ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
        if (chatMessageCellDelegate != null) {
            chatMessageCellDelegate.didPressSideButton(this);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$startRevealMedia$13(ValueAnimator valueAnimator) {
        this.mediaSpoilerRevealProgress = ((Float) valueAnimator.getAnimatedValue()).floatValue();
        invalidate();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ boolean lambda$updateFlagSecure$10() {
        TLRPC.Message message;
        GroupMedia groupMedia;
        MessageObject messageObject = this.currentMessageObject;
        return (messageObject == null || (message = messageObject.messageOwner) == null || ((messageObject.type != 29 || ((groupMedia = this.groupMedia) != null && groupMedia.hidden)) && !message.noforwards && !messageObject.isVoiceOnce() && !this.currentMessageObject.hasRevealedExtendedMedia())) ? false : true;
    }

    /* JADX WARN: Removed duplicated region for block: B:43:0x01e4  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private int layoutFactCheck(int i) {
        int iDp;
        String displayCountry;
        MessageObject primaryMessageObject = getPrimaryMessageObject();
        this.factCheckHeight = 0;
        this.factCheckWidth = 0;
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        boolean z = ((groupedMessagePosition != null && (groupedMessagePosition.flags & 8) == 0) || primaryMessageObject == null || primaryMessageObject.getFactCheck() == null || primaryMessageObject.isRepostPreview) ? false : true;
        this.hasFactCheck = z;
        if (z) {
            TLRPC.TL_factCheck factCheck = primaryMessageObject.getFactCheck();
            CharSequence factCheckText = primaryMessageObject.getFactCheckText();
            if (factCheck.need_check || factCheckText == null) {
                this.hasFactCheck = false;
                iDp = 0;
            } else {
                this.factCheckHeight += AndroidUtilities.dp(4.66f);
                this.factCheckTitle = new Text(LocaleController.getString(R.string.FactCheck), 14.0f, AndroidUtilities.bold());
                this.factCheckWhat = new Text(LocaleController.getString(R.string.FactCheckWhat), 11.0f);
                this.factCheckHeight += AndroidUtilities.dp(17.33f);
                this.factCheckWidth = (int) (AndroidUtilities.dp(20.0f) + this.factCheckTitle.getCurrentWidth() + this.factCheckWhat.getCurrentWidth() + AndroidUtilities.dp(18.0f));
                try {
                    displayCountry = new Locale("", factCheck.country).getDisplayCountry(LocaleController.getInstance().getCurrentLocale());
                } catch (Exception e) {
                    FileLog.e(e);
                    displayCountry = factCheck.country;
                }
                TextPaint textPaint = Theme.chat_replyTextPaint;
                Layout.Alignment alignment = Layout.Alignment.ALIGN_NORMAL;
                float fDp = AndroidUtilities.dp(1.0f);
                TextUtils.TruncateAt truncateAt = TextUtils.TruncateAt.END;
                this.factCheckTextLayout = StaticLayoutEx.createStaticLayout(factCheckText, textPaint, i, alignment, 1.0f, fDp, false, truncateAt, i, 99999);
                this.factCheckText2Layout = StaticLayoutEx.createStaticLayout(LocaleController.formatString(R.string.FactCheckFooter, displayCountry), Theme.chat_titleLabelTextPaint, i, alignment, 1.0f, AndroidUtilities.dp(1.0f), false, truncateAt, i, 99999);
                this.factCheckTextLayoutLeft = this.factCheckTextLayout.getWidth();
                int iMax = 0;
                for (int i2 = 0; i2 < this.factCheckTextLayout.getLineCount(); i2++) {
                    this.factCheckTextLayoutLeft = (int) Math.min(this.factCheckTextLayoutLeft, this.factCheckTextLayout.getLineLeft(i2));
                    iMax = (int) Math.max(iMax, this.factCheckTextLayout.getLineRight(i2));
                }
                this.factCheckWidth = Math.max(this.factCheckWidth, Math.abs(iMax - this.factCheckTextLayoutLeft) + AndroidUtilities.dp(20.0f));
                this.factCheckText2LayoutLeft = this.factCheckText2Layout.getWidth();
                int iMax2 = 0;
                for (int i3 = 0; i3 < this.factCheckText2Layout.getLineCount(); i3++) {
                    this.factCheckText2LayoutLeft = (int) Math.min(this.factCheckText2LayoutLeft, this.factCheckText2Layout.getLineLeft(i3));
                    iMax2 = (int) Math.max(iMax2, this.factCheckText2Layout.getLineRight(i3));
                }
                this.factCheckWidth = Math.max(this.factCheckWidth, Math.abs(iMax2 - this.factCheckText2LayoutLeft) + AndroidUtilities.dp(20.0f));
                StaticLayout staticLayout = this.factCheckTextLayout;
                int lineBottom = staticLayout.getLineBottom(staticLayout.getLineCount() - 1);
                this.factCheckTextLayoutHeight = lineBottom;
                int iDp2 = lineBottom + AndroidUtilities.dp(12.66f);
                StaticLayout staticLayout2 = this.factCheckText2Layout;
                int lineBottom2 = iDp2 + staticLayout2.getLineBottom(staticLayout2.getLineCount() - 1);
                int textSize = (int) (Theme.chat_replyTextPaint.getTextSize() * 3.5f * 1.4f);
                boolean z2 = this.factCheckTextLayout.getLineCount() > 3 && AndroidUtilities.dp(10.0f) + lineBottom2 > textSize;
                this.factCheckLarge = z2;
                if (z2) {
                    StaticLayout staticLayout3 = this.factCheckText2Layout;
                    boolean z3 = staticLayout3.getLineRight(staticLayout3.getLineCount() - 1) - ((float) this.factCheckText2LayoutLeft) > ((float) (this.factCheckWidth - AndroidUtilities.dp(50.0f)));
                    this.factCheckTextLayoutLastLineEnd = z3;
                    if (this.factCheckLarge && !primaryMessageObject.factCheckExpanded) {
                        if (lineBottom2 < textSize) {
                            this.factCheckLarge = false;
                        }
                        lineBottom2 = Math.min(textSize, lineBottom2);
                    }
                    if (this.factCheckTextLayoutLastLineEnd) {
                        lineBottom2 = (int) (lineBottom2 + (Theme.chat_replyTextPaint.getTextSize() * 1.3f));
                    }
                    int i4 = this.factCheckHeight + lineBottom2;
                    this.factCheckHeight = i4;
                    this.factCheckHeight = i4 + AndroidUtilities.dp(6.66f);
                    iDp = AndroidUtilities.dp(2.0f);
                }
            }
        } else {
            iDp = 0;
        }
        if (this.hasFactCheck) {
            return this.factCheckHeight + iDp;
        }
        return 0;
    }

    private boolean loopStickers() {
        return LiteMode.isEnabled(2);
    }

    /* JADX WARN: Removed duplicated region for block: B:134:0x029b  */
    /* JADX WARN: Removed duplicated region for block: B:40:0x00da  */
    /* JADX WARN: Removed duplicated region for block: B:96:0x01c6  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void measureTime(MessageObject messageObject) {
        String userName;
        String string;
        StringBuilder sb;
        TLRPC.MessageFwdHeader messageFwdHeader;
        int i;
        StringBuilder sb2;
        String str;
        MessageObject.GroupedMessages groupedMessages;
        TLRPC.Chat chat;
        TLRPC.User user;
        String str2;
        int i2 = 0;
        MessageObject primaryMessageObject = getPrimaryMessageObject();
        long fromChatId = messageObject.getFromChatId();
        CharSequence charSequenceEllipsize = "";
        if (!messageObject.scheduled) {
            if (primaryMessageObject.messageOwner.via_business_bot_id != 0) {
                TLRPC.User user2 = MessagesController.getInstance(messageObject.currentAccount).getUser(Long.valueOf(primaryMessageObject.messageOwner.via_business_bot_id));
                userName = user2 == null ? null : UserObject.getUserName(user2);
            } else {
                TLRPC.Message message = messageObject.messageOwner;
                if (message.post_author == null) {
                    TLRPC.MessageFwdHeader messageFwdHeader2 = message.fwd_from;
                    if (messageFwdHeader2 != null && (str2 = messageFwdHeader2.post_author) != null) {
                        userName = str2.replace("\n", "");
                    } else if (messageFwdHeader2 == null || !messageFwdHeader2.imported) {
                        if (!messageObject.isOutOwner() && fromChatId > 0 && messageObject.messageOwner.post && (user = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(fromChatId))) != null) {
                            userName = ContactsController.formatName(user.first_name, user.last_name).replace('\n', ' ');
                        }
                    } else if (messageFwdHeader2.date == message.date) {
                        userName = LocaleController.getString("ImportedMessage", R.string.ImportedMessage);
                    } else {
                        userName = LocaleController.formatImportedDate(messageObject.messageOwner.fwd_from.date) + " " + LocaleController.getString("ImportedMessage", R.string.ImportedMessage);
                    }
                } else if (!this.isMegagroup || messageObject.getFromChatId() != messageObject.getDialogId()) {
                    userName = messageObject.messageOwner.post_author.replace("\n", "");
                }
            }
        }
        if (messageObject.getDialogId() < 0 && (chat = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(-messageObject.getDialogId()))) != null && chat.signature_profiles && (messageObject.messageOwner.flags & 256) != 0) {
            userName = null;
        }
        TLRPC.User user3 = this.currentMessageObject.isFromUser() ? MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(fromChatId)) : null;
        boolean zHasReplies = messageObject.hasReplies();
        if (messageObject.scheduled || messageObject.isLiveLocation() || messageObject.messageOwner.edit_hide || messageObject.getDialogId() == 777000) {
            this.edited = false;
        } else {
            TLRPC.Message message2 = messageObject.messageOwner;
            if (message2.via_bot_id == 0 && message2.via_bot_name == null && (user3 == null || !user3.bot)) {
                if (this.currentPosition == null || (groupedMessages = this.currentMessagesGroup) == null || groupedMessages.messages.isEmpty()) {
                    this.edited = (messageObject.messageOwner.flags & LiteMode.FLAG_CHAT_SCALE) != 0 || messageObject.isEditing();
                } else {
                    this.edited = false;
                    zHasReplies = this.currentMessagesGroup.messages.get(0).hasReplies();
                    if (!this.currentMessagesGroup.messages.get(0).messageOwner.edit_hide) {
                        int size = this.currentMessagesGroup.messages.size();
                        for (int i3 = 0; i3 < size; i3++) {
                            MessageObject messageObject2 = this.currentMessagesGroup.messages.get(i3);
                            if ((messageObject2.messageOwner.flags & LiteMode.FLAG_CHAT_SCALE) != 0 || messageObject2.isEditing()) {
                                this.edited = true;
                                break;
                            }
                        }
                    }
                }
            }
        }
        MessageObject messageObject3 = this.currentMessageObject;
        if (messageObject3.notime || messageObject3.isSponsored() || this.currentMessageObject.isQuickReply()) {
            string = "";
        } else {
            MessageObject messageObject4 = this.currentMessageObject;
            if (!messageObject4.scheduled || messageObject4.messageOwner.date != 2147483646) {
                if (messageObject4.realDate != 0) {
                    sb2 = new StringBuilder();
                    sb2.append(LocaleController.formatSmallDateChat(this.currentMessageObject.realDate));
                    sb2.append(", ");
                    str = LocaleController.getInstance().getFormatterDay().format(this.currentMessageObject.realDate * 1000);
                } else {
                    if (messageObject4.isRepostPreview) {
                        sb2 = new StringBuilder();
                        sb2.append(LocaleController.formatSmallDateChat(messageObject.messageOwner.date));
                        sb2.append(", ");
                    } else if (this.edited) {
                        sb2 = new StringBuilder();
                        sb2.append(LocaleController.getString(R.string.EditedMessage));
                        sb2.append(" ");
                    } else if (!messageObject4.isSaved || (messageFwdHeader = messageObject4.messageOwner.fwd_from) == null || ((i = messageFwdHeader.date) == 0 && messageFwdHeader.saved_date == 0)) {
                        string = LocaleController.getInstance().getFormatterDay().format(messageObject.messageOwner.date * 1000);
                    } else {
                        int i4 = messageFwdHeader.saved_date;
                        if (i4 != 0) {
                            i = i4;
                        }
                        string = LocaleController.formatSeenDate(i);
                    }
                    str = LocaleController.getInstance().getFormatterDay().format(messageObject.messageOwner.date * 1000);
                }
                sb2.append(str);
                string = sb2.toString();
            }
        }
        if (this.currentMessageObject.messageOwner.video_processing_pending) {
            string = LocaleController.formatString(R.string.ScheduledTimeApprox, string);
        }
        if (userName != null) {
            TLRPC.Message message3 = messageObject.messageOwner;
            if (message3.via_business_bot_id != 0) {
                sb = new StringBuilder();
                sb.append(string);
                sb.append(", ");
            } else {
                TLRPC.MessageFwdHeader messageFwdHeader3 = message3.fwd_from;
                if (messageFwdHeader3 == null || !messageFwdHeader3.imported) {
                    sb = new StringBuilder();
                    sb.append(", ");
                } else {
                    sb = new StringBuilder();
                    sb.append(" ");
                }
                sb.append(string);
            }
            string = sb.toString();
        }
        this.currentTimeString = string;
        long starsPrice = this.currentMessageObject.getDialogId() < 0 ? getStarsPrice() : 0L;
        if (starsPrice > 0) {
            CharSequence charSequenceConcat = TextUtils.concat("", AndroidUtilities.formatWholeNumber((int) starsPrice, 0), "  ", this.currentTimeString);
            this.currentTimeString = charSequenceConcat;
            this.currentTimeString = StarsIntroActivity.replaceStars(charSequenceConcat, 0.8f, null, BitmapDescriptorFactory.HUE_RED, AndroidUtilities.dp(-0.33f), 0.94f);
        }
        TextPaint textPaint = Theme.chat_timePaint;
        int iCeil = (int) Math.ceil(textPaint.measureText(r6, 0, this.currentTimeString == null ? 0 : r6.length()));
        this.timeWidth = iCeil;
        this.timeTextWidth = iCeil;
        MessageObject messageObject5 = this.currentMessageObject;
        if ((messageObject5.scheduled && messageObject5.messageOwner.date == 2147483646) || messageObject5.notime) {
            this.timeWidth = iCeil - AndroidUtilities.dp(8.0f);
        }
        TLRPC.Message message4 = messageObject.messageOwner;
        if ((message4.flags & 1024) != 0) {
            this.currentViewsString = String.format("%s", LocaleController.formatShortNumber(Math.max(1, message4.views), null));
            this.viewsTextWidth = (int) Math.ceil(Theme.chat_timePaint.measureText(r3));
            this.timeWidth = (int) (this.timeWidth + this.viewsTextWidth + ((Theme.chat_msgInViewsDrawable.getIntrinsicWidth() * (Theme.chat_timePaint.getTextSize() - AndroidUtilities.dp(2.0f))) / Theme.chat_msgInViewsDrawable.getIntrinsicHeight()) + AndroidUtilities.dp(10.0f));
        }
        if (messageObject.type == 20) {
            int i5 = R.string.PaymentCheckoutPay;
            LocaleController localeController = LocaleController.getInstance();
            TLRPC.MessageMedia messageMedia = messageObject.messageOwner.media;
            String currencyString = localeController.formatCurrencyString(messageMedia.total_amount, messageMedia.currency);
            Locale locale = Locale.ROOT;
            String string2 = LocaleController.formatString(i5, currencyString.toUpperCase(locale));
            if (string2.length() >= 2) {
                string2 = string2.substring(0, 1).toUpperCase(locale) + string2.substring(1).toLowerCase(locale);
            }
            this.currentUnlockString = string2;
            this.unlockTextWidth = (int) Math.ceil(Theme.chat_unlockExtendedMediaTextPaint.measureText(string2));
        }
        if (this.isChat && this.isMegagroup && ((!this.isThreadChat || this.isMonoForum) && zHasReplies)) {
            this.currentRepliesString = String.format("%s", LocaleController.formatShortNumber(getRepliesCount(), null));
            this.repliesTextWidth = (int) Math.ceil(Theme.chat_timePaint.measureText(r3));
            this.timeWidth = (int) (this.timeWidth + this.repliesTextWidth + ((Theme.chat_msgInRepliesDrawable.getIntrinsicWidth() * (Theme.chat_timePaint.getTextSize() - AndroidUtilities.dp(2.0f))) / Theme.chat_msgInRepliesDrawable.getIntrinsicHeight()) + AndroidUtilities.dp(10.0f));
        } else {
            this.currentRepliesString = null;
        }
        if (this.isPinned) {
            this.timeWidth += Theme.chat_msgInPinnedDrawable.getIntrinsicWidth() + AndroidUtilities.dp(3.0f);
        }
        if (messageObject.scheduled && (messageObject.isSendError() || (messageObject.isSending() && messageObject.messageOwner.peer_id.channel_id != 0 && !messageObject.isSupergroup()))) {
            this.timeWidth += AndroidUtilities.dp(18.0f);
        }
        if (this.currentMessageObject.shouldDrawReactions()) {
            ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
            if (reactionsLayoutInBubble.isSmall) {
                reactionsLayoutInBubble.measure(Integer.MAX_VALUE, 3);
                this.timeWidth += this.reactionsLayoutInBubble.width;
            }
        }
        TLRPC.TL_availableEffect effect = getEffect();
        if (this.effectId != (effect != null ? effect.id : 0L)) {
            if (this.effectDrawable == null) {
                ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
                this.effectDrawable = new AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable(this, chatMessageCellDelegate == null || !chatMessageCellDelegate.canDrawOutboundsContent(), AndroidUtilities.dp(14.0f), 23);
            }
            boolean z = this.effectMessageId == this.currentMessageObject.getId();
            if (effect == null) {
                this.effectDrawable.set((Drawable) null, z);
            } else if (!TextUtils.isEmpty(effect.emoticon)) {
                this.effectDrawable.set(Emoji.getEmojiDrawable(effect.emoticon), z);
            } else if ((effect.flags & 1) != 0) {
                this.effectDrawable.set(effect.static_icon_id, z);
            }
            this.effectId = effect != null ? effect.id : 0L;
            this.effectMessageId = this.currentMessageObject.getId();
        }
        if (this.effectId != 0 && !this.currentMessageObject.notime) {
            this.timeWidth += AndroidUtilities.dp(18.0f);
        }
        if (userName == null) {
            this.signWidth = 0;
            return;
        }
        if (this.availableTimeWidth == 0) {
            this.availableTimeWidth = AndroidUtilities.dp(1000.0f);
        }
        int iDp = this.availableTimeWidth - this.timeWidth;
        if (messageObject.isOutOwner()) {
            iDp -= AndroidUtilities.dp(messageObject.type == 5 ? 20.0f : 96.0f);
        }
        CharSequence charSequenceReplaceEmoji = Emoji.replaceEmoji(userName, Theme.chat_timePaint.getFontMetricsInt(), false);
        int iCeil2 = (int) Math.ceil(Theme.chat_timePaint.measureText(charSequenceReplaceEmoji, 0, charSequenceReplaceEmoji.length()));
        this.signWidth = Math.min(iCeil2, iDp);
        if (iCeil2 <= iDp) {
            charSequenceEllipsize = charSequenceReplaceEmoji;
            i2 = iCeil2;
        } else if (iDp > 0) {
            charSequenceEllipsize = TextUtils.ellipsize(charSequenceReplaceEmoji, Theme.chat_timePaint, iDp, TextUtils.TruncateAt.END);
            i2 = iDp;
        }
        SpannableStringBuilder spannableStringBuilder = new SpannableStringBuilder();
        if (messageObject.messageOwner.via_business_bot_id != 0) {
            spannableStringBuilder.append(this.currentTimeString);
            spannableStringBuilder.append(charSequenceEllipsize);
        } else {
            spannableStringBuilder.append(charSequenceEllipsize);
            spannableStringBuilder.append(this.currentTimeString);
        }
        this.currentTimeString = spannableStringBuilder;
        this.timeTextWidth += i2;
        this.timeWidth += i2;
    }

    private float mediaAbove() {
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateMediaAbove) {
            boolean z = this.captionAbove;
            return AndroidUtilities.lerp(z ? BitmapDescriptorFactory.HUE_RED : 1.0f, z ? 1.0f : BitmapDescriptorFactory.HUE_RED, transitionParams.animateChangeProgress);
        }
        if (this.captionAbove) {
            return 1.0f;
        }
        return BitmapDescriptorFactory.HUE_RED;
    }

    private LinkPath obtainNewUrlPath() {
        LinkPath linkPath;
        if (this.urlPathCache.isEmpty()) {
            linkPath = new LinkPath(true);
        } else {
            linkPath = (LinkPath) this.urlPathCache.get(0);
            this.urlPathCache.remove(0);
        }
        linkPath.reset();
        this.urlPathSelection.add(linkPath);
        return linkPath;
    }

    private void resetCodeSelectors() {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && messageObject.textLayoutBlocks != null) {
            for (int i = 0; i < this.currentMessageObject.textLayoutBlocks.size(); i++) {
                MessageObject.TextLayoutBlock textLayoutBlock = this.currentMessageObject.textLayoutBlocks.get(i);
                Drawable drawable = textLayoutBlock.copySelector;
                if (drawable != null) {
                    drawable.setCallback(this);
                    textLayoutBlock.copySelector.setState(StateSet.NOTHING);
                }
            }
        }
        if (this.captionLayout != null) {
            for (int i2 = 0; i2 < this.captionLayout.textLayoutBlocks.size(); i2++) {
                MessageObject.TextLayoutBlock textLayoutBlock2 = this.captionLayout.textLayoutBlocks.get(i2);
                Drawable drawable2 = textLayoutBlock2.copySelector;
                if (drawable2 != null) {
                    drawable2.setCallback(this);
                    textLayoutBlock2.copySelector.setState(StateSet.NOTHING);
                }
            }
        }
    }

    private void resetContactButtonsPressedState() {
        Drawable drawable;
        this.contactPressed = false;
        ButtonBounce buttonBounce = this.contactBounce;
        if (buttonBounce != null) {
            buttonBounce.setPressed(false);
        }
        if (Build.VERSION.SDK_INT >= 21 && (drawable = this.selectorDrawable[0]) != null) {
            drawable.setState(StateSet.NOTHING);
        }
        if (this.contactButtons != null) {
            for (int i = 0; i < this.contactButtons.size(); i++) {
                InstantViewButton instantViewButton = (InstantViewButton) this.contactButtons.get(i);
                if (instantViewButton.buttonBounce != null) {
                    instantViewButton.buttonBounce.setPressed(false);
                }
                if (instantViewButton.selectorDrawable != null) {
                    instantViewButton.selectorDrawable.setState(StateSet.NOTHING);
                }
            }
        }
    }

    private void resetUrlPaths() {
        if (this.quoteHighlight != null) {
            this.quoteHighlight = null;
        }
        if (this.urlPathSelection.isEmpty()) {
            return;
        }
        this.urlPathCache.addAll(this.urlPathSelection);
        this.urlPathSelection.clear();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void sendAccessibilityEventForVirtualView(int i, int i2) {
        sendAccessibilityEventForVirtualView(i, i2, null);
    }

    private void sendAccessibilityEventForVirtualView(int i, int i2, String str) {
        if (((AccessibilityManager) getContext().getSystemService("accessibility")).isTouchExplorationEnabled()) {
            AccessibilityEvent accessibilityEventObtain = AccessibilityEvent.obtain(i2);
            accessibilityEventObtain.setPackageName(getContext().getPackageName());
            accessibilityEventObtain.setSource(this, i);
            if (str != null) {
                accessibilityEventObtain.getText().add(str);
            }
            if (getParent() != null) {
                getParent().requestSendAccessibilityEvent(this, accessibilityEventObtain);
            }
        }
    }

    private void setInstantButtonPressed(boolean z) {
        if (this.instantButtonBounce == null) {
            this.instantButtonBounce = new ButtonBounce(this);
        }
        ButtonBounce buttonBounce = this.instantButtonBounce;
        this.instantButtonPressed = z;
        buttonBounce.setPressed(z);
    }

    /*  JADX ERROR: JadxRuntimeException in pass: ConstructorVisitor
        jadx.core.utils.exceptions.JadxRuntimeException: Can't remove SSA var: r2v589 ??, still in use, count: 1, list:
          (r2v589 ?? I:android.text.StaticLayout) from 0x09f5: IPUT 
          (r2v589 ?? I:android.text.StaticLayout)
          (r85v0 'this' ?? I:org.telegram.ui.Cells.ChatMessageCell A[IMMUTABLE_TYPE, THIS])
         org.telegram.ui.Cells.ChatMessageCell.commentLayout android.text.StaticLayout
        	at jadx.core.utils.InsnRemover.removeSsaVar(InsnRemover.java:162)
        	at jadx.core.utils.InsnRemover.unbindResult(InsnRemover.java:127)
        	at jadx.core.utils.InsnRemover.lambda$unbindInsns$1(InsnRemover.java:99)
        	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
        	at jadx.core.utils.InsnRemover.unbindInsns(InsnRemover.java:98)
        	at jadx.core.utils.InsnRemover.perform(InsnRemover.java:73)
        	at jadx.core.dex.visitors.ConstructorVisitor.replaceInvoke(ConstructorVisitor.java:59)
        	at jadx.core.dex.visitors.ConstructorVisitor.visit(ConstructorVisitor.java:42)
        */
    private void setMessageContent(
    /*  JADX ERROR: JadxRuntimeException in pass: ConstructorVisitor
        jadx.core.utils.exceptions.JadxRuntimeException: Can't remove SSA var: r2v589 ??, still in use, count: 1, list:
          (r2v589 ?? I:android.text.StaticLayout) from 0x09f5: IPUT 
          (r2v589 ?? I:android.text.StaticLayout)
          (r85v0 'this' ?? I:org.telegram.ui.Cells.ChatMessageCell A[IMMUTABLE_TYPE, THIS])
         org.telegram.ui.Cells.ChatMessageCell.commentLayout android.text.StaticLayout
        	at jadx.core.utils.InsnRemover.removeSsaVar(InsnRemover.java:162)
        	at jadx.core.utils.InsnRemover.unbindResult(InsnRemover.java:127)
        	at jadx.core.utils.InsnRemover.lambda$unbindInsns$1(InsnRemover.java:99)
        	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
        	at jadx.core.utils.InsnRemover.unbindInsns(InsnRemover.java:98)
        	at jadx.core.utils.InsnRemover.perform(InsnRemover.java:73)
        	at jadx.core.dex.visitors.ConstructorVisitor.replaceInvoke(ConstructorVisitor.java:59)
        */
    /*  JADX ERROR: Method generation error
        jadx.core.utils.exceptions.JadxRuntimeException: Code variable not set in r86v0 ??
        	at jadx.core.dex.instructions.args.SSAVar.getCodeVar(SSAVar.java:236)
        	at jadx.core.codegen.MethodGen.addMethodArguments(MethodGen.java:224)
        	at jadx.core.codegen.MethodGen.addDefinition(MethodGen.java:169)
        	at jadx.core.codegen.ClassGen.addMethodCode(ClassGen.java:405)
        	at jadx.core.codegen.ClassGen.addMethod(ClassGen.java:335)
        	at jadx.core.codegen.ClassGen.lambda$addInnerClsAndMethods$3(ClassGen.java:301)
        	at java.base/java.util.stream.ForEachOps$ForEachOp$OfRef.accept(ForEachOps.java:183)
        	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
        	at java.base/java.util.stream.SortedOps$RefSortingSink.end(SortedOps.java:395)
        	at java.base/java.util.stream.Sink$ChainedReference.end(Sink.java:258)
        */

    /* JADX WARN: Can't wrap try/catch for region: R(32:397|(3:407|(1:(1:414))(1:411)|412)|415|(1:420)(1:419)|421|(4:423|(1:426)|427|(3:431|(1:436)(1:435)|437))(2:438|(1:440))|441|(1:448)(1:447)|449|(1:454)(1:453)|455|(1:460)(1:459)|(1:465)|466|(1:472)(1:470)|471|473|(24:490|(9:510|574|(1:576)(1:577)|578|(3:580|(3:582|(3:584|(1:586)(1:587)|588)(1:589)|590)(1:591)|(1:593)(1:594))(1:595)|596|(3:627|(13:642|(1:644)(1:646)|645|647|(1:649)(1:651)|650|652|(1:654)(1:656)|655|657|(1:659)(1:660)|661|626)|662)(4:602|(1:604)(3:606|(1:608)|(2:610|662)(10:611|(1:613)(1:615)|614|616|(1:618)(1:620)|619|621|(1:623)(1:624)|625|626))|605|(0)(0))|663|(2:665|(6:673|(6:675|671|672|(1:728)|729|(2:751|(2:813|(1:815))(1:(2:766|(4:771|(1:773)(2:776|(1:778)(2:779|(2:794|(1:812)(8:800|(1:802)|803|(1:805)|806|(1:808)|809|(2:811|775)))(6:783|(1:785)|786|(1:788)|789|(2:793|775))))|774|775)(1:745))(1:765)))(2:737|(4:739|(2:741|(1:743))|744|745)(2:746|(0)(1:750))))|726|(0)|729|(3:731|751|(5:753|755|757|813|(0))(0))(0))(7:669|670|671|672|(0)|729|(0)(0)))(2:676|(2:681|(2:683|(2:685|(1:687)(6:690|671|672|(0)|729|(0)(0)))(7:691|670|671|672|(0)|729|(0)(0)))(2:692|(5:695|(1:(3:703|(1:705)(1:706)|(2:708|(2:710|(2:712|672))(2:713|(3:724|725|672))))(1:726))(1:701)|(0)|729|(0)(0))(4:672|(0)|729|(0)(0))))(0)))(4:511|(5:513|(1:515)(2:517|(1:519)(4:520|(1:522)|523|(1:525)))|516|523|(0))|526|(16:534|(1:536)|537|(2:539|(1:541)(13:543|547|549|(1:551)(1:552)|553|(1:555)(1:556)|557|(1:559)(1:560)|561|(1:565)|566|(1:572)(1:571)|573))(2:544|(1:546)(11:548|549|(0)(0)|553|(0)(0)|557|(0)(0)|561|(2:563|565)|566|(3:568|572|573)(0)))|542|547|549|(0)(0)|553|(0)(0)|557|(0)(0)|561|(0)|566|(0)(0))(1:533))|1009|816|819|(1:821)|822|(1:824)(1:825)|999|826|(1:828)(1:831)|832|(2:834|(1:836))|837|(1:848)(3:842|(1:844)(1:845)|846)|847|849|1007|852|(1:854)(1:857)|858|(8:860|(3:862|(2:864|1013)(1:1014)|865)|1012|866|(1:870)|871|(1:880)(2:(1:878)|879)|(14:882|(2:884|886)|885|887|(4:889|(1:893)|894|(2:896|(3:898|(1:900)(1:901)|902)(0)))(1:903)|904|(1:914)|915|(4:917|(4:920|(1:1017)(4:922|(1:924)(1:925)|(1:927)(1:928)|(2:930|1016)(1:1018))|931|918)|1015|932)(1:933)|934|(1:936)|937|(1:945)(1:944)|946)(6:886|885|887|(0)(0)|904|(9:908|910|914|915|(0)(0)|934|(0)|937|(5:939|941|943|945|946)(0))(8:906|914|915|(0)(0)|934|(0)|937|(0)(0))))(1:947)|948|(1:950))(3:477|(3:(1:486)(1:488)|487|489)(1:482)|483)|484|1009|816|819|(0)|822|(0)(0)|999|826|(0)(0)|832|(0)|837|(10:848|847|849|1007|852|(0)(0)|858|(0)(0)|948|(0))(0)) */
    /* JADX WARN: Can't wrap try/catch for region: R(50:35|37|(1:56)(1:55)|57|(1:59)|60|(1:62)|63|(1:73)(2:69|(40:71|104|(3:(1:107)|108|(1:110)(1:111))|(1:113)(1:115)|114|116|(1:118)(1:(1:120)(1:121))|122|(1:124)(1:125)|126|1003|127|130|(1:132)(1:133)|134|(8:136|(1:138)|139|(1:141)(2:143|(1:145)(1:146))|142|147|(3:149|(1:151)|152)(1:153)|154)(1:156)|155|1011|157|(3:159|(1:161)|164)(1:166)|165|167|(1:169)|170|(1:172)|173|(1:175)|176|(4:178|(1:180)(1:182)|181|183)(1:184)|187|(2:191|(1:193))|194|(2:196|(1:198)(2:199|(1:201)(2:202|(1:204))))|205|(2:209|(1:211))|212|(2:214|(1:216)(1:217))(1:218)|219|(1:221)|222)(1:72))|74|(2:81|(4:93|(1:95)(1:96)|97|(3:99|(1:101)|102)(1:103))(0))(1:80)|104|(0)|(0)(0)|114|116|(0)(0)|122|(0)(0)|126|1003|127|130|(0)(0)|134|(0)(0)|155|1011|157|(0)(0)|165|167|(0)|170|(0)|173|(0)|176|(0)(0)|187|(3:189|191|(0))|194|(0)|205|(3:207|209|(0))|212|(0)(0)|219|(0)|222) */
    /* JADX WARN: Code restructure failed: missing block: B:162:0x0472, code lost:
    
        r0 = move-exception;
     */
    /* JADX WARN: Code restructure failed: missing block: B:186:0x051b, code lost:
    
        org.telegram.messenger.FileLog.e(r0);
     */
    /* JADX WARN: Code restructure failed: missing block: B:688:0x0f49, code lost:
    
        if (r4 != null) goto L725;
     */
    /* JADX WARN: Code restructure failed: missing block: B:829:0x123f, code lost:
    
        r0 = move-exception;
     */
    /* JADX WARN: Code restructure failed: missing block: B:851:0x12b5, code lost:
    
        org.telegram.messenger.FileLog.e(r0);
     */
    /* JADX WARN: Multi-variable type inference failed */
    /* JADX WARN: Removed duplicated region for block: B:103:0x0225  */
    /* JADX WARN: Removed duplicated region for block: B:106:0x022e  */
    /* JADX WARN: Removed duplicated region for block: B:113:0x025b  */
    /* JADX WARN: Removed duplicated region for block: B:115:0x0281  */
    /* JADX WARN: Removed duplicated region for block: B:118:0x028f  */
    /* JADX WARN: Removed duplicated region for block: B:119:0x0292  */
    /* JADX WARN: Removed duplicated region for block: B:124:0x02b1  */
    /* JADX WARN: Removed duplicated region for block: B:125:0x02b4  */
    /* JADX WARN: Removed duplicated region for block: B:132:0x02e5  */
    /* JADX WARN: Removed duplicated region for block: B:133:0x02e8  */
    /* JADX WARN: Removed duplicated region for block: B:136:0x02f3  */
    /* JADX WARN: Removed duplicated region for block: B:156:0x041e  */
    /* JADX WARN: Removed duplicated region for block: B:159:0x0451 A[Catch: Exception -> 0x0472, TryCatch #6 {Exception -> 0x0472, blocks: (B:157:0x042b, B:159:0x0451, B:161:0x0468, B:164:0x0475, B:165:0x047c, B:167:0x0486, B:169:0x048a, B:170:0x0496, B:172:0x049a, B:173:0x04a3, B:175:0x04ab, B:176:0x04b4, B:178:0x04bb, B:180:0x04dc, B:181:0x04eb, B:183:0x050b, B:182:0x04ed, B:184:0x0515, B:166:0x047f), top: B:1011:0x042b }] */
    /* JADX WARN: Removed duplicated region for block: B:166:0x047f A[Catch: Exception -> 0x0472, TryCatch #6 {Exception -> 0x0472, blocks: (B:157:0x042b, B:159:0x0451, B:161:0x0468, B:164:0x0475, B:165:0x047c, B:167:0x0486, B:169:0x048a, B:170:0x0496, B:172:0x049a, B:173:0x04a3, B:175:0x04ab, B:176:0x04b4, B:178:0x04bb, B:180:0x04dc, B:181:0x04eb, B:183:0x050b, B:182:0x04ed, B:184:0x0515, B:166:0x047f), top: B:1011:0x042b }] */
    /* JADX WARN: Removed duplicated region for block: B:169:0x048a A[Catch: Exception -> 0x0472, TryCatch #6 {Exception -> 0x0472, blocks: (B:157:0x042b, B:159:0x0451, B:161:0x0468, B:164:0x0475, B:165:0x047c, B:167:0x0486, B:169:0x048a, B:170:0x0496, B:172:0x049a, B:173:0x04a3, B:175:0x04ab, B:176:0x04b4, B:178:0x04bb, B:180:0x04dc, B:181:0x04eb, B:183:0x050b, B:182:0x04ed, B:184:0x0515, B:166:0x047f), top: B:1011:0x042b }] */
    /* JADX WARN: Removed duplicated region for block: B:172:0x049a A[Catch: Exception -> 0x0472, TryCatch #6 {Exception -> 0x0472, blocks: (B:157:0x042b, B:159:0x0451, B:161:0x0468, B:164:0x0475, B:165:0x047c, B:167:0x0486, B:169:0x048a, B:170:0x0496, B:172:0x049a, B:173:0x04a3, B:175:0x04ab, B:176:0x04b4, B:178:0x04bb, B:180:0x04dc, B:181:0x04eb, B:183:0x050b, B:182:0x04ed, B:184:0x0515, B:166:0x047f), top: B:1011:0x042b }] */
    /* JADX WARN: Removed duplicated region for block: B:175:0x04ab A[Catch: Exception -> 0x0472, TryCatch #6 {Exception -> 0x0472, blocks: (B:157:0x042b, B:159:0x0451, B:161:0x0468, B:164:0x0475, B:165:0x047c, B:167:0x0486, B:169:0x048a, B:170:0x0496, B:172:0x049a, B:173:0x04a3, B:175:0x04ab, B:176:0x04b4, B:178:0x04bb, B:180:0x04dc, B:181:0x04eb, B:183:0x050b, B:182:0x04ed, B:184:0x0515, B:166:0x047f), top: B:1011:0x042b }] */
    /* JADX WARN: Removed duplicated region for block: B:178:0x04bb A[Catch: Exception -> 0x0472, TryCatch #6 {Exception -> 0x0472, blocks: (B:157:0x042b, B:159:0x0451, B:161:0x0468, B:164:0x0475, B:165:0x047c, B:167:0x0486, B:169:0x048a, B:170:0x0496, B:172:0x049a, B:173:0x04a3, B:175:0x04ab, B:176:0x04b4, B:178:0x04bb, B:180:0x04dc, B:181:0x04eb, B:183:0x050b, B:182:0x04ed, B:184:0x0515, B:166:0x047f), top: B:1011:0x042b }] */
    /* JADX WARN: Removed duplicated region for block: B:184:0x0515 A[Catch: Exception -> 0x0472, TRY_LEAVE, TryCatch #6 {Exception -> 0x0472, blocks: (B:157:0x042b, B:159:0x0451, B:161:0x0468, B:164:0x0475, B:165:0x047c, B:167:0x0486, B:169:0x048a, B:170:0x0496, B:172:0x049a, B:173:0x04a3, B:175:0x04ab, B:176:0x04b4, B:178:0x04bb, B:180:0x04dc, B:181:0x04eb, B:183:0x050b, B:182:0x04ed, B:184:0x0515, B:166:0x047f), top: B:1011:0x042b }] */
    /* JADX WARN: Removed duplicated region for block: B:193:0x0536  */
    /* JADX WARN: Removed duplicated region for block: B:196:0x053d  */
    /* JADX WARN: Removed duplicated region for block: B:211:0x057b  */
    /* JADX WARN: Removed duplicated region for block: B:214:0x0582  */
    /* JADX WARN: Removed duplicated region for block: B:218:0x0594  */
    /* JADX WARN: Removed duplicated region for block: B:221:0x059d  */
    /* JADX WARN: Removed duplicated region for block: B:23:0x0101  */
    /* JADX WARN: Removed duplicated region for block: B:247:0x0631  */
    /* JADX WARN: Removed duplicated region for block: B:300:0x07a7  */
    /* JADX WARN: Removed duplicated region for block: B:303:0x07b7  */
    /* JADX WARN: Removed duplicated region for block: B:304:0x07ba  */
    /* JADX WARN: Removed duplicated region for block: B:307:0x07d9  */
    /* JADX WARN: Removed duplicated region for block: B:308:0x07dd  */
    /* JADX WARN: Removed duplicated region for block: B:311:0x07f4  */
    /* JADX WARN: Removed duplicated region for block: B:312:0x083f  */
    /* JADX WARN: Removed duplicated region for block: B:314:0x0849  */
    /* JADX WARN: Removed duplicated region for block: B:317:0x0856  */
    /* JADX WARN: Removed duplicated region for block: B:324:0x087a  */
    /* JADX WARN: Removed duplicated region for block: B:525:0x0c06  */
    /* JADX WARN: Removed duplicated region for block: B:551:0x0c92  */
    /* JADX WARN: Removed duplicated region for block: B:552:0x0c95  */
    /* JADX WARN: Removed duplicated region for block: B:555:0x0ca4  */
    /* JADX WARN: Removed duplicated region for block: B:556:0x0ca7  */
    /* JADX WARN: Removed duplicated region for block: B:559:0x0cb7  */
    /* JADX WARN: Removed duplicated region for block: B:560:0x0cbb  */
    /* JADX WARN: Removed duplicated region for block: B:563:0x0cd1  */
    /* JADX WARN: Removed duplicated region for block: B:568:0x0ce4  */
    /* JADX WARN: Removed duplicated region for block: B:572:0x0cef  */
    /* JADX WARN: Removed duplicated region for block: B:610:0x0dbf  */
    /* JADX WARN: Removed duplicated region for block: B:611:0x0dc6  */
    /* JADX WARN: Removed duplicated region for block: B:701:0x0f80  */
    /* JADX WARN: Removed duplicated region for block: B:728:0x0ffa  */
    /* JADX WARN: Removed duplicated region for block: B:731:0x1006  */
    /* JADX WARN: Removed duplicated region for block: B:751:0x108e  */
    /* JADX WARN: Removed duplicated region for block: B:812:0x11b5  */
    /* JADX WARN: Removed duplicated region for block: B:813:0x11b7  */
    /* JADX WARN: Removed duplicated region for block: B:815:0x11db  */
    /* JADX WARN: Removed duplicated region for block: B:821:0x120a  */
    /* JADX WARN: Removed duplicated region for block: B:824:0x1214  */
    /* JADX WARN: Removed duplicated region for block: B:825:0x1217  */
    /* JADX WARN: Removed duplicated region for block: B:828:0x122d A[Catch: Exception -> 0x123f, TryCatch #0 {Exception -> 0x123f, blocks: (B:826:0x1225, B:828:0x122d, B:832:0x1243, B:834:0x1248, B:836:0x1267, B:837:0x1288, B:840:0x128e, B:842:0x1292, B:846:0x129b, B:847:0x12a9, B:849:0x12b2, B:848:0x12ab), top: B:999:0x1225 }] */
    /* JADX WARN: Removed duplicated region for block: B:831:0x1242  */
    /* JADX WARN: Removed duplicated region for block: B:834:0x1248 A[Catch: Exception -> 0x123f, TryCatch #0 {Exception -> 0x123f, blocks: (B:826:0x1225, B:828:0x122d, B:832:0x1243, B:834:0x1248, B:836:0x1267, B:837:0x1288, B:840:0x128e, B:842:0x1292, B:846:0x129b, B:847:0x12a9, B:849:0x12b2, B:848:0x12ab), top: B:999:0x1225 }] */
    /* JADX WARN: Removed duplicated region for block: B:848:0x12ab A[Catch: Exception -> 0x123f, TryCatch #0 {Exception -> 0x123f, blocks: (B:826:0x1225, B:828:0x122d, B:832:0x1243, B:834:0x1248, B:836:0x1267, B:837:0x1288, B:840:0x128e, B:842:0x1292, B:846:0x129b, B:847:0x12a9, B:849:0x12b2, B:848:0x12ab), top: B:999:0x1225 }] */
    /* JADX WARN: Removed duplicated region for block: B:854:0x12c0 A[Catch: Exception -> 0x12c7, TryCatch #4 {Exception -> 0x12c7, blocks: (B:852:0x12b8, B:854:0x12c0, B:858:0x12cb, B:860:0x12d0, B:862:0x12e7, B:864:0x12f3, B:865:0x12f7, B:866:0x12fa, B:868:0x1304, B:870:0x130c, B:871:0x1311, B:873:0x1315, B:875:0x1319, B:879:0x1321, B:882:0x1357, B:887:0x1366, B:889:0x136e, B:891:0x1387, B:893:0x138d, B:894:0x1397, B:896:0x13a3, B:898:0x13a9, B:902:0x13ba, B:904:0x13de, B:906:0x13ea, B:914:0x13ff, B:915:0x141d, B:917:0x1425, B:918:0x142f, B:920:0x1437, B:922:0x1455, B:930:0x1463, B:931:0x1469, B:932:0x1474, B:934:0x1481, B:936:0x1485, B:937:0x148e, B:939:0x1497, B:941:0x149f, B:946:0x14c6, B:948:0x14d7, B:950:0x14dd, B:945:0x14af, B:908:0x13ee, B:910:0x13f4, B:912:0x13f9, B:903:0x13bd, B:886:0x135e), top: B:1007:0x12b8 }] */
    /* JADX WARN: Removed duplicated region for block: B:857:0x12ca  */
    /* JADX WARN: Removed duplicated region for block: B:860:0x12d0 A[Catch: Exception -> 0x12c7, TryCatch #4 {Exception -> 0x12c7, blocks: (B:852:0x12b8, B:854:0x12c0, B:858:0x12cb, B:860:0x12d0, B:862:0x12e7, B:864:0x12f3, B:865:0x12f7, B:866:0x12fa, B:868:0x1304, B:870:0x130c, B:871:0x1311, B:873:0x1315, B:875:0x1319, B:879:0x1321, B:882:0x1357, B:887:0x1366, B:889:0x136e, B:891:0x1387, B:893:0x138d, B:894:0x1397, B:896:0x13a3, B:898:0x13a9, B:902:0x13ba, B:904:0x13de, B:906:0x13ea, B:914:0x13ff, B:915:0x141d, B:917:0x1425, B:918:0x142f, B:920:0x1437, B:922:0x1455, B:930:0x1463, B:931:0x1469, B:932:0x1474, B:934:0x1481, B:936:0x1485, B:937:0x148e, B:939:0x1497, B:941:0x149f, B:946:0x14c6, B:948:0x14d7, B:950:0x14dd, B:945:0x14af, B:908:0x13ee, B:910:0x13f4, B:912:0x13f9, B:903:0x13bd, B:886:0x135e), top: B:1007:0x12b8 }] */
    /* JADX WARN: Removed duplicated region for block: B:889:0x136e A[Catch: Exception -> 0x12c7, TryCatch #4 {Exception -> 0x12c7, blocks: (B:852:0x12b8, B:854:0x12c0, B:858:0x12cb, B:860:0x12d0, B:862:0x12e7, B:864:0x12f3, B:865:0x12f7, B:866:0x12fa, B:868:0x1304, B:870:0x130c, B:871:0x1311, B:873:0x1315, B:875:0x1319, B:879:0x1321, B:882:0x1357, B:887:0x1366, B:889:0x136e, B:891:0x1387, B:893:0x138d, B:894:0x1397, B:896:0x13a3, B:898:0x13a9, B:902:0x13ba, B:904:0x13de, B:906:0x13ea, B:914:0x13ff, B:915:0x141d, B:917:0x1425, B:918:0x142f, B:920:0x1437, B:922:0x1455, B:930:0x1463, B:931:0x1469, B:932:0x1474, B:934:0x1481, B:936:0x1485, B:937:0x148e, B:939:0x1497, B:941:0x149f, B:946:0x14c6, B:948:0x14d7, B:950:0x14dd, B:945:0x14af, B:908:0x13ee, B:910:0x13f4, B:912:0x13f9, B:903:0x13bd, B:886:0x135e), top: B:1007:0x12b8 }] */
    /* JADX WARN: Removed duplicated region for block: B:901:0x13b9  */
    /* JADX WARN: Removed duplicated region for block: B:903:0x13bd A[Catch: Exception -> 0x12c7, TryCatch #4 {Exception -> 0x12c7, blocks: (B:852:0x12b8, B:854:0x12c0, B:858:0x12cb, B:860:0x12d0, B:862:0x12e7, B:864:0x12f3, B:865:0x12f7, B:866:0x12fa, B:868:0x1304, B:870:0x130c, B:871:0x1311, B:873:0x1315, B:875:0x1319, B:879:0x1321, B:882:0x1357, B:887:0x1366, B:889:0x136e, B:891:0x1387, B:893:0x138d, B:894:0x1397, B:896:0x13a3, B:898:0x13a9, B:902:0x13ba, B:904:0x13de, B:906:0x13ea, B:914:0x13ff, B:915:0x141d, B:917:0x1425, B:918:0x142f, B:920:0x1437, B:922:0x1455, B:930:0x1463, B:931:0x1469, B:932:0x1474, B:934:0x1481, B:936:0x1485, B:937:0x148e, B:939:0x1497, B:941:0x149f, B:946:0x14c6, B:948:0x14d7, B:950:0x14dd, B:945:0x14af, B:908:0x13ee, B:910:0x13f4, B:912:0x13f9, B:903:0x13bd, B:886:0x135e), top: B:1007:0x12b8 }] */
    /* JADX WARN: Removed duplicated region for block: B:917:0x1425 A[Catch: Exception -> 0x12c7, TryCatch #4 {Exception -> 0x12c7, blocks: (B:852:0x12b8, B:854:0x12c0, B:858:0x12cb, B:860:0x12d0, B:862:0x12e7, B:864:0x12f3, B:865:0x12f7, B:866:0x12fa, B:868:0x1304, B:870:0x130c, B:871:0x1311, B:873:0x1315, B:875:0x1319, B:879:0x1321, B:882:0x1357, B:887:0x1366, B:889:0x136e, B:891:0x1387, B:893:0x138d, B:894:0x1397, B:896:0x13a3, B:898:0x13a9, B:902:0x13ba, B:904:0x13de, B:906:0x13ea, B:914:0x13ff, B:915:0x141d, B:917:0x1425, B:918:0x142f, B:920:0x1437, B:922:0x1455, B:930:0x1463, B:931:0x1469, B:932:0x1474, B:934:0x1481, B:936:0x1485, B:937:0x148e, B:939:0x1497, B:941:0x149f, B:946:0x14c6, B:948:0x14d7, B:950:0x14dd, B:945:0x14af, B:908:0x13ee, B:910:0x13f4, B:912:0x13f9, B:903:0x13bd, B:886:0x135e), top: B:1007:0x12b8 }] */
    /* JADX WARN: Removed duplicated region for block: B:933:0x1480  */
    /* JADX WARN: Removed duplicated region for block: B:936:0x1485 A[Catch: Exception -> 0x12c7, TryCatch #4 {Exception -> 0x12c7, blocks: (B:852:0x12b8, B:854:0x12c0, B:858:0x12cb, B:860:0x12d0, B:862:0x12e7, B:864:0x12f3, B:865:0x12f7, B:866:0x12fa, B:868:0x1304, B:870:0x130c, B:871:0x1311, B:873:0x1315, B:875:0x1319, B:879:0x1321, B:882:0x1357, B:887:0x1366, B:889:0x136e, B:891:0x1387, B:893:0x138d, B:894:0x1397, B:896:0x13a3, B:898:0x13a9, B:902:0x13ba, B:904:0x13de, B:906:0x13ea, B:914:0x13ff, B:915:0x141d, B:917:0x1425, B:918:0x142f, B:920:0x1437, B:922:0x1455, B:930:0x1463, B:931:0x1469, B:932:0x1474, B:934:0x1481, B:936:0x1485, B:937:0x148e, B:939:0x1497, B:941:0x149f, B:946:0x14c6, B:948:0x14d7, B:950:0x14dd, B:945:0x14af, B:908:0x13ee, B:910:0x13f4, B:912:0x13f9, B:903:0x13bd, B:886:0x135e), top: B:1007:0x12b8 }] */
    /* JADX WARN: Removed duplicated region for block: B:939:0x1497 A[Catch: Exception -> 0x12c7, TryCatch #4 {Exception -> 0x12c7, blocks: (B:852:0x12b8, B:854:0x12c0, B:858:0x12cb, B:860:0x12d0, B:862:0x12e7, B:864:0x12f3, B:865:0x12f7, B:866:0x12fa, B:868:0x1304, B:870:0x130c, B:871:0x1311, B:873:0x1315, B:875:0x1319, B:879:0x1321, B:882:0x1357, B:887:0x1366, B:889:0x136e, B:891:0x1387, B:893:0x138d, B:894:0x1397, B:896:0x13a3, B:898:0x13a9, B:902:0x13ba, B:904:0x13de, B:906:0x13ea, B:914:0x13ff, B:915:0x141d, B:917:0x1425, B:918:0x142f, B:920:0x1437, B:922:0x1455, B:930:0x1463, B:931:0x1469, B:932:0x1474, B:934:0x1481, B:936:0x1485, B:937:0x148e, B:939:0x1497, B:941:0x149f, B:946:0x14c6, B:948:0x14d7, B:950:0x14dd, B:945:0x14af, B:908:0x13ee, B:910:0x13f4, B:912:0x13f9, B:903:0x13bd, B:886:0x135e), top: B:1007:0x12b8 }] */
    /* JADX WARN: Removed duplicated region for block: B:945:0x14af A[Catch: Exception -> 0x12c7, TryCatch #4 {Exception -> 0x12c7, blocks: (B:852:0x12b8, B:854:0x12c0, B:858:0x12cb, B:860:0x12d0, B:862:0x12e7, B:864:0x12f3, B:865:0x12f7, B:866:0x12fa, B:868:0x1304, B:870:0x130c, B:871:0x1311, B:873:0x1315, B:875:0x1319, B:879:0x1321, B:882:0x1357, B:887:0x1366, B:889:0x136e, B:891:0x1387, B:893:0x138d, B:894:0x1397, B:896:0x13a3, B:898:0x13a9, B:902:0x13ba, B:904:0x13de, B:906:0x13ea, B:914:0x13ff, B:915:0x141d, B:917:0x1425, B:918:0x142f, B:920:0x1437, B:922:0x1455, B:930:0x1463, B:931:0x1469, B:932:0x1474, B:934:0x1481, B:936:0x1485, B:937:0x148e, B:939:0x1497, B:941:0x149f, B:946:0x14c6, B:948:0x14d7, B:950:0x14dd, B:945:0x14af, B:908:0x13ee, B:910:0x13f4, B:912:0x13f9, B:903:0x13bd, B:886:0x135e), top: B:1007:0x12b8 }] */
    /* JADX WARN: Removed duplicated region for block: B:947:0x14d5  */
    /* JADX WARN: Removed duplicated region for block: B:950:0x14dd A[Catch: Exception -> 0x12c7, TRY_LEAVE, TryCatch #4 {Exception -> 0x12c7, blocks: (B:852:0x12b8, B:854:0x12c0, B:858:0x12cb, B:860:0x12d0, B:862:0x12e7, B:864:0x12f3, B:865:0x12f7, B:866:0x12fa, B:868:0x1304, B:870:0x130c, B:871:0x1311, B:873:0x1315, B:875:0x1319, B:879:0x1321, B:882:0x1357, B:887:0x1366, B:889:0x136e, B:891:0x1387, B:893:0x138d, B:894:0x1397, B:896:0x13a3, B:898:0x13a9, B:902:0x13ba, B:904:0x13de, B:906:0x13ea, B:914:0x13ff, B:915:0x141d, B:917:0x1425, B:918:0x142f, B:920:0x1437, B:922:0x1455, B:930:0x1463, B:931:0x1469, B:932:0x1474, B:934:0x1481, B:936:0x1485, B:937:0x148e, B:939:0x1497, B:941:0x149f, B:946:0x14c6, B:948:0x14d7, B:950:0x14dd, B:945:0x14af, B:908:0x13ee, B:910:0x13f4, B:912:0x13f9, B:903:0x13bd, B:886:0x135e), top: B:1007:0x12b8 }] */
    /* JADX WARN: Removed duplicated region for block: B:972:0x1524  */
    /* JADX WARN: Type inference failed for: r0v0, types: [android.text.StaticLayout[]] */
    /* JADX WARN: Type inference failed for: r2v1 */
    /* JADX WARN: Type inference failed for: r2v137 */
    /* JADX WARN: Type inference failed for: r2v2, types: [boolean, int] */
    /* JADX WARN: Type inference failed for: r2v24, types: [org.telegram.tgnet.TLRPC$Photo] */
    /* JADX WARN: Type inference failed for: r4v137, types: [java.lang.CharSequence] */
    /* JADX WARN: Type inference failed for: r4v2 */
    /* JADX WARN: Type inference failed for: r4v228 */
    /* JADX WARN: Type inference failed for: r4v3, types: [java.lang.String, org.telegram.tgnet.TLRPC$Chat, org.telegram.tgnet.TLRPC$User] */
    /* JADX WARN: Type inference failed for: r9v133 */
    /* JADX WARN: Type inference failed for: r9v134, types: [boolean, int] */
    /* JADX WARN: Type inference failed for: r9v135 */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void setMessageObjectInternal(MessageObject messageObject) {
        String str;
        SpannableStringBuilder spannableStringBuilderReplaceTags;
        String str2;
        SpannableStringBuilder spannableStringBuilder;
        String str3;
        String str4;
        String str5;
        String str6;
        String str7;
        ?? r4;
        CharSequence charSequence;
        ?? r2;
        String str8;
        boolean z;
        String userName;
        int i;
        int i2;
        SpannableStringBuilder spannableStringBuilder2;
        int i3;
        boolean z2;
        String string;
        CharSequence charSequenceReplaceEmoji;
        boolean z3;
        String str9;
        TLRPC.MessageReplyHeader messageReplyHeader;
        TLRPC.PhotoSize photoSize;
        boolean z4;
        TLRPC.PhotoSize closestPhotoSizeWithSize;
        TLObject tLObject;
        int i4;
        int i5;
        CharSequence charSequence2;
        String str10;
        TextPaint textPaint;
        String str11;
        MessageObject messageObject2;
        ImageReceiver imageReceiver;
        int iDp;
        CharSequence charSequence3;
        String userName2;
        CharSequence charSequenceRemoveDiacritics;
        TLRPC.Message message;
        TLRPC.Chat chat;
        TLRPC.Chat chat2;
        TLRPC.MessageReplyHeader messageReplyHeader2;
        UserConfig userConfig;
        TLRPC.User user;
        TLRPC.MessageReplyHeader messageReplyHeader3;
        CharSequence charSequenceReplaceEmoji2;
        ArrayList arrayList;
        TLRPC.MessageReplyHeader messageReplyHeader4;
        CharSequence charSequence4;
        float f;
        TextUtils.TruncateAt truncateAt;
        MessageObject messageObject3;
        TLRPC.Message message2;
        String str12;
        TLRPC.MessageMedia messageMedia;
        MessageObject messageObject4;
        TLRPC.TL_textWithEntities tL_textWithEntities;
        TLRPC.MessageReplyHeader messageReplyHeader5;
        TLRPC.MessageMedia messageMedia2;
        ArrayList<TLRPC.PhotoSize> arrayList2;
        TLRPC.Document document;
        int i6;
        int i7;
        int i8;
        TLRPC.MessageReplyHeader messageReplyHeader6;
        boolean z5;
        String userName3;
        CharSequence charSequenceEllipsize;
        SpannableStringBuilder spannableStringBuilder3;
        int i9;
        MessagesController messagesController;
        long j;
        String str13;
        String strEllipsize;
        float f2;
        int i10;
        int i11;
        CharSequence charSequenceEllipsize2;
        ?? r9;
        int i12;
        int i13;
        int iDp2;
        CharSequence string2;
        float f3;
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        MessagesController messagesController2;
        long j2;
        CharSequence charSequence5;
        ChatMessageCellDelegate chatMessageCellDelegate;
        SpannableStringBuilder spannableStringBuilder4;
        int i14;
        int lineWidth;
        String str14;
        AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable;
        AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable2;
        String str15;
        StaticLayout staticLayout;
        float lineLeft;
        SpannableStringBuilder spannableStringBuilder5;
        TLRPC.Chat chat3;
        MessageObject.GroupedMessagePosition groupedMessagePosition2;
        int i15;
        MessageObject messageObject5 = messageObject;
        TLRPC.Message message3 = messageObject5.messageOwner;
        if ((message3.flags & 1024) != 0 || message3.replies != null) {
            MessageObject messageObject6 = this.currentMessageObject;
            if (!messageObject6.scheduled && !messageObject6.isSponsored() && !this.currentMessageObject.viewsReloaded) {
                MessagesController.getInstance(this.currentAccount).addToViewsQueue(this.currentMessageObject);
                this.currentMessageObject.viewsReloaded = true;
            }
        }
        updateCurrentUserAndChat();
        setAvatar(messageObject);
        measureTime(messageObject);
        this.namesOffset = 0;
        TLRPC.Message message4 = messageObject5.messageOwner;
        if (message4.via_bot_id != 0) {
            TLRPC.User user2 = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(messageObject5.messageOwner.via_bot_id));
            if (user2 == null || TextUtils.isEmpty(user2.username)) {
                spannableStringBuilderReplaceTags = null;
                str = null;
            } else {
                str = "@" + user2.username;
                spannableStringBuilderReplaceTags = AndroidUtilities.replaceTags(String.format(" %s <b>%s</b>", LocaleController.getString("ViaBot", R.string.ViaBot), str));
                this.viaWidth = (int) Math.ceil(Theme.chat_replyNamePaint.measureText(spannableStringBuilderReplaceTags, 0, spannableStringBuilderReplaceTags.length()));
                this.currentViaBotUser = user2;
            }
        } else if (!TextUtils.isEmpty(message4.via_bot_name)) {
            str = "@" + messageObject5.messageOwner.via_bot_name;
            spannableStringBuilderReplaceTags = AndroidUtilities.replaceTags(String.format(" %s <b>%s</b>", LocaleController.getString("ViaBot", R.string.ViaBot), str));
            this.viaWidth = (int) Math.ceil(Theme.chat_replyNamePaint.measureText(spannableStringBuilderReplaceTags, 0, spannableStringBuilderReplaceTags.length()));
        }
        boolean zIsNeedAuthorName = isNeedAuthorName();
        boolean z6 = (messageObject5.messageOwner.fwd_from == null || messageObject5.type == 14) && str != null;
        if (this.hasPsaHint || !(zIsNeedAuthorName || z6)) {
            str2 = "";
            spannableStringBuilder = spannableStringBuilderReplaceTags;
            str3 = "ViaBot";
            str4 = "%s (%s)";
            str5 = "Loading";
            str6 = "A ";
            str7 = "\n";
            r4 = 0;
            charSequence = " ";
            this.currentNameString = null;
            this.nameLayout = null;
            r2 = 0;
            this.nameWidth = 0;
            this.nameOffsetX = BitmapDescriptorFactory.HUE_RED;
        } else {
            this.drawNameLayout = true;
            this.drawNameAvatar = !messageObject.isOutOwner() && (this.isForum || this.isMonoForum) && this.isSideMenuEnabled && !(((groupedMessagePosition2 = this.currentPosition) != null && (groupedMessagePosition2.flags & 4) == 0) || (i15 = messageObject5.type) == 5 || i15 == 13 || i15 == 15);
            int maxNameWidth = getMaxNameWidth();
            this.nameWidth = maxNameWidth;
            if (maxNameWidth < 0) {
                this.nameWidth = AndroidUtilities.dp(100.0f);
            }
            if (this.drawNameAvatar) {
                this.nameWidth -= AndroidUtilities.dp(32.33f);
            }
            if (!this.isMegagroup || (chat3 = this.currentChat) == null || messageObject5.messageOwner.post_author == null) {
                charSequence5 = " ";
            } else {
                charSequence5 = " ";
                if (chat3.id == (-this.currentMessageObject.getFromChatId())) {
                    messageObject5 = messageObject;
                    spannableStringBuilder4 = new SpannableStringBuilder(messageObject5.messageOwner.post_author.replace("\n", ""));
                    i14 = this.currentMessageObject.messageOwner.from_boosts_applied;
                    if (i14 > 0) {
                        if (spannableStringBuilder4 == null) {
                            spannableStringBuilder4 = new SpannableStringBuilder();
                        }
                        Pair pairCreate = BoostCounterSpan.create(this, Theme.chat_namePaint, i14);
                        BoostCounterSpan boostCounterSpan = (BoostCounterSpan) pairCreate.second;
                        this.boostCounterSpan = boostCounterSpan;
                        boostCounterSpan.isRtl = AndroidUtilities.isRTL(spannableStringBuilder4);
                        boolean z7 = this.boostCounterSpan.isRtl;
                        CharSequence charSequence6 = (CharSequence) pairCreate.first;
                        if (z7) {
                            spannableStringBuilder4.insert(0, charSequence6);
                        } else {
                            spannableStringBuilder4.append(charSequence6);
                        }
                    }
                    if (spannableStringBuilder4 == null) {
                        lineWidth = (int) new StaticLayout(spannableStringBuilder4, Theme.chat_adminPaint, AndroidUtilities.dp(300.0f), Layout.Alignment.ALIGN_NORMAL, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, false).getLineWidth(0);
                        this.nameWidth -= lineWidth;
                    } else {
                        lineWidth = 0;
                    }
                    this.currentNameStatus = null;
                    this.nameStatusSlug = null;
                    this.currentNameBotVerificationId = 0L;
                    str14 = messageObject5.customName;
                    if (str14 == null) {
                        this.currentNameString = str14;
                    } else if (zIsNeedAuthorName) {
                        this.currentNameString = getAuthorName();
                        this.currentNameStatus = getAuthorStatus();
                        this.currentNameBotVerificationId = getAuthorBotVerificationId();
                    } else {
                        this.currentNameString = "";
                    }
                    int iDp3 = AndroidUtilities.dp(!this.currentMessageObject.isSponsored() ? -24.0f : BitmapDescriptorFactory.HUE_RED);
                    str2 = "";
                    CharSequence charSequenceRemoveDiacritics2 = AndroidUtilities.removeDiacritics(this.currentNameString.replace('\n', ' ').replace((char) 8207, ' '));
                    charSequenceRemoveDiacritics2 = Emoji.replaceEmoji(charSequenceRemoveDiacritics2, Theme.chat_namePaint.getFontMetricsInt(), false);
                    TextPaint textPaint2 = Theme.chat_namePaint;
                    str6 = "A ";
                    float f4 = (this.nameWidth + iDp3) - (!z6 ? this.viaWidth : 0);
                    TextUtils.TruncateAt truncateAt2 = TextUtils.TruncateAt.END;
                    CharSequence charSequenceEllipsize3 = TextUtils.ellipsize(charSequenceRemoveDiacritics2, textPaint2, f4, truncateAt2);
                    if (z6) {
                        spannableStringBuilder = spannableStringBuilderReplaceTags;
                        str4 = "%s (%s)";
                        str5 = "Loading";
                        str7 = "\n";
                        charSequence = charSequence5;
                        str3 = "ViaBot";
                    } else {
                        int iCeil = (int) Math.ceil(Theme.chat_namePaint.measureText(charSequenceEllipsize3, 0, charSequenceEllipsize3.length()));
                        this.viaNameWidth = iCeil;
                        if (iCeil != 0) {
                            this.viaNameWidth = iCeil + AndroidUtilities.dp(4.0f);
                        }
                        int themedColor = getThemedColor(this.currentMessageObject.shouldDrawWithoutBackground() ? Theme.key_chat_stickerViaBotNameText : this.currentMessageObject.isOutOwner() ? Theme.key_chat_outViaBotNameText : Theme.key_chat_inViaBotNameText);
                        String string3 = LocaleController.getString(R.string.ViaBot);
                        if (this.currentNameString.length() > 0) {
                            SpannableStringBuilder spannableStringBuilder6 = new SpannableStringBuilder();
                            str7 = "\n";
                            str5 = "Loading";
                            charSequence = charSequence5;
                            spannableStringBuilder6.append(charSequenceEllipsize3).append(charSequence).append((CharSequence) string3).append(charSequence).append((CharSequence) str);
                            str3 = "ViaBot";
                            spannableStringBuilder = spannableStringBuilderReplaceTags;
                            TypefaceSpan typefaceSpan = new TypefaceSpan(Typeface.DEFAULT, 0, themedColor);
                            this.viaSpan1 = typefaceSpan;
                            str4 = "%s (%s)";
                            spannableStringBuilder6.setSpan(typefaceSpan, charSequenceEllipsize3.length() + 1, charSequenceEllipsize3.length() + 1 + string3.length(), 33);
                            if (this.currentNameStatus != null) {
                                this.viaNameWidth += AndroidUtilities.dp(28.0f);
                                spannableStringBuilder6.setSpan(new DialogCell.FixedWidthSpan(AndroidUtilities.dp(28.0f)), charSequenceEllipsize3.length(), charSequenceEllipsize3.length() + 1, 33);
                            }
                            TypefaceSpan typefaceSpan2 = new TypefaceSpan(AndroidUtilities.bold(), 0, themedColor);
                            this.viaSpan2 = typefaceSpan2;
                            spannableStringBuilder6.setSpan(typefaceSpan2, charSequenceEllipsize3.length() + 2 + string3.length(), spannableStringBuilder6.length(), 33);
                            spannableStringBuilder5 = spannableStringBuilder6;
                        } else {
                            spannableStringBuilder = spannableStringBuilderReplaceTags;
                            str4 = "%s (%s)";
                            str5 = "Loading";
                            str7 = "\n";
                            charSequence = charSequence5;
                            str3 = "ViaBot";
                            this.viaOnly = true;
                            SpannableStringBuilder spannableStringBuilder7 = new SpannableStringBuilder();
                            spannableStringBuilder7.append((CharSequence) string3).append(charSequence).append((CharSequence) str);
                            TypefaceSpan typefaceSpan3 = new TypefaceSpan(Typeface.DEFAULT, 0, themedColor);
                            this.viaSpan1 = typefaceSpan3;
                            spannableStringBuilder7.setSpan(typefaceSpan3, 0, string3.length() + 1, 33);
                            TypefaceSpan typefaceSpan4 = new TypefaceSpan(AndroidUtilities.bold(), 0, themedColor);
                            this.viaSpan2 = typefaceSpan4;
                            spannableStringBuilder7.setSpan(typefaceSpan4, string3.length() + 1, spannableStringBuilder7.length(), 33);
                            spannableStringBuilder5 = spannableStringBuilder7;
                        }
                        charSequenceEllipsize3 = TextUtils.ellipsize(spannableStringBuilder5, Theme.chat_namePaint, this.nameWidth + iDp3, truncateAt2);
                    }
                    CharSequence charSequence7 = charSequenceEllipsize3;
                    TextPaint textPaint3 = Theme.chat_namePaint;
                    int iDp4 = this.nameWidth + iDp3 + AndroidUtilities.dp(2.0f);
                    Layout.Alignment alignment = Layout.Alignment.ALIGN_NORMAL;
                    staticLayout = new StaticLayout(charSequence7, textPaint3, iDp4, alignment, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                    this.nameLayout = staticLayout;
                    if (staticLayout.getLineCount() <= 0) {
                        int iCeil2 = (int) Math.ceil(this.nameLayout.getLineWidth(0));
                        this.nameLayoutWidth = iCeil2;
                        this.nameWidth = iCeil2;
                        if (!messageObject.isAnyKindOfSticker()) {
                            this.namesOffset += getNameHeight();
                        }
                        lineLeft = this.nameLayout.getLineLeft(0);
                    } else {
                        this.nameLayoutWidth = 0;
                        this.nameWidth = 0;
                        lineLeft = BitmapDescriptorFactory.HUE_RED;
                    }
                    this.nameOffsetX = lineLeft;
                    if (this.drawNameAvatar) {
                        this.nameWidth += AndroidUtilities.dp(36.33f);
                    }
                    if (this.currentNameStatus != null) {
                        this.nameWidth += AndroidUtilities.dp(20.0f);
                    }
                    if (this.currentNameBotVerificationId != 0) {
                        this.nameWidth += AndroidUtilities.dp(20.0f);
                    }
                    this.nameWidth -= iDp3;
                    if (spannableStringBuilder4 == null) {
                        StaticLayout staticLayout2 = new StaticLayout(spannableStringBuilder4, Theme.chat_adminPaint, lineWidth + AndroidUtilities.dp(2.0f), alignment, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                        this.adminLayout = staticLayout2;
                        this.nameWidth = (int) (!this.drawNameAvatar ? this.nameWidth + staticLayout2.getLineWidth(0) + AndroidUtilities.dp(8.0f) : Math.max(this.nameWidth, AndroidUtilities.dp(32.33f) + this.adminLayout.getLineWidth(0) + AndroidUtilities.dp(8.0f)));
                        this.boostCounterBounds = new RectF();
                    } else {
                        this.adminLayout = null;
                        this.boostCounterBounds = null;
                    }
                    if (this.currentNameStatusDrawable == null && this.currentNameStatus != null) {
                        AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable3 = new AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable((View) this, true, AndroidUtilities.dp(20.0f));
                        this.currentNameStatusDrawable = swapAnimatedEmojiDrawable3;
                        if (this.attachedToWindow) {
                            swapAnimatedEmojiDrawable3.attach();
                        }
                    }
                    swapAnimatedEmojiDrawable = this.currentNameStatusDrawable;
                    if (swapAnimatedEmojiDrawable != null) {
                        Object obj = this.currentNameStatus;
                        if (obj == null) {
                            swapAnimatedEmojiDrawable.set((Drawable) null, false);
                        } else if (obj instanceof Long) {
                            swapAnimatedEmojiDrawable.set(((Long) obj).longValue(), false);
                        } else if (obj instanceof Drawable) {
                            swapAnimatedEmojiDrawable.set((Drawable) obj, false);
                        }
                    }
                    if (this.currentNameEmojiStatusDrawable == null && this.currentNameBotVerificationId != 0) {
                        AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable4 = new AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable((View) this, true, AndroidUtilities.dp(18.0f));
                        this.currentNameEmojiStatusDrawable = swapAnimatedEmojiDrawable4;
                        if (this.attachedToWindow) {
                            swapAnimatedEmojiDrawable4.attach();
                        }
                    }
                    swapAnimatedEmojiDrawable2 = this.currentNameEmojiStatusDrawable;
                    if (swapAnimatedEmojiDrawable2 == null) {
                        long j3 = this.currentNameBotVerificationId;
                        str15 = null;
                        str15 = null;
                        if (j3 == 0) {
                            swapAnimatedEmojiDrawable2.set((Drawable) null, false);
                        } else {
                            swapAnimatedEmojiDrawable2.set(j3, false);
                        }
                    } else {
                        str15 = null;
                    }
                    if (this.currentNameString.length() == 0) {
                        this.currentNameString = str15;
                    }
                    r2 = 0;
                    r4 = str15;
                } else {
                    messageObject5 = messageObject;
                }
            }
            if (this.isMegagroup && this.currentChat != null && this.currentMessageObject.isForwardedChannelPost()) {
                spannableStringBuilder4 = new SpannableStringBuilder(LocaleController.getString(R.string.DiscussChannel));
            } else if ((this.currentUser != null || this.currentChat != null) && !this.currentMessageObject.isOutOwner() && !this.currentMessageObject.isAnyKindOfSticker() && this.currentMessageObject.type != 5 && (chatMessageCellDelegate = this.delegate) != null) {
                TLRPC.User user3 = this.currentUser;
                String adminRank = chatMessageCellDelegate.getAdminRank(user3 != null ? user3.id : this.currentChat.id);
                if (adminRank != null) {
                    if (adminRank.length() == 0) {
                        adminRank = LocaleController.getString(R.string.ChatAdmin);
                    }
                    spannableStringBuilder4 = new SpannableStringBuilder(adminRank);
                } else {
                    spannableStringBuilder4 = null;
                }
            }
            i14 = this.currentMessageObject.messageOwner.from_boosts_applied;
            if (i14 > 0) {
            }
            if (spannableStringBuilder4 == null) {
            }
            this.currentNameStatus = null;
            this.nameStatusSlug = null;
            this.currentNameBotVerificationId = 0L;
            str14 = messageObject5.customName;
            if (str14 == null) {
            }
            int iDp32 = AndroidUtilities.dp(!this.currentMessageObject.isSponsored() ? -24.0f : BitmapDescriptorFactory.HUE_RED);
            str2 = "";
            CharSequence charSequenceRemoveDiacritics22 = AndroidUtilities.removeDiacritics(this.currentNameString.replace('\n', ' ').replace((char) 8207, ' '));
            charSequenceRemoveDiacritics22 = Emoji.replaceEmoji(charSequenceRemoveDiacritics22, Theme.chat_namePaint.getFontMetricsInt(), false);
            TextPaint textPaint22 = Theme.chat_namePaint;
            str6 = "A ";
            float f42 = (this.nameWidth + iDp32) - (!z6 ? this.viaWidth : 0);
            TextUtils.TruncateAt truncateAt22 = TextUtils.TruncateAt.END;
            CharSequence charSequenceEllipsize32 = TextUtils.ellipsize(charSequenceRemoveDiacritics22, textPaint22, f42, truncateAt22);
            if (z6) {
            }
            CharSequence charSequence72 = charSequenceEllipsize32;
            TextPaint textPaint32 = Theme.chat_namePaint;
            int iDp42 = this.nameWidth + iDp32 + AndroidUtilities.dp(2.0f);
            Layout.Alignment alignment2 = Layout.Alignment.ALIGN_NORMAL;
            staticLayout = new StaticLayout(charSequence72, textPaint32, iDp42, alignment2, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
            this.nameLayout = staticLayout;
            if (staticLayout.getLineCount() <= 0) {
            }
            this.nameOffsetX = lineLeft;
            if (this.drawNameAvatar) {
            }
            if (this.currentNameStatus != null) {
            }
            if (this.currentNameBotVerificationId != 0) {
            }
            this.nameWidth -= iDp32;
            if (spannableStringBuilder4 == null) {
            }
            if (this.currentNameStatusDrawable == null) {
                AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable32 = new AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable((View) this, true, AndroidUtilities.dp(20.0f));
                this.currentNameStatusDrawable = swapAnimatedEmojiDrawable32;
                if (this.attachedToWindow) {
                }
            }
            swapAnimatedEmojiDrawable = this.currentNameStatusDrawable;
            if (swapAnimatedEmojiDrawable != null) {
            }
            if (this.currentNameEmojiStatusDrawable == null) {
                AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable42 = new AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable((View) this, true, AndroidUtilities.dp(18.0f));
                this.currentNameEmojiStatusDrawable = swapAnimatedEmojiDrawable42;
                if (this.attachedToWindow) {
                }
            }
            swapAnimatedEmojiDrawable2 = this.currentNameEmojiStatusDrawable;
            if (swapAnimatedEmojiDrawable2 == null) {
            }
            if (this.currentNameString.length() == 0) {
            }
            r2 = 0;
            r4 = str15;
        }
        this.currentForwardUser = r4;
        this.currentForwardNameString = r4;
        this.currentForwardChannel = r4;
        this.currentForwardName = r4;
        ?? r0 = this.forwardedNameLayout;
        r0[r2] = r4;
        r0[1] = r4;
        this.replyPanelIsForward = r2;
        this.forwardedNameWidth = r2;
        if (messageObject.isForwarded()) {
            TLRPC.Peer peer = messageObject5.messageOwner.fwd_from.from_id;
            if (peer instanceof TLRPC.TL_peerChannel) {
                messagesController2 = MessagesController.getInstance(this.currentAccount);
                j2 = messageObject5.messageOwner.fwd_from.from_id.channel_id;
            } else if (peer instanceof TLRPC.TL_peerChat) {
                messagesController2 = MessagesController.getInstance(this.currentAccount);
                j2 = messageObject5.messageOwner.fwd_from.from_id.chat_id;
            } else if (peer instanceof TLRPC.TL_peerUser) {
                this.currentForwardUser = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(messageObject5.messageOwner.fwd_from.from_id.user_id));
            }
            this.currentForwardChannel = messagesController2.getChat(Long.valueOf(j2));
        }
        if (messageObject5.type == 23 || (this.drawForwardedName && messageObject.needDrawForwarded() && ((groupedMessagePosition = this.currentPosition) == null || groupedMessagePosition.minY == 0))) {
            int i16 = messageObject5.type;
            if (i16 != 23 && (str9 = messageObject5.messageOwner.fwd_from.from_name) != null) {
                this.currentForwardName = str9;
            }
            if (i16 != 23 && this.currentForwardUser == null && this.currentForwardChannel == null && this.currentForwardName == null) {
                str8 = str4;
            } else {
                if (this.forwardAvatar == null) {
                    AvatarSpan avatarSpan = new AvatarSpan(this, this.currentAccount);
                    this.forwardAvatar = avatarSpan;
                    avatarSpan.translate(BitmapDescriptorFactory.HUE_RED, AndroidUtilities.dp(-0.33f));
                }
                this.forwardAvatar.setSize((((int) Theme.chat_forwardNamePaint.getTextSize()) * 1.23f) / AndroidUtilities.density);
                if (messageObject5.type == 23) {
                    string = LocaleController.getString(R.string.ForwardedStory);
                    this.currentForwardNameString = string;
                    long peerDialogId = DialogObject.getPeerDialogId(messageObject5.messageOwner.media.peer);
                    if (peerDialogId > 0) {
                        AvatarSpan avatarSpan2 = this.forwardAvatar;
                        TLRPC.User user4 = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(peerDialogId));
                        this.currentForwardUser = user4;
                        avatarSpan2.setUser(user4);
                    } else {
                        AvatarSpan avatarSpan3 = this.forwardAvatar;
                        TLRPC.Chat chat4 = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(-peerDialogId));
                        this.currentForwardChannel = chat4;
                        avatarSpan3.setChat(chat4);
                    }
                    String strRemoveDiacritics = AndroidUtilities.removeDiacritics(getNameFromDialogId(peerDialogId));
                    if (peerDialogId >= 0 || this.currentForwardChannel != null) {
                        z3 = true;
                    } else {
                        strRemoveDiacritics = LocaleController.getString("ChannelPrivate", R.string.ChannelPrivate);
                        z3 = false;
                    }
                    StringBuilder sb = new StringBuilder();
                    sb.append(z3 ? str6 : str2);
                    sb.append(strRemoveDiacritics);
                    SpannableStringBuilder spannableStringBuilder8 = new SpannableStringBuilder(sb.toString());
                    spannableStringBuilder8.setSpan(new TypefaceSpan(AndroidUtilities.bold()), 0, spannableStringBuilder8.length(), 33);
                    if (z3) {
                        spannableStringBuilder8.setSpan(this.forwardAvatar, 0, 1, 33);
                    }
                    this.forwardedNameWidth = getMaxNameWidth();
                    str8 = str4;
                    z2 = false;
                    charSequenceReplaceEmoji = spannableStringBuilder8;
                } else {
                    TLRPC.Chat chat5 = this.currentForwardChannel;
                    if (chat5 != null) {
                        TLRPC.User user5 = this.currentForwardUser;
                        if (user5 != null) {
                            Object[] objArr = {chat5.title, UserObject.getUserName(user5)};
                            str8 = str4;
                            userName = String.format(str8, objArr);
                        } else {
                            str8 = str4;
                            if (TextUtils.isEmpty(messageObject5.messageOwner.fwd_from.post_author)) {
                                TLRPC.Chat chat6 = this.currentForwardChannel;
                                this.currentForwardNameString = chat6.title;
                                this.forwardAvatar.setChat(chat6);
                            } else {
                                this.currentForwardNameString = String.format(str8, this.currentForwardChannel.title, messageObject5.messageOwner.fwd_from.post_author);
                                this.forwardAvatar.setChat(this.currentForwardChannel);
                            }
                            z = true;
                            this.forwardedNameWidth = getMaxNameWidth();
                            String forwardedMessageText = getForwardedMessageText(messageObject);
                            if (this.hasPsaHint) {
                                this.forwardedNameWidth -= AndroidUtilities.dp(36.0f);
                            }
                            StringBuilder sb2 = new StringBuilder();
                            sb2.append(z ? str6 : str2);
                            sb2.append(this.currentForwardNameString.replace('\n', ' '));
                            String strRemoveDiacritics2 = AndroidUtilities.removeDiacritics(TextUtils.ellipsize(sb2.toString(), Theme.chat_replyNamePaint, (this.forwardedNameWidth - this.viaWidth) - AndroidUtilities.dp(z ? 17.33f : BitmapDescriptorFactory.HUE_RED), TextUtils.TruncateAt.END).toString());
                            if (spannableStringBuilder != null) {
                                spannableStringBuilder2 = new SpannableStringBuilder(String.format("%s %s %s", strRemoveDiacritics2, LocaleController.getString(str3, R.string.ViaBot), str));
                                this.viaNameWidth = (int) Math.ceil(Theme.chat_forwardNamePaint.measureText(strRemoveDiacritics2));
                                TypefaceSpan typefaceSpan5 = new TypefaceSpan(AndroidUtilities.bold());
                                int length = spannableStringBuilder2.length() - str.length();
                                i = 1;
                                i2 = 33;
                                spannableStringBuilder2.setSpan(typefaceSpan5, length - 1, spannableStringBuilder2.length(), 33);
                            } else {
                                i = 1;
                                i2 = 33;
                                spannableStringBuilder2 = new SpannableStringBuilder(strRemoveDiacritics2);
                            }
                            if (!z || spannableStringBuilder2.length() <= i) {
                                i3 = 0;
                            } else {
                                i3 = 0;
                                spannableStringBuilder2.setSpan(this.forwardAvatar, 0, i, i2);
                            }
                            this.forwardNameCenterX = ((int) Math.ceil(Theme.chat_forwardNamePaint.measureText(r6, i3, r6.length()))) / 2;
                            if (this.currentForwardName == null && messageObject5.messageOwner.fwd_from.from_id == null) {
                                z2 = false;
                            } else {
                                z2 = false;
                                spannableStringBuilder2.setSpan(new TypefaceSpan(AndroidUtilities.bold()), 0, spannableStringBuilder2.length(), 33);
                            }
                            string = forwardedMessageText;
                            charSequenceReplaceEmoji = spannableStringBuilder2;
                        }
                    } else {
                        str8 = str4;
                        TLRPC.User user6 = this.currentForwardUser;
                        if (user6 != null) {
                            userName = UserObject.getUserName(user6);
                        } else {
                            this.currentForwardNameString = this.currentForwardName;
                            z = false;
                            this.forwardedNameWidth = getMaxNameWidth();
                            String forwardedMessageText2 = getForwardedMessageText(messageObject);
                            if (this.hasPsaHint) {
                            }
                            StringBuilder sb22 = new StringBuilder();
                            sb22.append(z ? str6 : str2);
                            sb22.append(this.currentForwardNameString.replace('\n', ' '));
                            String strRemoveDiacritics22 = AndroidUtilities.removeDiacritics(TextUtils.ellipsize(sb22.toString(), Theme.chat_replyNamePaint, (this.forwardedNameWidth - this.viaWidth) - AndroidUtilities.dp(z ? 17.33f : BitmapDescriptorFactory.HUE_RED), TextUtils.TruncateAt.END).toString());
                            if (spannableStringBuilder != null) {
                            }
                            if (z) {
                                i3 = 0;
                                this.forwardNameCenterX = ((int) Math.ceil(Theme.chat_forwardNamePaint.measureText(r6, i3, r6.length()))) / 2;
                                if (this.currentForwardName == null) {
                                    z2 = false;
                                    spannableStringBuilder2.setSpan(new TypefaceSpan(AndroidUtilities.bold()), 0, spannableStringBuilder2.length(), 33);
                                    string = forwardedMessageText2;
                                    charSequenceReplaceEmoji = spannableStringBuilder2;
                                }
                            }
                        }
                    }
                    this.currentForwardNameString = userName;
                    this.forwardAvatar.setUser(this.currentForwardUser);
                    z = true;
                    this.forwardedNameWidth = getMaxNameWidth();
                    String forwardedMessageText22 = getForwardedMessageText(messageObject);
                    if (this.hasPsaHint) {
                    }
                    StringBuilder sb222 = new StringBuilder();
                    sb222.append(z ? str6 : str2);
                    sb222.append(this.currentForwardNameString.replace('\n', ' '));
                    String strRemoveDiacritics222 = AndroidUtilities.removeDiacritics(TextUtils.ellipsize(sb222.toString(), Theme.chat_replyNamePaint, (this.forwardedNameWidth - this.viaWidth) - AndroidUtilities.dp(z ? 17.33f : BitmapDescriptorFactory.HUE_RED), TextUtils.TruncateAt.END).toString());
                    if (spannableStringBuilder != null) {
                    }
                    if (z) {
                    }
                }
                try {
                    charSequenceReplaceEmoji = Emoji.replaceEmoji(charSequenceReplaceEmoji, Theme.chat_forwardNamePaint.getFontMetricsInt(), z2);
                } catch (Exception unused) {
                }
                TextPaint textPaint4 = Theme.chat_forwardNamePaint;
                float f5 = this.forwardedNameWidth;
                TextUtils.TruncateAt truncateAt3 = TextUtils.TruncateAt.END;
                CharSequence charSequenceEllipsize4 = TextUtils.ellipsize(charSequenceReplaceEmoji, textPaint4, f5, truncateAt3);
                try {
                    StaticLayout[] staticLayoutArr = this.forwardedNameLayout;
                    TextPaint textPaint5 = Theme.chat_forwardNamePaint;
                    int iDp5 = this.forwardedNameWidth + AndroidUtilities.dp(2.0f);
                    Layout.Alignment alignment3 = Layout.Alignment.ALIGN_NORMAL;
                    staticLayoutArr[1] = new StaticLayout(charSequenceEllipsize4, textPaint5, iDp5, alignment3, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                    this.forwardedNameLayout[0] = new StaticLayout(TextUtils.ellipsize(AndroidUtilities.replaceTags(string), Theme.chat_forwardNamePaint, this.forwardedNameWidth, truncateAt3), Theme.chat_forwardNamePaint, this.forwardedNameWidth + AndroidUtilities.dp(2.0f), alignment3, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                    if (this.forwardBg == null) {
                        this.forwardBg = new ForwardBackground(this);
                    }
                    this.forwardBg.set(this.forwardedNameLayout, !this.currentMessageObject.isOutOwner() && (!this.drawNameLayout || this.nameLayout == null) && this.pinnedTop);
                    int iMax = Math.max((int) Math.ceil(this.forwardedNameLayout[0].getLineWidth(0)), (int) Math.ceil(this.forwardedNameLayout[1].getLineWidth(0)));
                    this.forwardedNameWidth = iMax;
                    if (this.hasPsaHint) {
                        this.forwardedNameWidth = iMax + AndroidUtilities.dp(36.0f);
                    }
                    this.forwardNameOffsetX[0] = this.forwardedNameLayout[0].getLineLeft(0);
                    this.forwardNameOffsetX[1] = this.forwardedNameLayout[1].getLineLeft(0);
                    if ((this.isSideMenued && !this.drawBackground) || ((messageObject5.type != 5 && !messageObject.isAnyKindOfSticker()) || messageObject5.type == 19)) {
                        int iDp6 = (int) (this.namesOffset + AndroidUtilities.dp(8.0f) + (Theme.chat_forwardNamePaint.getTextSize() * 2.0f));
                        this.namesOffset = iDp6;
                        if (messageObject5.type == 19) {
                            this.namesOffset = iDp6 + AndroidUtilities.dp(8.0f);
                        }
                    }
                } catch (Exception e) {
                    FileLog.e(e);
                }
            }
        }
        if (((messageObject.isGiveawayResults() || !((!this.isThreadChat || messageObject.isQuickReply() || this.isSavedChat || messageObject5.getReplyTopMsgId(this.isForum) != 0 || this.isForumGeneral || this.isMonoForum) && messageObject.hasValidReplyMessageObject())) && ((messageObject5.messageOwner.fwd_from == null || !messageObject.isDice()) && ((messageReplyHeader = messageObject5.messageOwner.reply_to) == null || (messageReplyHeader.story_id == 0 && TextUtils.isEmpty(messageReplyHeader.quote_text) && messageObject5.messageOwner.reply_to.reply_from == null)))) || messageObject5.isRepostPreview) {
            String str16 = str5;
            if ((!this.isThreadChat || messageObject.isQuickReply() || this.isMonoForum) && messageObject.getReplyMsgId() != 0 && !messageObject.isGiveawayResults() && !messageObject5.isRepostPreview) {
                MessageObject messageObject7 = messageObject5.replyMessageObject;
                if (messageObject7 != null) {
                    TLRPC.Message message5 = messageObject7.messageOwner;
                    if (!(message5 instanceof TLRPC.TL_messageEmpty) && (message5 == null || !(message5.action instanceof TLRPC.TL_messageActionTopicCreate))) {
                        ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
                        if (chatMessageCellDelegate2 == null || chatMessageCellDelegate2.doNotShowLoadingReply(messageObject5)) {
                            if ((this.isSideMenued && !this.drawBackground) || (!messageObject.isAnyKindOfSticker() && messageObject5.type != 5)) {
                                int iDp7 = (int) (this.namesOffset + AndroidUtilities.dp(18.0f) + Theme.chat_replyTextPaint.getTextSize() + Theme.chat_replyNamePaint.getTextSize());
                                this.namesOffset = iDp7;
                                if (messageObject5.type != 0) {
                                    this.namesOffset = iDp7 + AndroidUtilities.dp(5.0f);
                                }
                            }
                            this.needReplyImage = false;
                            int maxNameWidth2 = getMaxNameWidth();
                            if (!messageObject.shouldDrawWithoutBackground()) {
                                maxNameWidth2 -= AndroidUtilities.dp(10.0f);
                            } else if (messageObject5.type == 5) {
                                maxNameWidth2 += AndroidUtilities.dp(13.0f);
                            }
                            StaticLayout staticLayout3 = new StaticLayout(LocaleController.getString(str16, R.string.Loading), Theme.chat_replyNamePaint, maxNameWidth2 + AndroidUtilities.dp(6.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                            this.replyNameLayout = staticLayout3;
                            if (staticLayout3.getLineCount() > 0) {
                                this.replyNameWidth += ((int) Math.ceil(this.replyNameLayout.getLineWidth(0))) + AndroidUtilities.dp(8.0f);
                                this.replyNameOffset = (int) this.replyNameLayout.getLineLeft(0);
                            }
                        }
                    }
                }
            }
        } else {
            MessageObject.GroupedMessagePosition groupedMessagePosition3 = this.currentPosition;
            if (groupedMessagePosition3 == null || groupedMessagePosition3.minY == 0) {
                if ((this.isSideMenued && !this.drawBackground) || ((!messageObject.isAnyKindOfSticker() && messageObject5.type != 5) || messageObject5.type == 19)) {
                    int iDp8 = (int) (this.namesOffset + AndroidUtilities.dp(20.0f) + Theme.chat_replyTextPaint.getTextSize() + Theme.chat_replyNamePaint.getTextSize());
                    this.namesOffset = iDp8;
                    int i17 = messageObject5.type;
                    if (i17 != 19 || this.drawForwardedName) {
                        f3 = i17 != 0 ? 5.0f : 12.0f;
                    }
                    this.namesOffset = iDp8 + AndroidUtilities.dp(f3);
                }
                if (this.drawForwardedName && this.forwardedNameLayout[0] != null) {
                    this.namesOffset += AndroidUtilities.dp(2.0f);
                }
                int maxNameWidth3 = getMaxNameWidth();
                if (!messageObject.shouldDrawWithoutBackground()) {
                    maxNameWidth3 -= AndroidUtilities.dp(messageObject.isOutOwner() ? 20.0f : 10.0f);
                    if (messageObject5.type != 0 || messageObject.needDrawShareButton()) {
                        maxNameWidth3 -= AndroidUtilities.dp((messageObject5.isSaved && messageObject.isOutOwner()) ? 35.0f : 10.0f);
                    }
                } else if (messageObject5.type == 5) {
                    maxNameWidth3 += AndroidUtilities.dp(13.0f);
                }
                TLRPC.MessageReplyHeader messageReplyHeader7 = messageObject5.messageOwner.reply_to;
                boolean z8 = (messageReplyHeader7 == null || (messageReplyHeader7.flags & 64) == 0 || messageReplyHeader7.quote_text == null) ? false : true;
                this.hasReplyQuote = z8;
                boolean z9 = z8 && messageReplyHeader7.quote;
                this.isReplyQuote = z9;
                boolean z10 = z9 && messageReplyHeader7.quote;
                if (z9 && z10 && this.replyQuoteDrawable == null) {
                    this.replyQuoteDrawable = getContext().getResources().getDrawable(R.drawable.mini_quote).mutate();
                    this.replyQuoteDrawableColor = -1;
                }
                TextPaint textPaint6 = (this.isReplyQuote && messageObject.shouldDrawWithoutBackground()) ? Theme.chat_quoteTextPaint : Theme.chat_replyTextPaint;
                TLRPC.MessageReplyHeader messageReplyHeader8 = messageObject5.messageOwner.reply_to;
                if (messageReplyHeader8 == null || messageReplyHeader8.story_id == 0) {
                    String str17 = str5;
                    if (((!this.isThreadChat || this.isMonoForum || messageObject.isQuickReply() || this.isSavedChat || messageObject5.getReplyTopMsgId(this.isForum) != 0 || this.isForumGeneral) && messageObject.hasValidReplyMessageObject()) || this.hasReplyQuote || !((messageReplyHeader6 = messageObject5.messageOwner.reply_to) == null || messageReplyHeader6.reply_from == null)) {
                        MessageObject messageObject8 = messageObject5.replyMessageObject;
                        this.lastReplyMessage = messageObject8 == null ? null : messageObject8.messageOwner;
                        if (messageObject8 != null) {
                            boolean zHasMediaSpoilers = messageObject8.hasMediaSpoilers();
                            TLRPC.PhotoSize closestPhotoSizeWithSize2 = FileLoader.getClosestPhotoSizeWithSize(messageObject5.replyMessageObject.photoThumbs2, 320);
                            TLRPC.PhotoSize closestPhotoSizeWithSize3 = FileLoader.getClosestPhotoSizeWithSize(messageObject5.replyMessageObject.photoThumbs2, 40);
                            MessageObject messageObject9 = messageObject5.replyMessageObject;
                            tLObject = messageObject9.photoThumbsObject2;
                            if (closestPhotoSizeWithSize2 == null) {
                                if (messageObject9.mediaExists) {
                                    closestPhotoSizeWithSize2 = FileLoader.getClosestPhotoSizeWithSize(messageObject9.photoThumbs, AndroidUtilities.getPhotoSize());
                                    i8 = closestPhotoSizeWithSize2 != null ? closestPhotoSizeWithSize2.size : 0;
                                    i7 = 0;
                                } else {
                                    closestPhotoSizeWithSize2 = FileLoader.getClosestPhotoSizeWithSize(messageObject9.photoThumbs, 320);
                                    i7 = 1;
                                    i8 = 0;
                                }
                                int i18 = i8;
                                i6 = i7;
                                closestPhotoSizeWithSize3 = FileLoader.getClosestPhotoSizeWithSize(messageObject5.replyMessageObject.photoThumbs, 40);
                                tLObject = messageObject5.replyMessageObject.photoThumbsObject;
                                i4 = i18;
                            } else {
                                i6 = 1;
                                i4 = 0;
                            }
                            if (closestPhotoSizeWithSize3 == closestPhotoSizeWithSize2) {
                                closestPhotoSizeWithSize = closestPhotoSizeWithSize2;
                                i5 = i6;
                                z4 = zHasMediaSpoilers;
                                photoSize = null;
                            } else {
                                i5 = i6;
                                TLRPC.PhotoSize photoSize2 = closestPhotoSizeWithSize2;
                                z4 = zHasMediaSpoilers;
                                photoSize = closestPhotoSizeWithSize3;
                                closestPhotoSizeWithSize = photoSize2;
                            }
                        } else {
                            photoSize = null;
                            z4 = false;
                            closestPhotoSizeWithSize = null;
                            tLObject = null;
                            i4 = 0;
                            i5 = 1;
                        }
                        TLRPC.Message message6 = messageObject5.messageOwner;
                        if (message6 == null || (messageReplyHeader5 = message6.reply_to) == null || (messageMedia2 = messageReplyHeader5.reply_media) == null) {
                            charSequence2 = charSequence;
                            str10 = str17;
                            textPaint = textPaint6;
                            str11 = str7;
                            if (closestPhotoSizeWithSize != null && (messageObject2 = messageObject5.replyMessageObject) != null && !messageObject2.isAnyKindOfSticker() && ((!messageObject.isAnyKindOfSticker() || AndroidUtilities.isTablet()) && !messageObject5.replyMessageObject.isSecretMedia() && !messageObject5.replyMessageObject.isWebpageDocument())) {
                                if (messageObject5.replyMessageObject.isRoundVideo()) {
                                    imageReceiver = this.replyImageReceiver;
                                    iDp = AndroidUtilities.dp(32.0f);
                                } else {
                                    imageReceiver = this.replyImageReceiver;
                                    iDp = AndroidUtilities.dp(4.0f);
                                }
                                imageReceiver.setRoundRadius(iDp);
                                this.currentReplyPhoto = closestPhotoSizeWithSize;
                                this.replyImageReceiver.setImage(ImageLocation.getForObject(closestPhotoSizeWithSize, tLObject), z4 ? "5_5_b" : "50_50", ImageLocation.getForObject(photoSize, tLObject), z4 ? "50_50_b4" : "50_50_b", i4, null, messageObject5.replyMessageObject, i5);
                                this.needReplyImage = true;
                                maxNameWidth3 = (int) (maxNameWidth3 - ((AndroidUtilities.dp(this.isReplyQuote ? 3.0f : 7.0f) + Theme.chat_replyNamePaint.getTextSize()) + Theme.chat_replyTextPaint.getTextSize()));
                                charSequence3 = null;
                            }
                            charSequence3 = null;
                            this.replyImageReceiver.setImageBitmap((Drawable) null);
                            this.needReplyImage = false;
                        } else {
                            TLRPC.Document document2 = messageMedia2.document;
                            if (document2 != null) {
                                arrayList2 = document2.thumbs;
                                document = document2;
                            } else {
                                ?? r22 = messageMedia2.photo;
                                if (r22 != 0) {
                                    arrayList2 = r22.sizes;
                                    document = r22;
                                }
                                if (closestPhotoSizeWithSize != null) {
                                    charSequence2 = charSequence;
                                    str10 = str17;
                                    textPaint = textPaint6;
                                    str11 = str7;
                                    charSequence3 = null;
                                    this.replyImageReceiver.setImageBitmap((Drawable) null);
                                    this.needReplyImage = false;
                                } else {
                                    this.currentReplyPhoto = closestPhotoSizeWithSize;
                                    ImageReceiver imageReceiver2 = this.replyImageReceiver;
                                    ImageLocation forObject = ImageLocation.getForObject(closestPhotoSizeWithSize, tLObject);
                                    String str18 = z4 ? "5_5_b" : "50_50";
                                    ImageLocation forObject2 = ImageLocation.getForObject(photoSize, tLObject);
                                    charSequence2 = charSequence;
                                    str10 = str17;
                                    textPaint = textPaint6;
                                    String str19 = str7;
                                    imageReceiver2.setImage(forObject, str18, forObject2, z4 ? "50_50_b4" : "50_50_b", i4, null, messageObject, i5);
                                    this.needReplyImage = true;
                                    maxNameWidth3 = (int) (maxNameWidth3 - ((AndroidUtilities.dp(this.isReplyQuote ? 3.0f : 7.0f) + Theme.chat_replyNamePaint.getTextSize()) + Theme.chat_replyTextPaint.getTextSize()));
                                    str11 = str19;
                                    charSequence3 = null;
                                }
                            }
                            closestPhotoSizeWithSize = FileLoader.getClosestPhotoSizeWithSize(arrayList2, 320);
                            tLObject = document;
                            if (closestPhotoSizeWithSize != null) {
                            }
                        }
                        if (DialogObject.isEncryptedDialog(messageObject.getDialogId())) {
                            MessageObject messageObject10 = messageObject5.replyMessageObject;
                            if (messageObject10 == null || !messageObject10.isOutOwner()) {
                                TLRPC.EncryptedChat encryptedChat = MessagesController.getInstance(this.currentAccount).getEncryptedChat(Integer.valueOf(DialogObject.getEncryptedChatId(this.currentMessageObject.getDialogId())));
                                if (encryptedChat != null) {
                                    user = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(encryptedChat.user_id));
                                    userName2 = UserObject.getUserName(user);
                                    charSequenceRemoveDiacritics = AndroidUtilities.removeDiacritics(userName2);
                                    if (charSequenceRemoveDiacritics == null) {
                                        charSequenceRemoveDiacritics = LocaleController.getString(str10, R.string.Loading);
                                    }
                                    messageReplyHeader3 = messageObject5.messageOwner.reply_to;
                                    if (messageReplyHeader3 != null && (messageReplyHeader3.flags & 2048) != 0 && (messageObject4 = messageObject5.replyMessageObject) != null && (MessageObject.getMedia(messageObject4) instanceof TLRPC.TL_messageMediaToDo)) {
                                        TLRPC.TodoItem todoItemFindTodoItem = MessageObject.findTodoItem(messageObject5.replyMessageObject, messageObject5.messageOwner.reply_to.todo_item_id);
                                        if (todoItemFindTodoItem != null) {
                                            this.isReplyTask = true;
                                            CharSequence textWithEntities = MessageObject.formatTextWithEntities(todoItemFindTodoItem.title, messageObject.isOutOwner(), textPaint);
                                            if (this.replyTaskCheckbox == null) {
                                                CheckBoxBase checkBoxBase = new CheckBoxBase(this, 12, this.resourcesProvider);
                                                this.replyTaskCheckbox = checkBoxBase;
                                                checkBoxBase.checkScale = 0.5f;
                                                checkBoxBase.setDrawUnchecked(false);
                                                this.replyTaskCheckbox.setBackgroundType(9);
                                                if (this.attachedToWindow) {
                                                    this.replyTaskCheckbox.onAttachedToWindow();
                                                }
                                            }
                                            this.replyTaskCheckbox.setCuttingCheck(Theme.isCurrentThemeDark());
                                            this.replyTaskCheckbox.setChecked(MessageObject.isCompleted(messageObject5.replyMessageObject, todoItemFindTodoItem.id), true);
                                            charSequenceReplaceEmoji2 = textWithEntities;
                                        } else {
                                            TLRPC.TodoList todoList = ((TLRPC.TL_messageMediaToDo) MessageObject.getMedia(messageObject5.replyMessageObject)).todo;
                                            if (todoList != null && (tL_textWithEntities = todoList.title) != null) {
                                                charSequenceReplaceEmoji2 = MessageObject.formatTextWithEntities(tL_textWithEntities, messageObject.isOutOwner(), textPaint);
                                            }
                                        }
                                    } else if (!this.hasReplyQuote || ((messageReplyHeader4 = messageObject5.messageOwner.reply_to) != null && messageReplyHeader4.quote_text != null && messageReplyHeader4.reply_from != null)) {
                                        charSequenceReplaceEmoji2 = Emoji.replaceEmoji(new SpannableStringBuilder(messageObject5.messageOwner.reply_to.quote_text.replace('\n', ' ')), textPaint.getFontMetricsInt(), false);
                                        arrayList = messageObject5.messageOwner.reply_to.quote_entities;
                                        if (arrayList != null) {
                                            charSequenceReplaceEmoji2 = MessageObject.replaceAnimatedEmoji(charSequenceReplaceEmoji2, arrayList, textPaint.getFontMetricsInt(), true);
                                            MessageObject.addEntitiesToText(charSequenceReplaceEmoji2, messageObject5.messageOwner.reply_to.quote_entities, this.currentMessageObject.isOutOwner(), false, false, false);
                                        }
                                    } else if (messageReplyHeader4 == null || messageReplyHeader4.reply_from == null || (messageMedia = messageReplyHeader4.reply_media) == null) {
                                        MessageObject messageObject11 = messageObject5.replyMessageObject;
                                        if (messageObject11 == null || (textWithEntities = messageObject11.messageTextForReply) == null) {
                                            if (MessageObject.getMedia(messageObject11) instanceof TLRPC.TL_messageMediaGame) {
                                                str12 = MessageObject.getMedia(messageObject5.replyMessageObject).game.title;
                                            } else if (MessageObject.getMedia(messageObject5.replyMessageObject) instanceof TLRPC.TL_messageMediaInvoice) {
                                                str12 = MessageObject.getMedia(messageObject5.replyMessageObject).title;
                                            } else {
                                                MessageObject messageObject12 = messageObject5.replyMessageObject;
                                                if (messageObject12 == null || TextUtils.isEmpty(messageObject12.caption)) {
                                                    MessageObject messageObject13 = messageObject5.replyMessageObject;
                                                    if (messageObject13 == null || (charSequence4 = messageObject13.messageText) == null || charSequence4.length() <= 0) {
                                                        charSequenceReplaceEmoji2 = charSequence3;
                                                    } else {
                                                        CharSequence spannableStringBuilder9 = messageObject5.replyMessageObject.messageText;
                                                        if (spannableStringBuilder9.length() > 150) {
                                                            spannableStringBuilder9 = spannableStringBuilder9.subSequence(0, ImageReceiver.DEFAULT_CROSSFADE_DURATION);
                                                        }
                                                        if (!(spannableStringBuilder9 instanceof SpannableStringBuilder)) {
                                                            spannableStringBuilder9 = new SpannableStringBuilder(spannableStringBuilder9);
                                                        }
                                                        CharSequence charSequenceReplaceEmoji3 = Emoji.replaceEmoji(AndroidUtilities.replaceNewLines(AndroidUtilities.removeSpans(AndroidUtilities.removeSpans(spannableStringBuilder9, QuoteSpan.class), QuoteSpan.QuoteStyleSpan.class)), textPaint.getFontMetricsInt(), true);
                                                        TLRPC.Message message7 = messageObject5.replyMessageObject.messageOwner;
                                                        if (message7 != null) {
                                                            charSequenceReplaceEmoji3 = MessageObject.replaceAnimatedEmoji(charSequenceReplaceEmoji3, message7.entities, textPaint.getFontMetricsInt(), true);
                                                        }
                                                        f = maxNameWidth3;
                                                        truncateAt = TextUtils.TruncateAt.END;
                                                        charSequenceReplaceEmoji2 = TextUtils.ellipsize(charSequenceReplaceEmoji3, textPaint, f, truncateAt);
                                                        if (charSequenceReplaceEmoji2 instanceof Spannable) {
                                                            MediaDataController.addTextStyleRuns(messageObject5.replyMessageObject, (Spannable) charSequenceReplaceEmoji2);
                                                            charSequenceReplaceEmoji2 = TextUtils.ellipsize(charSequenceReplaceEmoji2, textPaint, f, truncateAt);
                                                        }
                                                    }
                                                } else {
                                                    String string4 = messageObject5.replyMessageObject.caption.toString();
                                                    if (string4.length() > 150) {
                                                        string4 = string4.substring(0, ImageReceiver.DEFAULT_CROSSFADE_DURATION);
                                                    }
                                                    CharSequence charSequenceReplaceEmoji4 = Emoji.replaceEmoji(string4.replace('\n', ' '), textPaint.getFontMetricsInt(), true);
                                                    TLRPC.Message message8 = messageObject5.replyMessageObject.messageOwner;
                                                    if (message8 != null) {
                                                        charSequenceReplaceEmoji4 = MessageObject.replaceAnimatedEmoji(charSequenceReplaceEmoji4, message8.entities, textPaint.getFontMetricsInt(), true);
                                                    }
                                                    f = maxNameWidth3;
                                                    truncateAt = TextUtils.TruncateAt.END;
                                                    charSequenceReplaceEmoji2 = TextUtils.ellipsize(charSequenceReplaceEmoji4, textPaint, f, truncateAt);
                                                    if ((charSequenceReplaceEmoji2 instanceof Spannable) && (message2 = (messageObject3 = messageObject5.replyMessageObject).messageOwner) != null) {
                                                        MediaDataController.addTextStyleRuns((ArrayList<TLRPC.MessageEntity>) message2.entities, messageObject3.caption, (Spannable) charSequenceReplaceEmoji2);
                                                        charSequenceReplaceEmoji2 = TextUtils.ellipsize(charSequenceReplaceEmoji2, textPaint, f, truncateAt);
                                                    }
                                                }
                                            }
                                            charSequenceReplaceEmoji2 = Emoji.replaceEmoji(str12, textPaint.getFontMetricsInt(), false);
                                            f = maxNameWidth3;
                                            truncateAt = TextUtils.TruncateAt.END;
                                            charSequenceReplaceEmoji2 = TextUtils.ellipsize(charSequenceReplaceEmoji2, textPaint, f, truncateAt);
                                        } else {
                                            charSequenceReplaceEmoji2 = textWithEntities;
                                        }
                                    } else {
                                        charSequenceReplaceEmoji2 = messageObject5.getMediaTitle(messageMedia);
                                    }
                                }
                                charSequenceRemoveDiacritics = charSequence3;
                                if (charSequenceRemoveDiacritics == null) {
                                }
                                messageReplyHeader3 = messageObject5.messageOwner.reply_to;
                                if (messageReplyHeader3 != null) {
                                    if (!this.hasReplyQuote) {
                                        charSequenceReplaceEmoji2 = Emoji.replaceEmoji(new SpannableStringBuilder(messageObject5.messageOwner.reply_to.quote_text.replace('\n', ' ')), textPaint.getFontMetricsInt(), false);
                                        arrayList = messageObject5.messageOwner.reply_to.quote_entities;
                                        if (arrayList != null) {
                                        }
                                    }
                                }
                            } else {
                                userConfig = UserConfig.getInstance(this.currentAccount);
                                user = userConfig.getCurrentUser();
                                userName2 = UserObject.getUserName(user);
                                charSequenceRemoveDiacritics = AndroidUtilities.removeDiacritics(userName2);
                                if (charSequenceRemoveDiacritics == null) {
                                }
                                messageReplyHeader3 = messageObject5.messageOwner.reply_to;
                                if (messageReplyHeader3 != null) {
                                }
                            }
                        } else if (!this.hasReplyQuote || DialogObject.isEncryptedDialog(messageObject.getDialogId())) {
                            if (messageObject5.hideSendersName) {
                                TLRPC.Peer peer2 = messageObject5.sendAsPeer;
                                if (peer2 == null) {
                                    userConfig = AccountInstance.getInstance(this.currentAccount).getUserConfig();
                                    user = userConfig.getCurrentUser();
                                    userName2 = UserObject.getUserName(user);
                                    charSequenceRemoveDiacritics = AndroidUtilities.removeDiacritics(userName2);
                                    if (charSequenceRemoveDiacritics == null) {
                                    }
                                    messageReplyHeader3 = messageObject5.messageOwner.reply_to;
                                    if (messageReplyHeader3 != null) {
                                    }
                                } else if (peer2.channel_id != 0) {
                                    chat2 = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(messageObject5.sendAsPeer.channel_id));
                                } else {
                                    user = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(messageObject5.sendAsPeer.user_id));
                                    userName2 = UserObject.getUserName(user);
                                    charSequenceRemoveDiacritics = AndroidUtilities.removeDiacritics(userName2);
                                    if (charSequenceRemoveDiacritics == null) {
                                    }
                                    messageReplyHeader3 = messageObject5.messageOwner.reply_to;
                                    if (messageReplyHeader3 != null) {
                                    }
                                }
                            } else {
                                userName2 = messageObject5.customReplyName;
                                if (userName2 == null) {
                                    MessageObject messageObject14 = messageObject5.replyMessageObject;
                                    if (messageObject14 == null && (messageReplyHeader2 = messageObject5.messageOwner.reply_to) != null && messageReplyHeader2.reply_from != null) {
                                        charSequenceRemoveDiacritics = messageObject.getReplyQuoteNameWithIcon();
                                    } else if (messageObject14 != null) {
                                        charSequenceRemoveDiacritics = this.drawForwardedName ? AndroidUtilities.removeDiacritics(messageObject14.getForwardedName()) : charSequence3;
                                        if (charSequenceRemoveDiacritics == null) {
                                            long fromChatId = messageObject5.replyMessageObject.getFromChatId();
                                            if (fromChatId > 0) {
                                                TLRPC.User user7 = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(fromChatId));
                                                if (user7 != null) {
                                                    userName2 = UserObject.getUserName(user7);
                                                    charSequenceRemoveDiacritics = AndroidUtilities.removeDiacritics(userName2);
                                                }
                                            } else if (fromChatId >= 0 ? !((message = messageObject5.replyMessageObject.messageOwner) == null || message.peer_id == null || (chat = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(messageObject5.replyMessageObject.messageOwner.peer_id.channel_id))) == null) : (chat = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(-fromChatId))) != null) {
                                                chat2 = chat;
                                                userName2 = chat2.title;
                                                charSequenceRemoveDiacritics = AndroidUtilities.removeDiacritics(userName2);
                                            }
                                        }
                                    } else {
                                        charSequenceRemoveDiacritics = charSequence3;
                                    }
                                    if (charSequenceRemoveDiacritics == null) {
                                    }
                                    messageReplyHeader3 = messageObject5.messageOwner.reply_to;
                                    if (messageReplyHeader3 != null) {
                                    }
                                } else {
                                    charSequenceRemoveDiacritics = AndroidUtilities.removeDiacritics(userName2);
                                    if (charSequenceRemoveDiacritics == null) {
                                    }
                                    messageReplyHeader3 = messageObject5.messageOwner.reply_to;
                                    if (messageReplyHeader3 != null) {
                                    }
                                }
                            }
                        }
                    } else {
                        this.replyImageReceiver.setImageBitmap((Drawable) null);
                        this.needReplyImage = false;
                        this.replyPanelIsForward = true;
                        TLRPC.MessageFwdHeader messageFwdHeader = messageObject5.messageOwner.fwd_from;
                        if (messageFwdHeader != null) {
                            TLRPC.Peer peer3 = messageFwdHeader.from_id;
                            if (peer3 instanceof TLRPC.TL_peerChannel) {
                                messagesController = MessagesController.getInstance(this.currentAccount);
                                j = messageObject5.messageOwner.fwd_from.from_id.channel_id;
                            } else if (peer3 instanceof TLRPC.TL_peerChat) {
                                messagesController = MessagesController.getInstance(this.currentAccount);
                                j = messageObject5.messageOwner.fwd_from.from_id.chat_id;
                            } else {
                                if (peer3 instanceof TLRPC.TL_peerUser) {
                                    this.currentForwardUser = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(messageObject5.messageOwner.fwd_from.from_id.user_id));
                                }
                                str13 = messageObject5.messageOwner.fwd_from.from_name;
                                if (str13 != null) {
                                    this.currentForwardName = str13;
                                }
                            }
                            this.currentForwardChannel = messagesController.getChat(Long.valueOf(j));
                            str13 = messageObject5.messageOwner.fwd_from.from_name;
                            if (str13 != null) {
                            }
                        }
                        if (this.currentForwardUser == null && this.currentForwardChannel == null && this.currentForwardName == null) {
                            charSequence2 = charSequence;
                            textPaint = textPaint6;
                            str11 = str7;
                            charSequenceRemoveDiacritics = null;
                            charSequenceReplaceEmoji2 = null;
                        } else {
                            if (this.forwardAvatar == null) {
                                AvatarSpan avatarSpan4 = new AvatarSpan(this, this.currentAccount);
                                this.forwardAvatar = avatarSpan4;
                                avatarSpan4.translate(BitmapDescriptorFactory.HUE_RED, AndroidUtilities.dp(-0.33f));
                            }
                            this.forwardAvatar.setSize((((int) Theme.chat_forwardNamePaint.getTextSize()) * 1.23f) / AndroidUtilities.density);
                            TLRPC.Chat chat7 = this.currentForwardChannel;
                            if (chat7 != null) {
                                TLRPC.User user8 = this.currentForwardUser;
                                if (user8 != null) {
                                    userName3 = String.format(str8, chat7.title, UserObject.getUserName(user8));
                                } else {
                                    this.currentForwardNameString = chat7.title;
                                    this.forwardAvatar.setChat(chat7);
                                    z5 = true;
                                    String forwardedMessageText3 = getForwardedMessageText(messageObject);
                                    String str20 = this.currentForwardNameString;
                                    String strReplace = str20 == null ? str2 : str20.replace('\n', ' ');
                                    StringBuilder sb3 = new StringBuilder();
                                    sb3.append(z5 ? str6 : str2);
                                    sb3.append((Object) strReplace);
                                    String string5 = sb3.toString();
                                    TextPaint textPaint7 = Theme.chat_replyNamePaint;
                                    float fDp = maxNameWidth3 - AndroidUtilities.dp(z5 ? 17.33f : BitmapDescriptorFactory.HUE_RED);
                                    TextUtils.TruncateAt truncateAt4 = TextUtils.TruncateAt.END;
                                    charSequenceEllipsize = TextUtils.ellipsize(string5, textPaint7, fDp, truncateAt4);
                                    spannableStringBuilder3 = new SpannableStringBuilder(charSequenceEllipsize);
                                    if (z5 && spannableStringBuilder3.length() > 1) {
                                        spannableStringBuilder3.setSpan(this.forwardAvatar, 0, 1, 33);
                                    }
                                    if (this.currentForwardName == null || messageObject5.messageOwner.fwd_from.from_id != null) {
                                        i9 = 0;
                                        spannableStringBuilder3.setSpan(new TypefaceSpan(AndroidUtilities.bold()), 0, charSequenceEllipsize.length(), 33);
                                    } else {
                                        i9 = 0;
                                    }
                                    CharSequence charSequenceEllipsize5 = TextUtils.ellipsize(spannableStringBuilder3, textPaint6, maxNameWidth3, truncateAt4);
                                    this.forwardNameCenterX = ((int) Math.ceil(Theme.chat_replyNamePaint.measureText(charSequenceEllipsize, i9, charSequenceEllipsize.length()))) / 2;
                                    charSequenceReplaceEmoji2 = charSequenceEllipsize5;
                                    charSequenceRemoveDiacritics = forwardedMessageText3;
                                    charSequence2 = charSequence;
                                    textPaint = textPaint6;
                                    str11 = str7;
                                }
                            } else {
                                TLRPC.User user9 = this.currentForwardUser;
                                if (user9 != null) {
                                    userName3 = UserObject.getUserName(user9);
                                } else {
                                    this.currentForwardNameString = this.currentForwardName;
                                    z5 = false;
                                    String forwardedMessageText32 = getForwardedMessageText(messageObject);
                                    String str202 = this.currentForwardNameString;
                                    if (str202 == null) {
                                    }
                                    StringBuilder sb32 = new StringBuilder();
                                    sb32.append(z5 ? str6 : str2);
                                    sb32.append((Object) strReplace);
                                    String string52 = sb32.toString();
                                    TextPaint textPaint72 = Theme.chat_replyNamePaint;
                                    float fDp2 = maxNameWidth3 - AndroidUtilities.dp(z5 ? 17.33f : BitmapDescriptorFactory.HUE_RED);
                                    TextUtils.TruncateAt truncateAt42 = TextUtils.TruncateAt.END;
                                    charSequenceEllipsize = TextUtils.ellipsize(string52, textPaint72, fDp2, truncateAt42);
                                    spannableStringBuilder3 = new SpannableStringBuilder(charSequenceEllipsize);
                                    if (z5) {
                                        spannableStringBuilder3.setSpan(this.forwardAvatar, 0, 1, 33);
                                    }
                                    if (this.currentForwardName == null) {
                                        i9 = 0;
                                        spannableStringBuilder3.setSpan(new TypefaceSpan(AndroidUtilities.bold()), 0, charSequenceEllipsize.length(), 33);
                                        CharSequence charSequenceEllipsize52 = TextUtils.ellipsize(spannableStringBuilder3, textPaint6, maxNameWidth3, truncateAt42);
                                        this.forwardNameCenterX = ((int) Math.ceil(Theme.chat_replyNamePaint.measureText(charSequenceEllipsize, i9, charSequenceEllipsize.length()))) / 2;
                                        charSequenceReplaceEmoji2 = charSequenceEllipsize52;
                                        charSequenceRemoveDiacritics = forwardedMessageText32;
                                        charSequence2 = charSequence;
                                        textPaint = textPaint6;
                                        str11 = str7;
                                    }
                                }
                            }
                            this.currentForwardNameString = userName3;
                            this.forwardAvatar.setUser(this.currentForwardUser);
                            z5 = true;
                            String forwardedMessageText322 = getForwardedMessageText(messageObject);
                            String str2022 = this.currentForwardNameString;
                            if (str2022 == null) {
                            }
                            StringBuilder sb322 = new StringBuilder();
                            sb322.append(z5 ? str6 : str2);
                            sb322.append((Object) strReplace);
                            String string522 = sb322.toString();
                            TextPaint textPaint722 = Theme.chat_replyNamePaint;
                            float fDp22 = maxNameWidth3 - AndroidUtilities.dp(z5 ? 17.33f : BitmapDescriptorFactory.HUE_RED);
                            TextUtils.TruncateAt truncateAt422 = TextUtils.TruncateAt.END;
                            charSequenceEllipsize = TextUtils.ellipsize(string522, textPaint722, fDp22, truncateAt422);
                            spannableStringBuilder3 = new SpannableStringBuilder(charSequenceEllipsize);
                            if (z5) {
                            }
                            if (this.currentForwardName == null) {
                            }
                        }
                    }
                    charSequenceRemoveDiacritics = Emoji.replaceEmoji(charSequenceRemoveDiacritics, Theme.chat_replyNamePaint.getFontMetricsInt(), false);
                    if (this.isReplyQuote) {
                        maxNameWidth3 -= AndroidUtilities.dp(24.0f);
                    }
                    int iDp9 = maxNameWidth3;
                    strEllipsize = charSequenceRemoveDiacritics != null ? str2 : TextUtils.ellipsize(AndroidUtilities.replaceCharSequence(str11, charSequenceRemoveDiacritics, charSequence2), Theme.chat_replyNamePaint, iDp9, TextUtils.TruncateAt.END);
                    this.replyNameWidth = AndroidUtilities.dp(4.0f) + (!this.needReplyImage ? AndroidUtilities.dp(16.0f) + ((int) (textPaint.getTextSize() + Theme.chat_replyNamePaint.getTextSize())) : 0);
                    if (strEllipsize != null) {
                        StaticLayout staticLayout4 = new StaticLayout(strEllipsize, Theme.chat_replyNamePaint, iDp9 + AndroidUtilities.dp(6.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                        this.replyNameLayout = staticLayout4;
                        if (staticLayout4.getLineCount() > 0) {
                            this.replyNameWidth += ((int) Math.ceil(this.replyNameLayout.getLineWidth(0))) + AndroidUtilities.dp(4.0f);
                            this.replyNameOffset = (int) this.replyNameLayout.getLineLeft(0);
                        }
                    }
                    if (this.isReplyQuote || !z10 || this.replyQuoteDrawable == null) {
                        i13 = this.replyNameWidth;
                        iDp2 = AndroidUtilities.dp(3.0f);
                    } else {
                        i13 = this.replyNameWidth;
                        iDp2 = AndroidUtilities.dp((!this.drawPinnedTop ? 2 : 0) + 6) + this.replyQuoteDrawable.getIntrinsicWidth();
                    }
                    this.replyNameWidth = i13 + iDp2;
                    try {
                        this.replyTextWidth = AndroidUtilities.dp(4.0f) + (!this.needReplyImage ? AndroidUtilities.dp(33.0f) : 0);
                        if (charSequenceReplaceEmoji2 == null) {
                            SpannableStringBuilder spannableStringBuilder10 = new SpannableStringBuilder(charSequenceReplaceEmoji2);
                            boolean z11 = false;
                            for (TextStyleSpan textStyleSpan : (TextStyleSpan[]) spannableStringBuilder10.getSpans(0, spannableStringBuilder10.length(), TextStyleSpan.class)) {
                                if ((textStyleSpan.getTextStyleRun().flags & 4) != 0) {
                                    spannableStringBuilder10.removeSpan(textStyleSpan);
                                    z11 = true;
                                }
                            }
                            this.replyTextRTL = AndroidUtilities.isRTL(spannableStringBuilder10);
                            if (this.isReplyQuote && !this.currentMessageObject.shouldDrawWithoutBackground()) {
                                iDp9 += AndroidUtilities.dp(36.0f);
                            }
                            boolean z12 = this.isReplyQuote;
                            if (z12 && this.needReplyImage && !this.replyTextRTL) {
                                float fDp3 = AndroidUtilities.dp(z12 ? 3.0f : 7.0f) + Theme.chat_replyNamePaint.getTextSize() + Theme.chat_replyTextPaint.getTextSize();
                                spannableStringBuilder10.setSpan(new LeadingMarginSpan.Standard(((int) fDp3) + AndroidUtilities.dp(4.0f), 0), 0, spannableStringBuilder10.length(), 33);
                                this.replyTextWidth = (int) (this.replyTextWidth - fDp3);
                                i11 = (int) (iDp9 + fDp3);
                            } else {
                                i11 = iDp9;
                            }
                            if (z11) {
                                charSequenceEllipsize2 = TextUtils.ellipsize(spannableStringBuilder10, textPaint, i11, TextUtils.TruncateAt.END);
                                this.replyTextOffset = 0;
                                if (Build.VERSION.SDK_INT < 23) {
                                }
                                this.replyTextHeight = this.replyTextLayout.getHeight();
                                if (this.isSideMenued) {
                                    this.namesOffset = (int) (this.namesOffset + Math.max(BitmapDescriptorFactory.HUE_RED, (this.replyTextHeight - AndroidUtilities.dp(3.66f)) - Theme.chat_replyTextPaint.getTextSize()));
                                    if (this.replyTextLayout.getLineCount() > 0) {
                                    }
                                    if (this.isReplyTask) {
                                    }
                                    this.replySpoilers.clear();
                                    if (this.hasReplyQuote) {
                                    }
                                } else {
                                    this.namesOffset = (int) (this.namesOffset + Math.max(BitmapDescriptorFactory.HUE_RED, (this.replyTextHeight - AndroidUtilities.dp(3.66f)) - Theme.chat_replyTextPaint.getTextSize()));
                                    if (this.replyTextLayout.getLineCount() > 0) {
                                    }
                                    if (this.isReplyTask) {
                                    }
                                    this.replySpoilers.clear();
                                    if (this.hasReplyQuote) {
                                        StaticLayout staticLayout5 = this.replyTextLayout;
                                        int i19 = this.replyTextOffset;
                                        r9 = 0;
                                        f2 = 2.0f;
                                        i12 = 1;
                                        SpoilerEffect.addSpoilers(this, staticLayout5, i19, i19 + this.replyTextWidth, this.replySpoilersPool, this.replySpoilers);
                                        AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans = this.animatedEmojiReplyStack;
                                        Layout[] layoutArr = new Layout[i12];
                                        layoutArr[r9] = this.replyTextLayout;
                                        this.animatedEmojiReplyStack = AnimatedEmojiSpan.update((int) r9, this, (boolean) r9, emojiGroupedSpans, layoutArr);
                                    }
                                }
                            } else {
                                charSequenceEllipsize2 = spannableStringBuilder10;
                                if (!this.isReplyQuote) {
                                    charSequenceEllipsize2 = TextUtils.ellipsize(spannableStringBuilder10, textPaint, i11, TextUtils.TruncateAt.END);
                                }
                                this.replyTextOffset = 0;
                                if (Build.VERSION.SDK_INT < 23) {
                                    StaticLayout.Builder includePad = StaticLayout.Builder.obtain(charSequenceEllipsize2, 0, charSequenceEllipsize2.length(), textPaint, i11).setAlignment(Layout.Alignment.ALIGN_NORMAL).setIncludePad(false);
                                    includePad.setBreakStrategy(0);
                                    if (this.isReplyQuote && !this.currentMessageObject.replyTextRevealed) {
                                        includePad.setMaxLines(5).setEllipsize(TextUtils.TruncateAt.END);
                                    }
                                    StaticLayout staticLayoutBuild = includePad.build();
                                    this.replyTextLayout = staticLayoutBuild;
                                    MessageObject messageObject15 = this.currentMessageObject;
                                    if (!messageObject15.replyTextRevealed) {
                                        if (staticLayoutBuild.getLineCount() > 0) {
                                            StaticLayout staticLayout6 = this.replyTextLayout;
                                            boolean z13 = staticLayout6.getEllipsisCount(staticLayout6.getLineCount() - 1) > 0;
                                            messageObject15.replyTextEllipsized = z13;
                                        }
                                    }
                                } else {
                                    this.replyTextLayout = new StaticLayout(charSequenceEllipsize2, 0, charSequenceEllipsize2.length(), textPaint, i11, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false, TextUtils.TruncateAt.END, i11);
                                }
                                this.replyTextHeight = this.replyTextLayout.getHeight();
                                if ((this.isSideMenued && !this.drawBackground) || ((!messageObject.isAnyKindOfSticker() && messageObject5.type != 5) || messageObject5.type == 19)) {
                                    this.namesOffset = (int) (this.namesOffset + Math.max(BitmapDescriptorFactory.HUE_RED, (this.replyTextHeight - AndroidUtilities.dp(3.66f)) - Theme.chat_replyTextPaint.getTextSize()));
                                }
                                if (this.replyTextLayout.getLineCount() > 0) {
                                    this.replyTextOffset = this.replyTextLayout.getWidth();
                                    int iMax2 = 0;
                                    for (int i20 = 0; i20 < this.replyTextLayout.getLineCount(); i20++) {
                                        iMax2 = Math.max(iMax2, (int) Math.ceil(this.replyTextLayout.getLineWidth(i20)));
                                        int iCeil3 = (int) Math.ceil(this.replyTextLayout.getLineLeft(i20));
                                        if (i20 > 0) {
                                            if ((this.replyTextOffset == 0) != (iCeil3 == 0)) {
                                                iMax2 = this.replyTextLayout.getWidth();
                                            }
                                        }
                                        this.replyTextOffset = Math.min(this.replyTextOffset, iCeil3);
                                    }
                                    this.replyTextWidth += iMax2 + AndroidUtilities.dp(18.0f);
                                }
                                if (this.isReplyTask) {
                                    this.replyTextWidth += AndroidUtilities.dp(16.0f);
                                }
                                this.replySpoilers.clear();
                                if (this.hasReplyQuote || !(getMessageObject().replyMessageObject == null || getMessageObject().replyMessageObject.isSpoilersRevealed)) {
                                    StaticLayout staticLayout52 = this.replyTextLayout;
                                    int i192 = this.replyTextOffset;
                                    r9 = 0;
                                    f2 = 2.0f;
                                    i12 = 1;
                                    SpoilerEffect.addSpoilers(this, staticLayout52, i192, i192 + this.replyTextWidth, this.replySpoilersPool, this.replySpoilers);
                                } else {
                                    r9 = 0;
                                    f2 = 2.0f;
                                    i12 = 1;
                                }
                                AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans2 = this.animatedEmojiReplyStack;
                                Layout[] layoutArr2 = new Layout[i12];
                                layoutArr2[r9] = this.replyTextLayout;
                                this.animatedEmojiReplyStack = AnimatedEmojiSpan.update((int) r9, this, (boolean) r9, emojiGroupedSpans2, layoutArr2);
                            }
                        } else {
                            f2 = 2.0f;
                        }
                        i10 = this.replyNameWidth;
                        if (i10 > this.replyTextWidth) {
                            this.replyNameWidth = i10 + AndroidUtilities.dp(Math.max(f2, SharedConfig.bubbleRadius / 4.0f));
                        }
                    } catch (Exception e2) {
                        FileLog.e(e2);
                    }
                } else {
                    charSequenceRemoveDiacritics = AndroidUtilities.removeDiacritics(getNameFromDialogId(DialogObject.getPeerDialogId(messageReplyHeader8.peer)));
                    TL_stories$StoryItem tL_stories$StoryItem = messageObject5.messageOwner.replyStory;
                    if (tL_stories$StoryItem == null || (tL_stories$StoryItem instanceof TL_stories$TL_storyItemDeleted)) {
                        string2 = tL_stories$StoryItem == null ? LocaleController.getString(str5, R.string.Loading) : StoriesUtilities.createExpiredStoryString();
                        this.needReplyImage = false;
                    } else {
                        this.needReplyImage = true;
                        StoriesUtilities.setStoryMiniImage(this.replyImageReceiver, tL_stories$StoryItem);
                        string2 = StoriesUtilities.createReplyStoryString();
                        maxNameWidth3 = (int) (maxNameWidth3 - (AndroidUtilities.dp(16.0f) + (textPaint6.getTextSize() + Theme.chat_replyNamePaint.getTextSize())));
                    }
                    charSequenceReplaceEmoji2 = string2;
                    charSequence2 = charSequence;
                    textPaint = textPaint6;
                    str11 = str7;
                }
                charSequenceRemoveDiacritics = Emoji.replaceEmoji(charSequenceRemoveDiacritics, Theme.chat_replyNamePaint.getFontMetricsInt(), false);
                if (this.isReplyQuote) {
                }
                int iDp92 = maxNameWidth3;
                if (charSequenceRemoveDiacritics != null) {
                }
                this.replyNameWidth = AndroidUtilities.dp(4.0f) + (!this.needReplyImage ? AndroidUtilities.dp(16.0f) + ((int) (textPaint.getTextSize() + Theme.chat_replyNamePaint.getTextSize())) : 0);
                if (strEllipsize != null) {
                }
                if (this.isReplyQuote) {
                    i13 = this.replyNameWidth;
                    iDp2 = AndroidUtilities.dp(3.0f);
                    this.replyNameWidth = i13 + iDp2;
                    this.replyTextWidth = AndroidUtilities.dp(4.0f) + (!this.needReplyImage ? AndroidUtilities.dp(33.0f) : 0);
                    if (charSequenceReplaceEmoji2 == null) {
                    }
                    i10 = this.replyNameWidth;
                    if (i10 > this.replyTextWidth) {
                    }
                }
            }
        }
        requestLayout();
    }

    private boolean shouldDrawCaptionLayout() {
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        MessageObject.GroupedMessages groupedMessages;
        MessageObject messageObject = this.currentMessageObject;
        return (messageObject == null || messageObject.preview || messageObject.isSponsored() || ((groupedMessagePosition = this.currentPosition) != null && ((groupedMessages = this.currentMessagesGroup) == null || !groupedMessages.isDocuments || (groupedMessagePosition.flags & 8) != 0)) || this.transitionParams.animateBackgroundBoundsInner || (this.enterTransitionInProgress && this.currentMessageObject.isVoice())) ? false : true;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public boolean shouldDrawMenuDrawable() {
        MessageObject messageObject;
        return (this.currentMessagesGroup == null || (this.currentPosition.flags & 4) != 0) && !this.hasLinkPreview && ((messageObject = this.currentMessageObject) == null || !(messageObject.isRepostPreview || messageObject.isSponsored()));
    }

    private boolean shouldDrawSelectionOverlay() {
        return hasSelectionOverlay() && ((isPressed() && this.isCheckPressed) || ((!this.isCheckPressed && this.isPressed) || this.isHighlighted || this.isHighlightedAnimated)) && !textIsSelectionMode() && ((this.currentMessagesGroup == null || this.drawSelectionBackground) && this.currentBackgroundDrawable != null);
    }

    private static boolean spanSupportsLongPress(CharacterStyle characterStyle) {
        return (characterStyle instanceof URLSpanMono) || (characterStyle instanceof URLSpan);
    }

    private void startRevealMedia(float f, float f2, float f3) throws Resources.NotFoundException, NumberFormatException {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject.isMediaSpoilersRevealed || this.mediaSpoilerRevealProgress != BitmapDescriptorFactory.HUE_RED) {
            return;
        }
        if (messageObject.type == 3) {
            messageObject.forceUpdate = true;
            messageObject.revealingMediaSpoilers = true;
            setMessageContent(messageObject, this.currentMessagesGroup, this.pinnedBottom, this.pinnedTop, this.firstInChat);
            MessageObject messageObject2 = this.currentMessageObject;
            messageObject2.revealingMediaSpoilers = false;
            messageObject2.forceUpdate = false;
            if (this.currentMessagesGroup != null) {
                this.radialProgress.setProgress(BitmapDescriptorFactory.HUE_RED, false);
            }
        }
        this.mediaSpoilerRevealX = f;
        this.mediaSpoilerRevealY = f2;
        ValueAnimator duration = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f).setDuration((long) MathUtils.clamp(this.mediaSpoilerRevealMaxRadius * 0.3f, 250.0f, 550.0f));
        duration.setInterpolator(CubicBezierInterpolator.EASE_BOTH);
        duration.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda7
            @Override // android.animation.ValueAnimator.AnimatorUpdateListener
            public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                this.f$0.lambda$startRevealMedia$13(valueAnimator);
            }
        });
        duration.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.Cells.ChatMessageCell.8
            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
            public void onAnimationEnd(Animator animator) {
                ChatMessageCell.this.currentMessageObject.isMediaSpoilersRevealed = true;
                ChatMessageCell.this.invalidate();
            }
        });
        duration.start();
    }

    private boolean textIsSelectionMode() {
        ChatMessageCellDelegate chatMessageCellDelegate;
        return getCurrentMessagesGroup() == null && (chatMessageCellDelegate = this.delegate) != null && chatMessageCellDelegate.getTextSelectionHelper() != null && this.delegate.getTextSelectionHelper().isSelected(this.currentMessageObject);
    }

    /* JADX WARN: Code restructure failed: missing block: B:35:0x008d, code lost:
    
        if ((r1 instanceof org.telegram.tgnet.TLRPC.TL_peerUser) != false) goto L50;
     */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void updateCurrentUserAndChat() {
        TLRPC.Peer peer;
        Long lValueOf;
        long peerDialogId;
        TLRPC.User currentUser;
        TLRPC.TL_user tL_user;
        String str;
        TLRPC.Peer peer2;
        TLRPC.Peer peer3;
        Long lValueOf2;
        long j;
        if (this.currentMessageObject == null) {
            return;
        }
        MessagesController messagesController = MessagesController.getInstance(this.currentAccount);
        TLRPC.MessageFwdHeader messageFwdHeader = this.currentMessageObject.messageOwner.fwd_from;
        long clientUserId = UserConfig.getInstance(this.currentAccount).getClientUserId();
        if (messageFwdHeader == null || !(messageFwdHeader.from_id instanceof TLRPC.TL_peerChannel) || (this.currentMessageObject.getDialogId() != clientUserId && this.currentMessageObject.getDialogId() != UserObject.REPLY_BOT)) {
            if (messageFwdHeader == null || this.currentMessageObject.getDialogId() != UserObject.VERIFY) {
                if (messageFwdHeader != null && (peer3 = messageFwdHeader.saved_from_peer) != null) {
                    long j2 = peer3.user_id;
                    if (j2 != 0) {
                        if (!this.isSavedChat) {
                            peer2 = messageFwdHeader.from_id;
                        }
                        lValueOf = Long.valueOf(j2);
                        currentUser = messagesController.getUser(lValueOf);
                    } else if (peer3.channel_id != 0) {
                        if (this.currentMessageObject.isSavedFromMegagroup()) {
                            TLRPC.Peer peer4 = messageFwdHeader.from_id;
                            if (peer4 instanceof TLRPC.TL_peerUser) {
                                peerDialogId = peer4.user_id;
                            }
                        }
                        peer = messageFwdHeader.saved_from_peer;
                    } else {
                        long j3 = peer3.chat_id;
                        if (j3 == 0) {
                            return;
                        }
                        peer2 = messageFwdHeader.from_id;
                        if (!(peer2 instanceof TLRPC.TL_peerUser)) {
                            lValueOf2 = Long.valueOf(j3);
                            this.currentChat = messagesController.getChat(lValueOf2);
                        }
                    }
                    peerDialogId = peer2.user_id;
                } else {
                    if (messageFwdHeader == null || !(messageFwdHeader.from_id instanceof TLRPC.TL_peerUser) || (!messageFwdHeader.imported && this.currentMessageObject.getDialogId() != clientUserId)) {
                        if (messageFwdHeader != null && !TextUtils.isEmpty(messageFwdHeader.saved_from_name) && (messageFwdHeader.imported || this.currentMessageObject.getDialogId() == clientUserId)) {
                            tL_user = new TLRPC.TL_user();
                            this.currentUser = tL_user;
                            str = messageFwdHeader.saved_from_name;
                        } else if (messageFwdHeader == null || TextUtils.isEmpty(messageFwdHeader.from_name) || !(messageFwdHeader.imported || this.currentMessageObject.getDialogId() == clientUserId)) {
                            long dialogId = this.currentMessageObject.getDialogId();
                            long fromChatId = this.currentMessageObject.getFromChatId();
                            TLRPC.Chat chat = DialogObject.isChatDialog(fromChatId) ? messagesController.getChat(Long.valueOf(-fromChatId)) : null;
                            TLRPC.Chat chat2 = DialogObject.isChatDialog(dialogId) ? messagesController.getChat(Long.valueOf(-dialogId)) : null;
                            if (DialogObject.isEncryptedDialog(this.currentMessageObject.getDialogId())) {
                                if (this.currentMessageObject.isOutOwner()) {
                                    currentUser = UserConfig.getInstance(this.currentAccount).getCurrentUser();
                                } else {
                                    TLRPC.EncryptedChat encryptedChat = messagesController.getEncryptedChat(Integer.valueOf(DialogObject.getEncryptedChatId(this.currentMessageObject.getDialogId())));
                                    if (encryptedChat == null) {
                                        return;
                                    } else {
                                        peerDialogId = encryptedChat.user_id;
                                    }
                                }
                            } else if (DialogObject.isUserDialog(fromChatId) && (!this.currentMessageObject.messageOwner.post || (chat != null && chat.signature_profiles))) {
                                lValueOf = Long.valueOf(fromChatId);
                                currentUser = messagesController.getUser(lValueOf);
                            } else if (this.currentMessageObject.messageOwner.post && chat2 != null && !chat2.signature_profiles) {
                                this.currentChat = chat2;
                                return;
                            } else {
                                if (DialogObject.isChatDialog(fromChatId)) {
                                    this.currentChat = chat;
                                    return;
                                }
                                TLRPC.Message message = this.currentMessageObject.messageOwner;
                                if (!message.post) {
                                    return;
                                } else {
                                    peer = message.peer_id;
                                }
                            }
                        } else {
                            tL_user = new TLRPC.TL_user();
                            this.currentUser = tL_user;
                            str = messageFwdHeader.from_name;
                        }
                        tL_user.first_name = str;
                        return;
                    }
                    peer2 = messageFwdHeader.from_id;
                    peerDialogId = peer2.user_id;
                }
                this.currentUser = currentUser;
                return;
            }
            peerDialogId = DialogObject.getPeerDialogId(messageFwdHeader.from_id);
            if (peerDialogId < 0) {
                j = -peerDialogId;
                lValueOf2 = Long.valueOf(j);
                this.currentChat = messagesController.getChat(lValueOf2);
            }
            lValueOf = Long.valueOf(peerDialogId);
            currentUser = messagesController.getUser(lValueOf);
            this.currentUser = currentUser;
            return;
        }
        messagesController = MessagesController.getInstance(this.currentAccount);
        peer = messageFwdHeader.from_id;
        j = peer.channel_id;
        lValueOf2 = Long.valueOf(j);
        this.currentChat = messagesController.getChat(lValueOf2);
    }

    private void updateFlagSecure() {
        if (this.flagSecure == null) {
            Activity activityFindActivity = AndroidUtilities.findActivity(getContext());
            Window window = activityFindActivity == null ? null : activityFindActivity.getWindow();
            if (window != null) {
                FlagSecureReason flagSecureReason = new FlagSecureReason(window, new FlagSecureReason.FlagSecureCondition() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda6
                    @Override // org.telegram.messenger.FlagSecureReason.FlagSecureCondition
                    public final boolean run() {
                        return this.f$0.lambda$updateFlagSecure$10();
                    }
                });
                this.flagSecure = flagSecureReason;
                if (this.attachedToWindow) {
                    flagSecureReason.attach();
                }
            }
        }
        FlagSecureReason flagSecureReason2 = this.flagSecure;
        if (flagSecureReason2 != null) {
            flagSecureReason2.invalidate();
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:32:0x0099  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void updatePollAnimations(long j) {
        if (this.pollVoteInProgress) {
            this.voteRadOffset = (this.voteRadOffset + ((360 * j) / 2000.0f)) - (((int) (r0 / 360.0f)) * 360);
            float f = this.voteCurrentProgressTime + j;
            this.voteCurrentProgressTime = f;
            if (f >= 500.0f) {
                this.voteCurrentProgressTime = 500.0f;
            }
            if (this.voteRisingCircleLength) {
                this.voteCurrentCircleLength = (AndroidUtilities.accelerateInterpolator.getInterpolation(this.voteCurrentProgressTime / 500.0f) * 266.0f) + 4.0f;
            } else {
                this.voteCurrentCircleLength = 4.0f - ((this.firstCircleLength ? 360 : 270) * (1.0f - AndroidUtilities.decelerateInterpolator.getInterpolation(this.voteCurrentProgressTime / 500.0f)));
            }
            if (this.voteCurrentProgressTime == 500.0f) {
                boolean z = this.voteRisingCircleLength;
                if (z) {
                    this.voteRadOffset += 270.0f;
                    this.voteCurrentCircleLength = -266.0f;
                }
                this.voteRisingCircleLength = !z;
                if (this.firstCircleLength) {
                    this.firstCircleLength = false;
                }
                this.voteCurrentProgressTime = BitmapDescriptorFactory.HUE_RED;
            }
            invalidate();
        }
        boolean z2 = this.hintButtonVisible;
        if (z2) {
            float f2 = this.hintButtonProgress;
            if (f2 < 1.0f) {
                float f3 = f2 + (j / 180.0f);
                this.hintButtonProgress = f3;
                if (f3 > 1.0f) {
                    this.hintButtonProgress = 1.0f;
                }
            } else if (!z2) {
                float f4 = this.hintButtonProgress;
                if (f4 > BitmapDescriptorFactory.HUE_RED) {
                    float f5 = f4 - (j / 180.0f);
                    this.hintButtonProgress = f5;
                    if (f5 < BitmapDescriptorFactory.HUE_RED) {
                        this.hintButtonProgress = BitmapDescriptorFactory.HUE_RED;
                    }
                }
            }
            invalidate();
        }
        if (this.animatePollAnswer) {
            float f6 = this.pollAnimationProgressTime + j;
            this.pollAnimationProgressTime = f6;
            if (f6 >= 300.0f) {
                this.pollAnimationProgressTime = 300.0f;
            }
            float interpolation = AndroidUtilities.decelerateInterpolator.getInterpolation(this.pollAnimationProgressTime / 300.0f);
            this.pollAnimationProgress = interpolation;
            if (interpolation >= 1.0f) {
                this.pollAnimationProgress = 1.0f;
                this.animatePollAnswer = false;
                this.animatePollAnswerAlpha = false;
                this.pollVoteInProgress = false;
                if (this.pollUnvoteInProgress && this.animatePollAvatars) {
                    int i = 0;
                    while (true) {
                        ImageReceiver[] imageReceiverArr = this.pollAvatarImages;
                        if (i >= imageReceiverArr.length) {
                            break;
                        }
                        imageReceiverArr[i].setImageBitmap((Drawable) null);
                        this.pollAvatarImagesVisible[i] = false;
                        i++;
                    }
                }
                this.pollUnvoteInProgress = false;
                int size = this.pollButtons.size();
                for (int i2 = 0; i2 < size; i2++) {
                    ((PollButton) this.pollButtons.get(i2)).prevChosen = false;
                }
            }
            invalidate();
        }
    }

    private void updateRadialProgressBackground() {
        if (this.drawRadialCheckBackground) {
            return;
        }
        boolean z = true;
        boolean z2 = (this.isHighlighted || this.isPressed || isPressed()) && !(this.drawPhotoImage && this.photoImage.hasBitmapImage());
        this.radialProgress.setPressed(z2 || this.buttonPressed != 0, false);
        if (this.hasMiniProgress != 0) {
            this.radialProgress.setPressed(z2 || this.miniButtonPressed != 0, true);
        }
        RadialProgress2 radialProgress2 = this.videoRadialProgress;
        if (!z2 && this.videoButtonPressed == 0) {
            z = false;
        }
        radialProgress2.setPressed(z, false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:115:0x01df  */
    /* JADX WARN: Removed duplicated region for block: B:116:0x01f9  */
    /* JADX WARN: Removed duplicated region for block: B:13:0x0022  */
    /* JADX WARN: Removed duplicated region for block: B:49:0x00e2  */
    /* JADX WARN: Removed duplicated region for block: B:53:0x00f1  */
    /* JADX WARN: Removed duplicated region for block: B:54:0x00f4  */
    /* JADX WARN: Removed duplicated region for block: B:58:0x0121  */
    /* JADX WARN: Removed duplicated region for block: B:65:0x0137  */
    /* JADX WARN: Removed duplicated region for block: B:68:0x013f  */
    /* JADX WARN: Removed duplicated region for block: B:77:0x015f  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void updateReactionLayoutPosition() {
        int iDp;
        float fDp;
        ReactionsLayoutInBubble reactionsLayoutInBubble;
        int currentBackgroundLeft;
        int measuredWidth;
        int iDp2;
        int iDp3;
        int i;
        if (this.currentMessageObject.shouldDrawReactions()) {
            ReactionsLayoutInBubble reactionsLayoutInBubble2 = this.reactionsLayoutInBubble;
            int iDp4 = 0;
            if (!reactionsLayoutInBubble2.isEmpty) {
                MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
                if (groupedMessagePosition != null) {
                    int i2 = groupedMessagePosition.flags;
                    if ((i2 & 8) != 0 && (i2 & 1) != 0) {
                        if (!reactionsLayoutInBubble2.isSmall) {
                            MessageObject messageObject = this.currentMessageObject;
                            if (messageObject.type != 19 && !messageObject.isAnimatedEmoji() && !this.currentMessageObject.isAnyKindOfSticker()) {
                                if (this.currentMessageObject.isOutOwner()) {
                                    this.reactionsLayoutInBubble.x = getCurrentBackgroundLeft() + AndroidUtilities.dp(11.0f);
                                } else if (this.isRoundVideo) {
                                    this.reactionsLayoutInBubble.x = getCurrentBackgroundLeft() + AndroidUtilities.dp(11.0f) + AndroidUtilities.dp(AndroidUtilities.lerp(0, !this.drawPinnedBottom ? 6 : 0, getVideoTranscriptionProgress()));
                                    reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                                    measuredWidth = reactionsLayoutInBubble.x;
                                    iDp2 = (int) ((1.0f - getVideoTranscriptionProgress()) * AndroidUtilities.dp(9.0f));
                                } else {
                                    this.reactionsLayoutInBubble.x = getCurrentBackgroundLeft() + AndroidUtilities.dp((this.mediaBackground || !this.drawPinnedBottom) ? 17.0f : 11.0f);
                                    if (this.mediaBackground) {
                                        reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                                        measuredWidth = reactionsLayoutInBubble.x;
                                        iDp2 = AndroidUtilities.dp(9.0f);
                                    }
                                }
                                if (!this.currentMessageObject.isOutOwner()) {
                                    this.reactionsLayoutInBubble.x = (int) (r0.x - (AndroidUtilities.dp(64 - (!needDrawAvatar() ? 48 : 0)) * this.sideMenuAlpha));
                                }
                                ReactionsLayoutInBubble reactionsLayoutInBubble3 = this.reactionsLayoutInBubble;
                                int backgroundDrawableBottom = getBackgroundDrawableBottom() - AndroidUtilities.dp(10.0f);
                                ReactionsLayoutInBubble reactionsLayoutInBubble4 = this.reactionsLayoutInBubble;
                                reactionsLayoutInBubble3.y = backgroundDrawableBottom - reactionsLayoutInBubble4.height;
                                int i3 = reactionsLayoutInBubble4.y;
                                if (this.drawCommentButton) {
                                }
                                reactionsLayoutInBubble4.y = i3 - iDp3;
                                if (this.hasNewLineForTime) {
                                    this.reactionsLayoutInBubble.y -= AndroidUtilities.dp(16.0f);
                                }
                                MessageObject messageObject2 = this.currentMessageObject;
                                i = messageObject2.type;
                                if (i != 9) {
                                    this.reactionsLayoutInBubble.y -= AndroidUtilities.dp(14.0f);
                                }
                                ReactionsLayoutInBubble reactionsLayoutInBubble5 = this.reactionsLayoutInBubble;
                                reactionsLayoutInBubble5.y += reactionsLayoutInBubble5.positionOffsetY;
                            } else if (this.currentMessageObject.isOutOwner()) {
                                reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                                measuredWidth = getMeasuredWidth() - this.reactionsLayoutInBubble.width;
                                iDp2 = AndroidUtilities.dp(16.0f);
                            } else {
                                reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                                currentBackgroundLeft = getCurrentBackgroundLeft();
                                reactionsLayoutInBubble.x = currentBackgroundLeft;
                                if (!this.currentMessageObject.isOutOwner() && this.currentPosition != null) {
                                    this.reactionsLayoutInBubble.x = (int) (r0.x - (AndroidUtilities.dp(64 - (!needDrawAvatar() ? 48 : 0)) * this.sideMenuAlpha));
                                }
                                ReactionsLayoutInBubble reactionsLayoutInBubble32 = this.reactionsLayoutInBubble;
                                int backgroundDrawableBottom2 = getBackgroundDrawableBottom() - AndroidUtilities.dp(10.0f);
                                ReactionsLayoutInBubble reactionsLayoutInBubble42 = this.reactionsLayoutInBubble;
                                reactionsLayoutInBubble32.y = backgroundDrawableBottom2 - reactionsLayoutInBubble42.height;
                                int i32 = reactionsLayoutInBubble42.y;
                                if (this.drawCommentButton) {
                                    iDp3 = AndroidUtilities.dp((this.currentMessageObject.type == 29 && hasCaptionLayout()) ? 28.0f : 43.0f);
                                } else {
                                    iDp3 = 0;
                                }
                                reactionsLayoutInBubble42.y = i32 - iDp3;
                                if (this.hasNewLineForTime && (!this.drawForwardedName || !this.hasLinkPreview || this.documentAttachType != 3)) {
                                    this.reactionsLayoutInBubble.y -= AndroidUtilities.dp(16.0f);
                                }
                                MessageObject messageObject22 = this.currentMessageObject;
                                i = messageObject22.type;
                                if (i != 9 && this.captionLayout != null && ((i != 2 && (!messageObject22.isOut() || !this.drawForwardedName || this.drawPhotoImage)) || ((this.currentPosition != null && this.currentMessagesGroup != null) || this.currentMessageObject.type == 29))) {
                                    this.reactionsLayoutInBubble.y -= AndroidUtilities.dp(14.0f);
                                }
                                ReactionsLayoutInBubble reactionsLayoutInBubble52 = this.reactionsLayoutInBubble;
                                reactionsLayoutInBubble52.y += reactionsLayoutInBubble52.positionOffsetY;
                            }
                            currentBackgroundLeft = measuredWidth - iDp2;
                            reactionsLayoutInBubble.x = currentBackgroundLeft;
                            if (!this.currentMessageObject.isOutOwner()) {
                            }
                            ReactionsLayoutInBubble reactionsLayoutInBubble322 = this.reactionsLayoutInBubble;
                            int backgroundDrawableBottom22 = getBackgroundDrawableBottom() - AndroidUtilities.dp(10.0f);
                            ReactionsLayoutInBubble reactionsLayoutInBubble422 = this.reactionsLayoutInBubble;
                            reactionsLayoutInBubble322.y = backgroundDrawableBottom22 - reactionsLayoutInBubble422.height;
                            int i322 = reactionsLayoutInBubble422.y;
                            if (this.drawCommentButton) {
                            }
                            reactionsLayoutInBubble422.y = i322 - iDp3;
                            if (this.hasNewLineForTime) {
                            }
                            MessageObject messageObject222 = this.currentMessageObject;
                            i = messageObject222.type;
                            if (i != 9) {
                            }
                            ReactionsLayoutInBubble reactionsLayoutInBubble522 = this.reactionsLayoutInBubble;
                            reactionsLayoutInBubble522.y += reactionsLayoutInBubble522.positionOffsetY;
                        }
                    }
                }
            }
            ReactionsLayoutInBubble reactionsLayoutInBubble6 = this.reactionsLayoutInBubble;
            if (!reactionsLayoutInBubble6.isSmall || reactionsLayoutInBubble6.isEmpty) {
                return;
            }
            if (shouldDrawTimeOnMedia()) {
                if (this.drawCommentButton) {
                    iDp4 = AndroidUtilities.dp(41.3f);
                }
            } else {
                if (this.currentMessageObject.isSponsored()) {
                    iDp = -AndroidUtilities.dp(48.0f);
                    if (this.hasNewLineForTime) {
                        iDp -= AndroidUtilities.dp(16.0f);
                    }
                    ReactionsLayoutInBubble reactionsLayoutInBubble7 = this.reactionsLayoutInBubble;
                    if (shouldDrawTimeOnMedia()) {
                        fDp = ((this.layoutHeight - AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 7.5f : 6.5f)) - this.timeLayout.getHeight()) + iDp;
                    } else {
                        fDp = ((getPhotoBottom() + this.additionalTimeOffsetY) - AndroidUtilities.dp(7.3f)) - this.timeLayout.getHeight();
                    }
                    reactionsLayoutInBubble7.y = (int) fDp;
                    this.reactionsLayoutInBubble.y = (int) (r0.y + ((this.timeLayout.getHeight() / 2.0f) - AndroidUtilities.dp(7.0f)));
                    this.reactionsLayoutInBubble.x = this.timeX;
                }
                if (this.drawCommentButton) {
                    iDp4 = AndroidUtilities.dp(43.0f);
                }
            }
            iDp = -iDp4;
            ReactionsLayoutInBubble reactionsLayoutInBubble72 = this.reactionsLayoutInBubble;
            if (shouldDrawTimeOnMedia()) {
            }
            reactionsLayoutInBubble72.y = (int) fDp;
            this.reactionsLayoutInBubble.y = (int) (r0.y + ((this.timeLayout.getHeight() / 2.0f) - AndroidUtilities.dp(7.0f)));
            this.reactionsLayoutInBubble.x = this.timeX;
        }
    }

    private void updateSecretTimeText(MessageObject messageObject) {
        CharSequence secretTimeString;
        if (messageObject == null || !messageObject.needDrawBluredPreview() || (secretTimeString = messageObject.getSecretTimeString()) == null) {
            return;
        }
        if (secretTimeString instanceof String) {
            int iCeil = (int) Math.ceil(Theme.chat_infoPaint.measureText((String) secretTimeString));
            this.infoWidth = iCeil;
            this.infoLayout = new StaticLayout(TextUtils.ellipsize(secretTimeString, Theme.chat_infoPaint, iCeil, TextUtils.TruncateAt.END), Theme.chat_infoPaint, this.infoWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
        } else {
            StaticLayout staticLayout = new StaticLayout(secretTimeString, Theme.chat_infoBoldPaint, getMeasuredWidth() > 0 ? getMeasuredWidth() : 9999, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
            this.infoLayout = staticLayout;
            this.infoWidth = staticLayout.getLineCount() > 0 ? (int) this.infoLayout.getLineWidth(0) : 0;
        }
        invalidate();
    }

    /* JADX WARN: Removed duplicated region for block: B:86:0x01a0 A[PHI: r2 r3 r5
      0x01a0: PHI (r2v20 org.telegram.ui.Components.SeekBar) = (r2v7 org.telegram.ui.Components.SeekBar), (r2v22 org.telegram.ui.Components.SeekBar) binds: [B:85:0x019e, B:51:0x0107] A[DONT_GENERATE, DONT_INLINE]
      0x01a0: PHI (r3v12 int) = (r3v2 int), (r3v18 int) binds: [B:85:0x019e, B:51:0x0107] A[DONT_GENERATE, DONT_INLINE]
      0x01a0: PHI (r5v3 int) = (r5v1 int), (r5v6 int) binds: [B:85:0x019e, B:51:0x0107] A[DONT_GENERATE, DONT_INLINE]] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void updateSeekBarWaveformWidth(Canvas canvas) {
        SeekBar seekBar;
        int useTranscribeButtonProgress;
        int i;
        int i2;
        int iDp;
        int iDp2;
        int iDp3;
        int iDp4;
        int i3 = 0;
        this.seekBarWaveformTranslateX = 0;
        this.seekBarTranslateX = 0;
        int i4 = -AndroidUtilities.dp((this.hasLinkPreview ? 10 : 0) + 92);
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateBackgroundBoundsInner && ((i2 = this.documentAttachType) == 3 || i2 == 7)) {
            int i5 = this.backgroundWidth;
            float f = i5;
            int iDp5 = (int) ((f - transitionParams.toDeltaLeft) + transitionParams.toDeltaRight);
            int videoTranscriptionProgress = (int) ((f - transitionParams.deltaLeft) + transitionParams.deltaRight);
            if (this.isRoundVideo && !this.drawBackground) {
                videoTranscriptionProgress = (int) (videoTranscriptionProgress + (getVideoTranscriptionProgress() * AndroidUtilities.dp(8.0f)));
                iDp5 += AndroidUtilities.dp(8.0f);
            }
            TransitionParams transitionParams2 = this.transitionParams;
            if (transitionParams2.toDeltaLeft == BitmapDescriptorFactory.HUE_RED && transitionParams2.toDeltaRight == BitmapDescriptorFactory.HUE_RED) {
                iDp5 = videoTranscriptionProgress;
            }
            SeekBarWaveform seekBarWaveform = this.seekBarWaveform;
            if (seekBarWaveform != null) {
                if (transitionParams2.animateUseTranscribeButton) {
                    iDp = ((videoTranscriptionProgress + i4) - ((int) (AndroidUtilities.dp(34.0f) * getUseTranscribeButtonProgress()))) - AndroidUtilities.dp(this.hasLinkPreview ? 10.0f : BitmapDescriptorFactory.HUE_RED);
                    iDp2 = AndroidUtilities.dp(30.0f);
                    iDp3 = i5 + i4 + (!this.useTranscribeButton ? -AndroidUtilities.dp(34.0f) : 0);
                    iDp4 = iDp5 + i4 + (this.useTranscribeButton ? -AndroidUtilities.dp(34.0f) : 0);
                } else {
                    iDp = ((videoTranscriptionProgress + i4) - ((int) (AndroidUtilities.dp(34.0f) * getUseTranscribeButtonProgress()))) - AndroidUtilities.dp(this.hasLinkPreview ? 10.0f : BitmapDescriptorFactory.HUE_RED);
                    iDp2 = AndroidUtilities.dp(30.0f);
                    iDp3 = (i5 + i4) - ((int) (AndroidUtilities.dp(34.0f) * getUseTranscribeButtonProgress()));
                    iDp4 = (iDp5 + i4) - ((int) (AndroidUtilities.dp(34.0f) * getUseTranscribeButtonProgress()));
                }
                seekBarWaveform.setSize(iDp, iDp2, iDp3, iDp4);
            }
            seekBar = this.seekBar;
            if (seekBar == null) {
                return;
            }
            useTranscribeButtonProgress = videoTranscriptionProgress - ((int) (getUseTranscribeButtonProgress() * AndroidUtilities.dp(34.0f)));
            i = this.documentAttachType == 5 ? 65 : 72;
            if (this.hasLinkPreview) {
            }
        } else {
            SeekBarWaveform seekBarWaveform2 = this.seekBarWaveform;
            if (seekBarWaveform2 != null) {
                if (transitionParams.animateUseTranscribeButton) {
                    seekBarWaveform2.setSize(((this.backgroundWidth + i4) - ((int) (AndroidUtilities.dp(34.0f) * getUseTranscribeButtonProgress()))) - AndroidUtilities.dp(this.hasLinkPreview ? 10.0f : BitmapDescriptorFactory.HUE_RED), AndroidUtilities.dp(30.0f), ((this.backgroundWidth + i4) + (!this.useTranscribeButton ? -AndroidUtilities.dp(34.0f) : 0)) - AndroidUtilities.dp(this.hasLinkPreview ? 10.0f : BitmapDescriptorFactory.HUE_RED), this.backgroundWidth + i4 + (this.useTranscribeButton ? -AndroidUtilities.dp(34.0f) : 0));
                } else {
                    seekBarWaveform2.setSize(((this.backgroundWidth + i4) - ((int) (AndroidUtilities.dp(34.0f) * getUseTranscribeButtonProgress()))) - AndroidUtilities.dp(this.hasLinkPreview ? 10.0f : BitmapDescriptorFactory.HUE_RED), AndroidUtilities.dp(30.0f));
                }
            }
            seekBar = this.seekBar;
            if (seekBar == null) {
                return;
            }
            useTranscribeButtonProgress = this.backgroundWidth - ((int) (getUseTranscribeButtonProgress() * AndroidUtilities.dp(34.0f)));
            i = this.documentAttachType == 5 ? 65 : 72;
            if (this.hasLinkPreview) {
                i3 = 20;
            }
        }
        seekBar.setSize(useTranscribeButtonProgress - AndroidUtilities.dp(i + i3), AndroidUtilities.dp(30.0f));
    }

    private void updateSelectionTextPosition() {
        TextSelectionHelper.ChatListTextSelectionHelper textSelectionHelper;
        int i;
        int i2;
        int i3;
        int iDp;
        if (getDelegate() == null || getDelegate().getTextSelectionHelper() == null || !getDelegate().getTextSelectionHelper().isSelected(this.currentMessageObject)) {
            return;
        }
        int textSelectionType = getDelegate().getTextSelectionHelper().getTextSelectionType(this);
        if (textSelectionType == TextSelectionHelper.ChatListTextSelectionHelper.TYPE_DESCRIPTION) {
            getDelegate().getTextSelectionHelper().updateTextPosition((this.hasGamePreview ? this.unmovedTextX - AndroidUtilities.dp(10.0f) : this.unmovedTextX + AndroidUtilities.dp(1.0f)) + AndroidUtilities.dp(10.0f) + this.descriptionX, this.descriptionY);
            return;
        }
        if (textSelectionType == TextSelectionHelper.ChatListTextSelectionHelper.TYPE_CAPTION) {
            updateCaptionLayout();
            textSelectionHelper = getDelegate().getTextSelectionHelper();
            i = (int) this.captionX;
            i2 = (int) this.captionY;
        } else {
            if (textSelectionType == TextSelectionHelper.ChatListTextSelectionHelper.TYPE_FACTCHECK) {
                MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
                if (groupedMessages == null || groupedMessages.isDocuments) {
                    float f = 12.0f;
                    if (this.currentMessageObject.isOutOwner()) {
                        iDp = this.backgroundDrawableLeft + AndroidUtilities.dp(12.0f) + getExtraTextX();
                        if (this.currentMessageObject.type == 19) {
                            iDp -= Math.max(0, ((Math.max(this.replyNameWidth, this.replyTextWidth) + iDp) + AndroidUtilities.dp(14.0f)) - AndroidUtilities.displaySize.x);
                        }
                    } else {
                        if (this.mediaBackground) {
                            i3 = this.backgroundDrawableLeft;
                        } else {
                            i3 = this.backgroundDrawableLeft;
                            if (!this.drawPinnedBottom) {
                                f = 18.0f;
                            }
                        }
                        iDp = i3 + AndroidUtilities.dp(f) + getExtraTextX();
                    }
                } else {
                    iDp = (int) this.captionX;
                }
                int iDp2 = ((int) (iDp + this.transitionParams.deltaLeft)) - AndroidUtilities.dp(1.33f);
                int i4 = this.factCheckY;
                updateCaptionLayout();
                getDelegate().getTextSelectionHelper().updateTextPosition((iDp2 + AndroidUtilities.dp(10.0f)) - this.factCheckTextLayoutLeft, i4 + AndroidUtilities.dp(22.0f));
                return;
            }
            textSelectionHelper = getDelegate().getTextSelectionHelper();
            i = this.textX;
            i2 = this.textY;
        }
        textSelectionHelper.updateTextPosition(i, i2);
    }

    private void updateSpoilersVisiblePart(int i, int i2) {
        ArrayList<MessageObject.TextLayoutBlock> arrayList;
        MessageObject.TextLayoutBlocks textLayoutBlocks = this.captionLayout;
        if (textLayoutBlocks != null && (arrayList = textLayoutBlocks.textLayoutBlocks) != null) {
            Iterator<MessageObject.TextLayoutBlock> it = arrayList.iterator();
            while (it.hasNext()) {
                MessageObject.TextLayoutBlock next = it.next();
                Iterator<SpoilerEffect> it2 = next.spoilers.iterator();
                while (it2.hasNext()) {
                    it2.next().setVisibleBounds(BitmapDescriptorFactory.HUE_RED, (i - next.textYOffset(this.captionLayout.textLayoutBlocks, this.transitionParams)) - this.captionX, getWidth(), (i2 - next.textYOffset(this.captionLayout.textLayoutBlocks, this.transitionParams)) - this.captionY);
                }
            }
        }
        StaticLayout staticLayout = this.replyTextLayout;
        if (staticLayout != null) {
            float height = (-this.replyStartY) - staticLayout.getHeight();
            Iterator it3 = this.replySpoilers.iterator();
            while (it3.hasNext()) {
                ((SpoilerEffect) it3.next()).setVisibleBounds(BitmapDescriptorFactory.HUE_RED, i + height, getWidth(), i2 + height);
            }
        }
        if (getMessageObject() == null || getMessageObject().textLayoutBlocks == null) {
            return;
        }
        Iterator<MessageObject.TextLayoutBlock> it4 = getMessageObject().textLayoutBlocks.iterator();
        while (it4.hasNext()) {
            MessageObject.TextLayoutBlock next2 = it4.next();
            Iterator<SpoilerEffect> it5 = next2.spoilers.iterator();
            while (it5.hasNext()) {
                it5.next().setVisibleBounds(BitmapDescriptorFactory.HUE_RED, (i - next2.textYOffset(getMessageObject().textLayoutBlocks, this.transitionParams)) - this.textY, getWidth(), (i2 - next2.textYOffset(getMessageObject().textLayoutBlocks, this.transitionParams)) - this.textY);
            }
        }
    }

    private void updateWaveform() {
        TLRPC.Message message;
        TLRPC.MessageMedia messageMedia;
        MessageObject messageObject;
        TLRPC.Message message2;
        MessageObject messageObject2 = this.currentMessageObject;
        if (messageObject2 != null) {
            int i = this.documentAttachType;
            if (i == 3 || i == 7) {
                byte[] waveform = messageObject2.getWaveform();
                boolean z = false;
                this.useSeekBarWaveform = waveform != null;
                SeekBarWaveform seekBarWaveform = this.seekBarWaveform;
                if (seekBarWaveform != null) {
                    seekBarWaveform.setWaveform(waveform);
                }
                MessageObject messageObject3 = this.currentMessageObject;
                if (messageObject3 != null && !messageObject3.isQuickReply()) {
                    MessageObject messageObject4 = this.currentMessageObject;
                    if (!messageObject4.isRepostPreview && (!messageObject4.isOutOwner() || this.currentMessageObject.isSent())) {
                        if (!UserConfig.getInstance(this.currentAccount).isPremium() && !TranscribeButton.isFreeTranscribeInChat(this.currentMessageObject)) {
                            if (MessagesController.getInstance(this.currentAccount).transcribeAudioTrialWeeklyNumber > 0 && this.currentMessageObject.getDuration() <= MessagesController.getInstance(this.currentAccount).transcribeAudioTrialDurationMax) {
                                TLRPC.Message message3 = this.currentMessageObject.messageOwner;
                                if (message3 == null || (TextUtils.isEmpty(message3.voiceTranscription) && !this.currentMessageObject.messageOwner.voiceTranscriptionFinal)) {
                                    TranscribeButton.canTranscribeTrial(this.currentMessageObject);
                                }
                            } else if (MessagesController.getInstance(this.currentAccount).transcribeAudioTrialWeeklyNumber <= 0 && !MessagesController.getInstance(this.currentAccount).premiumFeaturesBlocked() && !MessagesController.getInstance(this.currentAccount).didPressTranscribeButtonEnough() && !this.currentMessageObject.isOutOwner() && (((message2 = (messageObject = this.currentMessageObject).messageOwner) != null && message2.voiceTranscriptionForce) || messageObject.getDuration() >= 60.0d)) {
                            }
                            z = !this.currentMessageObject.isVoice() ? true : true;
                        } else if (((!this.currentMessageObject.isVoice() && this.useSeekBarWaveform) || this.currentMessageObject.isRoundVideo()) && (message = this.currentMessageObject.messageOwner) != null && !(MessageObject.getMedia(message) instanceof TLRPC.TL_messageMediaWebPage) && ((messageMedia = this.currentMessageObject.messageOwner.media) == null || messageMedia.ttl_seconds == 0)) {
                        }
                    }
                }
                this.useTranscribeButton = z;
                updateSeekBarWaveformWidth(null);
            }
        }
    }

    public void applyServiceShaderMatrix() {
        applyServiceShaderMatrix(getMeasuredWidth(), this.backgroundHeight, getX(), this.viewTop);
    }

    public void applyServiceShaderMatrix(int i, int i2, float f, float f2) {
        Theme.ResourcesProvider resourcesProvider = this.resourcesProvider;
        if (resourcesProvider != null) {
            resourcesProvider.applyServiceShaderMatrix(i, i2, f, f2 + this.starsPriceTopPadding + this.topicSeparatorTopPadding + this.suggestionOfferTopPadding);
        } else {
            Theme.applyServiceShaderMatrix(i, i2, f, f2 + this.starsPriceTopPadding + this.topicSeparatorTopPadding + this.suggestionOfferTopPadding);
        }
    }

    public boolean areTags() {
        TLRPC.Message message;
        TLRPC.TL_messageReactions tL_messageReactions;
        MessageObject primaryMessageObject = getPrimaryMessageObject();
        if (primaryMessageObject == null || (message = primaryMessageObject.messageOwner) == null || (tL_messageReactions = message.reactions) == null) {
            return false;
        }
        return tL_messageReactions.reactions_as_tags;
    }

    public int captionFlag() {
        return this.captionAbove ? 4 : 8;
    }

    public boolean checkLoadCaughtPremiumFloodWait() {
        return FileLoader.getInstance(this.currentAccount).checkLoadCaughtPremiumFloodWait(getFilename());
    }

    /* JADX WARN: Removed duplicated region for block: B:26:0x0034  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    protected boolean checkNeedDrawShareButton(MessageObject messageObject) {
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        if (this.isReportChat) {
            return false;
        }
        MessageObject messageObject2 = this.currentMessageObject;
        if ((messageObject2.deleted && !messageObject2.deletedByThanos) || messageObject2.isSponsored()) {
            return false;
        }
        if (this.currentMessagesGroup != null && (groupedMessagePosition = this.currentPosition) != null) {
            int i = groupedMessagePosition.flags;
            if ((i & 8) != 0) {
                boolean z = (i & (messageObject.isOutOwner() ? 1 : 2)) != 0;
                if (!this.currentMessagesGroup.isDocuments && !z) {
                    return false;
                }
            }
        }
        return messageObject.needDrawShareButton();
    }

    public boolean checkSpoilersMotionEvent(MotionEvent motionEvent, int i) {
        int i2;
        MessageObject.GroupedMessages groupedMessages;
        if (i <= 15 && getParent() != null) {
            if (this.currentMessageObject.hasValidGroupId() && (groupedMessages = this.currentMessagesGroup) != null && !groupedMessages.isDocuments) {
                ViewGroup viewGroup = (ViewGroup) getParent();
                for (int i3 = 0; i3 < viewGroup.getChildCount(); i3++) {
                    View childAt = viewGroup.getChildAt(i3);
                    if (childAt instanceof ChatMessageCell) {
                        ChatMessageCell chatMessageCell = (ChatMessageCell) childAt;
                        MessageObject.GroupedMessages currentMessagesGroup = chatMessageCell.getCurrentMessagesGroup();
                        MessageObject.GroupedMessagePosition currentPosition = chatMessageCell.getCurrentPosition();
                        if (currentMessagesGroup != null && currentMessagesGroup.groupId == this.currentMessagesGroup.groupId) {
                            int i4 = currentPosition.flags;
                            if ((i4 & 8) != 0 && (i4 & 1) != 0 && chatMessageCell != this) {
                                motionEvent.offsetLocation(getLeft() - chatMessageCell.getLeft(), getTop() - chatMessageCell.getTop());
                                boolean zCheckSpoilersMotionEvent = chatMessageCell.checkSpoilersMotionEvent(motionEvent, i + 1);
                                motionEvent.offsetLocation(-(getLeft() - chatMessageCell.getLeft()), -(getTop() - chatMessageCell.getTop()));
                                return zCheckSpoilersMotionEvent;
                            }
                        }
                    }
                }
            }
            if (this.isSpoilerRevealing) {
                return false;
            }
            int eventX = (int) getEventX(motionEvent);
            int eventY = (int) getEventY(motionEvent);
            int actionMasked = motionEvent.getActionMasked();
            if (actionMasked == 0) {
                int i5 = this.textX;
                if (eventX >= i5 && eventY >= (i2 = this.textY)) {
                    MessageObject messageObject = this.currentMessageObject;
                    if (eventX <= i5 + messageObject.textWidth && eventY <= i2 + messageObject.textHeight(this.transitionParams)) {
                        ArrayList<MessageObject.TextLayoutBlock> arrayList = this.currentMessageObject.textLayoutBlocks;
                        for (int i6 = 0; i6 < arrayList.size() && arrayList.get(i6).textYOffset(this.currentMessageObject.textLayoutBlocks, this.transitionParams) <= eventY; i6++) {
                            MessageObject.TextLayoutBlock textLayoutBlock = arrayList.get(i6);
                            int i7 = textLayoutBlock.isRtl() ? (int) this.currentMessageObject.textXOffset : 0;
                            for (SpoilerEffect spoilerEffect : textLayoutBlock.spoilers) {
                                if (spoilerEffect.getBounds().contains((eventX - this.textX) + i7, (int) ((eventY - this.textY) - textLayoutBlock.textYOffset(this.currentMessageObject.textLayoutBlocks, this.transitionParams)))) {
                                    this.spoilerPressed = spoilerEffect;
                                    return true;
                                }
                            }
                        }
                    }
                }
                if (this.captionLayout != null) {
                    float f = eventX;
                    float f2 = this.captionX;
                    if (f >= f2) {
                        float f3 = eventY;
                        float f4 = this.captionY;
                        if (f3 >= f4 && f <= f2 + r14.textWidth && f3 <= f4 + r14.textHeight(this.transitionParams)) {
                            ArrayList<MessageObject.TextLayoutBlock> arrayList2 = this.captionLayout.textLayoutBlocks;
                            for (int i8 = 0; i8 < arrayList2.size() && arrayList2.get(i8).textYOffset(this.captionLayout.textLayoutBlocks, this.transitionParams) <= f3; i8++) {
                                MessageObject.TextLayoutBlock textLayoutBlock2 = arrayList2.get(i8);
                                int i9 = textLayoutBlock2.isRtl() ? (int) this.captionLayout.textXOffset : 0;
                                for (SpoilerEffect spoilerEffect2 : textLayoutBlock2.spoilers) {
                                    if (spoilerEffect2.getBounds().contains((int) ((f - this.captionX) + i9), (int) ((f3 - this.captionY) - textLayoutBlock2.textYOffset(this.captionLayout.textLayoutBlocks, this.transitionParams)))) {
                                        this.spoilerPressed = spoilerEffect2;
                                        return true;
                                    }
                                }
                            }
                        }
                    }
                }
            } else if (actionMasked == 1 && this.spoilerPressed != null) {
                playSoundEffect(0);
                this.sPath.rewind();
                MessageObject.TextLayoutBlocks textLayoutBlocks = this.captionLayout;
                if (textLayoutBlocks != null) {
                    Iterator<MessageObject.TextLayoutBlock> it = textLayoutBlocks.textLayoutBlocks.iterator();
                    while (it.hasNext()) {
                        MessageObject.TextLayoutBlock next = it.next();
                        Iterator<SpoilerEffect> it2 = next.spoilers.iterator();
                        while (it2.hasNext()) {
                            Rect bounds = it2.next().getBounds();
                            this.sPath.addRect(bounds.left, bounds.top + next.textYOffset(this.captionLayout.textLayoutBlocks, this.transitionParams), bounds.right, next.textYOffset(this.captionLayout.textLayoutBlocks, this.transitionParams) + bounds.bottom, Path.Direction.CW);
                        }
                    }
                } else {
                    Iterator<MessageObject.TextLayoutBlock> it3 = this.currentMessageObject.textLayoutBlocks.iterator();
                    while (it3.hasNext()) {
                        MessageObject.TextLayoutBlock next2 = it3.next();
                        Iterator<SpoilerEffect> it4 = next2.spoilers.iterator();
                        while (it4.hasNext()) {
                            Rect bounds2 = it4.next().getBounds();
                            this.sPath.addRect(bounds2.left, bounds2.top + next2.textYOffset(this.currentMessageObject.textLayoutBlocks, this.transitionParams), bounds2.right, next2.textYOffset(this.currentMessageObject.textLayoutBlocks, this.transitionParams) + bounds2.bottom, Path.Direction.CW);
                        }
                    }
                }
                this.sPath.computeBounds(this.rect, false);
                float fSqrt = (float) Math.sqrt(Math.pow(this.rect.width(), 2.0d) + Math.pow(this.rect.height(), 2.0d));
                this.isSpoilerRevealing = true;
                this.spoilerPressed.setOnRippleEndCallback(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda8
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$checkSpoilersMotionEvent$1();
                    }
                });
                MessageObject.TextLayoutBlocks textLayoutBlocks2 = this.captionLayout;
                if (textLayoutBlocks2 != null) {
                    Iterator<MessageObject.TextLayoutBlock> it5 = textLayoutBlocks2.textLayoutBlocks.iterator();
                    while (it5.hasNext()) {
                        MessageObject.TextLayoutBlock next3 = it5.next();
                        int i10 = next3.isRtl() ? (int) this.captionLayout.textXOffset : 0;
                        Iterator<SpoilerEffect> it6 = next3.spoilers.iterator();
                        while (it6.hasNext()) {
                            it6.next().startRipple((eventX - this.captionX) + i10, (eventY - next3.textYOffset(this.captionLayout.textLayoutBlocks, this.transitionParams)) - this.captionY, fSqrt);
                        }
                    }
                } else {
                    ArrayList<MessageObject.TextLayoutBlock> arrayList3 = this.currentMessageObject.textLayoutBlocks;
                    if (arrayList3 != null) {
                        Iterator<MessageObject.TextLayoutBlock> it7 = arrayList3.iterator();
                        while (it7.hasNext()) {
                            MessageObject.TextLayoutBlock next4 = it7.next();
                            int i11 = next4.isRtl() ? (int) this.currentMessageObject.textXOffset : 0;
                            Iterator<SpoilerEffect> it8 = next4.spoilers.iterator();
                            while (it8.hasNext()) {
                                it8.next().startRipple((eventX - this.textX) + i11, (eventY - next4.textYOffset(this.currentMessageObject.textLayoutBlocks, this.transitionParams)) - this.textY, fSqrt);
                            }
                        }
                    }
                }
                if (getParent() instanceof RecyclerListView) {
                    ViewGroup viewGroup2 = (ViewGroup) getParent();
                    for (int i12 = 0; i12 < viewGroup2.getChildCount(); i12++) {
                        View childAt2 = viewGroup2.getChildAt(i12);
                        if (childAt2 instanceof ChatMessageCell) {
                            final ChatMessageCell chatMessageCell2 = (ChatMessageCell) childAt2;
                            if (chatMessageCell2.getMessageObject() != null && chatMessageCell2.getMessageObject().getReplyMsgId() == getMessageObject().getId() && !chatMessageCell2.replySpoilers.isEmpty()) {
                                ((SpoilerEffect) chatMessageCell2.replySpoilers.get(0)).setOnRippleEndCallback(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda9
                                    @Override // java.lang.Runnable
                                    public final void run() {
                                        this.f$0.lambda$checkSpoilersMotionEvent$3(chatMessageCell2);
                                    }
                                });
                                Iterator it9 = chatMessageCell2.replySpoilers.iterator();
                                while (it9.hasNext()) {
                                    ((SpoilerEffect) it9.next()).startRipple(r4.getBounds().centerX(), r4.getBounds().centerY(), fSqrt);
                                }
                            }
                        }
                    }
                }
                this.spoilerPressed = null;
                return true;
            }
        }
        return false;
    }

    public boolean checkUnreadReactions(float f, int i) {
        if (!this.reactionsLayoutInBubble.hasUnreadReactions) {
            return false;
        }
        float y = getY();
        float f2 = y + r2.y;
        return f2 > f && (f2 + ((float) this.reactionsLayoutInBubble.height)) - ((float) AndroidUtilities.dp(16.0f)) < ((float) i);
    }

    public boolean checkUploadCaughtPremiumFloodWait() {
        return FileLoader.getInstance(this.currentAccount).checkUploadCaughtPremiumFloodWait(getFilename());
    }

    /* JADX WARN: Code restructure failed: missing block: B:21:0x004e, code lost:
    
        if (r4 != false) goto L9;
     */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void checkVideoPlayback(boolean z, Bitmap bitmap) {
        if (this.currentMessageObject.isVideo()) {
            if (MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                this.photoImage.setAllowStartAnimation(false);
                this.photoImage.stopAnimation();
                return;
            } else {
                this.photoImage.setAllowStartAnimation(true);
                this.photoImage.startAnimation();
                return;
            }
        }
        if (z) {
            MessageObject playingMessageObject = MediaController.getInstance().getPlayingMessageObject();
            z = playingMessageObject == null || !playingMessageObject.isRoundVideo();
        }
        this.photoImage.setAllowStartAnimation(z);
        if (bitmap != null) {
            this.photoImage.startCrossfadeFromStaticThumb(bitmap);
        }
    }

    public int computeHeight(MessageObject messageObject, MessageObject.GroupedMessages groupedMessages, boolean z) throws Resources.NotFoundException, NumberFormatException {
        this.photoImage.setIgnoreImageSet(true);
        this.avatarImage.setIgnoreImageSet(true);
        this.replyImageReceiver.setIgnoreImageSet(true);
        this.locationImageReceiver.setIgnoreImageSet(true);
        if (groupedMessages == null || groupedMessages.messages.size() == 1) {
            setMessageContent(messageObject, groupedMessages, false, false, false);
            this.photoImage.setIgnoreImageSet(false);
            this.avatarImage.setIgnoreImageSet(false);
            this.replyImageReceiver.setIgnoreImageSet(false);
            this.locationImageReceiver.setIgnoreImageSet(false);
            updateCaptionLayout();
            return this.totalHeight + this.keyboardHeight;
        }
        if (groupedMessages.messages.size() != groupedMessages.positions.size()) {
            groupedMessages.calculate();
        }
        this.computedGroupCaptionY = 0;
        int i = 0;
        for (int i2 = 0; i2 < groupedMessages.messages.size(); i2++) {
            MessageObject messageObject2 = groupedMessages.messages.get(i2);
            MessageObject.GroupedMessagePosition position = groupedMessages.getPosition(messageObject2);
            if (position != null && (position.flags & 1) != 0) {
                setMessageContent(messageObject2, groupedMessages, false, false, false);
                if (z && !TextUtils.isEmpty(this.currentCaption)) {
                    updateCaptionLayout();
                    this.computedGroupCaptionY = (int) (i + this.captionY);
                    this.computedCaptionLayout = this.captionLayout;
                }
                i += this.totalHeight + this.keyboardHeight;
            }
        }
        return i;
    }

    @Override // android.view.View
    public void computeScroll() {
        super.computeScroll();
        ChannelRecommendationsCell channelRecommendationsCell = this.channelRecommendationsCell;
        if (channelRecommendationsCell != null) {
            channelRecommendationsCell.computeScroll();
        }
    }

    public int computeWidth(MessageObject messageObject, MessageObject.GroupedMessages groupedMessages) throws Resources.NotFoundException, NumberFormatException {
        this.photoImage.setIgnoreImageSet(true);
        this.avatarImage.setIgnoreImageSet(true);
        this.replyImageReceiver.setIgnoreImageSet(true);
        this.locationImageReceiver.setIgnoreImageSet(true);
        if (groupedMessages == null || groupedMessages.messages.size() == 1) {
            setMessageContent(messageObject, groupedMessages, false, false, false);
            this.photoImage.setIgnoreImageSet(false);
            this.avatarImage.setIgnoreImageSet(false);
            this.replyImageReceiver.setIgnoreImageSet(false);
            this.locationImageReceiver.setIgnoreImageSet(false);
            updateCaptionLayout();
            return this.backgroundWidth;
        }
        if (groupedMessages.messages.size() != groupedMessages.positions.size()) {
            groupedMessages.calculate();
        }
        this.computedGroupCaptionY = 0;
        int i = 0;
        for (int i2 = 0; i2 < groupedMessages.messages.size(); i2++) {
            MessageObject messageObject2 = groupedMessages.messages.get(i2);
            MessageObject.GroupedMessagePosition position = groupedMessages.getPosition(messageObject2);
            if (position != null && (position.flags & 4) != 0) {
                setMessageContent(messageObject2, groupedMessages, false, false, false);
                i += this.backgroundWidth;
            }
        }
        return i;
    }

    public void copyParamsTo(ChatMessageCell chatMessageCell) {
        if (chatMessageCell == null) {
            return;
        }
        chatMessageCell.isChat = this.isChat;
        chatMessageCell.isReportChat = this.isReportChat;
        chatMessageCell.isSavedChat = this.isSavedChat;
        chatMessageCell.isSavedPreviewChat = this.isSavedPreviewChat;
        chatMessageCell.isBot = this.isBot;
        chatMessageCell.isMegagroup = this.isMegagroup;
        chatMessageCell.isForum = this.isForum;
        chatMessageCell.isMonoForum = this.isMonoForum;
        chatMessageCell.isForumGeneral = this.isForumGeneral;
        chatMessageCell.isThreadChat = this.isThreadChat;
        chatMessageCell.hasDiscussion = this.hasDiscussion;
        chatMessageCell.isPinned = this.isPinned;
        chatMessageCell.linkedChatId = this.linkedChatId;
        chatMessageCell.isRepliesChat = this.isRepliesChat;
        chatMessageCell.isPinnedChat = this.isPinnedChat;
        chatMessageCell.isAllChats = this.isAllChats;
        chatMessageCell.isSideMenued = this.isSideMenued;
        chatMessageCell.isSideMenuEnabled = this.isSideMenuEnabled;
        chatMessageCell.sideMenuAlpha = this.sideMenuAlpha;
        chatMessageCell.sideMenuWidth = this.sideMenuWidth;
    }

    public void copySpoilerEffect2AttachIndexFrom(ChatMessageCell chatMessageCell) {
        SpoilerEffect2 spoilerEffect2;
        if (chatMessageCell == null || (spoilerEffect2 = chatMessageCell.mediaSpoilerEffect2) == null) {
            return;
        }
        int attachIndex = spoilerEffect2.getAttachIndex(chatMessageCell);
        this.mediaSpoilerEffect2Index = Integer.valueOf(attachIndex);
        SpoilerEffect2 spoilerEffect22 = this.mediaSpoilerEffect2;
        if (spoilerEffect22 != null) {
            spoilerEffect22.reassignAttach(this, attachIndex);
        }
    }

    public void copyVisiblePartTo(ChatMessageCell chatMessageCell) {
        if (chatMessageCell == null) {
            return;
        }
        chatMessageCell.setVisiblePart(this.childPosition, this.visibleHeight, this.visibleParent, this.visibleParentOffset, this.visibleTop, this.parentWidth, this.parentHeight, this.blurredViewTopOffset, this.blurredViewBottomOffset);
    }

    /* JADX WARN: Removed duplicated region for block: B:27:0x0048  */
    /* JADX WARN: Removed duplicated region for block: B:28:0x004b  */
    /* JADX WARN: Removed duplicated region for block: B:32:0x005a  */
    /* JADX WARN: Removed duplicated region for block: B:37:0x009a  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void createSelectorDrawable(final int i) {
        ReplyMessageLine replyMessageLine;
        int color;
        int i2;
        Drawable drawable;
        if (Build.VERSION.SDK_INT < 21) {
            return;
        }
        if (this.currentMessageObject.isUnsupported()) {
            i2 = this.currentMessageObject.isOutOwner() ? Theme.key_chat_outPreviewInstantText : Theme.key_chat_inPreviewInstantText;
        } else if (i == 0 && this.psaHintPressed) {
            i2 = this.currentMessageObject.isOutOwner() ? Theme.key_chat_outViews : Theme.key_chat_inViews;
        } else {
            if ((i == 0 && (replyMessageLine = this.linkLine) != null) || (i == 0 && (replyMessageLine = this.contactLine) != null)) {
                color = replyMessageLine.getColor();
                drawable = this.selectorDrawable[i];
                if (drawable != null) {
                    this.selectorMaskDrawable[i] = new MaskDrawable() { // from class: org.telegram.ui.Cells.ChatMessageCell.6
                        /* JADX WARN: 'super' call moved to the top of the method (can break code semantics) */
                        {
                            super();
                        }

                        /* JADX WARN: Removed duplicated region for block: B:39:0x00cf  */
                        /* JADX WARN: Removed duplicated region for block: B:51:0x01a5  */
                        @Override // org.telegram.ui.Cells.ChatMessageCell.MaskDrawable
                        /*
                            Code decompiled incorrectly, please refer to instructions dump.
                        */
                        public void updatePath() {
                            Rect bounds = getBounds();
                            RectF rectF = this.rect;
                            int i3 = bounds.left;
                            this.pathX = i3;
                            int i4 = bounds.top;
                            this.pathY = i4;
                            rectF.set(i3, i4, bounds.right, bounds.bottom);
                            this.path.rewind();
                            if (ChatMessageCell.this.selectorDrawableMaskType[i] == 3 || ChatMessageCell.this.selectorDrawableMaskType[i] == 4) {
                                this.path.addCircle(this.rect.centerX(), this.rect.centerY(), AndroidUtilities.dp(ChatMessageCell.this.selectorDrawableMaskType[i] == 3 ? 16.0f : 20.0f), Path.Direction.CW);
                                return;
                            }
                            int i5 = ChatMessageCell.this.selectorDrawableMaskType[i];
                            float fDp = BitmapDescriptorFactory.HUE_RED;
                            if (i5 != 2) {
                                if (ChatMessageCell.this.selectorDrawableMaskType[i] == 0) {
                                    fDp = AndroidUtilities.dp(6.0f);
                                }
                                this.path.addRoundRect(this.rect, fDp, fDp, Path.Direction.CW);
                                return;
                            }
                            boolean z = ChatMessageCell.this.currentMessageObject != null && ChatMessageCell.this.currentMessageObject.isOutOwner();
                            for (int i6 = 0; i6 < 4; i6++) {
                                if (ChatMessageCell.this.instantTextNewLine) {
                                    float[] fArr = ChatMessageCell.radii;
                                    int i7 = i6 * 2;
                                    ChatMessageCell.radii[i7 + 1] = 0.0f;
                                    fArr[i7] = 0.0f;
                                } else if (i6 == (z ? 3 : 2)) {
                                    float[] fArr2 = ChatMessageCell.radii;
                                    int i8 = i6 * 2;
                                    float fDp2 = AndroidUtilities.dp(SharedConfig.bubbleRadius);
                                    ChatMessageCell.radii[i8 + 1] = fDp2;
                                    fArr2[i8] = fDp2;
                                } else if (((ChatMessageCell.this.mediaBackground && ChatMessageCell.this.currentPosition == null) || ChatMessageCell.this.pinnedBottom) && (i6 == 2 || i6 == 3)) {
                                    float[] fArr3 = ChatMessageCell.radii;
                                    int i9 = i6 * 2;
                                    float[] fArr4 = ChatMessageCell.radii;
                                    int i10 = i9 + 1;
                                    float fDp3 = AndroidUtilities.dp(ChatMessageCell.this.pinnedBottom ? Math.min(5, SharedConfig.bubbleRadius) : SharedConfig.bubbleRadius);
                                    fArr4[i10] = fDp3;
                                    fArr3[i9] = fDp3;
                                }
                            }
                            if (!z) {
                                ChatMessageCell chatMessageCell = ChatMessageCell.this;
                                if (!chatMessageCell.drawPinnedBottom && chatMessageCell.currentPosition == null && (ChatMessageCell.this.currentPosition == null || ChatMessageCell.this.pollInstantViewTouchesBottom)) {
                                    this.path.moveTo(this.rect.left + AndroidUtilities.dp(6.0f), this.rect.top);
                                    this.path.lineTo(this.rect.left + AndroidUtilities.dp(6.0f), (this.rect.bottom - AndroidUtilities.dp(6.0f)) - AndroidUtilities.dp(5.0f));
                                    RectF rectF2 = AndroidUtilities.rectTmp;
                                    rectF2.set(this.rect.left + AndroidUtilities.dp(-7.0f), this.rect.bottom - AndroidUtilities.dp(23.0f), this.rect.left + AndroidUtilities.dp(6.0f), this.rect.bottom);
                                    this.path.arcTo(rectF2, BitmapDescriptorFactory.HUE_RED, 83.0f, false);
                                    float f = this.rect.right - (ChatMessageCell.radii[4] * 2.0f);
                                    float f2 = this.rect.bottom - (ChatMessageCell.radii[5] * 2.0f);
                                    RectF rectF3 = this.rect;
                                    rectF2.set(f, f2, rectF3.right, rectF3.bottom);
                                    this.path.arcTo(rectF2, 90.0f, -90.0f, false);
                                    Path path = this.path;
                                    RectF rectF4 = this.rect;
                                    path.lineTo(rectF4.right, rectF4.top);
                                    this.path.close();
                                } else {
                                    this.path.addRoundRect(this.rect, ChatMessageCell.radii, Path.Direction.CW);
                                }
                            }
                            this.path.close();
                        }
                    };
                    this.selectorDrawable[i] = new BaseCell.RippleDrawableSafe(new ColorStateList(new int[][]{StateSet.WILD_CARD}, new int[]{436207615 & getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outPreviewInstantText : Theme.key_chat_inPreviewInstantText)}), null, this.selectorMaskDrawable[i]);
                    this.selectorDrawable[i].setCallback(this);
                } else {
                    Theme.setSelectorDrawableColor(drawable, color & 436207615, true);
                }
                this.selectorDrawable[i].setVisible(true, false);
            }
            if (this.currentMessageObject.isOutOwner()) {
            }
        }
        color = getThemedColor(i2);
        drawable = this.selectorDrawable[i];
        if (drawable != null) {
        }
        this.selectorDrawable[i].setVisible(true, false);
    }

    @Override // org.telegram.messenger.NotificationCenter.NotificationCenterDelegate
    public void didReceivedNotification(int i, int i2, Object... objArr) throws Resources.NotFoundException, NumberFormatException {
        MessageObject messageObject;
        if (i == NotificationCenter.startSpoilers) {
            setSpoilersSuppressed(false);
            return;
        }
        if (i == NotificationCenter.stopSpoilers) {
            setSpoilersSuppressed(true);
            return;
        }
        if (i == NotificationCenter.userInfoDidLoad) {
            TLRPC.User user = this.currentUser;
            if (user != null) {
                if (user.id == ((Long) objArr[0]).longValue()) {
                    setAvatar(this.currentMessageObject);
                    return;
                }
                return;
            }
            return;
        }
        if (i == NotificationCenter.emojiLoaded) {
            invalidate();
            return;
        }
        if (i != NotificationCenter.didUpdatePremiumGiftStickers || (messageObject = this.currentMessageObject) == null) {
            return;
        }
        TLRPC.MessageMedia messageMedia = messageObject.messageOwner.media;
        if ((messageMedia instanceof TLRPC.TL_messageMediaGiveaway) || (messageMedia instanceof TLRPC.TL_messageMediaGiveawayResults)) {
            setMessageObject(messageObject, this.currentMessagesGroup, this.pinnedBottom, this.pinnedTop, this.firstInChat);
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:19:0x0026  */
    /* JADX WARN: Removed duplicated region for block: B:32:0x0043  */
    @Override // org.telegram.messenger.ImageReceiver.ImageReceiverDelegate
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void didSetImage(ImageReceiver imageReceiver, boolean z, boolean z2, boolean z3) {
        int i;
        int i2;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && z) {
            if (setCurrentDiceValue((z3 || messageObject.wasUnread) ? false : true)) {
                return;
            }
            if (z2) {
                MessageObject messageObject2 = this.currentMessageObject;
                if (messageObject2.type != 20 || messageObject2.mediaExists) {
                    if (!z2) {
                        MessageObject messageObject3 = this.currentMessageObject;
                        if (!messageObject3.mediaExists && !messageObject3.attachPathExists && (((i = messageObject3.type) == 0 && ((i2 = this.documentAttachType) == 8 || i2 == 0 || i2 == 6)) || i == 1)) {
                            this.currentMessageObject.mediaExists = true;
                            updateButtonState(false, true, false);
                        }
                    }
                }
            }
        }
        if (!z || this.currentMessageObject == null) {
            return;
        }
        if (this.blurredPhotoImage.getBitmap() != null) {
            this.blurredPhotoImage.getBitmap().recycle();
            this.blurredPhotoImage.setImageBitmap((Bitmap) null);
        }
        if ((!this.currentMessageObject.hasMediaSpoilers() && !this.fitPhotoImage) || imageReceiver.getBitmap() == null || imageReceiver.getBitmap().isRecycled()) {
            return;
        }
        this.blurredPhotoImage.setImageBitmap(Utilities.stackBlurBitmapMax(imageReceiver.getBitmap(), this.currentMessageObject.isRoundVideo()));
        this.blurredPhotoImage.setColorFilter(getFancyBlurFilter());
    }

    @Override // org.telegram.messenger.ImageReceiver.ImageReceiverDelegate
    public /* synthetic */ void didSetImageBitmap(int i, String str, Drawable drawable) {
        ImageReceiver.ImageReceiverDelegate.CC.$default$didSetImageBitmap(this, i, str, drawable);
    }

    public void drawAnimatedEmojiCaption(Canvas canvas, float f) {
        float f2;
        float f3;
        ArrayList<MessageObject.TextLayoutBlock> arrayList;
        AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans;
        float f4;
        boolean z;
        boolean z2;
        ChatMessageCell chatMessageCell;
        float f5;
        float f6;
        Canvas canvas2;
        float f7;
        if (this.captionLayout == null) {
            return;
        }
        float translationY = this.captionY;
        float f8 = this.captionX;
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateBackgroundBoundsInner) {
            if (transitionParams.transformGroupToSingleMessage) {
                translationY -= getTranslationY();
            } else if (transitionParams.moveCaption) {
                float f9 = this.captionX;
                TransitionParams transitionParams2 = this.transitionParams;
                float f10 = transitionParams2.animateChangeProgress;
                float f11 = 1.0f - f10;
                f3 = (f9 * f10) + (transitionParams2.captionFromX * f11);
                f2 = (this.captionY * f10) + (transitionParams2.captionFromY * f11);
            } else {
                if (!this.currentMessageObject.isVoice() || !TextUtils.isEmpty(this.currentMessageObject.caption)) {
                }
                f2 = translationY;
                f3 = f8;
            }
            f8 += this.transitionParams.deltaLeft;
            f2 = translationY;
            f3 = f8;
        } else {
            f2 = translationY;
            f3 = f8;
        }
        TransitionParams transitionParams3 = this.transitionParams;
        if (!transitionParams3.animateReplaceCaptionLayout || transitionParams3.animateChangeProgress == 1.0f) {
            MessageObject.TextLayoutBlocks textLayoutBlocks = this.captionLayout;
            arrayList = textLayoutBlocks != null ? textLayoutBlocks.textLayoutBlocks : null;
            emojiGroupedSpans = this.animatedEmojiStack;
            f4 = textLayoutBlocks != null ? textLayoutBlocks.textXOffset : BitmapDescriptorFactory.HUE_RED;
            z = true;
            z2 = true;
            chatMessageCell = this;
            f5 = f3;
            f6 = f2;
            canvas2 = canvas;
            f7 = f;
        } else {
            ArrayList<MessageObject.TextLayoutBlock> arrayList2 = transitionParams3.animateOutCaptionLayout != null ? this.transitionParams.animateOutCaptionLayout.textLayoutBlocks : null;
            AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans2 = this.transitionParams.animateOutAnimateEmoji;
            TransitionParams transitionParams4 = this.transitionParams;
            drawAnimatedEmojiMessageText(f3, f2, canvas, arrayList2, emojiGroupedSpans2, false, f * (1.0f - transitionParams4.animateChangeProgress), transitionParams4.animateOutCaptionLayout != null ? this.transitionParams.animateOutCaptionLayout.textXOffset : BitmapDescriptorFactory.HUE_RED, true);
            MessageObject.TextLayoutBlocks textLayoutBlocks2 = this.captionLayout;
            arrayList = textLayoutBlocks2 != null ? textLayoutBlocks2.textLayoutBlocks : null;
            emojiGroupedSpans = this.animatedEmojiStack;
            f7 = f * this.transitionParams.animateChangeProgress;
            f4 = textLayoutBlocks2 != null ? textLayoutBlocks2.textXOffset : BitmapDescriptorFactory.HUE_RED;
            z = true;
            z2 = true;
            chatMessageCell = this;
            f5 = f3;
            f6 = f2;
            canvas2 = canvas;
        }
        chatMessageCell.drawAnimatedEmojiMessageText(f5, f6, canvas2, arrayList, emojiGroupedSpans, z2, f7, f4, z);
    }

    public void drawAnimatedEmojis(Canvas canvas, float f) {
        drawAnimatedEmojiMessageText(canvas, f);
        if (shouldDrawCaptionLayout()) {
            drawAnimatedEmojiCaption(canvas, f);
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:29:0x006f A[PHI: r6 r7
      0x006f: PHI (r6v10 int) = (r6v9 int), (r6v17 int) binds: [B:25:0x004c, B:27:0x005c] A[DONT_GENERATE, DONT_INLINE]
      0x006f: PHI (r7v1 int) = (r7v0 int), (r7v11 int) binds: [B:25:0x004c, B:27:0x005c] A[DONT_GENERATE, DONT_INLINE]] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawBackground(Canvas canvas, int i, int i2, int i3, int i4, boolean z, boolean z2, boolean z3, int i5) {
        int i6;
        int measuredHeight;
        MessageObject messageObject = this.currentMessageObject;
        this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable((messageObject == null || !messageObject.isOutOwner()) ? (this.mediaBackground || z2) ? z3 ? "drawableMsgInMediaSelected" : "drawableMsgInMedia" : z3 ? "drawableMsgInSelected" : "drawableMsgIn" : (this.mediaBackground || z2) ? z3 ? "drawableMsgOutMediaSelected" : "drawableMsgOutMedia" : z3 ? "drawableMsgOutSelected" : "drawableMsgOut");
        int parentWidth = this.parentWidth;
        int i7 = this.parentHeight;
        if (i7 == 0) {
            parentWidth = getParentWidth();
            i7 = AndroidUtilities.displaySize.y;
            if (getParent() instanceof View) {
                View view = (View) getParent();
                int measuredWidth = view.getMeasuredWidth();
                measuredHeight = view.getMeasuredHeight();
                i6 = measuredWidth;
            } else {
                i6 = parentWidth;
                measuredHeight = i7;
            }
        }
        Theme.MessageDrawable messageDrawable = this.currentBackgroundDrawable;
        if (messageDrawable != null) {
            messageDrawable.setTop(i5, i6, measuredHeight, (int) this.parentViewTopOffset, this.blurredViewTopOffset, this.blurredViewBottomOffset, z, z2);
            Theme.MessageDrawable messageDrawable2 = this.currentBackgroundDrawable;
            MessageObject messageObject2 = this.currentMessageObject;
            messageDrawable2.setBotButtonsBottom(messageObject2 != null && messageObject2.hasInlineBotButtons());
            Drawable shadowDrawable = this.currentBackgroundDrawable.getShadowDrawable();
            if (shadowDrawable != null) {
                shadowDrawable.setAlpha((int) (getAlpha() * 255.0f));
                shadowDrawable.setBounds(i, i2, i3, i4);
                shadowDrawable.draw(canvas);
                shadowDrawable.setAlpha(255);
            }
            this.currentBackgroundDrawable.setAlpha((int) (getAlpha() * 255.0f));
            this.currentBackgroundDrawable.setBounds(i, i2, i3, i4);
            this.currentBackgroundDrawable.drawCached(canvas, this.backgroundCacheParams);
            this.currentBackgroundDrawable.setAlpha(255);
        }
        animateCheckboxTranslation();
    }

    public boolean drawBackgroundInParent() {
        MessageObject messageObject;
        return this.canDrawBackgroundInParent && (messageObject = this.currentMessageObject) != null && messageObject.isOutOwner() && getThemedColor(Theme.key_chat_outBubbleGradient1) != 0;
    }

    /* JADX WARN: Multi-variable type inference failed */
    /* JADX WARN: Removed duplicated region for block: B:363:0x073f  */
    /* JADX WARN: Removed duplicated region for block: B:368:0x0754  */
    /* JADX WARN: Removed duplicated region for block: B:372:0x0764  */
    /* JADX WARN: Removed duplicated region for block: B:377:0x07ca A[PHI: r3 r5
      0x07ca: PHI (r3v45 int) = (r3v44 int), (r3v52 int) binds: [B:373:0x07a5, B:375:0x07b5] A[DONT_GENERATE, DONT_INLINE]
      0x07ca: PHI (r5v20 int) = (r5v19 int), (r5v24 int) binds: [B:373:0x07a5, B:375:0x07b5] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:393:0x0825  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawBackgroundInternal(Canvas canvas, boolean z) {
        float f;
        MessageObject messageObject;
        int iDp;
        int iDp2;
        int iDp3;
        int i;
        int iDp4;
        Drawable drawable;
        String str;
        String str2;
        String str3;
        float f2;
        float f3;
        float f4;
        float f5;
        MessageObject messageObject2;
        MessageObject.GroupedMessages groupedMessages;
        Theme.MessageDrawable messageDrawable;
        int i2;
        int measuredHeight;
        int i3;
        float f6;
        int i4;
        int iDp5;
        int iDp6;
        ChatMessageCell chatMessageCell;
        int i5;
        int i6;
        Theme.MessageDrawable messageDrawable2;
        int i7;
        int iDp7;
        if (this.currentMessageObject == null) {
            return;
        }
        boolean z2 = this.wasLayout;
        if (!z2 && !this.animationRunning) {
            forceLayout();
            return;
        }
        if (!z2 || this.forcedLayout) {
            onLayout(false, getLeft(), getTop(), getRight(), getBottom());
        }
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        boolean z3 = groupedMessagePosition != null && (groupedMessagePosition.flags & 8) == 0 && this.currentMessagesGroup.isDocuments && !this.drawPinnedBottom;
        String str4 = "drawableMsgOut";
        if (this.currentMessageObject.isOutOwner()) {
            if (this.transitionParams.changePinnedBottomProgress < 1.0f || this.mediaBackground || this.drawPinnedBottom || z3) {
                this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgOutMedia");
                this.currentBackgroundSelectedDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgOutMediaSelected");
                this.transitionParams.drawPinnedBottomBackground = true;
            } else {
                this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgOut");
                this.currentBackgroundSelectedDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgOutSelected");
                this.transitionParams.drawPinnedBottomBackground = false;
            }
            setBackgroundTopY(true);
            Drawable shadowDrawable = ((!isDrawSelectionBackground() || (this.currentPosition != null && getBackground() == null)) ? this.currentBackgroundDrawable : this.currentBackgroundSelectedDrawable).getShadowDrawable();
            this.backgroundDrawableLeft = (this.layoutWidth - this.backgroundWidth) - (!this.mediaBackground ? 0 : AndroidUtilities.dp(9.0f));
            int iDp8 = this.backgroundWidth - (this.mediaBackground ? 0 : AndroidUtilities.dp(3.0f));
            this.backgroundDrawableRight = iDp8;
            MessageObject.GroupedMessages groupedMessages2 = this.currentMessagesGroup;
            if (groupedMessages2 != null && !groupedMessages2.isDocuments && !this.currentPosition.edge) {
                this.backgroundDrawableRight = iDp8 + AndroidUtilities.dp(10.0f);
            }
            int iDp9 = this.backgroundDrawableLeft;
            if (z3 || this.transitionParams.changePinnedBottomProgress == 1.0f ? !(this.mediaBackground || !this.drawPinnedBottom) : !this.mediaBackground) {
                this.backgroundDrawableRight -= AndroidUtilities.dp(6.0f);
            }
            MessageObject.GroupedMessagePosition groupedMessagePosition2 = this.currentPosition;
            if (groupedMessagePosition2 != null) {
                if ((groupedMessagePosition2.flags & 2) == 0) {
                    this.backgroundDrawableRight += AndroidUtilities.dp(SharedConfig.bubbleRadius + 2);
                }
                if ((this.currentPosition.flags & 1) == 0) {
                    iDp9 -= AndroidUtilities.dp(SharedConfig.bubbleRadius + 2);
                    this.backgroundDrawableRight += AndroidUtilities.dp(SharedConfig.bubbleRadius + 2);
                }
                if ((this.currentPosition.flags & 4) == 0) {
                    iDp5 = 0 - AndroidUtilities.dp(SharedConfig.bubbleRadius + 3);
                    iDp6 = AndroidUtilities.dp(SharedConfig.bubbleRadius + 3);
                } else {
                    iDp5 = 0;
                    iDp6 = 0;
                }
                if ((this.currentPosition.flags & 8) == 0) {
                    iDp6 += AndroidUtilities.dp(SharedConfig.bubbleRadius + 3);
                }
                i4 = iDp9;
            } else {
                i4 = iDp9;
                iDp5 = 0;
                iDp6 = 0;
            }
            boolean z4 = this.drawPinnedBottom;
            int iDp10 = (z4 && this.drawPinnedTop) ? 0 : z4 ? AndroidUtilities.dp(1.0f) : AndroidUtilities.dp(2.0f);
            int iDp11 = (this.drawPinnedTop ? 0 : AndroidUtilities.dp(1.0f)) + iDp5;
            this.backgroundDrawableTop = iDp11;
            int iDp12 = (this.layoutHeight - iDp10) + iDp6;
            this.backgroundDrawableBottom = iDp11 + iDp12;
            if (!this.mediaBackground) {
                if (this.drawPinnedTop) {
                    this.backgroundDrawableTop = iDp11 - AndroidUtilities.dp(1.0f);
                    iDp12 += AndroidUtilities.dp(1.0f);
                }
                if (this.drawPinnedBottom) {
                    this.backgroundDrawableBottom += AndroidUtilities.dp(1.0f);
                    iDp12 += AndroidUtilities.dp(1.0f);
                }
            }
            int i8 = iDp12;
            if (z3) {
                setDrawableBoundsInner(this.currentBackgroundDrawable, i4, this.backgroundDrawableTop - iDp5, this.backgroundDrawableRight, (i8 - iDp6) + 10);
                messageDrawable2 = this.currentBackgroundSelectedDrawable;
                i5 = this.backgroundDrawableLeft;
                i7 = this.backgroundDrawableTop;
                iDp7 = this.backgroundDrawableRight - AndroidUtilities.dp(6.0f);
                chatMessageCell = this;
                i6 = i8;
            } else {
                chatMessageCell = this;
                i5 = i4;
                i6 = i8;
                chatMessageCell.setDrawableBoundsInner(this.currentBackgroundDrawable, i5, this.backgroundDrawableTop, this.backgroundDrawableRight, i6);
                messageDrawable2 = this.currentBackgroundSelectedDrawable;
                i7 = this.backgroundDrawableTop;
                iDp7 = this.backgroundDrawableRight;
            }
            chatMessageCell.setDrawableBoundsInner(messageDrawable2, i5, i7, iDp7, i6);
            setDrawableBoundsInner(shadowDrawable, i4, this.backgroundDrawableTop, this.backgroundDrawableRight, i8);
            drawable = shadowDrawable;
            f = 1.0f;
        } else {
            f = 1.0f;
            if (this.transitionParams.changePinnedBottomProgress < 1.0f || this.mediaBackground || this.drawPinnedBottom || z3) {
                this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgInMedia");
                this.currentBackgroundSelectedDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgInMediaSelected");
                this.transitionParams.drawPinnedBottomBackground = true;
            } else {
                this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgIn");
                this.currentBackgroundSelectedDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgInSelected");
                this.transitionParams.drawPinnedBottomBackground = false;
            }
            setBackgroundTopY(true);
            Drawable shadowDrawable2 = ((!isDrawSelectionBackground() || (this.currentPosition != null && getBackground() == null)) ? this.currentBackgroundDrawable : this.currentBackgroundSelectedDrawable).getShadowDrawable();
            this.backgroundDrawableLeft = AndroidUtilities.dp(this.isSideMenuEnabled ? 64.0f : ((this.isChat || (((messageObject = this.currentMessageObject) != null && (messageObject.isRepostPreview || messageObject.forceAvatar)) || messageObject.getDialogId() == UserObject.VERIFY)) && this.isAvatarVisible) ? 48.0f : BitmapDescriptorFactory.HUE_RED) + AndroidUtilities.dp(this.mediaBackground ? 9.0f : 3.0f);
            this.backgroundDrawableRight = this.backgroundWidth - (this.mediaBackground ? 0 : AndroidUtilities.dp(3.0f));
            MessageObject.GroupedMessages groupedMessages3 = this.currentMessagesGroup;
            if (groupedMessages3 != null && !groupedMessages3.isDocuments) {
                if (!this.currentPosition.edge) {
                    this.backgroundDrawableLeft -= AndroidUtilities.dp(10.0f);
                    this.backgroundDrawableRight += AndroidUtilities.dp(10.0f);
                }
                if (this.currentPosition.leftSpanOffset != 0) {
                    this.backgroundDrawableLeft += (int) Math.ceil((r0 / 1000.0f) * getGroupPhotosWidth());
                }
            }
            boolean z5 = this.mediaBackground;
            if ((!z5 && this.drawPinnedBottom) || (!z3 && this.transitionParams.changePinnedBottomProgress != 1.0f)) {
                if (this.drawPinnedBottom || !z5) {
                    this.backgroundDrawableRight -= AndroidUtilities.dp(6.0f);
                }
                if (!this.mediaBackground) {
                    this.backgroundDrawableLeft += AndroidUtilities.dp(6.0f);
                }
            }
            MessageObject.GroupedMessagePosition groupedMessagePosition3 = this.currentPosition;
            if (groupedMessagePosition3 != null) {
                if ((groupedMessagePosition3.flags & 2) == 0) {
                    this.backgroundDrawableRight += AndroidUtilities.dp(SharedConfig.bubbleRadius + 2);
                }
                if ((this.currentPosition.flags & 1) == 0) {
                    this.backgroundDrawableLeft -= AndroidUtilities.dp(SharedConfig.bubbleRadius + 2);
                    this.backgroundDrawableRight += AndroidUtilities.dp(SharedConfig.bubbleRadius + 2);
                }
                if ((this.currentPosition.flags & 4) == 0) {
                    iDp = 0 - AndroidUtilities.dp(SharedConfig.bubbleRadius + 3);
                    iDp2 = AndroidUtilities.dp(SharedConfig.bubbleRadius + 3);
                } else {
                    iDp = 0;
                    iDp2 = 0;
                }
                if ((this.currentPosition.flags & 8) == 0) {
                    iDp2 += AndroidUtilities.dp(SharedConfig.bubbleRadius + 4);
                }
            } else {
                iDp = 0;
                iDp2 = 0;
            }
            boolean z6 = this.drawPinnedBottom;
            int iDp13 = (z6 && this.drawPinnedTop) ? 0 : z6 ? AndroidUtilities.dp(1.0f) : AndroidUtilities.dp(2.0f);
            int iDp14 = iDp + (this.drawPinnedTop ? 0 : AndroidUtilities.dp(1.0f));
            this.backgroundDrawableTop = iDp14;
            int iDp15 = (this.layoutHeight - iDp13) + iDp2;
            this.backgroundDrawableBottom = iDp14 + iDp15;
            if (!this.mediaBackground) {
                if (this.drawPinnedTop) {
                    this.backgroundDrawableTop = iDp14 - AndroidUtilities.dp(1.0f);
                    iDp15 += AndroidUtilities.dp(1.0f);
                }
                if (this.drawPinnedBottom) {
                    this.backgroundDrawableBottom += AndroidUtilities.dp(1.0f);
                    iDp15 += AndroidUtilities.dp(1.0f);
                }
            }
            int i9 = iDp15;
            setDrawableBoundsInner(this.currentBackgroundDrawable, this.backgroundDrawableLeft, this.backgroundDrawableTop, this.backgroundDrawableRight, i9);
            Theme.MessageDrawable messageDrawable3 = this.currentBackgroundSelectedDrawable;
            if (z3) {
                iDp3 = AndroidUtilities.dp(6.0f) + this.backgroundDrawableLeft;
                i = this.backgroundDrawableTop;
                iDp4 = this.backgroundDrawableRight - AndroidUtilities.dp(6.0f);
            } else {
                iDp3 = this.backgroundDrawableLeft;
                i = this.backgroundDrawableTop;
                iDp4 = this.backgroundDrawableRight;
            }
            setDrawableBoundsInner(messageDrawable3, iDp3, i, iDp4, i9);
            setDrawableBoundsInner(shadowDrawable2, this.backgroundDrawableLeft, this.backgroundDrawableTop, this.backgroundDrawableRight, i9);
            drawable = shadowDrawable2;
        }
        if (!this.currentMessageObject.isOutOwner() && this.transitionParams.changePinnedBottomProgress != f && !this.mediaBackground && !this.drawPinnedBottom) {
            this.backgroundDrawableLeft -= AndroidUtilities.dp(6.0f);
            this.backgroundDrawableRight += AndroidUtilities.dp(6.0f);
        }
        if (this.hasPsaHint) {
            MessageObject.GroupedMessagePosition groupedMessagePosition4 = this.currentPosition;
            if (groupedMessagePosition4 == null || (groupedMessagePosition4.flags & 2) != 0) {
                str = "drawableMsgOut";
                i3 = this.currentBackgroundDrawable.getBounds().right;
            } else {
                int groupPhotosWidth = getGroupPhotosWidth();
                int i10 = 0;
                i3 = 0;
                while (i10 < this.currentMessagesGroup.posArray.size()) {
                    if (this.currentMessagesGroup.posArray.get(i10).minY != 0) {
                        break;
                    }
                    double d = i3;
                    double dCeil = Math.ceil(((r4.pw + r4.leftSpanOffset) / 1000.0f) * groupPhotosWidth);
                    Double.isNaN(d);
                    i3 = (int) (d + dCeil);
                    i10++;
                    str4 = str4;
                }
                str = str4;
            }
            Drawable drawable2 = Theme.chat_psaHelpDrawable[this.currentMessageObject.isOutOwner() ? 1 : 0];
            if (this.currentMessageObject.type == 5) {
                f6 = 12.0f;
            } else {
                f6 = (this.drawNameLayout ? 19 : 0) + 10;
            }
            int iDp16 = AndroidUtilities.dp(f6);
            this.psaHelpX = (i3 - drawable2.getIntrinsicWidth()) - AndroidUtilities.dp(this.currentMessageObject.isOutOwner() ? 20.0f : 14.0f);
            this.psaHelpY = iDp16 + AndroidUtilities.dp(4.0f);
        } else {
            str = "drawableMsgOut";
        }
        if (this.checkBoxVisible || this.checkBoxAnimationInProgress) {
            animateCheckboxTranslation();
            int iDp17 = AndroidUtilities.dp(21.0f);
            this.checkBox.setBounds(AndroidUtilities.dp(-27.0f) + this.checkBoxTranslation, (this.currentBackgroundDrawable.getBounds().bottom - AndroidUtilities.dp(8.0f)) - iDp17, iDp17, iDp17);
        }
        if (z || !drawBackgroundInParent()) {
            int saveCount = canvas.getSaveCount();
            if (this.transitionYOffsetForDrawables != BitmapDescriptorFactory.HUE_RED) {
                canvas.save();
                canvas.translate(BitmapDescriptorFactory.HUE_RED, this.transitionYOffsetForDrawables);
            }
            MessageObject messageObject3 = this.currentMessageObject;
            if (messageObject3 == null || !messageObject3.isRoundVideo()) {
                str2 = "drawableMsgIn";
                str3 = "drawableMsgInMedia";
                f2 = BitmapDescriptorFactory.HUE_RED;
                this.roundVideoPlayPipFloat.set(BitmapDescriptorFactory.HUE_RED, true);
                f3 = BitmapDescriptorFactory.HUE_RED;
            } else {
                float videoTranscriptionProgress = getVideoTranscriptionProgress();
                this.currentBackgroundDrawable.setRoundingRadius(1.0f - videoTranscriptionProgress);
                float fLerp = AndroidUtilities.lerp(this.backgroundWidth / 2, 0, videoTranscriptionProgress);
                f2 = BitmapDescriptorFactory.HUE_RED;
                str2 = "drawableMsgIn";
                str3 = "drawableMsgInMedia";
                canvas.saveLayerAlpha(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, getWidth(), Math.max(this.currentBackgroundDrawable.getBounds().bottom, getHeight()), (int) (videoTranscriptionProgress * 255.0f), 31);
                this.roundVideoPlayPipFloat.set((((MediaController.getInstance().isPiPShown() && MediaController.getInstance().isPlayingMessageAndReadyToDraw(this.currentMessageObject)) || this.wouldBeInPip) && canvas.isHardwareAccelerated()) ? 1.0f : BitmapDescriptorFactory.HUE_RED);
                if (MediaController.getInstance().isPiPShown()) {
                    this.wouldBeInPip = false;
                }
                f3 = fLerp;
            }
            if ((this.drawBackground || this.transitionParams.animateDrawBackground) && this.currentBackgroundDrawable != null && ((this.currentPosition == null || (isDrawSelectionBackground() && (this.currentMessageObject.isMusic() || this.currentMessageObject.isDocument()))) && (!this.enterTransitionInProgress || this.currentMessageObject.isVoice()))) {
                float alpha = this.alphaInternal;
                if (z) {
                    alpha *= getAlpha();
                }
                if (hasSelectionOverlay()) {
                    this.currentSelectedBackgroundAlpha = f2;
                    int i11 = (int) (alpha * 255.0f);
                    this.currentBackgroundDrawable.setAlpha(i11);
                    this.currentBackgroundDrawable.drawCached(canvas, this.backgroundCacheParams);
                    if (drawable != null && this.currentPosition == null) {
                        drawable.setAlpha(i11);
                        drawable.draw(canvas);
                    }
                } else {
                    if (this.isHighlightedAnimated) {
                        this.currentBackgroundDrawable.setAlpha((int) (alpha * 255.0f));
                        this.currentBackgroundDrawable.drawCached(canvas, this.backgroundCacheParams);
                        float highlightAlpha = getHighlightAlpha();
                        this.currentSelectedBackgroundAlpha = highlightAlpha;
                        if (this.currentPosition == null) {
                            this.currentBackgroundSelectedDrawable.setAlpha((int) (highlightAlpha * alpha * 255.0f));
                            this.currentBackgroundSelectedDrawable.drawCached(canvas, this.backgroundCacheParams);
                        }
                    } else if (this.selectedBackgroundProgress != f2 && (((messageObject2 = this.currentMessageObject) == null || !messageObject2.preview) && ((groupedMessages = this.currentMessagesGroup) == null || !groupedMessages.isDocuments))) {
                        this.currentBackgroundDrawable.setAlpha((int) (alpha * 255.0f));
                        this.currentBackgroundDrawable.drawCached(canvas, this.backgroundCacheParams);
                        float f7 = this.selectedBackgroundProgress;
                        this.currentSelectedBackgroundAlpha = f7;
                        this.currentBackgroundSelectedDrawable.setAlpha((int) (f7 * alpha * 255.0f));
                        this.currentBackgroundSelectedDrawable.drawCached(canvas, this.backgroundCacheParams);
                        if (this.currentBackgroundDrawable.getGradientShader() == null) {
                            drawable = null;
                        }
                    } else if (isDrawSelectionBackground() && this.quoteHighlight == null && (this.currentPosition == null || this.currentMessageObject.isMusic() || this.currentMessageObject.isDocument() || getBackground() != null)) {
                        if (this.currentPosition != null) {
                            canvas.save();
                        }
                        f4 = 1.0f;
                        this.currentSelectedBackgroundAlpha = 1.0f;
                        this.currentBackgroundSelectedDrawable.setAlpha((int) (alpha * 255.0f));
                        this.currentBackgroundSelectedDrawable.drawCached(canvas, this.backgroundCacheParams);
                        if (this.currentPosition != null) {
                            canvas.restore();
                        }
                        f5 = 255.0f;
                        if (drawable != null) {
                            drawable.setAlpha((int) (alpha * f5));
                            drawable.draw(canvas);
                        }
                        if (this.transitionParams.changePinnedBottomProgress != f4) {
                            if (this.currentMessageObject.isOutOwner()) {
                            }
                            messageDrawable.draw(canvas);
                            messageDrawable.setAlpha(255);
                            canvas.restore();
                        }
                    } else {
                        f4 = 1.0f;
                        this.currentSelectedBackgroundAlpha = f2;
                        f5 = 255.0f;
                        this.currentBackgroundDrawable.setAlpha((int) (alpha * 255.0f));
                        this.currentBackgroundDrawable.drawCached(canvas, this.backgroundCacheParams);
                        if (drawable != null && this.currentPosition == null) {
                            drawable.setAlpha((int) (alpha * f5));
                            drawable.draw(canvas);
                        }
                        if (this.transitionParams.changePinnedBottomProgress != f4 && this.currentPosition == null) {
                            if (this.currentMessageObject.isOutOwner()) {
                                messageDrawable = (Theme.MessageDrawable) (this.transitionParams.drawPinnedBottomBackground ? getThemedDrawable(str2) : getThemedDrawable(str3));
                                messageDrawable.setAlpha((int) (((this.mediaBackground || this.pinnedBottom) ? f4 - this.transitionParams.changePinnedBottomProgress : this.transitionParams.changePinnedBottomProgress) * 255.0f));
                                Rect bounds = this.currentBackgroundDrawable.getBounds();
                                messageDrawable.setBounds(bounds.left - AndroidUtilities.dp(6.0f), bounds.top, bounds.right, bounds.bottom);
                                canvas.save();
                                canvas.translate(f3, f2);
                                canvas.clipRect(bounds.left - AndroidUtilities.dp(6.0f), bounds.bottom - AndroidUtilities.dp(16.0f), bounds.left + AndroidUtilities.dp(18.0f), bounds.bottom);
                            } else {
                                messageDrawable = (Theme.MessageDrawable) getThemedDrawable(str);
                                Rect bounds2 = this.currentBackgroundDrawable.getBounds();
                                messageDrawable.setBounds(bounds2.left, bounds2.top, bounds2.right + AndroidUtilities.dp(6.0f), bounds2.bottom);
                                canvas.save();
                                canvas.translate(-f3, f2);
                                canvas.clipRect(bounds2.right - AndroidUtilities.dp(16.0f), bounds2.bottom - AndroidUtilities.dp(16.0f), bounds2.right + AndroidUtilities.dp(16.0f), bounds2.bottom);
                                int parentWidth = this.parentWidth;
                                int i12 = this.parentHeight;
                                if (i12 == 0) {
                                    parentWidth = getParentWidth();
                                    i12 = AndroidUtilities.displaySize.y;
                                    if (getParent() instanceof View) {
                                        View view = (View) getParent();
                                        int measuredWidth = view.getMeasuredWidth();
                                        measuredHeight = view.getMeasuredHeight();
                                        i2 = measuredWidth;
                                    } else {
                                        i2 = parentWidth;
                                        measuredHeight = i12;
                                    }
                                    float y = getY();
                                    float f8 = this.parentViewTopOffset;
                                    messageDrawable.setTop((int) (y + f8), i2, measuredHeight, (int) f8, this.blurredViewTopOffset, this.blurredViewBottomOffset, this.pinnedTop, this.pinnedBottom);
                                    MessageObject messageObject4 = this.currentMessageObject;
                                    messageDrawable.setBotButtonsBottom(messageObject4 != null && messageObject4.hasInlineBotButtons());
                                    messageDrawable.setAlpha((int) (((this.mediaBackground || this.pinnedBottom) ? f4 - this.transitionParams.changePinnedBottomProgress : this.transitionParams.changePinnedBottomProgress) * 255.0f));
                                }
                            }
                            messageDrawable.draw(canvas);
                            messageDrawable.setAlpha(255);
                            canvas.restore();
                        }
                    }
                    f4 = 1.0f;
                    f5 = 255.0f;
                    if (drawable != null) {
                    }
                    if (this.transitionParams.changePinnedBottomProgress != f4) {
                    }
                }
            }
            MessageObject messageObject5 = this.currentMessageObject;
            if (messageObject5 != null && messageObject5.isRoundVideo()) {
                this.currentBackgroundDrawable.setRoundingRadius(f2);
            }
            canvas.restoreToCount(saveCount);
        }
    }

    public void drawBlurredPhoto(Canvas canvas) {
        ImageReceiver imageReceiver;
        if (this.currentMessageObject.isMediaSpoilersRevealed || this.mediaSpoilerRevealProgress == 1.0f) {
            return;
        }
        int[] roundRadius = this.photoImage.getRoundRadius();
        float[] fArr = this.mediaSpoilerRadii;
        float f = roundRadius[0];
        fArr[1] = f;
        fArr[0] = f;
        float f2 = roundRadius[1];
        fArr[3] = f2;
        fArr[2] = f2;
        float f3 = roundRadius[2];
        fArr[5] = f3;
        fArr[4] = f3;
        float f4 = roundRadius[3];
        fArr[7] = f4;
        fArr[6] = f4;
        this.mediaSpoilerPath.rewind();
        RectF rectF = AndroidUtilities.rectTmp;
        rectF.set(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX2(), this.photoImage.getImageY2());
        Path path = this.mediaSpoilerPath;
        float[] fArr2 = this.mediaSpoilerRadii;
        Path.Direction direction = Path.Direction.CW;
        path.addRoundRect(rectF, fArr2, direction);
        canvas.save();
        canvas.clipPath(this.mediaSpoilerPath);
        if (this.mediaSpoilerRevealProgress != BitmapDescriptorFactory.HUE_RED) {
            this.mediaSpoilerPath.rewind();
            this.mediaSpoilerPath.addCircle(this.mediaSpoilerRevealX, this.mediaSpoilerRevealY, this.mediaSpoilerRevealMaxRadius * this.mediaSpoilerRevealProgress, direction);
            canvas.clipPath(this.mediaSpoilerPath, Region.Op.DIFFERENCE);
        }
        if (this.currentMessageObject.needDrawBluredPreview()) {
            imageReceiver = this.photoImage;
        } else {
            this.blurredPhotoImage.setImageCoords(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageWidth(), this.photoImage.getImageHeight());
            this.blurredPhotoImage.setRoundRadius(this.photoImage.getRoundRadius());
            imageReceiver = this.blurredPhotoImage;
        }
        imageReceiver.draw(canvas);
        drawBlurredPhotoParticles(canvas);
        canvas.restore();
    }

    public void drawBlurredPhotoParticles(Canvas canvas) {
        if (this.mediaSpoilerEffect2 == null) {
            return;
        }
        canvas.save();
        canvas.translate(this.photoImage.getImageX(), this.photoImage.getImageY());
        this.mediaSpoilerEffect2.draw(canvas, this, (int) this.photoImage.getImageWidth(), (int) this.photoImage.getImageHeight(), this.photoImage.getAlpha(), this.drawingToBitmap);
        canvas.restore();
        invalidate();
    }

    public void drawCaptionLayout(Canvas canvas, boolean z, float f) {
        MessageObject.TextLayoutBlocks textLayoutBlocks;
        boolean z2;
        ChatMessageCell chatMessageCell;
        Canvas canvas2;
        boolean z3;
        float f2;
        if (this.animatedEmojiStack != null && !(canvas instanceof SizeNotifierFrameLayout.SimplerCanvas) && (this.captionLayout != null || this.transitionParams.animateOutCaptionLayout != null)) {
            this.animatedEmojiStack.clearPositions();
        }
        TransitionParams transitionParams = this.transitionParams;
        if (!transitionParams.animateReplaceCaptionLayout || transitionParams.animateChangeProgress == 1.0f) {
            textLayoutBlocks = this.captionLayout;
            z2 = true;
            chatMessageCell = this;
            canvas2 = canvas;
            z3 = z;
            f2 = f;
        } else {
            canvas2 = canvas;
            z3 = z;
            drawCaptionLayout(canvas2, transitionParams.animateOutCaptionLayout, false, z3, f * (1.0f - this.transitionParams.animateChangeProgress));
            textLayoutBlocks = this.captionLayout;
            f2 = f * this.transitionParams.animateChangeProgress;
            z2 = true;
            chatMessageCell = this;
        }
        chatMessageCell.drawCaptionLayout(canvas2, textLayoutBlocks, z2, z3, f2);
        if (!z) {
            drawAnimatedEmojiCaption(canvas, f);
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || messageObject.messageOwner == null || !messageObject.isVoiceTranscriptionOpen()) {
            return;
        }
        MessageObject messageObject2 = this.currentMessageObject;
        if (messageObject2.messageOwner.voiceTranscriptionFinal || !TranscribeButton.isTranscribing(messageObject2)) {
            return;
        }
        invalidate();
    }

    public void drawCheckBox(Canvas canvas) {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || messageObject.isSending()) {
            return;
        }
        MessageObject messageObject2 = this.currentMessageObject;
        if (messageObject2.type == 27 || messageObject2.isSendError() || this.checkBox == null) {
            return;
        }
        if (this.checkBoxVisible || this.checkBoxAnimationInProgress) {
            MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
            if (groupedMessagePosition != null) {
                int i = groupedMessagePosition.flags;
                if ((i & 8) == 0 || (i & 1) == 0) {
                    return;
                }
            }
            canvas.save();
            float y = getY() + getPaddingTop();
            MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
            canvas.translate(this.sideMenuWidth, ((groupedMessages == null || groupedMessages.messages.size() <= 1) ? y + this.transitionParams.deltaTop : (getTop() + this.currentMessagesGroup.transitionParams.offsetTop) - getTranslationY()) + this.transitionYOffsetForDrawables);
            this.checkBox.draw(canvas);
            canvas.restore();
        }
    }

    public void drawCommentButton(Canvas canvas, float f) {
        if (this.drawSideButton != 3) {
            return;
        }
        int iDp = AndroidUtilities.dp(32.0f);
        if (this.commentLayout != null) {
            this.sideStartY -= AndroidUtilities.dp(18.0f);
            iDp += AndroidUtilities.dp(18.0f);
        }
        RectF rectF = this.rect;
        float f2 = this.sideStartX;
        rectF.set(f2, this.sideStartY, AndroidUtilities.dp(32.0f) + f2, this.sideStartY + iDp);
        applyServiceShaderMatrix();
        if (f != 1.0f) {
            int alpha = getThemedPaint("paintChatActionBackground").getAlpha();
            getThemedPaint("paintChatActionBackground").setAlpha((int) (alpha * f));
            canvas.drawRoundRect(this.rect, AndroidUtilities.dp(16.0f), AndroidUtilities.dp(16.0f), getThemedPaint("paintChatActionBackground"));
            getThemedPaint("paintChatActionBackground").setAlpha(alpha);
        } else {
            canvas.drawRoundRect(this.rect, AndroidUtilities.dp(16.0f), AndroidUtilities.dp(16.0f), getThemedPaint(this.sideButtonPressed ? "paintChatActionBackgroundSelected" : "paintChatActionBackground"));
        }
        if (hasGradientService()) {
            if (f != 1.0f) {
                int alpha2 = Theme.chat_actionBackgroundGradientDarkenPaint.getAlpha();
                Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha((int) (alpha2 * f));
                canvas.drawRoundRect(this.rect, AndroidUtilities.dp(16.0f), AndroidUtilities.dp(16.0f), Theme.chat_actionBackgroundGradientDarkenPaint);
                Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha(alpha2);
            } else {
                canvas.drawRoundRect(this.rect, AndroidUtilities.dp(16.0f), AndroidUtilities.dp(16.0f), Theme.chat_actionBackgroundGradientDarkenPaint);
            }
        }
        Drawable themeDrawable = Theme.getThemeDrawable("drawableCommentSticker");
        BaseCell.setDrawableBounds(themeDrawable, this.sideStartX + AndroidUtilities.dp(4.0f), this.sideStartY + AndroidUtilities.dp(4.0f));
        if (f != 1.0f) {
            themeDrawable.setAlpha((int) (f * 255.0f));
            themeDrawable.draw(canvas);
            themeDrawable.setAlpha(255);
        } else {
            themeDrawable.draw(canvas);
        }
        if (this.commentLayout != null) {
            Theme.chat_stickerCommentCountPaint.setColor(getThemedColor(Theme.key_chat_stickerReplyNameText));
            Theme.chat_stickerCommentCountPaint.setAlpha((int) (f * 255.0f));
            if (this.transitionParams.animateComments) {
                if (this.transitionParams.animateCommentsLayout != null) {
                    canvas.save();
                    TextPaint textPaint = Theme.chat_stickerCommentCountPaint;
                    double d = this.transitionParams.animateChangeProgress;
                    Double.isNaN(d);
                    double d2 = (1.0d - d) * 255.0d;
                    double d3 = f;
                    Double.isNaN(d3);
                    textPaint.setAlpha((int) (d2 * d3));
                    canvas.translate(this.sideStartX + ((AndroidUtilities.dp(32.0f) - this.transitionParams.animateTotalCommentWidth) / 2), this.sideStartY + AndroidUtilities.dp(30.0f));
                    this.transitionParams.animateCommentsLayout.draw(canvas);
                    canvas.restore();
                }
                Theme.chat_stickerCommentCountPaint.setAlpha((int) (this.transitionParams.animateChangeProgress * 255.0f));
            }
            canvas.save();
            canvas.translate(this.sideStartX + ((AndroidUtilities.dp(32.0f) - this.totalCommentWidth) / 2), this.sideStartY + AndroidUtilities.dp(30.0f));
            this.commentLayout.draw(canvas);
            canvas.restore();
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:182:0x0372  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawCommentLayout(Canvas canvas, float f) {
        int i;
        int iDp;
        int i2;
        int iDp2;
        int i3;
        int i4;
        MessageObject messageObject;
        int i5;
        boolean z;
        Paint paint;
        int i6;
        int i7;
        float f2;
        float f3;
        InfiniteProgress infiniteProgress;
        int i8;
        Drawable drawable;
        int i9;
        int i10;
        TextPaint textPaint;
        float f4;
        MessageObject messageObject2;
        TLRPC.MessageReplies messageReplies;
        int i11;
        int i12;
        if (this.mediaBackground) {
            i = this.backgroundDrawableLeft;
            iDp = AndroidUtilities.dp(12.0f);
        } else {
            i = this.backgroundDrawableLeft;
            iDp = AndroidUtilities.dp(this.drawPinnedBottom ? 12.0f : 18.0f);
        }
        int extraTextX = i + iDp + getExtraTextX();
        int extraTextX2 = extraTextX - getExtraTextX();
        int i13 = 1;
        if (this.currentMessagesGroup == null || this.currentMessageObject.isMusic() || this.currentMessageObject.isDocument()) {
            i2 = extraTextX;
            iDp2 = extraTextX2 + (this.backgroundWidth - (this.mediaBackground ? 0 : AndroidUtilities.dp(9.0f)));
        } else {
            int groupPhotosWidth = getGroupPhotosWidth();
            if ((this.currentPosition.flags & 1) == 0) {
                double d = extraTextX2;
                double dCeil = Math.ceil((r4.pw / 1000.0f) * groupPhotosWidth);
                Double.isNaN(d);
                iDp2 = (int) (d + dCeil);
                i2 = extraTextX;
            } else {
                int i14 = 0;
                int i15 = 0;
                while (i14 < this.currentMessagesGroup.posArray.size()) {
                    if (this.currentMessagesGroup.posArray.get(i14).minY != 0) {
                        break;
                    }
                    double d2 = i15;
                    double dCeil2 = Math.ceil(((r13.pw + r13.leftSpanOffset) / 1000.0f) * groupPhotosWidth);
                    Double.isNaN(d2);
                    i15 = (int) (d2 + dCeil2);
                    i14++;
                    extraTextX = extraTextX;
                }
                i2 = extraTextX;
                iDp2 = extraTextX2 + (i15 - AndroidUtilities.dp(9.0f));
            }
            TLRPC.Chat chat = this.currentChat;
            if (chat != null && chat.signature_profiles) {
                iDp2 -= AndroidUtilities.dp(48.0f);
            }
        }
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if (groupedMessagePosition != null && (groupedMessagePosition.flags & 1) == 0 && !this.currentMessagesGroup.hasSibling) {
            iDp2 += AndroidUtilities.dp(14.0f);
        }
        if (this.currentBackgroundDrawable == null || !this.drawCommentButton || this.timeLayout == null) {
            return;
        }
        float fDp = ((this.layoutHeight + this.transitionParams.deltaBottom) - AndroidUtilities.dp(18.0f)) - this.timeLayout.getHeight();
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages != null) {
            MessageObject.GroupedMessages.TransitionParams transitionParams = groupedMessages.transitionParams;
            fDp += transitionParams.offsetBottom;
            if (transitionParams.backgroundChangeBounds) {
                fDp -= getTranslationY();
            }
        }
        float f5 = fDp;
        if (this.pinnedBottom) {
            i3 = 2;
            i4 = 3;
        } else if (this.pinnedTop) {
            i3 = 4;
            i4 = 1;
        } else {
            i3 = 3;
            i4 = 0;
        }
        int currentBackgroundLeft = getCurrentBackgroundLeft() + AndroidUtilities.dp((this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 2.0f : 8.0f);
        float f6 = 45.1f - i4;
        float fDp2 = this.layoutHeight - AndroidUtilities.dp(f6);
        MessageObject.GroupedMessagePosition groupedMessagePosition2 = this.currentPosition;
        if (groupedMessagePosition2 != null && (groupedMessagePosition2.flags & 1) == 0 && !this.currentMessagesGroup.hasSibling) {
            currentBackgroundLeft -= AndroidUtilities.dp(10.0f);
        }
        Rect rect = this.commentButtonRect;
        MessageObject messageObject3 = this.currentMessageObject;
        rect.set(currentBackgroundLeft - AndroidUtilities.dp(((messageObject3 == null || !messageObject3.isOutOwner()) && !this.drawPinnedBottom && this.currentPosition == null && ((messageObject = this.currentMessageObject) == null || messageObject.type != 17 || this.pollInstantViewTouchesBottom)) ? 6.0f : BitmapDescriptorFactory.HUE_RED), (int) fDp2, iDp2 - AndroidUtilities.dp(14.0f), (this.layoutHeight - AndroidUtilities.dp(i3)) + 1);
        if (this.selectorDrawable[1] != null && this.selectorDrawableMaskType[1] == 2) {
            int saveCount = canvas.getSaveCount();
            this.selectorDrawable[1].setBounds(this.commentButtonRect);
            this.selectorDrawable[1].draw(canvas);
            canvas.restoreToCount(saveCount);
        }
        MessageObject.GroupedMessagePosition groupedMessagePosition3 = this.currentPosition;
        if (groupedMessagePosition3 == null || ((groupedMessagePosition3.flags & 1) != 0 && groupedMessagePosition3.minX == 0 && groupedMessagePosition3.maxX == 0)) {
            ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
            boolean z2 = chatMessageCellDelegate != null && chatMessageCellDelegate.shouldDrawThreadProgress(this, false);
            ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
            boolean z3 = chatMessageCellDelegate2 != null && chatMessageCellDelegate2.shouldDrawThreadProgress(this, true);
            if (z2) {
                LoadingDrawable loadingDrawable = this.commentLoading;
                if (loadingDrawable == null) {
                    LoadingDrawable loadingDrawable2 = new LoadingDrawable();
                    this.commentLoading = loadingDrawable2;
                    loadingDrawable2.setAppearByGradient(true);
                } else if (loadingDrawable.isDisappeared() || this.commentLoading.isDisappearing()) {
                    this.commentLoading.reset();
                    this.commentLoading.resetDisappear();
                }
            } else {
                LoadingDrawable loadingDrawable3 = this.commentLoading;
                if (loadingDrawable3 != null && !loadingDrawable3.isDisappearing() && !this.commentLoading.isDisappeared()) {
                    this.commentLoading.disappear();
                }
            }
            LoadingDrawable loadingDrawable4 = this.commentLoading;
            if (loadingDrawable4 != null && !loadingDrawable4.isDisappeared()) {
                int themedColor = getThemedColor(Theme.key_chat_inInstant);
                this.commentLoading.setColors(Theme.multAlpha(themedColor, 0.05f), Theme.multAlpha(themedColor, 0.15f));
                this.commentLoading.setBounds(this.commentButtonRect);
                canvas.save();
                MaskDrawable maskDrawable = this.selectorMaskDrawable[1];
                if (maskDrawable != null) {
                    maskDrawable.setBounds(this.commentButtonRect);
                    this.selectorMaskDrawable[1].updatePath();
                    canvas.clipPath(this.selectorMaskDrawable[1].path);
                }
                this.commentLoading.draw(canvas);
                canvas.restore();
                invalidate();
            }
            if (getAlpha() != 1.0f) {
                RectF rectF = AndroidUtilities.rectTmp;
                rectF.set(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, getWidth(), getHeight());
                canvas.saveLayerAlpha(rectF, (int) (getAlpha() * 255.0f), 31);
            }
            Theme.chat_instantViewPaint.setColor(getThemedColor(Theme.key_chat_inPreviewInstantText));
            if (this.commentAvatarImages != null) {
                int iDp3 = AndroidUtilities.dp(17.0f);
                int extraTextX3 = i2 + getExtraTextX();
                int length = this.commentAvatarImages.length - 1;
                int i16 = 2;
                z = false;
                while (length >= 0) {
                    if (this.commentAvatarImagesVisible[length] && this.commentAvatarImages[length].hasImageSet()) {
                        this.commentAvatarImages[length].setImageX(extraTextX3 + (iDp3 * length));
                        this.commentAvatarImages[length].setImageY((f5 - AndroidUtilities.dp(4.0f)) + (this.pinnedBottom ? AndroidUtilities.dp(2.0f) : 0));
                        ImageReceiver[] imageReceiverArr = this.commentAvatarImages;
                        if (length != imageReceiverArr.length - i13) {
                            canvas.drawCircle(imageReceiverArr[length].getCenterX(), this.commentAvatarImages[length].getCenterY(), AndroidUtilities.dp(13.0f), this.currentBackgroundDrawable.getPaint());
                        }
                        this.commentAvatarImages[length].draw(canvas);
                        if (length != 0) {
                            i16 += 17;
                        }
                        z = true;
                    }
                    length--;
                    i13 = 1;
                }
                i5 = i16;
            } else {
                i5 = 2;
                z = false;
            }
            if (getAlpha() != 1.0f) {
                canvas.restore();
            }
            if (this.mediaBackground && this.captionLayout == null) {
                ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                if (reactionsLayoutInBubble.isEmpty || reactionsLayoutInBubble.isSmall) {
                    i7 = i2;
                    f2 = 1.0f;
                }
            } else {
                if (isDrawSelectionBackground()) {
                    paint = Theme.chat_replyLinePaint;
                    i6 = this.currentMessageObject.isOutOwner() ? Theme.key_chat_outVoiceSeekbarSelected : Theme.key_chat_inVoiceSeekbarSelected;
                } else {
                    paint = Theme.chat_replyLinePaint;
                    i6 = this.currentMessageObject.isOutOwner() ? Theme.key_chat_outVoiceSeekbar : Theme.key_chat_inVoiceSeekbar;
                }
                paint.setColor(getThemedColor(i6));
                float fDp3 = this.layoutHeight - AndroidUtilities.dp(f6);
                TransitionParams transitionParams2 = this.transitionParams;
                float translationY = fDp3 + transitionParams2.deltaBottom;
                MessageObject.GroupedMessages groupedMessages2 = this.currentMessagesGroup;
                if (groupedMessages2 != null) {
                    MessageObject.GroupedMessages.TransitionParams transitionParams3 = groupedMessages2.transitionParams;
                    translationY += transitionParams3.offsetBottom;
                    if (transitionParams3.backgroundChangeBounds) {
                        translationY -= getTranslationY();
                    }
                } else {
                    iDp2 = (i2 + ((int) ((this.backgroundWidth - transitionParams2.deltaLeft) + transitionParams2.deltaRight))) - AndroidUtilities.dp(12.0f);
                }
                int i17 = iDp2;
                float f7 = translationY;
                Theme.chat_replyLinePaint.setAlpha((int) (r1.getAlpha() * getAlpha()));
                i7 = i2;
                f2 = 1.0f;
                canvas.drawLine(i7, f7, i17 - AndroidUtilities.dp(14.0f), f7, Theme.chat_replyLinePaint);
                iDp2 = i17;
            }
            if (this.commentLayout != null && this.drawSideButton != 3) {
                Theme.chat_commentTextPaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outPreviewInstantText : Theme.key_chat_inPreviewInstantText));
                float f8 = i5 + 33;
                int iDp4 = i7 + AndroidUtilities.dp(f8);
                this.commentX = iDp4;
                if (this.drawCommentNumber) {
                    this.commentX = iDp4 + this.commentNumberWidth + AndroidUtilities.dp(4.0f);
                }
                int alpha = Theme.chat_commentTextPaint.getAlpha();
                if (!this.transitionParams.animateComments || this.transitionParams.animateCommentsLayout == null) {
                    i8 = alpha;
                } else {
                    canvas.save();
                    TextPaint textPaint2 = Theme.chat_commentTextPaint;
                    double d3 = alpha;
                    i8 = alpha;
                    double d4 = this.transitionParams.animateChangeProgress;
                    Double.isNaN(d4);
                    Double.isNaN(d3);
                    textPaint2.setAlpha((int) (d3 * (1.0d - d4)));
                    canvas.translate(this.transitionParams.animateCommentX + ((this.commentX - this.transitionParams.animateCommentX) * this.transitionParams.animateChangeProgress), (f5 - AndroidUtilities.dp(0.1f)) + (this.pinnedBottom ? AndroidUtilities.dp(2.0f) : 0));
                    this.transitionParams.animateCommentsLayout.draw(canvas);
                    canvas.restore();
                }
                canvas.save();
                canvas.translate(i7 + AndroidUtilities.dp(f8), (f5 - AndroidUtilities.dp(0.1f)) + (this.pinnedBottom ? AndroidUtilities.dp(2.0f) : 0));
                if (this.currentMessageObject.isSent()) {
                    drawable = Theme.chat_commentArrowDrawable;
                    i9 = 255;
                } else {
                    i9 = 127;
                    Theme.chat_commentTextPaint.setAlpha(127);
                    drawable = Theme.chat_commentArrowDrawable;
                }
                drawable.setAlpha(i9);
                Theme.chat_commentDrawable.setAlpha(i9);
                if (this.drawCommentNumber || (this.transitionParams.animateComments && this.transitionParams.animateDrawCommentNumber)) {
                    if (!this.drawCommentNumber || !this.transitionParams.animateComments) {
                        i10 = i8;
                    } else if (this.transitionParams.animateDrawCommentNumber) {
                        i10 = i8;
                        Theme.chat_commentTextPaint.setAlpha(i10);
                    } else {
                        i10 = i8;
                        Theme.chat_commentTextPaint.setAlpha((int) (i10 * this.transitionParams.animateChangeProgress));
                    }
                    Theme.chat_commentTextPaint.setAlpha((int) (r3.getAlpha() * getAlpha()));
                    this.commentNumberLayout.draw(canvas);
                    if (this.drawCommentNumber) {
                        canvas.translate(this.commentNumberWidth + AndroidUtilities.dp(4.0f), BitmapDescriptorFactory.HUE_RED);
                    }
                } else {
                    i10 = i8;
                }
                if (!this.transitionParams.animateComments || this.transitionParams.animateCommentsLayout == null) {
                    textPaint = Theme.chat_commentTextPaint;
                    f4 = i10 * f;
                } else {
                    textPaint = Theme.chat_commentTextPaint;
                    f4 = i10 * this.transitionParams.animateChangeProgress;
                }
                textPaint.setAlpha((int) f4);
                Theme.chat_commentTextPaint.setAlpha((int) (r3.getAlpha() * getAlpha()));
                this.commentLayout.draw(canvas);
                canvas.restore();
                int iDp5 = i7 + this.commentWidth + AndroidUtilities.dp(f8) + AndroidUtilities.dp(9.0f);
                this.commentUnreadX = iDp5;
                if (this.drawCommentNumber) {
                    this.commentUnreadX = iDp5 + this.commentNumberWidth + AndroidUtilities.dp(4.0f);
                }
                MessageObject.GroupedMessages groupedMessages3 = this.currentMessagesGroup;
                if (groupedMessages3 == null || groupedMessages3.messages.isEmpty()) {
                    if (this.currentMessageObject.hasReplies()) {
                        messageObject2 = this.currentMessageObject;
                    }
                } else {
                    messageObject2 = this.currentMessagesGroup.messages.get(0);
                    messageReplies = messageObject2.hasReplies() ? messageObject2.messageOwner.replies : null;
                }
                boolean z4 = (messageReplies == null || (i12 = messageReplies.read_max_id) == 0 || i12 >= messageReplies.max_id) ? false : true;
                this.commentDrawUnread = z4;
                if (z4) {
                    Theme.chat_docBackPaint.setColor(getThemedColor(Theme.key_chat_inInstant));
                    if (this.transitionParams.animateComments) {
                        if (!this.transitionParams.animateCommentDrawUnread) {
                            Theme.chat_docBackPaint.setAlpha((int) (Color.alpha(r2) * this.transitionParams.animateChangeProgress));
                        }
                        i11 = (int) (this.transitionParams.animateCommentUnreadX + ((this.commentUnreadX - this.transitionParams.animateCommentUnreadX) * this.transitionParams.animateChangeProgress));
                    } else {
                        i11 = this.commentUnreadX;
                    }
                    canvas.drawCircle(i11, AndroidUtilities.dp(8.0f) + f5 + (this.pinnedBottom ? AndroidUtilities.dp(2.0f) : 0), AndroidUtilities.dp(2.5f), Theme.chat_docBackPaint);
                }
            }
            if (!z) {
                BaseCell.setDrawableBounds(Theme.chat_commentDrawable, i7, (f5 - AndroidUtilities.dp(4.0f)) + (this.pinnedBottom ? AndroidUtilities.dp(2.0f) : 0));
                if (f != f2) {
                    Theme.chat_commentDrawable.setAlpha((int) (f * 255.0f));
                    Theme.chat_commentDrawable.draw(canvas);
                    Theme.chat_commentDrawable.setAlpha(255);
                } else {
                    Theme.chat_commentDrawable.draw(canvas);
                }
            }
            this.commentArrowX = iDp2 - AndroidUtilities.dp(44.0f);
            int i18 = this.transitionParams.animateComments ? (int) (this.transitionParams.animateCommentArrowX + ((this.commentArrowX - this.transitionParams.animateCommentArrowX) * this.transitionParams.animateChangeProgress)) : this.commentArrowX;
            float fDp4 = (f5 - AndroidUtilities.dp(4.0f)) + (this.pinnedBottom ? AndroidUtilities.dp(2.0f) : 0);
            long jElapsedRealtime = SystemClock.elapsedRealtime();
            long j = jElapsedRealtime - this.commentProgressLastUpadteTime;
            this.commentProgressLastUpadteTime = jElapsedRealtime;
            if (j > 17) {
                j = 17;
            }
            float f9 = this.commentProgressAlpha;
            if (z3) {
                if (f9 < f2) {
                    float f10 = f9 + (j / 180.0f);
                    this.commentProgressAlpha = f10;
                    if (f10 > f2) {
                        this.commentProgressAlpha = f2;
                    }
                }
                f3 = BitmapDescriptorFactory.HUE_RED;
            } else {
                f3 = BitmapDescriptorFactory.HUE_RED;
                if (f9 > BitmapDescriptorFactory.HUE_RED) {
                    float f11 = f9 - (j / 180.0f);
                    this.commentProgressAlpha = f11;
                    if (f11 < BitmapDescriptorFactory.HUE_RED) {
                        this.commentProgressAlpha = BitmapDescriptorFactory.HUE_RED;
                    }
                }
            }
            if ((z3 || this.commentProgressAlpha > f3) && (infiniteProgress = this.commentProgress) != null) {
                infiniteProgress.setColor(getThemedColor(Theme.key_chat_inInstant));
                this.commentProgress.setAlpha(this.commentProgressAlpha);
                this.commentProgress.draw(canvas, AndroidUtilities.dp(11.0f) + i18, AndroidUtilities.dp(12.0f) + fDp4, this.commentProgressAlpha);
                invalidate();
            }
            if (!z3 || this.commentProgressAlpha < f2) {
                int intrinsicWidth = Theme.chat_commentArrowDrawable.getIntrinsicWidth() / 2;
                float f12 = i18 + intrinsicWidth;
                float intrinsicHeight = Theme.chat_commentArrowDrawable.getIntrinsicHeight() / 2;
                float f13 = fDp4 + intrinsicHeight;
                Drawable drawable2 = Theme.chat_commentArrowDrawable;
                float f14 = f2 - this.commentProgressAlpha;
                float f15 = intrinsicWidth * f14;
                float f16 = intrinsicHeight * f14;
                drawable2.setBounds((int) (f12 - f15), (int) (f13 - f16), (int) (f12 + f15), (int) (f13 + f16));
                Theme.chat_commentArrowDrawable.setAlpha((int) ((f2 - this.commentProgressAlpha) * 255.0f * f));
                Theme.chat_commentArrowDrawable.draw(canvas);
            }
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:1077:0x1870  */
    /* JADX WARN: Removed duplicated region for block: B:252:0x0532  */
    /* JADX WARN: Removed duplicated region for block: B:392:0x070f  */
    /* JADX WARN: Removed duplicated region for block: B:412:0x0797  */
    /* JADX WARN: Removed duplicated region for block: B:469:0x0902  */
    /* JADX WARN: Removed duplicated region for block: B:470:0x0906  */
    /* JADX WARN: Removed duplicated region for block: B:473:0x090f  */
    /* JADX WARN: Removed duplicated region for block: B:474:0x0912  */
    /* JADX WARN: Removed duplicated region for block: B:485:0x0937  */
    /* JADX WARN: Removed duplicated region for block: B:489:0x0941  */
    /* JADX WARN: Removed duplicated region for block: B:492:0x0981  */
    /* JADX WARN: Removed duplicated region for block: B:497:0x0994  */
    /* JADX WARN: Removed duplicated region for block: B:506:0x09b1  */
    /* JADX WARN: Removed duplicated region for block: B:514:0x0a13  */
    /* JADX WARN: Removed duplicated region for block: B:517:0x0a1d  */
    /* JADX WARN: Removed duplicated region for block: B:527:0x0ab5  */
    /* JADX WARN: Removed duplicated region for block: B:603:0x0c40  */
    /* JADX WARN: Removed duplicated region for block: B:614:0x0c6a  */
    /* JADX WARN: Removed duplicated region for block: B:619:0x0c97  */
    /* JADX WARN: Removed duplicated region for block: B:630:0x0cd3  */
    /* JADX WARN: Removed duplicated region for block: B:631:0x0cd6  */
    /* JADX WARN: Removed duplicated region for block: B:642:0x0cfb  */
    /* JADX WARN: Removed duplicated region for block: B:646:0x0d05  */
    /* JADX WARN: Removed duplicated region for block: B:649:0x0d13  */
    /* JADX WARN: Removed duplicated region for block: B:650:0x0d16  */
    /* JADX WARN: Removed duplicated region for block: B:654:0x0d2e  */
    /* JADX WARN: Removed duplicated region for block: B:657:0x0d4e  */
    /* JADX WARN: Removed duplicated region for block: B:658:0x0d52  */
    /* JADX WARN: Removed duplicated region for block: B:666:0x0d79  */
    /* JADX WARN: Removed duplicated region for block: B:671:0x0d90  */
    /* JADX WARN: Removed duplicated region for block: B:673:0x0d94  */
    /* JADX WARN: Removed duplicated region for block: B:678:0x0dc2  */
    /* JADX WARN: Removed duplicated region for block: B:685:0x0df2  */
    /* JADX WARN: Removed duplicated region for block: B:689:0x0dfe  */
    /* JADX WARN: Removed duplicated region for block: B:695:0x0e0a  */
    /* JADX WARN: Removed duplicated region for block: B:704:0x0e32  */
    /* JADX WARN: Removed duplicated region for block: B:705:0x0e35  */
    /* JADX WARN: Removed duplicated region for block: B:708:0x0e3f  */
    /* JADX WARN: Removed duplicated region for block: B:709:0x0e42  */
    /* JADX WARN: Removed duplicated region for block: B:712:0x0e4f  */
    /* JADX WARN: Removed duplicated region for block: B:726:0x0e8e  */
    /* JADX WARN: Removed duplicated region for block: B:728:0x0ec5  */
    /* JADX WARN: Removed duplicated region for block: B:748:0x0fed  */
    /* JADX WARN: Removed duplicated region for block: B:749:0x0ff0  */
    /* JADX WARN: Removed duplicated region for block: B:752:0x0ffa  */
    /* JADX WARN: Removed duplicated region for block: B:753:0x0ffd  */
    /* JADX WARN: Removed duplicated region for block: B:756:0x1015  */
    /* JADX WARN: Removed duplicated region for block: B:757:0x1017  */
    /* JADX WARN: Removed duplicated region for block: B:761:0x102c  */
    /* JADX WARN: Removed duplicated region for block: B:779:0x10ad  */
    /* JADX WARN: Removed duplicated region for block: B:780:0x10b0  */
    /* JADX WARN: Removed duplicated region for block: B:796:0x10dd  */
    /* JADX WARN: Removed duplicated region for block: B:824:0x11b0  */
    /* JADX WARN: Removed duplicated region for block: B:830:0x11d0  */
    /* JADX WARN: Removed duplicated region for block: B:833:0x11d7  */
    /* JADX WARN: Removed duplicated region for block: B:836:0x11e0  */
    /* JADX WARN: Removed duplicated region for block: B:854:0x121e  */
    /* JADX WARN: Removed duplicated region for block: B:855:0x1221  */
    /* JADX WARN: Removed duplicated region for block: B:858:0x123d  */
    /* JADX WARN: Removed duplicated region for block: B:859:0x1240  */
    /* JADX WARN: Removed duplicated region for block: B:862:0x1264  */
    /* JADX WARN: Removed duplicated region for block: B:863:0x126c  */
    /* JADX WARN: Removed duplicated region for block: B:866:0x12a0  */
    /* JADX WARN: Removed duplicated region for block: B:875:0x12ea  */
    /* JADX WARN: Removed duplicated region for block: B:878:0x12f3  */
    /* JADX WARN: Removed duplicated region for block: B:880:0x12ff  */
    /* JADX WARN: Removed duplicated region for block: B:883:0x1308  */
    /* JADX WARN: Removed duplicated region for block: B:888:0x1356  */
    /* JADX WARN: Removed duplicated region for block: B:890:0x135d  */
    /* JADX WARN: Removed duplicated region for block: B:893:0x1366  */
    /* JADX WARN: Removed duplicated region for block: B:933:0x144b  */
    /* JADX WARN: Removed duplicated region for block: B:934:0x144e  */
    /* JADX WARN: Removed duplicated region for block: B:984:0x1627 A[LOOP:0: B:982:0x1624->B:984:0x1627, LOOP_END] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawContent(final Canvas canvas, boolean z) {
        boolean z2;
        boolean z3;
        MessageObject messageObject;
        ArrayList<MessageObject.TextLayoutBlock> arrayList;
        ChatMessageCellDelegate chatMessageCellDelegate;
        boolean z4;
        ViewGroup viewGroup;
        CheckBoxBase checkBoxBase;
        float progress;
        MessageObject messageObject2;
        int i;
        float f;
        RadialProgress2 radialProgress2;
        int i2;
        AudioVisualizerDrawable currentAudiVisualizerDrawable;
        int currentBackgroundLeft;
        int currentBackgroundLeft2;
        float useTranscribeButtonProgress;
        boolean zIsPlayingMessage;
        float fLerp;
        MessageObject messageObject3;
        RadialProgress2 radialProgress22;
        int i3;
        boolean zIsPlayingMessage2;
        float f2;
        float f3;
        float f4;
        MessageObject messageObject4;
        MessageObject messageObject5;
        float f5;
        float f6;
        int i4;
        int i5;
        int i6;
        MessageObject messageObject6;
        Drawable themedDrawable;
        float fDp;
        int iDp;
        int iDp2;
        RadialProgress2 radialProgress23;
        int i7;
        StaticLayout staticLayout;
        float imageX;
        int i8;
        RadialProgress2 radialProgress24;
        int i9;
        int iBlendOver;
        int[] roundRadius;
        int i10;
        int imageX2;
        Path path;
        float fDp2;
        TextPaint textPaint;
        int i11;
        int i12;
        float videoTranscriptionProgress;
        MessageObject messageObject7 = this.currentMessageObject;
        if (messageObject7 == null || !messageObject7.preview) {
            z2 = z;
            z3 = false;
        } else {
            z2 = z;
            z3 = true;
        }
        if (z2 != z3) {
            return;
        }
        boolean z5 = this.needNewVisiblePart && messageObject7.type == 0;
        boolean zHasSpoilers = hasSpoilers();
        if (z5 || zHasSpoilers) {
            getLocalVisibleRect(this.scrollRect);
            if (zHasSpoilers) {
                Rect rect = this.scrollRect;
                updateSpoilersVisiblePart(rect.top, rect.bottom);
            }
            if (z5) {
                Rect rect2 = this.scrollRect;
                int i13 = rect2.top;
                setVisiblePart(i13, rect2.bottom - i13, this.parentHeight, this.parentViewTopOffset, this.viewTop, this.parentWidth, this.backgroundHeight, this.blurredViewTopOffset, this.blurredViewBottomOffset);
                this.needNewVisiblePart = false;
            }
        }
        float fLerp2 = this.buttonX;
        float fLerp3 = this.buttonY;
        if (this.transitionParams.animateButton) {
            fLerp2 = AndroidUtilities.lerp(this.transitionParams.animateFromButtonX, this.buttonX, this.transitionParams.animateChangeProgress);
            fLerp3 = AndroidUtilities.lerp(this.transitionParams.animateFromButtonY, this.buttonY, this.transitionParams.animateChangeProgress);
            int i14 = (int) fLerp2;
            int i15 = (int) fLerp3;
            this.radialProgress.setProgressRect(i14, i15, AndroidUtilities.dp(44.0f) + i14, AndroidUtilities.dp(44.0f) + i15);
        }
        float f7 = fLerp3;
        updateSeekBarWaveformWidth(canvas);
        this.forceNotDrawTime = this.currentMessagesGroup != null;
        this.photoImage.setPressed(((this.isHighlightedAnimated || this.isHighlighted) && this.currentPosition != null) ? 2 : 0);
        this.photoImage.setVisible((PhotoViewer.isShowingImage(this.currentMessageObject) || SecretMediaViewer.getInstance().isShowingImage(this.currentMessageObject) || StoryViewer.isShowingImage(this.currentMessageObject)) ? false : true, false);
        this.blurredPhotoImage.setVisible(this.fitPhotoImage || !(PhotoViewer.isShowingImage(this.currentMessageObject) || SecretMediaViewer.getInstance().isShowingImage(this.currentMessageObject) || StoryViewer.isShowingImage(this.currentMessageObject)), false);
        GroupMedia groupMedia = this.groupMedia;
        if (groupMedia == null ? !this.photoImage.getVisible() : !groupMedia.allVisible()) {
            this.mediaWasInvisible = true;
            this.timeWasInvisible = true;
            int i16 = this.animatingNoSound;
            if (i16 == 1) {
                this.animatingNoSoundProgress = BitmapDescriptorFactory.HUE_RED;
            } else if (i16 == 2) {
                this.animatingNoSoundProgress = 1.0f;
            }
            this.animatingNoSound = 0;
        } else if (this.groupPhotoInvisible) {
            this.timeWasInvisible = true;
        } else {
            boolean z6 = this.mediaWasInvisible;
            if (z6 || this.timeWasInvisible) {
                if (z6) {
                    this.controlsAlpha = BitmapDescriptorFactory.HUE_RED;
                    this.mediaWasInvisible = false;
                }
                if (this.timeWasInvisible) {
                    this.timeAlpha = BitmapDescriptorFactory.HUE_RED;
                    this.timeWasInvisible = false;
                }
                this.lastControlsAlphaChangeTime = System.currentTimeMillis();
                this.totalChangeTime = 0L;
            }
        }
        RadialProgress2 radialProgress25 = this.radialProgress;
        int i17 = Theme.key_chat_mediaProgress;
        radialProgress25.setProgressColor(getThemedColor(i17));
        this.videoRadialProgress.setProgressColor(getThemedColor(i17));
        this.imageDrawn = false;
        this.radialProgress.setCircleCrossfadeColor(-1, BitmapDescriptorFactory.HUE_RED, 1.0f);
        GroupMedia groupMedia2 = this.groupMedia;
        if (groupMedia2 == null) {
            MessageObject messageObject8 = this.currentMessageObject;
            int i18 = messageObject8.type;
            if (i18 == 0 || i18 == 24 || i18 == 19 || messageObject8.isGiveawayOrGiveawayResults()) {
                layoutTextXY(false);
                if (!this.enterTransitionInProgress && (messageObject = this.currentMessageObject) != null && !messageObject.preview && (!this.transitionParams.animateExpandedQuotes || (chatMessageCellDelegate = this.delegate) == null || chatMessageCellDelegate.canDrawOutboundsContent())) {
                    if (!this.drawForBlur && !(canvas instanceof SizeNotifierFrameLayout.SimplerCanvas) && this.animatedEmojiStack != null && (((arrayList = this.currentMessageObject.textLayoutBlocks) != null && !arrayList.isEmpty()) || (this.transitionParams.animateOutTextBlocks != null && !this.transitionParams.animateOutTextBlocks.isEmpty()))) {
                        this.animatedEmojiStack.clearPositions();
                    }
                    drawMessageText(canvas);
                }
                if (!this.enterTransitionInProgress || this.currentMessageObject.isVoice()) {
                    drawLinkPreview(canvas, 1.0f);
                    getIconForCurrentState();
                }
                this.drawTime = true;
            } else if (this.drawPhotoImage) {
                float f8 = this.roundVideoPlayPipFloat.get();
                if (f8 > BitmapDescriptorFactory.HUE_RED) {
                    if (this.drillHolePaint == null) {
                        this.drillHolePaint = new Paint(1);
                    }
                    this.drillHolePaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outLoader : Theme.key_chat_inLoader));
                    this.drillHolePaint.setAlpha((int) (r2.getAlpha() * getVideoTranscriptionProgress()));
                    canvas.drawCircle(this.photoImage.getCenterX(), this.photoImage.getCenterY(), this.photoImage.getImageWidth() / 2.0f, this.drillHolePaint);
                }
                if (this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && MediaController.getInstance().isVideoDrawingReady() && canvas.isHardwareAccelerated() && ((messageObject2 = this.currentMessageObject) == null || !messageObject2.isVoiceTranscriptionOpen() || f8 >= 1.0f)) {
                    this.imageDrawn = true;
                    this.drawTime = true;
                } else {
                    if (this.currentMessageObject.type == 5 && Theme.chat_roundVideoShadow != null) {
                        float imageX3 = this.photoImage.getImageX() - AndroidUtilities.dp(3.0f);
                        float imageY = this.photoImage.getImageY() - AndroidUtilities.dp(2.0f);
                        Theme.chat_roundVideoShadow.setAlpha((int) ((1.0f - getVideoTranscriptionProgress()) * 255.0f));
                        Theme.chat_roundVideoShadow.setBounds((int) imageX3, (int) imageY, (int) (imageX3 + this.photoImage.getImageWidth() + AndroidUtilities.dp(6.0f)), (int) (imageY + this.photoImage.getImageHeight() + AndroidUtilities.dp(6.0f)));
                        Theme.chat_roundVideoShadow.draw(canvas);
                        Theme.chat_roundVideoShadow.setAlpha(255);
                        if (!this.photoImage.hasBitmapImage() || this.photoImage.getCurrentAlpha() != 1.0f) {
                            Theme.chat_docBackPaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outBubble : Theme.key_chat_inBubble));
                            canvas.drawCircle(this.photoImage.getCenterX(), this.photoImage.getCenterY(), this.photoImage.getImageWidth() / 2.0f, Theme.chat_docBackPaint);
                        }
                    }
                    CheckBoxBase checkBoxBase2 = this.mediaCheckBox;
                    boolean z7 = checkBoxBase2 != null && (this.checkBoxVisible || checkBoxBase2.getProgress() != BitmapDescriptorFactory.HUE_RED || this.checkBoxAnimationInProgress) && this.currentMessagesGroup != null;
                    this.drawMediaCheckBox = z7;
                    if (!z7 || (!(this.mediaCheckBox.isChecked() || this.mediaCheckBox.getProgress() != BitmapDescriptorFactory.HUE_RED || this.checkBoxAnimationInProgress) || textIsSelectionMode())) {
                        this.photoImage.setSideClip(BitmapDescriptorFactory.HUE_RED);
                    } else {
                        if (!this.currentMessagesGroup.isDocuments) {
                            Theme.chat_replyLinePaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outBubbleSelected : Theme.key_chat_inBubbleSelected));
                            this.rect.set(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX2(), this.photoImage.getImageY2());
                            int[] roundRadius2 = this.photoImage.getRoundRadius();
                            this.rectPath.reset();
                            for (int i19 = 0; i19 < roundRadius2.length; i19++) {
                                float[] fArr = radii;
                                int i20 = i19 * 2;
                                float f9 = roundRadius2[i19];
                                fArr[i20 + 1] = f9;
                                fArr[i20] = f9;
                            }
                            this.rectPath.addRoundRect(this.rect, radii, Path.Direction.CW);
                            this.rectPath.close();
                            canvas.drawPath(this.rectPath, Theme.chat_replyLinePaint);
                        }
                        this.photoImage.setSideClip(AndroidUtilities.dp(14.0f) * this.mediaCheckBox.getProgress());
                        if (this.checkBoxAnimationInProgress) {
                            checkBoxBase = this.mediaCheckBox;
                            progress = this.checkBoxAnimationProgress;
                        } else {
                            checkBoxBase = this.mediaCheckBox;
                            progress = this.checkBoxVisible ? 1.0f : checkBoxBase.getProgress();
                        }
                        checkBoxBase.setBackgroundAlpha(progress);
                    }
                    if (this.isRoundVideo && this.currentMessageObject.isVoiceTranscriptionOpen() && f8 > BitmapDescriptorFactory.HUE_RED) {
                        canvas.save();
                        Path path2 = this.drillHolePath;
                        if (path2 == null) {
                            this.drillHolePath = new Path();
                        } else {
                            path2.rewind();
                        }
                        this.drillHolePath.addCircle(this.photoImage.getCenterX(), this.photoImage.getCenterY(), (this.photoImage.getImageWidth() / 2.0f) * (1.0f - f8), Path.Direction.CW);
                        canvas.clipPath(this.drillHolePath);
                    }
                    ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
                    boolean z8 = (chatMessageCellDelegate2 == null || chatMessageCellDelegate2.getPinchToZoomHelper() == null || !this.delegate.getPinchToZoomHelper().isInOverlayModeFor(this)) ? false : true;
                    if (!z8 || this.fitPhotoImage) {
                        float y = getY() + getPaddingTop() + this.photoImage.getImageY();
                        float imageHeight = this.photoImage.getImageHeight() + y;
                        this.photoImageOutOfBounds = false;
                        if (!SizeNotifierFrameLayout.drawingBlur) {
                            float f10 = this.parentBoundsTop;
                            if ((f10 != BitmapDescriptorFactory.HUE_RED || this.parentBoundsBottom != 0) && (imageHeight < f10 || y > this.parentBoundsBottom)) {
                                this.photoImageOutOfBounds = true;
                            }
                        }
                        if (!this.photoImageOutOfBounds || this.drawForBlur) {
                            this.photoImage.setSkipUpdateFrame(this.drawForBlur || this.skipFrameUpdate);
                            if (this.flipImage) {
                                canvas.save();
                                canvas.scale(-1.0f, 1.0f, this.photoImage.getCenterX(), this.photoImage.getCenterY());
                                ImageReceiver imageReceiver = this.blurredPhotoImage;
                                if (imageReceiver != null && this.fitPhotoImage) {
                                    imageReceiver.setImageCoords(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageWidth(), this.photoImage.getImageHeight());
                                    this.blurredPhotoImage.setRoundRadius(this.photoImage.getRoundRadius());
                                    this.blurredPhotoImage.draw(canvas);
                                }
                                if (!z8) {
                                    if (allowDrawPhotoImage()) {
                                        this.imageDrawn = drawPhotoImage(canvas);
                                    } else {
                                        this.imageDrawn = true;
                                    }
                                    if (this.currentMessageObject.hasMediaSpoilers()) {
                                        drawBlurredPhoto(canvas);
                                    }
                                }
                                canvas.restore();
                            } else {
                                ImageReceiver imageReceiver2 = this.blurredPhotoImage;
                                if (imageReceiver2 != null && this.fitPhotoImage) {
                                    imageReceiver2.setImageCoords(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageWidth(), this.photoImage.getImageHeight());
                                    this.blurredPhotoImage.setRoundRadius(this.photoImage.getRoundRadius());
                                    this.blurredPhotoImage.draw(canvas);
                                }
                                if (!z8) {
                                    if (allowDrawPhotoImage()) {
                                        ButtonBounce buttonBounce = this.contactBounce;
                                        if (buttonBounce != null) {
                                            float scale = buttonBounce.getScale(0.0125f);
                                            if (scale != 1.0f) {
                                                canvas.save();
                                                canvas.scale(scale, scale, this.contactRect.centerX(), this.contactRect.centerY());
                                                z4 = true;
                                            } else {
                                                z4 = false;
                                            }
                                            this.imageDrawn = drawPhotoImage(canvas);
                                            if (z4) {
                                                canvas.restore();
                                            }
                                        }
                                    } else {
                                        this.imageDrawn = true;
                                    }
                                    if (this.currentMessageObject.hasMediaSpoilers()) {
                                        drawBlurredPhoto(canvas);
                                    }
                                }
                            }
                            this.photoImage.setSkipUpdateFrame(this.skipFrameUpdate);
                        }
                    }
                    if (this.isRoundVideo && this.currentMessageObject.isVoiceTranscriptionOpen() && f8 > BitmapDescriptorFactory.HUE_RED) {
                        canvas.restore();
                    }
                    if (!this.isRoundVideo) {
                        drawVideoTimestamps(canvas, getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outReplyLine : Theme.key_chat_inReplyLine));
                    }
                    boolean z9 = this.drawTime;
                    boolean visible = this.photoImage.getVisible();
                    boolean z10 = visible || (this.currentMessageObject.shouldDrawReactionsInLayout() && this.currentMessageObject.hasReactions());
                    this.drawTime = z10;
                    if (this.currentPosition != null && z9 != z10 && (viewGroup = (ViewGroup) getParent()) != null) {
                        if (this.currentPosition.last) {
                            viewGroup.invalidate();
                        } else {
                            int childCount = viewGroup.getChildCount();
                            for (int i21 = 0; i21 < childCount; i21++) {
                                View childAt = viewGroup.getChildAt(i21);
                                if (childAt != this && (childAt instanceof ChatMessageCell)) {
                                    ChatMessageCell chatMessageCell = (ChatMessageCell) childAt;
                                    if (chatMessageCell.getCurrentMessagesGroup() == this.currentMessagesGroup) {
                                        MessageObject.GroupedMessagePosition currentPosition = chatMessageCell.getCurrentPosition();
                                        if (currentPosition.last && currentPosition.maxY == this.currentPosition.maxY && (chatMessageCell.timeX - AndroidUtilities.dp(4.0f)) + chatMessageCell.getLeft() < getRight()) {
                                            chatMessageCell.groupPhotoInvisible = !visible;
                                            chatMessageCell.invalidate();
                                            viewGroup.invalidate();
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            } else {
                int i22 = this.documentAttachType;
                if (i22 == 5 || i22 == 1) {
                    CheckBoxBase checkBoxBase3 = this.mediaCheckBox;
                    boolean z11 = checkBoxBase3 != null && (this.checkBoxVisible || checkBoxBase3.getProgress() != BitmapDescriptorFactory.HUE_RED || this.checkBoxAnimationInProgress) && this.currentMessagesGroup != null;
                    this.drawMediaCheckBox = z11;
                    if (z11) {
                        this.radialProgress.setCircleCrossfadeColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outTimeText : Theme.key_chat_inTimeText, this.checkBoxAnimationProgress, 1.0f - this.mediaCheckBox.getProgress());
                    }
                    if (!this.drawMediaCheckBox || textIsSelectionMode() || (!this.mediaCheckBox.isChecked() && this.mediaCheckBox.getProgress() == BitmapDescriptorFactory.HUE_RED && !this.checkBoxAnimationInProgress)) {
                        CheckBoxBase checkBoxBase4 = this.mediaCheckBox;
                        if (checkBoxBase4 != null) {
                            checkBoxBase4.setBackgroundAlpha(1.0f);
                        }
                    } else if (this.checkBoxAnimationInProgress) {
                        this.mediaCheckBox.setBackgroundAlpha(this.checkBoxAnimationProgress);
                        if (this.radialProgress.getMiniIcon() == 4) {
                            this.radialProgress.setMiniIconScale(this.checkBoxAnimationProgress);
                        }
                    } else {
                        CheckBoxBase checkBoxBase5 = this.mediaCheckBox;
                        checkBoxBase5.setBackgroundAlpha(this.checkBoxVisible ? 1.0f : checkBoxBase5.getProgress());
                    }
                }
            }
            i = this.documentAttachType;
            if (i != 2) {
                if (this.drawPhotoImage) {
                    MessageObject messageObject9 = this.currentMessageObject;
                    if (!messageObject9.isRepostPreview && !messageObject9.isSponsored() && this.photoImage.getVisible() && !this.hasGamePreview && !this.currentMessageObject.needDrawBluredPreview()) {
                        MessageObject messageObject10 = this.currentMessageObject;
                        if (!messageObject10.preview && !this.isSmallImage && !messageObject10.isSponsored()) {
                            int alpha = ((BitmapDrawable) Theme.chat_msgMediaMenuDrawable).getPaint().getAlpha();
                            Theme.chat_msgMediaMenuDrawable.setAlpha((int) (alpha * this.controlsAlpha));
                            Drawable drawable = Theme.chat_msgMediaMenuDrawable;
                            int imageX4 = (int) ((this.photoImage.getImageX() + this.photoImage.getImageWidth()) - AndroidUtilities.dp(14.0f));
                            this.otherX = imageX4;
                            int imageY2 = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(8.1f));
                            this.otherY = imageY2;
                            BaseCell.setDrawableBounds(drawable, imageX4, imageY2);
                            Theme.chat_msgMediaMenuDrawable.draw(canvas);
                            Theme.chat_msgMediaMenuDrawable.setAlpha(alpha);
                        }
                    }
                }
                f = 1.0f;
            } else if (i == 5) {
                if (this.currentMessageObject.isOutOwner()) {
                    Theme.chat_audioTitlePaint.setColor(getThemedColor(Theme.key_chat_outAudioTitleText));
                    Theme.chat_audioPerformerPaint.setColor(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_outAudioPerformerSelectedText : Theme.key_chat_outAudioPerformerText));
                    Theme.chat_audioTimePaint.setColor(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_outAudioDurationSelectedText : Theme.key_chat_outAudioDurationText));
                    radialProgress22 = this.radialProgress;
                    i3 = (isDrawSelectionBackground() || this.buttonPressed != 0) ? Theme.key_chat_outAudioSelectedProgress : Theme.key_chat_outAudioProgress;
                } else {
                    ReplyMessageLine replyMessageLine = this.linkLine;
                    if (replyMessageLine == null || !this.hasLinkPreview) {
                        Theme.chat_audioTitlePaint.setColor(getThemedColor(Theme.key_chat_inAudioTitleText));
                        Theme.chat_audioPerformerPaint.setColor(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_inAudioPerformerSelectedText : Theme.key_chat_inAudioPerformerText));
                        Theme.chat_audioTimePaint.setColor(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_inAudioDurationSelectedText : Theme.key_chat_inAudioDurationText));
                        radialProgress22 = this.radialProgress;
                        i3 = (isDrawSelectionBackground() || this.buttonPressed != 0) ? Theme.key_chat_inAudioSelectedProgress : Theme.key_chat_inAudioProgress;
                    } else {
                        Theme.chat_audioTitlePaint.setColor(replyMessageLine.getColor());
                        Theme.chat_audioPerformerPaint.setColor(Theme.adaptHue(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_inAudioPerformerSelectedText : Theme.key_chat_inAudioPerformerText), this.linkLine.getColor()));
                        Theme.chat_audioTimePaint.setColor(Theme.adaptHue(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_inAudioDurationSelectedText : Theme.key_chat_inAudioDurationText), this.linkLine.getColor()));
                        this.radialProgress.setProgressColor(Theme.adaptHue(getThemedColor((isDrawSelectionBackground() || this.buttonPressed != 0) ? Theme.key_chat_inAudioSelectedProgress : Theme.key_chat_inAudioProgress), this.linkLine.getColor()));
                        SeekBar seekBar = this.seekBar;
                        int iAdaptHue = Theme.adaptHue(getThemedColor(Theme.key_chat_inAudioSeekbar), this.linkLine.getColor());
                        int iAdaptHue2 = Theme.adaptHue(getThemedColor(Theme.key_chat_inAudioCacheSeekbar), this.linkLine.getColor());
                        int i23 = Theme.key_chat_inAudioSeekbarFill;
                        seekBar.setColors(iAdaptHue, iAdaptHue2, Theme.adaptHue(getThemedColor(i23), this.linkLine.getColor()), Theme.adaptHue(getThemedColor(i23), this.linkLine.getColor()), Theme.adaptHue(getThemedColor(Theme.key_chat_inAudioSeekbarSelected), this.linkLine.getColor()));
                        TransitionParams transitionParams = this.transitionParams;
                        float f11 = !transitionParams.animateBackgroundBoundsInner ? transitionParams.deltaLeft : BitmapDescriptorFactory.HUE_RED;
                        this.radialProgress.setBackgroundDrawable(!isDrawSelectionBackground() ? this.currentBackgroundSelectedDrawable : this.currentBackgroundDrawable);
                        this.radialProgress.iconScale = 1.0f;
                        if (this.drawPhotoImage && (messageObject4 = this.currentMessageObject) != null && messageObject4.hasMediaSpoilers() && this.currentMessageObject.isSensitive()) {
                            if (!this.currentMessageObject.isMediaSpoilersRevealed) {
                                float f12 = this.mediaSpoilerRevealProgress;
                                if (f12 != BitmapDescriptorFactory.HUE_RED && f12 < 1.0f) {
                                    this.radialProgress.iconScale *= this.mediaSpoilerRevealProgress;
                                }
                            }
                        }
                        this.radialProgress.draw(canvas);
                        canvas.save();
                        canvas.translate(this.timeAudioX + f11 + this.songX, AndroidUtilities.dp(13.0f) + this.namesOffset + getMediaOffsetY());
                        this.songLayout.draw(canvas);
                        canvas.restore();
                        zIsPlayingMessage2 = MediaController.getInstance().isPlayingMessage(this.currentMessageObject);
                        if (!zIsPlayingMessage2) {
                            float f13 = this.toSeekBarProgress;
                            if (f13 != 1.0f) {
                                float f14 = f13 + 0.16f;
                                this.toSeekBarProgress = f14;
                                if (f14 > 1.0f) {
                                    this.toSeekBarProgress = 1.0f;
                                }
                            } else {
                                if (!zIsPlayingMessage2) {
                                    float f15 = this.toSeekBarProgress;
                                    if (f15 != BitmapDescriptorFactory.HUE_RED) {
                                        float f16 = f15 - 0.16f;
                                        this.toSeekBarProgress = f16;
                                        if (f16 < BitmapDescriptorFactory.HUE_RED) {
                                            this.toSeekBarProgress = BitmapDescriptorFactory.HUE_RED;
                                        }
                                    }
                                }
                                f2 = this.toSeekBarProgress;
                                if (f2 <= BitmapDescriptorFactory.HUE_RED) {
                                    float f17 = this.seekBarY;
                                    TransitionParams transitionParams2 = this.transitionParams;
                                    if (transitionParams2.animateBackgroundBoundsInner) {
                                        f17 += transitionParams2.deltaTop;
                                    }
                                    float f18 = f17;
                                    if (f2 != 1.0f) {
                                        float f19 = f11 + this.seekBarX;
                                        f4 = f18;
                                        f = 1.0f;
                                        canvas.saveLayerAlpha(f19, f18, this.seekBar.getWidth() + f19 + AndroidUtilities.dp(24.0f), f18 + AndroidUtilities.dp(24.0f), (int) (this.toSeekBarProgress * 255.0f), 31);
                                    } else {
                                        f4 = f18;
                                        f = 1.0f;
                                        canvas.save();
                                    }
                                    canvas.translate(this.seekBarX + f11, f4);
                                    this.seekBar.draw(canvas);
                                    canvas.restore();
                                } else {
                                    f = 1.0f;
                                }
                                if (this.toSeekBarProgress < f) {
                                    float f20 = this.timeAudioX + f11 + this.performerX;
                                    float fDp3 = AndroidUtilities.dp(35.0f) + this.namesOffset + getMediaOffsetY();
                                    if (this.toSeekBarProgress != BitmapDescriptorFactory.HUE_RED) {
                                        f3 = fDp3;
                                        canvas.saveLayerAlpha(f20, fDp3, f20 + this.performerLayout.getWidth(), fDp3 + this.performerLayout.getHeight(), (int) ((f - this.toSeekBarProgress) * 255.0f), 31);
                                    } else {
                                        f3 = fDp3;
                                        canvas.save();
                                    }
                                    float f21 = this.toSeekBarProgress;
                                    if (f21 != BitmapDescriptorFactory.HUE_RED) {
                                        float f22 = ((f - f21) * 0.3f) + 0.7f;
                                        canvas.scale(f22, f22, f20, (this.performerLayout.getHeight() / 2.0f) + f3);
                                    }
                                    canvas.translate(f20, f3);
                                    this.performerLayout.draw(canvas);
                                    canvas.restore();
                                }
                                canvas.save();
                                canvas.translate(f11 + this.timeAudioX, AndroidUtilities.dp(57.0f) + this.namesOffset + getMediaOffsetY());
                                this.durationLayout.draw(canvas);
                                canvas.restore();
                                if (shouldDrawMenuDrawable()) {
                                    Drawable themedDrawable2 = this.currentMessageObject.isOutOwner() ? getThemedDrawable(isDrawSelectionBackground() ? "drawableMsgOutMenuSelected" : "drawableMsgOutMenu") : isDrawSelectionBackground() ? Theme.chat_msgInMenuSelectedDrawable : Theme.chat_msgInMenuDrawable;
                                    int iDp3 = ((((int) fLerp2) + this.backgroundWidth) - AndroidUtilities.dp(this.currentMessageObject.type == 0 ? 58.0f : 48.0f)) - AndroidUtilities.dp(this.hasLinkPreview ? 18.0f : BitmapDescriptorFactory.HUE_RED);
                                    this.otherX = iDp3;
                                    int iDp4 = ((int) f7) - AndroidUtilities.dp(2.0f);
                                    this.otherY = iDp4;
                                    BaseCell.setDrawableBounds(themedDrawable2, iDp3, iDp4);
                                    TransitionParams transitionParams3 = this.transitionParams;
                                    if (transitionParams3.animateChangeProgress != f && transitionParams3.animateShouldDrawMenuDrawable) {
                                        themedDrawable2.setAlpha((int) (this.transitionParams.animateChangeProgress * 255.0f));
                                    }
                                    themedDrawable2.draw(canvas);
                                    TransitionParams transitionParams4 = this.transitionParams;
                                    if (transitionParams4.animateChangeProgress != f && transitionParams4.animateShouldDrawMenuDrawable) {
                                        themedDrawable2.setAlpha(255);
                                    }
                                }
                            }
                            invalidate();
                            f2 = this.toSeekBarProgress;
                            if (f2 <= BitmapDescriptorFactory.HUE_RED) {
                            }
                            if (this.toSeekBarProgress < f) {
                            }
                            canvas.save();
                            canvas.translate(f11 + this.timeAudioX, AndroidUtilities.dp(57.0f) + this.namesOffset + getMediaOffsetY());
                            this.durationLayout.draw(canvas);
                            canvas.restore();
                            if (shouldDrawMenuDrawable()) {
                            }
                        }
                    }
                }
                radialProgress22.setProgressColor(getThemedColor(i3));
                TransitionParams transitionParams5 = this.transitionParams;
                if (!transitionParams5.animateBackgroundBoundsInner) {
                }
                this.radialProgress.setBackgroundDrawable(!isDrawSelectionBackground() ? this.currentBackgroundSelectedDrawable : this.currentBackgroundDrawable);
                this.radialProgress.iconScale = 1.0f;
                if (this.drawPhotoImage) {
                    if (!this.currentMessageObject.isMediaSpoilersRevealed) {
                    }
                }
                this.radialProgress.draw(canvas);
                canvas.save();
                canvas.translate(this.timeAudioX + f11 + this.songX, AndroidUtilities.dp(13.0f) + this.namesOffset + getMediaOffsetY());
                this.songLayout.draw(canvas);
                canvas.restore();
                zIsPlayingMessage2 = MediaController.getInstance().isPlayingMessage(this.currentMessageObject);
                if (!zIsPlayingMessage2) {
                }
            } else {
                f = 1.0f;
                if (i == 3 || i == 7) {
                    if (this.currentMessageObject.isOutOwner()) {
                        Theme.chat_audioTimePaint.setColor(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_outAudioDurationSelectedText : Theme.key_chat_outAudioDurationText));
                        radialProgress2 = this.radialProgress;
                        i2 = (isDrawSelectionBackground() || this.buttonPressed != 0) ? Theme.key_chat_outAudioSelectedProgress : Theme.key_chat_outAudioProgress;
                    } else if (!this.hasLinkPreview || this.linkLine == null) {
                        Theme.chat_audioTimePaint.setColor(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_inAudioDurationSelectedText : Theme.key_chat_inAudioDurationText));
                        radialProgress2 = this.radialProgress;
                        i2 = (isDrawSelectionBackground() || this.buttonPressed != 0) ? Theme.key_chat_inAudioSelectedProgress : Theme.key_chat_inAudioProgress;
                    } else {
                        Theme.chat_audioTimePaint.setColor(Theme.adaptHue(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_inAudioDurationSelectedText : Theme.key_chat_inAudioDurationText), this.linkLine.getColor()));
                        this.radialProgress.setProgressColor(Theme.adaptHue(getThemedColor((isDrawSelectionBackground() || this.buttonPressed != 0) ? Theme.key_chat_inAudioSelectedProgress : Theme.key_chat_inAudioProgress), this.linkLine.getColor()));
                        SeekBar seekBar2 = this.seekBar;
                        int iAdaptHue3 = Theme.adaptHue(getThemedColor(Theme.key_chat_inAudioSeekbar), this.linkLine.getColor());
                        int iAdaptHue4 = Theme.adaptHue(getThemedColor(Theme.key_chat_inAudioCacheSeekbar), this.linkLine.getColor());
                        int i24 = Theme.key_chat_inAudioSeekbarFill;
                        seekBar2.setColors(iAdaptHue3, iAdaptHue4, Theme.adaptHue(getThemedColor(i24), this.linkLine.getColor()), Theme.adaptHue(getThemedColor(i24), this.linkLine.getColor()), Theme.adaptHue(getThemedColor(Theme.key_chat_inAudioSeekbarSelected), this.linkLine.getColor()));
                        currentAudiVisualizerDrawable = this.overridenAudioVisualizer;
                        if (currentAudiVisualizerDrawable == null) {
                            currentAudiVisualizerDrawable = MediaController.getInstance().isPlayingMessage(this.currentMessageObject) ? Theme.getCurrentAudiVisualizerDrawable() : Theme.getAnimatedOutAudioVisualizerDrawable(this.currentMessageObject);
                        }
                        if (currentAudiVisualizerDrawable != null && (this.documentAttachType != 7 || !this.hasLinkPreview)) {
                            currentAudiVisualizerDrawable.setParentView(this);
                            if (this.linkLine == null) {
                                currentAudiVisualizerDrawable.draw(canvas, fLerp2 + AndroidUtilities.dp(22.0f), f7 + AndroidUtilities.dp(22.0f), this.linkLine.getColor(), this.documentAttachType == 7 ? getVideoTranscriptionProgress() : 1.0f, this.resourcesProvider);
                            } else {
                                currentAudiVisualizerDrawable.draw(canvas, fLerp2 + AndroidUtilities.dp(22.0f), f7 + AndroidUtilities.dp(22.0f), this.currentMessageObject.isOutOwner(), this.documentAttachType == 7 ? getVideoTranscriptionProgress() : 1.0f, this.resourcesProvider);
                            }
                        }
                        if (!this.enterTransitionInProgress && this.documentAttachType == 3) {
                            this.radialProgress.setBackgroundDrawable(!isDrawSelectionBackground() ? this.currentBackgroundSelectedDrawable : this.currentBackgroundDrawable);
                            this.radialProgress.iconScale = 1.0f;
                            if (this.drawPhotoImage && (messageObject3 = this.currentMessageObject) != null && messageObject3.hasMediaSpoilers() && this.currentMessageObject.isSensitive()) {
                                if (!this.currentMessageObject.isMediaSpoilersRevealed) {
                                    float f23 = this.mediaSpoilerRevealProgress;
                                    if (f23 != BitmapDescriptorFactory.HUE_RED && f23 < 1.0f) {
                                        this.radialProgress.iconScale *= this.mediaSpoilerRevealProgress;
                                    }
                                }
                            }
                            SeekBarWaveform seekBarWaveform = this.seekBarWaveform;
                            drawVoiceOnce(canvas, seekBarWaveform != null ? 1.0f : 1.0f - seekBarWaveform.explosionRate, new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda2
                                @Override // java.lang.Runnable
                                public final void run() {
                                    this.f$0.lambda$drawContent$12(canvas);
                                }
                            });
                        }
                        currentBackgroundLeft = this.seekBarX;
                        currentBackgroundLeft2 = this.timeAudioX;
                        if (this.transitionParams.animateButton) {
                            int i25 = this.buttonX;
                            float f24 = this.transitionParams.animateFromButtonX;
                            float f25 = this.transitionParams.animateChangeProgress;
                            int i26 = i25 - ((int) ((f24 * (1.0f - f25)) + (this.buttonX * f25)));
                            currentBackgroundLeft -= i26;
                            currentBackgroundLeft2 -= i26;
                        }
                        TransitionParams transitionParams6 = this.transitionParams;
                        float videoTranscriptionProgress2 = !transitionParams6.animateBackgroundBoundsInner ? transitionParams6.deltaTop + BitmapDescriptorFactory.HUE_RED : BitmapDescriptorFactory.HUE_RED;
                        if (this.isRoundVideo && this.currentMessageObject.isOutOwner()) {
                            currentBackgroundLeft = getCurrentBackgroundLeft() + AndroidUtilities.dp(57.0f);
                            currentBackgroundLeft2 = getCurrentBackgroundLeft() + AndroidUtilities.dp(67.0f);
                        }
                        if (this.isRoundVideo) {
                            videoTranscriptionProgress2 += (1.0f - getVideoTranscriptionProgress()) * AndroidUtilities.roundMessageSize;
                        }
                        canvas.save();
                        if (this.documentAttachType == 7 || !this.hasLinkPreview) {
                            if (this.useSeekBarWaveform) {
                                canvas.translate(currentBackgroundLeft, this.seekBarY + videoTranscriptionProgress2);
                                this.seekBar.setAlpha(this.isRoundVideo ? CubicBezierInterpolator.EASE_IN.getInterpolation(getVideoTranscriptionProgress()) : 1.0f);
                                this.seekBar.draw(canvas);
                            } else {
                                canvas.translate((AndroidUtilities.dp(13.0f) + currentBackgroundLeft) - this.seekBarWaveformTranslateX, this.seekBarY + videoTranscriptionProgress2);
                                this.seekBarWaveform.setAlpha(this.isRoundVideo ? CubicBezierInterpolator.EASE_IN.getInterpolation(getVideoTranscriptionProgress()) : 1.0f);
                                this.seekBarWaveform.draw(canvas, this);
                            }
                        }
                        canvas.restore();
                        useTranscribeButtonProgress = getUseTranscribeButtonProgress();
                        TransitionParams transitionParams7 = this.transitionParams;
                        float f26 = !transitionParams7.animatePlayingRound ? this.isPlayingRound ? transitionParams7.animateChangeProgress : 1.0f - transitionParams7.animateChangeProgress : this.isPlayingRound ? 1.0f : BitmapDescriptorFactory.HUE_RED;
                        if (!this.wasTranscriptionOpen) {
                            useTranscribeButtonProgress = AndroidUtilities.lerp((1.0f - f26) * useTranscribeButtonProgress, useTranscribeButtonProgress, getVideoTranscriptionProgress());
                        }
                        if (useTranscribeButtonProgress > BitmapDescriptorFactory.HUE_RED && (this.documentAttachType != 7 || !this.hasLinkPreview)) {
                            canvas.save();
                            int currentBackgroundRight = ((getCurrentBackgroundRight() - getCurrentBackgroundLeft()) + AndroidUtilities.dp(!this.pinnedBottom ? 6.0f : BitmapDescriptorFactory.HUE_RED)) - AndroidUtilities.dp((!this.hasLinkPreview ? 10 : 0) + 128);
                            if (this.transcribeButton == null) {
                                TranscribeButton transcribeButton = new TranscribeButton(this, this.seekBarWaveform) { // from class: org.telegram.ui.Cells.ChatMessageCell.7
                                    @Override // org.telegram.ui.Components.TranscribeButton
                                    public void drawGradientBackground(Canvas canvas2, Rect rect3, float f27) {
                                        Paint themedPaint = ChatMessageCell.this.currentMessageObject.shouldDrawWithoutBackground() ? ChatMessageCell.this.getThemedPaint("paintChatActionBackground") : ChatMessageCell.this.getThemedPaint("paintChatTimeBackground");
                                        int alpha2 = themedPaint.getAlpha();
                                        themedPaint.setAlpha((int) (alpha2 * f27));
                                        ChatMessageCell.this.applyServiceShaderMatrix();
                                        canvas2.drawRect(rect3, themedPaint);
                                        if (themedPaint == ChatMessageCell.this.getThemedPaint("paintChatActionBackground") && ChatMessageCell.this.hasGradientService()) {
                                            int alpha3 = Theme.chat_actionBackgroundGradientDarkenPaint.getAlpha();
                                            Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha((int) (alpha3 * f27));
                                            canvas2.drawRect(rect3, Theme.chat_actionBackgroundGradientDarkenPaint);
                                            Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha(alpha3);
                                        }
                                        themedPaint.setAlpha(alpha2);
                                    }

                                    @Override // org.telegram.ui.Components.TranscribeButton
                                    protected void onOpen() {
                                        ChatMessageCell.this.wasTranscriptionOpen = true;
                                    }
                                };
                                this.transcribeButton = transcribeButton;
                                MessageObject messageObject11 = this.currentMessageObject;
                                TLRPC.Message message = messageObject11.messageOwner;
                                transcribeButton.setOpen(message != null && message.voiceTranscriptionOpen && message.voiceTranscriptionFinal && TranscribeButton.isVideoTranscriptionOpen(messageObject11), false);
                                this.transcribeButton.setLoading(TranscribeButton.isTranscribing(this.currentMessageObject), false);
                                this.transcribeButton.setLock(TranscribeButton.showTranscribeLock(this.currentMessageObject), false);
                            }
                            if (this.drawSideButton == 0) {
                                this.transcribeX = AndroidUtilities.lerp(currentBackgroundLeft + AndroidUtilities.dp(21.0f) + currentBackgroundRight, this.sideStartX, 1.0f - getVideoTranscriptionProgress());
                                fLerp = AndroidUtilities.lerp(this.seekBarY + AndroidUtilities.dp(3.0f), this.sideStartY - AndroidUtilities.dp(40.0f), 1.0f - getVideoTranscriptionProgress());
                            } else {
                                float fDp4 = currentBackgroundLeft + AndroidUtilities.dp(21.0f) + currentBackgroundRight;
                                MessageObject messageObject12 = this.currentMessageObject;
                                this.transcribeX = AndroidUtilities.lerp(fDp4, (messageObject12 == null || !messageObject12.isOutOwner()) ? (getCurrentBackgroundRight() + AndroidUtilities.dp(8.0f)) - (AndroidUtilities.dp(40.0f) * f26) : (getCurrentBackgroundLeft() - AndroidUtilities.dp(40.0f)) + (AndroidUtilities.dp(28.0f) * f26), 1.0f - getVideoTranscriptionProgress());
                                float fDp5 = (this.layoutHeight + this.transitionParams.deltaBottom) - AndroidUtilities.dp(28 - (this.drawPinnedBottom ? 2 : 0));
                                ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                                if (!reactionsLayoutInBubble.isEmpty) {
                                    fDp5 -= reactionsLayoutInBubble.getCurrentTotalHeight(this.transitionParams.animateChangeProgress);
                                }
                                fLerp = AndroidUtilities.lerp(this.seekBarY + AndroidUtilities.dp(3.0f), ((AndroidUtilities.lerp(fDp5, ((AndroidUtilities.dp(44.0f) + this.namesOffset) + getMediaOffsetY()) - AndroidUtilities.dp(1.7f), getVideoTranscriptionProgress()) + AndroidUtilities.dp(1.7f)) - AndroidUtilities.dp(12.0f)) - (this.currentMessageObject.isOutOwner() ? BitmapDescriptorFactory.HUE_RED : AndroidUtilities.dp(28.0f) * f26), 1.0f - getVideoTranscriptionProgress());
                            }
                            this.transcribeY = fLerp;
                            this.transcribeButton.setBounds((int) this.transcribeX, (int) this.transcribeY, AndroidUtilities.lerp(AndroidUtilities.dp(30.0f), AndroidUtilities.dp(32.0f), 1.0f - getVideoTranscriptionProgress()), AndroidUtilities.lerp(AndroidUtilities.dp(24.0f), AndroidUtilities.dp(32.0f), 1.0f - getVideoTranscriptionProgress()), AndroidUtilities.lerp(AndroidUtilities.dp(8.0f), AndroidUtilities.dp(16.0f), 1.0f - getVideoTranscriptionProgress()));
                            this.transcribeButton.setColor(ColorUtils.blendARGB(getThemedColor(Theme.key_chat_serviceText), getThemedColor(!this.currentMessageObject.isOutOwner() ? Theme.key_chat_outReactionButtonBackground : Theme.key_chat_inReactionButtonBackground), this.documentAttachType != 3 ? 1.0f : getVideoTranscriptionProgress()), getThemedColor(Theme.key_windowBackgroundWhiteGrayText), this.currentMessageObject.isOut(), this.documentAttachType != 3 ? BitmapDescriptorFactory.HUE_RED : 1.0f - getVideoTranscriptionProgress());
                            this.transcribeButton.draw(canvas, useTranscribeButtonProgress);
                            canvas.restore();
                        }
                        if (this.documentAttachType == 3) {
                            canvas.save();
                            canvas.translate(currentBackgroundLeft2, AndroidUtilities.dp(44.0f) + this.namesOffset + getMediaOffsetY() + videoTranscriptionProgress2);
                            this.durationLayout.draw(canvas);
                            canvas.restore();
                            MessageObject messageObject13 = this.currentMessageObject;
                            if (messageObject13.type != 0 && messageObject13.isContentUnread()) {
                                Theme.chat_docBackPaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outVoiceSeekbarFill : Theme.key_chat_inVoiceSeekbarFill));
                                canvas.drawCircle(currentBackgroundLeft2 + this.timeWidthAudio + AndroidUtilities.dp(6.0f), AndroidUtilities.dp(51.0f) + this.namesOffset + getMediaOffsetY(), AndroidUtilities.dp(3.0f), Theme.chat_docBackPaint);
                            }
                        }
                        if (this.documentAttachType == 7 && this.durationLayout != null && ((zIsPlayingMessage = MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) || this.roundProgressAlpha != BitmapDescriptorFactory.HUE_RED)) {
                            if (zIsPlayingMessage) {
                                float f27 = this.roundProgressAlpha - 0.10666667f;
                                this.roundProgressAlpha = f27;
                                if (f27 < BitmapDescriptorFactory.HUE_RED) {
                                    this.roundProgressAlpha = BitmapDescriptorFactory.HUE_RED;
                                } else {
                                    invalidate();
                                }
                            } else {
                                this.roundProgressAlpha = 1.0f;
                            }
                            drawRoundProgress(canvas);
                        }
                    }
                    radialProgress2.setProgressColor(getThemedColor(i2));
                    currentAudiVisualizerDrawable = this.overridenAudioVisualizer;
                    if (currentAudiVisualizerDrawable == null) {
                    }
                    if (currentAudiVisualizerDrawable != null) {
                        currentAudiVisualizerDrawable.setParentView(this);
                        if (this.linkLine == null) {
                        }
                    }
                    if (!this.enterTransitionInProgress) {
                        this.radialProgress.setBackgroundDrawable(!isDrawSelectionBackground() ? this.currentBackgroundSelectedDrawable : this.currentBackgroundDrawable);
                        this.radialProgress.iconScale = 1.0f;
                        if (this.drawPhotoImage) {
                            if (!this.currentMessageObject.isMediaSpoilersRevealed) {
                            }
                        }
                        SeekBarWaveform seekBarWaveform2 = this.seekBarWaveform;
                        drawVoiceOnce(canvas, seekBarWaveform2 != null ? 1.0f : 1.0f - seekBarWaveform2.explosionRate, new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda2
                            @Override // java.lang.Runnable
                            public final void run() {
                                this.f$0.lambda$drawContent$12(canvas);
                            }
                        });
                    }
                    currentBackgroundLeft = this.seekBarX;
                    currentBackgroundLeft2 = this.timeAudioX;
                    if (this.transitionParams.animateButton) {
                    }
                    TransitionParams transitionParams62 = this.transitionParams;
                    if (!transitionParams62.animateBackgroundBoundsInner) {
                    }
                    if (this.isRoundVideo) {
                        currentBackgroundLeft = getCurrentBackgroundLeft() + AndroidUtilities.dp(57.0f);
                        currentBackgroundLeft2 = getCurrentBackgroundLeft() + AndroidUtilities.dp(67.0f);
                    }
                    if (this.isRoundVideo) {
                    }
                    canvas.save();
                    if (this.documentAttachType == 7) {
                        if (this.useSeekBarWaveform) {
                        }
                        canvas.restore();
                        useTranscribeButtonProgress = getUseTranscribeButtonProgress();
                        TransitionParams transitionParams72 = this.transitionParams;
                        if (!transitionParams72.animatePlayingRound) {
                        }
                        if (!this.wasTranscriptionOpen) {
                        }
                        if (useTranscribeButtonProgress > BitmapDescriptorFactory.HUE_RED) {
                            canvas.save();
                            int currentBackgroundRight2 = ((getCurrentBackgroundRight() - getCurrentBackgroundLeft()) + AndroidUtilities.dp(!this.pinnedBottom ? 6.0f : BitmapDescriptorFactory.HUE_RED)) - AndroidUtilities.dp((!this.hasLinkPreview ? 10 : 0) + 128);
                            if (this.transcribeButton == null) {
                            }
                            if (this.drawSideButton == 0) {
                            }
                            this.transcribeY = fLerp;
                            this.transcribeButton.setBounds((int) this.transcribeX, (int) this.transcribeY, AndroidUtilities.lerp(AndroidUtilities.dp(30.0f), AndroidUtilities.dp(32.0f), 1.0f - getVideoTranscriptionProgress()), AndroidUtilities.lerp(AndroidUtilities.dp(24.0f), AndroidUtilities.dp(32.0f), 1.0f - getVideoTranscriptionProgress()), AndroidUtilities.lerp(AndroidUtilities.dp(8.0f), AndroidUtilities.dp(16.0f), 1.0f - getVideoTranscriptionProgress()));
                            this.transcribeButton.setColor(ColorUtils.blendARGB(getThemedColor(Theme.key_chat_serviceText), getThemedColor(!this.currentMessageObject.isOutOwner() ? Theme.key_chat_outReactionButtonBackground : Theme.key_chat_inReactionButtonBackground), this.documentAttachType != 3 ? 1.0f : getVideoTranscriptionProgress()), getThemedColor(Theme.key_windowBackgroundWhiteGrayText), this.currentMessageObject.isOut(), this.documentAttachType != 3 ? BitmapDescriptorFactory.HUE_RED : 1.0f - getVideoTranscriptionProgress());
                            this.transcribeButton.draw(canvas, useTranscribeButtonProgress);
                            canvas.restore();
                        }
                        if (this.documentAttachType == 3) {
                        }
                        if (this.documentAttachType == 7) {
                            if (zIsPlayingMessage) {
                            }
                            drawRoundProgress(canvas);
                        }
                    }
                }
            }
            messageObject5 = this.currentMessageObject;
            if (messageObject5 == null && !messageObject5.isOutOwner() && ((this.isForum || (this.isMonoForum && this.isAllChats)) && (((i12 = this.currentMessageObject.type) == 5 || i12 == 13 || i12 == 15) && this.isSideMenued))) {
                TransitionParams transitionParams8 = this.transitionParams;
                if (transitionParams8.animateDrawingSideMenuEnabled) {
                    boolean z12 = this.isSideMenuEnabled;
                    videoTranscriptionProgress = AndroidUtilities.lerp(!z12, z12, transitionParams8.animateChangeProgress);
                } else {
                    videoTranscriptionProgress = this.isSideMenuEnabled ? 1.0f : BitmapDescriptorFactory.HUE_RED;
                }
                if (this.currentMessageObject.type == 5) {
                    videoTranscriptionProgress *= f - getVideoTranscriptionProgress();
                }
                if (videoTranscriptionProgress > BitmapDescriptorFactory.HUE_RED) {
                    float imageX5 = this.avatarImage.getImageX();
                    float imageY3 = this.avatarImage.getImageY();
                    float imageWidth = this.avatarImage.getImageWidth();
                    float imageHeight2 = this.avatarImage.getImageHeight();
                    float alpha2 = this.avatarImage.getAlpha();
                    float fLerp4 = AndroidUtilities.lerp(0.1f, f, videoTranscriptionProgress);
                    boolean visible2 = this.avatarImage.getVisible();
                    this.avatarImage.setVisible(true, false);
                    f5 = f7;
                    this.avatarImage.setImageCoords(this.photoImage.getImageX() + AndroidUtilities.dp(7.0f), this.photoImage.getImageY() + AndroidUtilities.dp(7.0f), AndroidUtilities.dp(26.0f) * fLerp4, AndroidUtilities.dp(26.0f) * fLerp4);
                    this.avatarImage.setAlpha(videoTranscriptionProgress);
                    this.avatarImage.draw(canvas);
                    this.avatarImage.setImageCoords(imageX5, imageY3, imageWidth, imageHeight2);
                    this.avatarImage.setAlpha(alpha2);
                    this.avatarImage.setVisible(visible2, false);
                }
            } else {
                f5 = f7;
            }
            if (this.captionLayout == null || this.hasFactCheck || this.transitionParams.animateFactCheck) {
                updateCaptionLayout();
            }
            updateReactionLayoutPosition();
            if (shouldDrawCaptionLayout() || this.currentMessageObject.preview) {
                f6 = 1.0f;
            } else {
                f6 = 1.0f;
                drawCaptionLayout(canvas, false, 1.0f);
                drawCommentLayout(canvas, 1.0f);
                drawReactionsLayout(canvas, 1.0f, null);
            }
            if (this.currentMessagesGroup == null) {
                drawFactCheck(canvas, f6);
            }
            if (this.hasOldCaptionPreview) {
                i4 = 1;
                i5 = 2;
                i6 = 4;
            } else {
                MessageObject messageObject14 = this.currentMessageObject;
                int i27 = messageObject14.type;
                if (i27 == 1 || i27 == 20) {
                    i6 = 4;
                } else {
                    i6 = 4;
                    if (this.documentAttachType != 4 && i27 != 8) {
                        imageX2 = this.backgroundDrawableLeft + AndroidUtilities.dp(messageObject14.isOutOwner() ? 11.0f : 17.0f);
                    }
                    float fDp6 = ((this.totalHeight - AndroidUtilities.dp(!this.drawPinnedTop ? 9.0f : 10.0f)) - this.linkPreviewHeight) - AndroidUtilities.dp(11.0f);
                    Theme.chat_replyLinePaint.setColor(getThemedColor(!this.currentMessageObject.isOutOwner() ? Theme.key_chat_outPreviewLine : Theme.key_chat_inPreviewLine));
                    RectF rectF = AndroidUtilities.rectTmp;
                    float f28 = imageX2;
                    rectF.set(f28, fDp6 - AndroidUtilities.dp(3.0f), AndroidUtilities.dp(6.0f) + imageX2, this.linkPreviewHeight + fDp6);
                    path = this.replyRoundRectPath;
                    if (path != null) {
                        this.replyRoundRectPath = new Path();
                    } else {
                        path.rewind();
                    }
                    canvas.save();
                    float f29 = rectF.left;
                    canvas.clipRect(f29, rectF.top, AndroidUtilities.dp(3.0f) + f29, rectF.bottom);
                    this.replyRoundRectPath.addRoundRect(rectF, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), Path.Direction.CW);
                    canvas.drawPath(this.replyRoundRectPath, Theme.chat_replyLinePaint);
                    canvas.restore();
                    if (this.siteNameLayout == null) {
                        Theme.chat_replyNamePaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outSiteNameText : Theme.key_chat_inSiteNameText));
                        canvas.save();
                        canvas.translate(f28 + (-this.siteNameLeft) + (this.hasInvoicePreview ? 0 : AndroidUtilities.dp(10.0f)), fDp6 - AndroidUtilities.dp(3.0f));
                        SpoilerEffect.layoutDrawMaybe(this.siteNameLayout, canvas);
                        canvas.restore();
                        StaticLayout staticLayout2 = this.siteNameLayout;
                        fDp2 = staticLayout2.getLineBottom(staticLayout2.getLineCount() - 1) + fDp6;
                    } else {
                        fDp2 = fDp6;
                    }
                    if (this.currentMessageObject.isOutOwner()) {
                        textPaint = Theme.chat_replyTextPaint;
                        i11 = Theme.key_chat_messageTextIn;
                    } else {
                        textPaint = Theme.chat_replyTextPaint;
                        i11 = Theme.key_chat_messageTextOut;
                    }
                    textPaint.setColor(getThemedColor(i11));
                    if (this.descriptionLayout == null) {
                        if (fDp2 != fDp6) {
                            fDp2 += AndroidUtilities.dp(2.0f);
                        }
                        this.descriptionY = ((int) fDp2) - AndroidUtilities.dp(3.0f);
                        canvas.save();
                        canvas.translate(imageX2 + AndroidUtilities.dp(10.0f) + this.descriptionX, this.descriptionY);
                        SpoilerEffect.layoutDrawMaybe(this.descriptionLayout, canvas);
                        StaticLayout staticLayout3 = this.descriptionLayout;
                        i5 = 2;
                        AnimatedEmojiSpan.drawAnimatedEmojis(canvas, staticLayout3, this.animatedEmojiDescriptionStack, BitmapDescriptorFactory.HUE_RED, null, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 1.0f, getAdaptiveEmojiColorFilter(1, staticLayout3.getPaint().getColor()));
                        canvas.restore();
                    } else {
                        i5 = 2;
                    }
                    i4 = 1;
                    this.drawTime = true;
                }
                imageX2 = (int) (this.photoImage.getImageX() + AndroidUtilities.dp(5.0f));
                float fDp62 = ((this.totalHeight - AndroidUtilities.dp(!this.drawPinnedTop ? 9.0f : 10.0f)) - this.linkPreviewHeight) - AndroidUtilities.dp(11.0f);
                Theme.chat_replyLinePaint.setColor(getThemedColor(!this.currentMessageObject.isOutOwner() ? Theme.key_chat_outPreviewLine : Theme.key_chat_inPreviewLine));
                RectF rectF2 = AndroidUtilities.rectTmp;
                float f282 = imageX2;
                rectF2.set(f282, fDp62 - AndroidUtilities.dp(3.0f), AndroidUtilities.dp(6.0f) + imageX2, this.linkPreviewHeight + fDp62);
                path = this.replyRoundRectPath;
                if (path != null) {
                }
                canvas.save();
                float f292 = rectF2.left;
                canvas.clipRect(f292, rectF2.top, AndroidUtilities.dp(3.0f) + f292, rectF2.bottom);
                this.replyRoundRectPath.addRoundRect(rectF2, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), Path.Direction.CW);
                canvas.drawPath(this.replyRoundRectPath, Theme.chat_replyLinePaint);
                canvas.restore();
                if (this.siteNameLayout == null) {
                }
                if (this.currentMessageObject.isOutOwner()) {
                }
                textPaint.setColor(getThemedColor(i11));
                if (this.descriptionLayout == null) {
                }
                i4 = 1;
                this.drawTime = true;
            }
            if (this.documentAttachType == i4) {
                if (this.currentMessageObject.isOutOwner()) {
                    Theme.chat_docNamePaint.setColor(getThemedColor(Theme.key_chat_outFileNameText));
                    Theme.chat_infoPaint.setColor(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_outFileInfoSelectedText : Theme.key_chat_outFileInfoText));
                    Theme.chat_docBackPaint.setColor(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_outFileBackgroundSelected : Theme.key_chat_outFileBackground));
                    themedDrawable = getThemedDrawable(isDrawSelectionBackground() ? "drawableMsgOutMenuSelected" : "drawableMsgOutMenu");
                } else if (this.linkLine == null || !this.hasLinkPreview) {
                    Theme.chat_docNamePaint.setColor(getThemedColor(Theme.key_chat_inFileNameText));
                    Theme.chat_infoPaint.setColor(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_inFileInfoSelectedText : Theme.key_chat_inFileInfoText));
                    Theme.chat_docBackPaint.setColor(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_inFileBackgroundSelected : Theme.key_chat_inFileBackground));
                    themedDrawable = isDrawSelectionBackground() ? Theme.chat_msgInMenuSelectedDrawable : Theme.chat_msgInMenuDrawable;
                } else {
                    Theme.chat_docNamePaint.setColor(Theme.adaptHue(getThemedColor(Theme.key_chat_inFileNameText), this.linkLine.getColor()));
                    Theme.chat_infoPaint.setColor(Theme.adaptHue(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_inFileInfoSelectedText : Theme.key_chat_inFileInfoText), this.linkLine.getColor()));
                    Theme.chat_docBackPaint.setColor(Theme.adaptHue(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_inFileBackgroundSelected : Theme.key_chat_inFileBackground), this.linkLine.getColor()));
                    if (isDrawSelectionBackground()) {
                    }
                }
                if (this.drawPhotoImage) {
                    if (this.currentMessageObject.type == 0) {
                        imageX = this.photoImage.getImageX() + this.backgroundWidth;
                        i8 = (this.hasLinkPreview ? 12 : 0) + 56;
                    } else {
                        imageX = this.photoImage.getImageX() + this.backgroundWidth;
                        i8 = (this.hasLinkPreview ? 12 : 0) + 40;
                    }
                    int iDp5 = (int) (imageX - AndroidUtilities.dp(i8));
                    this.otherX = iDp5;
                    int imageY4 = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(4.0f));
                    this.otherY = imageY4;
                    BaseCell.setDrawableBounds(themedDrawable, iDp5, imageY4);
                    fDp = (int) (this.photoImage.getImageX() + this.photoImage.getImageWidth() + AndroidUtilities.dp(10.0f));
                    iDp = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(8.0f));
                    iDp2 = (int) (this.photoImage.getImageY() + (this.docTitleLayout != null ? r4.getLineBottom(r4.getLineCount() - 1) + AndroidUtilities.dp(13.0f) : AndroidUtilities.dp(8.0f)));
                    if (this.imageDrawn) {
                        RadialProgress2 radialProgress26 = this.radialProgress;
                        int i28 = Theme.key_chat_mediaLoaderPhoto;
                        int i29 = Theme.key_chat_mediaLoaderPhotoSelected;
                        int i30 = Theme.key_chat_mediaLoaderPhotoIcon;
                        int i31 = Theme.key_chat_mediaLoaderPhotoIconSelected;
                        radialProgress26.setColorKeys(i28, i29, i30, i31);
                        RadialProgress2 radialProgress27 = this.radialProgress;
                        int i32 = Theme.key_chat_mediaProgress;
                        radialProgress27.setProgressColor(getThemedColor(i32));
                        this.videoRadialProgress.setColorKeys(i28, i29, i30, i31);
                        this.videoRadialProgress.setProgressColor(getThemedColor(i32));
                        if (this.buttonState == -1 && this.radialProgress.getIcon() != i6) {
                            this.radialProgress.setIcon(i6, true, true);
                        }
                    } else {
                        if (this.currentMessageObject.isOutOwner()) {
                            RadialProgress2 radialProgress28 = this.radialProgress;
                            int i33 = Theme.key_chat_outLoader;
                            int i34 = Theme.key_chat_outLoaderSelected;
                            int i35 = Theme.key_chat_outMediaIcon;
                            int i36 = Theme.key_chat_outMediaIconSelected;
                            radialProgress28.setColorKeys(i33, i34, i35, i36);
                            this.radialProgress.setProgressColor(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_outFileProgressSelected : Theme.key_chat_outFileProgress));
                            this.videoRadialProgress.setColorKeys(i33, i34, i35, i36);
                            radialProgress24 = this.videoRadialProgress;
                            i9 = isDrawSelectionBackground() ? Theme.key_chat_outFileProgressSelected : Theme.key_chat_outFileProgress;
                        } else {
                            ReplyMessageLine replyMessageLine2 = this.linkLine;
                            if (replyMessageLine2 == null || !this.hasLinkPreview) {
                                RadialProgress2 radialProgress29 = this.radialProgress;
                                int i37 = Theme.key_chat_inLoader;
                                int i38 = Theme.key_chat_inLoaderSelected;
                                int i39 = Theme.key_chat_inMediaIcon;
                                int i40 = Theme.key_chat_inMediaIconSelected;
                                radialProgress29.setColorKeys(i37, i38, i39, i40);
                                this.radialProgress.setProgressColor(getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_inFileProgressSelected : Theme.key_chat_inFileProgress));
                                this.videoRadialProgress.setColorKeys(i37, i38, i39, i40);
                                radialProgress24 = this.videoRadialProgress;
                                i9 = isDrawSelectionBackground() ? Theme.key_chat_inFileProgressSelected : Theme.key_chat_inFileProgress;
                            } else {
                                this.radialProgress.setColors(replyMessageLine2.getColor(), this.linkLine.getColor(), Theme.blendOver(-1, Theme.multAlpha(this.linkLine.getColor(), 0.01f)), Theme.blendOver(-1, Theme.multAlpha(this.linkLine.getColor(), 0.05f)));
                                this.radialProgress.setProgressColor(Theme.blendOver(-1, Theme.multAlpha(this.linkLine.getColor(), 0.01f)));
                                this.videoRadialProgress.setColors(this.linkLine.getColor(), this.linkLine.getColor(), Theme.blendOver(-1, Theme.multAlpha(this.linkLine.getColor(), 0.01f)), Theme.blendOver(-1, Theme.multAlpha(this.linkLine.getColor(), 0.05f)));
                                radialProgress24 = this.videoRadialProgress;
                                iBlendOver = Theme.blendOver(-1, Theme.multAlpha(this.linkLine.getColor(), 0.01f));
                                radialProgress24.setProgressColor(iBlendOver);
                                this.rect.set(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX() + this.photoImage.getImageWidth(), this.photoImage.getImageY() + this.photoImage.getImageHeight());
                                roundRadius = this.photoImage.getRoundRadius();
                                this.rectPath.reset();
                                for (i10 = 0; i10 < roundRadius.length; i10++) {
                                    float[] fArr2 = radii;
                                    int i41 = i10 * 2;
                                    float f30 = roundRadius[i10];
                                    fArr2[i41] = f30;
                                    fArr2[i41 + 1] = f30;
                                }
                                this.rectPath.addRoundRect(this.rect, radii, Path.Direction.CW);
                                this.rectPath.close();
                                canvas.drawPath(this.rectPath, Theme.chat_docBackPaint);
                            }
                        }
                        iBlendOver = getThemedColor(i9);
                        radialProgress24.setProgressColor(iBlendOver);
                        this.rect.set(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX() + this.photoImage.getImageWidth(), this.photoImage.getImageY() + this.photoImage.getImageHeight());
                        roundRadius = this.photoImage.getRoundRadius();
                        this.rectPath.reset();
                        while (i10 < roundRadius.length) {
                        }
                        this.rectPath.addRoundRect(this.rect, radii, Path.Direction.CW);
                        this.rectPath.close();
                        canvas.drawPath(this.rectPath, Theme.chat_docBackPaint);
                    }
                } else {
                    int iDp6 = ((((int) fLerp2) + this.backgroundWidth) - AndroidUtilities.dp(this.currentMessageObject.type == 0 ? 58.0f : 48.0f)) - AndroidUtilities.dp(this.hasLinkPreview ? 24.0f : BitmapDescriptorFactory.HUE_RED);
                    this.otherX = iDp6;
                    int i42 = (int) f5;
                    int iDp7 = i42 - AndroidUtilities.dp(2.0f);
                    this.otherY = iDp7;
                    BaseCell.setDrawableBounds(themedDrawable, iDp6, iDp7);
                    fDp = fLerp2 + AndroidUtilities.dp(53.0f);
                    iDp = AndroidUtilities.dp(4.0f) + i42;
                    iDp2 = i42 + AndroidUtilities.dp(27.0f);
                    StaticLayout staticLayout4 = this.docTitleLayout;
                    if (staticLayout4 != null && staticLayout4.getLineCount() > 1) {
                        iDp2 += ((this.docTitleLayout.getLineCount() - 1) * AndroidUtilities.dp(16.0f)) + AndroidUtilities.dp(2.0f);
                    }
                    if (this.currentMessageObject.isOutOwner()) {
                        this.radialProgress.setProgressColor(getThemedColor((isDrawSelectionBackground() || this.buttonPressed != 0) ? Theme.key_chat_outAudioSelectedProgress : Theme.key_chat_outAudioProgress));
                        radialProgress23 = this.videoRadialProgress;
                        i7 = (isDrawSelectionBackground() || this.videoButtonPressed != 0) ? Theme.key_chat_outAudioSelectedProgress : Theme.key_chat_outAudioProgress;
                    } else {
                        this.radialProgress.setProgressColor(getThemedColor((isDrawSelectionBackground() || this.buttonPressed != 0) ? Theme.key_chat_inAudioSelectedProgress : Theme.key_chat_inAudioProgress));
                        radialProgress23 = this.videoRadialProgress;
                        i7 = (isDrawSelectionBackground() || this.videoButtonPressed != 0) ? Theme.key_chat_inAudioSelectedProgress : Theme.key_chat_inAudioProgress;
                    }
                    radialProgress23.setProgressColor(getThemedColor(i7));
                }
                int i43 = iDp;
                float f31 = fDp;
                if (shouldDrawMenuDrawable()) {
                    TransitionParams transitionParams9 = this.transitionParams;
                    if (transitionParams9.animateChangeProgress != 1.0f && transitionParams9.animateShouldDrawMenuDrawable) {
                        themedDrawable.setAlpha((int) (this.transitionParams.animateChangeProgress * 255.0f));
                    }
                    themedDrawable.draw(canvas);
                    TransitionParams transitionParams10 = this.transitionParams;
                    if (transitionParams10.animateChangeProgress != 1.0f && transitionParams10.animateShouldDrawMenuDrawable) {
                        themedDrawable.setAlpha(255);
                    }
                }
                try {
                    if (this.docTitleLayout != null) {
                        canvas.save();
                        canvas.translate(this.docTitleOffsetX + f31, i43);
                        this.docTitleLayout.draw(canvas);
                        canvas.restore();
                    }
                } catch (Exception e) {
                    FileLog.e(e);
                }
                try {
                    if (this.infoLayout != null) {
                        canvas.save();
                        canvas.translate(f31, iDp2);
                        if (this.buttonState != 1 || (staticLayout = this.loadingProgressLayout) == null) {
                            staticLayout = this.infoLayout;
                        }
                        staticLayout.draw(canvas);
                        canvas.restore();
                    }
                } catch (Exception e2) {
                    FileLog.e(e2);
                }
            }
            messageObject6 = this.currentMessageObject;
            if (messageObject6.type == i6 && !(MessageObject.getMedia(messageObject6.messageOwner) instanceof TLRPC.TL_messageMediaGeoLive) && this.currentMapProvider == i5 && this.photoImage.hasNotThumb()) {
                Drawable redLocationIcon = this.sharedResources.getRedLocationIcon();
                int intrinsicWidth = (int) (redLocationIcon.getIntrinsicWidth() * 0.8f);
                int intrinsicHeight = (int) (redLocationIcon.getIntrinsicHeight() * 0.8f);
                int imageX6 = (int) (this.photoImage.getImageX() + ((this.photoImage.getImageWidth() - intrinsicWidth) / 2.0f));
                int imageY5 = (int) ((this.photoImage.getImageY() + ((this.photoImage.getImageHeight() / 2.0f) - intrinsicHeight)) - (AndroidUtilities.dp(16.0f) * (1.0f - CubicBezierInterpolator.EASE_OUT_BACK.getInterpolation(this.photoImage.getCurrentAlpha()))));
                redLocationIcon.setAlpha((int) (Math.min(1.0f, this.photoImage.getCurrentAlpha() * 5.0f) * 255.0f));
                redLocationIcon.setBounds(imageX6, imageY5, intrinsicWidth + imageX6, intrinsicHeight + imageY5);
                redLocationIcon.draw(canvas);
                if (this.photoImage.getCurrentAlpha() < 1.0f) {
                    invalidate();
                }
            }
            this.transitionParams.recordDrawingState();
        }
        this.drawTime = groupMedia2.allVisible();
        this.groupMedia.draw(canvas);
        i = this.documentAttachType;
        if (i != 2) {
        }
        messageObject5 = this.currentMessageObject;
        if (messageObject5 == null) {
            f5 = f7;
        }
        if (this.captionLayout == null) {
            updateCaptionLayout();
        }
        updateReactionLayoutPosition();
        if (shouldDrawCaptionLayout()) {
            f6 = 1.0f;
        }
        if (this.currentMessagesGroup == null) {
        }
        if (this.hasOldCaptionPreview) {
        }
        if (this.documentAttachType == i4) {
        }
        messageObject6 = this.currentMessageObject;
        if (messageObject6.type == i6) {
            Drawable redLocationIcon2 = this.sharedResources.getRedLocationIcon();
            int intrinsicWidth2 = (int) (redLocationIcon2.getIntrinsicWidth() * 0.8f);
            int intrinsicHeight2 = (int) (redLocationIcon2.getIntrinsicHeight() * 0.8f);
            int imageX62 = (int) (this.photoImage.getImageX() + ((this.photoImage.getImageWidth() - intrinsicWidth2) / 2.0f));
            int imageY52 = (int) ((this.photoImage.getImageY() + ((this.photoImage.getImageHeight() / 2.0f) - intrinsicHeight2)) - (AndroidUtilities.dp(16.0f) * (1.0f - CubicBezierInterpolator.EASE_OUT_BACK.getInterpolation(this.photoImage.getCurrentAlpha()))));
            redLocationIcon2.setAlpha((int) (Math.min(1.0f, this.photoImage.getCurrentAlpha() * 5.0f) * 255.0f));
            redLocationIcon2.setBounds(imageX62, imageY52, intrinsicWidth2 + imageX62, intrinsicHeight2 + imageY52);
            redLocationIcon2.draw(canvas);
            if (this.photoImage.getCurrentAlpha() < 1.0f) {
            }
        }
        this.transitionParams.recordDrawingState();
    }

    public void drawFactCheck(Canvas canvas, float f) {
        int i;
        int iDp;
        int extraTextX;
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if (groupedMessagePosition == null || groupedMessagePosition.last) {
            float fLerp = this.hasFactCheck ? 1.0f : BitmapDescriptorFactory.HUE_RED;
            TransitionParams transitionParams = this.transitionParams;
            if (transitionParams.animateFactCheck) {
                fLerp = AndroidUtilities.lerp(1.0f - fLerp, fLerp, transitionParams.animateChangeProgress);
            }
            float f2 = f * fLerp;
            if (f2 <= BitmapDescriptorFactory.HUE_RED) {
                return;
            }
            float backgroundDrawableRight = getBackgroundDrawableRight();
            TransitionParams transitionParams2 = this.transitionParams;
            float fDp = ((backgroundDrawableRight + (transitionParams2 != null ? transitionParams2.deltaRight : BitmapDescriptorFactory.HUE_RED)) - AndroidUtilities.dp(10 + ((!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 0 : 6))) - getExtraTextX();
            MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
            if (groupedMessages != null && !groupedMessages.isDocuments) {
                extraTextX = (int) this.captionX;
            } else if (this.currentMessageObject.isOutOwner()) {
                extraTextX = this.backgroundDrawableLeft + AndroidUtilities.dp(12.0f) + getExtraTextX();
                if (this.currentMessageObject.type == 19) {
                    extraTextX -= Math.max(0, ((Math.max(this.replyNameWidth, this.replyTextWidth) + extraTextX) + AndroidUtilities.dp(14.0f)) - AndroidUtilities.displaySize.x);
                }
            } else {
                if (this.mediaBackground) {
                    i = this.backgroundDrawableLeft;
                    iDp = AndroidUtilities.dp(12.0f);
                } else {
                    i = this.backgroundDrawableLeft;
                    iDp = AndroidUtilities.dp(this.drawPinnedBottom ? 12.0f : 18.0f);
                }
                extraTextX = i + iDp + getExtraTextX();
            }
            int iDp2 = ((int) (extraTextX + this.transitionParams.deltaLeft)) - AndroidUtilities.dp(1.33f);
            int i2 = this.factCheckY;
            float f3 = iDp2;
            int i3 = (int) (fDp - f3);
            int iLerp = this.factCheckHeight;
            TransitionParams transitionParams3 = this.transitionParams;
            if (transitionParams3.animateFactCheckHeight) {
                iLerp = AndroidUtilities.lerp(transitionParams3.animateFactCheckHeightFrom, iLerp, transitionParams3.animateChangeProgress);
            }
            float f4 = (!this.factCheckLarge || (getPrimaryMessageObject() != null && getPrimaryMessageObject().factCheckExpanded)) ? 1.0f : BitmapDescriptorFactory.HUE_RED;
            TransitionParams transitionParams4 = this.transitionParams;
            if (transitionParams4.animateFactCheckExpanded) {
                AndroidUtilities.lerp(1.0f - f4, f4, transitionParams4.animateChangeProgress);
            }
            if (this.factCheckLine == null) {
                this.factCheckLine = new ReplyMessageLine(this);
            }
            int factCheck = this.factCheckLine.setFactCheck(this.resourcesProvider);
            canvas.save();
            canvas.translate(f3, i2);
            RectF rectF = AndroidUtilities.rectTmp;
            rectF.set(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, i3, iLerp);
            ButtonBounce buttonBounce = this.factCheckBounce;
            float scale = buttonBounce != null ? buttonBounce.getScale(0.01f) : 1.0f;
            canvas.scale(scale, scale, rectF.centerX(), rectF.centerY());
            this.factCheckLine.drawBackground(canvas, rectF, 5.0f, 5.0f, 5.0f, f2, false, false);
            this.factCheckLine.drawLine(canvas, rectF, f2);
            Text text = this.factCheckTitle;
            if (text != null) {
                text.draw(canvas, AndroidUtilities.dp(10.0f), AndroidUtilities.dp(12.0f), factCheck, f2);
                if (this.factCheckWhat != null) {
                    rectF.set((int) (AndroidUtilities.dp(10.0f) + this.factCheckTitle.getCurrentWidth() + AndroidUtilities.dp(4.0f)), AndroidUtilities.dp(4.33f), AndroidUtilities.dp(10.0f) + r1 + this.factCheckWhat.getCurrentWidth(), AndroidUtilities.dp(21.66f));
                    ButtonBounce buttonBounce2 = this.factCheckWhatBounce;
                    float scale2 = buttonBounce2 != null ? buttonBounce2.getScale(0.1f) : 1.0f;
                    canvas.save();
                    canvas.scale(scale2, scale2, rectF.centerX(), rectF.centerY());
                    canvas.drawRoundRect(rectF, AndroidUtilities.dp(17.0f), AndroidUtilities.dp(17.0f), this.factCheckLine.backgroundPaint);
                    this.factCheckWhat.draw(canvas, r1 + AndroidUtilities.dp(5.0f), AndroidUtilities.dp(12.0f), factCheck, f2);
                    canvas.restore();
                }
            }
            canvas.restore();
        }
    }

    public void drawFactCheckText(Canvas canvas, float f) {
        int i;
        int iDp;
        float f2;
        int i2;
        float f3;
        float f4;
        RectF rectF;
        TextPaint textPaint;
        int i3;
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if (groupedMessagePosition == null || groupedMessagePosition.last) {
            float fLerp = this.hasFactCheck ? 1.0f : BitmapDescriptorFactory.HUE_RED;
            TransitionParams transitionParams = this.transitionParams;
            if (transitionParams.animateFactCheck) {
                fLerp = AndroidUtilities.lerp(1.0f - fLerp, fLerp, transitionParams.animateChangeProgress);
            }
            float f5 = f * fLerp;
            if (f5 <= BitmapDescriptorFactory.HUE_RED) {
                return;
            }
            float backgroundDrawableRight = getBackgroundDrawableRight();
            TransitionParams transitionParams2 = this.transitionParams;
            float fDp = ((backgroundDrawableRight + (transitionParams2 != null ? transitionParams2.deltaRight : BitmapDescriptorFactory.HUE_RED)) - AndroidUtilities.dp(10 + ((!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 0 : 6))) - getExtraTextX();
            MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
            if (groupedMessages == null || groupedMessages.isDocuments) {
                float f6 = 12.0f;
                if (this.currentMessageObject.isOutOwner()) {
                    iDp = this.backgroundDrawableLeft + AndroidUtilities.dp(12.0f) + getExtraTextX();
                    if (this.currentMessageObject.type == 19) {
                        iDp -= Math.max(0, ((Math.max(this.replyNameWidth, this.replyTextWidth) + iDp) + AndroidUtilities.dp(14.0f)) - AndroidUtilities.displaySize.x);
                    }
                } else {
                    if (this.mediaBackground) {
                        i = this.backgroundDrawableLeft;
                    } else {
                        i = this.backgroundDrawableLeft;
                        if (!this.drawPinnedBottom) {
                            f6 = 18.0f;
                        }
                    }
                    iDp = i + AndroidUtilities.dp(f6) + getExtraTextX();
                }
            } else {
                iDp = (int) this.captionX;
            }
            int iDp2 = ((int) (iDp + this.transitionParams.deltaLeft)) - AndroidUtilities.dp(1.33f);
            int i4 = this.factCheckY;
            float f7 = iDp2;
            int i5 = (int) (fDp - f7);
            int iLerp = this.factCheckHeight;
            TransitionParams transitionParams3 = this.transitionParams;
            if (transitionParams3.animateFactCheckHeight) {
                iLerp = AndroidUtilities.lerp(transitionParams3.animateFactCheckHeightFrom, iLerp, transitionParams3.animateChangeProgress);
            }
            int i6 = iLerp;
            float fLerp2 = (!this.factCheckLarge || (getPrimaryMessageObject() != null && getPrimaryMessageObject().factCheckExpanded)) ? 1.0f : BitmapDescriptorFactory.HUE_RED;
            TransitionParams transitionParams4 = this.transitionParams;
            if (transitionParams4.animateFactCheckExpanded) {
                fLerp2 = AndroidUtilities.lerp(1.0f - fLerp2, fLerp2, transitionParams4.animateChangeProgress);
            }
            float f8 = fLerp2;
            if (this.factCheckLine == null) {
                this.factCheckLine = new ReplyMessageLine(this);
            }
            int factCheck = this.factCheckLine.setFactCheck(this.resourcesProvider);
            canvas.save();
            canvas.translate(f7, i4);
            RectF rectF2 = AndroidUtilities.rectTmp;
            float f9 = i5;
            float f10 = i6;
            rectF2.set(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, f9, f10);
            ButtonBounce buttonBounce = this.factCheckBounce;
            float scale = buttonBounce != null ? buttonBounce.getScale(0.01f) : 1.0f;
            canvas.scale(scale, scale, rectF2.centerX(), rectF2.centerY());
            if (this.factCheckTextLayout != null) {
                if (this.factCheckLarge) {
                    f3 = f10;
                    f4 = f9;
                    rectF = rectF2;
                    f2 = f8;
                    i2 = factCheck;
                    canvas.saveLayerAlpha(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, f9, i6 - 1, 255, 31);
                } else {
                    f3 = f10;
                    f4 = f9;
                    rectF = rectF2;
                    f2 = f8;
                    i2 = factCheck;
                }
                canvas.save();
                canvas.translate(AndroidUtilities.dp(10.0f) - this.factCheckTextLayoutLeft, AndroidUtilities.dp(22.0f));
                Theme.chat_replyTextPaint.linkColor = i2;
                LinkSpanDrawable.LinkCollector linkCollector = this.factCheckLinks;
                if (linkCollector != null && linkCollector.draw(canvas)) {
                    invalidateOutbounds();
                }
                if (this.currentMessageObject.isOutOwner()) {
                    textPaint = Theme.chat_replyTextPaint;
                    i3 = Theme.key_chat_messageTextOut;
                } else {
                    textPaint = Theme.chat_replyTextPaint;
                    i3 = Theme.key_chat_messageTextIn;
                }
                textPaint.setColor(getThemedColor(i3));
                int alpha = Theme.chat_replyTextPaint.getAlpha();
                Theme.chat_replyTextPaint.setAlpha((int) (alpha * f5));
                ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
                if (chatMessageCellDelegate != null && chatMessageCellDelegate.getTextSelectionHelper() != null && getDelegate().getTextSelectionHelper().isSelected(this.currentMessageObject)) {
                    this.delegate.getTextSelectionHelper().drawFactCheck(this.currentMessageObject.isOutOwner(), this.factCheckTextLayout, canvas);
                }
                this.factCheckTextLayout.draw(canvas);
                canvas.restore();
                Theme.chat_replyTextPaint.setAlpha(alpha);
                rectF.set(AndroidUtilities.dp(10.0f), AndroidUtilities.dp(22.0f) + this.factCheckTextLayoutHeight + AndroidUtilities.dp(6.33f), i5 - AndroidUtilities.dp(10.0f), AndroidUtilities.dp(22.0f) + this.factCheckTextLayoutHeight + AndroidUtilities.dp(6.33f) + 1);
                Theme.chat_titleLabelTextPaint.setColor(i2);
                Theme.chat_titleLabelTextPaint.setAlpha((int) (r2.getAlpha() * 0.5f * f5));
                canvas.drawRect(rectF, Theme.chat_titleLabelTextPaint);
                canvas.save();
                canvas.translate(AndroidUtilities.dp(10.0f) - this.factCheckText2LayoutLeft, AndroidUtilities.dp(22.0f) + this.factCheckTextLayoutHeight + AndroidUtilities.dp(12.66f));
                Theme.chat_titleLabelTextPaint.setColor(i2);
                Theme.chat_titleLabelTextPaint.setAlpha((int) (r1.getAlpha() * f5));
                this.factCheckText2Layout.draw(canvas);
                canvas.restore();
                if (this.clip == null) {
                    this.clip = new GradientClip();
                }
                if (this.factCheckLarge) {
                    canvas.save();
                    int iDp3 = AndroidUtilities.dp((AndroidUtilities.dp(22.0f) + this.factCheckTextLayoutHeight) + AndroidUtilities.dp(12.66f) < i6 ? 20.0f : 24.0f);
                    rectF.set(BitmapDescriptorFactory.HUE_RED, (i6 - AndroidUtilities.dp(6.66f)) - iDp3, f4, f3);
                    float f11 = (1.0f - f2) * f5;
                    this.clip.draw(canvas, rectF, 3, f11);
                    float f12 = i6 - iDp3;
                    rectF.set(i5 - AndroidUtilities.dp(60.0f), f12, i5 - AndroidUtilities.dp(32.0f), f3);
                    this.clip.draw(canvas, rectF, 2, f11);
                    rectF.set(i5 - AndroidUtilities.dp(32.0f), f12, f4, f3);
                    canvas.drawRect(rectF, this.clip.getPaint(2, f11));
                    canvas.restore();
                    canvas.restore();
                }
            } else {
                f2 = f8;
                i2 = factCheck;
            }
            if (this.factCheckLarge) {
                if (this.factCheckArrow == null) {
                    Drawable drawableMutate = getContext().getResources().getDrawable(R.drawable.arrow_more).mutate();
                    this.factCheckArrow = drawableMutate;
                    this.factCheckArrowColor = i2;
                    drawableMutate.setColorFilter(new PorterDuffColorFilter(i2, PorterDuff.Mode.SRC_IN));
                }
                if (i2 != this.factCheckArrowColor) {
                    Drawable drawable = this.factCheckArrow;
                    this.factCheckArrowColor = i2;
                    drawable.setColorFilter(new PorterDuffColorFilter(i2, PorterDuff.Mode.SRC_IN));
                }
                canvas.save();
                int iDp4 = AndroidUtilities.dp(16.0f);
                this.factCheckArrow.setBounds((i5 - iDp4) - AndroidUtilities.dp(7.0f), (i6 - iDp4) - AndroidUtilities.dp(5.0f), i5 - AndroidUtilities.dp(7.0f), i6 - AndroidUtilities.dp(5.0f));
                canvas.rotate(AndroidUtilities.lerp(0, 180, f2), this.factCheckArrow.getBounds().centerX(), this.factCheckArrow.getBounds().centerY());
                this.factCheckArrow.setAlpha((int) (f5 * 255.0f));
                this.factCheckArrow.draw(canvas);
                canvas.restore();
            }
            canvas.restore();
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:110:0x0248  */
    /* JADX WARN: Removed duplicated region for block: B:112:0x0266  */
    /* JADX WARN: Removed duplicated region for block: B:113:0x026e  */
    /* JADX WARN: Removed duplicated region for block: B:130:0x02ce  */
    /* JADX WARN: Removed duplicated region for block: B:141:0x0314  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawInternal(Canvas canvas) {
        boolean z;
        MessageObject messageObject;
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        int i;
        int iDp;
        int extraTextX;
        int i2;
        int iDp2;
        int i3;
        int iDp3;
        int iRoundPlayingMessageSize;
        Theme.MessageDrawable messageDrawable;
        MessageObject messageObject2;
        int iDp4;
        int iDp5;
        int y;
        int i4;
        if (this.currentMessageObject == null || this.doNotDraw) {
            return;
        }
        if (!this.wasLayout) {
            onLayout(false, getLeft(), getTop(), getRight(), getBottom());
        }
        if (this.enterTransitionInProgress && this.currentMessageObject.isAnimatedEmojiStickers()) {
            return;
        }
        if (this.channelRecommendationsCell != null && this.currentMessageObject.type == 27) {
            ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
            if (chatMessageCellDelegate == null || chatMessageCellDelegate.canDrawOutboundsContent()) {
                this.channelRecommendationsCell.draw(canvas);
            }
            this.transitionParams.recordDrawingState();
            return;
        }
        int saveCount = canvas.getSaveCount();
        setupTextColors();
        int topicSeparatorTopPadding = this.starsPriceTopPadding + this.suggestionOfferTopPadding + getTopicSeparatorTopPadding();
        float nameHeightAnimated = BitmapDescriptorFactory.HUE_RED;
        if (topicSeparatorTopPadding > 0) {
            canvas.save();
            canvas.translate(BitmapDescriptorFactory.HUE_RED, this.starsPriceTopPadding + this.suggestionOfferTopPadding + getTopicSeparatorTopPadding());
        }
        if (isWidthAdaptive()) {
            canvas.save();
            canvas.translate(-getBoundsLeft(), BitmapDescriptorFactory.HUE_RED);
        }
        drawBackgroundInternal(canvas, false);
        if (this.isHighlightedAnimated) {
            long jCurrentTimeMillis = System.currentTimeMillis();
            long jAbs = Math.abs(jCurrentTimeMillis - this.lastHighlightProgressTime);
            if (jAbs > 17) {
                jAbs = 17;
            }
            int i5 = (int) (this.highlightProgress - jAbs);
            this.highlightProgress = i5;
            this.lastHighlightProgressTime = jCurrentTimeMillis;
            if (i5 <= 0) {
                this.highlightProgress = 0;
                this.isHighlightedAnimated = false;
                if (this.highlightedQuote) {
                    resetUrlPaths();
                }
                this.highlightedQuote = false;
            }
            invalidate();
            if (getParent() != null) {
                ((View) getParent()).invalidate();
            }
        }
        if (this.alphaInternal != 1.0f) {
            int measuredHeight = getMeasuredHeight();
            int measuredWidth = getMeasuredWidth();
            Theme.MessageDrawable messageDrawable2 = this.currentBackgroundDrawable;
            if (messageDrawable2 != null) {
                i4 = messageDrawable2.getBounds().top;
                y = this.currentBackgroundDrawable.getBounds().bottom;
                iDp5 = this.currentBackgroundDrawable.getBounds().left;
                iDp4 = this.currentBackgroundDrawable.getBounds().right;
            } else {
                iDp4 = measuredWidth;
                iDp5 = 0;
                y = measuredHeight;
                i4 = 0;
            }
            if (this.drawSideButton != 0) {
                if (this.currentMessageObject.isOutOwner()) {
                    iDp5 -= AndroidUtilities.dp(40.0f);
                } else {
                    iDp4 += AndroidUtilities.dp(40.0f);
                }
            }
            if (getY() < BitmapDescriptorFactory.HUE_RED) {
                i4 = (int) (-getY());
            }
            float y2 = getY() + getMeasuredHeight();
            float f = this.parentHeight;
            if (y2 > f) {
                y = (int) (f - getY());
            }
            this.rect.set(iDp5, i4, iDp4, y);
            canvas.saveLayerAlpha(this.rect, (int) (this.alphaInternal * 255.0f), 31);
        }
        if (!this.transitionParams.animateBackgroundBoundsInner || (messageDrawable = this.currentBackgroundDrawable) == null || this.isRoundVideo || ((messageObject2 = this.currentMessageObject) != null && messageObject2.sendPreview)) {
            z = false;
        } else {
            Rect bounds = messageDrawable.getBounds();
            canvas.save();
            canvas.clipRect(bounds.left + AndroidUtilities.dp(4.0f), bounds.top + AndroidUtilities.dp(4.0f), bounds.right - AndroidUtilities.dp(4.0f), bounds.bottom - AndroidUtilities.dp(4.0f));
            z = true;
        }
        drawContent(canvas, false);
        ExpiredStoryView expiredStoryView = this.expiredStoryView;
        if (expiredStoryView != null && expiredStoryView.visible) {
            expiredStoryView.draw(canvas, this);
        }
        if (z) {
            canvas.restore();
        }
        if (this.replyNameLayout != null) {
            float fLerp = this.replyTextHeight;
            TransitionParams transitionParams = this.transitionParams;
            if (transitionParams != null && transitionParams.animateReplyTextLayout != null) {
                fLerp = AndroidUtilities.lerp(this.transitionParams.animateFromReplyTextHeight, fLerp, this.transitionParams.animateChangeProgress);
            }
            this.replyHeight = AndroidUtilities.dp(9.0f) + Theme.chat_replyNamePaint.getTextSize() + Math.max(fLerp - AndroidUtilities.dp(3.66f), Theme.chat_replyTextPaint.getTextSize());
            if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                MessageObject messageObject3 = this.currentMessageObject;
                if (messageObject3.type == 19 || this.isSideMenued) {
                    if (this.currentMessageObject.isOutOwner()) {
                        int iDp6 = this.backgroundDrawableLeft + AndroidUtilities.dp(12.0f) + getExtraTextX();
                        this.replyStartX = iDp6;
                        if (this.currentMessageObject.type == 19) {
                            extraTextX = iDp6 - Math.max(0, ((Math.max(this.replyNameWidth, this.replyTextWidth) + iDp6) + AndroidUtilities.dp(14.0f)) - AndroidUtilities.displaySize.x);
                        }
                        if (this.currentMessageObject.type == 19) {
                            this.replyStartX -= AndroidUtilities.dp(7.0f);
                        }
                        this.forwardHeight = AndroidUtilities.dp(4.0f) + (((int) Theme.chat_forwardNamePaint.getTextSize()) * 2);
                        int iDp7 = AndroidUtilities.dp(12.0f);
                        if (this.drawNameLayout && this.nameLayout != null) {
                            nameHeightAnimated = getNameHeightAnimated() + AndroidUtilities.dp(1.0f);
                        }
                        i2 = iDp7 + ((int) nameHeightAnimated);
                        iDp2 = (this.drawForwardedName || this.forwardedNameLayout[0] == null) ? 0 : AndroidUtilities.dp(4.0f) + this.forwardHeight;
                    } else {
                        if (this.mediaBackground) {
                            i = this.backgroundDrawableLeft;
                            iDp = AndroidUtilities.dp(12.0f);
                        } else {
                            i = this.backgroundDrawableLeft;
                            iDp = AndroidUtilities.dp(this.drawPinnedBottom ? 12.0f : 18.0f);
                        }
                        extraTextX = i + iDp + getExtraTextX();
                    }
                    this.replyStartX = extraTextX;
                    if (this.currentMessageObject.type == 19) {
                    }
                    this.forwardHeight = AndroidUtilities.dp(4.0f) + (((int) Theme.chat_forwardNamePaint.getTextSize()) * 2);
                    int iDp72 = AndroidUtilities.dp(12.0f);
                    if (this.drawNameLayout) {
                        nameHeightAnimated = getNameHeightAnimated() + AndroidUtilities.dp(1.0f);
                    }
                    i2 = iDp72 + ((int) nameHeightAnimated);
                    if (this.drawForwardedName) {
                    }
                } else {
                    if (messageObject3.isOutOwner()) {
                        int iDp8 = AndroidUtilities.dp(23.0f);
                        this.replyStartX = iDp8;
                        if (this.isPlayingRound) {
                            iRoundPlayingMessageSize = iDp8 - (AndroidUtilities.roundPlayingMessageSize(this.isSideMenued) - AndroidUtilities.roundMessageSize);
                        }
                        if (this.drawForwardedName) {
                            this.replyStartY = AndroidUtilities.dp(12.0f);
                            this.replyStartY += AndroidUtilities.dp(0.66f);
                        } else {
                            int iDp9 = AndroidUtilities.dp(4.0f) + (((int) Theme.chat_forwardNamePaint.getTextSize()) * 2);
                            this.forwardHeight = iDp9;
                            i2 = this.forwardNameY + iDp9;
                            iDp2 = AndroidUtilities.dp(6.0f);
                        }
                    } else {
                        if (this.currentMessageObject.type == 5) {
                            i3 = this.backgroundDrawableLeft + this.backgroundDrawableRight;
                            iDp3 = AndroidUtilities.dp(4.0f);
                        } else {
                            i3 = this.backgroundDrawableLeft + this.backgroundDrawableRight;
                            iDp3 = AndroidUtilities.dp(17.0f);
                        }
                        iRoundPlayingMessageSize = i3 + iDp3;
                    }
                    this.replyStartX = iRoundPlayingMessageSize;
                    if (this.drawForwardedName) {
                    }
                }
                this.replyStartY = i2 + iDp2;
                this.replyStartY += AndroidUtilities.dp(0.66f);
            }
        }
        if (this.currentPosition == null && !this.transitionParams.animateBackgroundBoundsInner && (!this.enterTransitionInProgress || this.currentMessageObject.isVoice())) {
            drawNamesLayout(canvas, 1.0f);
        }
        if ((!this.autoPlayingMedia || !MediaController.getInstance().isPlayingMessageAndReadyToDraw(this.currentMessageObject) || this.isRoundVideo) && !this.transitionParams.animateBackgroundBoundsInner && ((messageObject = this.currentMessageObject) == null || !messageObject.preview)) {
            drawOverlays(canvas);
        }
        if ((this.drawTime || !this.mediaBackground) && !this.forceNotDrawTime && !this.transitionParams.animateBackgroundBoundsInner && ((!this.enterTransitionInProgress || this.currentMessageObject.isVoice()) && (!this.currentMessageObject.isQuickReply() || this.currentMessageObject.isSendError()))) {
            drawTime(canvas, 1.0f, false);
        }
        if ((this.controlsAlpha != 1.0f || this.timeAlpha != 1.0f) && this.currentMessageObject.type != 5) {
            long jCurrentTimeMillis2 = System.currentTimeMillis();
            long jAbs2 = Math.abs(this.lastControlsAlphaChangeTime - jCurrentTimeMillis2);
            long j = this.totalChangeTime + (jAbs2 <= 17 ? jAbs2 : 17L);
            this.totalChangeTime = j;
            if (j > 200) {
                this.totalChangeTime = 200L;
            }
            this.lastControlsAlphaChangeTime = jCurrentTimeMillis2;
            if (this.controlsAlpha != 1.0f) {
                this.controlsAlpha = AndroidUtilities.decelerateInterpolator.getInterpolation(this.totalChangeTime / 200.0f);
            }
            if (this.timeAlpha != 1.0f) {
                this.timeAlpha = AndroidUtilities.decelerateInterpolator.getInterpolation(this.totalChangeTime / 200.0f);
            }
            invalidate();
            if (this.forceNotDrawTime && (groupedMessagePosition = this.currentPosition) != null && groupedMessagePosition.last && getParent() != null) {
                ((View) getParent()).invalidate();
            }
        }
        if ((this.drawBackground || this.transitionParams.animateDrawBackground) && shouldDrawSelectionOverlay() && this.currentMessagesGroup == null && hasSelectionOverlay()) {
            if (this.selectionOverlayPaint == null) {
                this.selectionOverlayPaint = new Paint(1);
            }
            this.selectionOverlayPaint.setColor(getSelectionOverlayColor());
            int alpha = this.selectionOverlayPaint.getAlpha();
            this.selectionOverlayPaint.setAlpha((int) (alpha * getHighlightAlpha() * getAlpha()));
            if (this.selectionOverlayPaint.getAlpha() > 0) {
                canvas.save();
                canvas.clipRect(0, 0, getMeasuredWidth(), getMeasuredHeight());
                this.currentBackgroundDrawable.drawCached(canvas, this.backgroundCacheParams, this.selectionOverlayPaint);
                canvas.restore();
            }
            this.selectionOverlayPaint.setAlpha(alpha);
        }
        ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
        if (chatMessageCellDelegate2 == null || chatMessageCellDelegate2.canDrawOutboundsContent() || this.transitionParams.messageEntering || getAlpha() != 1.0f) {
            drawOutboundsContent(canvas);
        }
        updateSelectionTextPosition();
        canvas.restoreToCount(saveCount);
    }

    /* JADX WARN: Removed duplicated region for block: B:383:0x0962  */
    /* JADX WARN: Removed duplicated region for block: B:386:0x096e  */
    /* JADX WARN: Removed duplicated region for block: B:387:0x0985  */
    /* JADX WARN: Removed duplicated region for block: B:668:0x11b4 A[PHI: r1 r2 r3 r4
      0x11b4: PHI (r1v45 int) = (r1v42 int), (r1v144 int) binds: [B:667:0x11b2, B:645:0x1127] A[DONT_GENERATE, DONT_INLINE]
      0x11b4: PHI (r2v97 android.graphics.drawable.Drawable) = (r2v82 android.graphics.drawable.Drawable), (r2v132 android.graphics.drawable.Drawable) binds: [B:667:0x11b2, B:645:0x1127] A[DONT_GENERATE, DONT_INLINE]
      0x11b4: PHI (r3v63 org.telegram.ui.Components.LoadingDrawable) = (r3v55 org.telegram.ui.Components.LoadingDrawable), (r3v119 org.telegram.ui.Components.LoadingDrawable) binds: [B:667:0x11b2, B:645:0x1127] A[DONT_GENERATE, DONT_INLINE]
      0x11b4: PHI (r4v15 float) = (r4v14 float), (r4v57 float) binds: [B:667:0x11b2, B:645:0x1127] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:671:0x11d6  */
    /* JADX WARN: Removed duplicated region for block: B:688:0x12ba  */
    /* JADX WARN: Removed duplicated region for block: B:691:0x12d0  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawLinkPreview(Canvas canvas, float f) {
        int i;
        int iDp;
        int extraTextX;
        int iDp2;
        int iLerp;
        boolean z;
        int i2;
        float f2;
        int i3;
        int i4;
        int i5;
        boolean z2;
        int iDp3;
        int iTextHeight;
        int iDp4;
        TextPaint textPaint;
        int i6;
        float f3;
        float f4;
        Canvas canvas2;
        float f5;
        int themedColor;
        Drawable drawable;
        LoadingDrawable loadingDrawable;
        Resources resources;
        int i7;
        float f6;
        int iDp5;
        int imageX;
        TextPaint textPaint2;
        int i8;
        ImageReceiver imageReceiver;
        float f7;
        int i9;
        boolean zDraw;
        float f8;
        MessageObject messageObject;
        ReplyMessageLine replyMessageLine;
        float f9;
        float imageWidth;
        float f10;
        MotionBackgroundDrawable motionBackgroundDrawable;
        float f11;
        float fDp;
        int i10;
        float f12;
        float f13;
        int lineBottom;
        int i11;
        int i12;
        if (this.currentMessageObject.isSponsored() || this.currentMessageObject.isUnsupported() || this.hasLinkPreview || this.hasGamePreview || this.hasInvoicePreview) {
            int saveCount = canvas.getSaveCount();
            float backgroundDrawableRight = getBackgroundDrawableRight();
            TransitionParams transitionParams = this.transitionParams;
            float fDp2 = ((backgroundDrawableRight + (transitionParams != null ? transitionParams.deltaRight : BitmapDescriptorFactory.HUE_RED)) - AndroidUtilities.dp(10 + ((!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 0 : 6))) - getExtraTextX();
            if (this.hasGamePreview) {
                iLerp = AndroidUtilities.dp(14.0f) + this.namesOffset;
                iDp2 = this.unmovedTextX - AndroidUtilities.dp(10.0f);
            } else {
                if (this.hasInvoicePreview) {
                    iLerp = AndroidUtilities.dp(14.0f) + this.namesOffset;
                } else if (this.currentMessageObject.isSponsored()) {
                    iLerp = this.linkPreviewY - AndroidUtilities.dp(2.0f);
                } else {
                    if (this.currentMessageObject.isOutOwner()) {
                        extraTextX = this.backgroundDrawableLeft + AndroidUtilities.dp(12.0f) + getExtraTextX();
                        if (this.currentMessageObject.type == 19) {
                            extraTextX -= Math.max(0, ((Math.max(this.replyNameWidth, this.replyTextWidth) + extraTextX) + AndroidUtilities.dp(14.0f)) - AndroidUtilities.displaySize.x);
                        }
                    } else {
                        if (this.mediaBackground) {
                            i = this.backgroundDrawableLeft;
                            iDp = AndroidUtilities.dp(12.0f);
                        } else {
                            i = this.backgroundDrawableLeft;
                            iDp = AndroidUtilities.dp(this.drawPinnedBottom ? 12.0f : 18.0f);
                        }
                        extraTextX = i + iDp + getExtraTextX();
                    }
                    iDp2 = ((int) (extraTextX + this.transitionParams.deltaLeft)) - AndroidUtilities.dp(1.33f);
                    iLerp = this.linkPreviewY;
                    TransitionParams transitionParams2 = this.transitionParams;
                    if (transitionParams2.animateLinkPreviewY) {
                        iLerp = AndroidUtilities.lerp(transitionParams2.animateFromLinkPreviewY, iLerp, transitionParams2.animateChangeProgress);
                    }
                }
                iDp2 = this.unmovedTextX + AndroidUtilities.dp(1.0f);
            }
            int i13 = iLerp;
            int i14 = iDp2;
            float f14 = i14;
            int i15 = (int) (fDp2 - f14);
            int iLerp2 = this.linkPreviewHeight;
            TransitionParams transitionParams3 = this.transitionParams;
            if (transitionParams3 != null && transitionParams3.animateLinkPreviewHeight) {
                iLerp2 = AndroidUtilities.lerp(transitionParams3.animateFromLinkPreviewHeight, iLerp2, transitionParams3.animateChangeProgress);
            }
            int i16 = iLerp2;
            if (this.linkLine == null) {
                this.linkLine = new ReplyMessageLine(this);
            }
            Theme.chat_replyNamePaint.setColor(this.linkLine.check(this.currentMessageObject, this.currentUser, this.currentChat, this.resourcesProvider, 3));
            ReplyMessageLine replyMessageLine2 = this.linkLine;
            int i17 = this.drawInstantViewType;
            replyMessageLine2.setEmojiAlpha((i17 == 23 || i17 == 24) ? 0.5f : 1.0f);
            boolean z3 = this.currentMessageObject.isSponsored() && !this.isSmallImage;
            boolean z4 = !(z3 || !this.drawInstantView || (i12 = this.drawInstantViewType) == 26 || i12 == 9 || i12 == 2 || i12 == 13 || i12 == 11 || i12 == 25 || i12 == 1 || i12 == 18 || i12 == 22) || (this.drawInstantViewType == 6 && this.imageBackgroundColor != 0);
            boolean z5 = !z3 && (!this.drawInstantView || (i11 = this.drawInstantViewType) == 9 || i11 == 2 || i11 == 11 || i11 == 25 || i11 == 13 || i11 == 1 || i11 == 18 || i11 == 22 || i11 == 32 || this.isSmallImage || i11 == 26);
            ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
            boolean z6 = chatMessageCellDelegate != null && chatMessageCellDelegate.isProgressLoading(this, 2);
            if (this.hasInvoicePreview || this.currentMessageObject.isGiveawayOrGiveawayResults() || this.currentMessageObject.isUnsupported()) {
                z = z6;
                i2 = i15;
                f2 = f14;
                i3 = i14;
                i4 = saveCount;
                i5 = i13;
                z2 = false;
            } else {
                if (this.linkPreviewBounce == null) {
                    this.linkPreviewBounce = new ButtonBounce(this, 2.0f, 2.0f);
                }
                canvas.save();
                float scale = this.linkPreviewBounce.getScale(0.01f);
                canvas.scale(scale, scale, (i15 / 2.0f) + f14, i13 + ((i16 + (this.drawInstantView ? AndroidUtilities.dp(42.0f) : 0)) / 2.0f));
                RectF rectF = AndroidUtilities.rectTmp;
                rectF.set(f14, i13 - AndroidUtilities.dp(6.0f), i14 + i15, i13 + i16 + (this.drawInstantView ? AndroidUtilities.dp(42.0f) : 0));
                this.linkLine.setLoading(z6);
                boolean z7 = z6;
                float fFloor = (float) Math.floor(SharedConfig.bubbleRadius / (this.currentMessageObject.isSponsored() ? 2.0f : 3.0f));
                ReplyMessageLine replyMessageLine3 = this.linkLine;
                if (z4) {
                    float fIsSmallImage = 1.0f - isSmallImage();
                    float fDp3 = AndroidUtilities.dp(18.0f) + this.photoImage.getImageHeight();
                    StaticLayout staticLayout = this.siteNameLayout;
                    if (staticLayout != null) {
                        z = z7;
                        lineBottom = staticLayout.getLineBottom(staticLayout.getLineCount() - 1);
                    } else {
                        z = z7;
                        lineBottom = 0;
                    }
                    f13 = fIsSmallImage * (fDp3 + lineBottom);
                } else {
                    z = z7;
                    f13 = BitmapDescriptorFactory.HUE_RED;
                }
                i2 = i15;
                i4 = saveCount;
                i3 = i14;
                f2 = f14;
                i5 = i13;
                replyMessageLine3.offsetEmoji(BitmapDescriptorFactory.HUE_RED, f13).drawBackground(canvas, rectF, fFloor, fFloor, fFloor, f);
                int backgroundColor = this.linkLine.getBackgroundColor();
                Drawable drawable2 = this.linkPreviewSelector;
                if (drawable2 == null) {
                    this.linkPreviewSelectorColor = backgroundColor;
                    Drawable drawableCreateRadSelectorDrawable = Theme.createRadSelectorDrawable(backgroundColor, 0, 0);
                    this.linkPreviewSelector = drawableCreateRadSelectorDrawable;
                    drawableCreateRadSelectorDrawable.setCallback(this);
                    Theme.setMaskDrawableRad(this.linkPreviewSelector, 3.0f, 6.0f, 6.0f, 3.0f);
                    this.linkPreviewSelector.setCallback(this);
                } else if (this.linkPreviewSelectorColor != backgroundColor) {
                    this.linkPreviewSelectorColor = backgroundColor;
                    Theme.setSelectorDrawableColor(drawable2, backgroundColor, true);
                }
                this.linkPreviewSelector.setBounds((int) rectF.left, (int) rectF.top, (int) rectF.right, (int) rectF.bottom);
                this.linkPreviewSelector.draw(canvas);
                this.linkLine.drawLine(canvas, rectF, f);
                this.linkLine.drawLoadingBackground(canvas, rectF, fFloor, fFloor, fFloor, f);
                z2 = true;
            }
            if (this.drawPhotoImage && z3) {
                int iDp6 = i2 - AndroidUtilities.dp(17.0f);
                if (this.isSmallImage) {
                    ImageReceiver imageReceiver2 = this.photoImage;
                    imageReceiver2.setImageX(((i3 + i2) - imageReceiver2.getImageWidth()) - AndroidUtilities.dp(6.0f));
                    this.photoImage.setImageY(0);
                } else {
                    this.photoImage.setImageX(i3 + (this.hasInvoicePreview ? -AndroidUtilities.dp(6.3f) : AndroidUtilities.dp(10.0f)));
                    this.photoImage.setImageY(i5);
                }
                TransitionParams transitionParams4 = this.transitionParams;
                if (transitionParams4 != null && transitionParams4.animateSmallImage) {
                    if (!this.isSmallImage && this.documentAttachType != 1) {
                        this.photoImage.setImageWidth((int) AndroidUtilities.lerp(transitionParams4.photoImageFromWidth, iDp6, transitionParams4.animateChangeProgress));
                    }
                    ImageReceiver imageReceiver3 = this.photoImage;
                    imageReceiver3.setImageX(AndroidUtilities.lerp(this.transitionParams.photoImageFromCenterX, imageReceiver3.getCenterX(), this.transitionParams.animateChangeProgress) - (this.photoImage.getImageWidth() / 2.0f));
                    ImageReceiver imageReceiver4 = this.photoImage;
                    imageReceiver4.setImageY(AndroidUtilities.lerp(this.transitionParams.photoImageFromCenterY, imageReceiver4.getCenterY(), this.transitionParams.animateChangeProgress) - (this.photoImage.getImageHeight() / 2.0f));
                } else if (!this.isSmallImage && (i10 = this.documentAttachType) != 7 && i10 != 1) {
                    this.photoImage.setImageWidth(iDp6);
                }
                if (!this.isSmallImage && this.drawImageButton) {
                    int iDp7 = AndroidUtilities.dp(48.0f);
                    float f15 = iDp7;
                    this.buttonX = (int) (this.photoImage.getImageX() + ((this.photoImage.getImageWidth() - f15) / 2.0f));
                    int imageY = (int) (this.photoImage.getImageY() + ((this.photoImage.getImageHeight() - f15) / 2.0f));
                    this.buttonY = imageY;
                    RadialProgress2 radialProgress2 = this.radialProgress;
                    int i18 = this.buttonX;
                    radialProgress2.setProgressRect(i18, imageY, i18 + iDp7, iDp7 + imageY);
                }
                if (this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && MediaController.getInstance().isVideoDrawingReady() && canvas.isHardwareAccelerated()) {
                    this.imageDrawn = true;
                    this.drawTime = true;
                } else {
                    ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
                    if (chatMessageCellDelegate2 == null || chatMessageCellDelegate2.getPinchToZoomHelper() == null || !this.delegate.getPinchToZoomHelper().isInOverlayModeFor(this)) {
                        if (f != 1.0f) {
                            this.photoImage.setAlpha(f);
                            this.imageDrawn = allowDrawPhotoImage() ? this.photoImage.draw(canvas) : true;
                            if (this.currentMessageObject.hasMediaSpoilers()) {
                                this.blurredPhotoImage.setAlpha(f);
                                drawBlurredPhoto(canvas);
                                f12 = 1.0f;
                                this.blurredPhotoImage.setAlpha(1.0f);
                            } else {
                                f12 = 1.0f;
                            }
                            this.photoImage.setAlpha(f12);
                        } else {
                            this.imageDrawn = allowDrawPhotoImage() ? this.photoImage.draw(canvas) : true;
                            if (this.currentMessageObject.hasMediaSpoilers()) {
                                drawBlurredPhoto(canvas);
                            }
                        }
                    }
                }
                iDp3 = (int) (i5 + this.photoImage.getImageHeight() + AndroidUtilities.dp(6.0f));
            } else {
                iDp3 = i5;
            }
            if (this.siteNameLayout != null) {
                if (this.titleLabelLayout != null) {
                    f11 = 1.0f;
                    iDp3 += AndroidUtilities.dp(1.0f);
                } else {
                    f11 = 1.0f;
                }
                int iDp8 = iDp3 - AndroidUtilities.dp(f11);
                int alpha = Theme.chat_replyNamePaint.getAlpha();
                if (f != f11) {
                    Theme.chat_replyNamePaint.setAlpha((int) (alpha * f));
                }
                canvas.save();
                if (Math.abs(this.siteNameLeft) > 1.0f) {
                    fDp = ((i2 - AndroidUtilities.dp(this.hasInvoicePreview ? BitmapDescriptorFactory.HUE_RED : 20.0f)) - this.siteNameWidth) - this.siteNameLeft;
                } else {
                    fDp = BitmapDescriptorFactory.HUE_RED;
                }
                float fDp4 = f2 + fDp + (this.hasInvoicePreview ? 0 : AndroidUtilities.dp(10.0f));
                canvas.translate(fDp4, iDp3 - AndroidUtilities.dp(1.0f));
                SpoilerEffect.layoutDrawMaybe(this.siteNameLayout, canvas);
                canvas.restore();
                if (this.titleLabelLayout != null) {
                    float fDp5 = fDp4 + this.siteNameLayoutWidth + AndroidUtilities.dp(12.0f);
                    this.titleLabelX = fDp5;
                    this.titleLabelY = iDp3;
                    this.rect.set(fDp5 - AndroidUtilities.dp(6.0f), this.titleLabelY - AndroidUtilities.dp(2.0f), this.titleLabelX + this.titleLabelLayoutWidth + AndroidUtilities.dp(6.0f), this.titleLabelY + this.titleLabelLayoutHeight + AndroidUtilities.dp(2.0f));
                    if (this.titleLabelBounce == null) {
                        this.titleLabelBounce = new ButtonBounce(this);
                    }
                    float scale2 = this.titleLabelBounce.getScale(0.1f);
                    boolean z8 = scale2 != 1.0f;
                    if (z8) {
                        canvas.save();
                        canvas.scale(scale2, scale2, this.rect.centerX(), this.rect.centerY());
                    }
                    Theme.chat_instantViewPaint.setColor(Theme.chat_replyNamePaint.getColor());
                    int alpha2 = Theme.chat_instantViewPaint.getAlpha();
                    Theme.chat_instantViewPaint.setAlpha((int) (alpha * 0.11f));
                    RectF rectF2 = this.rect;
                    canvas.drawRoundRect(rectF2, rectF2.height(), this.rect.height(), Theme.chat_instantViewPaint);
                    Theme.chat_instantViewPaint.setAlpha(alpha2);
                    Theme.chat_titleLabelTextPaint.setColor(Theme.chat_replyNamePaint.getColor());
                    Theme.chat_titleLabelTextPaint.setAlpha(Theme.chat_replyNamePaint.getAlpha());
                    canvas.save();
                    canvas.translate(this.titleLabelX, this.titleLabelY);
                    this.titleLabelLayout.draw(canvas);
                    canvas.restore();
                    if (z8) {
                        canvas.restore();
                    }
                }
                StaticLayout staticLayout2 = this.siteNameLayout;
                int lineBottom2 = iDp3 + staticLayout2.getLineBottom(staticLayout2.getLineCount() - 1);
                Theme.chat_replyNamePaint.setAlpha(alpha);
                iTextHeight = lineBottom2;
                iDp4 = iDp8;
            } else {
                iTextHeight = iDp3;
                iDp4 = 0;
            }
            if ((this.hasGamePreview || this.hasInvoicePreview) && this.currentMessageObject.textHeight(this.transitionParams) != 0) {
                int iTextHeight2 = this.currentMessageObject.textHeight(this.transitionParams) + AndroidUtilities.dp(4.0f) + i5;
                iTextHeight += this.currentMessageObject.textHeight(this.transitionParams) + AndroidUtilities.dp(4.0f);
                i5 = iTextHeight2;
            }
            if (this.drawPhotoImage && z4) {
                if (this.isSmallImage) {
                    TransitionParams transitionParams5 = this.transitionParams;
                    if (transitionParams5 != null && transitionParams5.animateSmallImage) {
                        iTextHeight = (int) (iTextHeight + (((iTextHeight != i5 ? AndroidUtilities.dp(2.0f) : 0) + this.transitionParams.photoImageFromHeight + AndroidUtilities.dp(6.0f)) * (1.0f - this.transitionParams.animateChangeProgress)));
                    }
                } else {
                    TransitionParams transitionParams6 = this.transitionParams;
                    float f16 = (transitionParams6 == null || !transitionParams6.animateSmallImage) ? 1.0f : transitionParams6.animateChangeProgress;
                    if (iTextHeight != i5) {
                        iTextHeight = (int) (iTextHeight + (AndroidUtilities.dp(2.0f) * f16));
                    }
                    int i19 = iTextHeight;
                    int iDp9 = i2 - AndroidUtilities.dp(17.0f);
                    if (this.isSmallImage || this.drawInstantViewType != 17) {
                        imageWidth = BitmapDescriptorFactory.HUE_RED;
                    } else {
                        Rect rect = AndroidUtilities.rectTmp2;
                        rect.set(i3 + AndroidUtilities.dp(10.0f), i19, AndroidUtilities.dp(10.0f) + i3 + iDp9, ((int) this.photoImage.getImageHeight()) + i19);
                        RectF rectF3 = AndroidUtilities.rectTmp;
                        rectF3.set(rect);
                        if (this.gradientDrawable == null) {
                            TLRPC.PhotoSize photoSize = this.currentPhotoObject;
                            if (photoSize != null && photoSize.gradientTopColor != 0 && photoSize.gradientBottomColor != 0) {
                                GradientDrawable.Orientation orientation = GradientDrawable.Orientation.TOP_BOTTOM;
                                TLRPC.PhotoSize photoSize2 = this.currentPhotoObject;
                                this.gradientDrawable = new GradientDrawable(orientation, new int[]{photoSize2.gradientTopColor, photoSize2.gradientBottomColor});
                            } else if (this.photoImage.getBitmap() != null) {
                                int[] colorsSync = DominantColors.getColorsSync(false, this.photoImage.getBitmap(), Theme.isCurrentThemeDark());
                                this.gradientDrawable = new GradientDrawable(GradientDrawable.Orientation.TOP_BOTTOM, colorsSync);
                                TLRPC.PhotoSize photoSize3 = this.currentPhotoObject;
                                if (photoSize3 != null) {
                                    photoSize3.gradientTopColor = colorsSync[0];
                                    photoSize3.gradientBottomColor = colorsSync[1];
                                }
                            }
                        }
                        if (this.gradientDrawable != null) {
                            canvas.save();
                            Path path = this.drillHolePath;
                            if (path != null) {
                                path.rewind();
                            } else {
                                this.drillHolePath = new Path();
                            }
                            this.drillHolePath.addRoundRect(rectF3, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), Path.Direction.CW);
                            canvas.clipPath(this.drillHolePath);
                            this.gradientDrawable.setBounds(rect);
                            this.gradientDrawable.draw(canvas);
                            canvas.restore();
                        }
                        imageWidth = (((this.instantWidth - this.photoImage.getImageWidth()) - AndroidUtilities.dp(10.0f)) - (this.transitionParams == null ? BitmapDescriptorFactory.HUE_RED : this.currentMessageObject.isOutOwner() ? this.transitionParams.deltaLeft : -this.transitionParams.deltaRight)) / 2.0f;
                    }
                    if (this.imageBackgroundSideColor != 0) {
                        int iDp10 = i3 + AndroidUtilities.dp(10.0f);
                        ImageReceiver imageReceiver5 = this.photoImage;
                        float f17 = iDp10;
                        imageReceiver5.setImageX(imageWidth + f17 + ((this.imageBackgroundSideWidth - imageReceiver5.getImageWidth()) / 2.0f));
                        this.photoImage.setImageY(i19);
                        this.rect.set(f17, this.photoImage.getImageY(), iDp10 + this.imageBackgroundSideWidth, this.photoImage.getImageY2());
                        Theme.chat_instantViewPaint.setColor(ColorUtils.setAlphaComponent(this.imageBackgroundSideColor, (int) (f * 255.0f)));
                        canvas.drawRoundRect(this.rect, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), Theme.chat_instantViewPaint);
                    } else {
                        this.photoImage.setImageX(imageWidth + f2 + AndroidUtilities.dp(10.0f));
                        this.photoImage.setImageY(i19);
                    }
                    if (this.drawInstantViewType != 17) {
                        TransitionParams transitionParams7 = this.transitionParams;
                        if (transitionParams7 != null && transitionParams7.animateSmallImage) {
                            if (!this.isSmallImage && this.documentAttachType != 1) {
                                this.photoImage.setImageWidth((int) AndroidUtilities.lerp(transitionParams7.photoImageFromWidth, iDp9, transitionParams7.animateChangeProgress));
                            }
                            ImageReceiver imageReceiver6 = this.photoImage;
                            imageReceiver6.setImageX(AndroidUtilities.lerp(this.transitionParams.photoImageFromCenterX, imageReceiver6.getCenterX(), this.transitionParams.animateChangeProgress) - (this.photoImage.getImageWidth() / 2.0f));
                            ImageReceiver imageReceiver7 = this.photoImage;
                            imageReceiver7.setImageY(AndroidUtilities.lerp(this.transitionParams.photoImageFromCenterY, imageReceiver7.getCenterY(), this.transitionParams.animateChangeProgress) - (this.photoImage.getImageHeight() / 2.0f));
                        } else if (!this.isSmallImage && this.documentAttachType != 1) {
                            this.photoImage.setImageWidth(iDp9);
                        }
                    }
                    if (this.imageBackgroundColor != 0) {
                        this.rect.set(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX2(), this.photoImage.getImageY2());
                        if (this.imageBackgroundGradientColor1 != 0) {
                            if (this.imageBackgroundGradientColor2 == 0) {
                                if (this.gradientShader == null) {
                                    Rect gradientPoints = BackgroundGradientDrawable.getGradientPoints(AndroidUtilities.getWallpaperRotation(this.imageBackgroundGradientRotation, false), (int) this.rect.width(), (int) this.rect.height());
                                    this.gradientShader = new LinearGradient(gradientPoints.left, gradientPoints.top, gradientPoints.right, gradientPoints.bottom, new int[]{this.imageBackgroundColor, this.imageBackgroundGradientColor1}, (float[]) null, Shader.TileMode.CLAMP);
                                }
                                Theme.chat_instantViewPaint.setShader(this.gradientShader);
                                if (f != 1.0f) {
                                    Theme.chat_instantViewPaint.setAlpha((int) (f * 255.0f));
                                }
                            } else if (this.motionBackgroundDrawable == null) {
                                MotionBackgroundDrawable motionBackgroundDrawable2 = new MotionBackgroundDrawable(this.imageBackgroundColor, this.imageBackgroundGradientColor1, this.imageBackgroundGradientColor2, this.imageBackgroundGradientColor3, true);
                                this.motionBackgroundDrawable = motionBackgroundDrawable2;
                                if (this.imageBackgroundIntensity < BitmapDescriptorFactory.HUE_RED) {
                                    this.photoImage.setGradientBitmap(motionBackgroundDrawable2.getBitmap());
                                }
                                if (!this.photoImage.hasImageSet()) {
                                    this.motionBackgroundDrawable.setRoundRadius(AndroidUtilities.dp(4.0f));
                                }
                            }
                            motionBackgroundDrawable = this.motionBackgroundDrawable;
                            if (motionBackgroundDrawable == null) {
                                RectF rectF4 = this.rect;
                                motionBackgroundDrawable.setBounds((int) rectF4.left, (int) rectF4.top, (int) rectF4.right, (int) rectF4.bottom);
                                this.motionBackgroundDrawable.draw(canvas);
                            } else if (this.imageBackgroundSideColor != 0) {
                                canvas.drawRect(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX2(), this.photoImage.getImageY2(), Theme.chat_instantViewPaint);
                            } else {
                                canvas.drawRoundRect(this.rect, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), Theme.chat_instantViewPaint);
                            }
                            Theme.chat_instantViewPaint.setShader(null);
                            Theme.chat_instantViewPaint.setAlpha(255);
                        } else {
                            Theme.chat_instantViewPaint.setShader(null);
                            Theme.chat_instantViewPaint.setColor(this.imageBackgroundColor);
                            if (f != 1.0f) {
                            }
                            motionBackgroundDrawable = this.motionBackgroundDrawable;
                            if (motionBackgroundDrawable == null) {
                            }
                            Theme.chat_instantViewPaint.setShader(null);
                            Theme.chat_instantViewPaint.setAlpha(255);
                        }
                    }
                    if (this.drawPhotoImage && this.drawInstantView && this.drawInstantViewType != 9) {
                        if (this.drawImageButton) {
                            int iDp11 = AndroidUtilities.dp(48.0f);
                            float f18 = iDp11;
                            this.buttonX = (int) (this.photoImage.getImageX() + ((this.photoImage.getImageWidth() - f18) / 2.0f));
                            int imageY2 = (int) (this.photoImage.getImageY() + ((this.photoImage.getImageHeight() - f18) / 2.0f));
                            this.buttonY = imageY2;
                            RadialProgress2 radialProgress22 = this.radialProgress;
                            int i20 = this.buttonX;
                            radialProgress22.setProgressRect(i20, imageY2, i20 + iDp11, iDp11 + imageY2);
                        }
                        ChatMessageCellDelegate chatMessageCellDelegate3 = this.delegate;
                        if (chatMessageCellDelegate3 == null || chatMessageCellDelegate3.getPinchToZoomHelper() == null || !this.delegate.getPinchToZoomHelper().isInOverlayModeFor(this)) {
                            if (f != 1.0f) {
                                this.photoImage.setAlpha(f);
                                this.imageDrawn = allowDrawPhotoImage() ? this.photoImage.draw(canvas) : true;
                                if (this.currentMessageObject.hasMediaSpoilers()) {
                                    this.blurredPhotoImage.setAlpha(f);
                                    drawBlurredPhoto(canvas);
                                    f10 = 1.0f;
                                    this.blurredPhotoImage.setAlpha(1.0f);
                                } else {
                                    f10 = 1.0f;
                                }
                                this.photoImage.setAlpha(f10);
                            } else {
                                this.imageDrawn = allowDrawPhotoImage() ? this.photoImage.draw(canvas) : true;
                                if (this.currentMessageObject.hasMediaSpoilers()) {
                                    drawBlurredPhoto(canvas);
                                }
                            }
                        }
                    }
                    TransitionParams transitionParams8 = this.transitionParams;
                    iTextHeight = (transitionParams8 == null || !transitionParams8.animateChange) ? (int) (i19 + (f16 * (this.photoImage.getImageHeight() + AndroidUtilities.dp(6.0f)))) : (int) (i19 + (f16 * (transitionParams8.animateToImageH + AndroidUtilities.dp(6.0f))));
                }
            }
            if (this.currentMessageObject.isOutOwner()) {
                textPaint = Theme.chat_replyNamePaint;
                i6 = Theme.key_chat_messageTextOut;
            } else {
                textPaint = Theme.chat_replyNamePaint;
                i6 = Theme.key_chat_messageTextIn;
            }
            int i21 = (int) (f * 255.0f);
            textPaint.setColor(ColorUtils.setAlphaComponent(getThemedColor(i6), i21));
            Theme.chat_replyTextPaint.setColor(ColorUtils.setAlphaComponent(getThemedColor(i6), i21));
            if (this.titleLayout != null) {
                if (iTextHeight != i5) {
                    iTextHeight += AndroidUtilities.dp(4.0f);
                    f9 = 1.0f;
                    AndroidUtilities.dp(1.0f);
                } else {
                    f9 = 1.0f;
                }
                if (iDp4 == 0) {
                    iDp4 = iTextHeight - AndroidUtilities.dp(f9);
                }
                canvas.save();
                float fDp6 = i3 + AndroidUtilities.dp(10.0f) + (Math.abs(this.titleLayoutLeft) > 1 ? ((i2 - AndroidUtilities.dp(20.0f)) - this.titleLayoutWidth) - this.titleLayoutLeft : 0);
                float fDp7 = iTextHeight - AndroidUtilities.dp(3.0f);
                TransitionParams transitionParams9 = this.transitionParams;
                canvas.translate(fDp6, fDp7 + (!transitionParams9.animateLinkPreviewY ? transitionParams9.deltaBottom + (-transitionParams9.deltaTop) : BitmapDescriptorFactory.HUE_RED));
                TextPaint paint = this.titleLayout.getPaint();
                int alpha3 = paint.getAlpha();
                paint.setAlpha((int) (alpha3 * f));
                SpoilerEffect.layoutDrawMaybe(this.titleLayout, canvas);
                paint.setAlpha(alpha3);
                canvas.restore();
                StaticLayout staticLayout3 = this.titleLayout;
                iTextHeight += staticLayout3.getLineBottom(staticLayout3.getLineCount() - 1);
            }
            if (this.authorLayout != null) {
                if (iTextHeight != i5) {
                    iTextHeight += AndroidUtilities.dp(2.0f);
                }
                if (iDp4 == 0) {
                    iDp4 = iTextHeight - AndroidUtilities.dp(1.0f);
                }
                canvas.save();
                float fDp8 = i3 + AndroidUtilities.dp(10.0f) + (Math.abs(this.authorLayoutLeft) > 1 ? ((i2 - AndroidUtilities.dp(20.0f)) - this.authorLayoutWidth) - this.authorLayoutLeft : 0);
                float fDp9 = iTextHeight - AndroidUtilities.dp(3.0f);
                TransitionParams transitionParams10 = this.transitionParams;
                canvas.translate(fDp8, fDp9 + (!transitionParams10.animateLinkPreviewY ? transitionParams10.deltaBottom + (-transitionParams10.deltaTop) : BitmapDescriptorFactory.HUE_RED));
                TextPaint paint2 = this.authorLayout.getPaint();
                int alpha4 = paint2.getAlpha();
                paint2.setAlpha((int) (alpha4 * f));
                SpoilerEffect.layoutDrawMaybe(this.authorLayout, canvas);
                paint2.setAlpha(alpha4);
                canvas.restore();
                StaticLayout staticLayout4 = this.authorLayout;
                iTextHeight += staticLayout4.getLineBottom(staticLayout4.getLineCount() - 1);
            }
            if (this.descriptionLayout != null) {
                if (iTextHeight != i5) {
                    iTextHeight += AndroidUtilities.dp(2.0f);
                }
                int i22 = iTextHeight;
                if (iDp4 == 0) {
                    iDp4 = i22 - AndroidUtilities.dp(1.0f);
                }
                int i23 = iDp4;
                this.descriptionY = i22 - AndroidUtilities.dp(3.0f);
                canvas.save();
                float fDp10 = i3 + AndroidUtilities.dp(10.0f) + (Math.abs(this.descriptionLayoutLeft) > 1 ? ((i2 - AndroidUtilities.dp(20.0f)) - this.descriptionLayoutWidth) - this.descriptionLayoutLeft : 0);
                float f19 = this.descriptionY;
                TransitionParams transitionParams11 = this.transitionParams;
                canvas.translate(fDp10, f19 + (!transitionParams11.animateLinkPreviewY ? transitionParams11.deltaBottom + (-transitionParams11.deltaTop) : BitmapDescriptorFactory.HUE_RED));
                if (this.linkBlockNum == -10 && this.links.draw(canvas)) {
                    invalidate();
                }
                drawProgressLoadingLink(canvas, -2);
                ChatMessageCellDelegate chatMessageCellDelegate4 = this.delegate;
                if (chatMessageCellDelegate4 != null && chatMessageCellDelegate4.getTextSelectionHelper() != null && getDelegate().getTextSelectionHelper().isSelected(this.currentMessageObject)) {
                    this.delegate.getTextSelectionHelper().drawDescription(this.currentMessageObject.isOutOwner(), this.descriptionLayout, canvas);
                }
                TextPaint paint3 = this.descriptionLayout.getPaint();
                if (z2 && (messageObject = this.currentMessageObject) != null && !messageObject.isOutOwner() && (replyMessageLine = this.linkLine) != null) {
                    paint3.linkColor = replyMessageLine.getColor();
                }
                int alpha5 = paint3.getAlpha();
                paint3.setAlpha((int) (alpha5 * f));
                SpoilerEffect.layoutDrawMaybe(this.descriptionLayout, canvas);
                paint3.setAlpha(alpha5);
                StaticLayout staticLayout5 = this.descriptionLayout;
                f4 = 2.0f;
                f3 = 1.0f;
                AnimatedEmojiSpan.drawAnimatedEmojis(canvas, staticLayout5, this.animatedEmojiDescriptionStack, BitmapDescriptorFactory.HUE_RED, null, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 1.0f, getAdaptiveEmojiColorFilter(1, staticLayout5.getPaint().getColor()));
                canvas.restore();
                paint3.linkColor = getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_messageLinkOut : Theme.key_chat_messageLinkIn);
                StaticLayout staticLayout6 = this.descriptionLayout;
                iTextHeight = i22 + staticLayout6.getLineBottom(staticLayout6.getLineCount() - 1);
                iDp4 = i23;
            } else {
                f3 = 1.0f;
                f4 = 2.0f;
            }
            if (this.drawPhotoImage && z5) {
                if (iTextHeight != i5) {
                    iTextHeight += AndroidUtilities.dp(f4);
                }
                int iDp12 = i2 - AndroidUtilities.dp(17.0f);
                if (this.isSmallImage) {
                    ImageReceiver imageReceiver8 = this.photoImage;
                    imageReceiver8.setImageX(((i3 + i2) - imageReceiver8.getImageWidth()) - AndroidUtilities.dp(6.0f));
                    imageReceiver = this.photoImage;
                    f7 = iDp4;
                } else {
                    this.photoImage.setImageX(i3 + (this.hasInvoicePreview ? -AndroidUtilities.dp(6.3f) : AndroidUtilities.dp(10.0f)));
                    imageReceiver = this.photoImage;
                    f7 = iTextHeight;
                }
                imageReceiver.setImageY(f7);
                TransitionParams transitionParams12 = this.transitionParams;
                if (transitionParams12 != null && transitionParams12.animateSmallImage) {
                    if (!this.isSmallImage && this.documentAttachType != 1) {
                        this.photoImage.setImageWidth((int) AndroidUtilities.lerp(transitionParams12.photoImageFromWidth, iDp12, transitionParams12.animateChangeProgress));
                    }
                    ImageReceiver imageReceiver9 = this.photoImage;
                    imageReceiver9.setImageX(AndroidUtilities.lerp(this.transitionParams.photoImageFromCenterX, imageReceiver9.getCenterX(), this.transitionParams.animateChangeProgress) - (this.photoImage.getImageWidth() / f4));
                    ImageReceiver imageReceiver10 = this.photoImage;
                    imageReceiver10.setImageY(AndroidUtilities.lerp(this.transitionParams.photoImageFromCenterY, imageReceiver10.getCenterY(), this.transitionParams.animateChangeProgress) - (this.photoImage.getImageHeight() / f4));
                } else if (!this.isSmallImage && (i9 = this.documentAttachType) != 7 && i9 != 1) {
                    this.photoImage.setImageWidth(iDp12);
                }
                if (!this.isSmallImage && this.drawImageButton) {
                    int iDp13 = AndroidUtilities.dp(48.0f);
                    float f20 = iDp13;
                    this.buttonX = (int) (this.photoImage.getImageX() + ((this.photoImage.getImageWidth() - f20) / f4));
                    int imageY3 = (int) (this.photoImage.getImageY() + ((this.photoImage.getImageHeight() - f20) / f4));
                    this.buttonY = imageY3;
                    RadialProgress2 radialProgress23 = this.radialProgress;
                    int i24 = this.buttonX;
                    radialProgress23.setProgressRect(i24, imageY3, i24 + iDp13, iDp13 + imageY3);
                }
                if (this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && MediaController.getInstance().isVideoDrawingReady() && canvas.isHardwareAccelerated()) {
                    this.imageDrawn = true;
                    this.drawTime = true;
                } else {
                    ChatMessageCellDelegate chatMessageCellDelegate5 = this.delegate;
                    if (chatMessageCellDelegate5 == null || chatMessageCellDelegate5.getPinchToZoomHelper() == null || !this.delegate.getPinchToZoomHelper().isInOverlayModeFor(this)) {
                        if (f != f3) {
                            this.photoImage.setAlpha(f);
                            if (allowDrawPhotoImage()) {
                                canvas2 = canvas;
                                f8 = 1.0f;
                                zDraw = this.photoImage.draw(canvas2);
                            } else {
                                canvas2 = canvas;
                                zDraw = true;
                                f8 = 1.0f;
                            }
                            this.imageDrawn = zDraw;
                            if (this.currentMessageObject.hasMediaSpoilers()) {
                                this.blurredPhotoImage.setAlpha(f);
                                drawBlurredPhoto(canvas);
                                this.blurredPhotoImage.setAlpha(f8);
                            }
                            this.photoImage.setAlpha(f8);
                        } else {
                            canvas2 = canvas;
                            this.imageDrawn = allowDrawPhotoImage() ? this.photoImage.draw(canvas2) : true;
                            if (this.currentMessageObject.hasMediaSpoilers()) {
                                drawBlurredPhoto(canvas);
                            }
                        }
                    }
                }
                canvas2 = canvas;
            } else {
                canvas2 = canvas;
            }
            int i25 = this.documentAttachType;
            if (i25 == 4 || i25 == 2) {
                this.videoButtonX = (int) (this.photoImage.getImageX() + AndroidUtilities.dp(8.0f));
                int imageY4 = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(8.0f));
                this.videoButtonY = imageY4;
                RadialProgress2 radialProgress24 = this.videoRadialProgress;
                int i26 = this.videoButtonX;
                radialProgress24.setProgressRect(i26, imageY4, AndroidUtilities.dp(24.0f) + i26, this.videoButtonY + AndroidUtilities.dp(24.0f));
            }
            Paint themedPaint = getThemedPaint("paintChatTimeBackground");
            if (this.photosCountLayout != null && this.photoImage.getVisible()) {
                int imageX2 = (int) (((this.photoImage.getImageX() + this.photoImage.getImageWidth()) - AndroidUtilities.dp(8.0f)) - this.photosCountWidth);
                int imageY5 = (int) ((this.photoImage.getImageY() + this.photoImage.getImageHeight()) - AndroidUtilities.dp(19.0f));
                this.rect.set(imageX2 - AndroidUtilities.dp(4.0f), imageY5 - AndroidUtilities.dp(1.5f), this.photosCountWidth + imageX2 + AndroidUtilities.dp(4.0f), imageY5 + AndroidUtilities.dp(14.5f));
                int alpha6 = themedPaint.getAlpha();
                themedPaint.setAlpha((int) (alpha6 * this.controlsAlpha));
                Theme.chat_durationPaint.setAlpha((int) (this.controlsAlpha * 255.0f));
                canvas2.drawRoundRect(this.rect, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), themedPaint);
                themedPaint.setAlpha(alpha6);
                canvas.save();
                canvas2.translate(imageX2, imageY5);
                this.photosCountLayout.draw(canvas2);
                canvas.restore();
                Theme.chat_durationPaint.setAlpha(255);
            }
            if (this.videoInfoLayout != null && ((!this.drawPhotoImage || this.photoImage.getVisible()) && this.imageBackgroundSideColor == 0)) {
                if (!this.hasGamePreview && !this.hasInvoicePreview && this.documentAttachType != 8) {
                    imageX = (int) (((this.photoImage.getImageX() + this.photoImage.getImageWidth()) - AndroidUtilities.dp(8.0f)) - this.durationWidth);
                    iTextHeight = (int) ((this.photoImage.getImageY() + this.photoImage.getImageHeight()) - AndroidUtilities.dp(19.0f));
                    this.rect.set(imageX - AndroidUtilities.dp(4.0f), iTextHeight - AndroidUtilities.dp(1.5f), this.durationWidth + imageX + AndroidUtilities.dp(4.0f), AndroidUtilities.dp(14.5f) + iTextHeight);
                    canvas2.drawRoundRect(this.rect, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), getThemedPaint("paintChatTimeBackground"));
                } else if (this.drawPhotoImage) {
                    imageX = (int) (this.photoImage.getImageX() + AndroidUtilities.dp(8.5f));
                    iTextHeight = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(6.0f));
                    this.rect.set(imageX - AndroidUtilities.dp(4.0f), iTextHeight - AndroidUtilities.dp(1.5f), this.durationWidth + imageX + AndroidUtilities.dp(4.0f), AndroidUtilities.dp(this.documentAttachType == 8 ? 14.5f : 16.5f) + iTextHeight);
                    canvas2.drawRoundRect(this.rect, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), themedPaint);
                } else {
                    imageX = i3;
                }
                canvas.save();
                canvas2.translate(imageX, iTextHeight);
                if (this.hasInvoicePreview) {
                    if (this.drawPhotoImage) {
                        textPaint2 = Theme.chat_shipmentPaint;
                        i8 = Theme.key_chat_previewGameText;
                    } else if (this.currentMessageObject.isOutOwner()) {
                        textPaint2 = Theme.chat_shipmentPaint;
                        i8 = Theme.key_chat_messageTextOut;
                    } else {
                        textPaint2 = Theme.chat_shipmentPaint;
                        i8 = Theme.key_chat_messageTextIn;
                    }
                    textPaint2.setColor(getThemedColor(i8));
                }
                this.videoInfoLayout.draw(canvas2);
                canvas.restore();
            }
            drawVideoTimestamps(canvas2, this.linkLine.getColor());
            this.giveawayMessageCell.draw(canvas2, this.namesOffset, i3, this.resourcesProvider);
            this.giveawayResultsMessageCell.draw(canvas2, this.namesOffset, i3, this.resourcesProvider);
            if (this.drawInstantView) {
                if (this.currentMessageObject.isOutOwner()) {
                    themedColor = getThemedColor(Theme.key_chat_outPreviewInstantText);
                    if (this.instantDrawable == null) {
                        this.instantDrawable = this.drawInstantViewType == 27 ? getContext().getResources().getDrawable(R.drawable.mini_call_join).mutate() : getThemedDrawable("drawableMsgOutInstant");
                        Drawable drawable3 = this.instantDrawable;
                        this.instantDrawableColor = themedColor;
                        drawable3.setColorFilter(new PorterDuffColorFilter(themedColor, PorterDuff.Mode.SRC_IN));
                    }
                    if (this.instantDrawableColor != themedColor) {
                        Drawable drawable4 = this.instantDrawable;
                        this.instantDrawableColor = themedColor;
                        drawable4.setColorFilter(new PorterDuffColorFilter(themedColor, PorterDuff.Mode.SRC_IN));
                    }
                    drawable = this.instantDrawable;
                    Theme.chat_instantViewPaint.setColor(themedColor);
                    f5 = 0.1f;
                    Theme.chat_instantViewButtonPaint.setColor(Theme.multAlpha(themedColor, 0.1f));
                    loadingDrawable = this.instantButtonLoading;
                    if (loadingDrawable != null) {
                        loadingDrawable.setColors(Theme.multAlpha(themedColor, f5), Theme.multAlpha(themedColor, 0.3f), Theme.multAlpha(themedColor, 0.3f), Theme.multAlpha(themedColor, 1.2f));
                    }
                    Drawable drawable5 = drawable;
                    int i27 = i5 + i16;
                    if (z2) {
                        int iDp14 = i27 + AndroidUtilities.dp(this.currentMessageObject.isUnsupported() ? -5.0f : 10.0f);
                        LoadingDrawable loadingDrawable2 = this.instantButtonLoading;
                        if (loadingDrawable2 != null && !z && !loadingDrawable2.isDisappeared() && !this.instantButtonLoading.isDisappearing()) {
                            this.instantButtonLoading.disappear();
                        }
                        LoadingDrawable loadingDrawable3 = this.instantButtonLoading;
                        if (loadingDrawable3 == null && z) {
                            LoadingDrawable loadingDrawable4 = new LoadingDrawable();
                            this.instantButtonLoading = loadingDrawable4;
                            loadingDrawable4.strokePaint.setStrokeWidth(AndroidUtilities.dp(1.25f));
                            this.instantButtonLoading.setAppearByGradient(true);
                        } else if (loadingDrawable3 != null && z && (loadingDrawable3.isDisappeared() || this.instantButtonLoading.isDisappearing())) {
                            this.instantButtonLoading.reset();
                            this.instantButtonLoading.resetDisappear();
                        }
                        this.instantButtonRect.set(f2, iDp14, i3 + this.instantWidth, AndroidUtilities.dp(36.0f) + iDp14);
                        float scale3 = this.instantButtonBounce.getScale(0.02f);
                        boolean z9 = scale3 != 1.0f;
                        if (z9) {
                            canvas.save();
                            canvas2.scale(scale3, scale3, this.instantButtonRect.centerX(), this.instantButtonRect.centerY());
                        }
                        if (Build.VERSION.SDK_INT >= 21) {
                            this.selectorDrawableMaskType[0] = 0;
                            createSelectorDrawable(0);
                            this.selectorDrawable[0].setBounds(i3, iDp14, i3 + this.instantWidth, AndroidUtilities.dp(36.0f) + iDp14);
                            this.selectorDrawable[0].draw(canvas2);
                        }
                        LoadingDrawable loadingDrawable5 = this.instantButtonLoading;
                        if (loadingDrawable5 == null || loadingDrawable5.isDisappeared()) {
                            f6 = 6.0f;
                        } else {
                            this.instantButtonLoading.setBounds(this.instantButtonRect);
                            f6 = 6.0f;
                            this.instantButtonLoading.setRadiiDp(6.0f);
                            this.instantButtonLoading.draw(canvas2);
                            invalidate();
                        }
                        canvas2.drawRoundRect(this.instantButtonRect, AndroidUtilities.dp(f6), AndroidUtilities.dp(f6), Theme.chat_instantViewButtonPaint);
                        int i28 = this.drawInstantViewType;
                        if (i28 == 0) {
                            BaseCell.setDrawableBounds(drawable5, ((this.instantTextLeftX + this.instantTextX) + i3) - AndroidUtilities.dp(15.0f), AndroidUtilities.dp(11.5f) + iDp14, AndroidUtilities.dp(9.0f), AndroidUtilities.dp(13.0f));
                            drawable5.setAlpha((int) (f * 255.0f));
                            drawable5.draw(canvas2);
                        } else if (i28 == 16) {
                            if (this.instantLinkArrowPaint == null) {
                                Paint paint4 = new Paint(1);
                                this.instantLinkArrowPaint = paint4;
                                paint4.setStyle(Paint.Style.STROKE);
                                this.instantLinkArrowPaint.setStrokeCap(Paint.Cap.ROUND);
                                this.instantLinkArrowPaint.setStrokeJoin(Paint.Join.ROUND);
                            }
                            this.instantLinkArrowPaint.setColor(Theme.chat_instantViewPaint.getColor());
                            this.instantLinkArrowPaint.setStrokeWidth(AndroidUtilities.dpf2(1.333f));
                            Path path2 = this.instantLinkArrowPath;
                            if (path2 == null) {
                                this.instantLinkArrowPath = new Path();
                            } else {
                                path2.rewind();
                            }
                            this.instantLinkArrowPath.moveTo(this.instantButtonRect.right - AndroidUtilities.dp(11.0f), this.instantButtonRect.top + AndroidUtilities.dp(6.0f));
                            this.instantLinkArrowPath.lineTo(this.instantButtonRect.right - AndroidUtilities.dp(6.0f), this.instantButtonRect.top + AndroidUtilities.dp(6.0f));
                            this.instantLinkArrowPath.lineTo(this.instantButtonRect.right - AndroidUtilities.dp(6.0f), this.instantButtonRect.top + AndroidUtilities.dp(11.0f));
                            this.instantLinkArrowPath.moveTo(this.instantButtonRect.right - AndroidUtilities.dpf2(11.66f), this.instantButtonRect.top + AndroidUtilities.dp(11.66f));
                            this.instantLinkArrowPath.lineTo(this.instantButtonRect.right - AndroidUtilities.dp(6.0f), this.instantButtonRect.top + AndroidUtilities.dp(6.0f));
                            canvas2.drawPath(this.instantLinkArrowPath, this.instantLinkArrowPaint);
                        }
                        if (this.instantViewLayout != null) {
                            canvas.save();
                            canvas2.translate(i3 + this.instantTextX, iDp14 + AndroidUtilities.dp(10.5f));
                            SpoilerEffect.layoutDrawMaybe(this.instantViewLayout, canvas2);
                            canvas.restore();
                        }
                        if (z9) {
                            canvas.restore();
                        }
                    } else {
                        int iDp15 = i27 + AndroidUtilities.dp(14.0f);
                        int alpha7 = Theme.chat_instantViewPaint.getAlpha();
                        Theme.chat_instantViewPaint.setAlpha((int) (alpha7 * 0.18f));
                        canvas.drawRect(i3 + AndroidUtilities.dp(10.0f), AndroidUtilities.dp(f4) + i27, (i3 + i2) - AndroidUtilities.dp(7.0f), i27 + AndroidUtilities.dp(f4) + Math.max(1, AndroidUtilities.dp(0.66f)), Theme.chat_instantViewPaint);
                        Theme.chat_instantViewPaint.setAlpha(alpha7);
                        int i29 = this.drawInstantViewType;
                        float fDp11 = AndroidUtilities.dp(i29 == 27 ? 20.0f : i29 == 0 ? 15.0f : BitmapDescriptorFactory.HUE_RED) + this.instantViewLayoutWidth;
                        float fDp12 = f2 + ((i2 - fDp11) / f4);
                        int i30 = this.drawInstantViewType;
                        if (i30 == 0) {
                            BaseCell.setDrawableBounds(drawable5, fDp12, AndroidUtilities.dp(1.0f) + iDp15, AndroidUtilities.dp(9.0f), AndroidUtilities.dp(13.0f));
                            drawable5.setAlpha((int) (f * 255.0f));
                            drawable5.draw(canvas2);
                            iDp5 = AndroidUtilities.dp(15.0f);
                        } else if (i30 == 27) {
                            BaseCell.setDrawableBounds(drawable5, fDp12, iDp15, drawable5.getIntrinsicWidth(), drawable5.getIntrinsicHeight());
                            drawable5.setAlpha((int) (f * 255.0f));
                            drawable5.draw(canvas2);
                            iDp5 = AndroidUtilities.dp(20.0f);
                        } else {
                            if (i30 == 16) {
                                fDp12 -= AndroidUtilities.dp(11.0f);
                                BaseCell.setDrawableBounds(drawable5, fDp11 + fDp12 + AndroidUtilities.dp(4.0f), iDp15 - AndroidUtilities.dp(f4), AndroidUtilities.dp(18.0f), AndroidUtilities.dp(18.0f));
                                drawable5.setAlpha((int) (f * 255.0f));
                                drawable5.draw(canvas2);
                            }
                            if (this.instantViewLayout != null) {
                                canvas.save();
                                canvas2.translate(fDp12 - this.instantViewLayoutLeft, iDp15);
                                SpoilerEffect.layoutDrawMaybe(this.instantViewLayout, canvas2);
                                canvas.restore();
                            }
                        }
                        fDp12 += iDp5;
                        if (this.instantViewLayout != null) {
                        }
                    }
                } else {
                    f5 = 0.1f;
                    themedColor = getThemedColor(Theme.key_chat_inPreviewInstantText);
                    if (this.linkLine != null && !this.currentMessageObject.isUnsupported()) {
                        themedColor = this.linkLine.getColor();
                    }
                    if (this.instantDrawable == null) {
                        int i31 = this.drawInstantViewType;
                        if (i31 == 16) {
                            resources = getContext().getResources();
                            i7 = R.drawable.mini_external_link;
                        } else if (i31 == 27) {
                            resources = getContext().getResources();
                            i7 = R.drawable.mini_call_join;
                        } else {
                            resources = getContext().getResources();
                            i7 = R.drawable.msg_instant;
                        }
                        this.instantDrawable = resources.getDrawable(i7).mutate();
                        Drawable drawable6 = this.instantDrawable;
                        this.instantDrawableColor = themedColor;
                        drawable6.setColorFilter(new PorterDuffColorFilter(themedColor, PorterDuff.Mode.SRC_IN));
                    }
                    if (this.instantDrawableColor != themedColor) {
                        Drawable drawable7 = this.instantDrawable;
                        this.instantDrawableColor = themedColor;
                        drawable7.setColorFilter(new PorterDuffColorFilter(themedColor, PorterDuff.Mode.SRC_IN));
                    }
                    drawable = this.instantDrawable;
                    Theme.chat_instantViewPaint.setColor(themedColor);
                    Theme.chat_instantViewButtonPaint.setColor(Theme.multAlpha(themedColor, 0.1f));
                    loadingDrawable = this.instantButtonLoading;
                    if (loadingDrawable != null) {
                    }
                    Drawable drawable52 = drawable;
                    int i272 = i5 + i16;
                    if (z2) {
                    }
                }
            }
            canvas2.restoreToCount(i4);
        }
    }

    /* JADX WARN: Multi-variable type inference failed */
    /* JADX WARN: Removed duplicated region for block: B:106:0x020e  */
    /* JADX WARN: Removed duplicated region for block: B:144:0x0326  */
    /* JADX WARN: Removed duplicated region for block: B:162:0x039c  */
    /* JADX WARN: Removed duplicated region for block: B:170:0x03ca  */
    /* JADX WARN: Removed duplicated region for block: B:175:0x03d8  */
    /* JADX WARN: Removed duplicated region for block: B:178:0x03f1  */
    /* JADX WARN: Removed duplicated region for block: B:185:0x0414  */
    /* JADX WARN: Removed duplicated region for block: B:186:0x0417  */
    /* JADX WARN: Removed duplicated region for block: B:189:0x0428  */
    /* JADX WARN: Removed duplicated region for block: B:230:0x068e  */
    /* JADX WARN: Removed duplicated region for block: B:274:0x0785  */
    /* JADX WARN: Removed duplicated region for block: B:281:0x07b6  */
    /* JADX WARN: Removed duplicated region for block: B:284:0x07d8  */
    /* JADX WARN: Removed duplicated region for block: B:299:0x0828  */
    /* JADX WARN: Removed duplicated region for block: B:307:0x083d  */
    /* JADX WARN: Removed duplicated region for block: B:310:0x0851  */
    /* JADX WARN: Removed duplicated region for block: B:311:0x0855  */
    /* JADX WARN: Removed duplicated region for block: B:314:0x0860  */
    /* JADX WARN: Removed duplicated region for block: B:315:0x0865  */
    /* JADX WARN: Removed duplicated region for block: B:319:0x0876 A[LOOP:3: B:317:0x086e->B:319:0x0876, LOOP_END] */
    /* JADX WARN: Removed duplicated region for block: B:330:0x08a5  */
    /* JADX WARN: Removed duplicated region for block: B:331:0x08a9  */
    /* JADX WARN: Removed duplicated region for block: B:334:0x08bd  */
    /* JADX WARN: Removed duplicated region for block: B:335:0x08c0  */
    /* JADX WARN: Removed duplicated region for block: B:346:0x08fe  */
    /* JADX WARN: Removed duplicated region for block: B:354:0x094a  */
    /* JADX WARN: Removed duplicated region for block: B:357:0x0963  */
    /* JADX WARN: Removed duplicated region for block: B:372:0x0936 A[ADDED_TO_REGION, REMOVE, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:378:? A[RETURN, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:74:0x0181  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawMessageText(float f, float f2, Canvas canvas, ArrayList arrayList, float f3, boolean z, float f4, boolean z2, boolean z3, boolean z4) {
        int size;
        int i;
        float backgroundDrawableRight;
        int i2;
        int i3;
        int iSaveLayerAlpha;
        boolean z5;
        QuoteHighlight quoteHighlight;
        int i4;
        int i5;
        int i6;
        int i7;
        int i8;
        MessageObject.TextLayoutBlock textLayoutBlock;
        int i9;
        int i10;
        MessageObject.TextLayoutBlock textLayoutBlock2;
        int i11;
        int i12;
        float f5;
        int iMin;
        float f6;
        int i13;
        Text text;
        int i14;
        ChatMessageCellDelegate chatMessageCellDelegate;
        int i15;
        float f7;
        int i16;
        MessageObject.TextLayoutBlock textLayoutBlock3;
        float f8;
        MessageObject.TextLayoutBlock textLayoutBlock4;
        boolean z6;
        int i17;
        int i18;
        ButtonBounce buttonBounce;
        Theme.MessageDrawable messageDrawable;
        RectF rectF;
        float currentBackgroundLeft;
        float f9;
        int iDp;
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        StaticLayout staticLayout;
        float f10 = f;
        ArrayList arrayList2 = arrayList;
        if (arrayList2 == null || arrayList.isEmpty()) {
            return;
        }
        float f11 = BitmapDescriptorFactory.HUE_RED;
        if (f4 == BitmapDescriptorFactory.HUE_RED) {
            return;
        }
        if (!z || z2) {
            size = arrayList.size();
            i = 0;
        } else {
            if (this.fullyDraw) {
                this.firstVisibleBlockNum = 0;
                this.lastVisibleBlockNum = arrayList.size();
            }
            i = this.firstVisibleBlockNum;
            size = this.lastVisibleBlockNum;
        }
        boolean zIsTranslating = MessagesController.getInstance(this.currentAccount).getTranslateController().isTranslating(getMessageObject());
        boolean z7 = !z;
        MessageObject messageObject = this.currentMessageObject;
        if (z7 == (messageObject != null && messageObject.translated)) {
            if (this.translationLoadingFloat == null) {
                this.translationLoadingFloat = new AnimatedFloat(this, 350L, CubicBezierInterpolator.EASE_OUT_QUINT);
            }
            float f12 = this.translationLoadingFloat.set(zIsTranslating ? 1.0f : BitmapDescriptorFactory.HUE_RED);
            if (f12 > BitmapDescriptorFactory.HUE_RED) {
                if (this.translationLoadingDrawable == null) {
                    LoadingDrawable loadingDrawable = new LoadingDrawable();
                    this.translationLoadingDrawable = loadingDrawable;
                    loadingDrawable.setAppearByGradient(true);
                    if (this.translationLoadingPath == null) {
                        LinkPath linkPath = new LinkPath(true);
                        this.translationLoadingPath = linkPath;
                        linkPath.setUseCornerPathImplementation(true);
                    }
                    this.translationLoadingDrawable.usePath(this.translationLoadingPath);
                    this.translationLoadingDrawable.setRadiiDp(5.0f);
                    this.translationLoadingDrawable.reset();
                }
                if (this.translationLoadingDrawableText != arrayList2) {
                    this.translationLoadingDrawableText = arrayList2;
                    this.translationLoadingPath.reset();
                    int i19 = 0;
                    while (i19 < arrayList.size()) {
                        MessageObject.TextLayoutBlock textLayoutBlock5 = (MessageObject.TextLayoutBlock) arrayList2.get(i19);
                        if (textLayoutBlock5 != 0 && (staticLayout = textLayoutBlock5.textLayout) != null) {
                            LinkPath linkPath2 = this.translationLoadingPath;
                            if (textLayoutBlock5.isRtl()) {
                                f11 = f3;
                            }
                            linkPath2.setCurrentLayout(staticLayout, 0, f11, textLayoutBlock5.textYOffset(arrayList2, this.transitionParams));
                            StaticLayout staticLayout2 = textLayoutBlock5.textLayout;
                            staticLayout2.getSelectionPath(0, staticLayout2.getText().length(), this.translationLoadingPath);
                        }
                        i19++;
                        f11 = BitmapDescriptorFactory.HUE_RED;
                    }
                    this.translationLoadingPath.closeRects();
                    this.translationLoadingDrawable.updateBounds();
                }
                if (zIsTranslating && (this.translationLoadingDrawable.isDisappearing() || this.translationLoadingDrawable.isDisappeared())) {
                    this.translationLoadingDrawable.reset();
                    this.translationLoadingDrawable.resetDisappear();
                } else if (!zIsTranslating && !this.translationLoadingDrawable.isDisappearing() && !this.translationLoadingDrawable.isDisappeared()) {
                    this.translationLoadingDrawable.disappear();
                }
                MessageObject messageObject2 = this.currentMessageObject;
                int themedColor = getThemedColor((messageObject2 == null || !messageObject2.isOutOwner()) ? Theme.key_chat_messageLinkIn : Theme.key_chat_messageLinkOut);
                this.translationLoadingDrawable.setColors(Theme.multAlpha(themedColor, 0.05f), Theme.multAlpha(themedColor, 0.15f), Theme.multAlpha(themedColor, 0.1f), Theme.multAlpha(themedColor, 0.3f));
                canvas.save();
                canvas.translate(f10, f2 + this.transitionYOffsetForDrawables);
                this.translationLoadingDrawable.setAlpha((int) (f4 * 255.0f * f12));
                this.translationLoadingDrawable.draw(canvas);
                canvas.restore();
                invalidate();
            }
        }
        if (i < 0) {
            return;
        }
        if (this.currentMessagesGroup == null || (groupedMessagePosition = this.currentPosition) == null) {
            backgroundDrawableRight = getBackgroundDrawableRight() + this.transitionParams.deltaRight;
        } else {
            int i20 = groupedMessagePosition.flags;
            if ((i20 & 1) == 0 || (i20 & 2) == 0) {
                int minTabletSide = AndroidUtilities.isTablet() ? AndroidUtilities.getMinTabletSide() : getParentWidth();
                int i21 = 0;
                for (int i22 = 0; i22 < this.currentMessagesGroup.posArray.size(); i22++) {
                    if (this.currentMessagesGroup.posArray.get(i22).minY != 0) {
                        break;
                    }
                    double d = i21;
                    double dCeil = Math.ceil(((r4.pw + r4.leftSpanOffset) / 1000.0f) * minTabletSide);
                    Double.isNaN(d);
                    i21 = (int) (d + dCeil);
                }
                backgroundDrawableRight = ((this.mediaBackground || !this.currentMessageObject.isOutOwner()) ? this.backgroundDrawableLeft + i21 : (this.backgroundDrawableLeft + i21) - AndroidUtilities.dp(6.0f)) - (getExtraTextX() + AndroidUtilities.dp((this.isAvatarVisible ? 48 : 0) + 8));
            }
        }
        float fDp = (backgroundDrawableRight - (AndroidUtilities.dp(10 + ((!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 0 : 6)) + getExtraTextX())) - f10;
        if (f4 == 1.0f) {
            i2 = 0;
            i3 = 0;
            iSaveLayerAlpha = Integer.MIN_VALUE;
        } else {
            if (z3 || z4) {
                int alpha = Theme.chat_msgTextPaint.getAlpha();
                int iAlpha = Color.alpha(Theme.chat_msgTextPaint.linkColor);
                Theme.chat_msgTextPaint.setAlpha((int) (alpha * f4));
                TextPaint textPaint = Theme.chat_msgTextPaint;
                textPaint.linkColor = ColorUtils.setAlphaComponent(textPaint.linkColor, (int) (iAlpha * f4));
                i3 = alpha;
                i2 = iAlpha;
                iSaveLayerAlpha = Integer.MIN_VALUE;
                z5 = true;
                int color = (this.currentMessageObject.isOutOwner() || ChatObject.isChannelAndNotMegaGroup(this.currentMessageObject.getChatId(), this.currentAccount)) ? Theme.chat_msgTextPaint.getColor() : getThemedColor(Theme.key_chat_outTimeText);
                quoteHighlight = this.quoteHighlight;
                if (quoteHighlight != null || quoteHighlight.todo || this.currentMessagesGroup != null || (messageDrawable = this.currentBackgroundDrawable) == null) {
                    i4 = i2;
                    i5 = i3;
                    i6 = iSaveLayerAlpha;
                } else {
                    canvas.save();
                    canvas.clipPath(messageDrawable.makePath());
                    Paint paint = this.quoteHighlight.paint;
                    MessageObject messageObject3 = this.currentMessageObject;
                    int themedColor2 = getThemedColor((messageObject3 == null || !messageObject3.isOutOwner() || this.currentMessageObject.preview) ? Theme.key_chat_inReplyLine : Theme.key_chat_outReplyLine);
                    Theme.isCurrentThemeDark();
                    paint.setColor(Theme.multAlpha(themedColor2, 0.2f));
                    i4 = i2;
                    i5 = i3;
                    i6 = iSaveLayerAlpha;
                    this.quoteHighlight.draw(canvas, f, f2, messageDrawable.getBounds(), getHighlightAlpha(true));
                    canvas.restore();
                }
                i7 = i;
                while (i7 <= size && i7 < arrayList.size()) {
                    textLayoutBlock = (MessageObject.TextLayoutBlock) arrayList2.get(i7);
                    int saveCount = canvas.getSaveCount();
                    canvas.save();
                    float fDp2 = textLayoutBlock.isRtl() ? BitmapDescriptorFactory.HUE_RED : f3 - (textLayoutBlock.quote ? AndroidUtilities.dp(10.0f) : 0);
                    canvas.translate(f10 - fDp2, f2 + textLayoutBlock.textYOffset(arrayList2, this.transitionParams) + this.transitionYOffsetForDrawables + textLayoutBlock.padTop);
                    if (i7 == this.linkBlockNum) {
                        if (!z3 && this.links.draw(canvas)) {
                            invalidate();
                        }
                        drawProgressLoadingLink(canvas, i7);
                    }
                    int iDp2 = (int) (textLayoutBlock.maxRight + ((float) AndroidUtilities.dp(24.0f)) <= 0.7f * fDp ? fDp : textLayoutBlock.maxRight + AndroidUtilities.dp(24.0f));
                    if (textLayoutBlock.quote) {
                        i9 = iDp2;
                        i10 = saveCount;
                        textLayoutBlock2 = textLayoutBlock;
                        i11 = i7;
                        TextPaint textPaint2 = Theme.chat_msgGameTextPaint;
                        TextPaint textPaint3 = Theme.chat_replyTextPaint;
                        TextPaint textPaint4 = Theme.chat_quoteTextPaint;
                        TextPaint textPaint5 = Theme.chat_msgTextPaint;
                        int themedColor3 = getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_messageLinkOut : Theme.key_chat_messageLinkIn);
                        textPaint5.linkColor = themedColor3;
                        textPaint4.linkColor = themedColor3;
                        textPaint3.linkColor = themedColor3;
                        textPaint2.linkColor = themedColor3;
                        if (textLayoutBlock2.code) {
                            if (this.quoteLine == null) {
                                this.quoteLine = new ReplyMessageLine(this);
                            }
                            this.quoteLine.check(this.currentMessageObject, this.currentUser, this.currentChat, this.resourcesProvider, 2);
                            if (this.currentMessageObject.isOutOwner() && (Theme.isCurrentThemeDark() || Theme.isCustomTheme())) {
                                this.quoteLine.setBackgroundColor(getThemedColor(Theme.key_chat_outCodeBackground));
                            }
                            RectF rectF2 = AndroidUtilities.rectTmp;
                            rectF2.set(BitmapDescriptorFactory.HUE_RED, (-AndroidUtilities.dp(6.0f)) - textLayoutBlock2.languageHeight, this.namesOffset <= 0 ? fDp + AndroidUtilities.dp(4.0f) : fDp, textLayoutBlock2.height + AndroidUtilities.dp(6.0f));
                            rectF2.offset(textLayoutBlock2.isRtl() ? f3 : BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED);
                            if (textLayoutBlock2.hasCodeCopyButton) {
                                rectF2.bottom += AndroidUtilities.dp(38.0f);
                            }
                            if (!textLayoutBlock2.first || this.namesOffset > 0 || z4) {
                                iMin = Math.min(5, SharedConfig.bubbleRadius);
                            } else if (this.currentMessageObject.isOutOwner() && this.pinnedTop) {
                                iMin = Math.min(6, SharedConfig.bubbleRadius);
                            } else {
                                f6 = (SharedConfig.bubbleRadius / 3.0f) * 2.0f;
                                float f13 = f6;
                                this.quoteLine.drawBackground(canvas, rectF2, 5.0f, f13, Math.min(5, SharedConfig.bubbleRadius), f4);
                                i13 = textLayoutBlock2.languageHeight;
                                if (i13 > 0) {
                                    float f14 = rectF2.bottom;
                                    rectF2.bottom = rectF2.top + i13;
                                    this.quoteLine.drawBackground(canvas, rectF2, 5.0f, f13, BitmapDescriptorFactory.HUE_RED, (Theme.isCurrentThemeDark() ? 0.6f : 0.8f) * f4);
                                    rectF2.bottom = f14;
                                }
                                this.quoteLine.drawLine(canvas, rectF2, f4);
                                if (textLayoutBlock2.hasCodeCopyButton) {
                                    textLayoutBlock2.drawCopyCodeButton(canvas, rectF2, this.quoteLine.getColor(), this.quoteLine.getBackgroundColor(), f4);
                                }
                                canvas.translate(AndroidUtilities.dp(10.0f), BitmapDescriptorFactory.HUE_RED);
                                text = textLayoutBlock2.languageLayout;
                                if (text != null) {
                                    text.ellipsize((int) (fDp - AndroidUtilities.dp(12.0f))).draw(canvas, BitmapDescriptorFactory.HUE_RED, (-AndroidUtilities.dp(6.0f)) - (textLayoutBlock2.languageHeight / 2.0f), this.quoteLine.color3, f4);
                                }
                            }
                            f6 = iMin;
                            float f132 = f6;
                            this.quoteLine.drawBackground(canvas, rectF2, 5.0f, f132, Math.min(5, SharedConfig.bubbleRadius), f4);
                            i13 = textLayoutBlock2.languageHeight;
                            if (i13 > 0) {
                            }
                            this.quoteLine.drawLine(canvas, rectF2, f4);
                            if (textLayoutBlock2.hasCodeCopyButton) {
                            }
                            canvas.translate(AndroidUtilities.dp(10.0f), BitmapDescriptorFactory.HUE_RED);
                            text = textLayoutBlock2.languageLayout;
                            if (text != null) {
                            }
                        }
                        i12 = color;
                        f5 = 1.0f;
                    } else {
                        if (this.quoteLine == null) {
                            this.quoteLine = new ReplyMessageLine(this);
                        }
                        this.quoteLine.check(this.currentMessageObject, this.currentUser, this.currentChat, this.resourcesProvider, 1);
                        RectF rectF3 = AndroidUtilities.rectTmp;
                        float f15 = iDp2;
                        rectF3.set(BitmapDescriptorFactory.HUE_RED, (-textLayoutBlock.padTop) + AndroidUtilities.dp(textLayoutBlock.first ? 4.66f : 3.0f), f15, textLayoutBlock.height(this.transitionParams) + AndroidUtilities.dp(4.0f));
                        rectF3.offset(fDp2, BitmapDescriptorFactory.HUE_RED);
                        if (textLayoutBlock.quoteCollapse && (buttonBounce = textLayoutBlock.collapsedBounce) != null) {
                            float scale = buttonBounce.getScale(0.01f);
                            canvas.scale(scale, scale, rectF3.centerX(), rectF3.centerY());
                        }
                        i10 = saveCount;
                        i11 = i7;
                        this.quoteLine.drawBackground(canvas, rectF3, 5.0f, 5.0f, 5.0f, f4);
                        this.quoteLine.drawLine(canvas, rectF3, f4);
                        if (this.quoteDrawable == null) {
                            i18 = 2;
                            this.quoteDrawable = new Drawable[2];
                        } else {
                            i18 = 2;
                        }
                        if (this.quoteDrawableColor == null) {
                            this.quoteDrawableColor = new int[i18];
                        }
                        boolean z8 = textLayoutBlock.quoteCollapse;
                        Drawable[] drawableArr = this.quoteDrawable;
                        if (drawableArr[z8 ? 1 : 0] == null) {
                            drawableArr[z8 ? 1 : 0] = getContext().getResources().getDrawable(R.drawable.mini_quote).mutate();
                        }
                        if (this.quoteLine.getColor() != this.quoteDrawableColor[z8 ? 1 : 0]) {
                            Drawable drawable = this.quoteDrawable[z8 ? 1 : 0];
                            int[] iArr = this.quoteDrawableColor;
                            int color2 = this.quoteLine.getColor();
                            iArr[z8 ? 1 : 0] = color2;
                            drawable.setColorFilter(new PorterDuffColorFilter(color2, PorterDuff.Mode.SRC_IN));
                        }
                        this.quoteDrawable[z8 ? 1 : 0].setBounds((int) ((rectF3.right - AndroidUtilities.dp((!this.drawPinnedTop ? 1 : 0) + 2)) - this.quoteDrawable[z8 ? 1 : 0].getIntrinsicWidth()), (int) (rectF3.top + AndroidUtilities.dp((!this.drawPinnedTop ? 1 : 0) + 2)), (int) (rectF3.right - AndroidUtilities.dp((!this.drawPinnedTop ? 1 : 0) + 2)), (int) (rectF3.top + AndroidUtilities.dp((!this.drawPinnedTop ? 1 : 0) + 2) + this.quoteDrawable[z8 ? 1 : 0].getIntrinsicHeight()));
                        int i23 = (int) (f4 * 255.0f);
                        this.quoteDrawable[z8 ? 1 : 0].setAlpha(i23);
                        this.quoteDrawable[z8 ? 1 : 0].draw(canvas);
                        int color3 = this.quoteLine.getColor();
                        TextPaint textPaint6 = Theme.chat_msgGameTextPaint;
                        TextPaint textPaint7 = Theme.chat_replyTextPaint;
                        TextPaint textPaint8 = Theme.chat_quoteTextPaint;
                        TextPaint textPaint9 = Theme.chat_msgTextPaint;
                        int color4 = this.currentMessageObject.isOutOwner() ? Theme.getColor(Theme.key_chat_messageLinkOut, this.resourcesProvider) : this.quoteLine.getColor();
                        textPaint9.linkColor = color4;
                        textPaint8.linkColor = color4;
                        textPaint7.linkColor = color4;
                        textPaint6.linkColor = color4;
                        if (!textLayoutBlock.quoteCollapse || textLayoutBlock.height <= textLayoutBlock.collapsedHeight) {
                            textLayoutBlock2 = textLayoutBlock;
                            i9 = iDp2;
                            i12 = color3;
                            f5 = 1.0f;
                        } else {
                            float fCollapsed = textLayoutBlock.collapsed(this.transitionParams);
                            if (this.quoteArrow == null) {
                                Drawable drawableMutate = getContext().getResources().getDrawable(R.drawable.arrow_more).mutate();
                                this.quoteArrow = drawableMutate;
                                int color5 = this.quoteLine.getColor();
                                this.quoteArrowColor = color5;
                                drawableMutate.setColorFilter(new PorterDuffColorFilter(color5, PorterDuff.Mode.SRC_IN));
                            }
                            if (this.quoteLine.getColor() != this.quoteArrowColor) {
                                Drawable drawable2 = this.quoteArrow;
                                int color6 = this.quoteLine.getColor();
                                this.quoteArrowColor = color6;
                                drawable2.setColorFilter(new PorterDuffColorFilter(color6, PorterDuff.Mode.SRC_IN));
                            }
                            canvas.save();
                            int iDp3 = AndroidUtilities.dp(16.0f);
                            int i24 = ((int) fDp2) + iDp2;
                            this.quoteArrow.setBounds((i24 - iDp3) - AndroidUtilities.dp(7.0f), (textLayoutBlock.height(this.transitionParams) - iDp3) - AndroidUtilities.dp(2.0f), i24 - AndroidUtilities.dp(7.0f), textLayoutBlock.height(this.transitionParams) - AndroidUtilities.dp(2.0f));
                            canvas.rotate(AndroidUtilities.lerp(180, 0, fCollapsed), this.quoteArrow.getBounds().centerX(), this.quoteArrow.getBounds().centerY());
                            this.quoteArrow.setAlpha(i23);
                            this.quoteArrow.draw(canvas);
                            canvas.restore();
                            i9 = iDp2;
                            textLayoutBlock2 = textLayoutBlock;
                            canvas.saveLayerAlpha(fDp2, BitmapDescriptorFactory.HUE_RED, f15 + fDp2, textLayoutBlock.height(this.transitionParams) - 1, 255, 31);
                            i12 = color3;
                            f5 = fCollapsed;
                        }
                    }
                    i14 = i11;
                    if (i14 == this.linkSelectionBlockNum && this.quoteHighlight == null && !this.urlPathSelection.isEmpty() && !z3) {
                        MessageObject messageObject4 = this.currentMessageObject;
                        Paint paint2 = (messageObject4 == null && messageObject4.isOutOwner()) ? Theme.chat_outUrlPaint : Theme.chat_urlPaint;
                        MessageObject messageObject5 = this.currentMessageObject;
                        paint2.setColor(getThemedColor((messageObject5 == null && messageObject5.isOutOwner() && !this.currentMessageObject.preview) ? Theme.key_chat_outReplyLine : Theme.key_chat_inReplyLine));
                        int alpha2 = (int) (paint2.getAlpha() * (!Theme.isCurrentThemeDark() ? 0.2f : 0.3f));
                        paint2.setAlpha((int) (alpha2 * (!this.highlightedQuote ? getHighlightAlpha() : 1.0f)));
                        for (i17 = 0; i17 < this.urlPathSelection.size(); i17++) {
                            canvas.drawPath((Path) this.urlPathSelection.get(i17), paint2);
                        }
                        paint2.setAlpha(alpha2);
                    }
                    chatMessageCellDelegate = this.delegate;
                    if (chatMessageCellDelegate != null && chatMessageCellDelegate.getTextSelectionHelper() != null && this.transitionParams.animateChangeProgress == 1.0f && !z3) {
                        TextSelectionHelper.ChatListTextSelectionHelper textSelectionHelper = this.delegate.getTextSelectionHelper();
                        MessageObject messageObject6 = this.currentMessageObject;
                        if (z4) {
                            textSelectionHelper.draw(messageObject6, textLayoutBlock2, canvas);
                        } else {
                            textSelectionHelper.drawCaption(messageObject6, textLayoutBlock2, canvas);
                        }
                    }
                    try {
                        Emoji.emojiDrawingYOffset = -this.transitionYOffsetForDrawables;
                        boolean z9 = this.invalidateSpoilersParent;
                        AtomicReference<Layout> atomicReference = textLayoutBlock2.spoilersPatchedTextLayout;
                        StaticLayout staticLayout3 = textLayoutBlock2.textLayout;
                        List<SpoilerEffect> list = textLayoutBlock2.spoilers;
                        z6 = this.currentPosition == null;
                        i15 = i14;
                        f7 = f5;
                        i16 = size;
                        textLayoutBlock3 = textLayoutBlock2;
                        f8 = BitmapDescriptorFactory.HUE_RED;
                    } catch (Exception e) {
                        e = e;
                        i15 = i14;
                        f7 = f5;
                        i16 = size;
                        textLayoutBlock3 = textLayoutBlock2;
                        f8 = BitmapDescriptorFactory.HUE_RED;
                    }
                    try {
                        SpoilerEffect.renderWithRipple(this, z9, i12, 0, atomicReference, 0, staticLayout3, list, canvas, z6);
                        Emoji.emojiDrawingYOffset = BitmapDescriptorFactory.HUE_RED;
                    } catch (Exception e2) {
                        e = e2;
                        FileLog.e(e);
                        textLayoutBlock4 = textLayoutBlock3;
                        if (textLayoutBlock4.quoteCollapse) {
                        }
                        canvas.restoreToCount(i10);
                        i7 = i15 + 1;
                        f10 = f;
                        arrayList2 = arrayList;
                        size = i16;
                    }
                    textLayoutBlock4 = textLayoutBlock3;
                    if (textLayoutBlock4.quoteCollapse && textLayoutBlock4.height > textLayoutBlock4.collapsedHeight) {
                        if (this.clip == null) {
                            this.clip = new GradientClip();
                        }
                        canvas.save();
                        RectF rectF4 = AndroidUtilities.rectTmp;
                        rectF4.set(f8, textLayoutBlock4.height(this.transitionParams) - AndroidUtilities.dp(24.0f), i9, textLayoutBlock4.height(this.transitionParams));
                        this.clip.draw(canvas, rectF4, 3, f7);
                        canvas.restore();
                    }
                    canvas.restoreToCount(i10);
                    i7 = i15 + 1;
                    f10 = f;
                    arrayList2 = arrayList;
                    size = i16;
                }
                if (z5) {
                    Theme.chat_msgTextPaint.setAlpha(i5);
                    TextPaint textPaint10 = Theme.chat_msgTextPaint;
                    textPaint10.linkColor = ColorUtils.setAlphaComponent(textPaint10.linkColor, i4);
                }
                i8 = i6;
                if (i8 == Integer.MIN_VALUE) {
                    canvas.restoreToCount(i8);
                    return;
                }
                return;
            }
            Theme.MessageDrawable messageDrawable2 = this.currentBackgroundDrawable;
            if (messageDrawable2 != null) {
                int i25 = messageDrawable2.getBounds().top;
                int y = this.currentBackgroundDrawable.getBounds().bottom;
                if (z4) {
                    rectF = this.rect;
                    currentBackgroundLeft = getCurrentBackgroundLeft() - AndroidUtilities.dp(10.0f);
                    f9 = i25;
                    iDp = this.currentBackgroundDrawable.getBounds().right + AndroidUtilities.dp(10.0f);
                } else {
                    if (getY() < BitmapDescriptorFactory.HUE_RED) {
                        i25 = (int) (-getY());
                    }
                    float y2 = getY() + getMeasuredHeight();
                    float f16 = this.parentHeight;
                    if (y2 > f16) {
                        y = (int) (f16 - getY());
                    }
                    rectF = this.rect;
                    currentBackgroundLeft = getCurrentBackgroundLeft();
                    f9 = i25;
                    iDp = this.currentBackgroundDrawable.getBounds().right;
                }
                rectF.set(currentBackgroundLeft, f9, iDp, y);
            } else {
                this.rect.set(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, getMeasuredWidth(), getMeasuredHeight());
            }
            iSaveLayerAlpha = canvas.saveLayerAlpha(this.rect, (int) (f4 * 255.0f), 31);
            i2 = 0;
            i3 = 0;
        }
        z5 = false;
        int color7 = (this.currentMessageObject.isOutOwner() || ChatObject.isChannelAndNotMegaGroup(this.currentMessageObject.getChatId(), this.currentAccount)) ? Theme.chat_msgTextPaint.getColor() : getThemedColor(Theme.key_chat_outTimeText);
        quoteHighlight = this.quoteHighlight;
        if (quoteHighlight != null) {
            i4 = i2;
            i5 = i3;
            i6 = iSaveLayerAlpha;
        }
        i7 = i;
        while (i7 <= size) {
            textLayoutBlock = (MessageObject.TextLayoutBlock) arrayList2.get(i7);
            int saveCount2 = canvas.getSaveCount();
            canvas.save();
            if (textLayoutBlock.isRtl()) {
            }
            canvas.translate(f10 - fDp2, f2 + textLayoutBlock.textYOffset(arrayList2, this.transitionParams) + this.transitionYOffsetForDrawables + textLayoutBlock.padTop);
            if (i7 == this.linkBlockNum) {
            }
            int iDp22 = (int) (textLayoutBlock.maxRight + ((float) AndroidUtilities.dp(24.0f)) <= 0.7f * fDp ? fDp : textLayoutBlock.maxRight + AndroidUtilities.dp(24.0f));
            if (textLayoutBlock.quote) {
            }
            i14 = i11;
            if (i14 == this.linkSelectionBlockNum) {
                MessageObject messageObject42 = this.currentMessageObject;
                if (messageObject42 == null) {
                    MessageObject messageObject52 = this.currentMessageObject;
                    if (messageObject52 == null) {
                        paint2.setColor(getThemedColor((messageObject52 == null && messageObject52.isOutOwner() && !this.currentMessageObject.preview) ? Theme.key_chat_outReplyLine : Theme.key_chat_inReplyLine));
                        int alpha22 = (int) (paint2.getAlpha() * (!Theme.isCurrentThemeDark() ? 0.2f : 0.3f));
                        paint2.setAlpha((int) (alpha22 * (!this.highlightedQuote ? getHighlightAlpha() : 1.0f)));
                        while (i17 < this.urlPathSelection.size()) {
                        }
                        paint2.setAlpha(alpha22);
                    }
                }
            }
            chatMessageCellDelegate = this.delegate;
            if (chatMessageCellDelegate != null) {
                TextSelectionHelper.ChatListTextSelectionHelper textSelectionHelper2 = this.delegate.getTextSelectionHelper();
                MessageObject messageObject62 = this.currentMessageObject;
                if (z4) {
                }
            }
            Emoji.emojiDrawingYOffset = -this.transitionYOffsetForDrawables;
            boolean z92 = this.invalidateSpoilersParent;
            AtomicReference<Layout> atomicReference2 = textLayoutBlock2.spoilersPatchedTextLayout;
            StaticLayout staticLayout32 = textLayoutBlock2.textLayout;
            List<SpoilerEffect> list2 = textLayoutBlock2.spoilers;
            if (this.currentPosition == null) {
            }
            i15 = i14;
            f7 = f5;
            i16 = size;
            textLayoutBlock3 = textLayoutBlock2;
            f8 = BitmapDescriptorFactory.HUE_RED;
            SpoilerEffect.renderWithRipple(this, z92, i12, 0, atomicReference2, 0, staticLayout32, list2, canvas, z6);
            Emoji.emojiDrawingYOffset = BitmapDescriptorFactory.HUE_RED;
            textLayoutBlock4 = textLayoutBlock3;
            if (textLayoutBlock4.quoteCollapse) {
            }
            canvas.restoreToCount(i10);
            i7 = i15 + 1;
            f10 = f;
            arrayList2 = arrayList;
            size = i16;
        }
        if (z5) {
        }
        i8 = i6;
        if (i8 == Integer.MIN_VALUE) {
        }
    }

    public void drawMessageText(Canvas canvas) {
        float f;
        float fTextHeight;
        float f2;
        int iDp;
        float f3;
        int iDp2;
        float f4;
        ArrayList<MessageObject.TextLayoutBlock> arrayList;
        float f5;
        boolean z;
        boolean z2;
        boolean z3;
        float f6;
        boolean z4;
        ChatMessageCell chatMessageCell;
        float f7;
        Canvas canvas2;
        int iDp3;
        int iDp4;
        int i;
        int iDp5;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || messageObject.isSponsored()) {
            return;
        }
        float f8 = this.textY;
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateText) {
            float f9 = transitionParams.animateFromTextY;
            float f10 = transitionParams.animateChangeProgress;
            f = (f9 * (1.0f - f10)) + (f10 * f8);
        } else {
            f = f8;
        }
        if (transitionParams.animateChangeProgress == 1.0f || !transitionParams.animateMessageText) {
            boolean z5 = transitionParams.animateLinkAbove;
            if (!z5 || this.currentBackgroundDrawable == null) {
                float f11 = this.textX;
                MessageObject messageObject2 = this.currentMessageObject;
                drawMessageText(f11, f, canvas, messageObject2.textLayoutBlocks, messageObject2.textXOffset, true, 1.0f, true, false, false);
                return;
            }
            if (z5) {
                float fTextHeight2 = (this.linkPreviewAbove ? 1 : -1) * this.currentMessageObject.textHeight(transitionParams);
                TransitionParams transitionParams2 = this.transitionParams;
                f = f8 + (fTextHeight2 * (1.0f - transitionParams2.animateChangeProgress));
                fTextHeight = transitionParams2.animateFromTextY - (((this.linkPreviewAbove ? 1 : -1) * this.currentMessageObject.textHeight(transitionParams2)) * this.transitionParams.animateChangeProgress);
            } else {
                fTextHeight = f;
            }
            canvas.save();
            RectF rectF = AndroidUtilities.rectTmp;
            rectF.set(this.currentBackgroundDrawable.getBounds());
            if (!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.pinnedBottom) {
                rectF.left += AndroidUtilities.dp(4.0f);
                f2 = rectF.right;
                iDp = AndroidUtilities.dp(4.0f);
            } else {
                rectF.left += AndroidUtilities.dp(4.0f);
                f2 = rectF.right;
                iDp = AndroidUtilities.dp(10.0f);
            }
            rectF.right = f2 - iDp;
            float f12 = rectF.left;
            float f13 = this.transitionParams.animateFromTextY;
            canvas.clipRect(f12, f13, rectF.right, this.currentMessageObject.textHeight(r1) + f13 + AndroidUtilities.dp(4.0f));
            float f14 = this.textX;
            MessageObject messageObject3 = this.currentMessageObject;
            drawMessageText(f14, fTextHeight, canvas, messageObject3.textLayoutBlocks, messageObject3.textXOffset, false, 1.0f - this.transitionParams.animateChangeProgress, true, false, false);
            canvas.restore();
            canvas.save();
            rectF.set(this.currentBackgroundDrawable.getBounds());
            if (!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.pinnedBottom) {
                rectF.left += AndroidUtilities.dp(4.0f);
                f3 = rectF.right;
                iDp2 = AndroidUtilities.dp(4.0f);
            } else {
                rectF.left += AndroidUtilities.dp(4.0f);
                f3 = rectF.right;
                iDp2 = AndroidUtilities.dp(10.0f);
            }
            rectF.right = f3 - iDp2;
            canvas.clipRect(rectF.left, this.textY, rectF.right, r1 + this.currentMessageObject.textHeight(this.transitionParams) + AndroidUtilities.dp(4.0f));
            f4 = this.textX;
            MessageObject messageObject4 = this.currentMessageObject;
            arrayList = messageObject4.textLayoutBlocks;
            f5 = messageObject4.textXOffset;
            z = false;
            z2 = false;
            z3 = true;
            f6 = 1.0f;
            z4 = true;
            chatMessageCell = this;
            f7 = f;
            canvas2 = canvas;
        } else {
            canvas.save();
            Theme.MessageDrawable messageDrawable = this.currentBackgroundDrawable;
            if (messageDrawable != null) {
                Rect bounds = messageDrawable.getBounds();
                if (!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.pinnedBottom) {
                    iDp3 = bounds.left + AndroidUtilities.dp(4.0f);
                    iDp4 = bounds.top + AndroidUtilities.dp(4.0f);
                    i = bounds.right;
                    iDp5 = AndroidUtilities.dp(4.0f);
                } else {
                    iDp3 = bounds.left + AndroidUtilities.dp(4.0f);
                    iDp4 = bounds.top + AndroidUtilities.dp(4.0f);
                    i = bounds.right;
                    iDp5 = AndroidUtilities.dp(10.0f);
                }
                canvas.clipRect(iDp3, iDp4, i - iDp5, bounds.bottom - AndroidUtilities.dp(4.0f));
            }
            z = false;
            z2 = false;
            z4 = true;
            f7 = f;
            canvas2 = canvas;
            drawMessageText(this.textX, f7, canvas2, this.transitionParams.animateOutTextBlocks, this.transitionParams.animateOutTextXOffset, false, 1.0f - this.transitionParams.animateChangeProgress, true, false, false);
            f4 = this.textX;
            MessageObject messageObject5 = this.currentMessageObject;
            arrayList = messageObject5.textLayoutBlocks;
            f5 = messageObject5.textXOffset;
            f6 = this.transitionParams.animateChangeProgress;
            z3 = true;
            chatMessageCell = this;
        }
        chatMessageCell.drawMessageText(f4, f7, canvas2, arrayList, f5, z3, f6, z4, z, z2);
        canvas.restore();
    }

    public void drawMessageText(Canvas canvas, ArrayList arrayList, boolean z, float f, boolean z2) {
        float f2;
        float f3 = this.textY;
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateText) {
            float f4 = transitionParams.animateFromTextY;
            float f5 = transitionParams.animateChangeProgress;
            f2 = (f4 * (1.0f - f5)) + (f3 * f5);
        } else {
            f2 = f3;
        }
        float f6 = this.textX;
        MessageObject messageObject = this.currentMessageObject;
        drawMessageText(f6, f2, canvas, arrayList, messageObject == null ? BitmapDescriptorFactory.HUE_RED : messageObject.textXOffset, z, f, false, z2, false);
    }

    /* JADX WARN: Removed duplicated region for block: B:104:0x0258  */
    /* JADX WARN: Removed duplicated region for block: B:115:0x028b  */
    /* JADX WARN: Removed duplicated region for block: B:117:0x0293  */
    /* JADX WARN: Removed duplicated region for block: B:118:0x0298  */
    /* JADX WARN: Removed duplicated region for block: B:149:0x0302  */
    /* JADX WARN: Removed duplicated region for block: B:150:0x0305  */
    /* JADX WARN: Removed duplicated region for block: B:153:0x0312  */
    /* JADX WARN: Removed duplicated region for block: B:155:0x0316  */
    /* JADX WARN: Removed duplicated region for block: B:157:0x031e  */
    /* JADX WARN: Removed duplicated region for block: B:158:0x0321  */
    /* JADX WARN: Removed duplicated region for block: B:161:0x032b  */
    /* JADX WARN: Removed duplicated region for block: B:164:0x0332  */
    /* JADX WARN: Removed duplicated region for block: B:345:0x0815  */
    /* JADX WARN: Removed duplicated region for block: B:503:0x0bef  */
    /* JADX WARN: Removed duplicated region for block: B:506:0x0bf3  */
    /* JADX WARN: Removed duplicated region for block: B:508:0x0c01  */
    /* JADX WARN: Removed duplicated region for block: B:552:0x0ce1  */
    /* JADX WARN: Removed duplicated region for block: B:558:0x0cf8  */
    /* JADX WARN: Removed duplicated region for block: B:561:0x0cfd  */
    /* JADX WARN: Removed duplicated region for block: B:573:0x0d53  */
    /* JADX WARN: Removed duplicated region for block: B:583:0x0db3  */
    /* JADX WARN: Removed duplicated region for block: B:586:0x0dba  */
    /* JADX WARN: Removed duplicated region for block: B:595:0x0df3  */
    /* JADX WARN: Removed duplicated region for block: B:611:0x0e79  */
    /* JADX WARN: Removed duplicated region for block: B:692:0x10e8  */
    /* JADX WARN: Removed duplicated region for block: B:715:0x1159  */
    /* JADX WARN: Removed duplicated region for block: B:779:0x12c9  */
    /* JADX WARN: Removed duplicated region for block: B:809:0x1378  */
    /* JADX WARN: Removed duplicated region for block: B:817:0x13a4  */
    /* JADX WARN: Removed duplicated region for block: B:825:0x13c3  */
    /* JADX WARN: Removed duplicated region for block: B:88:0x0216 A[PHI: r0
      0x0216: PHI (r0v60 float) = (r0v7 float), (r0v7 float), (r0v7 float), (r0v7 float), (r0v7 float), (r0v65 float) binds: [B:92:0x0237, B:94:0x023b, B:96:0x0243, B:98:0x0247, B:100:0x024b, B:87:0x0214] A[DONT_GENERATE, DONT_INLINE]] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawNamesLayout(Canvas canvas, float f) {
        int iSaveLayerAlpha;
        float f2;
        float f3;
        float f4;
        MessageObject.GroupedMessages groupedMessages;
        float f5;
        TextPaint textPaint;
        int i;
        TLRPC.User user;
        TypefaceSpan typefaceSpan;
        TypefaceSpan typefaceSpan2;
        float fLerp;
        long j;
        String str;
        float f6;
        int i2;
        float f7;
        int iDp;
        int i3;
        int iDp2;
        float fDp;
        float f8;
        float f9;
        String str2;
        float fDp2;
        boolean z;
        int i4;
        int themedColor;
        int i5;
        int saveCount;
        float f10;
        float f11;
        float backgroundDrawableRight;
        float f12;
        float f13;
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        int i6;
        float f14;
        float f15;
        float f16;
        CheckBoxBase checkBoxBase;
        MessageObject messageObject;
        TLRPC.Message message;
        StaticLayout staticLayout;
        ChatMessageCellDelegate chatMessageCellDelegate;
        MessageObject.GroupedMessagePosition groupedMessagePosition2;
        int colorId;
        TextPaint textPaint2;
        int color;
        TLRPC.MessageFwdHeader messageFwdHeader;
        int i7;
        int iDp3;
        int i8;
        boolean z2;
        ForwardBackground forwardBackground;
        int i9;
        ForwardBackground forwardBackground2;
        int color2;
        float f17;
        int iDp4;
        int iDp5;
        int iDp6;
        int iDp7;
        int alpha;
        int alpha2;
        float fDp3;
        float f18;
        MessageObject.GroupedMessages groupedMessages2;
        long jElapsedRealtime = SystemClock.elapsedRealtime();
        long j2 = jElapsedRealtime - this.lastNamesAnimationTime;
        if (j2 > 17) {
            j2 = 17;
        }
        this.lastNamesAnimationTime = jElapsedRealtime;
        if (!this.currentMessageObject.deleted || this.drawingToBitmap || (groupedMessages2 = this.currentMessagesGroup) == null || groupedMessages2.messages.size() < 1) {
            if (f != 1.0f) {
                this.rect.set(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, getMaxNameWidth(), getMeasuredHeight());
                iSaveLayerAlpha = canvas.saveLayerAlpha(this.rect, (int) (f * 255.0f), 31);
            } else {
                iSaveLayerAlpha = Integer.MIN_VALUE;
            }
            if (!this.isRoundVideo || this.hasLinkPreview) {
                f2 = 1.0f;
            } else {
                float videoTranscriptionProgress = (1.0f - getVideoTranscriptionProgress()) * 1.0f;
                TransitionParams transitionParams = this.transitionParams;
                if (transitionParams.animatePlayingRound) {
                    boolean z3 = this.isPlayingRound;
                    float f19 = transitionParams.animateChangeProgress;
                    if (z3) {
                        f19 = 1.0f - f19;
                    }
                    videoTranscriptionProgress *= f19;
                } else if (this.isPlayingRound) {
                    f2 = BitmapDescriptorFactory.HUE_RED;
                }
                f2 = videoTranscriptionProgress;
            }
            boolean z4 = this.drawNameLayout;
            if ((z4 || this.transitionParams.animateDrawNameLayout) && this.nameLayout != null) {
                TransitionParams transitionParams2 = this.transitionParams;
                float f20 = !transitionParams2.animateDrawNameLayout ? 1.0f : z4 ? transitionParams2.animateChangeProgress : 1.0f - transitionParams2.animateChangeProgress;
                canvas.save();
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    Theme.chat_namePaint.setColor(getThemedColor(Theme.key_chat_stickerNameText));
                    this.nameX = this.currentMessageObject.isOutOwner() ? AndroidUtilities.dp(28.0f) : this.backgroundDrawableLeft + this.transitionParams.deltaLeft + this.backgroundDrawableRight + AndroidUtilities.dp(22.0f);
                    f3 = f20;
                    if (this.currentNameBotVerificationId != 0) {
                        this.nameX += AndroidUtilities.dp(20.0f);
                    }
                    this.nameY = this.layoutHeight - AndroidUtilities.dp(38.0f);
                    float f21 = (this.currentMessageObject.isOut() && (this.checkBoxVisible || this.checkBoxAnimationInProgress)) ? 1.0f - this.checkBoxAnimationProgress : 1.0f;
                    this.rect.set(((int) this.nameX) - AndroidUtilities.dp(12.0f), ((int) this.nameY) - AndroidUtilities.dp(5.0f), ((int) this.nameX) + AndroidUtilities.dp(12.0f) + this.nameWidth, ((int) this.nameY) + AndroidUtilities.dp(22.0f));
                    applyServiceShaderMatrix();
                    int alpha3 = getThemedPaint("paintChatActionBackground").getAlpha();
                    getThemedPaint("paintChatActionBackground").setAlpha((int) (alpha3 * f21 * f2));
                    canvas.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), getThemedPaint("paintChatActionBackground"));
                    if (hasGradientService()) {
                        int alpha4 = Theme.chat_actionBackgroundGradientDarkenPaint.getAlpha();
                        Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha((int) (alpha4 * this.timeAlpha * f2));
                        canvas.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), Theme.chat_actionBackgroundGradientDarkenPaint);
                        Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha(alpha4);
                    }
                    if (this.viaSpan1 != null || this.viaSpan2 != null) {
                        int iAlpha = (((int) (Color.alpha(getThemedColor(r4)) * f21)) << 24) | (getThemedColor(Theme.key_chat_stickerViaBotNameText) & 16777215);
                        TypefaceSpan typefaceSpan3 = this.viaSpan1;
                        if (typefaceSpan3 != null) {
                            typefaceSpan3.setColor(iAlpha);
                        }
                        TypefaceSpan typefaceSpan4 = this.viaSpan2;
                        if (typefaceSpan4 != null) {
                            typefaceSpan4.setColor(iAlpha);
                        }
                    }
                    this.nameX -= this.nameOffsetX;
                    getThemedPaint("paintChatActionBackground").setAlpha(alpha3);
                } else {
                    f3 = f20;
                    if (this.mediaBackground || this.currentMessageObject.isOutOwner()) {
                        f4 = this.backgroundDrawableLeft + this.transitionParams.deltaLeft;
                        f5 = (!this.isSideMenuEnabled || this.currentPosition == null || this.currentMessageObject.isOutOwner() || (groupedMessages = this.currentMessagesGroup) == null || groupedMessages.isDocuments) ? 11.0f : -4.0f;
                        this.nameX = ((f4 + AndroidUtilities.dp(f5)) - this.nameOffsetX) + getExtraTextX();
                        if (this.currentNameBotVerificationId != 0) {
                            this.nameX += AndroidUtilities.dp(20.0f);
                        }
                        if (this.currentMessageObject.isOutOwner() || !ChatObject.isChannel(this.currentChat)) {
                            if (this.currentMessageObject.isOutOwner()) {
                                MessageObject messageObject2 = this.currentMessageObject;
                                if (messageObject2.overrideLinkColor >= 0 || ((messageObject2.isFromUser() && this.currentUser != null) || (this.currentMessageObject.isFromChannel() && this.currentChat != null))) {
                                    MessageObject messageObject3 = this.currentMessageObject;
                                    int colorId2 = messageObject3.overrideLinkColor;
                                    if (colorId2 < 0) {
                                        colorId2 = (!messageObject3.isFromUser() || (user = this.currentUser) == null) ? ChatObject.getColorId(this.currentChat) : UserObject.getColorId(user);
                                    }
                                    if (colorId2 < 7) {
                                        textPaint = Theme.chat_namePaint;
                                        i = Theme.keys_avatar_nameInMessage[colorId2];
                                    } else {
                                        MessagesController.PeerColors peerColors = MessagesController.getInstance(this.currentAccount).peerColors;
                                        MessagesController.PeerColor color3 = peerColors != null ? peerColors.getColor(colorId2) : null;
                                        if (color3 != null) {
                                            Theme.chat_namePaint.setColor(color3.getColor(0, this.resourcesProvider));
                                            this.nameY = AndroidUtilities.dp(!this.drawPinnedTop ? 9.0f : 10.0f);
                                            if (this.viaSpan1 == null || this.viaSpan2 != null) {
                                                int themedColor2 = getThemedColor(!this.currentMessageObject.isOutOwner() ? Theme.key_chat_outViaBotNameText : Theme.key_chat_inViaBotNameText);
                                                typefaceSpan = this.viaSpan1;
                                                if (typefaceSpan != null) {
                                                    typefaceSpan.setColor(themedColor2);
                                                }
                                                typefaceSpan2 = this.viaSpan2;
                                                if (typefaceSpan2 != null) {
                                                    typefaceSpan2.setColor(themedColor2);
                                                }
                                            }
                                        }
                                        textPaint = Theme.chat_namePaint;
                                        i = Theme.key_chat_inForwardedNameText;
                                    }
                                } else {
                                    textPaint = Theme.chat_namePaint;
                                    i = Theme.key_chat_inForwardedNameText;
                                }
                            } else {
                                textPaint = Theme.chat_namePaint;
                                i = Theme.key_chat_outForwardedNameText;
                            }
                            textPaint.setColor(getThemedColor(i));
                            this.nameY = AndroidUtilities.dp(!this.drawPinnedTop ? 9.0f : 10.0f);
                            if (this.viaSpan1 == null) {
                                int themedColor22 = getThemedColor(!this.currentMessageObject.isOutOwner() ? Theme.key_chat_outViaBotNameText : Theme.key_chat_inViaBotNameText);
                                typefaceSpan = this.viaSpan1;
                                if (typefaceSpan != null) {
                                }
                                typefaceSpan2 = this.viaSpan2;
                                if (typefaceSpan2 != null) {
                                }
                            }
                        } else {
                            Theme.MessageDrawable messageDrawable = this.currentBackgroundDrawable;
                            if (messageDrawable != null && messageDrawable.hasGradient()) {
                                textPaint = Theme.chat_namePaint;
                                i = Theme.key_chat_messageTextOut;
                            }
                            textPaint.setColor(getThemedColor(i));
                            this.nameY = AndroidUtilities.dp(!this.drawPinnedTop ? 9.0f : 10.0f);
                            if (this.viaSpan1 == null) {
                            }
                        }
                    } else {
                        f4 = this.backgroundDrawableLeft + this.transitionParams.deltaLeft;
                        if (this.mediaBackground || !this.drawPinnedBottom) {
                            f5 = 17.0f;
                        }
                        this.nameX = ((f4 + AndroidUtilities.dp(f5)) - this.nameOffsetX) + getExtraTextX();
                        if (this.currentNameBotVerificationId != 0) {
                        }
                        if (this.currentMessageObject.isOutOwner()) {
                            if (this.currentMessageObject.isOutOwner()) {
                            }
                            textPaint.setColor(getThemedColor(i));
                            this.nameY = AndroidUtilities.dp(!this.drawPinnedTop ? 9.0f : 10.0f);
                            if (this.viaSpan1 == null) {
                            }
                        }
                    }
                }
                MessageObject.GroupedMessages groupedMessages3 = this.currentMessagesGroup;
                if (groupedMessages3 != null) {
                    MessageObject.GroupedMessages.TransitionParams transitionParams3 = groupedMessages3.transitionParams;
                    if (transitionParams3.backgroundChangeBounds) {
                        this.nameX += transitionParams3.offsetLeft;
                        this.nameY += transitionParams3.offsetTop - getTranslationY();
                    }
                }
                this.nameX += this.animationOffsetX;
                float f22 = this.nameY;
                TransitionParams transitionParams4 = this.transitionParams;
                this.nameY = f22 + transitionParams4.deltaTop;
                float f23 = transitionParams4.animateSign ? this.transitionParams.animateNameX + ((this.nameX - this.transitionParams.animateNameX) * this.transitionParams.animateChangeProgress) : this.nameX;
                float f24 = this.nameY;
                TransitionParams transitionParams5 = this.transitionParams;
                if (transitionParams5.animateDrawAvatar) {
                    boolean z5 = this.drawNameAvatar;
                    fLerp = AndroidUtilities.lerp(!z5, z5, transitionParams5.animateChangeProgress);
                } else {
                    fLerp = this.drawNameAvatar ? 1.0f : BitmapDescriptorFactory.HUE_RED;
                }
                if (fLerp > BitmapDescriptorFactory.HUE_RED) {
                    float fDp4 = this.currentNameBotVerificationId != 0 ? f23 - AndroidUtilities.dp(20.0f) : f23;
                    float imageX = this.avatarImage.getImageX();
                    float imageY = this.avatarImage.getImageY();
                    float imageWidth = this.avatarImage.getImageWidth();
                    float imageHeight = this.avatarImage.getImageHeight();
                    float alpha5 = this.avatarImage.getAlpha();
                    i2 = iSaveLayerAlpha;
                    float fLerp2 = AndroidUtilities.lerp(0.1f, 1.0f, fLerp);
                    boolean visible = this.avatarImage.getVisible();
                    j = j2;
                    this.avatarImage.setVisible(true, false);
                    str = "paintChatActionBackground";
                    f7 = f2;
                    f6 = f3;
                    this.avatarImage.setImageCoords(fDp4, (AndroidUtilities.dp(13.0f) * (1.0f - fLerp2)) + f24, AndroidUtilities.dp(26.0f) * fLerp2, AndroidUtilities.dp(26.0f) * fLerp2);
                    this.avatarImage.setAlpha(fLerp);
                    this.avatarImage.draw(canvas);
                    this.avatarImage.setImageCoords(imageX, imageY, imageWidth, imageHeight);
                    this.avatarImage.setAlpha(alpha5);
                    this.avatarImage.setVisible(visible, false);
                } else {
                    j = j2;
                    str = "paintChatActionBackground";
                    f6 = f3;
                    i2 = iSaveLayerAlpha;
                    f7 = f2;
                }
                float fDp5 = f23 + (AndroidUtilities.dp(32.33f) * fLerp);
                float fDp6 = this.adminLayout == null ? f24 + (AndroidUtilities.dp(5.0f) * fLerp) : f24 - (AndroidUtilities.dp(2.33f) * fLerp);
                if (!this.currentMessageObject.isSponsored()) {
                    int iMultAlpha = Theme.multAlpha(Theme.chat_namePaint.getColor(), 0.12f);
                    Drawable drawable = this.nameLayoutSelector;
                    if (drawable == null) {
                        this.nameLayoutSelectorColor = iMultAlpha;
                        Drawable drawableCreateRadSelectorDrawable = Theme.createRadSelectorDrawable(iMultAlpha, 6, 6);
                        this.nameLayoutSelector = drawableCreateRadSelectorDrawable;
                        drawableCreateRadSelectorDrawable.setCallback(this);
                    } else if (this.nameLayoutSelectorColor != iMultAlpha) {
                        this.nameLayoutSelectorColor = iMultAlpha;
                        Theme.setSelectorDrawableColor(drawable, iMultAlpha, true);
                    }
                    this.nameLayoutSelector.setBounds((int) ((this.nameOffsetX + fDp5) - AndroidUtilities.dp(4.0f)), (int) (fDp6 - AndroidUtilities.dp(1.33f)), (int) (this.nameOffsetX + fDp5 + (this.viaNameWidth > 0 ? r9 - AndroidUtilities.dp(32.0f) : this.nameLayoutWidth) + AndroidUtilities.dp(4.0f)), (int) (this.nameLayout.getHeight() + fDp6 + AndroidUtilities.dp(1.33f)));
                    int i10 = (int) (f6 * 255.0f);
                    this.nameLayoutSelector.setAlpha(i10);
                    this.nameLayoutSelector.draw(canvas);
                    if (this.currentNameStatus != null) {
                        Drawable drawable2 = this.nameStatusSelector;
                        if (drawable2 == null) {
                            this.nameStatusSelectorColor = iMultAlpha;
                            Drawable drawableCreateRadSelectorDrawable2 = Theme.createRadSelectorDrawable(iMultAlpha, 6, 6);
                            this.nameStatusSelector = drawableCreateRadSelectorDrawable2;
                            drawableCreateRadSelectorDrawable2.setCallback(this);
                        } else if (this.nameStatusSelectorColor != iMultAlpha) {
                            this.nameStatusSelectorColor = iMultAlpha;
                            Theme.setSelectorDrawableColor(drawable2, iMultAlpha, true);
                        }
                        boolean z6 = this.currentNameStatus instanceof Drawable;
                        float f25 = z6 ? 1.5f : BitmapDescriptorFactory.HUE_RED;
                        float f26 = z6 ? -5.0f : BitmapDescriptorFactory.HUE_RED;
                        Drawable drawable3 = this.nameStatusSelector;
                        int iDp8 = (int) (this.nameOffsetX + fDp5 + (this.viaNameWidth > 0 ? r9 - AndroidUtilities.dp(32.0f) : this.nameLayoutWidth));
                        float f27 = 3.33f - f25;
                        drawable3.setBounds(iDp8, (int) (fDp6 - AndroidUtilities.dp(f27)), (int) (this.nameOffsetX + fDp5 + (this.viaNameWidth > 0 ? r13 - AndroidUtilities.dp(32.0f) : this.nameLayoutWidth) + AndroidUtilities.dp(f26 + 24.0f)), (int) (this.nameLayout.getHeight() + fDp6 + AndroidUtilities.dp(f27)));
                        this.nameStatusSelector.setAlpha(i10);
                        this.nameStatusSelector.draw(canvas);
                    }
                }
                canvas.translate(fDp5, fDp6);
                int alpha6 = Theme.chat_namePaint.getAlpha();
                Theme.chat_namePaint.setAlpha((int) (alpha6 * f6));
                this.nameLayout.draw(canvas);
                Theme.chat_namePaint.setAlpha(alpha6);
                canvas.restore();
                MessageObject.GroupedMessages groupedMessages4 = this.currentMessagesGroup;
                if (groupedMessages4 == null || groupedMessages4.isDocuments) {
                    if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                        if (this.currentMessageObject.isOutOwner()) {
                            iDp = AndroidUtilities.dp(39.0f);
                            i3 = this.nameWidth;
                        } else {
                            fDp = this.backgroundDrawableLeft + this.transitionParams.deltaLeft + this.backgroundDrawableRight + AndroidUtilities.dp(33.0f) + this.nameWidth;
                        }
                    } else if (this.mediaBackground || !this.currentMessageObject.isOutOwner()) {
                        iDp = this.backgroundDrawableLeft;
                        i3 = this.backgroundDrawableRight;
                    } else {
                        iDp2 = (this.backgroundDrawableLeft + this.backgroundDrawableRight) - AndroidUtilities.dp(6.0f);
                        fDp = iDp2;
                    }
                    iDp2 = iDp + i3;
                    fDp = iDp2;
                } else {
                    int groupPhotosWidth = getGroupPhotosWidth();
                    int i11 = 0;
                    for (int i12 = 0; i12 < this.currentMessagesGroup.posArray.size(); i12++) {
                        if (this.currentMessagesGroup.posArray.get(i12).minY != 0) {
                            break;
                        }
                        double d = i11;
                        double dCeil = Math.ceil(((r5.pw + r5.leftSpanOffset) / 1000.0f) * groupPhotosWidth);
                        Double.isNaN(d);
                        i11 = (int) (d + dCeil);
                    }
                    fDp = ((this.mediaBackground || !this.currentMessageObject.isOutOwner()) ? this.backgroundDrawableLeft + i11 : (this.backgroundDrawableLeft + i11) - AndroidUtilities.dp(6.0f)) - (getExtraTextX() + AndroidUtilities.dp(8.0f));
                    if (!this.isSideMenuEnabled) {
                        f8 = this.currentMessageObject.isOutOwner() ? 64.0f : 48.0f;
                    }
                    fDp -= AndroidUtilities.dp(f8);
                }
                float f28 = fDp + this.transitionParams.deltaRight;
                if (this.adminLayout != null) {
                    Theme.chat_adminPaint.setColor(getThemedColor(this.currentMessageObject.shouldDrawWithoutBackground() ? Theme.key_chat_stickerReplyNameText : this.currentMessageObject.isOutOwner() ? isDrawSelectionBackground() ? Theme.key_chat_outAdminSelectedText : Theme.key_chat_outAdminText : isDrawSelectionBackground() ? Theme.key_chat_inAdminSelectedText : Theme.key_chat_inAdminText));
                    canvas.save();
                    float fDp7 = (f28 - AndroidUtilities.dp(11.0f)) - this.adminLayout.getLineWidth(0);
                    float fDp8 = this.nameY + AndroidUtilities.dp(0.5f);
                    float fLerp3 = AndroidUtilities.lerp(fDp7, fDp5, fLerp);
                    float fDp9 = fDp8 + (AndroidUtilities.dp(14.0f) * fLerp);
                    if (this.currentNameBotVerificationId != 0) {
                        fLerp3 -= AndroidUtilities.dp(20.0f) * fLerp;
                    }
                    if (this.boostCounterSpan != null && this.boostCounterBounds != null) {
                        float lineWidth = (((this.adminLayout.getLineWidth(0) + fLerp3) + AndroidUtilities.dp(11.0f)) - AndroidUtilities.dp(this.boostCounterSpan.isRtl ? 5.0f : 7.5f)) - this.boostCounterSpan.getWidth();
                        this.boostCounterBounds.set(lineWidth, fDp9, this.boostCounterSpan.getWidth() + lineWidth, this.adminLayout.getHeight() + fDp9);
                        int iMultAlpha2 = Theme.multAlpha(Theme.chat_namePaint.getColor(), 0.12f);
                        Drawable drawable4 = this.boostCounterLayoutSelector;
                        if (drawable4 == null) {
                            this.boostCounterSelectorColor = iMultAlpha2;
                            Drawable drawableCreateRadSelectorDrawable3 = Theme.createRadSelectorDrawable(iMultAlpha2, 6, 6);
                            this.boostCounterLayoutSelector = drawableCreateRadSelectorDrawable3;
                            drawableCreateRadSelectorDrawable3.setCallback(this);
                        } else if (this.boostCounterSelectorColor != iMultAlpha2) {
                            this.boostCounterSelectorColor = iMultAlpha2;
                            Theme.setSelectorDrawableColor(drawable4, iMultAlpha2, true);
                        }
                        Drawable drawable5 = this.boostCounterLayoutSelector;
                        int iDp9 = ((int) this.boostCounterBounds.left) - AndroidUtilities.dp(4.0f);
                        RectF rectF = this.boostCounterBounds;
                        drawable5.setBounds(iDp9, (int) rectF.top, (int) rectF.right, (int) rectF.bottom);
                        this.boostCounterLayoutSelector.setAlpha((int) (f6 * 255.0f));
                        this.boostCounterLayoutSelector.draw(canvas);
                    }
                    canvas.translate(fLerp3, fDp9);
                    if (this.transitionParams.animateSign) {
                        Theme.chat_adminPaint.setAlpha((int) (Color.alpha(r2) * this.transitionParams.animateChangeProgress));
                    }
                    this.adminLayout.draw(canvas);
                    canvas.restore();
                }
            } else {
                j = j2;
                str = "paintChatActionBackground";
                i2 = iSaveLayerAlpha;
                f7 = f2;
            }
            boolean z7 = this.drawForwardedName || this.currentMessageObject.type == 23;
            boolean z8 = this.replyNameLayout != null;
            StaticLayout[] staticLayoutArr = this.forwardedNameLayout;
            int i13 = this.forwardedNameWidth;
            if (!this.transitionParams.animateForwardedLayout) {
                f9 = 1.0f;
            } else if (this.currentMessageObject.needDrawForwarded()) {
                f9 = this.transitionParams.animateChangeProgress;
            } else {
                TransitionParams transitionParams6 = this.transitionParams;
                staticLayoutArr = transitionParams6.animatingForwardedNameLayout;
                f9 = 1.0f - transitionParams6.animateChangeProgress;
                i13 = transitionParams6.animateForwardNameWidth;
                z7 = true;
            }
            if (!z7 || staticLayoutArr[0] == null || staticLayoutArr[1] == null || !((groupedMessagePosition2 = this.currentPosition) == null || (groupedMessagePosition2.minY == 0 && groupedMessagePosition2.minX == 0))) {
                str2 = str;
                fDp2 = BitmapDescriptorFactory.HUE_RED;
                z = true;
                i4 = -1;
            } else if (!this.isSideMenued) {
                MessageObject messageObject4 = this.currentMessageObject;
                if (messageObject4.type == 5 || messageObject4.isAnyKindOfSticker()) {
                    Theme.chat_forwardNamePaint.setColor(getThemedColor(Theme.key_chat_stickerReplyNameText));
                    MessageObject messageObject5 = this.currentMessageObject;
                    if (messageObject5.type == 19) {
                        if (messageObject5.isOutOwner()) {
                            if (this.currentMessageObject.needDrawForwarded()) {
                                float fDp10 = this.backgroundDrawableLeft + AndroidUtilities.dp(11.0f) + getExtraTextX();
                                this.forwardNameX = fDp10;
                                f18 = fDp10 + this.transitionParams.deltaLeft;
                            } else {
                                f18 = this.transitionParams.animateForwardNameX;
                            }
                            fDp3 = f18 - Math.max(BitmapDescriptorFactory.HUE_RED, (Math.max(AndroidUtilities.dp(14.0f) + i13, z8 ? Math.max(this.replyNameWidth, this.replyTextWidth) + AndroidUtilities.dp(14.0f) : 0) + f18) - AndroidUtilities.displaySize.x);
                        } else if (this.currentMessageObject.needDrawForwarded()) {
                            fDp3 = this.backgroundDrawableLeft + AndroidUtilities.dp((this.mediaBackground || this.drawPinnedBottom) ? 11.0f : 17.0f) + getExtraTextX();
                            this.forwardNameX = fDp3;
                        } else {
                            fDp3 = this.transitionParams.animateForwardNameX;
                        }
                        fDp2 = fDp3 - AndroidUtilities.dp(7.0f);
                    } else if (messageObject5.needDrawForwarded()) {
                        fDp2 = this.currentMessageObject.isOutOwner() ? AndroidUtilities.dp(23.0f) : this.backgroundDrawableLeft + this.backgroundDrawableRight + AndroidUtilities.dp(17.0f);
                        this.forwardNameX = fDp2;
                    } else {
                        fDp2 = this.transitionParams.animateForwardNameX;
                    }
                    if (!this.currentMessageObject.isVoiceTranscriptionOpen() && ((this.currentMessageObject.isOutOwner() && this.currentMessageObject.type == 5 && this.transitionParams.animatePlayingRound) || this.isPlayingRound)) {
                        fDp2 -= AndroidUtilities.dp(78.0f) * (this.isPlayingRound ? this.transitionParams.animateChangeProgress : 1.0f - this.transitionParams.animateChangeProgress);
                    }
                    this.forwardNameY = AndroidUtilities.dp(12.0f);
                    this.forwardHeight = AndroidUtilities.dp(4.0f) + (((int) Theme.chat_forwardNamePaint.getTextSize()) * 2);
                    int iDp10 = i13 + AndroidUtilities.dp(14.0f);
                    if (z8) {
                        int iMax = (Math.max(this.replyNameWidth, this.replyTextWidth) - AndroidUtilities.dp(4.0f)) + AndroidUtilities.dp(7.0f);
                        RectF rectF2 = this.rect;
                        int i14 = (int) fDp2;
                        float fDp11 = i14 - AndroidUtilities.dp(7.0f);
                        float fDp12 = this.forwardNameY - AndroidUtilities.dp(6.0f);
                        int iMax2 = Math.max(iDp10, iMax) + (i14 - AndroidUtilities.dp(7.0f));
                        rectF2.set(fDp11, fDp12, iMax2, this.forwardNameY + this.forwardHeight + AndroidUtilities.dp(6.0f) + this.replyHeight + AndroidUtilities.dp(3.0f));
                        i4 = iMax2;
                        z = false;
                    } else {
                        int i15 = (int) fDp2;
                        this.rect.set(i15 - AndroidUtilities.dp(7.0f), this.forwardNameY - AndroidUtilities.dp(6.0f), (i15 - AndroidUtilities.dp(7.0f)) + iDp10, this.forwardNameY + this.forwardHeight + AndroidUtilities.dp(6.0f));
                        z = true;
                        i4 = -1;
                    }
                    if (z8 || this.forwardBg == null) {
                        str2 = str;
                        applyServiceShaderMatrix(getMeasuredWidth(), this.backgroundHeight, getX(), this.viewTop);
                        if (f9 == 1.0f && f7 == 1.0f) {
                            alpha = -1;
                        } else {
                            alpha = getThemedPaint(str2).getAlpha();
                            getThemedPaint(str2).setAlpha((int) (alpha * f9 * f7));
                        }
                        canvas.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), getThemedPaint(str2));
                        if (hasGradientService()) {
                            if (f9 == 1.0f && f7 == 1.0f) {
                                alpha2 = -1;
                            } else {
                                alpha2 = Theme.chat_actionBackgroundGradientDarkenPaint.getAlpha();
                                Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha((int) (alpha2 * f9 * f7));
                            }
                            canvas.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), Theme.chat_actionBackgroundGradientDarkenPaint);
                        } else {
                            alpha2 = -1;
                        }
                    } else {
                        applyServiceShaderMatrix(getMeasuredWidth(), this.backgroundHeight, getX() + fDp2, this.viewTop + this.forwardNameY);
                        canvas.save();
                        canvas.translate(fDp2, this.forwardNameY);
                        float scale = this.forwardBg.bounce.getScale(0.02f);
                        canvas.scale(scale, scale, this.forwardBg.bounds.centerX(), this.forwardBg.bounds.centerY());
                        if (f9 == 1.0f && f7 == 1.0f) {
                            str2 = str;
                            alpha = -1;
                        } else {
                            str2 = str;
                            alpha = getThemedPaint(str2).getAlpha();
                            getThemedPaint(str2).setAlpha((int) (alpha * f9 * f7));
                        }
                        canvas.drawPath(this.forwardBg.path, getThemedPaint(str2));
                        if (hasGradientService()) {
                            if (f9 == 1.0f && f7 == 1.0f) {
                                alpha2 = -1;
                            } else {
                                alpha2 = Theme.chat_actionBackgroundGradientDarkenPaint.getAlpha();
                                Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha((int) (alpha2 * f9 * f7));
                            }
                            canvas.drawPath(this.forwardBg.path, Theme.chat_actionBackgroundGradientDarkenPaint);
                        } else {
                            alpha2 = -1;
                        }
                        canvas.restore();
                    }
                    if (alpha >= 0) {
                        getThemedPaint(str2).setAlpha(alpha);
                    }
                    if (alpha2 >= 0) {
                        Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha(alpha2);
                    }
                } else {
                    str2 = str;
                    int iDp11 = AndroidUtilities.dp(7.0f) + ((int) (this.drawNameLayout ? getNameHeightAnimated() + AndroidUtilities.dp(1.0f) : BitmapDescriptorFactory.HUE_RED));
                    this.forwardNameY = iDp11;
                    if (!this.drawNameLayout && ((i8 = this.currentMessageObject.type) == 8 || i8 == 1 || i8 == 3 || i8 == 23 || i8 == 29 || i8 == 9)) {
                        this.forwardNameY = iDp11 + AndroidUtilities.dp(2.0f);
                    }
                    if (!this.drawNameLayout && this.currentMessageObject.type == 0 && !this.drawPinnedTop) {
                        this.forwardNameY += AndroidUtilities.dp(2.0f);
                    }
                    this.forwardHeight = AndroidUtilities.dp(4.0f) + (((int) Theme.chat_forwardNamePaint.getTextSize()) * 2);
                    Theme.chat_forwardNamePaint.setColor(getThemedColor(this.hasPsaHint ? Theme.key_chat_inPsaNameText : Theme.key_chat_inForwardedNameText));
                    if (this.currentMessageObject.isOutOwner()) {
                        Theme.chat_forwardNamePaint.setColor(getThemedColor(this.hasPsaHint ? Theme.key_chat_outPsaNameText : Theme.key_chat_outForwardedNameText));
                    } else if (!this.hasPsaHint) {
                        MessageObject messageObject6 = this.currentMessageObject;
                        if (messageObject6.messageOwner != null && (messageObject6.isStoryMedia() || ((messageFwdHeader = this.currentMessageObject.messageOwner.fwd_from) != null && messageFwdHeader.from_id != null))) {
                            long peerDialogId = DialogObject.getPeerDialogId(this.currentMessageObject.isStoryMedia() ? MessageObject.getMedia(this.currentMessageObject).peer : this.currentMessageObject.messageOwner.fwd_from.from_id);
                            if (peerDialogId < 0) {
                                TLRPC.Chat chat = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(-peerDialogId));
                                colorId = chat != null ? ChatObject.getColorId(chat) : 5;
                                if (colorId >= 7) {
                                    textPaint2 = Theme.chat_forwardNamePaint;
                                    color = getThemedColor(Theme.keys_avatar_nameInMessage[colorId]);
                                } else {
                                    MessagesController.PeerColors peerColors2 = MessagesController.getInstance(this.currentAccount).peerColors;
                                    MessagesController.PeerColor color4 = peerColors2 != null ? peerColors2.getColor(colorId) : null;
                                    if (color4 != null) {
                                        textPaint2 = Theme.chat_forwardNamePaint;
                                        color = color4.getColor(0, this.resourcesProvider);
                                    }
                                }
                                textPaint2.setColor(color);
                            } else {
                                TLRPC.User user2 = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(peerDialogId));
                                if (user2 != null) {
                                    colorId = UserObject.getColorId(user2);
                                }
                                if (colorId >= 7) {
                                }
                                textPaint2.setColor(color);
                            }
                        }
                    }
                    if (this.currentMessageObject.isOutOwner()) {
                        if (this.currentMessageObject.needDrawForwarded()) {
                            i7 = this.backgroundDrawableLeft;
                            iDp3 = AndroidUtilities.dp(10.0f);
                            float extraTextX = i7 + iDp3 + getExtraTextX();
                            this.forwardNameX = extraTextX;
                            fDp2 = extraTextX + this.transitionParams.deltaLeft;
                        }
                        fDp2 = this.transitionParams.animateForwardNameX;
                    } else {
                        if (this.currentMessageObject.needDrawForwarded()) {
                            i7 = this.backgroundDrawableLeft;
                            iDp3 = AndroidUtilities.dp((this.mediaBackground || this.drawPinnedBottom) ? 10.0f : 16.0f);
                            float extraTextX2 = i7 + iDp3 + getExtraTextX();
                            this.forwardNameX = extraTextX2;
                            fDp2 = extraTextX2 + this.transitionParams.deltaLeft;
                        }
                        fDp2 = this.transitionParams.animateForwardNameX;
                    }
                    z = true;
                    i4 = -1;
                }
                if (this.transitionParams.animateForwardedLayout && this.currentBackgroundDrawable != null && this.currentMessagesGroup == null) {
                    MessageObject messageObject7 = this.currentMessageObject;
                    if (messageObject7.type != 5 && !messageObject7.isAnyKindOfSticker()) {
                        Rect bounds = this.currentBackgroundDrawable.getBounds();
                        canvas.save();
                        if (!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.pinnedBottom) {
                            iDp4 = bounds.left + AndroidUtilities.dp(4.0f);
                            iDp5 = bounds.top + AndroidUtilities.dp(4.0f);
                            iDp6 = bounds.right - AndroidUtilities.dp(4.0f);
                            iDp7 = bounds.bottom - AndroidUtilities.dp(4.0f);
                        } else {
                            iDp4 = bounds.left + AndroidUtilities.dp(4.0f);
                            iDp5 = bounds.top + AndroidUtilities.dp(4.0f);
                            iDp6 = bounds.right - AndroidUtilities.dp(10.0f);
                            iDp7 = bounds.bottom - AndroidUtilities.dp(4.0f);
                        }
                        canvas.clipRect(iDp4, iDp5, iDp6, iDp7);
                        z2 = true;
                    }
                    canvas.save();
                    canvas.translate(fDp2, this.forwardNameY);
                    ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
                    if (chatMessageCellDelegate2 == null) {
                        forwardBackground = this.forwardBg;
                        if (forwardBackground != null) {
                        }
                        while (i9 < 2) {
                        }
                        canvas.restore();
                        if (z2) {
                        }
                        if (this.hasPsaHint) {
                        }
                    }
                } else {
                    z2 = false;
                    canvas.save();
                    canvas.translate(fDp2, this.forwardNameY);
                    ChatMessageCellDelegate chatMessageCellDelegate22 = this.delegate;
                    boolean z9 = chatMessageCellDelegate22 == null && chatMessageCellDelegate22.isProgressLoading(this, 6);
                    forwardBackground = this.forwardBg;
                    if (forwardBackground != null) {
                        float scale2 = forwardBackground.bounce.getScale(0.02f);
                        canvas.scale(scale2, scale2, this.forwardBg.bounds.centerX(), this.forwardBg.bounds.centerY());
                        MessageObject messageObject8 = this.currentMessageObject;
                        if (messageObject8.type == 5 || messageObject8.isAnyKindOfSticker()) {
                            forwardBackground2 = this.forwardBg;
                            color2 = Theme.getColor(Theme.key_listSelector, this.resourcesProvider);
                            f17 = 1.35f;
                        } else {
                            forwardBackground2 = this.forwardBg;
                            color2 = Theme.chat_forwardNamePaint.getColor();
                            f17 = 0.15f;
                        }
                        forwardBackground2.setColor(Theme.multAlpha(color2, f17));
                        this.forwardBg.draw(canvas, z9);
                    }
                    for (i9 = 0; i9 < 2; i9++) {
                        canvas.save();
                        canvas.translate(-this.forwardNameOffsetX[i9], ((this.forwardHeight / 2.0f) + AndroidUtilities.dp(1.33f)) * i9);
                        if (f9 == 1.0f && f7 == 1.0f) {
                            staticLayoutArr[i9].draw(canvas);
                        } else {
                            int alpha7 = staticLayoutArr[i9].getPaint().getAlpha();
                            staticLayoutArr[i9].getPaint().setAlpha((int) (alpha7 * f9 * f7));
                            staticLayoutArr[i9].draw(canvas);
                            staticLayoutArr[i9].getPaint().setAlpha(alpha7);
                        }
                        canvas.restore();
                    }
                    canvas.restore();
                    if (z2) {
                        canvas.restore();
                    }
                    if (this.hasPsaHint) {
                        if (this.psaButtonVisible || this.psaButtonProgress > BitmapDescriptorFactory.HUE_RED) {
                            Drawable drawable6 = Theme.chat_psaHelpDrawable[this.currentMessageObject.isOutOwner() ? 1 : 0];
                            int intrinsicWidth = this.psaHelpX + (drawable6.getIntrinsicWidth() / 2);
                            int intrinsicHeight = this.psaHelpY + (drawable6.getIntrinsicHeight() / 2);
                            if (this.psaButtonVisible) {
                                float f29 = this.psaButtonProgress;
                                float interpolation = f29 < 1.0f ? AnimationProperties.overshootInterpolator.getInterpolation(f29) : this.psaButtonProgress;
                                int intrinsicWidth2 = ((int) (drawable6.getIntrinsicWidth() * interpolation)) / 2;
                                int intrinsicHeight2 = ((int) (drawable6.getIntrinsicHeight() * interpolation)) / 2;
                                drawable6.setBounds(intrinsicWidth - intrinsicWidth2, intrinsicHeight - intrinsicHeight2, intrinsicWidth + intrinsicWidth2, intrinsicHeight + intrinsicHeight2);
                                drawable6.draw(canvas);
                                if (Build.VERSION.SDK_INT >= 21 && this.selectorDrawable[0] != null && this.selectorDrawableMaskType[0] == 3) {
                                    canvas.save();
                                    float f30 = this.psaButtonProgress;
                                    canvas.scale(f30, f30, this.selectorDrawable[0].getBounds().centerX(), this.selectorDrawable[0].getBounds().centerY());
                                    this.selectorDrawable[0].draw(canvas);
                                    canvas.restore();
                                }
                            }
                        }
                        boolean z10 = this.psaButtonVisible;
                        if (z10) {
                            float f31 = this.psaButtonProgress;
                            if (f31 < 1.0f) {
                                this.psaButtonProgress = f31 + (j / 180.0f);
                                invalidate();
                                if (this.psaButtonProgress > 1.0f) {
                                    this.psaButtonProgress = 1.0f;
                                    setInvalidatesParent(false);
                                }
                            } else {
                                long j3 = j;
                                if (!z10) {
                                    float f32 = this.psaButtonProgress;
                                    if (f32 > BitmapDescriptorFactory.HUE_RED) {
                                        this.psaButtonProgress = f32 - (j3 / 180.0f);
                                        invalidate();
                                        if (this.psaButtonProgress < BitmapDescriptorFactory.HUE_RED) {
                                            this.psaButtonProgress = BitmapDescriptorFactory.HUE_RED;
                                            setInvalidatesParent(false);
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if (z8) {
                float f33 = this.replyStartX;
                float fLerp4 = this.replyStartY;
                MessageObject.GroupedMessages groupedMessages5 = this.currentMessagesGroup;
                if (groupedMessages5 != null) {
                    MessageObject.GroupedMessages.TransitionParams transitionParams7 = groupedMessages5.transitionParams;
                    if (transitionParams7.backgroundChangeBounds) {
                        f33 += transitionParams7.offsetLeft;
                    }
                }
                TransitionParams transitionParams8 = this.transitionParams;
                if (transitionParams8.animateBackgroundBoundsInner) {
                    f33 += this.isRoundVideo ? (this.currentMessageObject.isOutOwner() ? BitmapDescriptorFactory.HUE_RED : this.transitionParams.deltaLeft) + this.transitionParams.deltaRight : transitionParams8.deltaLeft;
                    TransitionParams transitionParams9 = this.transitionParams;
                    fLerp4 = AndroidUtilities.lerp(transitionParams9.animateFromReplyY, this.replyStartY, transitionParams9.animateChangeProgress);
                }
                float f34 = fLerp4;
                float f35 = !z ? fDp2 : f33;
                boolean z11 = (this.currentMessageObject == null || (chatMessageCellDelegate = this.delegate) == null || !chatMessageCellDelegate.isProgressLoading(this, 0)) ? false : true;
                if (this.replyPressedFloat == null) {
                    this.replyPressedFloat = new AnimatedFloat(this);
                }
                float f36 = this.replyPressedFloat.set((this.replySelectorPressed || z11) ? 1.0f : BitmapDescriptorFactory.HUE_RED);
                if (this.replyLine == null) {
                    this.replyLine = new ReplyMessageLine(this);
                }
                Theme.chat_replyNamePaint.setColor(this.replyLine.check(this.currentMessageObject, this.currentUser, this.currentChat, this.resourcesProvider, 0));
                int alphaComponent = ColorUtils.setAlphaComponent(this.replyLine.getColor(), 30);
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    Theme.chat_replyLinePaint.setColor(getThemedColor(Theme.key_chat_stickerReplyLine));
                    Theme.chat_replyLinePaint.setAlpha((int) (Theme.chat_replyLinePaint.getAlpha() * this.timeAlpha * f7));
                    alphaComponent = ColorUtils.setAlphaComponent(Theme.chat_replyLinePaint.getColor(), Color.alpha(alphaComponent));
                    Theme.chat_replyNamePaint.setColor(getThemedColor(Theme.key_chat_stickerReplyNameText));
                    Theme.chat_replyNamePaint.setAlpha((int) (Theme.chat_replyNamePaint.getAlpha() * this.timeAlpha * f7));
                    TextPaint textPaint3 = Theme.chat_replyTextPaint;
                    int i16 = Theme.key_chat_stickerReplyMessageText;
                    textPaint3.setColor(getThemedColor(i16));
                    Theme.chat_replyTextPaint.linkColor = getThemedColor(i16);
                    Theme.chat_replyTextPaint.setAlpha((int) (Theme.chat_replyTextPaint.getAlpha() * this.timeAlpha * f7));
                    if (z) {
                        if (this.replyBounce == null) {
                            this.replyBounce = new ButtonBounce(this, 2.0f, 2.0f);
                        }
                        canvas.save();
                        float scale3 = this.replyBounce.getScale(0.0125f);
                        int i17 = (int) f35;
                        this.rect.set(i17 - AndroidUtilities.dp(7.0f), f34 - AndroidUtilities.dp(3.0f), (i17 - AndroidUtilities.dp(4.0f)) + Math.max(this.replyNameWidth, this.replyTextWidth), AndroidUtilities.dp(3.0f) + f34 + this.replyHeight);
                        float f37 = this.replyBounceX;
                        RectF rectF3 = this.rect;
                        float fClamp = Utilities.clamp(f37, rectF3.right, rectF3.left);
                        float f38 = this.replyBounceY;
                        RectF rectF4 = this.rect;
                        canvas.scale(scale3, scale3, fClamp, Utilities.clamp(f38, rectF4.bottom, rectF4.top));
                        applyServiceShaderMatrix();
                        int alpha8 = getThemedPaint(str2).getAlpha();
                        getThemedPaint(str2).setAlpha((int) (alpha8 * this.timeAlpha * f7));
                        canvas.drawRoundRect(this.rect, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), getThemedPaint(str2));
                        getThemedPaint(str2).setAlpha(alpha8);
                        if (hasGradientService()) {
                            int alpha9 = Theme.chat_actionBackgroundGradientDarkenPaint.getAlpha();
                            Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha((int) (alpha9 * this.timeAlpha * f7));
                            canvas.drawRoundRect(this.rect, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), Theme.chat_actionBackgroundGradientDarkenPaint);
                            Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha(alpha9);
                        }
                        canvas.restore();
                    }
                } else if (this.currentMessageObject.isOutOwner()) {
                    if (!this.currentMessageObject.isReplyToStory()) {
                        themedColor = getThemedColor(Theme.key_chat_outReplyMessageText);
                        MessageObject messageObject9 = this.currentMessageObject;
                        if (!messageObject9.forceAvatar) {
                            if (messageObject9.hasValidReplyMessageObject()) {
                                MessageObject messageObject10 = this.currentMessageObject.replyMessageObject;
                                if (((messageObject10.contentType == 1 || messageObject10.type != 0) && TextUtils.isEmpty(messageObject10.caption)) || (MessageObject.getMedia(this.currentMessageObject.replyMessageObject.messageOwner) instanceof TLRPC.TL_messageMediaGame) || (MessageObject.getMedia(this.currentMessageObject.replyMessageObject.messageOwner) instanceof TLRPC.TL_messageMediaInvoice)) {
                                    if (!this.hasReplyQuote) {
                                        i5 = isDrawSelectionBackground() ? Theme.key_chat_outReplyMediaMessageSelectedText : Theme.key_chat_outReplyMediaMessageText;
                                        themedColor = getThemedColor(i5);
                                        f36 = (f36 * 0.4f) + 0.6f;
                                    }
                                }
                            }
                        }
                        Theme.chat_replyTextPaint.setColor(ColorUtils.blendARGB(themedColor, Theme.adaptHue(themedColor, Theme.chat_replyNamePaint.getColor()), f36));
                        Theme.chat_replyTextPaint.linkColor = ColorUtils.blendARGB(themedColor, Theme.adaptHue(themedColor, Theme.chat_replyNamePaint.getColor()), Utilities.clamp(f36 * 2.0f, 1.0f, BitmapDescriptorFactory.HUE_RED));
                    }
                    Theme.chat_replyTextPaint.setColor(Theme.chat_replyNamePaint.getColor());
                    TextPaint textPaint4 = Theme.chat_replyTextPaint;
                    textPaint4.linkColor = textPaint4.getColor();
                } else {
                    if (!this.currentMessageObject.isReplyToStory()) {
                        themedColor = getThemedColor(Theme.key_chat_inReplyMessageText);
                        MessageObject messageObject11 = this.currentMessageObject;
                        if (!messageObject11.forceAvatar) {
                            if (messageObject11.hasValidReplyMessageObject()) {
                                MessageObject messageObject12 = this.currentMessageObject.replyMessageObject;
                                if (((messageObject12.contentType == 1 || messageObject12.type != 0) && TextUtils.isEmpty(messageObject12.caption)) || (MessageObject.getMedia(this.currentMessageObject.replyMessageObject.messageOwner) instanceof TLRPC.TL_messageMediaGame) || (MessageObject.getMedia(this.currentMessageObject.replyMessageObject.messageOwner) instanceof TLRPC.TL_messageMediaInvoice)) {
                                    if (!this.hasReplyQuote) {
                                        i5 = isDrawSelectionBackground() ? Theme.key_chat_inReplyMediaMessageSelectedText : Theme.key_chat_inReplyMediaMessageText;
                                        themedColor = getThemedColor(i5);
                                        f36 = (f36 * 0.4f) + 0.6f;
                                    }
                                }
                            }
                        }
                        Theme.chat_replyTextPaint.setColor(ColorUtils.blendARGB(themedColor, Theme.adaptHue(themedColor, Theme.chat_replyNamePaint.getColor()), f36));
                        Theme.chat_replyTextPaint.linkColor = ColorUtils.blendARGB(themedColor, Theme.adaptHue(themedColor, Theme.chat_replyNamePaint.getColor()), Utilities.clamp(f36 * 2.0f, 1.0f, BitmapDescriptorFactory.HUE_RED));
                    }
                    Theme.chat_replyTextPaint.setColor(Theme.chat_replyNamePaint.getColor());
                    TextPaint textPaint42 = Theme.chat_replyTextPaint;
                    textPaint42.linkColor = textPaint42.getColor();
                }
                int i18 = alphaComponent;
                Theme.chat_quoteTextPaint.setColor(Theme.chat_replyTextPaint.getColor());
                Theme.chat_quoteTextPaint.linkColor = Theme.chat_replyTextPaint.linkColor;
                float fDp13 = AndroidUtilities.dp(10.0f);
                this.forwardNameX = (f35 - this.replyTextOffset) + fDp13 + (this.needReplyImage ? r1 + AndroidUtilities.dp(25.0f) : 0);
                MessageObject.GroupedMessagePosition groupedMessagePosition3 = this.currentPosition;
                if ((groupedMessagePosition3 == null || (groupedMessagePosition3.minY == 0 && groupedMessagePosition3.minX == 0)) && (!this.enterTransitionInProgress || this.currentMessageObject.isVoice())) {
                    float alpha10 = (this.transitionParams.ignoreAlpha ? 1.0f : getAlpha()) * f7;
                    if (alpha10 != 1.0f) {
                        RectF rectF5 = AndroidUtilities.rectTmp;
                        rectF5.set(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, getWidth(), getHeight());
                        saveCount = canvas.saveLayerAlpha(rectF5, (int) (alpha10 * 255.0f), 31);
                    } else {
                        saveCount = -1;
                    }
                    float fMin = Math.min(4.0f, SharedConfig.bubbleRadius);
                    if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                        float f39 = z ? 6.0f : 4.0f;
                        this.replySelectorRect.set(f35 - AndroidUtilities.dp(7.0f), f34 - AndroidUtilities.dp(3.0f), (Math.max(this.replyNameWidth, this.replyTextWidth) + f35) - AndroidUtilities.dp(4.0f), this.replyHeight + f34 + AndroidUtilities.dp(3.0f));
                        if (i4 > 0) {
                            RectF rectF6 = this.replySelectorRect;
                            rectF6.right = Math.max(rectF6.right, i4);
                        }
                        f11 = fDp13;
                        f13 = f39;
                        f12 = f13;
                    } else {
                        float f40 = (this.drawTopic || this.drawNameLayout || (this.drawForwardedName && this.forwardedNameLayout[0] != null)) ? fMin : (this.currentMessageObject.isOutOwner() && this.drawPinnedTop) ? SharedConfig.bubbleRadius / 3.0f : SharedConfig.bubbleRadius * 0.6f;
                        if (this.currentMessagesGroup == null || (groupedMessagePosition = this.currentPosition) == null) {
                            f10 = f40;
                            f11 = fDp13;
                            backgroundDrawableRight = getBackgroundDrawableRight() + this.transitionParams.deltaRight;
                            this.replySelectorRect.set(this.backgroundDrawableLeft + this.transitionParams.deltaLeft + AndroidUtilities.dp(10 + ((!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 0 : 6)) + getExtraTextX(), (f34 - AndroidUtilities.dp((this.mediaBackground && this.drawPinnedTop && !this.drawNameLayout) ? 2 : 0)) - ((this.drawForwardedName || this.forwardedNameLayout[0] == null || this.drawNameLayout) ? 0 : 2), backgroundDrawableRight - (AndroidUtilities.dp(10 + ((this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 0 : 6)) + getExtraTextX()), this.replyHeight + f34 + AndroidUtilities.dp(4.0f));
                            f12 = fMin;
                            f13 = f10;
                        } else {
                            int i19 = groupedMessagePosition.flags;
                            if ((i19 & 1) == 0 || (i19 & 2) == 0) {
                                int minTabletSide = AndroidUtilities.isTablet() ? AndroidUtilities.getMinTabletSide() : getParentWidth();
                                int i20 = 0;
                                int i21 = 0;
                                while (i20 < this.currentMessagesGroup.posArray.size()) {
                                    if (this.currentMessagesGroup.posArray.get(i20).minY != 0) {
                                        break;
                                    }
                                    float f41 = fDp13;
                                    double d2 = i21;
                                    float f42 = f40;
                                    double dCeil2 = Math.ceil(((r6.pw + r6.leftSpanOffset) / 1000.0f) * minTabletSide);
                                    Double.isNaN(d2);
                                    i21 = (int) (d2 + dCeil2);
                                    i20++;
                                    f40 = f42;
                                    fDp13 = f41;
                                    minTabletSide = minTabletSide;
                                }
                                f10 = f40;
                                f11 = fDp13;
                                backgroundDrawableRight = ((this.mediaBackground || !this.currentMessageObject.isOutOwner()) ? this.backgroundDrawableLeft + i21 : (this.backgroundDrawableLeft + i21) - AndroidUtilities.dp(6.0f)) - ((getExtraTextX() + AndroidUtilities.dp(8.0f)) + AndroidUtilities.lerp(AndroidUtilities.dp(this.isAvatarVisible ? 48.0f : BitmapDescriptorFactory.HUE_RED), AndroidUtilities.dp(64.0f), this.sideMenuAlpha));
                            }
                            if (this.currentMessageObject.isOutOwner()) {
                                if (this.currentMessageObject.isOutOwner()) {
                                    if (this.mediaBackground) {
                                        this.replySelectorRect.set(this.backgroundDrawableLeft + this.transitionParams.deltaLeft + AndroidUtilities.dp(10 + ((!this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 0 : 6)) + getExtraTextX(), (f34 - AndroidUtilities.dp((this.mediaBackground && this.drawPinnedTop && !this.drawNameLayout) ? 2 : 0)) - ((this.drawForwardedName || this.forwardedNameLayout[0] == null || this.drawNameLayout) ? 0 : 2), backgroundDrawableRight - (AndroidUtilities.dp(10 + ((this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 0 : 6)) + getExtraTextX()), this.replyHeight + f34 + AndroidUtilities.dp(4.0f));
                                        f12 = fMin;
                                        f13 = f10;
                                    }
                                }
                            }
                        }
                    }
                    if (z) {
                        if (this.replyBounce == null) {
                            this.replyBounce = new ButtonBounce(this, 2.0f, 2.0f);
                        }
                        if (saveCount == -1) {
                            saveCount = canvas.getSaveCount();
                        }
                        canvas.save();
                        float scale4 = this.replyBounce.getScale(0.0125f);
                        float f43 = this.replyBounceX;
                        RectF rectF7 = this.replySelectorRect;
                        float fClamp2 = Utilities.clamp(f43, rectF7.right, rectF7.left);
                        float f44 = this.replyBounceY;
                        RectF rectF8 = this.replySelectorRect;
                        canvas.scale(scale4, scale4, fClamp2, Utilities.clamp(f44, rectF8.bottom, rectF8.top));
                    }
                    int i22 = saveCount;
                    this.replyLine.setLoading(z11);
                    boolean z12 = false;
                    this.replyLine.drawBackground(canvas, this.replySelectorRect, f12, f13, f12, f, this.isReplyQuote, this.currentMessageObject.shouldDrawWithoutBackground());
                    if (this.replySelector == null) {
                        this.replySelectorColor = i18;
                        Drawable drawableCreateRadSelectorDrawable4 = Theme.createRadSelectorDrawable(i18, 0, 0);
                        this.replySelector = drawableCreateRadSelectorDrawable4;
                        drawableCreateRadSelectorDrawable4.setCallback(this);
                    }
                    Drawable drawable7 = this.replySelector;
                    RectF rectF9 = this.replySelectorRect;
                    drawable7.setBounds((int) rectF9.left, (int) rectF9.top, (int) rectF9.right, (int) rectF9.bottom);
                    if (f12 != this.replySelectorRadLeft || f13 != this.replySelectorRadRight) {
                        Drawable drawable8 = this.replySelector;
                        this.replySelectorRadLeft = f12;
                        this.replySelectorRadRight = f13;
                        Theme.setMaskDrawableRad(drawable8, f12, f13, f12, f12);
                    }
                    if (i18 != this.replySelectorColor) {
                        Drawable drawable9 = this.replySelector;
                        this.replySelectorColor = i18;
                        Theme.setSelectorDrawableColor(drawable9, i18, true);
                    }
                    this.replySelector.draw(canvas);
                    Path path = this.replyRoundRectPath;
                    if (path == null) {
                        this.replyRoundRectPath = new Path();
                    } else {
                        path.rewind();
                    }
                    this.replyLine.drawLine(canvas, this.replySelectorRect);
                    this.replyLine.drawLoadingBackground(canvas, this.replySelectorRect, f12, f13, f12, f);
                    if (this.needReplyImage) {
                        this.replyImageReceiver.setAlpha(f7);
                        float fMin2 = Math.min(this.replySelectorRect.height() - AndroidUtilities.dp(10.0f), AndroidUtilities.dp(this.isReplyQuote ? 3.0f : 7.0f) + Theme.chat_replyNamePaint.getTextSize() + Theme.chat_replyTextPaint.getTextSize());
                        this.replyImageReceiver.setImageCoords(this.replySelectorRect.left + AndroidUtilities.dp(8.0f), this.replySelectorRect.top + AndroidUtilities.dp(((!this.isReplyQuote || (staticLayout = this.replyTextLayout) == null || staticLayout.getLineCount() > 1) ? 0 : 2) + 5), fMin2, fMin2);
                        this.replyImageReceiver.draw(canvas);
                        MessageObject messageObject13 = this.currentMessageObject;
                        if (messageObject13 != null && messageObject13.hasValidReplyMessageObject() && this.currentMessageObject.replyMessageObject.hasMediaSpoilers()) {
                            int[] roundRadius = this.replyImageReceiver.getRoundRadius();
                            float[] fArr = this.mediaSpoilerRadii;
                            float f45 = roundRadius[0];
                            fArr[1] = f45;
                            fArr[0] = f45;
                            float f46 = roundRadius[1];
                            fArr[3] = f46;
                            i6 = 2;
                            fArr[2] = f46;
                            float f47 = roundRadius[2];
                            fArr[5] = f47;
                            fArr[4] = f47;
                            float f48 = roundRadius[3];
                            fArr[7] = f48;
                            fArr[6] = f48;
                            this.mediaSpoilerPath.rewind();
                            RectF rectF10 = AndroidUtilities.rectTmp;
                            rectF10.set(this.replyImageReceiver.getImageX(), this.replyImageReceiver.getImageY(), this.replyImageReceiver.getImageX2(), this.replyImageReceiver.getImageY2());
                            this.mediaSpoilerPath.addRoundRect(rectF10, this.mediaSpoilerRadii, Path.Direction.CW);
                            canvas.save();
                            canvas.clipPath(this.mediaSpoilerPath);
                            if (this.mediaSpoilerEffect == null) {
                                this.mediaSpoilerEffect = new SpoilerEffect();
                            }
                            this.mediaSpoilerEffect.setColor(ColorUtils.setAlphaComponent(-1, (int) (Color.alpha(-1) * 0.325f * this.replyImageReceiver.getAlpha())));
                            this.mediaSpoilerEffect.setBounds((int) this.replyImageReceiver.getImageX(), (int) this.replyImageReceiver.getImageY(), (int) this.replyImageReceiver.getImageX2(), (int) this.replyImageReceiver.getImageY2());
                            this.mediaSpoilerEffect.draw(canvas);
                            canvas.restore();
                            invalidate();
                        } else {
                            i6 = 2;
                        }
                        f14 = fMin2;
                    } else {
                        i6 = 2;
                        f14 = BitmapDescriptorFactory.HUE_RED;
                    }
                    MessageObject messageObject14 = this.currentMessageObject;
                    if (messageObject14 == null || !messageObject14.shouldDrawWithoutBackground()) {
                        f15 = 1.0f;
                        f16 = -AndroidUtilities.dp(1.0f);
                    } else {
                        f16 = -AndroidUtilities.dp(6.0f);
                        f15 = 1.0f;
                    }
                    MessageObject messageObject15 = this.currentMessageObject;
                    if (messageObject15 == null || !messageObject15.shouldDrawWithoutBackground()) {
                        f15 = 3.0f;
                    }
                    float fDp14 = AndroidUtilities.dp(f15);
                    boolean z13 = this.isReplyQuote;
                    if (z13 && (messageObject = this.currentMessageObject) != null && (message = messageObject.messageOwner) != null && message.reply_to.quote) {
                        z12 = true;
                    }
                    if (z13 && z12 && this.replyQuoteDrawable != null) {
                        if (this.replyLine.getColor() != this.replyQuoteDrawableColor) {
                            Drawable drawable10 = this.replyQuoteDrawable;
                            int color5 = this.replyLine.getColor();
                            this.replyQuoteDrawableColor = color5;
                            drawable10.setColorFilter(new PorterDuffColorFilter(color5, PorterDuff.Mode.SRC_IN));
                        }
                        this.replyQuoteDrawable.setBounds((int) ((this.replySelectorRect.right - AndroidUtilities.dp((!this.drawPinnedTop ? 1 : 0) + i6)) - this.replyQuoteDrawable.getIntrinsicWidth()), (int) (this.replySelectorRect.top + AndroidUtilities.dp((!this.drawPinnedTop ? 1 : 0) + i6)), (int) (this.replySelectorRect.right - AndroidUtilities.dp((!this.drawPinnedTop ? 1 : 0) + i6)), (int) (this.replySelectorRect.top + AndroidUtilities.dp((1 ^ (this.drawPinnedTop ? 1 : 0)) + i6) + this.replyQuoteDrawable.getIntrinsicHeight()));
                        this.replyQuoteDrawable.draw(canvas);
                    }
                    if (this.replyNameLayout != null) {
                        canvas.save();
                        canvas.translate(((f35 + f16) - this.replyNameOffset) + f11 + (this.needReplyImage ? f14 + AndroidUtilities.dp(3.0f) : BitmapDescriptorFactory.HUE_RED), f34 + fDp14);
                        this.replyNameLayout.draw(canvas);
                        canvas.restore();
                    }
                    MessageObject messageObject16 = this.currentMessageObject;
                    int color6 = (messageObject16 == null || !messageObject16.isOutOwner() || ChatObject.isChannelAndNotMegaGroup(this.currentMessageObject.getChatId(), this.currentAccount)) ? Theme.chat_replyTextPaint.getColor() : getThemedColor(Theme.key_chat_outTimeText);
                    if (this.transitionParams.animateReplyTextLayout != null && this.transitionParams.animateChangeProgress < 1.0f) {
                        canvas.save();
                        canvas.clipRect(this.replySelectorRect);
                        canvas.save();
                        float fDp15 = f35 + f11 + f16;
                        if (this.isReplyQuote && this.needReplyImage) {
                            fDp15 -= AndroidUtilities.dp(2.0f);
                        }
                        if (this.needReplyImage && (!this.isReplyQuote || this.replyTextRTL)) {
                            fDp15 += AndroidUtilities.dp(3.0f) + f14;
                        }
                        if (this.replyTextRTL && this.transitionParams.animateReplyTextOffset > BitmapDescriptorFactory.HUE_RED) {
                            fDp15 = (this.replySelectorRect.right - AndroidUtilities.dp(8.0f)) - this.transitionParams.animateReplyTextLayout.getWidth();
                        }
                        canvas.translate(fDp15, ((f34 + fDp14) - AndroidUtilities.dp(1.0f)) + Theme.chat_replyNamePaint.getTextSize() + AndroidUtilities.dp(5.0f));
                        TextPaint paint = this.transitionParams.animateReplyTextLayout.getPaint();
                        int alpha11 = paint.getAlpha();
                        paint.setAlpha((int) (alpha11 * (1.0f - this.transitionParams.animateChangeProgress)));
                        SpoilerEffect.renderWithRipple(this, this.invalidateSpoilersParent, color6, -AndroidUtilities.dp(2.0f), this.spoilersPatchedReplyTextLayout, 0, this.transitionParams.animateReplyTextLayout, this.replySpoilers, canvas, false);
                        AnimatedEmojiSpan.drawAnimatedEmojis(canvas, this.transitionParams.animateReplyTextLayout, this.transitionParams.animateOutAnimateEmojiReply, BitmapDescriptorFactory.HUE_RED, this.replySpoilers, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, f, getAdaptiveEmojiColorFilter(i6, paint.getColor()));
                        paint.setAlpha(alpha11);
                        canvas.restore();
                    }
                    if (this.replyTextLayout != null) {
                        canvas.save();
                        float fDp16 = f35 + f11 + f16;
                        float fDp17 = ((f34 + fDp14) - AndroidUtilities.dp(1.0f)) + Theme.chat_replyNamePaint.getTextSize() + AndroidUtilities.dp(5.0f);
                        if (this.isReplyQuote && this.needReplyImage) {
                            fDp16 -= AndroidUtilities.dp(2.0f);
                        }
                        if (this.needReplyImage && (!this.isReplyQuote || this.replyTextRTL)) {
                            fDp16 += f14 + AndroidUtilities.dp(3.0f);
                        }
                        if (this.replyTextRTL && this.replyTextOffset > 0) {
                            fDp16 = (this.replySelectorRect.right - AndroidUtilities.dp(8.0f)) - this.replyTextLayout.getWidth();
                        }
                        if (this.isReplyTask && (checkBoxBase = this.replyTaskCheckbox) != null) {
                            checkBoxBase.setBounds((int) fDp16, ((int) fDp17) + AndroidUtilities.dp(2.0f), AndroidUtilities.dp(12.0f), AndroidUtilities.dp(12.0f));
                            Theme.chat_instantViewRectPaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outMenu : Theme.key_chat_inMenu));
                            canvas.drawCircle(AndroidUtilities.dp(6.0f) + fDp16, AndroidUtilities.dp(8.0f) + fDp17, AndroidUtilities.dp(5.0f), Theme.chat_instantViewRectPaint);
                            this.replyTaskCheckbox.setColor(-1, this.currentMessageObject.isOutOwner() ? Theme.key_chat_outAudioSeekbarFill : Theme.key_chat_inAudioSeekbarFill, Theme.key_checkboxCheck);
                            this.replyTaskCheckbox.draw(canvas);
                        }
                        if (this.isReplyTask) {
                            fDp16 += AndroidUtilities.dp(16.0f);
                        }
                        canvas.translate(fDp16, fDp17);
                        TextPaint paint2 = this.replyTextLayout.getPaint();
                        int alpha12 = paint2.getAlpha();
                        paint2.setAlpha((int) (alpha12 * (this.transitionParams.animateReplyTextLayout != null ? this.transitionParams.animateChangeProgress : 1.0f)));
                        SpoilerEffect.renderWithRipple(this, this.invalidateSpoilersParent, color6, -AndroidUtilities.dp(2.0f), this.spoilersPatchedReplyTextLayout, 0, this.replyTextLayout, this.replySpoilers, canvas, false);
                        AnimatedEmojiSpan.drawAnimatedEmojis(canvas, this.replyTextLayout, this.animatedEmojiReplyStack, BitmapDescriptorFactory.HUE_RED, this.replySpoilers, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, f, getAdaptiveEmojiColorFilter(i6, paint2.getColor()));
                        paint2.setAlpha(alpha12);
                        canvas.restore();
                    }
                    if (this.transitionParams.animateReplyTextLayout != null && this.transitionParams.animateChangeProgress < 1.0f) {
                        canvas.restore();
                    }
                    if (i22 >= 0) {
                        canvas.restoreToCount(i22);
                    }
                }
            }
            int i23 = i2;
            if (i23 != Integer.MIN_VALUE) {
                canvas.restoreToCount(i23);
            }
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:167:0x0326  */
    /* JADX WARN: Removed duplicated region for block: B:205:0x0399  */
    /* JADX WARN: Removed duplicated region for block: B:206:0x039c  */
    /* JADX WARN: Removed duplicated region for block: B:273:0x056d  */
    /* JADX WARN: Removed duplicated region for block: B:32:0x004f  */
    /* JADX WARN: Removed duplicated region for block: B:49:0x0128  */
    /* JADX WARN: Removed duplicated region for block: B:69:0x0189  */
    /* JADX WARN: Removed duplicated region for block: B:93:0x0208  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawOutboundsContent(Canvas canvas) {
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        float f;
        MessageObject.GroupedMessages groupedMessages;
        int color;
        int i;
        TLRPC.User user;
        TLRPC.TL_peerColor tL_peerColor;
        float f2;
        int themedColor;
        float fDp;
        float fLerp;
        float f3;
        TransitionParams transitionParams;
        MessageObject.GroupedMessages groupedMessages2;
        MessageObject messageObject;
        MessageObject messageObject2;
        ChannelRecommendationsCell channelRecommendationsCell = this.channelRecommendationsCell;
        if (channelRecommendationsCell != null && (messageObject2 = this.currentMessageObject) != null && messageObject2.type == 27) {
            channelRecommendationsCell.draw(canvas);
            return;
        }
        MessageObject messageObject3 = this.currentMessageObject;
        if (messageObject3 == null) {
            return;
        }
        int i2 = messageObject3.type;
        if ((i2 == 0 || i2 == 24 || i2 == 19 || messageObject3.isGiveawayOrGiveawayResults()) && this.transitionParams.animateExpandedQuotes) {
            layoutTextXY(false);
            drawMessageText(canvas);
        }
        if (this.starsPriceText != null) {
            MessageObject.GroupedMessagePosition groupedMessagePosition2 = this.currentPosition;
            if (groupedMessagePosition2 != null) {
                int i3 = groupedMessagePosition2.flags;
                if ((i3 & 4) != 0 && (i3 & 1) != 0) {
                    float alpha = this.transitionParams.ignoreAlpha ? this.timeAlpha : getAlpha();
                    canvas.save();
                    canvas.translate((getParentWidth() - this.starsPriceText.getWidth()) / 2.0f, (-this.starsPriceTopPadding) + AndroidUtilities.dp(4.5f) + AndroidUtilities.dp(3.33f));
                    applyServiceShaderMatrix(getMeasuredWidth(), this.backgroundHeight, getX(), (this.viewTop - this.starsPriceTopPadding) + AndroidUtilities.dp(4.5f) + AndroidUtilities.dp(3.33f));
                    Paint themedPaint = getThemedPaint("paintChatActionBackground");
                    int alpha2 = themedPaint.getAlpha();
                    themedPaint.setPathEffect(this.starsPriceTextPathEffect);
                    themedPaint.setAlpha((int) (alpha2 * alpha));
                    canvas.drawPath(this.starsPriceTextPath, themedPaint);
                    themedPaint.setPathEffect(null);
                    themedPaint.setAlpha(alpha2);
                    if (hasGradientService()) {
                        Paint themedPaint2 = getThemedPaint("paintChatActionBackgroundDarken");
                        int alpha3 = themedPaint2.getAlpha();
                        themedPaint2.setPathEffect(this.starsPriceTextPathEffect);
                        themedPaint2.setAlpha((int) (alpha3 * alpha));
                        canvas.drawPath(this.starsPriceTextPath, themedPaint2);
                        themedPaint2.setPathEffect(null);
                        themedPaint2.setAlpha(alpha3);
                    }
                    canvas.restore();
                    this.starsPriceText.draw(canvas, (getParentWidth() - this.starsPriceText.getWidth()) / 2.0f, (-this.starsPriceTopPadding) + AndroidUtilities.dp(6.83f), getThemedColor(Theme.key_chat_serviceText), alpha);
                }
            }
        }
        if (this.topicSeparator != null) {
            MessageObject.GroupedMessagePosition groupedMessagePosition3 = this.currentPosition;
            if (groupedMessagePosition3 != null) {
                int i4 = groupedMessagePosition3.flags;
                if ((i4 & 4) != 0 && (i4 & 1) != 0) {
                    float alpha4 = this.transitionParams.ignoreAlpha ? this.timeAlpha : getAlpha();
                    TransitionParams transitionParams2 = this.transitionParams;
                    if (transitionParams2.animateMonoforumPadding) {
                        boolean z = this.showTopicSeparator;
                        float f4 = transitionParams2.animateChangeProgress;
                        if (!z) {
                            f4 = 1.0f - f4;
                        }
                        alpha4 *= f4;
                    }
                    float f5 = ((-this.starsPriceTopPadding) - this.topicSeparatorTopPadding) - this.suggestionOfferTopPadding;
                    applyServiceShaderMatrix(getMeasuredWidth(), this.backgroundHeight, (this.sideMenuWidth / 2.0f) + getX(), this.viewTop + f5);
                    this.topicSeparator.draw(canvas, getParentWidth(), this.sideMenuWidth, f5, 1.0f, alpha4, this.showTopicSeparator);
                }
            }
        }
        if (this.suggestionOffer != null) {
            MessageObject.GroupedMessagePosition groupedMessagePosition4 = this.currentPosition;
            if (groupedMessagePosition4 != null) {
                int i5 = groupedMessagePosition4.flags;
                if ((i5 & 4) != 0 && (i5 & 1) != 0) {
                    float alpha5 = this.transitionParams.ignoreAlpha ? this.timeAlpha : getAlpha();
                    float fDp2 = ((-this.starsPriceTopPadding) - this.suggestionOfferTopPadding) + AndroidUtilities.dp(4.0f);
                    applyServiceShaderMatrix(getMeasuredWidth(), this.backgroundHeight, (this.sideMenuWidth / 2.0f) + getX(), this.viewTop + fDp2);
                    getParentWidth();
                    this.suggestionOffer.getWidth();
                    this.suggestionOffer.draw(canvas, getParentWidth(), this.sideMenuWidth, fDp2, 1.0f, alpha5, this.showTopicSeparator);
                }
            }
        }
        if (this.currentMessagesGroup != null) {
            updateCaptionLayout();
            drawFactCheck(canvas, 1.0f);
        }
        drawFactCheckText(canvas, 1.0f);
        if (!this.enterTransitionInProgress) {
            drawAnimatedEmojis(canvas, 1.0f);
        }
        if (this.reactionsLayoutInBubble.hasOverlay() && (messageObject = this.currentMessageObject) != null && messageObject.shouldDrawReactions()) {
            MessageObject.GroupedMessagePosition groupedMessagePosition5 = this.currentPosition;
            if (groupedMessagePosition5 != null) {
                int i6 = groupedMessagePosition5.flags;
                if ((i6 & 8) != 0 && (i6 & 1) != 0) {
                    if (!this.reactionsLayoutInBubble.isSmall) {
                        drawReactionsLayoutOverlay(canvas, 1.0f);
                        invalidateOutbounds();
                    }
                }
            }
        }
        if ((this.currentNameStatusDrawable != null || this.currentNameEmojiStatusDrawable != null) && this.drawNameLayout && this.nameLayout != null && (((groupedMessagePosition = this.currentPosition) == null || (groupedMessagePosition.minX == 0 && groupedMessagePosition.minY == 0)) && (!this.currentMessageObject.deleted || this.drawingToBitmap || (groupedMessages2 = this.currentMessagesGroup) == null || groupedMessages2.messages.size() < 1))) {
            if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                themedColor = getThemedColor(Theme.key_chat_stickerNameText);
                float fDp3 = this.currentMessageObject.isOutOwner() ? AndroidUtilities.dp(28.0f) : this.backgroundDrawableLeft + this.transitionParams.deltaLeft + this.backgroundDrawableRight + AndroidUtilities.dp(22.0f);
                if (this.currentNameBotVerificationId != 0) {
                    fDp3 += AndroidUtilities.dp(20.0f);
                }
                fDp = this.layoutHeight - AndroidUtilities.dp(38.0f);
                f2 = fDp3 - this.nameOffsetX;
            } else {
                float f6 = 11.0f;
                if (this.mediaBackground || this.currentMessageObject.isOutOwner()) {
                    f = this.backgroundDrawableLeft + this.transitionParams.deltaLeft;
                    if (this.isSideMenuEnabled && this.currentPosition != null && !this.currentMessageObject.isOutOwner() && (groupedMessages = this.currentMessagesGroup) != null && !groupedMessages.isDocuments) {
                        f6 = -4.0f;
                    }
                } else {
                    f = this.backgroundDrawableLeft + this.transitionParams.deltaLeft;
                    if (this.mediaBackground || !this.drawPinnedBottom) {
                        f6 = 17.0f;
                    }
                }
                float fDp4 = f + AndroidUtilities.dp(f6) + getExtraTextX();
                if (this.currentNameBotVerificationId != 0) {
                    fDp4 += AndroidUtilities.dp(20.0f);
                }
                if (this.currentMessageObject.isOutOwner() && ChatObject.isChannel(this.currentChat)) {
                    Theme.MessageDrawable messageDrawable = this.currentBackgroundDrawable;
                    if (messageDrawable != null && messageDrawable.hasGradient()) {
                        i = Theme.key_chat_messageTextOut;
                    }
                    color = getThemedColor(i);
                    f2 = fDp4;
                    themedColor = color;
                    fDp = AndroidUtilities.dp(this.drawPinnedTop ? 9.0f : 10.0f);
                } else {
                    if (this.currentMessageObject.isOutOwner()) {
                        i = Theme.key_chat_outForwardedNameText;
                    } else {
                        MessageObject messageObject4 = this.currentMessageObject;
                        if (messageObject4.overrideLinkColor >= 0 || ((messageObject4.isFromUser() && this.currentUser != null) || ((this.currentMessageObject.isFromChannel() && this.currentChat != null) || !((tL_peerColor = this.currentMessageObject.sponsoredColor) == null || tL_peerColor.color == -1)))) {
                            MessageObject messageObject5 = this.currentMessageObject;
                            int colorId = messageObject5.overrideLinkColor;
                            if (colorId < 0) {
                                TLRPC.TL_peerColor tL_peerColor2 = messageObject5.sponsoredColor;
                                colorId = tL_peerColor2 != null ? tL_peerColor2.color : (!messageObject5.isFromUser() || (user = this.currentUser) == null) ? ChatObject.getColorId(this.currentChat) : UserObject.getColorId(user);
                            }
                            if (colorId < 7) {
                                i = Theme.keys_avatar_nameInMessage[colorId];
                            } else {
                                MessagesController.PeerColors peerColors = MessagesController.getInstance(this.currentAccount).peerColors;
                                MessagesController.PeerColor color2 = peerColors != null ? peerColors.getColor(colorId) : null;
                                if (color2 != null) {
                                    color = color2.getColor(0, this.resourcesProvider);
                                    f2 = fDp4;
                                    themedColor = color;
                                    fDp = AndroidUtilities.dp(this.drawPinnedTop ? 9.0f : 10.0f);
                                }
                                i = Theme.key_chat_inForwardedNameText;
                            }
                        } else {
                            i = Theme.key_chat_inForwardedNameText;
                        }
                    }
                    color = getThemedColor(i);
                    f2 = fDp4;
                    themedColor = color;
                    fDp = AndroidUtilities.dp(this.drawPinnedTop ? 9.0f : 10.0f);
                }
            }
            MessageObject.GroupedMessages groupedMessages3 = this.currentMessagesGroup;
            if (groupedMessages3 != null) {
                MessageObject.GroupedMessages.TransitionParams transitionParams3 = groupedMessages3.transitionParams;
                if (transitionParams3.backgroundChangeBounds) {
                    f2 += transitionParams3.offsetLeft;
                    fDp += transitionParams3.offsetTop - getTranslationY();
                }
            }
            float f7 = f2 + this.animationOffsetX;
            TransitionParams transitionParams4 = this.transitionParams;
            float f8 = fDp + transitionParams4.deltaTop;
            if (transitionParams4.animateSign) {
                f7 = ((f7 - this.transitionParams.animateNameX) * this.transitionParams.animateChangeProgress) + this.transitionParams.animateNameX;
            }
            TransitionParams transitionParams5 = this.transitionParams;
            if (transitionParams5.animateDrawAvatar) {
                boolean z2 = this.drawNameAvatar;
                fLerp = AndroidUtilities.lerp(!z2, z2, transitionParams5.animateChangeProgress);
            } else {
                fLerp = this.drawNameAvatar ? 1.0f : BitmapDescriptorFactory.HUE_RED;
            }
            float fDp5 = f7 + (AndroidUtilities.dp(32.33f) * fLerp);
            float fDp6 = this.adminLayout == null ? f8 + (AndroidUtilities.dp(5.0f) * fLerp) : f8 - (AndroidUtilities.dp(2.33f) * fLerp);
            AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable = this.currentNameEmojiStatusDrawable;
            if (swapAnimatedEmojiDrawable != null) {
                swapAnimatedEmojiDrawable.setBounds((int) (Math.abs(fDp5) - AndroidUtilities.dp(20.0f)), (int) (((this.nameLayout.getHeight() / 2) + fDp6) - AndroidUtilities.dp(9.0f)), (int) (Math.abs(fDp5) - AndroidUtilities.dp(2.0f)), (int) ((this.nameLayout.getHeight() / 2) + fDp6 + AndroidUtilities.dp(9.0f)));
                this.currentNameEmojiStatusDrawable.setColor(Integer.valueOf(ColorUtils.setAlphaComponent(themedColor, R.styleable.AppCompatTheme_tooltipFrameBackground)));
                this.currentNameEmojiStatusDrawable.draw(canvas);
            }
            AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable2 = this.currentNameStatusDrawable;
            if (swapAnimatedEmojiDrawable2 != null) {
                swapAnimatedEmojiDrawable2.setBounds((int) (Math.abs(fDp5) + (this.viaNameWidth > 0 ? r8 - AndroidUtilities.dp(32.0f) : this.nameLayoutWidth) + AndroidUtilities.dp(2.0f)), (int) (((this.nameLayout.getHeight() / 2) + fDp6) - AndroidUtilities.dp(10.0f)), (int) (Math.abs(fDp5) + (this.viaNameWidth > 0 ? r12 - AndroidUtilities.dp(32.0f) : this.nameLayoutWidth) + AndroidUtilities.dp(22.0f)), (int) (fDp6 + (this.nameLayout.getHeight() / 2) + AndroidUtilities.dp(10.0f)));
                this.currentNameStatusDrawable.setColor(Integer.valueOf(ColorUtils.setAlphaComponent(themedColor, R.styleable.AppCompatTheme_tooltipFrameBackground)));
                this.currentNameStatusDrawable.draw(canvas);
            }
            MessageObject.GroupedMessages groupedMessages4 = this.currentMessagesGroup;
            if (groupedMessages4 != null && !groupedMessages4.isDocuments) {
                int groupPhotosWidth = getGroupPhotosWidth();
                for (int i7 = 0; i7 < this.currentMessagesGroup.posArray.size(); i7++) {
                    if (this.currentMessagesGroup.posArray.get(i7).minY != 0) {
                        break;
                    }
                    Math.ceil(((r4.pw + r4.leftSpanOffset) / 1000.0f) * groupPhotosWidth);
                }
                if (!this.mediaBackground && this.currentMessageObject.isOutOwner()) {
                    AndroidUtilities.dp(6.0f);
                }
                getExtraTextX();
                AndroidUtilities.dp(8.0f);
                if (!this.currentMessageObject.isOutOwner()) {
                    f3 = 48.0f;
                    AndroidUtilities.dp(f3);
                }
                transitionParams = this.transitionParams;
                float f9 = transitionParams.deltaRight;
                if (transitionParams.animateDrawTopic) {
                }
            } else if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                if (this.currentMessageObject.isOutOwner()) {
                    f3 = 39.0f;
                } else {
                    float f10 = this.transitionParams.deltaLeft;
                    f3 = 33.0f;
                }
                AndroidUtilities.dp(f3);
                transitionParams = this.transitionParams;
                float f92 = transitionParams.deltaRight;
                if (transitionParams.animateDrawTopic) {
                    boolean z3 = this.drawTopic;
                    AndroidUtilities.lerp(!z3, z3, transitionParams.animateChangeProgress);
                }
            } else {
                if (!this.mediaBackground && this.currentMessageObject.isOutOwner()) {
                    AndroidUtilities.dp(6.0f);
                }
                transitionParams = this.transitionParams;
                float f922 = transitionParams.deltaRight;
                if (transitionParams.animateDrawTopic) {
                }
            }
        }
        if (!this.transitionParams.transitionBotButtons.isEmpty()) {
            if (this.transitionParams.animateBotButtonsChanged) {
                drawBotButtons(canvas, this.transitionParams.transitionBotButtons, (int) (MathUtils.clamp(1.0f - ((float) Math.pow(r1.animateChangeProgress, 2.0d)), BitmapDescriptorFactory.HUE_RED, 1.0f) * 255.0f));
            }
        }
        if (!this.botButtons.isEmpty()) {
            drawBotButtons(canvas, this.botButtons, (int) ((this.transitionParams.animateBotButtonsChanged ? 1.0f - MathUtils.clamp(1.0f - ((float) Math.pow(r1.animateChangeProgress, 2.0d)), BitmapDescriptorFactory.HUE_RED, 1.0f) : 1.0f) * 255.0f));
        }
        drawSideButton(canvas);
    }

    /* JADX WARN: Removed duplicated region for block: B:1013:0x19af  */
    /* JADX WARN: Removed duplicated region for block: B:1014:0x19b2  */
    /* JADX WARN: Removed duplicated region for block: B:1017:0x19b9  */
    /* JADX WARN: Removed duplicated region for block: B:1018:0x19be  */
    /* JADX WARN: Removed duplicated region for block: B:1028:0x19f3  */
    /* JADX WARN: Removed duplicated region for block: B:1037:0x1a6c  */
    /* JADX WARN: Removed duplicated region for block: B:1038:0x1a6e  */
    /* JADX WARN: Removed duplicated region for block: B:1042:0x1aa3  */
    /* JADX WARN: Removed duplicated region for block: B:1044:0x1ab3 A[PHI: r1 r2
      0x1ab3: PHI (r1v87 float) = (r1v68 float), (r1v90 float) binds: [B:1048:0x1acb, B:1043:0x1ab1] A[DONT_GENERATE, DONT_INLINE]
      0x1ab3: PHI (r2v36 long) = (r2v33 long), (r2v37 long) binds: [B:1048:0x1acb, B:1043:0x1ab1] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:1045:0x1ab9  */
    /* JADX WARN: Removed duplicated region for block: B:1053:0x1ad6  */
    /* JADX WARN: Removed duplicated region for block: B:1055:0x1ae3 A[PHI: r1
      0x1ae3: PHI (r1v83 float) = (r1v73 float), (r1v86 float) binds: [B:1059:0x1af8, B:1054:0x1ae1] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:1056:0x1ae9  */
    /* JADX WARN: Removed duplicated region for block: B:1072:0x1b15  */
    /* JADX WARN: Removed duplicated region for block: B:1078:0x1b23  */
    /* JADX WARN: Removed duplicated region for block: B:1081:0x1b2f  */
    /* JADX WARN: Removed duplicated region for block: B:1085:0x1b3e  */
    /* JADX WARN: Removed duplicated region for block: B:1132:0x1c99  */
    /* JADX WARN: Removed duplicated region for block: B:1146:0x1cc4  */
    /* JADX WARN: Removed duplicated region for block: B:1245:0x1e96  */
    /* JADX WARN: Removed duplicated region for block: B:1364:0x214e A[PHI: r4
      0x214e: PHI (r4v159 float) = (r4v142 float), (r4v160 float) binds: [B:1369:0x2162, B:1363:0x214c] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:1365:0x2151  */
    /* JADX WARN: Removed duplicated region for block: B:1371:0x2165  */
    /* JADX WARN: Removed duplicated region for block: B:234:0x06ed  */
    /* JADX WARN: Removed duplicated region for block: B:235:0x06ef  */
    /* JADX WARN: Removed duplicated region for block: B:268:0x07c8  */
    /* JADX WARN: Removed duplicated region for block: B:271:0x07d7  */
    /* JADX WARN: Removed duplicated region for block: B:273:0x07e3  */
    /* JADX WARN: Removed duplicated region for block: B:283:0x0802  */
    /* JADX WARN: Removed duplicated region for block: B:286:0x080b  */
    /* JADX WARN: Removed duplicated region for block: B:289:0x0817  */
    /* JADX WARN: Removed duplicated region for block: B:303:0x08fb  */
    /* JADX WARN: Removed duplicated region for block: B:306:0x091a  */
    /* JADX WARN: Removed duplicated region for block: B:347:0x09e5  */
    /* JADX WARN: Removed duplicated region for block: B:350:0x09f2  */
    /* JADX WARN: Removed duplicated region for block: B:352:0x0a15  */
    /* JADX WARN: Removed duplicated region for block: B:356:0x0a1d  */
    /* JADX WARN: Removed duplicated region for block: B:363:0x0a56  */
    /* JADX WARN: Removed duplicated region for block: B:365:0x0a5f  */
    /* JADX WARN: Removed duplicated region for block: B:367:0x0a70  */
    /* JADX WARN: Removed duplicated region for block: B:370:0x0a78  */
    /* JADX WARN: Removed duplicated region for block: B:389:0x0af2  */
    /* JADX WARN: Removed duplicated region for block: B:442:0x0c4d  */
    /* JADX WARN: Removed duplicated region for block: B:452:0x0cc7  */
    /* JADX WARN: Removed duplicated region for block: B:462:0x0d0d  */
    /* JADX WARN: Removed duplicated region for block: B:468:0x0d21  */
    /* JADX WARN: Removed duplicated region for block: B:471:0x0d2d  */
    /* JADX WARN: Removed duplicated region for block: B:532:0x0f5c  */
    /* JADX WARN: Removed duplicated region for block: B:535:0x0f6d  */
    /* JADX WARN: Removed duplicated region for block: B:540:0x0f87  */
    /* JADX WARN: Removed duplicated region for block: B:575:0x0fed  */
    /* JADX WARN: Removed duplicated region for block: B:577:0x0ff7 A[PHI: r0
      0x0ff7: PHI (r0v239 android.graphics.Paint) = (r0v238 android.graphics.Paint), (r0v287 android.graphics.Paint) binds: [B:576:0x0ff5, B:572:0x0fe0] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:578:0x0ffa A[PHI: r0
      0x0ffa: PHI (r0v278 android.graphics.Paint) = (r0v238 android.graphics.Paint), (r0v287 android.graphics.Paint) binds: [B:576:0x0ff5, B:572:0x0fe0] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:582:0x1007  */
    /* JADX WARN: Removed duplicated region for block: B:585:0x10ba  */
    /* JADX WARN: Removed duplicated region for block: B:597:0x10d6  */
    /* JADX WARN: Removed duplicated region for block: B:606:0x1113  */
    /* JADX WARN: Removed duplicated region for block: B:618:0x114a  */
    /* JADX WARN: Removed duplicated region for block: B:620:0x1150  */
    /* JADX WARN: Removed duplicated region for block: B:624:0x1160  */
    /* JADX WARN: Removed duplicated region for block: B:62:0x013d  */
    /* JADX WARN: Removed duplicated region for block: B:630:0x117a  */
    /* JADX WARN: Removed duplicated region for block: B:631:0x1191  */
    /* JADX WARN: Removed duplicated region for block: B:634:0x11a2  */
    /* JADX WARN: Removed duplicated region for block: B:635:0x11a5  */
    /* JADX WARN: Removed duplicated region for block: B:665:0x12a1  */
    /* JADX WARN: Removed duplicated region for block: B:682:0x131d  */
    /* JADX WARN: Removed duplicated region for block: B:684:0x1325  */
    /* JADX WARN: Removed duplicated region for block: B:688:0x1333  */
    /* JADX WARN: Removed duplicated region for block: B:694:0x134b  */
    /* JADX WARN: Removed duplicated region for block: B:696:0x1361  */
    /* JADX WARN: Removed duplicated region for block: B:697:0x1364  */
    /* JADX WARN: Removed duplicated region for block: B:737:0x14ce  */
    /* JADX WARN: Removed duplicated region for block: B:765:0x156f  */
    /* JADX WARN: Removed duplicated region for block: B:801:0x1612  */
    /* JADX WARN: Removed duplicated region for block: B:830:0x16ee  */
    /* JADX WARN: Removed duplicated region for block: B:833:0x16fe  */
    /* JADX WARN: Removed duplicated region for block: B:844:0x1713  */
    /* JADX WARN: Removed duplicated region for block: B:846:0x1718  */
    /* JADX WARN: Removed duplicated region for block: B:860:0x1736  */
    /* JADX WARN: Removed duplicated region for block: B:865:0x1748  */
    /* JADX WARN: Removed duplicated region for block: B:868:0x174f  */
    /* JADX WARN: Removed duplicated region for block: B:870:0x1753  */
    /* JADX WARN: Removed duplicated region for block: B:895:0x1788  */
    /* JADX WARN: Removed duplicated region for block: B:896:0x178f  */
    /* JADX WARN: Removed duplicated region for block: B:939:0x17f8  */
    /* JADX WARN: Removed duplicated region for block: B:947:0x1810  */
    /* JADX WARN: Removed duplicated region for block: B:951:0x181b  */
    /* JADX WARN: Removed duplicated region for block: B:954:0x1824  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawOverlays(Canvas canvas) {
        String str;
        float f;
        int i;
        float f2;
        boolean zIsPlayingMessage;
        boolean z;
        int i2;
        int i3;
        MessageObject messageObject;
        int i4;
        boolean z2;
        boolean z3;
        float f3;
        float f4;
        float fIsSmallImage;
        int i5;
        int lineWidth;
        String str2;
        boolean z4;
        RectF rectF;
        float f5;
        StaticLayout staticLayout;
        StaticLayout staticLayout2;
        MessageObject messageObject2;
        int i6;
        int i7;
        long j;
        float f6;
        int i8;
        float f7;
        float f8;
        float f9;
        float f10;
        Drawable drawable;
        float f11;
        float f12;
        int i9;
        int themedColor;
        int themedColor2;
        int i10;
        float f13;
        TransitionParams transitionParams;
        int iDp;
        float f14;
        boolean z5;
        long j2;
        float f15;
        int i11;
        int i12;
        int i13;
        float f16;
        float f17;
        int i14;
        int i15;
        boolean z6;
        float f18;
        long j3;
        int i16;
        int size;
        int i17;
        QuoteHighlight quoteHighlight;
        Theme.MessageDrawable messageDrawable;
        TextPaint textPaint;
        int i18;
        float f19;
        int i19;
        PollButton pollButton;
        int i20;
        long j4;
        int i21;
        int i22;
        float f20;
        float fMin;
        Paint paint;
        int i23;
        Paint paint2;
        int i24;
        TLRPC.Poll poll;
        int i25;
        boolean z7;
        TLRPC.Poll poll2;
        Paint paint3;
        TLRPC.Poll poll3;
        int i26;
        float f21;
        float f22;
        CheckBoxBase checkBoxBase;
        CheckBoxBase checkBoxBase2;
        TLRPC.Poll poll4;
        int i27;
        long j5;
        int i28;
        int iCeil;
        float fDp;
        int iDp2;
        int length;
        int intrinsicWidth;
        Drawable drawable2;
        Drawable themedDrawable;
        String str3;
        TextPaint textPaint2;
        int i29;
        int i30;
        float f23;
        int iDp3;
        Drawable drawable3;
        StaticLayout staticLayout3;
        TextPaint textPaint3;
        int i31;
        String locationLeftTime;
        StaticLayout staticLayout4;
        float fAbs;
        float f24;
        boolean z8;
        StaticLayout staticLayout5;
        Paint paint4;
        int i32;
        StaticLayout staticLayout6;
        Theme.MessageDrawable messageDrawable2;
        Canvas canvas2;
        int i33;
        float f25;
        float f26;
        MessageObject messageObject3;
        MessageObject messageObject4;
        float imageX;
        float imageY2;
        float f27;
        float fDp2;
        float fDp3;
        RoundVideoPlayingDrawable roundVideoPlayingDrawable;
        float videoTranscriptionProgress;
        MessageObject messageObject5;
        MessageObject messageObject6;
        boolean z9;
        int i34;
        AnimatedFileDrawable animation;
        ChatMessageCellDelegate chatMessageCellDelegate;
        if (this.drawFromPinchToZoom || (chatMessageCellDelegate = this.delegate) == null || chatMessageCellDelegate.getPinchToZoomHelper() == null || !this.delegate.getPinchToZoomHelper().isInOverlayModeFor(this)) {
            long jElapsedRealtime = SystemClock.elapsedRealtime();
            long j6 = jElapsedRealtime - this.lastAnimationTime;
            if (j6 > 17) {
                j6 = 17;
            }
            this.lastAnimationTime = jElapsedRealtime;
            if (this.currentMessageObject.hadAnimationNotReadyLoading && this.photoImage.getVisible() && !this.currentMessageObject.needDrawBluredPreview() && (((i34 = this.documentAttachType) == 7 || i34 == 4 || i34 == 2) && (animation = this.photoImage.getAnimation()) != null && animation.hasBitmap())) {
                this.currentMessageObject.hadAnimationNotReadyLoading = false;
                updateButtonState(false, true, false);
            }
            long j7 = j6;
            if (this.hasGamePreview) {
                str2 = "paintChatTimeBackground";
                f = 0.5f;
            } else {
                MessageObject messageObject7 = this.currentMessageObject;
                int i35 = messageObject7.type;
                if (i35 == 3 || i35 == 1 || i35 == 20 || (i9 = this.documentAttachType) == 4 || i9 == 2) {
                    str = "paintChatTimeBackground";
                    f = 0.5f;
                    if (this.photoImage.getVisible()) {
                        MessageObject messageObject8 = this.currentMessageObject;
                        if (!messageObject8.isRepostPreview) {
                            if (messageObject8.needDrawBluredPreview() || this.currentMessageObject.isSponsored()) {
                                i = 4;
                                f2 = 1.0f;
                                zIsPlayingMessage = MediaController.getInstance().isPlayingMessage(this.currentMessageObject);
                                if (this.animatingNoSoundPlaying != zIsPlayingMessage) {
                                    this.animatingNoSoundPlaying = zIsPlayingMessage;
                                    this.animatingNoSound = zIsPlayingMessage ? 1 : 2;
                                    this.animatingNoSoundProgress = zIsPlayingMessage ? 1.0f : BitmapDescriptorFactory.HUE_RED;
                                }
                                MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
                                z = groupedMessagePosition == null || (groupedMessagePosition.flags & 3) == 3;
                                i2 = this.documentAttachType;
                                if ((((i2 != i || i2 == 2) && ((i3 = this.buttonState) == 1 || i3 == 2 || i3 == 0 || i3 == 3 || i3 == -1)) || this.currentMessageObject.needDrawBluredPreview()) && !this.currentMessageObject.isRepostVideoPreview) {
                                    if (this.autoPlayingMedia) {
                                        updatePlayingMessageProgress();
                                    }
                                    if ((this.infoLayout != null || this.loadingProgressLayout != null) && ((!this.forceNotDrawTime || this.autoPlayingMedia || this.drawVideoImageButton || this.animatingLoadingProgressProgress != BitmapDescriptorFactory.HUE_RED || ((z && this.docTitleLayout != null) || (this.loadingProgressLayout != null && this.currentPosition != null && ((i6 = this.buttonState) == 1 || (i6 == 3 && this.miniButtonState == 1))))) && (messageObject = this.currentMessageObject) != null && !messageObject.sendPreview)) {
                                        if (z) {
                                            z2 = (this.buttonState == 1 || this.miniButtonState == 1 || this.animatingLoadingProgressProgress != BitmapDescriptorFactory.HUE_RED) && !messageObject.isSecretMedia() && ((i4 = this.documentAttachType) == i || i4 == 2 || i4 == 1);
                                            MessageObject messageObject9 = this.currentMessageObject;
                                            int i36 = messageObject9.type;
                                            float f28 = ((i36 == 3 || i36 == 8 || this.documentAttachType == i) && !(messageObject9.needDrawBluredPreview() && this.docTitleLayout == null)) ? this.animatingDrawVideoImageButtonProgress : BitmapDescriptorFactory.HUE_RED;
                                            boolean z10 = f28 > BitmapDescriptorFactory.HUE_RED && this.docTitleLayout != null;
                                            if (z10 || !(z2 || this.infoLayout == null)) {
                                                z3 = z10;
                                                f3 = f28;
                                                f4 = 1.0f;
                                            } else {
                                                z3 = z10;
                                                f3 = f28;
                                                f4 = this.animatingLoadingProgressProgress;
                                            }
                                        } else {
                                            f4 = this.animatingLoadingProgressProgress;
                                            z2 = true;
                                            f3 = BitmapDescriptorFactory.HUE_RED;
                                            z3 = false;
                                        }
                                        fIsSmallImage = f4 * (f2 - isSmallImage());
                                        if (this.drawPhotoImage && (messageObject2 = this.currentMessageObject) != null && messageObject2.hasMediaSpoilers() && this.currentMessageObject.isSensitive()) {
                                            if (!this.currentMessageObject.isMediaSpoilersRevealed) {
                                                float f29 = this.mediaSpoilerRevealProgress;
                                                if (f29 != BitmapDescriptorFactory.HUE_RED && f29 < f2) {
                                                    fIsSmallImage *= this.mediaSpoilerRevealProgress;
                                                }
                                            }
                                        }
                                        if (fIsSmallImage > BitmapDescriptorFactory.HUE_RED) {
                                            int i37 = this.documentAttachType;
                                            boolean z11 = (i37 == 7 || i37 == 6 || this.currentMessageObject.type == 19 || SharedConfig.bubbleRadius < 10) ? false : true;
                                            Theme.chat_infoPaint.setColor(getThemedColor(Theme.key_chat_mediaInfoText));
                                            int imageX2 = (int) (this.photoImage.getImageX() + AndroidUtilities.dp(4.0f));
                                            int imageY = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(4.0f));
                                            int intrinsicWidth2 = (!this.autoPlayingMedia || (zIsPlayingMessage && this.animatingNoSound == 0)) ? 0 : (int) ((Theme.chat_msgNoSoundDrawable.getIntrinsicWidth() + AndroidUtilities.dp(4.0f)) * this.animatingNoSoundProgress);
                                            if (!z2 || (staticLayout2 = this.loadingProgressLayout) == null) {
                                                i5 = intrinsicWidth2;
                                                lineWidth = this.infoWidth;
                                            } else {
                                                lineWidth = (int) staticLayout2.getLineWidth(0);
                                                i5 = 0;
                                            }
                                            int iCeil2 = (int) Math.ceil(lineWidth + AndroidUtilities.dp(z11 ? 12.0f : 8.0f) + i5 + ((((Math.max((this.infoWidth == lineWidth ? i5 : 0) + lineWidth, this.docTitleWidth) + (this.canStreamVideo ? AndroidUtilities.dp(32.0f) : 0)) - lineWidth) - i5) * f3));
                                            float f30 = (f3 == BitmapDescriptorFactory.HUE_RED || this.docTitleLayout != null) ? f3 : BitmapDescriptorFactory.HUE_RED;
                                            canvas.save();
                                            str2 = str;
                                            int alpha = getThemedPaint(str2).getAlpha();
                                            z4 = z;
                                            getThemedPaint(str2).setAlpha((int) (alpha * this.controlsAlpha * fIsSmallImage * (this.currentMessageObject.needDrawBluredPreview() ? 0.4f : 1.0f)));
                                            float f31 = imageX2;
                                            float f32 = imageY;
                                            this.rect.set(f31, f32, imageX2 + iCeil2, imageY + AndroidUtilities.dp((15.5f * f30) + 16.5f));
                                            int[] roundRadius = this.photoImage.getRoundRadius();
                                            int iMin = Math.min(AndroidUtilities.dp(8.0f), Math.max(roundRadius[0], roundRadius[1]));
                                            if (this.currentMessageObject.needDrawBluredPreview()) {
                                                this.rectPath.reset();
                                                f5 = iMin;
                                                this.rectPath.addRoundRect(this.rect, f5, f5, Path.Direction.CW);
                                                canvas.save();
                                                canvas.clipPath(this.rectPath);
                                                float alpha2 = this.photoImage.getAlpha();
                                                this.photoImage.setAlpha(alpha2 * 0.5f);
                                                this.photoImage.draw(canvas);
                                                this.photoImage.setAlpha(alpha2);
                                                canvas.restore();
                                                rectF = this.rect;
                                            } else if (z3 || ((z2 && this.loadingProgressLayout != null) || !(z2 || this.infoLayout == null))) {
                                                canvas.scale(fIsSmallImage, fIsSmallImage, f31, f32);
                                                rectF = this.rect;
                                                f5 = iMin;
                                            } else {
                                                canvas.scale(fIsSmallImage, fIsSmallImage, f31, f32);
                                                Theme.chat_infoPaint.setAlpha((int) (this.controlsAlpha * 255.0f * fIsSmallImage));
                                                Theme.chat_infoBoldPaint.setColor(Theme.chat_infoPaint.getColor());
                                                int imageX3 = (int) (this.photoImage.getImageX() + AndroidUtilities.dp((!z11 ? 10 : 8) + (!this.canStreamVideo ? 30.0f * f30 : BitmapDescriptorFactory.HUE_RED)));
                                                this.noSoundCenterX = imageX3;
                                                canvas.translate(imageX3, this.photoImage.getImageY() + AndroidUtilities.dp((0.2f * f30) + 5.5f));
                                                staticLayout = this.infoLayout;
                                                if (staticLayout != null && (!z2 || z3)) {
                                                    staticLayout.draw(canvas);
                                                }
                                                if (i5 == 0 && (!z2 || z3)) {
                                                    canvas.save();
                                                    Drawable drawable4 = Theme.chat_msgNoSoundDrawable;
                                                    float f33 = this.animatingNoSoundProgress;
                                                    drawable4.setAlpha((int) (f33 * 255.0f * f33 * this.controlsAlpha));
                                                    int iDp4 = AndroidUtilities.dp(this.animatingNoSoundProgress * 14.0f);
                                                    int iDp5 = (AndroidUtilities.dp(14.0f) - iDp4) / 2;
                                                    int iDp6 = this.infoWidth + AndroidUtilities.dp(4.0f);
                                                    canvas.translate(iDp6, BitmapDescriptorFactory.HUE_RED);
                                                    Theme.chat_msgNoSoundDrawable.setBounds(0, iDp5, iDp4, iDp5 + iDp4);
                                                    Theme.chat_msgNoSoundDrawable.draw(canvas);
                                                    this.noSoundCenterX += iDp6 + (iDp4 / 2);
                                                    canvas.restore();
                                                }
                                                if (!z2 && this.loadingProgressLayout != null) {
                                                    canvas.save();
                                                    if (z3) {
                                                        Theme.chat_infoPaint.setAlpha((int) (this.controlsAlpha * 255.0f * f30));
                                                        canvas.translate(BitmapDescriptorFactory.HUE_RED, AndroidUtilities.dp(f30 * 14.3f));
                                                    }
                                                    this.loadingProgressLayout.draw(canvas);
                                                    canvas.restore();
                                                } else if (z3) {
                                                    Theme.chat_infoPaint.setAlpha((int) (this.controlsAlpha * 255.0f * f30));
                                                    canvas.translate(BitmapDescriptorFactory.HUE_RED, AndroidUtilities.dp(f30 * 14.3f));
                                                    this.docTitleLayout.draw(canvas);
                                                }
                                                canvas.restore();
                                                Theme.chat_infoPaint.setAlpha(255);
                                                getThemedPaint(str2).setAlpha(alpha);
                                            }
                                            canvas.drawRoundRect(rectF, f5, f5, getThemedPaint(str2));
                                            Theme.chat_infoPaint.setAlpha((int) (this.controlsAlpha * 255.0f * fIsSmallImage));
                                            Theme.chat_infoBoldPaint.setColor(Theme.chat_infoPaint.getColor());
                                            int imageX32 = (int) (this.photoImage.getImageX() + AndroidUtilities.dp((!z11 ? 10 : 8) + (!this.canStreamVideo ? 30.0f * f30 : BitmapDescriptorFactory.HUE_RED)));
                                            this.noSoundCenterX = imageX32;
                                            canvas.translate(imageX32, this.photoImage.getImageY() + AndroidUtilities.dp((0.2f * f30) + 5.5f));
                                            staticLayout = this.infoLayout;
                                            if (staticLayout != null) {
                                                staticLayout.draw(canvas);
                                            }
                                            if (i5 == 0) {
                                                if (!z2) {
                                                    if (z3) {
                                                    }
                                                    canvas.restore();
                                                    Theme.chat_infoPaint.setAlpha(255);
                                                    getThemedPaint(str2).setAlpha(alpha);
                                                }
                                            }
                                        } else {
                                            z4 = z;
                                            str2 = str;
                                        }
                                        i7 = this.animatingDrawVideoImageButton;
                                        if (i7 == 1) {
                                            j = j7;
                                            float f34 = this.animatingDrawVideoImageButtonProgress - (j / 160.0f);
                                            this.animatingDrawVideoImageButtonProgress = f34;
                                            f6 = BitmapDescriptorFactory.HUE_RED;
                                            if (f34 <= BitmapDescriptorFactory.HUE_RED) {
                                                this.animatingDrawVideoImageButtonProgress = f6;
                                                this.animatingDrawVideoImageButton = 0;
                                            }
                                            invalidate();
                                            i8 = this.animatingNoSound;
                                            if (i8 != 1) {
                                                float f35 = this.animatingNoSoundProgress - (j / 180.0f);
                                                this.animatingNoSoundProgress = f35;
                                                f7 = BitmapDescriptorFactory.HUE_RED;
                                                if (f35 <= BitmapDescriptorFactory.HUE_RED) {
                                                    this.animatingNoSoundProgress = f7;
                                                    this.animatingNoSound = 0;
                                                }
                                                invalidate();
                                                if ((this.buttonState != 1 || this.miniButtonState == 1) && this.loadingProgressLayout != null) {
                                                    f8 = BitmapDescriptorFactory.HUE_RED;
                                                    f9 = 1.0f;
                                                } else {
                                                    f8 = BitmapDescriptorFactory.HUE_RED;
                                                    f9 = BitmapDescriptorFactory.HUE_RED;
                                                }
                                                if (f9 == f8 && this.infoLayout != null && z4) {
                                                    this.animatingLoadingProgressProgress = f8;
                                                }
                                                f10 = this.animatingLoadingProgressProgress;
                                                if (f10 < f9) {
                                                    float f36 = f10 + (j / 160.0f);
                                                    this.animatingLoadingProgressProgress = f36;
                                                    if (f36 > f9) {
                                                        this.animatingLoadingProgressProgress = f9;
                                                    }
                                                    invalidate();
                                                } else if (f10 != f9) {
                                                    float f37 = f10 - (j / 160.0f);
                                                    this.animatingLoadingProgressProgress = f37;
                                                    if (f37 < f9) {
                                                    }
                                                    invalidate();
                                                }
                                            } else {
                                                if (i8 == 2) {
                                                    float f38 = this.animatingNoSoundProgress + (j / 180.0f);
                                                    this.animatingNoSoundProgress = f38;
                                                    f7 = 1.0f;
                                                    if (f38 >= 1.0f) {
                                                    }
                                                    invalidate();
                                                }
                                                if (this.buttonState != 1) {
                                                    f8 = BitmapDescriptorFactory.HUE_RED;
                                                    f9 = 1.0f;
                                                    if (f9 == f8) {
                                                        this.animatingLoadingProgressProgress = f8;
                                                    }
                                                    f10 = this.animatingLoadingProgressProgress;
                                                    if (f10 < f9) {
                                                    }
                                                } else {
                                                    f8 = BitmapDescriptorFactory.HUE_RED;
                                                    f9 = 1.0f;
                                                    if (f9 == f8) {
                                                    }
                                                    f10 = this.animatingLoadingProgressProgress;
                                                    if (f10 < f9) {
                                                    }
                                                }
                                            }
                                        } else {
                                            j = j7;
                                            if (i7 == 2) {
                                                float f39 = this.animatingDrawVideoImageButtonProgress + (j / 160.0f);
                                                this.animatingDrawVideoImageButtonProgress = f39;
                                                f6 = 1.0f;
                                                if (f39 >= 1.0f) {
                                                }
                                                invalidate();
                                            }
                                            i8 = this.animatingNoSound;
                                            if (i8 != 1) {
                                            }
                                        }
                                    }
                                }
                            } else {
                                MessageObject messageObject10 = this.currentMessageObject;
                                if (!messageObject10.isRepostPreview && !messageObject10.preview && !this.isSmallImage) {
                                    i = 4;
                                    if (this.documentAttachType == 4) {
                                        int alpha3 = ((BitmapDrawable) Theme.chat_msgMediaMenuDrawable).getPaint().getAlpha();
                                        if (this.drawMediaCheckBox) {
                                            drawable = Theme.chat_msgMediaMenuDrawable;
                                            f11 = alpha3 * this.controlsAlpha;
                                            f2 = 1.0f;
                                            f12 = 1.0f - this.checkBoxAnimationProgress;
                                        } else {
                                            f2 = 1.0f;
                                            drawable = Theme.chat_msgMediaMenuDrawable;
                                            f11 = alpha3;
                                            f12 = this.controlsAlpha;
                                        }
                                        drawable.setAlpha((int) (f11 * f12));
                                        Drawable drawable5 = Theme.chat_msgMediaMenuDrawable;
                                        int imageX4 = (int) ((this.photoImage.getImageX() + this.photoImage.getImageWidth()) - AndroidUtilities.dp(14.0f));
                                        this.otherX = imageX4;
                                        int imageY3 = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(8.1f));
                                        this.otherY = imageY3;
                                        BaseCell.setDrawableBounds(drawable5, imageX4, imageY3);
                                        Theme.chat_msgMediaMenuDrawable.draw(canvas);
                                        Theme.chat_msgMediaMenuDrawable.setAlpha(alpha3);
                                    }
                                    zIsPlayingMessage = MediaController.getInstance().isPlayingMessage(this.currentMessageObject);
                                    if (this.animatingNoSoundPlaying != zIsPlayingMessage) {
                                    }
                                    MessageObject.GroupedMessagePosition groupedMessagePosition2 = this.currentPosition;
                                    if (groupedMessagePosition2 == null) {
                                        i2 = this.documentAttachType;
                                        if (i2 != i) {
                                            if (this.autoPlayingMedia) {
                                            }
                                            if (this.infoLayout != null) {
                                                if (z) {
                                                }
                                                fIsSmallImage = f4 * (f2 - isSmallImage());
                                                if (this.drawPhotoImage) {
                                                    if (!this.currentMessageObject.isMediaSpoilersRevealed) {
                                                    }
                                                }
                                                if (fIsSmallImage > BitmapDescriptorFactory.HUE_RED) {
                                                }
                                                i7 = this.animatingDrawVideoImageButton;
                                                if (i7 == 1) {
                                                }
                                            } else {
                                                if (z) {
                                                }
                                                fIsSmallImage = f4 * (f2 - isSmallImage());
                                                if (this.drawPhotoImage) {
                                                }
                                                if (fIsSmallImage > BitmapDescriptorFactory.HUE_RED) {
                                                }
                                                i7 = this.animatingDrawVideoImageButton;
                                                if (i7 == 1) {
                                                }
                                            }
                                        } else {
                                            if (this.autoPlayingMedia) {
                                            }
                                            if (this.infoLayout != null) {
                                            }
                                        }
                                    }
                                }
                                f2 = 1.0f;
                                zIsPlayingMessage = MediaController.getInstance().isPlayingMessage(this.currentMessageObject);
                                if (this.animatingNoSoundPlaying != zIsPlayingMessage) {
                                }
                                MessageObject.GroupedMessagePosition groupedMessagePosition22 = this.currentPosition;
                                if (groupedMessagePosition22 == null) {
                                }
                            }
                        }
                    }
                } else {
                    if (i35 == 4) {
                        if (this.docTitleLayout != null) {
                            if (messageObject7.isOutOwner()) {
                                Theme.chat_locationTitlePaint.setColor(getThemedColor(Theme.key_chat_messageTextOut));
                                textPaint3 = Theme.chat_locationAddressPaint;
                                i31 = isDrawSelectionBackground() ? Theme.key_chat_outVenueInfoSelectedText : Theme.key_chat_outVenueInfoText;
                            } else {
                                Theme.chat_locationTitlePaint.setColor(getThemedColor(Theme.key_chat_messageTextIn));
                                textPaint3 = Theme.chat_locationAddressPaint;
                                i31 = isDrawSelectionBackground() ? Theme.key_chat_inVenueInfoSelectedText : Theme.key_chat_inVenueInfoText;
                            }
                            textPaint3.setColor(getThemedColor(i31));
                            if (MessageObject.getMedia(this.currentMessageObject.messageOwner) instanceof TLRPC.TL_messageMediaGeoLive) {
                                int imageY22 = (int) (this.photoImage.getImageY2() + AndroidUtilities.dp(30.0f));
                                if (this.locationExpired) {
                                    TransitionParams transitionParams2 = this.transitionParams;
                                    if (transitionParams2.animateLocationIsExpired) {
                                        this.forceNotDrawTime = true;
                                        StaticLayout staticLayout7 = this.docTitleLayout;
                                        StaticLayout staticLayout8 = this.infoLayout;
                                        TransitionParams transitionParams3 = this.transitionParams;
                                        if (transitionParams3.animateLocationIsExpired) {
                                            float f40 = transitionParams3.lastDrawLocationExpireProgress;
                                            String str4 = transitionParams3.lastDrawLocationExpireText;
                                            StaticLayout staticLayout9 = transitionParams3.lastDrawDocTitleLayout;
                                            StaticLayout staticLayout10 = transitionParams3.lastDrawInfoLayout;
                                            fAbs = f40;
                                            f24 = 1.0f - transitionParams3.animateChangeProgress;
                                            staticLayout5 = staticLayout10;
                                            z8 = false;
                                            staticLayout4 = staticLayout9;
                                            locationLeftTime = str4;
                                        } else {
                                            if (MessageObject.getMedia(this.currentMessageObject.messageOwner).period == Integer.MAX_VALUE) {
                                                staticLayout4 = staticLayout7;
                                                locationLeftTime = "";
                                                fAbs = 1.0f;
                                                f24 = 1.0f;
                                                z8 = true;
                                            } else {
                                                locationLeftTime = LocaleController.formatLocationLeftTime(Math.abs(MessageObject.getMedia(this.currentMessageObject.messageOwner).period - (ConnectionsManager.getInstance(this.currentAccount).getCurrentTime() - this.currentMessageObject.messageOwner.date)));
                                                staticLayout4 = staticLayout7;
                                                fAbs = 1.0f - (Math.abs(ConnectionsManager.getInstance(this.currentAccount).getCurrentTime() - this.currentMessageObject.messageOwner.date) / MessageObject.getMedia(this.currentMessageObject.messageOwner).period);
                                                f24 = 1.0f;
                                                z8 = false;
                                            }
                                            staticLayout5 = staticLayout8;
                                        }
                                        this.rect.set(this.photoImage.getImageX2() - AndroidUtilities.dp(43.0f), imageY22 - AndroidUtilities.dp(15.0f), this.photoImage.getImageX2() - AndroidUtilities.dp(13.0f), AndroidUtilities.dp(15.0f) + imageY22);
                                        if (this.currentMessageObject.isOutOwner()) {
                                            paint4 = Theme.chat_radialProgress2Paint;
                                            i32 = Theme.key_chat_outInstant;
                                        } else {
                                            paint4 = Theme.chat_radialProgress2Paint;
                                            i32 = Theme.key_chat_inInstant;
                                        }
                                        paint4.setColor(getThemedColor(i32));
                                        Theme.chat_livePaint.setColor(getThemedColor(i32));
                                        int alpha4 = Theme.chat_locationTitlePaint.getAlpha();
                                        int alpha5 = Theme.chat_locationAddressPaint.getAlpha();
                                        int alpha6 = Theme.chat_livePaint.getAlpha();
                                        if (f24 != 1.0f) {
                                            Theme.chat_locationTitlePaint.setAlpha((int) (alpha4 * f24));
                                            Theme.chat_locationAddressPaint.setAlpha((int) (alpha5 * f24));
                                            Theme.chat_livePaint.setAlpha((int) (alpha6 * f24));
                                            canvas.save();
                                            canvas.translate(BitmapDescriptorFactory.HUE_RED, (-AndroidUtilities.dp(50.0f)) * this.transitionParams.animateChangeProgress);
                                        }
                                        Theme.chat_radialProgress2Paint.setAlpha((int) (50.0f * f24));
                                        canvas.drawCircle(this.rect.centerX(), this.rect.centerY(), AndroidUtilities.dp(15.0f), Theme.chat_radialProgress2Paint);
                                        Theme.chat_radialProgress2Paint.setAlpha((int) (f24 * 255.0f));
                                        StaticLayout staticLayout11 = staticLayout5;
                                        String str5 = locationLeftTime;
                                        StaticLayout staticLayout12 = staticLayout4;
                                        canvas.drawArc(this.rect, -90.0f, fAbs * (-360.0f), false, Theme.chat_radialProgress2Paint);
                                        if (z8) {
                                            if (this.foreverDrawable == null) {
                                                this.foreverDrawable = getContext().getResources().getDrawable(R.drawable.filled_location_forever).mutate();
                                            }
                                            if (Theme.chat_livePaint.getColor() != this.foreverDrawableColor) {
                                                Drawable drawable6 = this.foreverDrawable;
                                                int color = Theme.chat_livePaint.getColor();
                                                this.foreverDrawableColor = color;
                                                drawable6.setColorFilter(new PorterDuffColorFilter(color, PorterDuff.Mode.SRC_IN));
                                            }
                                            this.foreverDrawable.setBounds(((int) this.rect.centerX()) - (this.foreverDrawable.getIntrinsicWidth() / 2), ((int) this.rect.centerY()) - (this.foreverDrawable.getIntrinsicHeight() / 2), ((int) this.rect.centerX()) + (this.foreverDrawable.getIntrinsicWidth() / 2), ((int) this.rect.centerY()) + (this.foreverDrawable.getIntrinsicHeight() / 2));
                                            this.foreverDrawable.draw(canvas);
                                            staticLayout6 = staticLayout12;
                                        } else {
                                            float fMeasureText = Theme.chat_livePaint.measureText(str5);
                                            int length2 = str5.length();
                                            float f41 = length2 > 4 ? 0.75f : length2 > 3 ? 0.85f : 1.0f;
                                            canvas.save();
                                            canvas.scale(f41, f41, this.rect.centerX(), this.rect.centerY());
                                            canvas.drawText(str5, this.rect.centerX() - (fMeasureText / 2.0f), imageY22 + AndroidUtilities.dp(4.0f), Theme.chat_livePaint);
                                            canvas.restore();
                                            staticLayout6 = staticLayout12;
                                        }
                                        if (staticLayout6 != null && staticLayout11 != null) {
                                            canvas.save();
                                            canvas.translate(this.photoImage.getImageX() + AndroidUtilities.dp(10.0f), this.photoImage.getImageY2() + AndroidUtilities.dp(10.0f));
                                            staticLayout6.draw(canvas);
                                            canvas.translate(BitmapDescriptorFactory.HUE_RED, AndroidUtilities.dp(23.0f));
                                            staticLayout11.draw(canvas);
                                            canvas.restore();
                                        }
                                        if (f24 != 1.0f) {
                                            Theme.chat_locationTitlePaint.setAlpha(alpha4);
                                            Theme.chat_locationAddressPaint.setAlpha(alpha5);
                                            Theme.chat_livePaint.setAlpha(alpha6);
                                            canvas.restore();
                                        }
                                        TransitionParams transitionParams4 = this.transitionParams;
                                        transitionParams4.lastDrawLocationExpireProgress = fAbs;
                                        transitionParams4.lastDrawLocationExpireText = str5;
                                        transitionParams4.lastDrawDocTitleLayout = staticLayout6;
                                        transitionParams4.lastDrawInfoLayout = staticLayout11;
                                    } else {
                                        transitionParams2.lastDrawLocationExpireText = null;
                                        transitionParams2.lastDrawDocTitleLayout = null;
                                        transitionParams2.lastDrawInfoLayout = null;
                                    }
                                    float currentAlpha = this.photoImage.isCrossfadingWithOldImage() ? 1.0f : this.photoImage.getCurrentAlpha();
                                    if (currentAlpha > BitmapDescriptorFactory.HUE_RED && (this.photoImage.hasNotThumb() || this.photoImage.isCrossfadingWithOldImage())) {
                                        int imageX5 = (int) ((this.photoImage.getImageX() + (this.photoImage.getImageWidth() / 2.0f)) - AndroidUtilities.dp(31.0f));
                                        int imageY4 = (int) (((this.photoImage.getImageY() + (this.photoImage.getImageHeight() / 2.0f)) - AndroidUtilities.dp(38.0f)) - (AndroidUtilities.dp(16.0f) * (1.0f - CubicBezierInterpolator.EASE_OUT_BACK.getInterpolation(currentAlpha))));
                                        Drawable avatarLiveLocation = this.sharedResources.getAvatarLiveLocation();
                                        BaseCell.setDrawableBounds(avatarLiveLocation, imageX5, imageY4);
                                        float f42 = currentAlpha * 5.0f;
                                        avatarLiveLocation.setAlpha((int) (Math.min(1.0f, f42) * 255.0f));
                                        avatarLiveLocation.draw(canvas);
                                        this.locationImageReceiver.setImageCoords(imageX5 + AndroidUtilities.dp(5.0f), imageY4 + AndroidUtilities.dp(5.0f), AndroidUtilities.dp(52.0f), AndroidUtilities.dp(52.0f));
                                        this.locationImageReceiver.setAlpha(Math.min(1.0f, f42));
                                        this.locationImageReceiver.draw(canvas);
                                    }
                                }
                            } else {
                                canvas.save();
                                canvas.translate(this.photoImage.getImageX() + AndroidUtilities.dp(6.0f), this.photoImage.getImageY2() + AndroidUtilities.dp(8.0f));
                                this.docTitleLayout.draw(canvas);
                                if (this.infoLayout != null) {
                                    canvas.translate(BitmapDescriptorFactory.HUE_RED, AndroidUtilities.dp(21.0f));
                                    this.infoLayout.draw(canvas);
                                }
                                canvas.restore();
                            }
                        }
                    } else if (i35 == 16) {
                        boolean zIsVideoCall = messageObject7.isVideoCall();
                        if (this.currentMessageObject.isConferenceCall()) {
                            drawable2 = this.currentMessageObject.isOutOwner() ? Theme.chat_msgCallUpGreenDrawable : Theme.chat_msgCallDownRedDrawable;
                            if (this.groupCallDrawable == null) {
                                this.groupCallDrawable = getContext().getResources().getDrawable(this.currentMessageObject.isVideoCall() ? R.drawable.filled_video_group : R.drawable.filled_calls_users).mutate();
                            }
                            int themedColor3 = getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outInstant : Theme.key_chat_inInstant);
                            if (this.groupCallDrawableColor != themedColor3) {
                                Drawable drawable7 = this.groupCallDrawable;
                                this.groupCallDrawableColor = themedColor3;
                                drawable7.setColorFilter(new PorterDuffColorFilter(themedColor3, PorterDuff.Mode.SRC_IN));
                            }
                            themedDrawable = this.groupCallDrawable;
                        } else if (this.currentMessageObject.isOutOwner()) {
                            drawable2 = Theme.chat_msgCallUpGreenDrawable;
                            if (this.currentMessageObject.isVideoCall()) {
                                isDrawSelectionBackground();
                                str3 = "drawableMsgOutCallVideo";
                            } else {
                                str3 = isDrawSelectionBackground() ? "drawableMsgOutCallAudioSelected" : "drawableMsgOutCallAudio";
                            }
                            themedDrawable = getThemedDrawable(str3);
                        } else {
                            TLRPC.PhoneCallDiscardReason phoneCallDiscardReason = this.currentMessageObject.messageOwner.action.reason;
                            drawable2 = ((phoneCallDiscardReason instanceof TLRPC.TL_phoneCallDiscardReasonMissed) || (phoneCallDiscardReason instanceof TLRPC.TL_phoneCallDiscardReasonBusy)) ? Theme.chat_msgCallDownRedDrawable : Theme.chat_msgCallDownGreenDrawable;
                            themedDrawable = isDrawSelectionBackground() ? Theme.chat_msgInCallSelectedDrawable[zIsVideoCall ? 1 : 0] : Theme.chat_msgInCallDrawable[zIsVideoCall ? 1 : 0];
                        }
                        Drawable drawable8 = drawable2;
                        Drawable drawable9 = themedDrawable;
                        if (this.currentMessageObject.isOutOwner()) {
                            Theme.chat_audioTitlePaint.setColor(getThemedColor(Theme.key_chat_messageTextOut));
                            textPaint2 = Theme.chat_contactPhonePaint;
                            i29 = isDrawSelectionBackground() ? Theme.key_chat_outTimeSelectedText : Theme.key_chat_outTimeText;
                        } else {
                            Theme.chat_audioTitlePaint.setColor(getThemedColor(Theme.key_chat_messageTextIn));
                            textPaint2 = Theme.chat_contactPhonePaint;
                            i29 = isDrawSelectionBackground() ? Theme.key_chat_inTimeSelectedText : Theme.key_chat_inTimeText;
                        }
                        textPaint2.setColor(getThemedColor(i29));
                        this.forceNotDrawTime = true;
                        int iDp7 = this.currentMessageObject.isOutOwner() ? (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(16.0f) : AndroidUtilities.dp(needDrawAvatar() ? 74.0f : 25.0f);
                        this.otherX = iDp7;
                        if (LocaleController.isRTL) {
                            iDp7 += drawable9.getIntrinsicWidth() + AndroidUtilities.dp(12.0f);
                        }
                        int i38 = iDp7;
                        if (this.titleLayout != null) {
                            canvas.save();
                            canvas.translate(i38, AndroidUtilities.dp(12.0f) + this.namesOffset);
                            this.titleLayout.draw(canvas);
                            canvas.restore();
                        }
                        if (this.docTitleLayout != null) {
                            canvas.save();
                            canvas.translate(AndroidUtilities.dp(LocaleController.isRTL ? -19.0f : 19.0f) + i38, AndroidUtilities.dp(37.0f) + this.namesOffset);
                            this.docTitleLayout.draw(canvas);
                            canvas.restore();
                        }
                        if (this.groupCallParticipantsText == null || this.groupCallParticipantsAvatars == null) {
                            i30 = 4;
                        } else {
                            canvas.save();
                            canvas.translate(AndroidUtilities.dp(LocaleController.isRTL ? -19.0f : 19.0f) + i38 + this.docTitleWidth + AndroidUtilities.dp(6.0f), AndroidUtilities.dp(36.0f) + this.namesOffset);
                            this.groupCallParticipantsAvatars.onDraw(canvas);
                            canvas.translate(this.groupCallParticipantsAvatars.getMaxX() + AndroidUtilities.dp(5.0f), AndroidUtilities.dp(8.0f));
                            i30 = 4;
                            this.groupCallParticipantsText.draw(canvas, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, Theme.chat_contactPhonePaint.getColor(), 1.0f);
                            canvas.restore();
                        }
                        BaseCell.setDrawableBounds(drawable8, (i38 + ((!LocaleController.isRTL || (staticLayout3 = this.docTitleLayout) == null) ? 0 : staticLayout3.getWidth() - drawable8.getIntrinsicWidth())) - AndroidUtilities.dp(1.0f), AndroidUtilities.dp(37.0f) + this.namesOffset);
                        drawable8.draw(canvas);
                        if (Build.VERSION.SDK_INT >= 21 && (drawable3 = this.selectorDrawable[0]) != null && this.selectorDrawableMaskType[0] == i30) {
                            drawable3.draw(canvas);
                        }
                        boolean z12 = this.pinnedBottom;
                        if (!z12 && !this.pinnedTop) {
                            f23 = 18.5f;
                        } else if (z12 && this.pinnedTop) {
                            f23 = 18.0f;
                        } else if (z12) {
                            f23 = 19.0f;
                        } else {
                            iDp3 = AndroidUtilities.dp(17.0f);
                            this.otherY = iDp3;
                            BaseCell.setDrawableBounds(drawable9, this.otherX + (!LocaleController.isRTL ? 0 : this.backgroundWidth - AndroidUtilities.dp(70.0f)) + AndroidUtilities.dp(!zIsVideoCall ? 1 : 0), this.otherY);
                            drawable9.draw(canvas);
                        }
                        iDp3 = AndroidUtilities.dp(f23);
                        this.otherY = iDp3;
                        BaseCell.setDrawableBounds(drawable9, this.otherX + (!LocaleController.isRTL ? 0 : this.backgroundWidth - AndroidUtilities.dp(70.0f)) + AndroidUtilities.dp(!zIsVideoCall ? 1 : 0), this.otherY);
                        drawable9.draw(canvas);
                    } else if (i35 == 17) {
                        long jCurrentTimeMillis = System.currentTimeMillis();
                        long j8 = jCurrentTimeMillis - this.voteLastUpdateTime;
                        long j9 = j8 <= 17 ? j8 : 17L;
                        this.voteLastUpdateTime = jCurrentTimeMillis;
                        if (this.currentMessageObject.isOutOwner()) {
                            themedColor = getThemedColor(Theme.key_chat_messageTextOut);
                            themedColor2 = getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_outTimeSelectedText : Theme.key_chat_outTimeText);
                            i10 = Theme.key_chat_messageLinkOut;
                        } else {
                            themedColor = getThemedColor(Theme.key_chat_messageTextIn);
                            themedColor2 = getThemedColor(isDrawSelectionBackground() ? Theme.key_chat_inTimeSelectedText : Theme.key_chat_inTimeText);
                            i10 = Theme.key_chat_messageLinkIn;
                        }
                        int themedColor4 = getThemedColor(i10);
                        int i39 = themedColor2;
                        Theme.chat_audioTitlePaint.setColor(themedColor);
                        TextPaint textPaint4 = Theme.chat_audioPerformerPaint;
                        textPaint4.linkColor = themedColor4;
                        textPaint4.setColor(themedColor);
                        Theme.chat_instantViewPaint.setColor(themedColor);
                        Theme.chat_timePaint.setColor(i39);
                        Theme.chat_livePaint.setColor(i39);
                        Theme.chat_locationAddressPaint.setColor(i39);
                        canvas.save();
                        TransitionParams transitionParams5 = this.transitionParams;
                        if (transitionParams5.animateNamesOffset) {
                            int i40 = this.namesOffset;
                            canvas.translate(BitmapDescriptorFactory.HUE_RED, (-i40) + AndroidUtilities.lerp(transitionParams5.animateNamesOffsetFrom, i40, transitionParams5.animateChangeProgress));
                        } else {
                            if (transitionParams5.animateForwardedLayout) {
                                float f43 = this.namesOffset;
                                float f44 = transitionParams5.animateChangeProgress;
                                float f45 = (f43 * f44) + (transitionParams5.animateForwardedNamesOffset * (1.0f - f44));
                                if (this.currentMessageObject.needDrawForwarded()) {
                                    f45 -= this.namesOffset;
                                }
                                f13 = BitmapDescriptorFactory.HUE_RED;
                                canvas.translate(BitmapDescriptorFactory.HUE_RED, f45);
                            }
                            transitionParams = this.transitionParams;
                            if (transitionParams.animateBackgroundBoundsInner) {
                                canvas.translate(f13, transitionParams.deltaTop);
                            }
                            if (this.currentMessageObject.isOutOwner()) {
                                if (this.isSideMenuEnabled) {
                                    f14 = 84.0f;
                                } else if (needDrawAvatar()) {
                                    f14 = 68.0f;
                                } else {
                                    iDp = AndroidUtilities.dp(20.0f);
                                }
                                iDp = AndroidUtilities.dp(f14);
                            } else {
                                iDp = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(11.0f);
                            }
                            float f46 = iDp;
                            TransitionParams transitionParams6 = this.transitionParams;
                            z5 = transitionParams6.animateBackgroundBoundsInner;
                            if (z5) {
                                f46 += transitionParams6.deltaLeft;
                            }
                            float f47 = f46;
                            float f48 = this.backgroundWidth;
                            if (z5) {
                                f48 += transitionParams6.deltaRight - transitionParams6.deltaLeft;
                            }
                            float f49 = f48;
                            if (this.titleLayout == null) {
                                canvas.save();
                                canvas.translate(getExtraTextX() + f47, AndroidUtilities.dp(15.0f) + this.namesOffset);
                                int alpha7 = Theme.chat_audioTitlePaint.getAlpha();
                                TransitionParams transitionParams7 = this.transitionParams;
                                if (transitionParams7.animateTitleLayout != null) {
                                    Theme.chat_audioTitlePaint.setAlpha((int) (transitionParams7.animateChangeProgress * alpha7));
                                }
                                this.titleLayout.draw(canvas);
                                StaticLayout staticLayout13 = this.titleLayout;
                                AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans = this.animatedEmojiPollQuestion;
                                TransitionParams transitionParams8 = this.transitionParams;
                                i13 = 1;
                                j2 = j9;
                                f15 = f47;
                                i12 = 255;
                                f16 = 1.0f;
                                i11 = i39;
                                str = "paintChatTimeBackground";
                                f17 = 14.0f;
                                i14 = 4;
                                AnimatedEmojiSpan.drawAnimatedEmojis(canvas, staticLayout13, emojiGroupedSpans, BitmapDescriptorFactory.HUE_RED, null, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, transitionParams8.animateTitleLayout != null ? transitionParams8.animateChangeProgress : 1.0f, getAdaptiveEmojiColorFilter(1, staticLayout13.getPaint().getColor()));
                                if (this.transitionParams.animateTitleLayout != null) {
                                    Theme.chat_audioTitlePaint.setAlpha(alpha7);
                                }
                                int height = this.titleLayout.getHeight();
                                TransitionParams transitionParams9 = this.transitionParams;
                                if (transitionParams9.animateTitleLayout != null) {
                                    Theme.chat_audioTitlePaint.setAlpha((int) ((1.0f - transitionParams9.animateChangeProgress) * alpha7));
                                    this.transitionParams.animateTitleLayout.draw(canvas);
                                    Theme.chat_audioTitlePaint.setAlpha(alpha7);
                                    TransitionParams transitionParams10 = this.transitionParams;
                                    StaticLayout staticLayout14 = transitionParams10.animateTitleLayout;
                                    AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans2 = transitionParams10.animateTitleLayoutEmoji;
                                    TransitionParams transitionParams11 = this.transitionParams;
                                    AnimatedEmojiSpan.drawAnimatedEmojis(canvas, staticLayout14, emojiGroupedSpans2, BitmapDescriptorFactory.HUE_RED, null, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 1.0f - transitionParams11.animateChangeProgress, getAdaptiveEmojiColorFilter(1, transitionParams11.animateTitleLayout.getPaint().getColor()));
                                    height = AndroidUtilities.lerp(this.transitionParams.animateTitleLayout.getHeight(), height, this.transitionParams.animateChangeProgress);
                                }
                                i15 = height;
                                canvas.restore();
                            } else {
                                j2 = j9;
                                f15 = f47;
                                i11 = i39;
                                str = "paintChatTimeBackground";
                                i12 = 255;
                                i13 = 1;
                                f16 = 1.0f;
                                f17 = 14.0f;
                                i14 = 4;
                                i15 = 0;
                            }
                            int iDp8 = i15 + AndroidUtilities.dp(20.0f) + this.namesOffset;
                            if (this.docTitleLayout == null) {
                                canvas.save();
                                canvas.translate(f15 + this.docTitleOffsetX + getExtraTextX(), iDp8);
                                this.docTitleLayout.draw(canvas);
                                canvas.restore();
                                TLRPC.MessageMedia media = MessageObject.getMedia(this.currentMessageObject.messageOwner);
                                if (media instanceof TLRPC.TL_messageMediaPoll) {
                                    TLRPC.TL_messageMediaPoll tL_messageMediaPoll = (TLRPC.TL_messageMediaPoll) media;
                                    if (!tL_messageMediaPoll.poll.quiz) {
                                        z6 = false;
                                        i28 = -1;
                                        this.pollHintX = i28;
                                        if (this.pollAvatarImages != null && !this.isBot) {
                                            iCeil = (int) Math.ceil(this.docTitleLayout.getLineLeft(z6 ? 1 : 0));
                                            if (this.docTitleOffsetX == 0 || iCeil != 0) {
                                                int i41 = -AndroidUtilities.dp(13.0f);
                                                int i42 = this.docTitleOffsetX;
                                                fDp = ((f15 + (i42 == 0 ? i42 : iCeil)) - AndroidUtilities.dp(23.0f)) - getExtraTextX();
                                                iDp2 = i41;
                                            } else {
                                                iDp2 = AndroidUtilities.dp(13.0f);
                                                fDp = f15 + ((int) Math.ceil(this.docTitleLayout.getLineWidth(z6 ? 1 : 0))) + AndroidUtilities.dp(7.0f) + getExtraTextX();
                                            }
                                            for (length = this.pollAvatarImages.length - i13; length >= 0; length--) {
                                                if (this.pollAvatarImagesVisible[length] && this.pollAvatarImages[length].hasImageSet()) {
                                                    this.pollAvatarImages[length].setImageX((iDp2 * length) + fDp);
                                                    this.pollAvatarImages[length].setImageY(iDp8 - AndroidUtilities.dp(f16));
                                                    ImageReceiver[] imageReceiverArr = this.pollAvatarImages;
                                                    if (length != imageReceiverArr.length - i13) {
                                                        canvas.drawCircle(imageReceiverArr[length].getCenterX(), this.pollAvatarImages[length].getCenterY(), AndroidUtilities.dp(9.0f), this.currentBackgroundDrawable.getPaint());
                                                    }
                                                    if (this.animatePollAvatars && this.animatePollAnswerAlpha) {
                                                        this.pollAvatarImages[length].setAlpha(Math.min(this.pollUnvoteInProgress ? (f16 - this.pollAnimationProgress) / 0.3f : this.pollAnimationProgress, f16));
                                                    }
                                                    this.pollAvatarImages[length].draw(canvas);
                                                }
                                            }
                                        }
                                    } else if (this.pollVoted || this.pollClosed) {
                                        if (!TextUtils.isEmpty(tL_messageMediaPoll.results.solution)) {
                                            Drawable themedDrawable2 = getThemedDrawable(this.currentMessageObject.isOutOwner() ? "drawable_chat_pollHintDrawableOut" : "drawable_chat_pollHintDrawableIn");
                                            if (this.pollVoteInProgress) {
                                                themedDrawable2.setAlpha((int) (this.pollAnimationProgress * 255.0f));
                                            } else {
                                                themedDrawable2.setAlpha(i12);
                                            }
                                            int i43 = this.docTitleOffsetX;
                                            if (i43 >= 0) {
                                                if (i43 == 0) {
                                                    z6 = false;
                                                    z6 = false;
                                                    if (this.docTitleLayout.getLineLeft(0) == f13) {
                                                    }
                                                    this.pollHintX = intrinsicWidth;
                                                    this.pollHintY = iDp8 - AndroidUtilities.dp(6.0f);
                                                    int intrinsicWidth3 = this.pollHintX + (themedDrawable2.getIntrinsicWidth() / 2);
                                                    int intrinsicHeight = this.pollHintY + (themedDrawable2.getIntrinsicHeight() / 2);
                                                    if (this.hintButtonVisible) {
                                                        float f50 = this.hintButtonProgress;
                                                        float interpolation = f50 < f16 ? AnimationProperties.overshootInterpolator.getInterpolation(f50) : this.hintButtonProgress;
                                                        int intrinsicWidth4 = ((int) (themedDrawable2.getIntrinsicWidth() * interpolation)) / 2;
                                                        int intrinsicHeight2 = ((int) (themedDrawable2.getIntrinsicHeight() * interpolation)) / 2;
                                                        themedDrawable2.setBounds(intrinsicWidth3 - intrinsicWidth4, intrinsicHeight - intrinsicHeight2, intrinsicWidth3 + intrinsicWidth4, intrinsicHeight + intrinsicHeight2);
                                                        themedDrawable2.draw(canvas);
                                                        if (this.pollAvatarImages != null) {
                                                            iCeil = (int) Math.ceil(this.docTitleLayout.getLineLeft(z6 ? 1 : 0));
                                                            if (this.docTitleOffsetX == 0) {
                                                                int i412 = -AndroidUtilities.dp(13.0f);
                                                                int i422 = this.docTitleOffsetX;
                                                                fDp = ((f15 + (i422 == 0 ? i422 : iCeil)) - AndroidUtilities.dp(23.0f)) - getExtraTextX();
                                                                iDp2 = i412;
                                                                while (length >= 0) {
                                                                }
                                                            }
                                                        }
                                                    }
                                                } else {
                                                    z6 = false;
                                                }
                                                intrinsicWidth = getCurrentBackgroundLeft() + AndroidUtilities.dp(11.0f);
                                                this.pollHintX = intrinsicWidth;
                                                this.pollHintY = iDp8 - AndroidUtilities.dp(6.0f);
                                                int intrinsicWidth32 = this.pollHintX + (themedDrawable2.getIntrinsicWidth() / 2);
                                                int intrinsicHeight3 = this.pollHintY + (themedDrawable2.getIntrinsicHeight() / 2);
                                                if (this.hintButtonVisible) {
                                                }
                                            } else {
                                                z6 = false;
                                            }
                                            int i44 = this.backgroundWidth;
                                            TransitionParams transitionParams12 = this.transitionParams;
                                            intrinsicWidth = ((i44 + ((int) (transitionParams12 != null ? transitionParams12.deltaRight + (-transitionParams12.deltaLeft) : BitmapDescriptorFactory.HUE_RED))) - themedDrawable2.getIntrinsicWidth()) - AndroidUtilities.dp(this.currentMessageObject.isOutOwner() ? 17.0f : 11.0f);
                                            this.pollHintX = intrinsicWidth;
                                            this.pollHintY = iDp8 - AndroidUtilities.dp(6.0f);
                                            int intrinsicWidth322 = this.pollHintX + (themedDrawable2.getIntrinsicWidth() / 2);
                                            int intrinsicHeight32 = this.pollHintY + (themedDrawable2.getIntrinsicHeight() / 2);
                                            if (this.hintButtonVisible) {
                                            }
                                        }
                                        z6 = false;
                                        i28 = -1;
                                        this.pollHintX = i28;
                                        if (this.pollAvatarImages != null) {
                                        }
                                    } else {
                                        i28 = -1;
                                        z6 = false;
                                        this.pollHintX = i28;
                                        if (this.pollAvatarImages != null) {
                                        }
                                    }
                                }
                            } else {
                                z6 = false;
                            }
                            if (((!this.pollClosed || this.pollVoted) && !this.pollVoteInProgress) || (poll4 = this.lastPoll) == null || !poll4.quiz || poll4.close_period == 0) {
                                f18 = f15;
                                j3 = j2;
                            } else {
                                long jMax = Math.max(0L, (this.lastPoll.close_date * 1000) - ConnectionsManager.getInstance(this.currentAccount).getCurrentTimeMillis());
                                if (this.closeTimeText == null || this.lastPollCloseTime != jMax) {
                                    this.closeTimeText = AndroidUtilities.formatDurationNoHours((int) Math.ceil(jMax / 1000.0f), z6);
                                    this.closeTimeWidth = (int) Math.ceil(Theme.chat_timePaint.measureText(r0));
                                    this.lastPollCloseTime = jMax;
                                }
                                if (jMax <= 0 && !this.pollClosed) {
                                    if (this.currentMessageObject.pollLastCheckTime + 1000 < SystemClock.elapsedRealtime()) {
                                        this.currentMessageObject.pollLastCheckTime = 0L;
                                    }
                                    this.delegate.needReloadPolls();
                                }
                                int iDp9 = (this.currentBackgroundDrawable.getBounds().right - this.closeTimeWidth) - AndroidUtilities.dp(this.currentMessageObject.isOutOwner() ? 40.0f : 34.0f);
                                if (jMax <= 5000) {
                                    Theme.chat_timePaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outPollWrongAnswer : Theme.key_chat_inPollWrongAnswer));
                                }
                                if (this.animatePollAnswer) {
                                    Theme.chat_timePaint.setAlpha((int) ((f16 - this.pollAnimationProgress) * 255.0f));
                                }
                                canvas.drawText(this.closeTimeText, iDp9, iDp8 + AndroidUtilities.dp(11.0f), Theme.chat_timePaint);
                                Theme.chat_pollTimerPaint.setColor(Theme.chat_timePaint.getColor());
                                int iDp10 = iDp9 + this.closeTimeWidth + AndroidUtilities.dp(13.0f);
                                int iDp11 = AndroidUtilities.dp(5.1f);
                                int iDp12 = iDp8 + AndroidUtilities.dp(6.0f);
                                if (jMax <= UcsLib.NATIVE_VERIFY_SIGNATURE_FAIL) {
                                    this.rect.set(iDp10 - iDp11, iDp12 - iDp11, iDp10 + iDp11, iDp11 + iDp12);
                                    float fMin2 = (jMax / (Math.min(60, this.lastPoll.close_period) * 1000.0f)) * (-360.0f);
                                    f18 = f15;
                                    j5 = j2;
                                    i27 = iDp10;
                                    canvas.drawArc(this.rect, -90.0f, fMin2, false, Theme.chat_pollTimerPaint);
                                    this.timerParticles.draw(canvas, Theme.chat_pollTimerPaint, this.rect, fMin2, this.pollVoteInProgress ? f16 - this.pollAnimationProgress : 1.0f);
                                } else {
                                    f18 = f15;
                                    i27 = iDp10;
                                    j5 = j2;
                                    canvas.drawCircle(i27, iDp12, iDp11, Theme.chat_pollTimerPaint);
                                }
                                if (jMax > UcsLib.NATIVE_VERIFY_SIGNATURE_FAIL || this.timerTransitionProgress != BitmapDescriptorFactory.HUE_RED) {
                                    Theme.chat_pollTimerPaint.setAlpha((int) (this.timerTransitionProgress * 255.0f));
                                    float f51 = i27;
                                    canvas.drawLine(f51 - (AndroidUtilities.dp(2.1f) * this.timerTransitionProgress), iDp12 - AndroidUtilities.dp(7.5f), f51 + (AndroidUtilities.dp(2.1f) * this.timerTransitionProgress), iDp12 - AndroidUtilities.dp(7.5f), Theme.chat_pollTimerPaint);
                                    float f52 = iDp12;
                                    canvas.drawLine(f51, f52 - (AndroidUtilities.dp(3.0f) * this.timerTransitionProgress), f51, f52, Theme.chat_pollTimerPaint);
                                    if (jMax <= UcsLib.NATIVE_VERIFY_SIGNATURE_FAIL) {
                                        j3 = j5;
                                        float f53 = this.timerTransitionProgress - (j3 / 180.0f);
                                        this.timerTransitionProgress = f53;
                                        if (f53 < BitmapDescriptorFactory.HUE_RED) {
                                            this.timerTransitionProgress = BitmapDescriptorFactory.HUE_RED;
                                        }
                                    } else {
                                        j3 = j5;
                                    }
                                    invalidate();
                                }
                            }
                            if (Build.VERSION.SDK_INT < 21 || this.selectorDrawable[0] == null) {
                                i16 = 1;
                            } else {
                                int i45 = this.selectorDrawableMaskType[0];
                                i16 = 1;
                                if (i45 == 1 || i45 == 3) {
                                    if (i45 == 3) {
                                        canvas.save();
                                        float f54 = this.hintButtonProgress;
                                        canvas.scale(f54, f54, this.selectorDrawable[0].getBounds().centerX(), this.selectorDrawable[0].getBounds().centerY());
                                    }
                                    this.selectorDrawable[0].draw(canvas);
                                    if (this.selectorDrawableMaskType[0] == 3) {
                                        canvas.restore();
                                    }
                                }
                            }
                            boolean zIsTodo = this.currentMessageObject.isTodo();
                            boolean z13 = !zIsTodo && this.currentMessageObject.canCompleteTodo();
                            size = this.pollButtons.size();
                            i17 = 0;
                            int iDp13 = 0;
                            while (i17 < size) {
                                PollButton pollButton2 = (PollButton) this.pollButtons.get(i17);
                                pollButton2.x = (int) f18;
                                int iLerp = pollButton2.y;
                                int iLerp2 = pollButton2.height;
                                if (pollButton2.animateTitle != null) {
                                    iLerp = AndroidUtilities.lerp(pollButton2.animateY, iLerp, this.transitionParams.animateChangeProgress);
                                    iLerp2 = AndroidUtilities.lerp(pollButton2.animateHeight, iLerp2, this.transitionParams.animateChangeProgress);
                                }
                                int i46 = iLerp2;
                                int i47 = i17 == size + (-1) ? this.namesOffset + iLerp + i46 : iDp13;
                                if (pollButton2.task == null || pollButton2.task.id != this.doNotDrawTaskId) {
                                    canvas.save();
                                    int i48 = i11;
                                    int iMultAlpha = Theme.multAlpha(i48, 0.12f);
                                    if (pollButton2.selectorDrawableColor != iMultAlpha) {
                                        Drawable drawable10 = pollButton2.selectorDrawable;
                                        pollButton2.selectorDrawableColor = iMultAlpha;
                                        Theme.setSelectorDrawableColor(drawable10, iMultAlpha, false);
                                    }
                                    pollButton2.selectorDrawable.setBounds((int) (f18 - AndroidUtilities.dp(8.0f)), (this.namesOffset + iLerp) - AndroidUtilities.dp(13.0f), (int) ((f18 + f49) - AndroidUtilities.dp(23.0f)), this.namesOffset + iLerp + i46 + AndroidUtilities.dp(13.0f));
                                    pollButton2.selectorDrawable.draw(canvas);
                                    canvas.restore();
                                    canvas.save();
                                    pollButton2.titleX = f18 + AndroidUtilities.dp(z13 ? 48.0f : 35.0f);
                                    pollButton2.titleY = this.namesOffset + iLerp;
                                    canvas.translate(f18 + AndroidUtilities.dp(z13 ? 48.0f : 35.0f), iLerp + this.namesOffset);
                                    TransitionParams transitionParams13 = this.transitionParams;
                                    if (transitionParams13.animateBackgroundBoundsInner) {
                                        canvas.translate(BitmapDescriptorFactory.HUE_RED, transitionParams13.deltaTop);
                                    }
                                    int alpha8 = Theme.chat_audioPerformerPaint.getAlpha();
                                    if (pollButton2.animateTitle != null) {
                                        Theme.chat_audioPerformerPaint.setAlpha((int) (alpha8 * this.transitionParams.animateChangeProgress));
                                    }
                                    canvas.save();
                                    if (zIsTodo && z13 && pollButton2.author != null && (checkBoxBase2 = this.pollCheckBox[i17]) != null) {
                                        float progress = checkBoxBase2.getProgress();
                                        canvas.translate(BitmapDescriptorFactory.HUE_RED, (-AndroidUtilities.dp(7.66f)) * progress);
                                        pollButton2.titleY += (-AndroidUtilities.dp(7.66f)) * progress;
                                    }
                                    if (i17 == this.linkBlockNum && this.links.draw(canvas, Integer.valueOf(i14))) {
                                        invalidate();
                                    }
                                    pollButton2.title.draw(canvas);
                                    f19 = f18;
                                    int i49 = size;
                                    i19 = i48;
                                    AnimatedEmojiSpan.drawAnimatedEmojis(canvas, pollButton2.title, pollButton2.animatedEmoji, BitmapDescriptorFactory.HUE_RED, null, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, pollButton2.animateTitle != null ? this.transitionParams.animateChangeProgress : 1.0f, getAdaptiveEmojiColorFilter(i16, pollButton2.title.getPaint().getColor()));
                                    if (pollButton2.animateTitle != null) {
                                        Theme.chat_audioPerformerPaint.setAlpha((int) (alpha8 * (1.0f - this.transitionParams.animateChangeProgress)));
                                        pollButton2.animateTitle.draw(canvas);
                                        AnimatedEmojiSpan.drawAnimatedEmojis(canvas, pollButton2.animateTitle, pollButton2.animateTitleEmoji, BitmapDescriptorFactory.HUE_RED, null, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 1.0f - this.transitionParams.animateChangeProgress, getAdaptiveEmojiColorFilter(i16, pollButton2.animateTitle.getPaint().getColor()));
                                        Theme.chat_audioPerformerPaint.setAlpha(alpha8);
                                    }
                                    canvas.restore();
                                    if (!zIsTodo || !z13 || pollButton2.author == null || (checkBoxBase = this.pollCheckBox[i17]) == null) {
                                        pollButton = pollButton2;
                                        i20 = i17;
                                        j4 = j3;
                                        i21 = i49;
                                        i22 = 1;
                                        f20 = BitmapDescriptorFactory.HUE_RED;
                                        Theme.chat_audioPerformerPaint.setAlpha(alpha8);
                                        if (this.animatePollAnswerAlpha) {
                                            fMin = 255.0f;
                                        } else {
                                            if (this.pollUnvoteInProgress) {
                                                f21 = 1.0f;
                                                f22 = 1.0f - this.pollAnimationProgress;
                                            } else {
                                                f21 = 1.0f;
                                                f22 = this.pollAnimationProgress;
                                            }
                                            fMin = Math.min(f22 / 0.3f, f21) * 255.0f;
                                        }
                                        int i50 = (int) fMin;
                                        if (!zIsTodo && ((z7 = this.pollVoted) || this.pollClosed || this.animatePollAnswerAlpha)) {
                                            poll2 = this.lastPoll;
                                            if (poll2 == null && poll2.quiz && z7 && pollButton.chosen) {
                                                int i51 = pollButton.correct ? this.currentMessageObject.isOutOwner() ? Theme.key_chat_outPollCorrectAnswer : Theme.key_chat_inPollCorrectAnswer : this.currentMessageObject.isOutOwner() ? Theme.key_chat_outPollWrongAnswer : Theme.key_chat_inPollWrongAnswer;
                                                if (!this.currentBackgroundDrawable.hasGradient() || Theme.hasThemeKey(i51)) {
                                                    Theme.chat_docBackPaint.setColor(getThemedColor(i51));
                                                    if (this.animatePollAnswerAlpha) {
                                                        float f55 = i50;
                                                        Theme.chat_instantViewPaint.setAlpha((int) ((Theme.chat_instantViewPaint.getAlpha() / 255.0f) * f55));
                                                        Theme.chat_docBackPaint.setAlpha((int) (f55 * (Theme.chat_docBackPaint.getAlpha() / 255.0f)));
                                                    }
                                                    Object[] objArr = new Object[i22];
                                                    objArr[0] = Integer.valueOf((int) Math.ceil(pollButton.prevPercent + ((pollButton.percent - pollButton.prevPercent) * this.pollAnimationProgress)));
                                                    canvas.drawText(String.format("%d%%", objArr), (-AndroidUtilities.dp(6.5f)) - ((int) Math.ceil(Theme.chat_instantViewPaint.measureText(r0))), AndroidUtilities.dp(f17), Theme.chat_instantViewPaint);
                                                    this.rect.set(f20, i46 + AndroidUtilities.dp(6.0f), (this.backgroundWidth - AndroidUtilities.dp(76.0f)) * (pollButton.prevPercentProgress + ((pollButton.percentProgress - pollButton.prevPercentProgress) * this.pollAnimationProgress)), i46 + AndroidUtilities.dp(11.0f));
                                                    canvas.drawRoundRect(this.rect, AndroidUtilities.dp(2.0f), AndroidUtilities.dp(2.0f), Theme.chat_docBackPaint);
                                                    if (pollButton.chosen || pollButton.prevChosen || ((poll3 = this.lastPoll) != null && poll3.quiz && pollButton.correct && (this.pollVoted || this.pollClosed))) {
                                                        float fDp4 = this.rect.left - AndroidUtilities.dp(13.5f);
                                                        float fCenterY = this.rect.centerY();
                                                        canvas.drawCircle(fDp4, fCenterY, AndroidUtilities.dp(7.0f), Theme.chat_docBackPaint);
                                                        TLRPC.Poll poll5 = this.lastPoll;
                                                        Drawable drawable11 = (poll5 == null && poll5.quiz && pollButton.chosen && !pollButton.correct) ? Theme.chat_pollCrossDrawable[this.currentMessageObject.isOutOwner() ? 1 : 0] : Theme.chat_pollCheckDrawable[this.currentMessageObject.isOutOwner() ? 1 : 0];
                                                        drawable11.setAlpha(i50);
                                                        BaseCell.setDrawableBounds(drawable11, fDp4 - (drawable11.getIntrinsicWidth() / 2), fCenterY - (drawable11.getIntrinsicHeight() / 2));
                                                        drawable11.draw(canvas);
                                                    }
                                                } else {
                                                    paint3 = Theme.chat_docBackPaint;
                                                    if (this.currentMessageObject.isOutOwner()) {
                                                    }
                                                }
                                            } else {
                                                paint3 = Theme.chat_docBackPaint;
                                                i26 = !this.currentMessageObject.isOutOwner() ? Theme.key_chat_outAudioSeekbarFill : Theme.key_chat_inAudioSeekbarFill;
                                            }
                                            paint3.setColor(getThemedColor(i26));
                                            if (this.animatePollAnswerAlpha) {
                                            }
                                            Object[] objArr2 = new Object[i22];
                                            objArr2[0] = Integer.valueOf((int) Math.ceil(pollButton.prevPercent + ((pollButton.percent - pollButton.prevPercent) * this.pollAnimationProgress)));
                                            canvas.drawText(String.format("%d%%", objArr2), (-AndroidUtilities.dp(6.5f)) - ((int) Math.ceil(Theme.chat_instantViewPaint.measureText(r0))), AndroidUtilities.dp(f17), Theme.chat_instantViewPaint);
                                            this.rect.set(f20, i46 + AndroidUtilities.dp(6.0f), (this.backgroundWidth - AndroidUtilities.dp(76.0f)) * (pollButton.prevPercentProgress + ((pollButton.percentProgress - pollButton.prevPercentProgress) * this.pollAnimationProgress)), i46 + AndroidUtilities.dp(11.0f));
                                            canvas.drawRoundRect(this.rect, AndroidUtilities.dp(2.0f), AndroidUtilities.dp(2.0f), Theme.chat_docBackPaint);
                                            if (pollButton.chosen) {
                                                float fDp42 = this.rect.left - AndroidUtilities.dp(13.5f);
                                                float fCenterY2 = this.rect.centerY();
                                                canvas.drawCircle(fDp42, fCenterY2, AndroidUtilities.dp(7.0f), Theme.chat_docBackPaint);
                                                TLRPC.Poll poll52 = this.lastPoll;
                                                if (poll52 == null) {
                                                    drawable11.setAlpha(i50);
                                                    BaseCell.setDrawableBounds(drawable11, fDp42 - (drawable11.getIntrinsicWidth() / 2), fCenterY2 - (drawable11.getIntrinsicHeight() / 2));
                                                    drawable11.draw(canvas);
                                                }
                                            }
                                        }
                                        if (!zIsTodo || (!(this.pollVoted || this.pollClosed) || this.animatePollAnswerAlpha)) {
                                            if (isDrawSelectionBackground()) {
                                                paint = Theme.chat_replyLinePaint;
                                                i23 = this.currentMessageObject.isOutOwner() ? Theme.key_chat_outVoiceSeekbar : Theme.key_chat_inVoiceSeekbar;
                                            } else {
                                                paint = Theme.chat_replyLinePaint;
                                                i23 = this.currentMessageObject.isOutOwner() ? Theme.key_chat_outVoiceSeekbarSelected : Theme.key_chat_inVoiceSeekbarSelected;
                                            }
                                            paint.setColor(getThemedColor(i23));
                                            if (!this.animatePollAnswerAlpha) {
                                                Theme.chat_replyLinePaint.setAlpha((int) ((255 - i50) * (Theme.chat_replyLinePaint.getAlpha() / 255.0f)));
                                            }
                                            canvas.drawLine(-AndroidUtilities.dp(2.0f), i46 + AndroidUtilities.dp(13.0f), f49 - AndroidUtilities.dp(!z13 ? 71.0f : 58.0f), i46 + AndroidUtilities.dp(13.0f), Theme.chat_replyLinePaint);
                                            if (zIsTodo || z13) {
                                                if (zIsTodo && this.pollVoteInProgress && i20 == this.pollVoteInProgressNum) {
                                                    Theme.chat_instantViewRectPaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outAudioSeekbarFill : Theme.key_chat_inAudioSeekbarFill));
                                                    if (this.animatePollAnswerAlpha) {
                                                        Theme.chat_instantViewRectPaint.setAlpha((int) ((255 - i50) * (Theme.chat_instantViewRectPaint.getAlpha() / 255.0f)));
                                                    }
                                                    this.rect.set((-AndroidUtilities.dp(z13 ? 35.0f : 22.0f)) - AndroidUtilities.dp(8.5f), AndroidUtilities.dp(9.0f) - AndroidUtilities.dp(8.5f), (-AndroidUtilities.dp(23.0f)) + AndroidUtilities.dp(8.5f), AndroidUtilities.dp(9.0f) + AndroidUtilities.dp(8.5f));
                                                    canvas.drawArc(this.rect, this.voteRadOffset, this.voteCurrentCircleLength, false, Theme.chat_instantViewRectPaint);
                                                } else {
                                                    if (this.currentMessageObject.isOutOwner()) {
                                                        paint2 = Theme.chat_instantViewRectPaint;
                                                        i24 = isDrawSelectionBackground() ? Theme.key_chat_inMenuSelected : Theme.key_chat_inMenu;
                                                    } else {
                                                        paint2 = Theme.chat_instantViewRectPaint;
                                                        i24 = isDrawSelectionBackground() ? Theme.key_chat_outMenuSelected : Theme.key_chat_outMenu;
                                                    }
                                                    paint2.setColor(getThemedColor(i24));
                                                    if (this.animatePollAnswerAlpha) {
                                                        Theme.chat_instantViewRectPaint.setAlpha((int) ((255 - i50) * (Theme.chat_instantViewRectPaint.getAlpha() / 255.0f)));
                                                    }
                                                    canvas.drawCircle(-AndroidUtilities.dp(!z13 ? 35.0f : 22.0f), AndroidUtilities.dp(9.0f), AndroidUtilities.dp(8.5f), Theme.chat_instantViewRectPaint);
                                                    poll = this.lastPoll;
                                                    if ((poll == null && poll.multiple_choice) || zIsTodo) {
                                                        int iDp14 = AndroidUtilities.dp(8.5f);
                                                        int i52 = Theme.key_checkboxCheck;
                                                        if (this.currentMessageObject.isOutOwner()) {
                                                            i25 = -1;
                                                            if (getThemedColor(i52) == -1) {
                                                                i52 = Theme.key_chat_outBubble;
                                                            }
                                                        } else {
                                                            i25 = -1;
                                                        }
                                                        this.pollCheckBox[i20].setColor(i25, this.currentMessageObject.isOutOwner() ? Theme.key_chat_outAudioSeekbarFill : Theme.key_chat_inAudioSeekbarFill, i52);
                                                        int i53 = iDp14 / 2;
                                                        this.pollCheckBox[i20].setBounds((-AndroidUtilities.dp(z13 ? 35.0f : 22.0f)) - i53, AndroidUtilities.dp(9.0f) - i53, iDp14, iDp14);
                                                        this.pollCheckBox[i20].draw(canvas);
                                                        if (pollButton.task != null && pollButton.avatarImageReceiver != null) {
                                                            if (this.pollCutAvatarPaint == null) {
                                                                Paint paint5 = new Paint(i22);
                                                                this.pollCutAvatarPaint = paint5;
                                                                paint5.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.CLEAR));
                                                            }
                                                            float progress2 = this.pollCheckBox[i20].getProgress();
                                                            float fLerp = AndroidUtilities.lerp(0.5f, 1.0f, progress2);
                                                            pollButton.avatarImageReceiver.setImageCoords(((-AndroidUtilities.dp(z13 ? 35.0f : 22.0f)) - i53) + AndroidUtilities.dp(8.0f), AndroidUtilities.dp(9.0f) - (AndroidUtilities.dp(20.0f) / 2), AndroidUtilities.dp(20.0f), AndroidUtilities.dp(20.0f));
                                                            canvas.saveLayerAlpha(pollButton.avatarImageReceiver.getImageX(), pollButton.avatarImageReceiver.getImageY(), pollButton.avatarImageReceiver.getImageX2(), pollButton.avatarImageReceiver.getImageY2(), 255, 31);
                                                            canvas.save();
                                                            canvas.scale(fLerp, fLerp, pollButton.avatarImageReceiver.getImageX(), pollButton.avatarImageReceiver.getCenterY());
                                                            pollButton.avatarImageReceiver.setAlpha(progress2);
                                                            pollButton.avatarImageReceiver.draw(canvas);
                                                            canvas.restore();
                                                            canvas.drawCircle(-AndroidUtilities.dp(z13 ? 35.0f : 22.0f), AndroidUtilities.dp(9.0f), AndroidUtilities.dp(11.0f), this.pollCutAvatarPaint);
                                                            canvas.restore();
                                                        }
                                                        canvas.restore();
                                                    }
                                                    canvas.restore();
                                                }
                                            } else if (pollButton.chosen) {
                                                if (this.pollCheckPath == null) {
                                                    Path path = new Path();
                                                    this.pollCheckPath = path;
                                                    path.moveTo(-AndroidUtilities.dp(3.66f), AndroidUtilities.dp(0.16f));
                                                    this.pollCheckPath.lineTo(AndroidUtilities.dp(-1.0f), AndroidUtilities.dp(3.0f));
                                                    this.pollCheckPath.lineTo(AndroidUtilities.dp(3.66f), AndroidUtilities.dp(-3.0f));
                                                }
                                                if (this.pollCheckPaint == null) {
                                                    Paint paint6 = new Paint(i22);
                                                    this.pollCheckPaint = paint6;
                                                    paint6.setStyle(Paint.Style.STROKE);
                                                    this.pollCheckPaint.setStrokeCap(Paint.Cap.ROUND);
                                                    this.pollCheckPaint.setStrokeJoin(Paint.Join.ROUND);
                                                }
                                                this.pollCheckPaint.setStrokeWidth(AndroidUtilities.dp(1.833f));
                                                this.pollCheckPaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outAudioSeekbarFill : Theme.key_chat_inAudioSeekbarFill));
                                                canvas.save();
                                                canvas.translate(-AndroidUtilities.dp(z13 ? 35.0f : 22.0f), AndroidUtilities.dp(9.0f));
                                                canvas.drawPath(this.pollCheckPath, this.pollCheckPaint);
                                                canvas.restore();
                                            } else {
                                                Theme.chat_replyLinePaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outAudioSeekbarFill : Theme.key_chat_inAudioSeekbarFill));
                                                canvas.drawCircle(-AndroidUtilities.dp(z13 ? 35.0f : 22.0f), AndroidUtilities.dp(9.0f), AndroidUtilities.dp(2.5f), Theme.chat_replyLinePaint);
                                            }
                                            canvas.restore();
                                        } else {
                                            canvas.restore();
                                        }
                                    } else {
                                        float progress3 = checkBoxBase.getProgress();
                                        if (progress3 > BitmapDescriptorFactory.HUE_RED) {
                                            Text textEllipsize = pollButton2.author.ellipsize(f49 - AndroidUtilities.dp(8.0f));
                                            float height2 = (pollButton2.title.getHeight() - AndroidUtilities.dp(6.0f)) + (pollButton2.author.getHeight() / 2.0f);
                                            pollButton = pollButton2;
                                            i20 = i17;
                                            i21 = i49;
                                            f20 = BitmapDescriptorFactory.HUE_RED;
                                            i22 = 1;
                                            j4 = j3;
                                            textEllipsize.draw(canvas, BitmapDescriptorFactory.HUE_RED, height2, i19, progress3);
                                        }
                                        Theme.chat_audioPerformerPaint.setAlpha(alpha8);
                                        if (this.animatePollAnswerAlpha) {
                                        }
                                        int i502 = (int) fMin;
                                        if (!zIsTodo) {
                                            poll2 = this.lastPoll;
                                            if (poll2 == null) {
                                                paint3 = Theme.chat_docBackPaint;
                                                if (!this.currentMessageObject.isOutOwner()) {
                                                }
                                                paint3.setColor(getThemedColor(i26));
                                                if (this.animatePollAnswerAlpha) {
                                                }
                                                Object[] objArr22 = new Object[i22];
                                                objArr22[0] = Integer.valueOf((int) Math.ceil(pollButton.prevPercent + ((pollButton.percent - pollButton.prevPercent) * this.pollAnimationProgress)));
                                                canvas.drawText(String.format("%d%%", objArr22), (-AndroidUtilities.dp(6.5f)) - ((int) Math.ceil(Theme.chat_instantViewPaint.measureText(r0))), AndroidUtilities.dp(f17), Theme.chat_instantViewPaint);
                                                this.rect.set(f20, i46 + AndroidUtilities.dp(6.0f), (this.backgroundWidth - AndroidUtilities.dp(76.0f)) * (pollButton.prevPercentProgress + ((pollButton.percentProgress - pollButton.prevPercentProgress) * this.pollAnimationProgress)), i46 + AndroidUtilities.dp(11.0f));
                                                canvas.drawRoundRect(this.rect, AndroidUtilities.dp(2.0f), AndroidUtilities.dp(2.0f), Theme.chat_docBackPaint);
                                                if (pollButton.chosen) {
                                                }
                                            }
                                        }
                                        if (zIsTodo) {
                                            if (isDrawSelectionBackground()) {
                                            }
                                            paint.setColor(getThemedColor(i23));
                                            if (!this.animatePollAnswerAlpha) {
                                            }
                                            canvas.drawLine(-AndroidUtilities.dp(2.0f), i46 + AndroidUtilities.dp(13.0f), f49 - AndroidUtilities.dp(!z13 ? 71.0f : 58.0f), i46 + AndroidUtilities.dp(13.0f), Theme.chat_replyLinePaint);
                                            if (zIsTodo) {
                                                if (zIsTodo) {
                                                    if (this.currentMessageObject.isOutOwner()) {
                                                    }
                                                    paint2.setColor(getThemedColor(i24));
                                                    if (this.animatePollAnswerAlpha) {
                                                    }
                                                    canvas.drawCircle(-AndroidUtilities.dp(!z13 ? 35.0f : 22.0f), AndroidUtilities.dp(9.0f), AndroidUtilities.dp(8.5f), Theme.chat_instantViewRectPaint);
                                                    poll = this.lastPoll;
                                                    if (poll == null) {
                                                        canvas.restore();
                                                    } else {
                                                        canvas.restore();
                                                    }
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    i20 = i17;
                                    i21 = size;
                                    j4 = j3;
                                    f19 = f18;
                                    i19 = i11;
                                }
                                i17 = i20 + 1;
                                size = i21;
                                iDp13 = i47;
                                f18 = f19;
                                i11 = i19;
                                j3 = j4;
                                i16 = 1;
                            }
                            long j10 = j3;
                            f = 0.5f;
                            if (this.drawInstantView) {
                                if (this.animatedInfoLayout != null) {
                                    TLRPC.Poll poll6 = this.lastPoll;
                                    if (poll6 != null && (poll6.public_voters || poll6.multiple_choice)) {
                                        iDp13 += AndroidUtilities.dp(6.0f);
                                    }
                                    canvas.save();
                                    canvas.translate((this.transitionParams.animateBackgroundBoundsInner ? (getBackgroundDrawableLeft() + this.transitionParams.deltaLeft) + (getBackgroundDrawableRight() + this.transitionParams.deltaRight) : getBackgroundDrawableLeft() + getBackgroundDrawableRight()) / 2.0f, iDp13 + AndroidUtilities.dp(28.0f));
                                    this.animatedInfoLayout.setBounds(-1, -1, 1, 1);
                                    AnimatedTextView.AnimatedTextDrawable animatedTextDrawable = this.animatedInfoLayout;
                                    TLRPC.Poll poll7 = this.lastPoll;
                                    animatedTextDrawable.setTextColor(((poll7 == null || poll7.public_voters || poll7.multiple_choice) ? Theme.chat_locationAddressPaint : Theme.chat_livePaint).getColor());
                                    this.animatedInfoLayout.draw(canvas);
                                    canvas.restore();
                                }
                                updatePollAnimations(j10);
                                canvas.restore();
                                quoteHighlight = this.quoteHighlight;
                                if (quoteHighlight != null) {
                                    canvas.save();
                                    canvas.clipPath(messageDrawable.makePath());
                                    Paint paint7 = this.quoteHighlight.paint;
                                    MessageObject messageObject11 = this.currentMessageObject;
                                    if (messageObject11 == null) {
                                        int themedColor5 = getThemedColor((messageObject11 == null && messageObject11.isOutOwner() && !this.currentMessageObject.preview) ? Theme.key_chat_outReplyLine : Theme.key_chat_inReplyLine);
                                        Theme.isCurrentThemeDark();
                                        paint7.setColor(Theme.multAlpha(themedColor5, 0.2f));
                                        this.quoteHighlight.draw(canvas, this.textX, this.textY, messageDrawable.getBounds(), getHighlightAlpha(true));
                                        canvas.restore();
                                    }
                                }
                            } else {
                                int currentBackgroundLeft = getCurrentBackgroundLeft() + AndroidUtilities.dp((this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 2.0f : 8.0f);
                                int iDp15 = iDp13 + AndroidUtilities.dp(13.0f);
                                if (this.currentMessageObject.isOutOwner()) {
                                    textPaint = Theme.chat_instantViewPaint;
                                    i18 = Theme.key_chat_outPreviewInstantText;
                                } else {
                                    textPaint = Theme.chat_instantViewPaint;
                                    i18 = Theme.key_chat_inPreviewInstantText;
                                }
                                textPaint.setColor(getThemedColor(i18));
                                this.instantButtonRect.set(currentBackgroundLeft, iDp15, this.instantWidth + currentBackgroundLeft, AndroidUtilities.dp(44.0f) + iDp15);
                                Drawable drawable12 = this.selectorDrawable[0];
                                if (drawable12 != null && this.selectorDrawableMaskType[0] == 2) {
                                    drawable12.setBounds(currentBackgroundLeft - AndroidUtilities.dp(this.pollInstantViewTouchesBottom ? 6.0f : BitmapDescriptorFactory.HUE_RED), iDp15, this.instantWidth + currentBackgroundLeft, AndroidUtilities.dp(44.0f) + iDp15);
                                    this.selectorDrawable[0].draw(canvas);
                                }
                                if (this.instantViewLayout != null) {
                                    canvas.save();
                                    canvas.translate(currentBackgroundLeft + this.instantTextX, iDp15 + AndroidUtilities.dp(14.5f));
                                    this.instantViewLayout.draw(canvas);
                                    canvas.restore();
                                }
                                updatePollAnimations(j10);
                                canvas.restore();
                                quoteHighlight = this.quoteHighlight;
                                if (quoteHighlight != null && quoteHighlight.todo && (messageDrawable = this.currentBackgroundDrawable) != null) {
                                    canvas.save();
                                    canvas.clipPath(messageDrawable.makePath());
                                    Paint paint72 = this.quoteHighlight.paint;
                                    MessageObject messageObject112 = this.currentMessageObject;
                                    int themedColor52 = getThemedColor((messageObject112 == null && messageObject112.isOutOwner() && !this.currentMessageObject.preview) ? Theme.key_chat_outReplyLine : Theme.key_chat_inReplyLine);
                                    Theme.isCurrentThemeDark();
                                    paint72.setColor(Theme.multAlpha(themedColor52, 0.2f));
                                    this.quoteHighlight.draw(canvas, this.textX, this.textY, messageDrawable.getBounds(), getHighlightAlpha(true));
                                    canvas.restore();
                                }
                            }
                        }
                        f13 = BitmapDescriptorFactory.HUE_RED;
                        transitionParams = this.transitionParams;
                        if (transitionParams.animateBackgroundBoundsInner) {
                        }
                        if (this.currentMessageObject.isOutOwner()) {
                        }
                        float f462 = iDp;
                        TransitionParams transitionParams62 = this.transitionParams;
                        z5 = transitionParams62.animateBackgroundBoundsInner;
                        if (z5) {
                        }
                        float f472 = f462;
                        float f482 = this.backgroundWidth;
                        if (z5) {
                        }
                        float f492 = f482;
                        if (this.titleLayout == null) {
                        }
                        int iDp82 = i15 + AndroidUtilities.dp(20.0f) + this.namesOffset;
                        if (this.docTitleLayout == null) {
                        }
                        if (this.pollClosed) {
                            f18 = f15;
                            j3 = j2;
                            if (Build.VERSION.SDK_INT < 21) {
                                i16 = 1;
                                boolean zIsTodo2 = this.currentMessageObject.isTodo();
                                if (zIsTodo2) {
                                    size = this.pollButtons.size();
                                    i17 = 0;
                                    int iDp132 = 0;
                                    while (i17 < size) {
                                    }
                                    long j102 = j3;
                                    f = 0.5f;
                                    if (this.drawInstantView) {
                                    }
                                }
                            }
                        } else {
                            f18 = f15;
                            j3 = j2;
                            if (Build.VERSION.SDK_INT < 21) {
                            }
                        }
                    } else {
                        str = "paintChatTimeBackground";
                        f = 0.5f;
                        if (i35 == 12) {
                            drawContact(canvas);
                        }
                    }
                    str2 = "paintChatTimeBackground";
                    f = 0.5f;
                }
                str2 = str;
            }
            if (!this.drawImageButton || !this.photoImage.getVisible() || this.isSmallImage || this.currentMessageObject.isRepostVideoPreview) {
                messageDrawable2 = null;
            } else {
                float f56 = this.controlsAlpha;
                if (f56 != 1.0f) {
                    this.radialProgress.setOverrideAlpha(f56);
                }
                if (this.photoImage.hasImageSet()) {
                    messageDrawable2 = null;
                    this.radialProgress.setBackgroundDrawable(null);
                } else {
                    messageDrawable2 = null;
                    this.radialProgress.setBackgroundDrawable(isDrawSelectionBackground() ? this.currentBackgroundSelectedDrawable : this.currentBackgroundDrawable);
                }
                MessageObject messageObject12 = this.currentMessageObject;
                if (messageObject12 == null || !messageObject12.isRoundVideo() || (this.currentMessageObject.mediaExists() && !this.currentMessageObject.isRoundOnce())) {
                    MessageObject messageObject13 = this.currentMessageObject;
                    if (messageObject13 != null && messageObject13.isRoundVideo()) {
                        this.radialProgress.setProgressRect(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX() + this.photoImage.getImageWidth(), this.photoImage.getImageY() + this.photoImage.getImageHeight());
                        canvas.saveLayerAlpha(this.radialProgress.getProgressRect(), (int) (getVideoTranscriptionProgress() * 255.0f), 31);
                        float imageHeight = this.photoImage.getImageHeight() / (this.radialProgress.getRadius() * 2);
                        canvas.scale(imageHeight, imageHeight, this.radialProgress.getProgressRect().centerX(), this.radialProgress.getProgressRect().centerY());
                        z9 = true;
                    }
                    if ((this.isRoundVideo || !this.hasLinkPreview) && (!this.currentMessageObject.needDrawBluredPreview() || !MediaController.getInstance().isPlayingMessage(this.currentMessageObject))) {
                        if (this.currentMessageObject.hasMediaSpoilers()) {
                            MessageObject messageObject14 = this.currentMessageObject;
                            if ((messageObject14.isMediaSpoilersRevealed && messageObject14.revealingMediaSpoilers) || !SharedConfig.isAutoplayVideo() || this.currentMessageObject.isRepostPreview || this.currentMessagesGroup != null || (this.radialProgress.getIcon() != 0 && this.radialProgress.getIcon() != 4)) {
                                if (!this.currentMessageObject.isHiddenSensitive()) {
                                    if (this.currentMessageObject.needDrawBluredPreview()) {
                                        this.radialProgress.overrideCircleAlpha = BitmapDescriptorFactory.HUE_RED;
                                    } else if (this.isRoundVideo) {
                                        this.radialProgress.overrideCircleAlpha = ((1.0f - getVideoTranscriptionProgress()) * 0.75f) + 0.25f;
                                    }
                                    if (!this.currentMessageObject.isRoundOnce() && ((!SharedConfig.isAutoplayVideo() || this.currentMessagesGroup != null) && this.currentMessageObject.hasMediaSpoilers() && !this.currentMessageObject.isMediaSpoilersRevealed && this.radialProgress.getIcon() == 0)) {
                                        canvas.saveLayerAlpha(this.radialProgress.getProgressRect(), (int) (this.mediaSpoilerRevealProgress * 255.0f), 31);
                                    }
                                    drawRadialProgress(canvas);
                                    if (!this.currentMessageObject.isRoundOnce() && ((!SharedConfig.isAutoplayVideo() || this.currentMessagesGroup != null) && this.currentMessageObject.hasMediaSpoilers() && !this.currentMessageObject.isMediaSpoilersRevealed && this.radialProgress.getIcon() == 0)) {
                                        canvas.restore();
                                    }
                                    if (this.currentMessageObject.needDrawBluredPreview() || this.isRoundVideo) {
                                        this.radialProgress.overrideCircleAlpha = 1.0f;
                                    }
                                }
                            }
                        }
                    }
                    if (z9) {
                        canvas.restore();
                    }
                } else {
                    this.radialProgress.setProgressRect(this.photoImage.getImageX() + ((this.photoImage.getImageWidth() / 2.0f) - this.radialProgress.getRadius()), this.photoImage.getImageY() + ((this.photoImage.getImageHeight() / 2.0f) - this.radialProgress.getRadius()), this.photoImage.getImageX() + (this.photoImage.getImageWidth() / 2.0f) + this.radialProgress.getRadius(), this.photoImage.getImageY() + (this.photoImage.getImageHeight() / 2.0f) + this.radialProgress.getRadius());
                }
                z9 = false;
                if (this.isRoundVideo) {
                    if (this.currentMessageObject.hasMediaSpoilers()) {
                    }
                } else if (this.currentMessageObject.hasMediaSpoilers()) {
                }
            }
            boolean z14 = (this.buttonState != -1 || (messageObject6 = this.currentMessageObject) == null || !messageObject6.needDrawBluredPreview() || MediaController.getInstance().isPlayingMessage(this.currentMessageObject) || this.currentMessageObject.messageOwner.destroyTime == 0) ? false : true;
            if (z14 && this.timerParticlesAlpha == null) {
                i33 = 7;
                canvas2 = canvas;
                this.timerParticlesAlpha = new AnimatedFloat(BitmapDescriptorFactory.HUE_RED, this, 150L, 120L, CubicBezierInterpolator.EASE_OUT);
            } else {
                canvas2 = canvas;
                i33 = 7;
            }
            AnimatedFloat animatedFloat = this.timerParticlesAlpha;
            if (animatedFloat == null) {
                f26 = BitmapDescriptorFactory.HUE_RED;
                f25 = BitmapDescriptorFactory.HUE_RED;
            } else {
                f25 = animatedFloat.set(z14);
                f26 = BitmapDescriptorFactory.HUE_RED;
            }
            if (f25 > f26 && this.photoImage.getVisible()) {
                Theme.chat_deleteProgressPaint.setColor(-1);
                Theme.chat_deleteProgressPaint.setAlpha((int) (f25 * 255.0f * this.controlsAlpha));
                Theme.chat_deleteProgressPaint.setStrokeWidth(AndroidUtilities.dp(2.0f));
                float fMax = (Math.max(0L, (this.currentMessageObject.messageOwner.destroyTime * 1000) - (System.currentTimeMillis() + (ConnectionsManager.getInstance(this.currentAccount).getTimeDifference() * 1000))) / (this.currentMessageObject.messageOwner.ttl * 1000.0f)) * (-360.0f);
                canvas.drawArc(this.deleteProgressRect, -90.0f, fMax, false, Theme.chat_deleteProgressPaint);
                if (this.timerParticles == null) {
                    this.timerParticles = new TimerParticles();
                }
                this.timerParticles.draw(canvas, Theme.chat_deleteProgressPaint, this.deleteProgressRect, fMax, this.controlsAlpha);
                invalidate();
                updateSecretTimeText(this.currentMessageObject);
            }
            if (this.drawVideoImageButton || this.animatingDrawVideoImageButton != 0) {
                MessageObject messageObject15 = this.currentMessageObject;
                if (!messageObject15.isRepostPreview && !messageObject15.sendPreview && this.photoImage.getVisible() && !this.isSmallImage && !this.currentMessageObject.isHiddenSensitive()) {
                    float f57 = this.controlsAlpha;
                    if (this.drawPhotoImage && (messageObject3 = this.currentMessageObject) != null && messageObject3.hasMediaSpoilers() && this.currentMessageObject.isSensitive()) {
                        if (this.currentMessageObject.isMediaSpoilersRevealed) {
                            float f58 = this.mediaSpoilerRevealProgress;
                            if (f58 != BitmapDescriptorFactory.HUE_RED && f58 < 1.0f) {
                                f57 *= this.mediaSpoilerRevealProgress;
                            }
                        }
                    }
                    this.videoRadialProgress.setOverrideAlpha(f57);
                    this.videoRadialProgress.draw(canvas2);
                }
            }
            if (this.drawMediaCheckBox) {
                int i54 = this.documentAttachType;
                if (i54 == 5 || (i54 == 1 && !this.drawPhotoImage)) {
                    int iDp16 = AndroidUtilities.dp(20.0f);
                    this.mediaCheckBox.setBackgroundType(this.radialProgress.getMiniIcon() != 4 ? 12 : 13);
                    this.mediaCheckBox.setBounds(this.buttonX + AndroidUtilities.dp(28.0f), this.buttonY + AndroidUtilities.dp(28.0f), iDp16, iDp16);
                    this.mediaCheckBox.setColor(this.currentMessageObject.isOutOwner() ? Theme.key_chat_outTimeText : Theme.key_chat_inTimeText, this.currentMessageObject.isOutOwner() ? Theme.key_chat_outLoader : Theme.key_chat_inLoader, this.currentMessageObject.isOutOwner() ? Theme.key_chat_outBubble : Theme.key_chat_inBubble);
                    this.mediaCheckBox.setBackgroundDrawable(isDrawSelectionBackground() ? this.currentBackgroundSelectedDrawable : this.currentBackgroundDrawable);
                } else {
                    int iDp17 = AndroidUtilities.dp(21.0f);
                    this.mediaCheckBox.setBackgroundType(0);
                    this.mediaCheckBox.setBounds(((int) this.photoImage.getImageX2()) - AndroidUtilities.dp(25.0f), ((int) this.photoImage.getImageY()) + AndroidUtilities.dp(4.0f), iDp17, iDp17);
                    this.mediaCheckBox.setColor(-1, -1, this.currentMessageObject.isOutOwner() ? Theme.key_chat_outBubbleSelected : Theme.key_chat_inBubbleSelected);
                    this.mediaCheckBox.setBackgroundDrawable(messageDrawable2);
                }
                this.mediaCheckBox.draw(canvas2);
            }
            if (this.documentAttachType == i33) {
                boolean zIsPlayingMessage2 = MediaController.getInstance().isPlayingMessage(this.currentMessageObject);
                MessageObject messageObject16 = this.currentMessageObject;
                if (messageObject16.type == 5) {
                    if (messageObject16.isOutOwner()) {
                        float fRoundPlayingMessageSize = (AndroidUtilities.roundPlayingMessageSize(this.isSideMenued) - AndroidUtilities.roundMessageSize) * 0.2f;
                        boolean z15 = this.isPlayingRound;
                        float f59 = z15 ? fRoundPlayingMessageSize : BitmapDescriptorFactory.HUE_RED;
                        TransitionParams transitionParams14 = this.transitionParams;
                        f27 = transitionParams14.animatePlayingRound ? fRoundPlayingMessageSize * (z15 ? transitionParams14.animateChangeProgress : 1.0f - transitionParams14.animateChangeProgress) : f59;
                    } else {
                        f27 = BitmapDescriptorFactory.HUE_RED;
                    }
                    MessageObject messageObject17 = this.currentMessageObject;
                    if (messageObject17 == null || !messageObject17.isRoundOnce()) {
                        fDp2 = this.backgroundDrawableLeft + this.transitionParams.deltaLeft + ((this.currentMessageObject.isOutOwner() || this.drawPinnedBottom || !this.drawBackground) ? 0 : AndroidUtilities.dp(6.0f)) + AndroidUtilities.dp(8.0f) + this.roundPlayingDrawableProgress + f27;
                        fDp3 = this.layoutHeight - AndroidUtilities.dp(28 - (this.drawPinnedBottom ? 2 : 0));
                    } else {
                        fDp2 = this.photoImage.getImageX();
                        fDp3 = (this.photoImage.getImageY2() - (AndroidUtilities.dp(this.drawPinnedBottom ? 4.0f : 5.0f) * (1.0f - getVideoTranscriptionProgress()))) - AndroidUtilities.dp(17.0f);
                    }
                    if (!this.reactionsLayoutInBubble.isEmpty && ((messageObject5 = this.currentMessageObject) == null || !messageObject5.isRoundOnce())) {
                        fDp3 -= this.reactionsLayoutInBubble.totalHeight;
                    }
                    TransitionParams transitionParams15 = this.transitionParams;
                    transitionParams15.lastDrawRoundVideoDotY = fDp3;
                    if (transitionParams15.animateRoundVideoDotY) {
                        float f60 = transitionParams15.animateFromRoundVideoDotY;
                        float f61 = transitionParams15.animateChangeProgress;
                        fDp3 = (fDp3 * f61) + (f60 * (1.0f - f61));
                    }
                    int iDp18 = this.timeAudioX;
                    if (!this.hasLinkPreview) {
                        if (this.currentMessageObject.isOutOwner()) {
                            int width = getWidth();
                            TransitionParams transitionParams16 = this.transitionParams;
                            iDp18 = ((width - (transitionParams16.animateBackgroundBoundsInner ? (int) ((this.backgroundWidth - transitionParams16.deltaLeft) + transitionParams16.deltaRight) : this.backgroundWidth)) - ((this.drawPinnedBottom || !this.mediaBackground) ? 0 : AndroidUtilities.dp(8.0f))) + AndroidUtilities.dp(67.0f);
                        }
                        fDp2 = AndroidUtilities.lerp(fDp2, iDp18 - AndroidUtilities.dp(4.0f), getVideoTranscriptionProgress());
                        fDp3 = AndroidUtilities.lerp(fDp3, ((AndroidUtilities.dp(44.0f) + this.namesOffset) + this.mediaOffsetY) - AndroidUtilities.dp(1.7f), getVideoTranscriptionProgress());
                    }
                    this.rect.set(fDp2, fDp3, this.timeWidthAudio + fDp2 + AndroidUtilities.dp(22.0f), AndroidUtilities.dp(17.0f) + fDp3);
                    applyServiceShaderMatrix();
                    Paint themedPaint = getThemedPaint("paintChatActionBackground");
                    int alpha9 = themedPaint.getAlpha();
                    themedPaint.setAlpha((int) (alpha9 * this.timeAlpha * f * (1.0f - getVideoTranscriptionProgress())));
                    canvas2.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), themedPaint);
                    if (hasGradientService()) {
                        Paint themedPaint2 = getThemedPaint("paintChatActionBackgroundDarken");
                        int alpha10 = themedPaint2.getAlpha();
                        themedPaint2.setAlpha((int) (alpha10 * this.timeAlpha * (1.0f - getVideoTranscriptionProgress())));
                        canvas2.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), themedPaint2);
                        themedPaint2.setAlpha(alpha10);
                    }
                    themedPaint.setAlpha(alpha9);
                    boolean z16 = zIsPlayingMessage2 || !this.currentMessageObject.isContentUnread();
                    if (z16) {
                        float f62 = this.roundPlayingDrawableProgress;
                        float f63 = 1.0f;
                        if (f62 != 1.0f) {
                            float f64 = f62 + 0.10666667f;
                            this.roundPlayingDrawableProgress = f64;
                            if (f64 > 1.0f) {
                                this.roundPlayingDrawableProgress = f63;
                            } else {
                                invalidate();
                            }
                        } else if (!z16) {
                            float f65 = this.roundPlayingDrawableProgress;
                            f63 = BitmapDescriptorFactory.HUE_RED;
                            if (f65 != BitmapDescriptorFactory.HUE_RED) {
                                float f66 = f65 - 0.10666667f;
                                this.roundPlayingDrawableProgress = f66;
                                if (f66 < BitmapDescriptorFactory.HUE_RED) {
                                }
                            }
                        }
                        if (z16) {
                            if (!zIsPlayingMessage2 || MediaController.getInstance().isMessagePaused()) {
                                this.roundVideoPlayingDrawable.stop();
                            } else {
                                this.roundVideoPlayingDrawable.start();
                            }
                        }
                        if (this.roundPlayingDrawableProgress < 1.0f) {
                            float fDp5 = this.timeWidthAudio + fDp2 + AndroidUtilities.dp(12.0f);
                            float fDp6 = AndroidUtilities.dp(8.3f) + fDp3;
                            canvas.save();
                            float f67 = 1.0f - this.roundPlayingDrawableProgress;
                            canvas2.scale(f67, f67, fDp5, fDp6);
                            Theme.chat_docBackPaint.setColor(Theme.chat_timePaint.getColor());
                            Theme.chat_docBackPaint.setAlpha((int) (this.timeAlpha * 255.0f * (1.0f - this.roundPlayingDrawableProgress)));
                            canvas2.drawCircle(fDp5, fDp6, AndroidUtilities.dp(3.0f), Theme.chat_docBackPaint);
                            canvas.restore();
                        }
                        if (this.roundPlayingDrawableProgress > BitmapDescriptorFactory.HUE_RED) {
                            BaseCell.setDrawableBounds(this.roundVideoPlayingDrawable, this.timeWidthAudio + fDp2 + AndroidUtilities.dp(6.0f), AndroidUtilities.dp(2.3f) + fDp3);
                            canvas.save();
                            float f68 = this.roundPlayingDrawableProgress;
                            canvas2.scale(f68, f68, this.roundVideoPlayingDrawable.getBounds().centerX(), this.roundVideoPlayingDrawable.getBounds().centerY());
                            if (this.hasLinkPreview) {
                                roundVideoPlayingDrawable = this.roundVideoPlayingDrawable;
                                videoTranscriptionProgress = BitmapDescriptorFactory.HUE_RED;
                            } else {
                                this.roundVideoPlayingDrawable.timeColor = Theme.chat_timePaint.getColor();
                                roundVideoPlayingDrawable = this.roundVideoPlayingDrawable;
                                videoTranscriptionProgress = getVideoTranscriptionProgress();
                            }
                            roundVideoPlayingDrawable.colorProgress = videoTranscriptionProgress;
                            this.roundVideoPlayingDrawable.setAlpha((int) (this.roundPlayingDrawableProgress * 255.0f * (1.0f - getVideoTranscriptionProgress())));
                            this.roundVideoPlayingDrawable.draw(canvas2);
                            canvas.restore();
                        }
                        imageX = fDp2 + AndroidUtilities.dp(4.0f);
                        imageY2 = fDp3 + AndroidUtilities.dp(1.7f);
                    }
                } else {
                    imageX = this.photoImage.getImageX();
                    imageY2 = this.photoImage.getImageY2() - (this.durationLayout != null ? r2.getHeight() : 0);
                }
                if (this.durationLayout != null) {
                    Theme.chat_timePaint.setAlpha((int) (this.timeAlpha * 255.0f));
                    canvas.save();
                    canvas2.translate(imageX, imageY2);
                    this.durationLayout.draw(canvas2);
                    canvas.restore();
                    Theme.chat_timePaint.setAlpha(255);
                }
            }
            if (this.drawPhotoImage && (messageObject4 = this.currentMessageObject) != null && messageObject4.hasMediaSpoilers() && this.currentMessageObject.isSensitive()) {
                if (this.currentMessageObject.isMediaSpoilersRevealed) {
                    float f69 = this.mediaSpoilerRevealProgress;
                    if (f69 == BitmapDescriptorFactory.HUE_RED || f69 >= 1.0f) {
                        return;
                    }
                }
                if (this.sensitiveText == null) {
                    SpannableStringBuilder spannableStringBuilder = new SpannableStringBuilder("x " + LocaleController.getString(R.string.MessageSensitiveContent));
                    spannableStringBuilder.setSpan(new ColoredImageSpan(R.drawable.filled_sensitive), 0, 1, 33);
                    this.sensitiveText = new Text(spannableStringBuilder, 14.0f, AndroidUtilities.getTypeface(AndroidUtilities.TYPEFACE_ROBOTO_MEDIUM));
                }
                Text text = this.sensitiveText;
                if (this.photoImage.getImageWidth() < AndroidUtilities.dp(26.0f) + this.sensitiveText.getCurrentWidth()) {
                    if (this.sensitiveTextShort == null) {
                        SpannableStringBuilder spannableStringBuilder2 = new SpannableStringBuilder("x " + LocaleController.getString(R.string.MessageSensitiveContentShort));
                        spannableStringBuilder2.setSpan(new ColoredImageSpan(R.drawable.filled_sensitive), 0, 1, 33);
                        this.sensitiveTextShort = new Text(spannableStringBuilder2, 14.0f, AndroidUtilities.getTypeface(AndroidUtilities.TYPEFACE_ROBOTO_MEDIUM));
                    }
                    text = this.sensitiveTextShort;
                }
                float imageX6 = this.photoImage.getImageX() + (this.photoImage.getImageWidth() / 2.0f);
                float imageHeight2 = (this.photoImage.getImageHeight() / 2.0f) + this.photoImage.getImageY();
                float currentWidth = text.getCurrentWidth() + AndroidUtilities.dp(26.0f);
                float fDp7 = AndroidUtilities.dp(32.0f) / 2.0f;
                float fLerp2 = AndroidUtilities.lerp(0.8f, 1.0f, 1.0f - this.mediaSpoilerRevealProgress);
                RectF rectF2 = AndroidUtilities.rectTmp;
                float f70 = currentWidth / 2.0f;
                float f71 = f70 * fLerp2;
                float f72 = fDp7 * fLerp2;
                rectF2.set(imageX6 - f71, imageHeight2 - f72, f71 + imageX6, f72 + imageHeight2);
                this.rectPath.reset();
                this.rectPath.addRoundRect(rectF2, fDp7, fDp7, Path.Direction.CW);
                canvas.save();
                canvas2.clipPath(this.rectPath);
                float alpha11 = this.blurredPhotoImage.getAlpha();
                this.blurredPhotoImage.setAlpha((1.0f - this.mediaSpoilerRevealProgress) * alpha11);
                this.blurredPhotoImage.draw(canvas2);
                this.blurredPhotoImage.setAlpha(alpha11);
                canvas.restore();
                int alpha12 = getThemedPaint(str2).getAlpha();
                getThemedPaint(str2).setAlpha((int) (alpha12 * this.controlsAlpha * (1.0f - this.mediaSpoilerRevealProgress) * 0.35f));
                canvas2.drawRoundRect(rectF2, fDp7, fDp7, getThemedPaint(str2));
                getThemedPaint(str2).setAlpha(alpha12);
                canvas.save();
                canvas2.scale(fLerp2, fLerp2, imageX6, imageHeight2);
                text.draw(canvas, AndroidUtilities.dp(13.0f) + (imageX6 - f70), imageHeight2, -1, 1.0f - this.mediaSpoilerRevealProgress);
                canvas.restore();
            }
        }
    }

    protected void drawPhotoBlurRect(Canvas canvas, RectF rectF) {
        this.rectPath.rewind();
        this.rectPath.addRoundRect(rectF, rectF.width() / 2.0f, rectF.height() / 2.0f, Path.Direction.CW);
        canvas.save();
        canvas.clipPath(this.rectPath);
        float alpha = this.photoImage.getAlpha();
        this.photoImage.setAlpha((this.currentMessageObject.isRoundOnce() ? 1.0f : 0.5f) * alpha);
        this.photoImage.draw(canvas);
        this.photoImage.setAlpha(alpha);
        canvas.restore();
        Paint themedPaint = getThemedPaint("paintChatTimeBackground");
        int alpha2 = themedPaint.getAlpha();
        themedPaint.setAlpha((int) (alpha2 * this.controlsAlpha * 0.4f));
        canvas.drawRoundRect(rectF, rectF.width() / 2.0f, rectF.height() / 2.0f, themedPaint);
        themedPaint.setAlpha(alpha2);
    }

    protected boolean drawPhotoImage(Canvas canvas) {
        return this.photoImage.draw(canvas);
    }

    public boolean drawPinnedBottom() {
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages == null || !groupedMessages.isDocuments) {
            return this.pinnedBottom;
        }
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if (groupedMessagePosition == null || (groupedMessagePosition.flags & 8) == 0) {
            return true;
        }
        return this.pinnedBottom;
    }

    public boolean drawPinnedTop() {
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages == null || !groupedMessages.isDocuments) {
            return this.pinnedTop;
        }
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if (groupedMessagePosition == null || (groupedMessagePosition.flags & 4) == 0) {
            return true;
        }
        return this.pinnedTop;
    }

    public void drawProgressLoadingLink(Canvas canvas, int i) {
        updateProgressLoadingLink();
        ArrayList arrayList = this.progressLoadingLinkDrawables;
        if (arrayList == null || arrayList.isEmpty()) {
            return;
        }
        MessageObject messageObject = this.currentMessageObject;
        int themedColor = getThemedColor((messageObject == null || !messageObject.isOutOwner()) ? Theme.key_chat_linkSelectBackground : Theme.key_chat_outLinkSelectBackground);
        int i2 = 0;
        while (i2 < this.progressLoadingLinkDrawables.size()) {
            LoadingDrawableLocation loadingDrawableLocation = (LoadingDrawableLocation) this.progressLoadingLinkDrawables.get(i2);
            if (loadingDrawableLocation.blockNum == i) {
                LoadingDrawable loadingDrawable = loadingDrawableLocation.drawable;
                loadingDrawable.setColors(Theme.multAlpha(themedColor, 0.85f), Theme.multAlpha(themedColor, 2.0f), Theme.multAlpha(themedColor, 3.5f), Theme.multAlpha(themedColor, 6.0f));
                loadingDrawable.draw(canvas);
                invalidate();
                if (loadingDrawable.isDisappeared()) {
                    this.progressLoadingLinkDrawables.remove(i2);
                    i2--;
                }
            }
            i2++;
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:29:0x009f  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    protected void drawRadialProgress(Canvas canvas) {
        MessageObject messageObject;
        boolean zIsRoundOnce = this.currentMessageObject.isRoundOnce();
        if (zIsRoundOnce) {
            RectF rectF = AndroidUtilities.rectTmp;
            rectF.set(this.radialProgress.getProgressRect());
            rectF.inset(-AndroidUtilities.dp(15.0f), -AndroidUtilities.dp(15.0f));
            canvas.saveLayerAlpha(rectF, (int) (this.radialProgressAlpha * 255.0f), 31);
        } else {
            canvas.save();
            int i = this.currentMessageObject.type;
            if (this.drawPhotoImage && (i == 3 || i == 1 || i == 8)) {
                canvas.clipRect(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX2(), this.photoImage.getImageY2());
            }
        }
        if (this.currentMessageObject.needDrawBluredPreview()) {
            drawPhotoBlurRect(canvas, this.radialProgress.getProgressRect());
        }
        this.radialProgress.iconScale = 1.0f;
        if (this.drawPhotoImage && (messageObject = this.currentMessageObject) != null && messageObject.hasMediaSpoilers() && this.currentMessageObject.isSensitive()) {
            if (this.currentMessageObject.isMediaSpoilersRevealed) {
                float f = this.mediaSpoilerRevealProgress;
                if (f != BitmapDescriptorFactory.HUE_RED && f < 1.0f) {
                    this.radialProgress.iconScale *= this.mediaSpoilerRevealProgress;
                }
            }
        }
        this.radialProgress.draw(canvas);
        if (zIsRoundOnce) {
            canvas.save();
            drawPhotoBlurRect(canvas, getRadialProgress().getProgressRect());
            getRadialProgress().draw(canvas);
            RectF progressRect = getRadialProgress().getProgressRect();
            float fCenterX = progressRect.centerX() + AndroidUtilities.dp(18.0f);
            float fCenterY = progressRect.centerY() + AndroidUtilities.dp(18.0f);
            float fDp = AndroidUtilities.dp(10.0f);
            float fDp2 = AndroidUtilities.dp(1.33f) + fDp;
            if (this.clipPaint == null) {
                Paint paint = new Paint(1);
                this.clipPaint = paint;
                paint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.CLEAR));
            }
            canvas.drawCircle(fCenterX, fCenterY, fDp2, this.clipPaint);
            RectF rectF2 = AndroidUtilities.rectTmp;
            rectF2.set(fCenterX - fDp, fCenterY - fDp, fCenterX + fDp, fDp + fCenterY);
            drawPhotoBlurRect(canvas, rectF2);
            if (this.oncePeriod == null) {
                CaptionContainerView.PeriodDrawable periodDrawable = new CaptionContainerView.PeriodDrawable(3);
                this.oncePeriod = periodDrawable;
                periodDrawable.updateColors(-1, 0, 0);
                CaptionContainerView.PeriodDrawable periodDrawable2 = this.oncePeriod;
                periodDrawable2.diameterDp = 14.0f;
                periodDrawable2.setTextSize(10.0f);
                this.oncePeriod.strokePaint.setStrokeWidth(AndroidUtilities.dpf2(1.5f));
                this.oncePeriod.setValue(1, false, false);
                this.oncePeriod.textOffsetX = -AndroidUtilities.dpf2(0.33f);
                this.oncePeriod.textOffsetY = AndroidUtilities.dpf2(0.33f);
            }
            CaptionContainerView.PeriodDrawable periodDrawable3 = this.oncePeriod;
            periodDrawable3.diameterDp = 14.0f;
            periodDrawable3.setTextSize(10.0f);
            this.oncePeriod.setClear(false);
            this.oncePeriod.setCenterXY(fCenterX, fCenterY);
            this.oncePeriod.draw(canvas, 1.0f);
            canvas.restore();
        }
        canvas.restore();
    }

    public void drawReactionsLayout(Canvas canvas, float f, Integer num) {
        if (this.isRoundVideo) {
            this.reactionsLayoutInBubble.drawServiceShaderBackground = 1.0f - getVideoTranscriptionProgress();
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || !messageObject.shouldDrawReactions()) {
            return;
        }
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        boolean z = true;
        if (groupedMessagePosition != null) {
            int i = groupedMessagePosition.flags;
            if ((i & 8) == 0 || (i & 1) == 0) {
                return;
            }
        }
        ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
        if (reactionsLayoutInBubble.isSmall) {
            return;
        }
        if (reactionsLayoutInBubble.drawServiceShaderBackground > BitmapDescriptorFactory.HUE_RED) {
            applyServiceShaderMatrix();
        }
        if (getAlpha() * f != 1.0f) {
            RectF rectF = AndroidUtilities.rectTmp;
            rectF.set(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, getWidth(), getHeight());
            canvas.saveLayerAlpha(rectF, (int) (f * 255.0f * getAlpha()), 31);
        } else {
            z = false;
        }
        ReactionsLayoutInBubble reactionsLayoutInBubble2 = this.reactionsLayoutInBubble;
        if (reactionsLayoutInBubble2.drawServiceShaderBackground > BitmapDescriptorFactory.HUE_RED || !this.transitionParams.animateBackgroundBoundsInner || this.currentPosition != null || this.isRoundVideo) {
            reactionsLayoutInBubble2.setScrimProgress(BitmapDescriptorFactory.HUE_RED, false);
            ReactionsLayoutInBubble reactionsLayoutInBubble3 = this.reactionsLayoutInBubble;
            TransitionParams transitionParams = this.transitionParams;
            reactionsLayoutInBubble3.draw(canvas, transitionParams.animateChange ? transitionParams.animateChangeProgress : 1.0f, num);
        } else {
            canvas.save();
            canvas.clipRect(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, getMeasuredWidth(), getBackgroundDrawableBottom() + this.transitionParams.deltaBottom);
            this.reactionsLayoutInBubble.setScrimProgress(BitmapDescriptorFactory.HUE_RED, false);
            ReactionsLayoutInBubble reactionsLayoutInBubble4 = this.reactionsLayoutInBubble;
            TransitionParams transitionParams2 = this.transitionParams;
            reactionsLayoutInBubble4.draw(canvas, transitionParams2.animateChange ? transitionParams2.animateChangeProgress : 1.0f, num);
            canvas.restore();
        }
        if (z) {
            canvas.restore();
        }
    }

    public void drawReactionsLayoutOverlay(Canvas canvas, float f) {
        if (this.isRoundVideo) {
            this.reactionsLayoutInBubble.drawServiceShaderBackground = 1.0f - getVideoTranscriptionProgress();
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || !messageObject.shouldDrawReactions()) {
            return;
        }
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        boolean z = true;
        if (groupedMessagePosition != null) {
            int i = groupedMessagePosition.flags;
            if ((i & 8) == 0 || (i & 1) == 0) {
                return;
            }
        }
        ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
        if (reactionsLayoutInBubble.isSmall) {
            return;
        }
        if (reactionsLayoutInBubble.drawServiceShaderBackground > BitmapDescriptorFactory.HUE_RED) {
            applyServiceShaderMatrix();
        }
        if (getAlpha() * f != 1.0f) {
            RectF rectF = AndroidUtilities.rectTmp;
            rectF.set(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, getWidth(), getHeight());
            canvas.saveLayerAlpha(rectF, (int) (f * 255.0f * getAlpha()), 31);
        } else {
            z = false;
        }
        ReactionsLayoutInBubble reactionsLayoutInBubble2 = this.reactionsLayoutInBubble;
        if (reactionsLayoutInBubble2.drawServiceShaderBackground > BitmapDescriptorFactory.HUE_RED || !this.transitionParams.animateBackgroundBoundsInner || this.currentPosition != null || this.isRoundVideo) {
            TransitionParams transitionParams = this.transitionParams;
            reactionsLayoutInBubble2.drawOverlay(canvas, transitionParams.animateChange ? transitionParams.animateChangeProgress : 1.0f);
        } else {
            canvas.save();
            canvas.clipRect(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, getMeasuredWidth(), getBackgroundDrawableBottom() + this.transitionParams.deltaBottom);
            ReactionsLayoutInBubble reactionsLayoutInBubble3 = this.reactionsLayoutInBubble;
            TransitionParams transitionParams2 = this.transitionParams;
            reactionsLayoutInBubble3.drawOverlay(canvas, transitionParams2.animateChange ? transitionParams2.animateChangeProgress : 1.0f);
            canvas.restore();
        }
        if (z) {
            canvas.restore();
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:23:0x004e  */
    /* JADX WARN: Removed duplicated region for block: B:29:0x0060  */
    /* JADX WARN: Removed duplicated region for block: B:36:0x0075  */
    /* JADX WARN: Removed duplicated region for block: B:42:0x0087  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawRoundProgress(Canvas canvas) {
        int i;
        int i2;
        int alpha;
        float fDp = this.isPlayingRound ? AndroidUtilities.dp(4.0f) : BitmapDescriptorFactory.HUE_RED;
        boolean z = false;
        boolean z2 = MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && MediaController.getInstance().isMessagePaused();
        if (z2 && this.roundSeekbarTouched == 1) {
            z = true;
        }
        if (z2) {
            float f = this.roundToPauseProgress;
            if (f != 1.0f) {
                float f2 = f + 0.07272727f;
                this.roundToPauseProgress = f2;
                if (f2 > 1.0f) {
                    this.roundToPauseProgress = 1.0f;
                } else {
                    invalidate();
                }
            } else if (!z2) {
                float f3 = this.roundToPauseProgress;
                if (f3 != BitmapDescriptorFactory.HUE_RED) {
                    float f4 = f3 - 0.10666667f;
                    this.roundToPauseProgress = f4;
                    if (f4 < BitmapDescriptorFactory.HUE_RED) {
                        this.roundToPauseProgress = BitmapDescriptorFactory.HUE_RED;
                    }
                }
            }
        }
        if (z) {
            float f5 = this.roundToPauseProgress2;
            if (f5 != 1.0f) {
                float f6 = f5 + 0.10666667f;
                this.roundToPauseProgress2 = f6;
                if (f6 > 1.0f) {
                    this.roundToPauseProgress2 = 1.0f;
                } else {
                    invalidate();
                }
            } else if (!z) {
                float f7 = this.roundToPauseProgress2;
                if (f7 != BitmapDescriptorFactory.HUE_RED) {
                    float f8 = f7 - 0.10666667f;
                    this.roundToPauseProgress2 = f8;
                    if (f8 < BitmapDescriptorFactory.HUE_RED) {
                        this.roundToPauseProgress2 = BitmapDescriptorFactory.HUE_RED;
                    }
                }
            }
        }
        float interpolation = z2 ? AndroidUtilities.overshootInterpolator.getInterpolation(this.roundToPauseProgress) : this.roundToPauseProgress;
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animatePlayingRound) {
            fDp = (this.isPlayingRound ? transitionParams.animateChangeProgress : 1.0f - transitionParams.animateChangeProgress) * AndroidUtilities.dp(4.0f);
        }
        float fDp2 = fDp + (AndroidUtilities.dp(16.0f) * interpolation);
        if (this.roundToPauseProgress > BitmapDescriptorFactory.HUE_RED) {
            Theme.getRadialSeekbarShadowDrawable().draw(canvas, this.photoImage.getCenterX(), this.photoImage.getCenterY(), this.photoImage.getImageWidth() / 2.0f, this.roundToPauseProgress);
        }
        this.rect.set(this.photoImage.getImageX() + AndroidUtilities.dpf2(1.5f) + fDp2, this.photoImage.getImageY() + AndroidUtilities.dpf2(1.5f) + fDp2, (this.photoImage.getImageX2() - AndroidUtilities.dpf2(1.5f)) - fDp2, (this.photoImage.getImageY2() - AndroidUtilities.dpf2(1.5f)) - fDp2);
        if (this.roundProgressAlpha != 1.0f || (!this.hasLinkPreview && getVideoTranscriptionProgress() > BitmapDescriptorFactory.HUE_RED)) {
            int alpha2 = Theme.chat_radialProgressPaint.getAlpha();
            Theme.chat_radialProgressPaint.setAlpha((int) (this.roundProgressAlpha * (!this.hasLinkPreview ? 1.0f - getVideoTranscriptionProgress() : 1.0f) * alpha2));
            i = alpha2;
        } else {
            i = -1;
        }
        VideoForwardDrawable videoForwardDrawable = this.videoForwardDrawable;
        if (videoForwardDrawable != null && videoForwardDrawable.isAnimating()) {
            this.videoForwardDrawable.setBounds((int) this.photoImage.getImageX(), (int) this.photoImage.getImageY(), (int) (this.photoImage.getImageX() + this.photoImage.getImageWidth()), (int) (this.photoImage.getImageY() + this.photoImage.getImageHeight()));
            this.videoForwardDrawable.draw(canvas);
        }
        int alpha3 = Theme.chat_radialProgressPaint.getAlpha();
        float strokeWidth = Theme.chat_radialProgressPaint.getStrokeWidth();
        float f9 = this.roundProgressAlpha == 1.0f ? this.currentMessageObject.audioProgress : this.lastDrawingAudioProgress;
        if (interpolation > BitmapDescriptorFactory.HUE_RED) {
            float fWidth = this.rect.width() / 2.0f;
            Theme.chat_radialProgressPaint.setStrokeWidth((0.5f * strokeWidth * this.roundToPauseProgress) + strokeWidth);
            Theme.chat_radialProgressPaint.setAlpha((int) (alpha3 * this.roundToPauseProgress * 0.3f));
            canvas.drawCircle(this.rect.centerX(), this.rect.centerY(), fWidth, Theme.chat_radialProgressPaint);
            Theme.chat_radialProgressPaint.setAlpha(alpha3);
            double dCenterX = this.rect.centerX();
            double d = ((-360.0f) * f9) + 180.0f;
            double dSin = Math.sin(Math.toRadians(d));
            i2 = i;
            double d2 = fWidth;
            Double.isNaN(d2);
            Double.isNaN(dCenterX);
            this.seekbarRoundX = (float) (dCenterX + (dSin * d2));
            double dCenterY = this.rect.centerY();
            double dCos = Math.cos(Math.toRadians(d));
            Double.isNaN(d2);
            Double.isNaN(dCenterY);
            this.seekbarRoundY = (float) (dCenterY + (dCos * d2));
            Theme.chat_radialProgressPausedSeekbarPaint.setColor(-1);
            Theme.chat_radialProgressPausedSeekbarPaint.setAlpha((int) (Math.min(1.0f, interpolation) * 255.0f * (!this.hasLinkPreview ? 1.0f - getVideoTranscriptionProgress() : 1.0f)));
            canvas.drawCircle(this.seekbarRoundX, this.seekbarRoundY, AndroidUtilities.dp(3.0f) + (AndroidUtilities.dp(5.0f) * interpolation) + (AndroidUtilities.dp(3.0f) * this.roundToPauseProgress2), Theme.chat_radialProgressPausedSeekbarPaint);
        } else {
            i2 = i;
        }
        float f10 = this.roundSeekbarOutAlpha;
        if (f10 != BitmapDescriptorFactory.HUE_RED) {
            float f11 = f10 - 0.10666667f;
            this.roundSeekbarOutAlpha = f11;
            if (f11 < BitmapDescriptorFactory.HUE_RED) {
                this.roundSeekbarOutAlpha = BitmapDescriptorFactory.HUE_RED;
            } else {
                invalidate();
            }
        }
        int i3 = i2;
        if (this.roundSeekbarOutAlpha != BitmapDescriptorFactory.HUE_RED) {
            alpha = i3 == -1 ? Theme.chat_radialProgressPaint.getAlpha() : i3;
            float f12 = alpha3;
            Theme.chat_radialProgressPaint.setAlpha((int) ((1.0f - this.roundSeekbarOutAlpha) * f12));
            canvas.drawArc(this.rect, -90.0f, f9 * 360.0f, false, Theme.chat_radialProgressPaint);
            Theme.chat_radialProgressPaint.setAlpha((int) (f12 * this.roundSeekbarOutAlpha));
            canvas.drawArc(this.rect, -90.0f, this.roundSeekbarOutProgress * 360.0f, false, Theme.chat_radialProgressPaint);
        } else {
            canvas.drawArc(this.rect, -90.0f, f9 * 360.0f, false, Theme.chat_radialProgressPaint);
            alpha = i3;
        }
        if (alpha != -1) {
            Theme.chat_radialProgressPaint.setAlpha(alpha);
        }
        Theme.chat_radialProgressPaint.setStrokeWidth(strokeWidth);
    }

    public void drawScrimReaction(Canvas canvas, Integer num, float f, boolean z) {
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if (groupedMessagePosition != null) {
            int i = groupedMessagePosition.flags;
            if ((i & 8) == 0 || (i & 1) == 0) {
                return;
            }
        }
        ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
        if (reactionsLayoutInBubble.isSmall) {
            return;
        }
        reactionsLayoutInBubble.setScrimProgress(f, z);
        this.reactionsLayoutInBubble.draw(canvas, this.transitionParams.animateChangeProgress, num);
    }

    public void drawScrimReactionPreview(View view, Canvas canvas, int i, Integer num, float f) {
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if (groupedMessagePosition != null) {
            int i2 = groupedMessagePosition.flags;
            if ((i2 & 8) == 0 || (i2 & 1) == 0) {
                return;
            }
        }
        ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
        if (reactionsLayoutInBubble.isSmall) {
            return;
        }
        reactionsLayoutInBubble.setScrimProgress(f);
        this.reactionsLayoutInBubble.drawPreview(view, canvas, i, num);
    }

    public void drawServiceBackground(Canvas canvas, RectF rectF, float f, float f2) {
        applyServiceShaderMatrix();
        if (f2 != 1.0f) {
            int alpha = getThemedPaint("paintChatActionBackground").getAlpha();
            getThemedPaint("paintChatActionBackground").setAlpha((int) (alpha * f2));
            canvas.drawRoundRect(rectF, f, f, getThemedPaint("paintChatActionBackground"));
            getThemedPaint("paintChatActionBackground").setAlpha(alpha);
        } else {
            canvas.drawRoundRect(rectF, f, f, getThemedPaint(this.sideButtonPressed ? "paintChatActionBackgroundSelected" : "paintChatActionBackground"));
        }
        if (hasGradientService()) {
            if (f2 == 1.0f) {
                canvas.drawRoundRect(rectF, f, f, Theme.chat_actionBackgroundGradientDarkenPaint);
                return;
            }
            int alpha2 = Theme.chat_actionBackgroundGradientDarkenPaint.getAlpha();
            Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha((int) (f2 * alpha2));
            canvas.drawRoundRect(rectF, f, f, Theme.chat_actionBackgroundGradientDarkenPaint);
            Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha(alpha2);
        }
    }

    public void drawSideButton(Canvas canvas) {
        drawSideButton(canvas, false);
    }

    public void drawSideButton(Canvas canvas, boolean z) {
        float fDp;
        float f;
        float f2;
        float currentTotalHeight;
        Drawable themedDrawable;
        Path path;
        Paint themedPaint;
        MessageObject.GroupedMessages groupedMessages;
        if ((!this.hideSideButtonByQuickShare || z) && this.drawSideButton != 0) {
            MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
            if (groupedMessagePosition == null || (groupedMessages = this.currentMessagesGroup) == null || !groupedMessages.isDocuments || groupedMessagePosition.last) {
                if (this.currentMessageObject.isOutOwner()) {
                    fDp = this.transitionParams.lastBackgroundLeft - AndroidUtilities.dp(40.0f);
                    this.sideStartX = fDp;
                    MessageObject.GroupedMessages groupedMessages2 = this.currentMessagesGroup;
                    if (groupedMessages2 != null) {
                        f = groupedMessages2.transitionParams.offsetLeft;
                        this.sideStartX = fDp + (f - this.animationOffsetX);
                    }
                } else {
                    fDp = this.transitionParams.lastBackgroundRight + AndroidUtilities.dp(8.0f);
                    this.sideStartX = fDp;
                    MessageObject.GroupedMessages groupedMessages3 = this.currentMessagesGroup;
                    if (groupedMessages3 != null) {
                        f = groupedMessages3.transitionParams.offsetRight;
                        this.sideStartX = fDp + (f - this.animationOffsetX);
                    }
                }
                int i = this.drawSideButton;
                float fDp2 = BitmapDescriptorFactory.HUE_RED;
                if (i == 4) {
                    this.sideStartY = AndroidUtilities.dp(6.0f);
                } else {
                    float fDp3 = (this.layoutHeight + this.transitionParams.deltaBottom) - AndroidUtilities.dp(41.0f);
                    this.sideStartY = fDp3;
                    MessageObject messageObject = this.currentMessageObject;
                    if (messageObject.type == 19 && messageObject.textWidth < this.timeTextWidth) {
                        this.sideStartY = fDp3 - AndroidUtilities.dp(22.0f);
                    }
                    MessageObject.GroupedMessages groupedMessages4 = this.currentMessagesGroup;
                    if (groupedMessages4 != null) {
                        float f3 = this.sideStartY;
                        MessageObject.GroupedMessages.TransitionParams transitionParams = groupedMessages4.transitionParams;
                        float f4 = f3 + transitionParams.offsetBottom;
                        this.sideStartY = f4;
                        if (transitionParams.backgroundChangeBounds) {
                            this.sideStartY = f4 - getTranslationY();
                        }
                    }
                    if (this.currentMessageObject.shouldDrawReactions()) {
                        ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                        if (!reactionsLayoutInBubble.isSmall) {
                            if (this.isRoundVideo) {
                                f2 = this.sideStartY;
                                currentTotalHeight = reactionsLayoutInBubble.getCurrentTotalHeight(this.transitionParams.animateChangeProgress) * (1.0f - getVideoTranscriptionProgress());
                            } else if (reactionsLayoutInBubble.drawServiceShaderBackground > BitmapDescriptorFactory.HUE_RED) {
                                f2 = this.sideStartY;
                                currentTotalHeight = reactionsLayoutInBubble.getCurrentTotalHeight(this.transitionParams.animateChangeProgress);
                            }
                            this.sideStartY = f2 - currentTotalHeight;
                        }
                    }
                }
                if (this.drawSideButton != 4) {
                    float fDp4 = ((this.layoutHeight + this.transitionParams.deltaBottom) - AndroidUtilities.dp(32.0f)) / 2.0f;
                    if (this.sideStartY < fDp4) {
                        this.sideStartY = fDp4;
                    }
                }
                if (this.currentMessageObject.type == 19) {
                    if (this.drawSideButton != 3 || this.commentLayout == null) {
                        this.sideStartY = BitmapDescriptorFactory.HUE_RED;
                    } else {
                        this.sideStartY = AndroidUtilities.dp(18.0f);
                    }
                }
                if (!this.currentMessageObject.isOutOwner() && this.isRoundVideo && !this.hasLinkPreview) {
                    float fRoundPlayingMessageSize = this.isAvatarVisible ? (AndroidUtilities.roundPlayingMessageSize(this.isSideMenued) - AndroidUtilities.roundMessageSize) * 0.7f : AndroidUtilities.dp(50.0f);
                    float videoTranscriptionProgress = this.isPlayingRound ? (1.0f - getVideoTranscriptionProgress()) * fRoundPlayingMessageSize : BitmapDescriptorFactory.HUE_RED;
                    if (this.isPlayingRound) {
                        fDp2 = AndroidUtilities.dp(28.0f) * (1.0f - getVideoTranscriptionProgress());
                    }
                    TransitionParams transitionParams2 = this.transitionParams;
                    if (transitionParams2.animatePlayingRound) {
                        videoTranscriptionProgress = (this.isPlayingRound ? transitionParams2.animateChangeProgress : 1.0f - transitionParams2.animateChangeProgress) * (1.0f - getVideoTranscriptionProgress()) * fRoundPlayingMessageSize;
                        fDp2 = AndroidUtilities.dp(28.0f) * (this.isPlayingRound ? this.transitionParams.animateChangeProgress : 1.0f - this.transitionParams.animateChangeProgress) * (1.0f - getVideoTranscriptionProgress());
                    }
                    this.sideStartX -= videoTranscriptionProgress;
                    this.sideStartY -= fDp2;
                }
                this.sideButtonVisible = true;
                if (this.drawSideButton == 3) {
                    if (!this.enterTransitionInProgress || this.currentMessageObject.isVoice()) {
                        drawCommentButton(canvas, 1.0f);
                        return;
                    }
                    return;
                }
                if (SizeNotifierFrameLayout.drawingBlur) {
                    return;
                }
                RectF rectF = this.rect;
                float f5 = this.sideStartX;
                rectF.set(f5, this.sideStartY, AndroidUtilities.dp(32.0f) + f5, this.sideStartY + AndroidUtilities.dp(this.drawSideButton2 == 5 ? 64.0f : 32.0f));
                if (this.rect.right >= getMeasuredWidth()) {
                    this.sideButtonVisible = false;
                    return;
                }
                applyServiceShaderMatrix();
                if (this.drawSideButton == 4 && this.drawSideButton2 == 5 && this.sideButtonPressed) {
                    Path path2 = this.sideButtonPath1;
                    if (path2 == null) {
                        this.sideButtonPath1 = new Path();
                    } else {
                        path2.rewind();
                    }
                    Path path3 = this.sideButtonPath2;
                    if (path3 == null) {
                        this.sideButtonPath2 = new Path();
                    } else {
                        path3.rewind();
                    }
                    if (this.sideButtonPathCorners1 == null) {
                        this.sideButtonPathCorners1 = new float[]{fDp, fDp, fDp, fDp, 0.0f, 0.0f, 0.0f, 0.0f};
                        float fDp5 = AndroidUtilities.dp(16.0f);
                    }
                    if (this.sideButtonPathCorners2 == null) {
                        this.sideButtonPathCorners2 = new float[]{0.0f, 0.0f, 0.0f, 0.0f, fDp, fDp, fDp, fDp};
                        float fDp6 = AndroidUtilities.dp(16.0f);
                    }
                    RectF rectF2 = AndroidUtilities.rectTmp;
                    float f6 = this.sideStartX;
                    rectF2.set(f6, this.sideStartY, AndroidUtilities.dp(32.0f) + f6, this.sideStartY + AndroidUtilities.dp(32.0f));
                    Path path4 = this.sideButtonPath1;
                    float[] fArr = this.sideButtonPathCorners1;
                    Path.Direction direction = Path.Direction.CW;
                    path4.addRoundRect(rectF2, fArr, direction);
                    rectF2.set(this.sideStartX, this.sideStartY + AndroidUtilities.dp(32.0f), this.sideStartX + AndroidUtilities.dp(32.0f), this.sideStartY + AndroidUtilities.dp(64.0f));
                    this.sideButtonPath2.addRoundRect(rectF2, this.sideButtonPathCorners2, direction);
                    if (this.pressedSideButton == 4) {
                        canvas.drawPath(this.sideButtonPath1, getThemedPaint("paintChatActionBackgroundSelected"));
                        path = this.sideButtonPath2;
                        themedPaint = getThemedPaint("paintChatActionBackground");
                    } else {
                        canvas.drawPath(this.sideButtonPath1, getThemedPaint("paintChatActionBackground"));
                        path = this.sideButtonPath2;
                        themedPaint = getThemedPaint("paintChatActionBackgroundSelected");
                    }
                    canvas.drawPath(path, themedPaint);
                } else {
                    canvas.drawRoundRect(this.rect, AndroidUtilities.dp(16.0f), AndroidUtilities.dp(16.0f), getThemedPaint(this.sideButtonPressed ? "paintChatActionBackgroundSelected" : "paintChatActionBackground"));
                }
                if (hasGradientService()) {
                    canvas.drawRoundRect(this.rect, AndroidUtilities.dp(16.0f), AndroidUtilities.dp(16.0f), Theme.chat_actionBackgroundGradientDarkenPaint);
                }
                int i2 = this.drawSideButton;
                if (i2 == 2) {
                    Drawable themedDrawable2 = getThemedDrawable("drawableGoIcon");
                    BaseCell.setDrawableBounds(themedDrawable2, (this.sideStartX + AndroidUtilities.dp(16.0f)) - (themedDrawable2.getIntrinsicWidth() / 2.0f), (this.sideStartY + AndroidUtilities.dp(16.0f)) - (themedDrawable2.getIntrinsicHeight() / 2.0f));
                    themedDrawable2.draw(canvas);
                    return;
                }
                if (i2 == 4) {
                    int iDp = (int) (this.sideStartX + AndroidUtilities.dp(16.0f));
                    int iDp2 = (int) (this.sideStartY + AndroidUtilities.dp(16.0f));
                    Drawable themedDrawable3 = getThemedDrawable("drawableCloseIcon");
                    int intrinsicWidth = themedDrawable3.getIntrinsicWidth() / 2;
                    int intrinsicHeight = themedDrawable3.getIntrinsicHeight() / 2;
                    themedDrawable3.setBounds(iDp - intrinsicWidth, iDp2 - intrinsicHeight, intrinsicWidth + iDp, intrinsicHeight + iDp2);
                    BaseCell.setDrawableBounds(themedDrawable3, this.sideStartX + AndroidUtilities.dp(4.0f), this.sideStartY + AndroidUtilities.dp(4.0f));
                    canvas.save();
                    canvas.scale(0.65f, 0.65f, themedDrawable3.getBounds().centerX(), themedDrawable3.getBounds().centerY());
                    themedDrawable3.draw(canvas);
                    canvas.restore();
                    if (this.drawSideButton2 != 5) {
                        return;
                    }
                    themedDrawable = getThemedDrawable("drawableMoreIcon");
                    int intrinsicWidth2 = themedDrawable.getIntrinsicWidth() / 2;
                    int intrinsicHeight2 = themedDrawable.getIntrinsicHeight() / 2;
                    themedDrawable.setBounds(iDp - intrinsicWidth2, iDp2 - intrinsicHeight2, iDp + intrinsicWidth2, iDp2 + intrinsicHeight2);
                    BaseCell.setDrawableBounds(themedDrawable, this.sideStartX + AndroidUtilities.dp(4.0f), this.sideStartY + AndroidUtilities.dp(34.0f));
                } else {
                    int iDp3 = (int) (this.sideStartX + AndroidUtilities.dp(16.0f));
                    int iDp4 = (int) (this.sideStartY + AndroidUtilities.dp(16.0f));
                    themedDrawable = getThemedDrawable("drawableShareIcon");
                    int intrinsicWidth3 = themedDrawable.getIntrinsicWidth() / 2;
                    int intrinsicHeight3 = themedDrawable.getIntrinsicHeight() / 2;
                    themedDrawable.setBounds(iDp3 - intrinsicWidth3, iDp4 - intrinsicHeight3, iDp3 + intrinsicWidth3, iDp4 + intrinsicHeight3);
                    BaseCell.setDrawableBounds(themedDrawable, this.sideStartX + AndroidUtilities.dp(4.0f), this.sideStartY + AndroidUtilities.dp(4.0f));
                }
                themedDrawable.draw(canvas);
            }
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:57:0x00ed  */
    /* JADX WARN: Removed duplicated region for block: B:59:0x00f3  */
    /* JADX WARN: Removed duplicated region for block: B:60:0x0112  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawTime(Canvas canvas, float f, boolean z) {
        float f2;
        MessageObject messageObject;
        float f3;
        float f4;
        TransitionParams transitionParams;
        float fLerp;
        float fLerp2;
        ChatMessageCellDelegate chatMessageCellDelegate;
        if (this.drawFromPinchToZoom || (chatMessageCellDelegate = this.delegate) == null || chatMessageCellDelegate.getPinchToZoomHelper() == null || !this.delegate.getPinchToZoomHelper().isInOverlayModeFor(this) || !shouldDrawTimeOnMedia()) {
            MessageObject messageObject2 = this.currentMessageObject;
            if (messageObject2 == null || messageObject2.type != 27) {
                int i = 0;
                while (true) {
                    f2 = BitmapDescriptorFactory.HUE_RED;
                    int i2 = 2;
                    if (i >= 2) {
                        break;
                    }
                    if (i != 0 || !isDrawSelectionBackground() || this.currentSelectedBackgroundAlpha != 1.0f || shouldDrawTimeOnMedia()) {
                        if (i == 1 && ((!isDrawSelectionBackground() && this.currentSelectedBackgroundAlpha == BitmapDescriptorFactory.HUE_RED) || shouldDrawTimeOnMedia())) {
                            break;
                        }
                        boolean z2 = i == 1;
                        if (i == 1) {
                            f4 = this.currentSelectedBackgroundAlpha;
                        } else if (shouldDrawTimeOnMedia()) {
                            f3 = f;
                            if (this.transitionParams.animateShouldDrawTimeOnMedia || this.transitionParams.animateChangeProgress == 1.0f) {
                                transitionParams = this.transitionParams;
                                if (transitionParams.shouldAnimateTimeX) {
                                    float f5 = this.timeX + transitionParams.deltaRight;
                                    fLerp = this.timeWidth;
                                    fLerp2 = f5;
                                } else {
                                    fLerp2 = AndroidUtilities.lerp(transitionParams.animateFromTimeX, this.timeX, transitionParams.animateChangeProgress);
                                    fLerp = AndroidUtilities.lerp(this.transitionParams.animateTimeWidth, this.timeWidth, this.transitionParams.animateChangeProgress);
                                }
                                drawTimeInternal(canvas, f3, z, fLerp2, this.timeLayout, fLerp, z2);
                            } else {
                                if (shouldDrawTimeOnMedia()) {
                                    this.overideShouldDrawTimeOnMedia = 1;
                                    drawTimeInternal(canvas, f3 * this.transitionParams.animateChangeProgress, z, this.timeX, this.timeLayout, this.timeWidth, z2);
                                } else {
                                    this.overideShouldDrawTimeOnMedia = 2;
                                    drawTimeInternal(canvas, f3 * this.transitionParams.animateChangeProgress, z, this.timeX, this.timeLayout, this.timeWidth, z2);
                                    i2 = 1;
                                }
                                this.overideShouldDrawTimeOnMedia = i2;
                                TransitionParams transitionParams2 = this.transitionParams;
                                drawTimeInternal(canvas, f3 * (1.0f - transitionParams2.animateChangeProgress), z, transitionParams2.animateFromTimeX, transitionParams2.animateTimeLayout, this.transitionParams.animateTimeWidth, z2);
                                this.overideShouldDrawTimeOnMedia = 0;
                            }
                        } else {
                            f4 = 1.0f - this.currentSelectedBackgroundAlpha;
                        }
                        f3 = f4 * f;
                        if (this.transitionParams.animateShouldDrawTimeOnMedia) {
                            transitionParams = this.transitionParams;
                            if (transitionParams.shouldAnimateTimeX) {
                            }
                            drawTimeInternal(canvas, f3, z, fLerp2, this.timeLayout, fLerp, z2);
                        }
                    }
                    i++;
                }
                if (this.transitionParams.animateBackgroundBoundsInner && ((messageObject = this.currentMessageObject) == null || !messageObject.preview)) {
                    drawOverlays(canvas);
                }
                if (this.effectDrawable != null) {
                    if (this.effectDrawableBounce == null) {
                        this.effectDrawableBounce = new ButtonBounce(this);
                    }
                    float scale = this.effectDrawableBounce.getScale(0.2f);
                    float timeX = getTimeX() - AndroidUtilities.dp(this.effectId == 0 ? BitmapDescriptorFactory.HUE_RED : 18.0f);
                    float f6 = this.timeWidth;
                    if (this.currentMessageObject.sendPreview) {
                        f2 = 1.0f - this.timeAlpha;
                    }
                    int iDp = (int) (timeX + (f6 * f2));
                    int timeY = (int) getTimeY();
                    MessageObject messageObject3 = this.currentMessageObject;
                    if (messageObject3 != null && !messageObject3.notime && this.pinnedBottom && !shouldDrawTimeOnMedia()) {
                        timeY += AndroidUtilities.dp(2.0f);
                    }
                    if (shouldDrawTimeOnMedia() && this.currentMessageObject.sendPreview) {
                        iDp -= AndroidUtilities.dp(1.0f);
                    }
                    MessageObject messageObject4 = this.currentMessageObject;
                    if (messageObject4 != null && (messageObject4.type == 15 || messageObject4.isAnyKindOfSticker())) {
                        iDp -= AndroidUtilities.dp(6.0f);
                    }
                    int iDp2 = AndroidUtilities.dp(14.0f) / 2;
                    int i3 = timeY + iDp2;
                    float f7 = iDp + iDp2;
                    float f8 = iDp2 * scale;
                    float f9 = i3;
                    this.effectDrawable.setBounds((int) (f7 - f8), (int) (f9 - f8), (int) (f7 + f8), (int) (f9 + f8));
                    if (!this.currentMessageObject.sendPreview) {
                        this.effectDrawable.setAlpha((int) (this.timeAlpha * 255.0f));
                    }
                    this.effectDrawable.draw(canvas);
                }
            }
        }
    }

    public void drawVideoTimestamps(Canvas canvas, int i) {
        if (this.currentMessageObject == null || this.controlsAlpha <= BitmapDescriptorFactory.HUE_RED || !this.photoImage.getVisible()) {
            return;
        }
        MessageObject messageObject = this.currentMessageObject;
        float fClamp01 = Utilities.clamp01((messageObject.openedInViewer || messageObject.getVideoStartsTimestamp() == -1) ? this.currentMessageObject.getVideoSavedProgress() : this.currentMessageObject.getVideoStartsTimestamp() / ((float) this.currentMessageObject.getDuration()));
        if (fClamp01 > BitmapDescriptorFactory.HUE_RED) {
            int[] roundRadius = this.photoImage.getRoundRadius();
            canvas.save();
            if (roundRadius[0] > 0 || roundRadius[1] > 0 || roundRadius[2] > 0 || roundRadius[3] > 0) {
                if (this.photoImageClipPath == null) {
                    this.photoImageClipPath = new Path();
                    this.photoImageClipPathRadii = new float[8];
                }
                float[] fArr = this.photoImageClipPathRadii;
                float fMax = Math.max(0, roundRadius[0]);
                fArr[1] = fMax;
                fArr[0] = fMax;
                float[] fArr2 = this.photoImageClipPathRadii;
                float fMax2 = Math.max(0, roundRadius[1]);
                fArr2[3] = fMax2;
                fArr2[2] = fMax2;
                float[] fArr3 = this.photoImageClipPathRadii;
                float fMax3 = Math.max(0, roundRadius[2]);
                fArr3[5] = fMax3;
                fArr3[4] = fMax3;
                float[] fArr4 = this.photoImageClipPathRadii;
                float fMax4 = Math.max(0, roundRadius[3]);
                fArr4[7] = fMax4;
                fArr4[6] = fMax4;
                this.photoImageClipPath.rewind();
                RectF rectF = AndroidUtilities.rectTmp;
                rectF.set(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX2(), this.photoImage.getImageY2());
                this.photoImageClipPath.addRoundRect(rectF, this.photoImageClipPathRadii, Path.Direction.CW);
                canvas.clipPath(this.photoImageClipPath);
            } else {
                canvas.clipRect(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX2(), this.photoImage.getImageY2());
            }
            Theme.chat_videoProgressPaint.setColor(Theme.multAlpha(-1, this.controlsAlpha * 0.35f));
            canvas.drawRect(this.photoImage.getImageX(), this.photoImage.getImageY2() - AndroidUtilities.dp(3.0f), this.photoImage.getImageX2(), this.photoImage.getImageY2(), Theme.chat_videoProgressPaint);
            Theme.chat_videoProgressPaint.setColor(Theme.multAlpha(i, this.controlsAlpha));
            RectF rectF2 = AndroidUtilities.rectTmp;
            rectF2.set(this.photoImage.getImageX() - AndroidUtilities.dp(2.0f), this.photoImage.getImageY2() - AndroidUtilities.dp(3.0f), this.photoImage.getImageX() + (this.photoImage.getImageWidth() * fClamp01), this.photoImage.getImageY2());
            canvas.drawRoundRect(rectF2, AndroidUtilities.dp(2.0f), AndroidUtilities.dp(2.0f), Theme.chat_videoProgressPaint);
            canvas.restore();
        }
    }

    public void drawVoiceOnce(Canvas canvas, float f, Runnable runnable) {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || !messageObject.isVoiceOnce()) {
            runnable.run();
            return;
        }
        float fCenterX = this.radialProgress.progressRect.centerX();
        double dLerp = AndroidUtilities.lerp(190, 45, f) / 180.0f;
        Double.isNaN(dLerp);
        float fCos = fCenterX + (((float) Math.cos(dLerp * 3.141592653589793d)) * AndroidUtilities.dp(22.6274f));
        float fCenterY = this.radialProgress.progressRect.centerY();
        double dLerp2 = AndroidUtilities.lerp(190, 45, f) / 180.0f;
        Double.isNaN(dLerp2);
        float fSin = fCenterY + (((float) Math.sin(dLerp2 * 3.141592653589793d)) * AndroidUtilities.dp(22.6274f));
        RectF rectF = AndroidUtilities.rectTmp;
        rectF.set(this.radialProgress.progressRect);
        rectF.inset(-AndroidUtilities.dp(1.0f), -AndroidUtilities.dp(1.0f));
        canvas.saveLayerAlpha(rectF, 255, 31);
        this.radialProgress.setBackgroundDrawable(isDrawSelectionBackground() ? this.currentBackgroundSelectedDrawable : this.currentBackgroundDrawable);
        this.radialProgress.iconScale = f;
        runnable.run();
        if (this.onceClearPaint == null) {
            Paint paint = new Paint(1);
            this.onceClearPaint = paint;
            paint.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.CLEAR));
        }
        if (f < 1.0f) {
            canvas.save();
            float f2 = 1.0f - f;
            float f3 = 0.7f * f2;
            float fCenterX2 = this.radialProgress.progressRect.centerX();
            RectF rectF2 = this.radialProgress.progressRect;
            canvas.scale(f3, f3, fCenterX2, AndroidUtilities.lerp(rectF2.top, rectF2.bottom, 0.5f));
            if (this.onceFire == null) {
                RLottieDrawable rLottieDrawable = new RLottieDrawable(R.raw.fire_once, "fire_once", AndroidUtilities.dp(32.0f), AndroidUtilities.dp(32.0f), true, null);
                this.onceFire = rLottieDrawable;
                rLottieDrawable.setMasterParent(this);
                this.onceFire.setAllowDecodeSingleFrame(true);
                this.onceFire.setAutoRepeat(1);
                this.onceFire.start();
                this.onceFire.scaleByCanvas = true;
            }
            RLottieDrawable rLottieDrawable2 = this.onceFire;
            RectF rectF3 = this.radialProgress.progressRect;
            rLottieDrawable2.setBounds((int) rectF3.left, (int) rectF3.top, (int) rectF3.right, (int) rectF3.bottom);
            if (this.onceRadialPaint == null) {
                this.onceRadialPaint = new Paint(1);
            }
            if (this.onceRadialCutPaint == null) {
                Paint paint2 = new Paint(1);
                this.onceRadialCutPaint = paint2;
                paint2.setXfermode(new PorterDuffXfermode(PorterDuff.Mode.DST_IN));
            }
            if (this.onceRadialStrokePaint == null) {
                Paint paint3 = new Paint(1);
                this.onceRadialStrokePaint = paint3;
                paint3.setStyle(Paint.Style.STROKE);
            }
            RadialProgress2 radialProgress2 = this.radialProgress;
            int i = radialProgress2.iconColorKey;
            int themedColor = i >= 0 ? getThemedColor(i) : radialProgress2.iconColor;
            this.onceRadialPaint.setColor(themedColor);
            this.onceRadialStrokePaint.setColor(themedColor);
            this.radialProgress.mediaActionDrawable.applyShaderMatrix(false);
            this.onceRadialPaint.setShader(this.radialProgress.mediaActionDrawable.paint2.getShader());
            this.onceRadialStrokePaint.setShader(this.radialProgress.mediaActionDrawable.paint2.getShader());
            rectF.set(this.onceFire.getBounds());
            canvas.saveLayerAlpha(rectF, 255, 31);
            rectF.inset(1.0f, 1.0f);
            canvas.drawRect(rectF, this.onceRadialPaint);
            this.onceFire.draw(canvas, this.onceRadialCutPaint);
            canvas.restore();
            canvas.restore();
            this.onceRadialStrokePaint.setAlpha((int) (255.0f * f2));
            this.onceRadialStrokePaint.setStrokeWidth(AndroidUtilities.dp(1.66f));
            this.rect.set(this.radialProgress.progressRect);
            this.rect.inset(AndroidUtilities.dp(3.0f), AndroidUtilities.dp(3.0f));
            canvas.drawArc(this.rect, -90.0f, (1.0f - this.seekBarWaveform.explodeProgress) * (-360.0f), false, this.onceRadialStrokePaint);
            if (this.timerParticles == null) {
                this.timerParticles = new TimerParticles();
            }
            this.timerParticles.draw(canvas, this.onceRadialStrokePaint, this.rect, (1.0f - this.seekBarWaveform.explodeProgress) * (-360.0f), f2);
        } else {
            RLottieDrawable rLottieDrawable3 = this.onceFire;
            if (rLottieDrawable3 != null) {
                rLottieDrawable3.recycle(true);
                this.onceFire = null;
                if (this.timerParticles != null) {
                    this.timerParticles = null;
                }
            }
        }
        canvas.drawCircle(fCos, fSin, AndroidUtilities.dp((f * 1.5f) + 10.0f) * f, this.onceClearPaint);
        canvas.restore();
        if (this.oncePeriod == null) {
            CaptionContainerView.PeriodDrawable periodDrawable = new CaptionContainerView.PeriodDrawable(3);
            this.oncePeriod = periodDrawable;
            periodDrawable.updateColors(-1, 0, 0);
            CaptionContainerView.PeriodDrawable periodDrawable2 = this.oncePeriod;
            periodDrawable2.diameterDp = 14.0f;
            periodDrawable2.setTextSize(10.0f);
            this.oncePeriod.strokePaint.setStrokeWidth(AndroidUtilities.dpf2(1.5f));
            this.oncePeriod.setValue(1, false, false);
            this.oncePeriod.textOffsetX = -AndroidUtilities.dpf2(0.33f);
            this.oncePeriod.textOffsetY = AndroidUtilities.dpf2(0.33f);
        }
        CaptionContainerView.PeriodDrawable periodDrawable3 = this.oncePeriod;
        periodDrawable3.diameterDp = f * 14.0f;
        periodDrawable3.setTextSize(f * 10.0f);
        canvas.saveLayerAlpha(fCos - AndroidUtilities.dp(10.0f), fSin - AndroidUtilities.dp(10.0f), fCos + AndroidUtilities.dp(10.0f), fSin + AndroidUtilities.dp(10.0f), 255, 31);
        canvas.drawCircle(fCos, fSin, AndroidUtilities.dp(10.0f) * f, this.radialProgress.circlePaint);
        this.oncePeriod.setClear(AndroidUtilities.computePerceivedBrightness(this.radialProgress.circlePaint.getColor()) > 0.8f);
        this.oncePeriod.setCenterXY(fCos, fSin);
        this.oncePeriod.draw(canvas, f);
        canvas.restore();
    }

    public void forceResetMessageObject() throws Resources.NotFoundException, NumberFormatException {
        MessageObject messageObject = this.messageObjectToSet;
        if (messageObject == null) {
            messageObject = this.currentMessageObject;
        }
        MessageObject messageObject2 = messageObject;
        this.currentMessageObject = null;
        setMessageObject(messageObject2, this.currentMessagesGroup, this.pinnedBottom, this.pinnedTop, this.firstInChat);
    }

    @Override // android.view.View
    public AccessibilityNodeProvider getAccessibilityNodeProvider() {
        return new MessageAccessibilityNodeProvider();
    }

    @Override // android.view.View
    public float getAlpha() {
        return this.ALPHA_PROPERTY_WORKAROUND ? this.alphaInternal : super.getAlpha();
    }

    /* JADX WARN: Removed duplicated region for block: B:13:0x0035  */
    /* JADX WARN: Removed duplicated region for block: B:7:0x001c  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public AnimatedEmojiSpan[] getAnimatedEmojiSpans() {
        AnimatedEmojiSpan[] animatedEmojiSpanArr;
        AnimatedEmojiSpan[] animatedEmojiSpanArr2;
        int i;
        MessageObject messageObject = this.currentMessageObject;
        AnimatedEmojiSpan[] animatedEmojiSpanArr3 = null;
        int i2 = 0;
        if (messageObject != null) {
            CharSequence charSequence = messageObject.messageText;
            animatedEmojiSpanArr = charSequence instanceof Spanned ? (AnimatedEmojiSpan[]) ((Spanned) charSequence).getSpans(0, charSequence.length(), AnimatedEmojiSpan.class) : null;
        }
        MessageObject messageObject2 = this.currentMessageObject;
        if (messageObject2 != null) {
            CharSequence charSequence2 = messageObject2.caption;
            animatedEmojiSpanArr2 = charSequence2 instanceof Spanned ? (AnimatedEmojiSpan[]) ((Spanned) charSequence2).getSpans(0, charSequence2.length(), AnimatedEmojiSpan.class) : null;
        }
        if ((animatedEmojiSpanArr != null && animatedEmojiSpanArr.length != 0) || (animatedEmojiSpanArr2 != null && animatedEmojiSpanArr2.length != 0)) {
            animatedEmojiSpanArr3 = new AnimatedEmojiSpan[(animatedEmojiSpanArr == null ? 0 : animatedEmojiSpanArr.length) + (animatedEmojiSpanArr2 == null ? 0 : animatedEmojiSpanArr2.length)];
            if (animatedEmojiSpanArr != null) {
                int i3 = 0;
                i = 0;
                while (i3 < animatedEmojiSpanArr.length) {
                    animatedEmojiSpanArr3[i] = animatedEmojiSpanArr[i3];
                    i3++;
                    i++;
                }
            } else {
                i = 0;
            }
            if (animatedEmojiSpanArr2 != null) {
                while (i2 < animatedEmojiSpanArr2.length) {
                    animatedEmojiSpanArr3[i] = animatedEmojiSpanArr2[i2];
                    i2++;
                    i++;
                }
            }
        }
        return animatedEmojiSpanArr3;
    }

    public float getAnimationOffsetX() {
        return this.animationOffsetX;
    }

    public ImageReceiver getAvatarImage() {
        if (this.isAvatarVisible) {
            return this.avatarImage;
        }
        return null;
    }

    public MessageBackgroundDrawable getBackgroundDrawable() {
        return this.backgroundDrawable;
    }

    public int getBackgroundDrawableBottom() {
        int iDp;
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if (groupedMessagePosition != null) {
            int i = 4;
            iDp = (groupedMessagePosition.flags & 4) == 0 ? AndroidUtilities.dp(3.0f) : 0;
            if ((this.currentPosition.flags & 8) == 0) {
                MessageObject messageObject = this.currentMessageObject;
                if (messageObject != null && messageObject.isOutOwner()) {
                    i = 3;
                }
                iDp += AndroidUtilities.dp(i);
            }
        } else {
            iDp = 0;
        }
        boolean z = this.drawPinnedBottom;
        int backgroundDrawableTop = ((getBackgroundDrawableTop() + this.layoutHeight) - ((z && this.drawPinnedTop) ? 0 : z ? AndroidUtilities.dp(1.0f) : AndroidUtilities.dp(2.0f))) + iDp;
        if (this.mediaBackground) {
            return backgroundDrawableTop;
        }
        if (this.drawPinnedTop) {
            backgroundDrawableTop += AndroidUtilities.dp(1.0f);
        }
        return this.drawPinnedBottom ? backgroundDrawableTop + AndroidUtilities.dp(1.0f) : backgroundDrawableTop;
    }

    public int getBackgroundDrawableLeft() {
        int iDp;
        int iDp2;
        int iDp3;
        int i;
        MessageObject messageObject = getMessageObject();
        if (messageObject != null && messageObject.isOutOwner()) {
            if (this.isRoundVideo) {
                return (this.layoutWidth - this.backgroundWidth) - ((int) ((1.0f - getVideoTranscriptionProgress()) * AndroidUtilities.dp(9.0f)));
            }
            return (this.layoutWidth - this.backgroundWidth) - (this.mediaBackground ? AndroidUtilities.dp(9.0f) : 0);
        }
        float f = 64.0f;
        if (this.isRoundVideo) {
            if (!isSideMenuLeftMargin()) {
                if ((this.isChat || ((messageObject != null && (messageObject.isRepostPreview || messageObject.forceAvatar)) || messageObject.getDialogId() == UserObject.VERIFY)) && this.isAvatarVisible) {
                    i = 48;
                }
                f = i + 3;
            }
            iDp = AndroidUtilities.dp(f);
            iDp2 = (int) (AndroidUtilities.dp(6.0f) * (1.0f - getVideoTranscriptionProgress()));
        } else {
            if (!isSideMenuLeftMargin()) {
                if ((this.isChat || ((messageObject != null && (messageObject.isRepostPreview || messageObject.forceAvatar)) || messageObject.getDialogId() == UserObject.VERIFY)) && this.isAvatarVisible) {
                    i = 48;
                }
                f = i;
            }
            iDp = AndroidUtilities.dp(f);
            iDp2 = AndroidUtilities.dp(this.mediaBackground ? 9.0f : 3.0f);
        }
        int iCeil = iDp + iDp2;
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages != null && !groupedMessages.isDocuments && (i = this.currentPosition.leftSpanOffset) != 0) {
            iCeil += (int) Math.ceil((i / 1000.0f) * getGroupPhotosWidth());
        }
        if (this.isRoundVideo) {
            if (!this.drawPinnedBottom) {
                return iCeil;
            }
            iDp3 = (int) (AndroidUtilities.dp(6.0f) * (1.0f - getVideoTranscriptionProgress()));
        } else {
            if (this.mediaBackground || !this.drawPinnedBottom) {
                return iCeil;
            }
            iDp3 = AndroidUtilities.dp(6.0f);
        }
        return iCeil + iDp3;
    }

    public int getBackgroundDrawableRight() {
        int iDp;
        MessageObject messageObject;
        MessageObject messageObject2;
        int i = this.backgroundWidth;
        if (this.isRoundVideo) {
            iDp = i - ((int) (getVideoTranscriptionProgress() * AndroidUtilities.dp(3.0f)));
            if (this.drawPinnedBottom && (messageObject2 = this.currentMessageObject) != null && messageObject2.isOutOwner()) {
                iDp = (int) (iDp - (AndroidUtilities.dp(6.0f) * (1.0f - getVideoTranscriptionProgress())));
            }
            if (this.drawPinnedBottom && ((messageObject = this.currentMessageObject) == null || !messageObject.isOutOwner())) {
                iDp = (int) (iDp - (AndroidUtilities.dp(6.0f) * (1.0f - getVideoTranscriptionProgress())));
            }
        } else {
            iDp = i - (this.mediaBackground ? 0 : AndroidUtilities.dp(3.0f));
            if (!this.mediaBackground && this.drawPinnedBottom) {
                iDp -= AndroidUtilities.dp(6.0f);
            }
        }
        return getBackgroundDrawableLeft() + iDp;
    }

    public int getBackgroundDrawableTop() {
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        int iDp = ((groupedMessagePosition == null || (groupedMessagePosition.flags & 4) != 0) ? 0 : 0 - AndroidUtilities.dp(3.0f)) + (this.drawPinnedTop ? 0 : AndroidUtilities.dp(1.0f));
        return (this.mediaBackground || !this.drawPinnedTop) ? iDp : iDp - AndroidUtilities.dp(1.0f);
    }

    public int getBackgroundHeight() {
        return this.backgroundHeight;
    }

    public ImageReceiver getBlurredPhotoImage() {
        return this.blurredPhotoImage;
    }

    @Override // org.telegram.ui.Cells.BaseCell
    public int getBoundsLeft() {
        int iDp;
        float f;
        MessageObject messageObject = this.currentMessageObject;
        boolean z = messageObject != null && messageObject.isOutOwner();
        if (needDrawAvatar()) {
            if (this.currentPosition != null) {
                f = 73.0f;
            } else {
                MessageObject messageObject2 = this.currentMessageObject;
                f = (messageObject2 == null || !messageObject2.isRepostPreview) ? 63 : 42;
            }
            iDp = AndroidUtilities.dp(f);
        } else {
            iDp = 0;
        }
        int backgroundDrawableLeft = (getBackgroundDrawableLeft() - iDp) - ((z && (checkNeedDrawShareButton(this.currentMessageObject) || this.useTranscribeButton)) ? AndroidUtilities.dp(48.0f) : 0);
        if (this.botButtons != null) {
            int widthForButtons = getWidthForButtons();
            MessageObject messageObject3 = this.currentMessageObject;
            int iDp2 = (messageObject3 == null || !messageObject3.isOutOwner()) ? this.backgroundDrawableLeft + AndroidUtilities.dp((this.mediaBackground || this.drawPinnedBottom) ? 1.0f : 7.0f) : (getMeasuredWidth() - widthForButtons) - AndroidUtilities.dp(10.0f);
            int iMax = Integer.MAX_VALUE;
            for (int i = 0; i < this.botButtons.size(); i++) {
                iMax = Math.max(iMax, ((int) (((BotButton) this.botButtons.get(i)).x * widthForButtons)) + iDp2);
            }
            backgroundDrawableLeft = Math.min(backgroundDrawableLeft, iMax);
        }
        if (this.starsPriceText != null) {
            backgroundDrawableLeft = Math.min(backgroundDrawableLeft, ((int) ((getParentWidth() - this.starsPriceText.getWidth()) - AndroidUtilities.dp(18.0f))) / 2);
        }
        if (this.topicSeparator != null) {
            backgroundDrawableLeft = Math.min(this.sideMenuWidth, backgroundDrawableLeft);
        }
        return Math.max(0, backgroundDrawableLeft);
    }

    @Override // org.telegram.ui.Cells.BaseCell
    public int getBoundsRight() {
        MessageObject messageObject = this.currentMessageObject;
        int backgroundDrawableRight = getBackgroundDrawableRight() + ((messageObject == null || messageObject.isOutOwner() || !(checkNeedDrawShareButton(this.currentMessageObject) || this.useTranscribeButton)) ? 0 : AndroidUtilities.dp(48.0f));
        if (this.botButtons != null) {
            int widthForButtons = getWidthForButtons();
            MessageObject messageObject2 = this.currentMessageObject;
            int iDp = (messageObject2 == null || !messageObject2.isOutOwner()) ? this.backgroundDrawableLeft + AndroidUtilities.dp((this.mediaBackground || this.drawPinnedBottom) ? 1.0f : 7.0f) : (getMeasuredWidth() - getWidthForButtons()) - AndroidUtilities.dp(10.0f);
            int iMax = 0;
            for (int i = 0; i < this.botButtons.size(); i++) {
                BotButton botButton = (BotButton) this.botButtons.get(i);
                float f = widthForButtons;
                iMax = Math.max(iMax, ((int) (botButton.x * f)) + iDp + ((int) (botButton.width * f)));
            }
            backgroundDrawableRight = Math.max(backgroundDrawableRight, iMax);
        }
        if (this.starsPriceText != null) {
            backgroundDrawableRight = Math.max(backgroundDrawableRight, ((int) ((getParentWidth() + this.starsPriceText.getWidth()) + AndroidUtilities.dp(18.0f))) / 2);
        }
        return this.topicSeparator != null ? Math.max(backgroundDrawableRight, getWidth()) : backgroundDrawableRight;
    }

    public MessageObject.TextLayoutBlocks getCaptionLayout() {
        return this.captionLayout;
    }

    public float getCaptionX() {
        float f;
        float f2;
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateBackgroundBoundsInner) {
            if (transitionParams.transformGroupToSingleMessage) {
                this.captionX += transitionParams.deltaLeft;
            } else {
                if (transitionParams.moveCaption) {
                    float f3 = this.captionX;
                    TransitionParams transitionParams2 = this.transitionParams;
                    float f4 = transitionParams2.animateChangeProgress;
                    f = f3 * f4;
                    f2 = transitionParams2.captionFromX * (1.0f - f4);
                } else if (!this.currentMessageObject.isVoice() || !TextUtils.isEmpty(this.currentMessageObject.caption)) {
                    f = this.captionX;
                    f2 = this.transitionParams.deltaLeft;
                }
                this.captionX = f + f2;
            }
        }
        return this.captionX;
    }

    public float getCaptionY() {
        float f = this.captionY;
        TransitionParams transitionParams = this.transitionParams;
        if (!transitionParams.animateBackgroundBoundsInner) {
            return f;
        }
        if (transitionParams.transformGroupToSingleMessage) {
            return f - getTranslationY();
        }
        if (!transitionParams.moveCaption) {
            return f;
        }
        float f2 = this.captionY;
        TransitionParams transitionParams2 = this.transitionParams;
        float f3 = transitionParams2.animateChangeProgress;
        return (f2 * f3) + (transitionParams2.captionFromY * (1.0f - f3));
    }

    public float getCheckBoxTranslation() {
        return this.checkBoxTranslation;
    }

    public int getChecksX() {
        return this.layoutWidth - AndroidUtilities.dp(SharedConfig.bubbleRadius >= 10 ? 27.3f : 25.3f);
    }

    public int getChecksY() {
        float f;
        Drawable themedDrawable;
        if (this.currentMessageObject.shouldDrawWithoutBackground()) {
            f = this.drawTimeY;
            themedDrawable = getThemedDrawable("drawableMsgStickerCheck");
        } else {
            f = this.drawTimeY;
            themedDrawable = Theme.chat_msgMediaCheckDrawable;
        }
        return (int) (f - themedDrawable.getIntrinsicHeight());
    }

    public Theme.MessageDrawable getCurrentBackgroundDrawable(boolean z) {
        if (z) {
            MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
            boolean z2 = groupedMessagePosition != null && (groupedMessagePosition.flags & 8) == 0 && this.currentMessagesGroup.isDocuments && !this.drawPinnedBottom;
            this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable(this.currentMessageObject.isOutOwner() ? (this.mediaBackground || this.drawPinnedBottom || z2) ? "drawableMsgOutMedia" : "drawableMsgOut" : (this.mediaBackground || this.drawPinnedBottom || z2) ? "drawableMsgInMedia" : "drawableMsgIn");
        }
        this.currentBackgroundDrawable.getBackgroundDrawable();
        return this.currentBackgroundDrawable;
    }

    public int getCurrentBackgroundLeft() {
        Theme.MessageDrawable messageDrawable = this.currentBackgroundDrawable;
        if (messageDrawable == null) {
            return 0;
        }
        int i = messageDrawable.getBounds().left;
        if (this.currentMessageObject.isOutOwner() || this.transitionParams.changePinnedBottomProgress == 1.0f) {
            return i;
        }
        boolean z = this.isRoundVideo;
        return ((z || !this.mediaBackground) && !this.drawPinnedBottom) ? z ? (int) (i - (AndroidUtilities.dp(6.0f) * getVideoTranscriptionProgress())) : i - AndroidUtilities.dp(6.0f) : i;
    }

    public int getCurrentBackgroundRight() {
        Theme.MessageDrawable messageDrawable = this.currentBackgroundDrawable;
        if (messageDrawable == null) {
            return getWidth();
        }
        int i = messageDrawable.getBounds().right;
        if (!this.currentMessageObject.isOutOwner() || this.transitionParams.changePinnedBottomProgress == 1.0f) {
            return i;
        }
        boolean z = this.isRoundVideo;
        return ((z || !this.mediaBackground) && !this.drawPinnedBottom) ? z ? (int) (i + (AndroidUtilities.dp(6.0f) * getVideoTranscriptionProgress())) : i + AndroidUtilities.dp(6.0f) : i;
    }

    public TLRPC.Chat getCurrentChat() {
        return this.currentChat;
    }

    public MessageObject.GroupedMessages getCurrentMessagesGroup() {
        return this.currentMessagesGroup;
    }

    public MessageObject.GroupedMessagePosition getCurrentPosition() {
        return this.currentPosition;
    }

    public TLRPC.User getCurrentUser() {
        return this.currentUser;
    }

    public ChatMessageCellDelegate getDelegate() {
        return this.delegate;
    }

    /* JADX WARN: Removed duplicated region for block: B:31:0x00b4  */
    /* JADX WARN: Removed duplicated region for block: B:39:0x00ca  */
    /* JADX WARN: Removed duplicated region for block: B:42:0x00ec  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public float getDescriptionLayoutX() {
        int i;
        float fDp;
        float fDp2;
        int iDp;
        TransitionParams transitionParams;
        boolean z = this.hasGamePreview;
        float f = BitmapDescriptorFactory.HUE_RED;
        if (z) {
            AndroidUtilities.dp(14.0f);
            iDp = this.unmovedTextX - AndroidUtilities.dp(10.0f);
        } else {
            if (this.hasInvoicePreview) {
                AndroidUtilities.dp(14.0f);
            } else {
                if (!this.currentMessageObject.isSponsored()) {
                    float f2 = 12.0f;
                    if (this.currentMessageObject.isOutOwner()) {
                        fDp = this.backgroundDrawableLeft + AndroidUtilities.dp(12.0f) + getExtraTextX();
                        if (this.currentMessageObject.type == 19) {
                            fDp -= Math.max(BitmapDescriptorFactory.HUE_RED, ((Math.max(this.replyNameWidth, this.replyTextWidth) + fDp) + AndroidUtilities.dp(14.0f)) - AndroidUtilities.displaySize.x);
                        }
                    } else {
                        if (this.mediaBackground) {
                            i = this.backgroundDrawableLeft;
                        } else {
                            i = this.backgroundDrawableLeft;
                            if (!this.drawPinnedBottom) {
                                f2 = 18.0f;
                            }
                        }
                        fDp = i + AndroidUtilities.dp(f2) + getExtraTextX();
                    }
                    fDp2 = (fDp + this.transitionParams.deltaLeft) - AndroidUtilities.dp(1.33f);
                    float f3 = this.linkPreviewY;
                    TransitionParams transitionParams2 = this.transitionParams;
                    if (transitionParams2.animateLinkPreviewY) {
                        AndroidUtilities.lerp(transitionParams2.animateFromLinkPreviewY, f3, transitionParams2.animateChangeProgress);
                    }
                    float backgroundDrawableRight = getBackgroundDrawableRight();
                    transitionParams = this.transitionParams;
                    if (transitionParams != null) {
                        f = transitionParams.deltaRight;
                    }
                    return fDp2 + AndroidUtilities.dp(10.0f) + (Math.abs(this.descriptionLayoutLeft) > 1 ? ((((int) ((((backgroundDrawableRight + f) - AndroidUtilities.dp(10 + ((this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 0 : 6))) - getExtraTextX()) - fDp2)) - AndroidUtilities.dp(20.0f)) - this.descriptionLayoutWidth) - this.descriptionLayoutLeft : 0);
                }
                AndroidUtilities.dp(2.0f);
            }
            iDp = this.unmovedTextX + AndroidUtilities.dp(1.0f);
        }
        fDp2 = iDp;
        float backgroundDrawableRight2 = getBackgroundDrawableRight();
        transitionParams = this.transitionParams;
        if (transitionParams != null) {
        }
        return fDp2 + AndroidUtilities.dp(10.0f) + (Math.abs(this.descriptionLayoutLeft) > 1 ? ((((int) ((((backgroundDrawableRight2 + f) - AndroidUtilities.dp(10 + ((this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 0 : 6))) - getExtraTextX()) - fDp2)) - AndroidUtilities.dp(20.0f)) - this.descriptionLayoutWidth) - this.descriptionLayoutLeft : 0);
    }

    public float getDescriptionLayoutY() {
        float f = this.descriptionY;
        TransitionParams transitionParams = this.transitionParams;
        return f + (!transitionParams.animateLinkPreviewY ? (-transitionParams.deltaTop) + transitionParams.deltaBottom : BitmapDescriptorFactory.HUE_RED);
    }

    public StaticLayout getDescriptionlayout() {
        return this.descriptionLayout;
    }

    public TLRPC.TL_availableEffect getEffect() {
        MessageObject messageObject;
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if ((groupedMessagePosition == null || groupedMessagePosition.last) && (messageObject = this.currentMessageObject) != null) {
            return messageObject.getEffect();
        }
        return null;
    }

    public float getEventX(MotionEvent motionEvent) {
        return motionEvent.getX();
    }

    public float getEventY(MotionEvent motionEvent) {
        return ((motionEvent.getY() - this.starsPriceTopPadding) - this.topicSeparatorTopPadding) - this.suggestionOfferTopPadding;
    }

    public int getExtraInsetHeight() {
        int iDp = this.addedCaptionHeight;
        if (this.hasFactCheck) {
            iDp += AndroidUtilities.dp((this.reactionsLayoutInBubble.isEmpty ? 18 : 0) + 2) + this.factCheckHeight;
        }
        if (this.drawCommentButton) {
            iDp += AndroidUtilities.dp(shouldDrawTimeOnMedia() ? 41.3f : 43.0f);
        }
        return (this.reactionsLayoutInBubble.isEmpty || !this.currentMessageObject.shouldDrawReactionsInLayout()) ? iDp : iDp + this.reactionsLayoutInBubble.totalHeight;
    }

    int getExtraTextX() {
        float f;
        int i = SharedConfig.bubbleRadius;
        if (i >= 15) {
            f = 2.0f;
        } else {
            if (i < 11) {
                return 0;
            }
            f = 1.0f;
        }
        return AndroidUtilities.dp(f);
    }

    public StaticLayout getFactCheckLayout() {
        return this.factCheckTextLayout;
    }

    public String getFilename() {
        int i;
        int i2;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            return null;
        }
        int i3 = messageObject.type;
        if (i3 == 1) {
            TLRPC.PhotoSize photoSize = this.currentPhotoObject;
            if (photoSize == null) {
                return null;
            }
            return FileLoader.getAttachFileName(photoSize);
        }
        if (i3 == 8 || (i2 = this.documentAttachType) == 7 || i2 == 4 || i2 == 8 || i3 == 9 || i2 == 3 || i2 == 5) {
            if (messageObject.useCustomPhoto) {
                return null;
            }
            if (messageObject.attachPathExists && !TextUtils.isEmpty(messageObject.messageOwner.attachPath)) {
                return this.currentMessageObject.messageOwner.attachPath;
            }
            if (!this.currentMessageObject.isSendError() || (i = this.documentAttachType) == 3 || i == 5) {
                return this.currentMessageObject.getFileName();
            }
        } else {
            if (i2 != 0) {
                return FileLoader.getAttachFileName(this.documentAttach);
            }
            TLRPC.PhotoSize photoSize2 = this.currentPhotoObject;
            if (photoSize2 != null) {
                return FileLoader.getAttachFileName(photoSize2);
            }
        }
        return null;
    }

    public int getForwardNameCenterX() {
        TLRPC.User user = this.currentUser;
        return (int) ((user == null || user.id != 0) ? this.forwardNameX + this.forwardNameCenterX : this.avatarImage.getCenterX());
    }

    public float getHighlightAlpha() {
        return getHighlightAlpha(false);
    }

    public float getHighlightAlpha(boolean z) {
        float f;
        QuoteHighlight quoteHighlight;
        if (this.drawSelectionBackground || !this.isHighlightedAnimated) {
            f = 1.0f;
        } else {
            int i = this.highlightProgress;
            f = (i >= 300 ? 1.0f : i / 300.0f) * 1.0f;
        }
        return (z || (quoteHighlight = this.quoteHighlight) == null) ? f : f * (1.0f - quoteHighlight.getT());
    }

    public float getLastTouchX() {
        return this.lastTouchX;
    }

    public float getLastTouchY() {
        return this.lastTouchY;
    }

    public int getLayoutHeight() {
        return this.layoutHeight;
    }

    /* JADX WARN: Removed duplicated region for block: B:54:0x00d5 A[PHI: r0
      0x00d5: PHI (r0v15 int) = (r0v3 int), (r0v16 int) binds: [B:60:0x00f4, B:53:0x00d3] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:57:0x00de A[PHI: r0
      0x00de: PHI (r0v4 int) = (r0v3 int), (r0v16 int) binds: [B:63:0x00fb, B:56:0x00dc] A[DONT_GENERATE, DONT_INLINE]] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public int getMaxNameWidth() {
        int iMin;
        MessageObject messageObject;
        MessageObject messageObject2;
        int i;
        int iDp;
        float f;
        int i2 = this.documentAttachType;
        if (i2 == 6 || i2 == 8 || (i = (messageObject2 = this.currentMessageObject).type) == 5) {
            boolean zIsTablet = AndroidUtilities.isTablet();
            float f2 = BitmapDescriptorFactory.HUE_RED;
            if (zIsTablet) {
                iMin = AndroidUtilities.getMinTabletSide();
                if (this.isSideMenued) {
                    f2 = 64.0f;
                } else if (needDrawAvatar()) {
                    f2 = 42.0f;
                }
            } else {
                iMin = Math.min(getParentWidth(), AndroidUtilities.displaySize.y);
                if (!this.isSideMenued) {
                    if (needDrawAvatar()) {
                    }
                }
            }
            int iDp2 = iMin - AndroidUtilities.dp(f2);
            MessageObject messageObject3 = this.currentMessageObject;
            if (messageObject3 != null && messageObject3.isSaved && messageObject3.isOutOwner() && checkNeedDrawShareButton(this.currentMessageObject)) {
                iDp2 -= AndroidUtilities.dp(25.0f);
            }
            return (!this.isPlayingRound || ((messageObject = this.currentMessageObject) != null && messageObject.isVoiceTranscriptionOpen())) ? (this.isSideMenued && (this.currentMessageObject.type == 5 || this.documentAttachType == 6)) ? this.backgroundWidth - AndroidUtilities.dp(57.0f) : (iDp2 - this.backgroundWidth) - AndroidUtilities.dp(57.0f) : (iDp2 - (this.backgroundWidth - (AndroidUtilities.roundPlayingMessageSize(this.isSideMenued) - AndroidUtilities.roundMessageSize))) - AndroidUtilities.dp(57.0f);
        }
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages == null || groupedMessages.isDocuments) {
            if (i == 19) {
                return Math.max(messageObject2.textWidth, (int) (((AndroidUtilities.displaySize.x - AndroidUtilities.dp(52.0f)) - (this.isAvatarVisible ? AndroidUtilities.dp(48.0f) : 0)) * 0.5f));
            }
            iDp = this.backgroundWidth;
            if (messageObject2.isSaved && messageObject2.isOutOwner() && checkNeedDrawShareButton(this.currentMessageObject)) {
                iDp -= AndroidUtilities.dp(25.0f);
            }
            f = this.mediaBackground ? 22.0f : 31.0f;
        } else {
            int minTabletSide = AndroidUtilities.isTablet() ? AndroidUtilities.getMinTabletSide() : getParentWidth();
            iDp = 0;
            for (int i3 = 0; i3 < this.currentMessagesGroup.posArray.size(); i3++) {
                if (this.currentMessagesGroup.posArray.get(i3).minY != 0) {
                    break;
                }
                double d = iDp;
                double dCeil = Math.ceil(((r4.pw + r4.leftSpanOffset) / 1000.0f) * minTabletSide);
                Double.isNaN(d);
                iDp = (int) (d + dCeil);
            }
            if (this.isSideMenued) {
                i = 64;
            } else if (needDrawAvatar()) {
                i = 48;
            }
            f = i + 31;
        }
        return iDp - AndroidUtilities.dp(f);
    }

    public int getMediaOffsetY() {
        return this.transitionParams.animateMediaOffsetY ? AndroidUtilities.lerp(this.transitionParams.animateFromMediaOffsetY, this.mediaOffsetY, this.transitionParams.animateChangeProgress) : this.mediaOffsetY;
    }

    public MessageObject getMessageObject() {
        MessageObject messageObject = this.messageObjectToSet;
        return messageObject != null ? messageObject : this.currentMessageObject;
    }

    public int getNameStatusX() {
        return (int) (this.nameX + this.nameOffsetX + (this.viaNameWidth > 0 ? r1 - AndroidUtilities.dp(32.0f) : this.nameLayoutWidth) + AndroidUtilities.dp(2.0f) + (AndroidUtilities.dp(20.0f) / 2));
    }

    public int getNameStatusY() {
        return (int) (this.nameY + ((this.nameLayout == null ? 0 : r1.getHeight()) / 2));
    }

    public int getNoSoundIconCenterX() {
        return this.noSoundCenterX;
    }

    public float getNonAnimationTranslationX(boolean z) {
        boolean z2;
        float f = this.slidingOffsetX;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || messageObject.isOutOwner()) {
            return f;
        }
        if (z && ((z2 = this.checkBoxVisible) || this.checkBoxAnimationInProgress)) {
            this.checkBoxTranslation = (int) Math.ceil((z2 ? CubicBezierInterpolator.EASE_OUT : CubicBezierInterpolator.EASE_IN).getInterpolation(this.checkBoxAnimationProgress) * AndroidUtilities.dp(35.0f));
        }
        float f2 = f + this.checkBoxTranslation;
        if (!this.isSideMenued || this.currentPosition == null) {
            return f2;
        }
        return f2 + (AndroidUtilities.dp(64 - (needDrawAvatar() ? 48 : 0)) * this.sideMenuAlpha);
    }

    @Override // org.telegram.messenger.DownloadController.FileDownloadProgressListener
    public int getObserverTag() {
        return this.TAG;
    }

    public float getPaddingTopAnimated() {
        return getTopicSeparatorTopPadding() + this.starsPriceTopPadding + this.suggestionOfferTopPadding;
    }

    public int getParentWidth() {
        int i;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            messageObject = this.messageObjectToSet;
        }
        return (messageObject == null || !messageObject.preview || (i = this.parentWidth) <= 0) ? AndroidUtilities.displaySize.x : i;
    }

    public float getPhotoBottom() {
        return this.groupMedia != null ? r0.y + r0.height : this.photoImage.getImageY2();
    }

    public ImageReceiver getPhotoImage() {
        return this.photoImage;
    }

    public ImageReceiver getPhotoImage(int i) {
        GroupMedia groupMedia = this.groupMedia;
        return groupMedia != null ? groupMedia.getPhotoImage(i) : this.photoImage;
    }

    public float getPollButtonBottom(int i) {
        if (i < 0 || i >= this.pollButtons.size()) {
            return BitmapDescriptorFactory.HUE_RED;
        }
        int i2 = ((PollButton) this.pollButtons.get(i)).y;
        int i3 = this.namesOffset;
        float f = i2 + i3;
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateForwardedLayout) {
            float f2 = transitionParams.animateChangeProgress;
            f += (i3 * f2) + (transitionParams.animateForwardedNamesOffset * (1.0f - f2));
            if (this.currentMessageObject.needDrawForwarded()) {
                f -= this.namesOffset;
            }
        }
        TransitionParams transitionParams2 = this.transitionParams;
        if (transitionParams2.animateBackgroundBoundsInner) {
            f += transitionParams2.deltaTop;
        }
        return f + r6.height + AndroidUtilities.dp(13.0f);
    }

    public float getPollButtonTop(int i) {
        if (i < 0 || i >= this.pollButtons.size()) {
            return BitmapDescriptorFactory.HUE_RED;
        }
        int i2 = ((PollButton) this.pollButtons.get(i)).y;
        int i3 = this.namesOffset;
        float f = i2 + i3;
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateForwardedLayout) {
            float f2 = transitionParams.animateChangeProgress;
            f += (i3 * f2) + (transitionParams.animateForwardedNamesOffset * (1.0f - f2));
            if (this.currentMessageObject.needDrawForwarded()) {
                f -= this.namesOffset;
            }
        }
        TransitionParams transitionParams2 = this.transitionParams;
        if (transitionParams2.animateBackgroundBoundsInner) {
            f += transitionParams2.deltaTop;
        }
        return f - AndroidUtilities.dp(13.0f);
    }

    public ArrayList<PollButton> getPollButtons() {
        return this.pollButtons;
    }

    public float getPollButtonsLeft() {
        int iDp;
        if (getMessageObject() == null || !getMessageObject().isOutOwner()) {
            iDp = AndroidUtilities.dp(this.isSideMenuEnabled ? 75.0f : needDrawAvatar() ? 59.0f : 11.0f);
        } else {
            iDp = (AndroidUtilities.dp(3.0f) + this.layoutWidth) - this.backgroundWidth;
        }
        return iDp;
    }

    public float getPollButtonsRight() {
        return (getPollButtonsLeft() + this.backgroundWidth) - AndroidUtilities.dp(15.0f);
    }

    public MessageObject getPrimaryMessageObject() {
        MessageObject messageObject = this.currentMessageObject;
        MessageObject messageObjectFindPrimaryMessageObject = (messageObject == null || this.currentMessagesGroup == null || !messageObject.hasValidGroupId()) ? null : this.currentMessagesGroup.findPrimaryMessageObject();
        return messageObjectFindPrimaryMessageObject != null ? messageObjectFindPrimaryMessageObject : this.currentMessageObject;
    }

    public RadialProgress2 getRadialProgress() {
        return this.radialProgress;
    }

    public ReactionsLayoutInBubble.ReactionButton getReactionButton(ReactionsLayoutInBubble.VisibleReaction visibleReaction) {
        return this.reactionsLayoutInBubble.getReactionButton(visibleReaction);
    }

    public Theme.ResourcesProvider getResourcesProvider() {
        return this.resourcesProvider;
    }

    public SeekBar getSeekBar() {
        return this.seekBar;
    }

    public SeekBarWaveform getSeekBarWaveform() {
        return this.seekBarWaveform;
    }

    public float getSideButtonStartX() {
        return this.sideStartX;
    }

    public float getSideButtonStartY() {
        return this.sideStartY;
    }

    public float getSlidingOffsetX() {
        return this.slidingOffsetX;
    }

    public long getStarsPrice() {
        TLRPC.Message message;
        TLRPC.Message message2;
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages == null) {
            MessageObject messageObject = this.currentMessageObject;
            if (messageObject == null || (message = messageObject.messageOwner) == null) {
                return 0L;
            }
            return message.paid_message_stars;
        }
        Iterator<MessageObject> it = groupedMessages.messages.iterator();
        long j = 0;
        while (it.hasNext()) {
            MessageObject next = it.next();
            j += (next == null || (message2 = next.messageOwner) == null) ? 0L : message2.paid_message_stars;
        }
        return j;
    }

    public TLRPC.Document getStreamingMedia() {
        int i = this.documentAttachType;
        if (i == 4 || i == 7 || i == 2) {
            return this.documentAttach;
        }
        return null;
    }

    public int getTextX() {
        return this.textX;
    }

    public int getTextY() {
        return this.textY;
    }

    public int getThemedColor(int i) {
        return Theme.getColor(i, this.resourcesProvider);
    }

    public Paint getThemedPaint(String str) {
        Theme.ResourcesProvider resourcesProvider = this.resourcesProvider;
        Paint paint = resourcesProvider != null ? resourcesProvider.getPaint(str) : null;
        return paint != null ? paint : Theme.getThemePaint(str);
    }

    public float getTimeAlpha() {
        return this.timeAlpha;
    }

    public float getTimeX() {
        return this.transitionParams.shouldAnimateTimeX ? AndroidUtilities.lerp(r0.animateFromTimeX, this.timeX, r0.animateChangeProgress) : this.timeX;
    }

    public float getTimeY() {
        float f;
        int iDp;
        int iDp2 = 0;
        if (shouldDrawTimeOnMedia()) {
            if (this.drawCommentButton) {
                f = 41.3f;
                iDp2 = AndroidUtilities.dp(f);
            }
            iDp = -iDp2;
        } else if (this.currentMessageObject.isSponsored()) {
            iDp = -AndroidUtilities.dp(48.0f);
            if (this.hasNewLineForTime) {
                iDp -= AndroidUtilities.dp(4.0f);
            }
        } else {
            if (this.drawCommentButton) {
                f = 43.0f;
                iDp2 = AndroidUtilities.dp(f);
            }
            iDp = -iDp2;
        }
        return getTimeY(iDp);
    }

    public float getTimeY(float f) {
        if (shouldDrawTimeOnMedia() && this.documentAttachType != 7) {
            return ((getPhotoBottom() + this.additionalTimeOffsetY) - AndroidUtilities.dp(7.3f)) - this.timeLayout.getHeight();
        }
        float fDp = ((this.layoutHeight - AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 7.5f : 6.5f)) - this.timeLayout.getHeight()) + f;
        if (this.isRoundVideo) {
            fDp -= (AndroidUtilities.dp(this.drawPinnedBottom ? 4.0f : 5.0f) + this.reactionsLayoutInBubble.getCurrentTotalHeight(this.transitionParams.animateChangeProgress)) * (1.0f - getVideoTranscriptionProgress());
        }
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages == null) {
            TransitionParams transitionParams = this.transitionParams;
            return fDp + (transitionParams.deltaBottom - transitionParams.deltaTop);
        }
        MessageObject.GroupedMessages.TransitionParams transitionParams2 = groupedMessages.transitionParams;
        float f2 = fDp + transitionParams2.offsetBottom;
        return transitionParams2.backgroundChangeBounds ? f2 - getTranslationY() : f2;
    }

    public int getTodoIndex(int i) {
        for (int i2 = 0; i2 < this.pollButtons.size(); i2++) {
            PollButton pollButton = (PollButton) this.pollButtons.get(i2);
            if (pollButton.task != null && pollButton.task.id == i) {
                return i2;
            }
        }
        return -1;
    }

    public int getTopMediaOffset() {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || messageObject.type != 14) {
            return 0;
        }
        return this.mediaOffsetY + this.namesOffset;
    }

    public int getTopicSeparatorTopPadding() {
        TransitionParams transitionParams = this.transitionParams;
        return transitionParams.animateMonoforumPadding ? AndroidUtilities.lerp(transitionParams.animateMonoforumPaddingFrom, this.topicSeparatorTopPadding, transitionParams.animateChangeProgress) : this.topicSeparatorTopPadding;
    }

    public TransitionParams getTransitionParams() {
        return this.transitionParams;
    }

    public float getVideoTranscriptionProgress() {
        MessageObject messageObject;
        if (this.transitionParams == null || (messageObject = this.currentMessageObject) == null || !messageObject.isRoundVideo()) {
            return 1.0f;
        }
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateDrawBackground) {
            boolean z = this.drawBackground;
            float f = transitionParams.animateChangeProgress;
            return z ? f : 1.0f - f;
        }
        if (this.drawBackground) {
            return 1.0f;
        }
        return BitmapDescriptorFactory.HUE_RED;
    }

    public float getViewTop() {
        return this.viewTop;
    }

    public int getWidthForButtons() {
        TransitionParams transitionParams = this.transitionParams;
        return transitionParams.animateWidthForButton ? AndroidUtilities.lerp(transitionParams.animateFromWidthForButton, this.widthForButtons, transitionParams.animateChangeProgress) : this.widthForButtons;
    }

    public boolean hasCaptionLayout() {
        return this.captionLayout != null;
    }

    public boolean hasCommentLayout() {
        return this.drawCommentButton;
    }

    public boolean hasGradientService() {
        Theme.ResourcesProvider resourcesProvider = this.resourcesProvider;
        return resourcesProvider != null ? resourcesProvider.hasGradientService() : Theme.hasGradientService();
    }

    public boolean hasNameLayout() {
        if (this.drawNameLayout && this.nameLayout != null) {
            return true;
        }
        if (this.drawForwardedName) {
            StaticLayout[] staticLayoutArr = this.forwardedNameLayout;
            if (staticLayoutArr[0] != null && staticLayoutArr[1] != null) {
                MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
                if (groupedMessagePosition == null) {
                    return true;
                }
                if (groupedMessagePosition.minY == 0 && groupedMessagePosition.minX == 0) {
                    return true;
                }
            }
        }
        return this.replyNameLayout != null;
    }

    /* JADX WARN: Code restructure failed: missing block: B:38:0x0055, code lost:
    
        if ((r0 & 1) != 0) goto L39;
     */
    /* JADX WARN: Code restructure failed: missing block: B:47:0x0067, code lost:
    
        if ((r0 & 1) != 0) goto L48;
     */
    /* JADX WARN: Code restructure failed: missing block: B:56:0x0079, code lost:
    
        if ((r0 & 1) != 0) goto L57;
     */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public boolean hasOutboundsContent() {
        AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable;
        MessageObject messageObject;
        MessageObject messageObject2;
        int i;
        AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable2 = this.effectDrawable;
        if ((swapAnimatedEmojiDrawable2 != null && swapAnimatedEmojiDrawable2.isNotEmpty() > BitmapDescriptorFactory.HUE_RED) || this.hasFactCheck) {
            return true;
        }
        if (this.transitionParams.animateExpandedQuotes && ((i = (messageObject2 = this.currentMessageObject).type) == 0 || i == 24 || i == 19 || messageObject2.isGiveawayOrGiveawayResults())) {
            return true;
        }
        if (this.channelRecommendationsCell != null && (messageObject = this.currentMessageObject) != null && messageObject.type == 27) {
            return true;
        }
        if (!this.drawTopic) {
            boolean z = this.transitionParams.animateDrawTopic;
        }
        if (this.starsPriceText != null) {
            MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
            if (groupedMessagePosition != null) {
                int i2 = groupedMessagePosition.flags;
                if ((i2 & 4) != 0) {
                }
            }
            return true;
        }
        if (this.topicSeparator != null) {
            MessageObject.GroupedMessagePosition groupedMessagePosition2 = this.currentPosition;
            if (groupedMessagePosition2 != null) {
                int i3 = groupedMessagePosition2.flags;
                if ((i3 & 4) != 0) {
                }
            }
            return true;
        }
        if (this.suggestionOffer != null) {
            MessageObject.GroupedMessagePosition groupedMessagePosition3 = this.currentPosition;
            if (groupedMessagePosition3 != null) {
                int i4 = groupedMessagePosition3.flags;
                if ((i4 & 4) != 0) {
                }
            }
            return true;
        }
        if (getAlpha() != 1.0f) {
            return false;
        }
        if (this.reactionsLayoutInBubble.hasOverlay()) {
            return true;
        }
        if ((!this.transitionParams.transitionBotButtons.isEmpty() && this.transitionParams.animateBotButtonsChanged) || !this.botButtons.isEmpty() || this.drawSideButton != 0) {
            return true;
        }
        if (this.drawNameLayout && this.nameLayout != null && (swapAnimatedEmojiDrawable = this.currentNameEmojiStatusDrawable) != null && !swapAnimatedEmojiDrawable.isEmpty()) {
            return true;
        }
        AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans = this.animatedEmojiStack;
        if (emojiGroupedSpans != null && !emojiGroupedSpans.holders.isEmpty()) {
            return true;
        }
        AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable3 = this.currentNameStatusDrawable;
        if (swapAnimatedEmojiDrawable3 != null && !swapAnimatedEmojiDrawable3.isEmpty()) {
            return true;
        }
        if (this.currentMessagesGroup == null) {
            TransitionParams transitionParams = this.transitionParams;
            if (((transitionParams.animateReplaceCaptionLayout && transitionParams.animateChangeProgress != 1.0f) || (transitionParams.animateChangeProgress != 1.0f && transitionParams.animateMessageText)) && transitionParams.animateOutAnimateEmoji != null && !this.transitionParams.animateOutAnimateEmoji.holders.isEmpty()) {
                return true;
            }
        }
        return false;
    }

    public boolean hasSpoilers() {
        ArrayList<MessageObject.TextLayoutBlock> arrayList;
        MessageObject.TextLayoutBlocks textLayoutBlocks = this.captionLayout;
        if (textLayoutBlocks != null && (arrayList = textLayoutBlocks.textLayoutBlocks) != null) {
            Iterator<MessageObject.TextLayoutBlock> it = arrayList.iterator();
            while (it.hasNext()) {
                if (!it.next().spoilers.isEmpty()) {
                    return true;
                }
            }
        }
        if (getMessageObject() == null || getMessageObject().textLayoutBlocks == null) {
            return false;
        }
        Iterator<MessageObject.TextLayoutBlock> it2 = getMessageObject().textLayoutBlocks.iterator();
        while (it2.hasNext()) {
            if (!it2.next().spoilers.isEmpty()) {
                return true;
            }
        }
        return false;
    }

    @Override // org.telegram.ui.Cells.BaseCell, android.view.View
    public void invalidate() {
        ChatMessageCellDelegate chatMessageCellDelegate;
        if (this.currentMessageObject == null) {
            return;
        }
        Runnable runnable = this.invalidateCallback;
        if (runnable != null) {
            runnable.run();
        }
        Runnable runnable2 = this.overrideInvalidate;
        if (runnable2 != null) {
            runnable2.run();
            return;
        }
        Runnable runnable3 = this.invalidateListener;
        if (runnable3 != null) {
            runnable3.run();
        }
        super.invalidate();
        if ((this.invalidatesParent || (this.currentMessagesGroup != null && invalidateParentForce())) && getParent() != null) {
            View view = (View) getParent();
            if (view.getParent() != null) {
                view.invalidate();
                ((View) view.getParent()).invalidate();
            }
        }
        if (!this.isBlurred || (chatMessageCellDelegate = this.delegate) == null) {
            return;
        }
        chatMessageCellDelegate.invalidateBlur();
    }

    @Override // android.view.View
    public void invalidate(int i, int i2, int i3, int i4) {
        ChatMessageCellDelegate chatMessageCellDelegate;
        if (this.currentMessageObject == null) {
            return;
        }
        Runnable runnable = this.overrideInvalidate;
        if (runnable != null) {
            runnable.run();
            return;
        }
        Runnable runnable2 = this.invalidateListener;
        if (runnable2 != null) {
            runnable2.run();
        }
        super.invalidate(i, i2, i3, i4);
        if (this.invalidatesParent && getParent() != null) {
            ((View) getParent()).invalidate(((int) getX()) + i, ((int) getY()) + i2, ((int) getX()) + i3, ((int) getY()) + i4);
        }
        if (!this.isBlurred || (chatMessageCellDelegate = this.delegate) == null) {
            return;
        }
        chatMessageCellDelegate.invalidateBlur();
    }

    @Override // android.view.View, android.graphics.drawable.Drawable.Callback
    public void invalidateDrawable(Drawable drawable) {
        super.invalidateDrawable(drawable);
        if (this.currentMessagesGroup != null) {
            invalidateWithParent();
        }
    }

    @Override // org.telegram.ui.Cells.BaseCell
    public void invalidateLite() {
        ChatMessageCellDelegate chatMessageCellDelegate;
        if (this.currentMessageObject == null) {
            return;
        }
        Runnable runnable = this.overrideInvalidate;
        if (runnable != null) {
            runnable.run();
            return;
        }
        Runnable runnable2 = this.invalidateListener;
        if (runnable2 != null) {
            runnable2.run();
        }
        super.invalidate();
        if ((this.invalidatesParent || (this.currentMessagesGroup != null && invalidateParentForce())) && getParent() != null) {
            View view = (View) getParent();
            if (view.getParent() != null) {
                view.invalidate();
                ((View) view.getParent()).invalidate();
            }
        }
        if (!this.isBlurred || (chatMessageCellDelegate = this.delegate) == null) {
            return;
        }
        chatMessageCellDelegate.invalidateBlur();
    }

    public void invalidateOutbounds() {
        ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
        if (chatMessageCellDelegate != null && chatMessageCellDelegate.canDrawOutboundsContent()) {
            super.invalidate();
        } else if (getParent() instanceof View) {
            ((View) getParent()).invalidate();
        }
    }

    public boolean isAdminLayoutChanged() {
        return !TextUtils.equals(this.lastPostAuthor, this.currentMessageObject.messageOwner.post_author);
    }

    public boolean isAnimatingPollAnswer() {
        return this.animatePollAnswerAlpha;
    }

    public boolean isCellAttachedToWindow() {
        return this.attachedToWindow;
    }

    public boolean isCheckBoxVisible() {
        return this.checkBoxVisible || this.checkBoxAnimationInProgress;
    }

    public boolean isDrawNameLayout() {
        return this.drawNameLayout && this.nameLayout != null;
    }

    public boolean isDrawPinnedBottom() {
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        return this.mediaBackground || this.drawPinnedBottom || (groupedMessagePosition != null && (groupedMessagePosition.flags & 8) == 0 && this.currentMessagesGroup.isDocuments);
    }

    public boolean isDrawSelectionBackground() {
        MessageObject messageObject;
        return ((isPressed() && this.isCheckPressed) || ((!this.isCheckPressed && this.isPressed) || this.isHighlighted)) && !textIsSelectionMode() && !hasSelectionOverlay() && ((messageObject = this.currentMessageObject) == null || !messageObject.preview);
    }

    public boolean isDrawingSelectionBackground() {
        return this.drawSelectionBackground || this.isHighlightedAnimated || this.isHighlighted;
    }

    public boolean isFirstInChat() {
        return this.messageObjectToSet != null ? this.firstInChatToSet : this.firstInChat;
    }

    public boolean isHighlighted() {
        return this.isHighlighted;
    }

    public boolean isHighlightedAnimated() {
        return this.isHighlightedAnimated;
    }

    public boolean isInsideBackground(float f, float f2) {
        if (this.currentBackgroundDrawable != null) {
            if (f >= this.backgroundDrawableLeft && f <= r3 + this.backgroundDrawableRight) {
                return true;
            }
        }
        return false;
    }

    protected boolean isNeedAuthorName() {
        TLRPC.Message message;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject.forceAvatar) {
            return true;
        }
        if (messageObject.getDialogId() == UserObject.VERIFY && (message = this.currentMessageObject.messageOwner) != null && message.fwd_from != null) {
            return true;
        }
        if (this.currentMessageObject.isSponsored() || this.currentMessageObject.isGiveawayOrGiveawayResults()) {
            return false;
        }
        if (this.isPinnedChat && this.currentMessageObject.type == 0) {
            return true;
        }
        if (!this.pinnedTop && this.drawName && this.isChat) {
            if (!this.currentMessageObject.isOutOwner()) {
                return true;
            }
            if ((this.currentMessageObject.isSupergroup() && this.currentMessageObject.isFromGroup()) || this.currentMessageObject.isRepostPreview) {
                return true;
            }
        }
        return this.currentMessageObject.isImportedForward() && this.currentMessageObject.messageOwner.fwd_from.from_id == null;
    }

    public boolean isPinnedBottom() {
        return this.messageObjectToSet != null ? this.bottomNearToSet : this.pinnedBottom;
    }

    public boolean isPinnedTop() {
        return this.messageObjectToSet != null ? this.topNearToSet : this.pinnedTop;
    }

    public boolean isPlayingRound() {
        return this.isRoundVideo && this.isPlayingRound;
    }

    @Override // org.telegram.ui.Components.SeekBar.SeekBarDelegate
    public boolean isSeekBarDragAllowed() {
        MessageObject messageObject = this.currentMessageObject;
        return messageObject == null || !messageObject.isVoiceOnce();
    }

    protected boolean isWidthAdaptive() {
        return false;
    }

    /* JADX WARN: Code restructure failed: missing block: B:25:0x0070, code lost:
    
        if (r2 != null) goto L31;
     */
    /* JADX WARN: Code restructure failed: missing block: B:30:0x0082, code lost:
    
        if (r2 != null) goto L31;
     */
    /* JADX WARN: Code restructure failed: missing block: B:31:0x0084, code lost:
    
        r2 = r2.getLineBottom(r2.getLineCount() - 1);
     */
    /* JADX WARN: Removed duplicated region for block: B:56:0x00fe  */
    /* JADX WARN: Removed duplicated region for block: B:58:0x0108  */
    /* JADX WARN: Removed duplicated region for block: B:70:0x0154  */
    /* JADX WARN: Removed duplicated region for block: B:72:0x0165  */
    /* JADX WARN: Removed duplicated region for block: B:83:0x0191  */
    /* JADX WARN: Removed duplicated region for block: B:94:? A[ADDED_TO_REGION, RETURN, SYNTHETIC] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void layoutTextXY(boolean z) {
        int currentBackgroundLeft;
        int iDp;
        int iDp2;
        int iDp3;
        int i;
        StaticLayout staticLayout;
        int iTextHeight;
        int iDp4;
        int iDp5;
        int iDp6;
        if (this.currentMessageObject.isOutOwner()) {
            currentBackgroundLeft = z ? (int) (this.backgroundDrawableLeft + this.transitionParams.deltaLeft) : getCurrentBackgroundLeft();
            iDp = AndroidUtilities.dp(11.0f);
        } else {
            currentBackgroundLeft = z ? (int) (this.backgroundDrawableLeft + this.transitionParams.deltaLeft) : getCurrentBackgroundLeft();
            if (this.currentMessageObject.type == 19) {
                iDp = 0;
            } else {
                iDp = AndroidUtilities.dp((this.mediaBackground || !this.drawPinnedBottom) ? 17.0f : 11.0f);
            }
        }
        this.textX = currentBackgroundLeft + iDp + getExtraTextX();
        if (!this.hasGamePreview) {
            if (this.hasInvoicePreview) {
                iDp2 = AndroidUtilities.dp(14.0f) + this.namesOffset;
                this.textY = iDp2;
                staticLayout = this.siteNameLayout;
            } else if (this.currentMessageObject.type == 19) {
                this.textY = AndroidUtilities.dp(6.0f) + this.namesOffset;
                this.textX = !this.currentMessageObject.isOut() ? getCurrentBackgroundLeft() : this.textX - AndroidUtilities.dp(4.0f);
            } else {
                int iDp7 = AndroidUtilities.dp(8.0f) + this.namesOffset;
                this.textY = iDp7;
                if (this.currentMessageObject.hasCodeAtTop && (i = SharedConfig.bubbleRadius) > 10) {
                    this.textY = iDp7 + AndroidUtilities.dp(i < 15 ? 1.0f : 2.0f);
                }
                if (this.currentMessageObject.hasCodeAtTop && this.namesOffset > 0) {
                    iDp2 = this.textY;
                    iDp3 = AndroidUtilities.dp(5.0f);
                }
            }
            if (!this.currentMessageObject.isSponsored()) {
                iTextHeight = this.textY;
                iDp4 = AndroidUtilities.dp(14.0f);
            } else {
                if (this.linkPreviewAbove) {
                    this.linkPreviewY = this.textY + AndroidUtilities.dp(10.0f);
                    this.textY += this.linkPreviewHeight + AndroidUtilities.dp(13.0f);
                    if (this.drawInstantView && !this.hasInvoicePreview && !this.currentMessageObject.isGiveawayOrGiveawayResults()) {
                        this.textY += AndroidUtilities.dp(44.0f);
                    }
                    if (this.linkPreviewAbove) {
                        iDp5 = this.textY + this.currentMessageObject.textHeight(this.transitionParams);
                        iDp6 = AndroidUtilities.dp(10.0f);
                    } else {
                        iDp5 = this.linkPreviewY + this.linkPreviewHeight + AndroidUtilities.dp(this.drawInstantView ? 46.0f : BitmapDescriptorFactory.HUE_RED);
                        iDp6 = AndroidUtilities.dp(this.linkPreviewHeight <= 0 ? -8.0f : 4.0f);
                    }
                    this.factCheckY = iDp5 + iDp6;
                    this.unmovedTextX = this.textX;
                    if (this.currentMessageObject.textXOffset == BitmapDescriptorFactory.HUE_RED || this.replyNameLayout == null) {
                        return;
                    }
                    int iDp8 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                    MessageObject messageObject = this.currentMessageObject;
                    int iDp9 = iDp8 - messageObject.textWidth;
                    if (!this.hasNewLineForTime) {
                        iDp9 -= this.timeWidth + AndroidUtilities.dp((messageObject.isOutOwner() ? 20 : 0) + 4);
                    }
                    if (iDp9 > 0) {
                        this.textX += iDp9 - getExtraTimeX();
                        return;
                    }
                    return;
                }
                iTextHeight = this.textY + this.currentMessageObject.textHeight(this.transitionParams);
                iDp4 = AndroidUtilities.dp(10.0f);
            }
            this.linkPreviewY = iTextHeight + iDp4;
            if (this.linkPreviewAbove) {
            }
            this.factCheckY = iDp5 + iDp6;
            this.unmovedTextX = this.textX;
            if (this.currentMessageObject.textXOffset == BitmapDescriptorFactory.HUE_RED) {
                return;
            } else {
                return;
            }
        }
        this.textX += AndroidUtilities.dp(11.0f);
        iDp2 = AndroidUtilities.dp(14.0f) + this.namesOffset;
        this.textY = iDp2;
        staticLayout = this.siteNameLayout;
        this.textY = iDp2 + iDp3;
        if (!this.currentMessageObject.isSponsored()) {
        }
        this.linkPreviewY = iTextHeight + iDp4;
        if (this.linkPreviewAbove) {
        }
        this.factCheckY = iDp5 + iDp6;
        this.unmovedTextX = this.textX;
        if (this.currentMessageObject.textXOffset == BitmapDescriptorFactory.HUE_RED) {
        }
    }

    protected SpoilerEffect2 makeSpoilerEffect() {
        return SpoilerEffect2.getInstance(this);
    }

    public void markReactionsAsRead() {
        this.reactionsLayoutInBubble.hasUnreadReactions = false;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            return;
        }
        messageObject.markReactionsAsRead();
    }

    public boolean needDelayRoundProgressDraw() {
        MessageObject messageObject;
        int i = this.documentAttachType;
        return (i == 7 || i == 4) && (messageObject = this.currentMessageObject) != null && messageObject.type != 5 && MediaController.getInstance().isPlayingMessage(this.currentMessageObject);
    }

    public boolean needDrawAvatar() {
        MessageObject messageObject;
        MessageObject messageObject2;
        MessageObject messageObject3;
        return (this.isChat && !this.isSavedPreviewChat && ((!this.isThreadPost || this.isForum) && (messageObject3 = this.currentMessageObject) != null && !messageObject3.isOutOwner() && this.currentMessageObject.needDrawAvatar())) || ((messageObject = this.currentMessageObject) != null && messageObject.getDialogId() == UserObject.VERIFY) || ((messageObject2 = this.currentMessageObject) != null && messageObject2.forceAvatar);
    }

    public boolean needDrawTime() {
        MessageObject messageObject;
        return !this.forceNotDrawTime && ((messageObject = this.currentMessageObject) == null || messageObject.type != 27);
    }

    @Override // org.telegram.messenger.ImageReceiver.ImageReceiverDelegate
    public void onAnimationReady(ImageReceiver imageReceiver) {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && imageReceiver == this.photoImage && messageObject.isAnimatedSticker()) {
            this.delegate.setShouldNotRepeatSticker(this.currentMessageObject);
        }
    }

    @Override // android.view.ViewGroup, android.view.View
    protected void onAttachedToWindow() throws Resources.NotFoundException, NumberFormatException {
        super.onAttachedToWindow();
        NotificationCenter.getGlobalInstance().addObserver(this, NotificationCenter.startSpoilers);
        NotificationCenter.getGlobalInstance().addObserver(this, NotificationCenter.stopSpoilers);
        NotificationCenter.getGlobalInstance().addObserver(this, NotificationCenter.emojiLoaded);
        NotificationCenter.getGlobalInstance().addObserver(this, NotificationCenter.didUpdatePremiumGiftStickers);
        NotificationCenter.getInstance(this.currentAccount).addObserver(this, NotificationCenter.userInfoDidLoad);
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null) {
            messageObject.animateComments = false;
        }
        AvatarsDrawable avatarsDrawable = this.groupCallParticipantsAvatars;
        if (avatarsDrawable != null) {
            avatarsDrawable.onAttachedToWindow();
        }
        Iterator it = this.pollButtons.iterator();
        while (it.hasNext()) {
            ((PollButton) it.next()).attach();
        }
        MessageObject messageObject2 = this.messageObjectToSet;
        if (messageObject2 != null) {
            messageObject2.animateComments = false;
            setMessageContent(messageObject2, this.groupedMessagesToSet, this.bottomNearToSet, this.topNearToSet, this.firstInChatToSet);
            this.messageObjectToSet = null;
            this.groupedMessagesToSet = null;
        }
        CheckBoxBase checkBoxBase = this.checkBox;
        if (checkBoxBase != null) {
            checkBoxBase.onAttachedToWindow();
        }
        CheckBoxBase checkBoxBase2 = this.mediaCheckBox;
        if (checkBoxBase2 != null) {
            checkBoxBase2.onAttachedToWindow();
        }
        TopicSeparator topicSeparator = this.topicSeparator;
        if (topicSeparator != null) {
            topicSeparator.attach();
        }
        CheckBoxBase checkBoxBase3 = this.replyTaskCheckbox;
        if (checkBoxBase3 != null) {
            checkBoxBase3.onAttachedToWindow();
        }
        if (this.pollCheckBox != null) {
            int i = 0;
            while (true) {
                CheckBoxBase[] checkBoxBaseArr = this.pollCheckBox;
                if (i >= checkBoxBaseArr.length) {
                    break;
                }
                checkBoxBaseArr[i].onAttachedToWindow();
                i++;
            }
        }
        this.attachedToWindow = true;
        float f = BitmapDescriptorFactory.HUE_RED;
        this.animationOffsetX = BitmapDescriptorFactory.HUE_RED;
        this.slidingOffsetX = BitmapDescriptorFactory.HUE_RED;
        this.checkBoxTranslation = 0;
        updateTranslation();
        this.avatarImage.setParentView((View) getParent());
        this.avatarImage.onAttachedToWindow();
        ImageReceiver imageReceiver = this.sideImage;
        if (imageReceiver != null) {
            imageReceiver.onAttachedToWindow();
        }
        checkImageReceiversAttachState();
        MessageObject messageObject3 = this.currentMessageObject;
        if (messageObject3 != null) {
            setAvatar(messageObject3);
        }
        int i2 = this.documentAttachType;
        if (i2 == 4 && this.autoPlayingMedia) {
            boolean zIsPlayingMessage = MediaController.getInstance().isPlayingMessage(this.currentMessageObject);
            this.animatingNoSoundPlaying = zIsPlayingMessage;
            this.animatingNoSoundProgress = zIsPlayingMessage ? BitmapDescriptorFactory.HUE_RED : 1.0f;
            this.animatingNoSound = 0;
        } else {
            this.animatingNoSoundPlaying = false;
            this.animatingNoSoundProgress = BitmapDescriptorFactory.HUE_RED;
            this.animatingDrawVideoImageButtonProgress = ((i2 == 4 || i2 == 2) && this.drawVideoSize) ? 1.0f : BitmapDescriptorFactory.HUE_RED;
        }
        if (getDelegate() != null && getDelegate().getTextSelectionHelper() != null) {
            getDelegate().getTextSelectionHelper().onChatMessageCellAttached(this);
        }
        if (this.documentAttachType == 5) {
            if (MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                f = 1.0f;
            }
            this.toSeekBarProgress = f;
        }
        this.reactionsLayoutInBubble.onAttachToWindow();
        FlagSecureReason flagSecureReason = this.flagSecure;
        if (flagSecureReason != null) {
            flagSecureReason.attach();
        }
        GroupMedia groupMedia = this.groupMedia;
        if (groupMedia != null) {
            groupMedia.onAttachedToWindow();
        }
        updateFlagSecure();
        MessageObject messageObject4 = this.currentMessageObject;
        if (messageObject4 != null && messageObject4.type == 20 && this.unlockLayout != null) {
            invalidate();
        }
        AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable = this.currentNameStatusDrawable;
        if (swapAnimatedEmojiDrawable != null) {
            swapAnimatedEmojiDrawable.attach();
        }
        AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable2 = this.currentNameEmojiStatusDrawable;
        if (swapAnimatedEmojiDrawable2 != null) {
            swapAnimatedEmojiDrawable2.attach();
        }
        SpoilerEffect2 spoilerEffect2 = this.mediaSpoilerEffect2;
        if (spoilerEffect2 != null) {
            if (spoilerEffect2.destroyed) {
                SpoilerEffect2 spoilerEffect2MakeSpoilerEffect = makeSpoilerEffect();
                this.mediaSpoilerEffect2 = spoilerEffect2MakeSpoilerEffect;
                Integer num = this.mediaSpoilerEffect2Index;
                if (num != null) {
                    spoilerEffect2MakeSpoilerEffect.reassignAttach(this, num.intValue());
                }
            } else {
                spoilerEffect2.attach(this);
            }
        }
        ChannelRecommendationsCell channelRecommendationsCell = this.channelRecommendationsCell;
        if (channelRecommendationsCell != null) {
            channelRecommendationsCell.onAttachedToWindow();
        }
        StickerSetLinkIcon stickerSetLinkIcon = this.stickerSetIcons;
        if (stickerSetLinkIcon != null) {
            stickerSetLinkIcon.attach(this);
        }
    }

    @Override // android.view.ViewGroup, android.view.View
    protected void onDetachedFromWindow() {
        super.onDetachedFromWindow();
        NotificationCenter.getGlobalInstance().removeObserver(this, NotificationCenter.startSpoilers);
        NotificationCenter.getGlobalInstance().removeObserver(this, NotificationCenter.stopSpoilers);
        NotificationCenter.getGlobalInstance().removeObserver(this, NotificationCenter.emojiLoaded);
        NotificationCenter.getGlobalInstance().removeObserver(this, NotificationCenter.didUpdatePremiumGiftStickers);
        NotificationCenter.getInstance(this.currentAccount).removeObserver(this, NotificationCenter.userInfoDidLoad);
        cancelShakeAnimation();
        CheckBoxBase checkBoxBase = this.checkBox;
        if (checkBoxBase != null) {
            checkBoxBase.onDetachedFromWindow();
        }
        Iterator it = this.pollButtons.iterator();
        while (it.hasNext()) {
            ((PollButton) it.next()).detach();
        }
        AvatarsDrawable avatarsDrawable = this.groupCallParticipantsAvatars;
        if (avatarsDrawable != null) {
            avatarsDrawable.onDetachedFromWindow();
        }
        CheckBoxBase checkBoxBase2 = this.mediaCheckBox;
        if (checkBoxBase2 != null) {
            checkBoxBase2.onDetachedFromWindow();
        }
        if (this.pollCheckBox != null) {
            int i = 0;
            while (true) {
                CheckBoxBase[] checkBoxBaseArr = this.pollCheckBox;
                if (i >= checkBoxBaseArr.length) {
                    break;
                }
                checkBoxBaseArr[i].onDetachedFromWindow();
                i++;
            }
        }
        CheckBoxBase checkBoxBase3 = this.replyTaskCheckbox;
        if (checkBoxBase3 != null) {
            checkBoxBase3.onDetachedFromWindow();
        }
        this.attachedToWindow = false;
        GroupMedia groupMedia = this.groupMedia;
        if (groupMedia != null) {
            groupMedia.onDetachedFromWindow();
        }
        this.avatarImage.onDetachedFromWindow();
        ImageReceiver imageReceiver = this.sideImage;
        if (imageReceiver != null) {
            imageReceiver.onDetachedFromWindow();
        }
        TopicSeparator topicSeparator = this.topicSeparator;
        if (topicSeparator != null) {
            topicSeparator.detach();
        }
        checkImageReceiversAttachState();
        if (this.addedForTest && this.currentUrl != null && this.currentWebFile != null) {
            ImageLoader.getInstance().removeTestWebFile(this.currentUrl);
            this.addedForTest = false;
        }
        StickerSetLinkIcon stickerSetLinkIcon = this.stickerSetIcons;
        if (stickerSetLinkIcon != null) {
            stickerSetLinkIcon.detach(this);
        }
        DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
        if (getDelegate() != null && getDelegate().getTextSelectionHelper() != null) {
            getDelegate().getTextSelectionHelper().onChatMessageCellDetached(this);
        }
        this.transitionParams.onDetach();
        if (MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
            Theme.getCurrentAudiVisualizerDrawable().setParentView(null);
        }
        ValueAnimator valueAnimator = this.statusDrawableAnimator;
        if (valueAnimator != null) {
            valueAnimator.removeAllListeners();
            this.statusDrawableAnimator.cancel();
        }
        this.reactionsLayoutInBubble.onDetachFromWindow();
        this.statusDrawableAnimationInProgress = false;
        FlagSecureReason flagSecureReason = this.flagSecure;
        if (flagSecureReason != null) {
            flagSecureReason.detach();
        }
        AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable = this.currentNameStatusDrawable;
        if (swapAnimatedEmojiDrawable != null) {
            swapAnimatedEmojiDrawable.detach();
        }
        AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable2 = this.currentNameEmojiStatusDrawable;
        if (swapAnimatedEmojiDrawable2 != null) {
            swapAnimatedEmojiDrawable2.detach();
        }
        SpoilerEffect2 spoilerEffect2 = this.mediaSpoilerEffect2;
        if (spoilerEffect2 != null) {
            spoilerEffect2.detach(this);
        }
        ChannelRecommendationsCell channelRecommendationsCell = this.channelRecommendationsCell;
        if (channelRecommendationsCell != null) {
            channelRecommendationsCell.onDetachedFromWindow();
        }
    }

    @Override // android.view.View
    protected void onDraw(Canvas canvas) {
        drawInternal(canvas);
    }

    @Override // org.telegram.messenger.DownloadController.FileDownloadProgressListener
    public void onFailedDownload(String str, boolean z) {
        int i = this.documentAttachType;
        updateButtonState(true, i == 3 || i == 5, false);
    }

    @Override // android.view.View
    public boolean onHoverEvent(MotionEvent motionEvent) {
        int eventX = (int) getEventX(motionEvent);
        int eventY = (int) getEventY(motionEvent);
        if (motionEvent.getAction() == 9 || motionEvent.getAction() == 7) {
            for (int i = 0; i < this.accessibilityVirtualViewBounds.size(); i++) {
                if (((Rect) this.accessibilityVirtualViewBounds.valueAt(i)).contains(eventX, eventY)) {
                    int iKeyAt = this.accessibilityVirtualViewBounds.keyAt(i);
                    if (iKeyAt == this.currentFocusedVirtualView) {
                        return true;
                    }
                    this.currentFocusedVirtualView = iKeyAt;
                    sendAccessibilityEventForVirtualView(iKeyAt, LiteMode.FLAG_CHAT_SCALE);
                    return true;
                }
            }
        } else if (motionEvent.getAction() == 10) {
            this.currentFocusedVirtualView = 0;
        }
        return super.onHoverEvent(motionEvent);
    }

    @Override // android.view.View
    public void onInitializeAccessibilityNodeInfo(AccessibilityNodeInfo accessibilityNodeInfo) {
        super.onInitializeAccessibilityNodeInfo(accessibilityNodeInfo);
    }

    /* JADX WARN: Removed duplicated region for block: B:115:0x028c  */
    /* JADX WARN: Removed duplicated region for block: B:135:0x0306  */
    /* JADX WARN: Removed duplicated region for block: B:137:0x0317  */
    /* JADX WARN: Removed duplicated region for block: B:191:0x0435  */
    /* JADX WARN: Removed duplicated region for block: B:197:0x046e  */
    /* JADX WARN: Removed duplicated region for block: B:203:0x048b  */
    /* JADX WARN: Removed duplicated region for block: B:324:0x07c9  */
    /* JADX WARN: Removed duplicated region for block: B:330:0x0800  */
    /* JADX WARN: Removed duplicated region for block: B:336:0x081d  */
    /* JADX WARN: Removed duplicated region for block: B:339:0x083b  */
    /* JADX WARN: Removed duplicated region for block: B:419:? A[RETURN, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:48:0x0103  */
    /* JADX WARN: Removed duplicated region for block: B:74:0x0171  */
    /* JADX WARN: Removed duplicated region for block: B:77:0x0187  */
    /* JADX WARN: Removed duplicated region for block: B:80:0x019a  */
    /* JADX WARN: Removed duplicated region for block: B:84:0x01ba  */
    /* JADX WARN: Removed duplicated region for block: B:87:0x01c0  */
    /* JADX WARN: Removed duplicated region for block: B:90:0x01e2  */
    /* JADX WARN: Removed duplicated region for block: B:93:0x01e8  */
    @Override // android.view.ViewGroup, android.view.View
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    protected void onLayout(boolean z, int i, int i2, int i3, int i4) {
        int i5;
        int iDp;
        int i6;
        float f;
        int iDp2;
        int i7;
        int iDp3;
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        int iDp4;
        int i8;
        int i9;
        int i10;
        int iDp5;
        int iDp6;
        int iDp7;
        MessageObject messageObject;
        MessageObject.GroupedMessagePosition groupedMessagePosition2;
        int iDp8;
        int iDp9;
        int iDp10;
        MessageObject.TextLayoutBlocks textLayoutBlocks;
        MessageObject.TextLayoutBlocks textLayoutBlocks2;
        int iDp11;
        int iDp12;
        MessageObject.GroupedMessagePosition groupedMessagePosition3;
        int iDp13;
        int iDp14;
        int iDp15;
        int iDp16;
        int iDp17;
        int iDp18;
        float f2;
        MessageObject.TextLayoutBlocks textLayoutBlocks3;
        int i11;
        int iDp19;
        MessageObject.TextLayoutBlocks textLayoutBlocks4;
        MessageObject.TextLayoutBlocks textLayoutBlocks5;
        int iDp20;
        int iDp21;
        int iTextHeight;
        int iDp22;
        int iDp23;
        int iDp24;
        if (this.currentMessageObject == null) {
            return;
        }
        int measuredHeight = getMeasuredHeight() + (getMeasuredWidth() << 16);
        if (this.lastSize != measuredHeight || !this.wasLayout || this.forcedLayout) {
            this.layoutWidth = getMeasuredWidth();
            this.layoutHeight = (getMeasuredHeight() - this.substractBackgroundHeight) - getPaddingTop();
            if (this.timeTextWidth < 0) {
                this.timeTextWidth = AndroidUtilities.dp(10.0f);
            }
            if (this.currentTimeString != null) {
                this.timeLayout = new StaticLayout(this.currentTimeString, Theme.chat_timePaint, this.timeTextWidth + AndroidUtilities.dp(100.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
            } else {
                this.timeLayout = null;
            }
            if (this.mediaBackground) {
                if (this.currentMessageObject.isOutOwner()) {
                    iDp4 = (this.layoutWidth - this.timeWidth) - AndroidUtilities.dp(42.0f);
                } else {
                    this.timeX = (this.backgroundWidth - AndroidUtilities.dp(4.0f)) - this.timeWidth;
                    if (this.currentMessageObject.isAnyKindOfSticker()) {
                        this.timeX = Math.max(AndroidUtilities.dp(26.0f), this.timeX);
                    }
                    if (isSideMenuLeftMargin()) {
                        i7 = this.timeX;
                        iDp3 = AndroidUtilities.dp(64.0f);
                    } else {
                        if (this.isAvatarVisible && !isWidthAdaptive()) {
                            i7 = this.timeX;
                            iDp3 = AndroidUtilities.dp(48.0f);
                        }
                        groupedMessagePosition = this.currentPosition;
                        if (groupedMessagePosition != null && (i8 = groupedMessagePosition.leftSpanOffset) != 0) {
                            this.timeX += (int) Math.ceil((i8 / 1000.0f) * getGroupPhotosWidth());
                        }
                        if (this.captionLayout != null && this.currentPosition != null) {
                            iDp4 = this.timeX + AndroidUtilities.dp(4.0f);
                        }
                        if (SharedConfig.bubbleRadius >= 10 && this.captionLayout == null && (i9 = this.documentAttachType) != 7 && i9 != 6) {
                            i6 = this.timeX;
                            iDp2 = AndroidUtilities.dp(2.0f);
                            this.timeX = i6 - iDp2;
                        }
                        int extraTimeX = this.timeX - getExtraTimeX();
                        this.timeX = extraTimeX;
                        if (this.effectId != 0) {
                            this.timeX = extraTimeX + AndroidUtilities.dp(18.0f);
                        }
                        if ((this.currentMessageObject.messageOwner.flags & 1024) == 0) {
                            String str = this.currentViewsString;
                            if (str == null) {
                                str = "";
                            }
                            this.viewsLayout = new StaticLayout(str, Theme.chat_timePaint, this.viewsTextWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                        } else {
                            this.viewsLayout = null;
                        }
                        if (this.currentRepliesString != null || this.currentMessageObject.scheduled) {
                            this.repliesLayout = null;
                        } else {
                            this.repliesLayout = new StaticLayout(this.currentRepliesString, Theme.chat_timePaint, this.repliesTextWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                        }
                        if (this.isAvatarVisible) {
                            this.avatarImage.setImageCoords(AndroidUtilities.dp(this.currentMessageObject.isRepostPreview ? 15.0f : 6.0f), this.avatarImage.getImageY(), AndroidUtilities.dp(this.currentMessageObject.isRepostPreview ? 36.0f : 42.0f), AndroidUtilities.dp(this.currentMessageObject.isRepostPreview ? 36.0f : 42.0f));
                        }
                        if (this.currentMessageObject.type == 20 || this.currentUnlockString == null) {
                            this.unlockLayout = null;
                        } else {
                            this.unlockLayout = new StaticLayout(this.currentUnlockString, Theme.chat_unlockExtendedMediaTextPaint, this.unlockTextWidth, Layout.Alignment.ALIGN_CENTER, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                            int i12 = ((TLRPC.TL_messageExtendedMediaPreview) this.currentMessageObject.messageOwner.media.extended_media.get(0)).video_duration;
                            if (i12 != 0) {
                                String duration = AndroidUtilities.formatDuration(i12, false);
                                this.durationWidth = (int) Math.ceil(Theme.chat_durationPaint.measureText(duration));
                                this.videoInfoLayout = new StaticLayout(duration, Theme.chat_durationPaint, this.durationWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                            } else {
                                this.videoInfoLayout = null;
                            }
                        }
                        this.wasLayout = true;
                        this.forcedLayout = false;
                    }
                    this.timeX = i7 + iDp3;
                    groupedMessagePosition = this.currentPosition;
                    if (groupedMessagePosition != null) {
                        this.timeX += (int) Math.ceil((i8 / 1000.0f) * getGroupPhotosWidth());
                    }
                    if (this.captionLayout != null) {
                        iDp4 = this.timeX + AndroidUtilities.dp(4.0f);
                    }
                    if (SharedConfig.bubbleRadius >= 10) {
                        i6 = this.timeX;
                        iDp2 = AndroidUtilities.dp(2.0f);
                        this.timeX = i6 - iDp2;
                    }
                    int extraTimeX2 = this.timeX - getExtraTimeX();
                    this.timeX = extraTimeX2;
                    if (this.effectId != 0) {
                    }
                    if ((this.currentMessageObject.messageOwner.flags & 1024) == 0) {
                    }
                    if (this.currentRepliesString != null) {
                        this.repliesLayout = null;
                        if (this.isAvatarVisible) {
                        }
                        if (this.currentMessageObject.type == 20) {
                            this.unlockLayout = null;
                            this.wasLayout = true;
                            this.forcedLayout = false;
                        }
                    }
                }
                this.timeX = iDp4;
                if (SharedConfig.bubbleRadius >= 10) {
                }
                int extraTimeX22 = this.timeX - getExtraTimeX();
                this.timeX = extraTimeX22;
                if (this.effectId != 0) {
                }
                if ((this.currentMessageObject.messageOwner.flags & 1024) == 0) {
                }
                if (this.currentRepliesString != null) {
                }
            } else {
                if (this.currentMessageObject.isOutOwner()) {
                    i6 = this.layoutWidth - this.timeWidth;
                    f = 38.5f;
                } else {
                    this.timeX = (this.backgroundWidth - AndroidUtilities.dp(9.0f)) - this.timeWidth;
                    if (this.currentMessageObject.isAnyKindOfSticker()) {
                        this.timeX = Math.max(0, this.timeX);
                    }
                    if (isSideMenuLeftMargin()) {
                        i5 = this.timeX;
                        iDp = AndroidUtilities.dp(64.0f);
                    } else {
                        if (this.isAvatarVisible && !isWidthAdaptive()) {
                            i5 = this.timeX;
                            iDp = AndroidUtilities.dp(48.0f);
                        }
                        if (shouldDrawTimeOnMedia()) {
                            i6 = this.timeX;
                            f = 7.0f;
                        }
                        int extraTimeX222 = this.timeX - getExtraTimeX();
                        this.timeX = extraTimeX222;
                        if (this.effectId != 0) {
                        }
                        if ((this.currentMessageObject.messageOwner.flags & 1024) == 0) {
                        }
                        if (this.currentRepliesString != null) {
                        }
                    }
                    this.timeX = i5 + iDp;
                    if (shouldDrawTimeOnMedia()) {
                    }
                    int extraTimeX2222 = this.timeX - getExtraTimeX();
                    this.timeX = extraTimeX2222;
                    if (this.effectId != 0) {
                    }
                    if ((this.currentMessageObject.messageOwner.flags & 1024) == 0) {
                    }
                    if (this.currentRepliesString != null) {
                    }
                }
                iDp2 = AndroidUtilities.dp(f);
                this.timeX = i6 - iDp2;
                int extraTimeX22222 = this.timeX - getExtraTimeX();
                this.timeX = extraTimeX22222;
                if (this.effectId != 0) {
                }
                if ((this.currentMessageObject.messageOwner.flags & 1024) == 0) {
                }
                if (this.currentRepliesString != null) {
                }
            }
        }
        this.lastSize = measuredHeight;
        if (this.currentMessageObject.type == 0) {
            this.textY = AndroidUtilities.dp(10.0f) + this.namesOffset;
            if (this.currentMessageObject.isSponsored()) {
                iTextHeight = this.textY;
                iDp22 = AndroidUtilities.dp(14.0f);
            } else if (this.linkPreviewAbove) {
                this.linkPreviewY = this.textY + AndroidUtilities.dp(10.0f);
                this.textY += this.linkPreviewHeight + AndroidUtilities.dp(13.0f);
                if (this.drawInstantView && !this.hasInvoicePreview && !this.currentMessageObject.isGiveawayOrGiveawayResults()) {
                    this.textY += AndroidUtilities.dp(44.0f);
                }
                if (this.linkPreviewAbove) {
                    iDp23 = this.linkPreviewY + this.linkPreviewHeight + AndroidUtilities.dp(this.drawInstantView ? 46.0f : BitmapDescriptorFactory.HUE_RED);
                    iDp24 = AndroidUtilities.dp(this.linkPreviewHeight > 0 ? 4.0f : -8.0f);
                } else {
                    iDp23 = this.textY + this.currentMessageObject.textHeight(this.transitionParams);
                    iDp24 = AndroidUtilities.dp(10.0f);
                }
                this.factCheckY = iDp23 + iDp24;
            } else {
                iTextHeight = this.textY + this.currentMessageObject.textHeight(this.transitionParams);
                iDp22 = AndroidUtilities.dp(10.0f);
            }
            this.linkPreviewY = iTextHeight + iDp22;
            if (this.linkPreviewAbove) {
            }
            this.factCheckY = iDp23 + iDp24;
        }
        if (this.groupMedia != null) {
            if (this.currentMessageObject.isOutOwner()) {
                iDp21 = this.mediaBackground ? (this.layoutWidth - this.backgroundWidth) - AndroidUtilities.dp(3.0f) : (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(6.0f);
            } else {
                int iDp25 = AndroidUtilities.dp(15.0f);
                if (isSideMenuLeftMargin()) {
                    iDp20 = AndroidUtilities.dp(64.0f);
                } else if ((this.isChat || this.currentMessageObject.isRepostPreview) && this.isAvatarVisible && !this.isPlayingRound) {
                    iDp20 = AndroidUtilities.dp(48.0f);
                } else {
                    iDp21 = iDp25;
                }
                iDp21 = iDp20 + iDp25;
            }
            this.groupMedia.x = iDp21 - AndroidUtilities.dp(2.0f);
        }
        if (this.isRoundVideo) {
            updatePlayingMessageProgress();
        }
        int i13 = this.documentAttachType;
        if (i13 != 3 && i13 != 7) {
            if (i13 == 5) {
                if (this.currentMessageObject.isOutOwner()) {
                    this.seekBarX = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(56.0f);
                    this.buttonX = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(14.0f);
                    i11 = this.layoutWidth - this.backgroundWidth;
                    iDp19 = AndroidUtilities.dp(67.0f);
                } else {
                    this.seekBarX = AndroidUtilities.dp(65.0f);
                    this.buttonX = AndroidUtilities.dp(23.0f);
                    this.timeAudioX = AndroidUtilities.dp(76.0f);
                    if (!isSideMenuLeftMargin()) {
                        if (needDrawAvatar()) {
                            this.seekBarX += AndroidUtilities.dp(48.0f);
                            this.buttonX += AndroidUtilities.dp(48.0f);
                            i11 = this.timeAudioX;
                            iDp19 = AndroidUtilities.dp(48.0f);
                        }
                        if (this.hasLinkPreview) {
                            this.seekBarX += AndroidUtilities.dp(10.0f);
                            this.buttonX += AndroidUtilities.dp(10.0f);
                            this.timeAudioX += AndroidUtilities.dp(10.0f);
                        }
                        updateSeekBarWaveformWidth(null);
                        this.seekBarY = AndroidUtilities.dp(29.0f) + this.namesOffset + this.mediaOffsetY + ((this.captionAbove || (textLayoutBlocks5 = this.captionLayout) == null) ? 0 : textLayoutBlocks5.textHeight(this.transitionParams));
                        int iDp26 = AndroidUtilities.dp(13.0f) + this.namesOffset + this.mediaOffsetY + ((this.captionAbove || (textLayoutBlocks4 = this.captionLayout) == null) ? 0 : textLayoutBlocks4.textHeight(this.transitionParams));
                        this.buttonY = iDp26;
                        RadialProgress2 radialProgress2 = this.radialProgress;
                        int i14 = this.buttonX;
                        radialProgress2.setProgressRect(i14, iDp26, AndroidUtilities.dp(44.0f) + i14, this.buttonY + AndroidUtilities.dp(44.0f));
                        updatePlayingMessageProgress();
                        return;
                    }
                    this.seekBarX += AndroidUtilities.dp(64.0f);
                    this.buttonX += AndroidUtilities.dp(64.0f);
                    i11 = this.timeAudioX;
                    iDp19 = AndroidUtilities.dp(64.0f);
                }
                this.timeAudioX = i11 + iDp19;
                if (this.hasLinkPreview) {
                }
                updateSeekBarWaveformWidth(null);
                this.seekBarY = AndroidUtilities.dp(29.0f) + this.namesOffset + this.mediaOffsetY + ((this.captionAbove || (textLayoutBlocks5 = this.captionLayout) == null) ? 0 : textLayoutBlocks5.textHeight(this.transitionParams));
                int iDp262 = AndroidUtilities.dp(13.0f) + this.namesOffset + this.mediaOffsetY + ((this.captionAbove || (textLayoutBlocks4 = this.captionLayout) == null) ? 0 : textLayoutBlocks4.textHeight(this.transitionParams));
                this.buttonY = iDp262;
                RadialProgress2 radialProgress22 = this.radialProgress;
                int i142 = this.buttonX;
                radialProgress22.setProgressRect(i142, iDp262, AndroidUtilities.dp(44.0f) + i142, this.buttonY + AndroidUtilities.dp(44.0f));
                updatePlayingMessageProgress();
                return;
            }
            if (i13 == 1 && !this.drawPhotoImage) {
                if (this.currentMessageObject.isOutOwner()) {
                    iDp18 = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(14.0f);
                } else {
                    if (isSideMenuLeftMargin()) {
                        f2 = 87.0f;
                    } else if (needDrawAvatar()) {
                        f2 = 71.0f;
                    } else {
                        iDp18 = AndroidUtilities.dp(23.0f);
                    }
                    iDp18 = AndroidUtilities.dp(f2);
                }
                this.buttonX = iDp18;
                if (this.hasLinkPreview) {
                    this.buttonX += AndroidUtilities.dp(10.0f);
                }
                int iDp27 = AndroidUtilities.dp(13.0f) + this.namesOffset + this.mediaOffsetY + ((!this.captionAbove || (textLayoutBlocks3 = this.captionLayout) == null) ? 0 : textLayoutBlocks3.textHeight(this.transitionParams));
                this.buttonY = iDp27;
                RadialProgress2 radialProgress23 = this.radialProgress;
                int i15 = this.buttonX;
                radialProgress23.setProgressRect(i15, iDp27, AndroidUtilities.dp(44.0f) + i15, this.buttonY + AndroidUtilities.dp(44.0f));
                this.photoImage.setImageCoords(this.buttonX - AndroidUtilities.dp(10.0f), this.buttonY - AndroidUtilities.dp(10.0f), this.photoImage.getImageWidth(), this.photoImage.getImageHeight());
                return;
            }
            MessageObject messageObject2 = this.currentMessageObject;
            int i16 = messageObject2.type;
            if (i16 == 12) {
                if (messageObject2.isOutOwner()) {
                    iDp16 = this.layoutWidth - this.backgroundWidth;
                    iDp17 = AndroidUtilities.dp(26.0f);
                } else {
                    iDp16 = AndroidUtilities.dp(35.0f);
                    if (!isSideMenuLeftMargin()) {
                        if (needDrawAvatar()) {
                            iDp17 = AndroidUtilities.dp(48.0f);
                        }
                        this.photoImage.setImageCoords(iDp16, AndroidUtilities.dp(24.0f) + this.namesOffset, AndroidUtilities.dp(46.0f), AndroidUtilities.dp(46.0f));
                        return;
                    }
                    iDp17 = AndroidUtilities.dp(64.0f);
                }
                iDp16 += iDp17;
                this.photoImage.setImageCoords(iDp16, AndroidUtilities.dp(24.0f) + this.namesOffset, AndroidUtilities.dp(46.0f), AndroidUtilities.dp(46.0f));
                return;
            }
            if (i16 == 0 && (this.hasLinkPreview || this.hasGamePreview || this.hasInvoicePreview)) {
                iDp14 = this.hasGamePreview ? this.unmovedTextX - AndroidUtilities.dp(10.0f) : this.unmovedTextX + AndroidUtilities.dp(1.0f);
                if (this.isSmallImage) {
                    iDp11 = iDp14 + this.backgroundWidth;
                    iDp13 = AndroidUtilities.dp(81.0f);
                    iDp11 -= iDp13;
                } else {
                    iDp15 = this.hasInvoicePreview ? -AndroidUtilities.dp(6.3f) : AndroidUtilities.dp(10.0f);
                    iDp11 = iDp14 + iDp15;
                }
            } else {
                if (!messageObject2.isOutOwner()) {
                    iDp11 = AndroidUtilities.dp(15.0f);
                    if (isSideMenuLeftMargin()) {
                        iDp12 = AndroidUtilities.dp(64.0f);
                    } else {
                        if ((this.isChat || this.currentMessageObject.isRepostPreview) && this.isAvatarVisible && !this.isPlayingRound) {
                            iDp12 = AndroidUtilities.dp(48.0f);
                        }
                        groupedMessagePosition3 = this.currentPosition;
                        if (groupedMessagePosition3 != null && !groupedMessagePosition3.edge) {
                            iDp13 = AndroidUtilities.dp(10.0f);
                        }
                    }
                    iDp11 += iDp12;
                    groupedMessagePosition3 = this.currentPosition;
                    if (groupedMessagePosition3 != null) {
                        iDp13 = AndroidUtilities.dp(10.0f);
                    }
                } else if (this.mediaBackground) {
                    iDp11 = this.layoutWidth - this.backgroundWidth;
                    iDp13 = AndroidUtilities.dp(3.0f);
                } else {
                    iDp14 = this.layoutWidth - this.backgroundWidth;
                    iDp15 = AndroidUtilities.dp(6.0f);
                    iDp11 = iDp14 + iDp15;
                }
                iDp11 -= iDp13;
            }
            MessageObject.GroupedMessagePosition groupedMessagePosition4 = this.currentPosition;
            if (groupedMessagePosition4 != null) {
                if ((groupedMessagePosition4.flags & 1) == 0) {
                    iDp11 -= AndroidUtilities.dp(2.0f);
                }
                if (this.currentPosition.leftSpanOffset != 0) {
                    iDp11 += (int) Math.ceil((r2 / 1000.0f) * getGroupPhotosWidth());
                }
            }
            if (this.currentMessageObject.type != 0) {
                iDp11 -= AndroidUtilities.dp(2.0f);
            }
            if (this.drawInstantViewType == 17) {
                iDp11 = (int) (iDp11 + AndroidUtilities.dp(10.0f) + ((this.instantWidth - this.photoImage.getImageWidth()) / 2.0f));
            }
            TransitionParams transitionParams = this.transitionParams;
            if (!transitionParams.imageChangeBoundsTransition || transitionParams.updatePhotoImageX) {
                transitionParams.updatePhotoImageX = false;
                ImageReceiver imageReceiver = this.photoImage;
                imageReceiver.setImageCoords(iDp11, imageReceiver.getImageY(), this.photoImage.getImageWidth(), this.photoImage.getImageHeight());
            }
            this.buttonX = (int) (iDp11 + ((this.photoImage.getImageWidth() - AndroidUtilities.dp(48.0f)) / 2.0f));
            int imageY = (int) (this.photoImage.getImageY() + ((this.photoImage.getImageHeight() - AndroidUtilities.dp(48.0f)) / 2.0f));
            this.buttonY = imageY;
            RadialProgress2 radialProgress24 = this.radialProgress;
            int i17 = this.buttonX;
            radialProgress24.setProgressRect(i17, imageY, AndroidUtilities.dp(48.0f) + i17, this.buttonY + AndroidUtilities.dp(48.0f));
            this.deleteProgressRect.set(this.buttonX + AndroidUtilities.dp(5.0f), this.buttonY + AndroidUtilities.dp(5.0f), this.buttonX + AndroidUtilities.dp(43.0f), this.buttonY + AndroidUtilities.dp(43.0f));
            int i18 = this.documentAttachType;
            if (i18 == 4 || i18 == 2) {
                this.videoButtonX = (int) (this.photoImage.getImageX() + AndroidUtilities.dp(8.0f));
                int imageY2 = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(8.0f));
                this.videoButtonY = imageY2;
                RadialProgress2 radialProgress25 = this.videoRadialProgress;
                int i19 = this.videoButtonX;
                radialProgress25.setProgressRect(i19, imageY2, AndroidUtilities.dp(24.0f) + i19, this.videoButtonY + AndroidUtilities.dp(24.0f));
                return;
            }
            return;
        }
        if (this.currentMessageObject.isOutOwner()) {
            this.seekBarX = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(57.0f);
            this.buttonX = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(14.0f);
            i10 = this.layoutWidth - this.backgroundWidth;
            iDp5 = AndroidUtilities.dp(67.0f);
        } else {
            this.seekBarX = AndroidUtilities.dp(66.0f);
            this.buttonX = AndroidUtilities.dp(23.0f);
            this.timeAudioX = AndroidUtilities.dp(76.0f);
            if (!isSideMenuLeftMargin()) {
                if (needDrawAvatar()) {
                    this.seekBarX += AndroidUtilities.dp(48.0f);
                    this.buttonX += AndroidUtilities.dp(48.0f);
                    i10 = this.timeAudioX;
                    iDp5 = AndroidUtilities.dp(48.0f);
                }
                if (this.hasLinkPreview) {
                    this.seekBarX += AndroidUtilities.dp(10.0f);
                    this.buttonX += AndroidUtilities.dp(10.0f);
                    this.timeAudioX += AndroidUtilities.dp(10.0f);
                }
                updateSeekBarWaveformWidth(null);
                this.seekBarY = AndroidUtilities.dp(13.0f) + this.namesOffset + this.mediaOffsetY + ((this.captionAbove || (textLayoutBlocks2 = this.captionLayout) == null) ? 0 : textLayoutBlocks2.textHeight(this.transitionParams));
                int iDp28 = AndroidUtilities.dp(13.0f) + this.namesOffset + this.mediaOffsetY + ((this.captionAbove || (textLayoutBlocks = this.captionLayout) == null) ? 0 : textLayoutBlocks.textHeight(this.transitionParams));
                this.buttonY = iDp28;
                RadialProgress2 radialProgress26 = this.radialProgress;
                int i20 = this.buttonX;
                radialProgress26.setProgressRect(i20, iDp28, AndroidUtilities.dp(44.0f) + i20, this.buttonY + AndroidUtilities.dp(44.0f));
                updatePlayingMessageProgress();
                if (this.documentAttachType != 7) {
                    MessageObject messageObject3 = this.currentMessageObject;
                    if (messageObject3.type == 0 && (this.hasLinkPreview || this.hasGamePreview || this.hasInvoicePreview)) {
                        iDp9 = this.hasGamePreview ? this.unmovedTextX - AndroidUtilities.dp(10.0f) : this.unmovedTextX + AndroidUtilities.dp(1.0f);
                        if (this.isSmallImage) {
                            iDp6 = iDp9 + this.backgroundWidth;
                            iDp8 = AndroidUtilities.dp(81.0f);
                            iDp6 -= iDp8;
                        } else {
                            iDp10 = this.hasInvoicePreview ? -AndroidUtilities.dp(6.3f) : AndroidUtilities.dp(10.0f);
                            iDp6 = iDp9 + iDp10;
                        }
                    } else {
                        if (!messageObject3.isOutOwner()) {
                            iDp6 = AndroidUtilities.dp(15.0f);
                            if (isSideMenuLeftMargin()) {
                                iDp7 = AndroidUtilities.dp(64.0f);
                            } else {
                                if ((this.isChat || (((messageObject = this.currentMessageObject) != null && messageObject.forceAvatar) || messageObject.getDialogId() == UserObject.VERIFY)) && this.isAvatarVisible && (!this.isPlayingRound || this.currentMessageObject.isVoiceTranscriptionOpen())) {
                                    iDp7 = AndroidUtilities.dp(48.0f);
                                }
                                groupedMessagePosition2 = this.currentPosition;
                                if (groupedMessagePosition2 != null && !groupedMessagePosition2.edge) {
                                    iDp8 = AndroidUtilities.dp(10.0f);
                                }
                            }
                            iDp6 += iDp7;
                            groupedMessagePosition2 = this.currentPosition;
                            if (groupedMessagePosition2 != null) {
                                iDp8 = AndroidUtilities.dp(10.0f);
                            }
                        } else if (this.mediaBackground) {
                            iDp6 = this.layoutWidth - this.backgroundWidth;
                            iDp8 = AndroidUtilities.dp(3.0f);
                        } else {
                            iDp9 = this.layoutWidth - this.backgroundWidth;
                            iDp10 = AndroidUtilities.dp(6.0f);
                            iDp6 = iDp9 + iDp10;
                        }
                        iDp6 -= iDp8;
                    }
                    MessageObject.GroupedMessagePosition groupedMessagePosition5 = this.currentPosition;
                    if (groupedMessagePosition5 != null) {
                        if ((groupedMessagePosition5.flags & 1) == 0) {
                            iDp6 -= AndroidUtilities.dp(2.0f);
                        }
                        if (this.currentPosition.leftSpanOffset != 0) {
                            iDp6 += (int) Math.ceil((r2 / 1000.0f) * getGroupPhotosWidth());
                        }
                    }
                    if (this.currentMessageObject.type != 0) {
                        iDp6 -= AndroidUtilities.dp(2.0f);
                    }
                    if (this.currentMessageObject.isVoiceTranscriptionOpen()) {
                        iDp6 += AndroidUtilities.dp(10.0f);
                    }
                    TransitionParams transitionParams2 = this.transitionParams;
                    if (!transitionParams2.imageChangeBoundsTransition || transitionParams2.updatePhotoImageX) {
                        transitionParams2.updatePhotoImageX = false;
                        ImageReceiver imageReceiver2 = this.photoImage;
                        imageReceiver2.setImageCoords(iDp6, this.currentMessageObject.type != 5 ? this.linkPreviewY : imageReceiver2.getImageY(), this.photoImage.getImageWidth(), this.photoImage.getImageHeight());
                        return;
                    }
                    return;
                }
                return;
            }
            this.seekBarX += AndroidUtilities.dp(64.0f);
            this.buttonX += AndroidUtilities.dp(64.0f);
            i10 = this.timeAudioX;
            iDp5 = AndroidUtilities.dp(64.0f);
        }
        this.timeAudioX = i10 + iDp5;
        if (this.hasLinkPreview) {
        }
        updateSeekBarWaveformWidth(null);
        this.seekBarY = AndroidUtilities.dp(13.0f) + this.namesOffset + this.mediaOffsetY + ((this.captionAbove || (textLayoutBlocks2 = this.captionLayout) == null) ? 0 : textLayoutBlocks2.textHeight(this.transitionParams));
        int iDp282 = AndroidUtilities.dp(13.0f) + this.namesOffset + this.mediaOffsetY + ((this.captionAbove || (textLayoutBlocks = this.captionLayout) == null) ? 0 : textLayoutBlocks.textHeight(this.transitionParams));
        this.buttonY = iDp282;
        RadialProgress2 radialProgress262 = this.radialProgress;
        int i202 = this.buttonX;
        radialProgress262.setProgressRect(i202, iDp282, AndroidUtilities.dp(44.0f) + i202, this.buttonY + AndroidUtilities.dp(44.0f));
        updatePlayingMessageProgress();
        if (this.documentAttachType != 7) {
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:206:0x037f  */
    @Override // org.telegram.ui.Cells.BaseCell
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    protected boolean onLongPress() {
        int i;
        boolean zDidLongPressChannelAvatar;
        int i2;
        TLRPC.Message message;
        TLRPC.MessageReplyHeader messageReplyHeader;
        PollButton pollButton;
        ChatMessageCellDelegate chatMessageCellDelegate;
        if (this.isRoundVideo && this.isPlayingRound && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && ((this.lastTouchX - this.photoImage.getCenterX()) * (this.lastTouchX - this.photoImage.getCenterX())) + ((this.lastTouchY - this.photoImage.getCenterY()) * (this.lastTouchY - this.photoImage.getCenterY())) < (this.photoImage.getImageWidth() / 2.0f) * (this.photoImage.getImageWidth() / 2.0f) && (this.lastTouchX > this.photoImage.getCenterX() + (this.photoImage.getImageWidth() / 4.0f) || this.lastTouchX < this.photoImage.getCenterX() - (this.photoImage.getImageWidth() / 4.0f))) {
            boolean z = this.lastTouchX > this.photoImage.getCenterX();
            if (this.videoPlayerRewinder == null) {
                this.videoForwardDrawable = new VideoForwardDrawable(true);
                this.videoPlayerRewinder = new OldVideoPlayerRewinder() { // from class: org.telegram.ui.Cells.ChatMessageCell.5
                    @Override // org.telegram.messenger.video.OldVideoPlayerRewinder
                    protected void onRewindCanceled() throws Resources.NotFoundException, NumberFormatException {
                        ChatMessageCell.this.onTouchEvent(MotionEvent.obtain(0L, 0L, 3, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 0));
                        ChatMessageCell.this.videoForwardDrawable.setShowing(false);
                    }

                    @Override // org.telegram.messenger.video.OldVideoPlayerRewinder
                    protected void onRewindStart(boolean z2) {
                        ChatMessageCell.this.videoForwardDrawable.setDelegate(new VideoForwardDrawable.VideoForwardDrawableDelegate() { // from class: org.telegram.ui.Cells.ChatMessageCell.5.1
                            @Override // org.telegram.ui.Components.VideoForwardDrawable.VideoForwardDrawableDelegate
                            public void invalidate() {
                                ChatMessageCell.this.invalidate();
                            }

                            @Override // org.telegram.ui.Components.VideoForwardDrawable.VideoForwardDrawableDelegate
                            public void onAnimationEnd() {
                            }
                        });
                        ChatMessageCell.this.videoForwardDrawable.setOneShootAnimation(false);
                        ChatMessageCell.this.videoForwardDrawable.setLeftSide(!z2);
                        ChatMessageCell.this.videoForwardDrawable.setShowing(true);
                        ChatMessageCell.this.invalidate();
                    }

                    @Override // org.telegram.messenger.video.OldVideoPlayerRewinder
                    protected void updateRewindProgressUi(long j, float f, boolean z2) {
                        ChatMessageCell.this.videoForwardDrawable.setTime(Math.abs(j));
                        if (z2) {
                            ChatMessageCell.this.currentMessageObject.audioProgress = f;
                            ChatMessageCell.this.updatePlayingMessageProgress();
                        }
                    }
                };
                getParent().requestDisallowInterceptTouchEvent(true);
            }
            this.videoPlayerRewinder.startRewind(MediaController.getInstance().getVideoPlayer(), z, MediaController.getInstance().getPlaybackSpeed(false));
            return false;
        }
        Drawable drawable = this.replySelector;
        if (drawable != null) {
            this.replySelectorPressed = false;
            drawable.setState(StateSet.NOTHING);
            invalidate();
        }
        Drawable drawable2 = this.nameStatusSelector;
        if (drawable2 != null) {
            drawable2.setState(StateSet.NOTHING);
        }
        Drawable drawable3 = this.nameLayoutSelector;
        if (drawable3 != null) {
            drawable3.setState(StateSet.NOTHING);
        }
        Drawable drawable4 = this.boostCounterLayoutSelector;
        if (drawable4 != null) {
            drawable4.setState(StateSet.NOTHING);
        }
        resetCodeSelectors();
        ButtonBounce buttonBounce = this.replyBounce;
        if (buttonBounce != null) {
            buttonBounce.setPressed(false);
        }
        ButtonBounce buttonBounce2 = this.titleLabelBounce;
        if (buttonBounce2 != null) {
            buttonBounce2.setPressed(false);
        }
        ButtonBounce buttonBounce3 = this.factCheckWhatBounce;
        if (buttonBounce3 != null) {
            buttonBounce3.setPressed(false);
        }
        this.forwardNamePressed = false;
        ForwardBackground forwardBackground = this.forwardBg;
        if (forwardBackground != null) {
            forwardBackground.setPressed(false);
        }
        this.pressedEffect = false;
        ButtonBounce buttonBounce4 = this.effectDrawableBounce;
        if (buttonBounce4 != null) {
            buttonBounce4.setPressed(false);
        }
        if (this.pressedEmoji != null) {
            this.pressedEmoji = null;
        }
        int i3 = this.pressedVoteButton;
        if (i3 != -1 && (pollButton = (PollButton) this.pollButtons.get(i3)) != null && pollButton.task != null && (chatMessageCellDelegate = this.delegate) != null && chatMessageCellDelegate.didLongPressToDoButton(this, pollButton.task)) {
            return true;
        }
        LinkSpanDrawable linkSpanDrawable = this.pressedFactCheckLink;
        if (linkSpanDrawable != null) {
            if (linkSpanDrawable.getSpan() instanceof URLSpanMono) {
                this.hadLongPress = true;
                this.delegate.didPressUrl(this, this.pressedFactCheckLink.getSpan(), true);
                return true;
            }
            if (this.pressedFactCheckLink.getSpan() instanceof URLSpanNoUnderline) {
                URLSpanNoUnderline uRLSpanNoUnderline = (URLSpanNoUnderline) this.pressedFactCheckLink.getSpan();
                if (ChatActivity.isClickableLink(uRLSpanNoUnderline.getURL()) || uRLSpanNoUnderline.getURL().startsWith("/")) {
                    this.hadLongPress = true;
                    this.delegate.didPressUrl(this, this.pressedFactCheckLink.getSpan(), true);
                    return true;
                }
            } else if (this.pressedFactCheckLink.getSpan() instanceof URLSpan) {
                this.hadLongPress = true;
                this.delegate.didPressUrl(this, this.pressedFactCheckLink.getSpan(), true);
                return true;
            }
        }
        LinkSpanDrawable linkSpanDrawable2 = this.pressedLink;
        if (linkSpanDrawable2 != null) {
            if (linkSpanDrawable2.getSpan() instanceof URLSpanMono) {
                this.hadLongPress = true;
                this.delegate.didPressUrl(this, this.pressedLink.getSpan(), true);
                return true;
            }
            if (this.pressedLink.getSpan() instanceof URLSpanNoUnderline) {
                URLSpanNoUnderline uRLSpanNoUnderline2 = (URLSpanNoUnderline) this.pressedLink.getSpan();
                if (ChatActivity.isClickableLink(uRLSpanNoUnderline2.getURL()) || uRLSpanNoUnderline2.getURL().startsWith("/") || uRLSpanNoUnderline2.getURL().startsWith("tel:")) {
                    this.hadLongPress = true;
                    this.delegate.didPressUrl(this, this.pressedLink.getSpan(), true);
                    return true;
                }
            } else if (this.pressedLink.getSpan() instanceof URLSpan) {
                this.hadLongPress = true;
                this.delegate.didPressUrl(this, this.pressedLink.getSpan(), true);
                return true;
            }
        }
        resetPressedLink(-1);
        if (this.buttonPressed != 0 || this.miniButtonPressed != 0 || this.videoButtonPressed != 0 || this.pressedBotButton != -1) {
            this.buttonPressed = 0;
            this.miniButtonPressed = 0;
            this.videoButtonPressed = 0;
            this.pressedBotButton = -1;
            invalidate();
        }
        if (this.replyPressed && !this.replyPanelIsForward) {
            this.hadLongPress = true;
            this.replyPressed = false;
            Drawable drawable5 = this.replySelector;
            if (drawable5 != null) {
                if (this.replySelectorPressed) {
                    drawable5.setState(new int[0]);
                } else {
                    drawable5.setState(new int[]{android.R.attr.state_pressed, android.R.attr.state_enabled});
                    post(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda13
                        @Override // java.lang.Runnable
                        public final void run() {
                            this.f$0.lambda$onLongPress$11();
                        }
                    });
                }
                this.replySelectorPressed = false;
                this.replySelectorCanBePressed = false;
                invalidate();
            }
            ButtonBounce buttonBounce5 = this.replyBounce;
            if (buttonBounce5 != null) {
                buttonBounce5.setPressed(false);
            }
            playSoundEffect(0);
            if (this.delegate != null && (this.currentMessageObject.hasValidReplyMessageObject() || this.currentMessageObject.isReplyToStory() || this.hasReplyQuote || ((message = this.currentMessageObject.messageOwner) != null && (messageReplyHeader = message.reply_to) != null && messageReplyHeader.reply_from != null))) {
                this.delegate.didPressReplyMessage(this, this.currentMessageObject.getReplyMsgId(), this.replyBounceX, this.replyBounceY, true);
            }
            return true;
        }
        this.linkPreviewPressed = false;
        this.imagePressed = false;
        this.timePressed = false;
        this.gamePreviewPressed = false;
        this.giveawayMessageCell.setButtonPressed(false);
        this.giveawayResultsMessageCell.setButtonPressed(false);
        resetContactButtonsPressedState();
        if (this.pressedVoteButton != -1 || this.pollHintPressed || this.psaHintPressed || this.instantPressed || this.otherPressed || this.commentButtonPressed) {
            this.commentButtonPressed = false;
            this.instantPressed = false;
            setInstantButtonPressed(false);
            this.pressedVoteButton = -1;
            this.pollHintPressed = false;
            this.psaHintPressed = false;
            this.otherPressed = false;
            if (Build.VERSION.SDK_INT >= 21) {
                int i4 = 0;
                while (true) {
                    Drawable[] drawableArr = this.selectorDrawable;
                    if (i4 >= drawableArr.length) {
                        break;
                    }
                    Drawable drawable6 = drawableArr[i4];
                    if (drawable6 != null) {
                        drawable6.setState(StateSet.NOTHING);
                    }
                    i4++;
                }
                Drawable drawable7 = this.linkPreviewSelector;
                if (drawable7 != null) {
                    drawable7.setState(StateSet.NOTHING);
                }
            }
            ButtonBounce buttonBounce6 = this.linkPreviewBounce;
            if (buttonBounce6 != null) {
                buttonBounce6.setPressed(false);
            }
            Runnable runnable = this.todoLongPressRunnable;
            if (runnable != null) {
                AndroidUtilities.cancelRunOnUIThread(runnable);
                this.todoLongPressRunnable = null;
            }
            invalidate();
        }
        ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
        if (chatMessageCellDelegate2 != null) {
            if (this.avatarPressed) {
                TLRPC.User user = this.currentUser;
                if (user != null) {
                    if (user.id != 0) {
                        zDidLongPressChannelAvatar = chatMessageCellDelegate2.didLongPressUserAvatar(this, user, this.lastTouchX, this.lastTouchY);
                    }
                    if (!zDidLongPressChannelAvatar) {
                        this.delegate.didLongPress(this, this.lastTouchX, this.lastTouchY);
                    }
                } else {
                    TLRPC.Chat chat = this.currentChat;
                    if (chat != null) {
                        TLRPC.MessageFwdHeader messageFwdHeader = this.currentMessageObject.messageOwner.fwd_from;
                        if (messageFwdHeader != null) {
                            i2 = (messageFwdHeader.flags & 16) != 0 ? messageFwdHeader.saved_from_msg_id : messageFwdHeader.channel_post;
                        } else {
                            i2 = 0;
                        }
                        zDidLongPressChannelAvatar = chatMessageCellDelegate2.didLongPressChannelAvatar(this, chat, i2, this.lastTouchX, this.lastTouchY);
                    }
                    if (!zDidLongPressChannelAvatar) {
                    }
                }
            } else if (this.sideButtonPressed && (i = this.pressedSideButton) != 4 && i != 5 && i != 3 && i != 2) {
                chatMessageCellDelegate2.didQuickShareStart(this, this.lastTouchX, this.lastTouchY);
                this.sideButtonPressed = false;
                this.pressedSideButton = 0;
                this.inQuickShareMode = true;
                return false;
            }
            zDidLongPressChannelAvatar = false;
            if (!zDidLongPressChannelAvatar) {
            }
        }
        this.sideButtonPressed = false;
        this.pressedSideButton = 0;
        return true;
    }

    @Override // android.view.View
    protected void onMeasure(int i, int i2) throws Resources.NotFoundException, NumberFormatException {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && (messageObject.checkLayout() || this.lastHeight != AndroidUtilities.displaySize.y)) {
            this.inLayout = true;
            MessageObject messageObject2 = this.currentMessageObject;
            this.currentMessageObject = null;
            setMessageObject(messageObject2, this.currentMessagesGroup, this.pinnedBottom, this.pinnedTop, this.firstInChat);
            this.inLayout = false;
        }
        updateSelectionTextPosition();
        setMeasuredDimension(isWidthAdaptive() ? getBoundsRight() - getBoundsLeft() : View.MeasureSpec.getSize(i), this.starsPriceTopPadding + this.topicSeparatorTopPadding + this.suggestionOfferTopPadding + this.totalHeight + this.keyboardHeight);
    }

    @Override // org.telegram.messenger.DownloadController.FileDownloadProgressListener
    public void onProgressDownload(String str, long j, long j2) {
        float fMin = j2 == 0 ? BitmapDescriptorFactory.HUE_RED : Math.min(1.0f, j / j2);
        this.currentMessageObject.loadedFileSize = j;
        createLoadingProgressLayout(j, j2);
        (this.drawVideoImageButton ? this.videoRadialProgress : this.radialProgress).setProgress(fMin, true);
        int i = this.documentAttachType;
        if (i == 3 || i == 5) {
            if (this.hasMiniProgress != 0) {
                if (this.miniButtonState == 1) {
                    return;
                }
            } else if (this.buttonState == 4) {
                return;
            }
        } else if (this.hasMiniProgress != 0) {
            if (this.miniButtonState == 1) {
                return;
            }
        } else if (this.buttonState == 1) {
            return;
        }
        updateButtonState(false, false, false);
    }

    @Override // org.telegram.messenger.DownloadController.FileDownloadProgressListener
    public void onProgressUpload(String str, long j, long j2, boolean z) {
        int i;
        float fMin = j2 == 0 ? BitmapDescriptorFactory.HUE_RED : Math.min(1.0f, j / j2);
        this.currentMessageObject.loadedFileSize = j;
        this.radialProgress.setProgress(fMin, true);
        if (j == j2 && ((this.currentPosition != null || this.currentMessageObject.isPaid()) && SendMessagesHelper.getInstance(this.currentAccount).isSendingMessage(this.currentMessageObject.getId()) && ((i = this.buttonState) == 1 || (i == 4 && this.documentAttachType == 5)))) {
            this.drawRadialCheckBackground = true;
            getIconForCurrentState();
            this.radialProgress.setIcon(6, false, true);
        }
        long j3 = this.lastLoadingSizeTotal;
        if (j3 > 0 && Math.abs(j3 - j2) > 1048576) {
            this.lastLoadingSizeTotal = j2;
        }
        createLoadingProgressLayout(j, j2);
    }

    @Override // android.view.View
    public void onProvideStructure(ViewStructure viewStructure) {
        CharSequence charSequence;
        CharSequence charSequence2;
        CharSequence charSequence3;
        super.onProvideStructure(viewStructure);
        if (!this.allowAssistant || Build.VERSION.SDK_INT < 23) {
            return;
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || (charSequence3 = messageObject.messageText) == null || charSequence3.length() <= 0) {
            MessageObject messageObject2 = this.currentMessageObject;
            if (messageObject2 == null || (charSequence = messageObject2.caption) == null || charSequence.length() <= 0) {
                return;
            } else {
                charSequence2 = this.currentMessageObject.caption;
            }
        } else {
            charSequence2 = this.currentMessageObject.messageText;
        }
        viewStructure.setText(charSequence2);
    }

    @Override // org.telegram.ui.Components.SeekBar.SeekBarDelegate
    public void onSeekBarContinuousDrag(float f) {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            return;
        }
        messageObject.audioProgress = f;
        double duration = messageObject.getDuration();
        double d = f;
        Double.isNaN(d);
        messageObject.audioProgressSec = (int) (duration * d);
        updatePlayingMessageProgress();
    }

    @Override // org.telegram.ui.Components.SeekBar.SeekBarDelegate
    public void onSeekBarDrag(float f) {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            return;
        }
        messageObject.audioProgress = f;
        MediaController.getInstance().seekToProgress(this.currentMessageObject, f);
        updatePlayingMessageProgress();
    }

    @Override // org.telegram.ui.Components.SeekBar.SeekBarDelegate
    public void onSeekBarPressed() {
        requestDisallowInterceptTouchEvent(true);
    }

    @Override // org.telegram.ui.Components.SeekBar.SeekBarDelegate
    public void onSeekBarReleased() {
        requestDisallowInterceptTouchEvent(false);
    }

    /* JADX WARN: Removed duplicated region for block: B:69:0x0126 A[PHI: r0 r7
      0x0126: PHI (r0v58 org.telegram.messenger.ImageLocation) = 
      (r0v50 org.telegram.messenger.ImageLocation)
      (r0v50 org.telegram.messenger.ImageLocation)
      (r0v61 org.telegram.messenger.ImageLocation)
      (r0v61 org.telegram.messenger.ImageLocation)
     binds: [B:65:0x011b, B:67:0x0123, B:59:0x00fc, B:61:0x0104] A[DONT_GENERATE, DONT_INLINE]
      0x0126: PHI (r7v16 org.telegram.messenger.ImageLocation) = 
      (r7v12 org.telegram.messenger.ImageLocation)
      (r7v12 org.telegram.messenger.ImageLocation)
      (r7v18 org.telegram.messenger.ImageLocation)
      (r7v18 org.telegram.messenger.ImageLocation)
     binds: [B:65:0x011b, B:67:0x0123, B:59:0x00fc, B:61:0x0104] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:71:0x012d A[PHI: r0 r7
      0x012d: PHI (r0v51 org.telegram.messenger.ImageLocation) = 
      (r0v50 org.telegram.messenger.ImageLocation)
      (r0v50 org.telegram.messenger.ImageLocation)
      (r0v61 org.telegram.messenger.ImageLocation)
      (r0v61 org.telegram.messenger.ImageLocation)
     binds: [B:64:0x0119, B:67:0x0123, B:58:0x00fa, B:61:0x0104] A[DONT_GENERATE, DONT_INLINE]
      0x012d: PHI (r7v13 org.telegram.messenger.ImageLocation) = 
      (r7v12 org.telegram.messenger.ImageLocation)
      (r7v12 org.telegram.messenger.ImageLocation)
      (r7v18 org.telegram.messenger.ImageLocation)
      (r7v18 org.telegram.messenger.ImageLocation)
     binds: [B:64:0x0119, B:67:0x0123, B:58:0x00fa, B:61:0x0104] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:76:0x0162  */
    /* JADX WARN: Removed duplicated region for block: B:92:0x01b0 A[PHI: r0 r7
      0x01b0: PHI (r0v38 org.telegram.messenger.ImageLocation) = 
      (r0v26 org.telegram.messenger.ImageLocation)
      (r0v26 org.telegram.messenger.ImageLocation)
      (r0v41 org.telegram.messenger.ImageLocation)
      (r0v41 org.telegram.messenger.ImageLocation)
     binds: [B:88:0x01a5, B:90:0x01ad, B:82:0x0186, B:84:0x018e] A[DONT_GENERATE, DONT_INLINE]
      0x01b0: PHI (r7v7 org.telegram.messenger.ImageLocation) = 
      (r7v3 org.telegram.messenger.ImageLocation)
      (r7v3 org.telegram.messenger.ImageLocation)
      (r7v9 org.telegram.messenger.ImageLocation)
      (r7v9 org.telegram.messenger.ImageLocation)
     binds: [B:88:0x01a5, B:90:0x01ad, B:82:0x0186, B:84:0x018e] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:94:0x01b7 A[PHI: r0 r7
      0x01b7: PHI (r0v27 org.telegram.messenger.ImageLocation) = 
      (r0v26 org.telegram.messenger.ImageLocation)
      (r0v26 org.telegram.messenger.ImageLocation)
      (r0v41 org.telegram.messenger.ImageLocation)
      (r0v41 org.telegram.messenger.ImageLocation)
     binds: [B:87:0x01a3, B:90:0x01ad, B:81:0x0184, B:84:0x018e] A[DONT_GENERATE, DONT_INLINE]
      0x01b7: PHI (r7v4 org.telegram.messenger.ImageLocation) = 
      (r7v3 org.telegram.messenger.ImageLocation)
      (r7v3 org.telegram.messenger.ImageLocation)
      (r7v9 org.telegram.messenger.ImageLocation)
      (r7v9 org.telegram.messenger.ImageLocation)
     binds: [B:87:0x01a3, B:90:0x01ad, B:81:0x0184, B:84:0x018e] A[DONT_GENERATE, DONT_INLINE]] */
    @Override // org.telegram.messenger.DownloadController.FileDownloadProgressListener
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void onSuccessDownload(String str) throws Resources.NotFoundException, NumberFormatException {
        MessageObject messageObject;
        MessageObject.GroupedMessages groupedMessages;
        boolean z;
        boolean z2;
        boolean z3;
        ChatMessageCell chatMessageCell;
        TLRPC.Document document;
        ImageLocation forDocument;
        ImageLocation forObject;
        String str2;
        ImageLocation forDocument2;
        ImageLocation forObject2;
        String str3;
        if (this.documentAttachType == 6 && this.currentMessageObject.isDice()) {
            DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
            setCurrentDiceValue(true);
            return;
        }
        int i = this.documentAttachType;
        if (i == 3 || i == 5) {
            updateButtonState(false, true, false);
            updateWaveform();
            return;
        }
        this.currentMessageObject.updateQualitiesCached(true);
        (this.drawVideoImageButton ? this.videoRadialProgress : this.radialProgress).setProgress(1.0f, true);
        if (!this.currentMessageObject.needDrawBluredPreview() && !this.autoPlayingMedia && (document = this.documentAttach) != null) {
            if (this.documentAttachType == 7) {
                ImageReceiver imageReceiver = this.photoImage;
                ImageLocation forDocument3 = ImageLocation.getForDocument(document);
                ImageLocation forObject3 = ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject);
                TLRPC.PhotoSize photoSize = this.currentPhotoObject;
                imageReceiver.setImage(forDocument3, ImageLoader.AUTOPLAY_FILTER, forObject3, ((photoSize instanceof TLRPC.TL_photoStrippedSize) || (photoSize != null && "s".equals(photoSize.type))) ? this.currentPhotoFilterThumb : this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, this.documentAttach.size, null, this.currentMessageObject, 0);
            } else if (!this.isSmallImage && !this.currentMessageObject.isHiddenSensitive() && !this.currentMessageObject.hasVideoCover() && SharedConfig.isAutoplayVideo()) {
                MessageObject messageObject2 = this.currentMessageObject;
                if (!messageObject2.isRepostPreview && this.documentAttachType == 4) {
                    MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
                    if (groupedMessagePosition != null) {
                        int i2 = groupedMessagePosition.flags;
                        if ((i2 & 1) == 0 || (i2 & 2) == 0) {
                        }
                    }
                    this.animatingNoSound = 2;
                    VideoPlayer.VideoUri videoUri = messageObject2.cachedQuality;
                    ImageReceiver imageReceiver2 = this.photoImage;
                    if (videoUri != null) {
                        forDocument2 = ImageLocation.getForVideoPath(videoUri.uri.getPath());
                        forObject2 = ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject);
                        TLRPC.PhotoSize photoSize2 = this.currentPhotoObject;
                        str3 = ((photoSize2 instanceof TLRPC.TL_photoStrippedSize) || (photoSize2 != null && "s".equals(photoSize2.type))) ? this.currentPhotoFilterThumb : this.currentPhotoFilter;
                    } else {
                        forDocument2 = ImageLocation.getForDocument(this.documentAttach);
                        forObject2 = ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject);
                        TLRPC.PhotoSize photoSize3 = this.currentPhotoObject;
                        if ((photoSize3 instanceof TLRPC.TL_photoStrippedSize) || (photoSize3 != null && "s".equals(photoSize3.type))) {
                        }
                    }
                    imageReceiver2.setImage(forDocument2, ImageLoader.AUTOPLAY_FILTER, forObject2, str3, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, this.documentAttach.size, null, this.currentMessageObject, 0);
                    if (PhotoViewer.isPlayingMessage(this.currentMessageObject)) {
                        this.photoImage.setAllowStartAnimation(false);
                    }
                    this.autoPlayingMedia = true;
                }
            } else if (this.documentAttachType == 2) {
                VideoPlayer.VideoUri videoUri2 = this.currentMessageObject.cachedQuality;
                ImageReceiver imageReceiver3 = this.photoImage;
                if (videoUri2 != null) {
                    forDocument = ImageLocation.getForVideoPath(videoUri2.uri.getPath());
                    forObject = ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject);
                    TLRPC.PhotoSize photoSize4 = this.currentPhotoObject;
                    str2 = ((photoSize4 instanceof TLRPC.TL_photoStrippedSize) || (photoSize4 != null && "s".equals(photoSize4.type))) ? this.currentPhotoFilterThumb : this.currentPhotoFilter;
                } else {
                    forDocument = ImageLocation.getForDocument(this.documentAttach);
                    forObject = ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject);
                    TLRPC.PhotoSize photoSize5 = this.currentPhotoObject;
                    if ((photoSize5 instanceof TLRPC.TL_photoStrippedSize) || (photoSize5 != null && "s".equals(photoSize5.type))) {
                    }
                }
                imageReceiver3.setImage(forDocument, ImageLoader.AUTOPLAY_FILTER, forObject, str2, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, this.documentAttach.size, null, this.currentMessageObject, 0);
                if (this.currentMessageObject.isHiddenSensitive() || !SharedConfig.isAutoplayGifs() || this.currentMessageObject.isRepostPreview) {
                    this.photoImage.setAllowStartAnimation(false);
                    this.photoImage.stopAnimation();
                }
                this.autoPlayingMedia = true;
            }
            this.photoImage.setAllowStartAnimation(true);
            this.photoImage.startAnimation();
            this.autoPlayingMedia = true;
        }
        MessageObject messageObject3 = this.currentMessageObject;
        if (messageObject3.type != 0) {
            if (!this.photoNotSet) {
                updateButtonState(false, true, false);
            }
            if (!this.photoNotSet) {
                return;
            }
            messageObject = this.currentMessageObject;
            groupedMessages = this.currentMessagesGroup;
            z = this.pinnedBottom;
            z2 = this.pinnedTop;
            z3 = this.firstInChat;
            chatMessageCell = this;
        } else if (!this.autoPlayingMedia && this.documentAttachType == 2 && messageObject3.gifState != 1.0f) {
            this.buttonState = 2;
            didPressButton(true, false);
            return;
        } else {
            if (!this.photoNotSet) {
                updateButtonState(false, true, false);
                return;
            }
            groupedMessages = this.currentMessagesGroup;
            z = this.pinnedBottom;
            z2 = this.pinnedTop;
            chatMessageCell = this;
            messageObject = messageObject3;
            z3 = this.firstInChat;
        }
        chatMessageCell.setMessageObject(messageObject, groupedMessages, z, z2, z3);
    }

    /* JADX WARN: Removed duplicated region for block: B:183:0x02a2  */
    /* JADX WARN: Removed duplicated region for block: B:204:0x02e7  */
    /* JADX WARN: Removed duplicated region for block: B:218:0x031b  */
    @Override // android.view.View
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public boolean onTouchEvent(MotionEvent motionEvent) throws Resources.NotFoundException, NumberFormatException {
        ChatMessageCellDelegate chatMessageCellDelegate;
        boolean z;
        ForwardBackground forwardBackground;
        ChatMessageCellDelegate chatMessageCellDelegate2;
        TLRPC.Chat chat;
        TLRPC.User user;
        float f;
        float f2;
        boolean z2;
        int i;
        float f3;
        float f4;
        boolean z3;
        ChatMessageCell chatMessageCell;
        Drawable drawable;
        TLRPC.Chat chat2;
        int i2;
        int i3;
        int i4;
        Drawable drawable2;
        GroupMedia groupMedia;
        TopicSeparator topicSeparator;
        ChannelRecommendationsCell channelRecommendationsCell;
        MessageObject messageObject;
        boolean z4 = true;
        if (this.currentMessageObject == null || (!((chatMessageCellDelegate = this.delegate) == null || chatMessageCellDelegate.canPerformActions()) || this.animationRunning)) {
            MessageObject messageObject2 = this.currentMessageObject;
            if (messageObject2 != null && messageObject2.preview) {
                return checkTextSelection(motionEvent);
            }
            boolean zCheckReplyTouchEvent = checkReplyTouchEvent(motionEvent);
            if (!zCheckReplyTouchEvent) {
                checkTextSelection(motionEvent);
            }
            return zCheckReplyTouchEvent || super.onTouchEvent(motionEvent);
        }
        if (checkTextSelection(motionEvent) || checkRoundSeekbar(motionEvent) || checkReactionsTouchEvent(motionEvent)) {
            return true;
        }
        OldVideoPlayerRewinder oldVideoPlayerRewinder = this.videoPlayerRewinder;
        if (oldVideoPlayerRewinder != null && oldVideoPlayerRewinder.rewindCount > 0) {
            if (motionEvent.getAction() != 1 && motionEvent.getAction() != 3) {
                return true;
            }
            getParent().requestDisallowInterceptTouchEvent(false);
            this.videoPlayerRewinder.cancelRewind();
            return false;
        }
        this.disallowLongPress = false;
        this.lastTouchX = getEventX(motionEvent);
        float eventY = getEventY(motionEvent);
        this.lastTouchY = eventY;
        this.backgroundDrawable.setTouchCoords(this.lastTouchX, eventY);
        boolean zCheckSpoilersMotionEvent = checkSpoilersMotionEvent(motionEvent, 0);
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkTextBlockMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent && (channelRecommendationsCell = this.channelRecommendationsCell) != null && (messageObject = this.currentMessageObject) != null && messageObject.type == 27 && (zCheckSpoilersMotionEvent = channelRecommendationsCell.checkTouchEvent(motionEvent))) {
            this.disallowLongPress = true;
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkQuickShareMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkAdminMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkNameMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkNameStatusMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkPinchToZoom(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkDateMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkTextSelection(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent && (topicSeparator = this.topicSeparator) != null) {
            zCheckSpoilersMotionEvent = topicSeparator.onTouchEvent(motionEvent, true);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkOtherButtonMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkSponsoredCloseMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkCaptionMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkTranscribeButtonMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkAudioMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkTitleLabelMotion(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkContactMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkLinkPreviewMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkInstantButtonMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkCommentButtonMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkGameMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkEffectMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkPhotoImageMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkBotButtonMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkPollButtonMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = this.giveawayMessageCell.checkMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = this.giveawayResultsMessageCell.checkMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkFactCheckMotionEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent && (groupMedia = this.groupMedia) != null) {
            zCheckSpoilersMotionEvent = groupMedia.onTouchEvent(motionEvent);
        }
        if (!zCheckSpoilersMotionEvent) {
            zCheckSpoilersMotionEvent = checkReplyTouchEvent(motionEvent);
        }
        if (motionEvent.getAction() == 3) {
            this.spoilerPressed = null;
            this.buttonPressed = 0;
            this.miniButtonPressed = 0;
            this.pressedBotButton = -1;
            this.pressedVoteButton = -1;
            this.pollHintPressed = false;
            this.psaHintPressed = false;
            this.linkPreviewPressed = false;
            this.otherPressed = false;
            this.sideButtonPressed = false;
            this.pressedSideButton = 0;
            this.imagePressed = false;
            this.timePressed = false;
            this.gamePreviewPressed = false;
            this.commentButtonPressed = false;
            this.instantPressed = false;
            setInstantButtonPressed(false);
            resetContactButtonsPressedState();
            Runnable runnable = this.todoLongPressRunnable;
            if (runnable != null) {
                AndroidUtilities.cancelRunOnUIThread(runnable);
                this.todoLongPressRunnable = null;
            }
            ButtonBounce buttonBounce = this.titleLabelBounce;
            if (buttonBounce != null) {
                buttonBounce.setPressed(false);
            }
            if (Build.VERSION.SDK_INT >= 21) {
                int i5 = 0;
                while (true) {
                    Drawable[] drawableArr = this.selectorDrawable;
                    if (i5 >= drawableArr.length) {
                        break;
                    }
                    Drawable drawable3 = drawableArr[i5];
                    if (drawable3 != null) {
                        drawable3.setState(StateSet.NOTHING);
                    }
                    i5++;
                }
                Drawable drawable4 = this.linkPreviewSelector;
                if (drawable4 != null) {
                    drawable4.setState(StateSet.NOTHING);
                }
            }
            Drawable drawable5 = this.nameStatusSelector;
            if (drawable5 != null) {
                drawable5.setState(StateSet.NOTHING);
            }
            Drawable drawable6 = this.nameLayoutSelector;
            if (drawable6 != null) {
                drawable6.setState(StateSet.NOTHING);
            }
            resetCodeSelectors();
            ButtonBounce buttonBounce2 = this.linkPreviewBounce;
            if (buttonBounce2 != null) {
                buttonBounce2.setPressed(false);
            }
            if (this.hadLongPress) {
                if (this.pressedLinkType != 2) {
                    this.hadLongPress = false;
                }
                this.pressedLink = null;
                this.pressedFactCheckLink = null;
                this.pressedEmoji = null;
                this.pressedLinkType = -1;
            } else {
                resetPressedLink(-1);
            }
            z = false;
        } else {
            z = zCheckSpoilersMotionEvent;
        }
        updateRadialProgressBackground();
        if (!this.disallowLongPress && z && motionEvent.getAction() == 0) {
            startCheckLongPress();
        }
        if (motionEvent.getAction() != 0 && motionEvent.getAction() != 2) {
            cancelCheckLongPress();
        }
        if (z) {
            return z;
        }
        float eventX = getEventX(motionEvent);
        float eventY2 = getEventY(motionEvent);
        if (motionEvent.getAction() == 0) {
            ChatMessageCellDelegate chatMessageCellDelegate3 = this.delegate;
            if (chatMessageCellDelegate3 != null && !chatMessageCellDelegate3.canPerformActions()) {
                return z;
            }
            if (this.isAvatarVisible && this.avatarImage.isInsideImage(eventX, getTop() + eventY2)) {
                this.avatarPressed = true;
            } else if (this.psaButtonVisible && this.hasPsaHint) {
                if (eventX >= this.psaHelpX && eventX <= r0 + AndroidUtilities.dp(40.0f)) {
                    if (eventY2 >= this.psaHelpY && eventY2 <= r0 + AndroidUtilities.dp(40.0f)) {
                        this.psaHintPressed = true;
                        createSelectorDrawable(0);
                        this.selectorDrawableMaskType[0] = 3;
                        if (Build.VERSION.SDK_INT >= 21 && (drawable2 = this.selectorDrawable[0]) != null) {
                            drawable2.setBounds(this.psaHelpX - AndroidUtilities.dp(8.0f), this.psaHelpY - AndroidUtilities.dp(8.0f), this.psaHelpX + AndroidUtilities.dp(32.0f), this.psaHelpY + AndroidUtilities.dp(32.0f));
                            this.selectorDrawable[0].setHotspot(eventX, eventY2);
                            this.selectorDrawable[0].setState(this.pressedState);
                        }
                    }
                    invalidate();
                }
            } else if (!this.drawForwardedName || this.forwardedNameLayout[0] == null) {
                if (this.drawNameLayout && this.nameLayout != null && (i4 = this.viaWidth) != 0) {
                    float f5 = this.nameX + this.viaNameWidth;
                    if (eventX >= f5 && eventX <= f5 + i4 && eventY2 >= this.nameY - AndroidUtilities.dp(4.0f) && eventY2 <= this.nameY + AndroidUtilities.dp(20.0f)) {
                        this.forwardBotPressed = true;
                    }
                }
                if (this.sideButtonVisible && this.drawSideButton != 0 && eventX >= this.sideStartX - AndroidUtilities.dp(24.0f) && eventX <= this.sideStartX + AndroidUtilities.dp(40.0f) && eventY2 >= this.sideStartY - AndroidUtilities.dp(24.0f)) {
                    if (eventY2 <= this.sideStartY + AndroidUtilities.dp(38 + ((this.drawSideButton != 3 || this.commentLayout == null) ? 0 : 18) + (this.drawSideButton2 == 5 ? 38 : 0))) {
                        if (this.currentMessageObject.isSent()) {
                            if (!this.currentMessageObject.isSponsored()) {
                                this.pressedSideButton = this.drawSideButton;
                            } else if (eventY2 <= this.sideStartY + AndroidUtilities.dp(32.0f) || this.drawSideButton2 != 5) {
                                this.pressedSideButton = 4;
                            } else {
                                this.pressedSideButton = 5;
                            }
                            this.sideButtonPressed = true;
                        }
                        invalidate();
                    }
                }
                z4 = z;
            } else {
                float f6 = this.forwardNameX;
                if (eventX >= f6 && eventX <= this.forwardedNameWidth + f6) {
                    if (eventY2 >= this.forwardNameY && eventY2 <= r6 + this.forwardHeight) {
                        if (this.viaWidth == 0 || eventX < f6 + this.viaNameWidth + AndroidUtilities.dp(4.0f)) {
                            ForwardBackground forwardBackground2 = this.forwardBg;
                            if (forwardBackground2 != null) {
                                forwardBackground2.setPressed(true);
                            }
                            this.forwardNamePressed = true;
                        }
                    }
                }
            }
            if (z4) {
                startCheckLongPress();
            }
            return z4;
        }
        if (motionEvent.getAction() != 2) {
            cancelCheckLongPress();
        }
        if (this.avatarPressed) {
            if (motionEvent.getAction() != 1) {
                if (motionEvent.getAction() != 3 && (motionEvent.getAction() != 2 || !this.isAvatarVisible || this.avatarImage.isInsideImage(eventX, eventY2 + getTop()))) {
                    return z;
                }
                this.avatarPressed = false;
                return z;
            }
            this.avatarPressed = false;
            playSoundEffect(0);
            chatMessageCellDelegate2 = this.delegate;
            if (chatMessageCellDelegate2 == null) {
                return z;
            }
            user = this.currentUser;
            if (user != null) {
                if (user.id != 0) {
                    f = this.lastTouchX;
                    f2 = this.lastTouchY;
                    z2 = false;
                    chatMessageCellDelegate2.didPressUserAvatar(this, user, f, f2, z2);
                    return z;
                }
                chatMessageCellDelegate2.didPressHiddenForward(this);
                return z;
            }
            TLRPC.Chat chat3 = this.currentChat;
            if (chat3 == null) {
                if (this.currentMessageObject == null) {
                    return z;
                }
                chatMessageCellDelegate2.didPressInstantButton(this, this.drawInstantViewType);
                return z;
            }
            TLRPC.MessageFwdHeader messageFwdHeader = this.currentMessageObject.messageOwner.fwd_from;
            if (messageFwdHeader != null) {
                if ((messageFwdHeader.flags & 16) != 0) {
                    i3 = messageFwdHeader.saved_from_msg_id;
                    chat2 = chat3;
                } else {
                    i3 = messageFwdHeader.channel_post;
                    chat2 = this.currentForwardChannel;
                }
                i2 = i3;
            } else {
                chat2 = chat3;
                i2 = 0;
            }
            chat = chat2 != null ? chat2 : chat3;
            chatMessageCell = this;
            i = i2;
            f3 = this.lastTouchX;
            f4 = this.lastTouchY;
            z3 = false;
            chatMessageCellDelegate2.didPressChannelAvatar(chatMessageCell, chat, i, f3, f4, z3);
            return z;
        }
        if (this.psaHintPressed) {
            if (motionEvent.getAction() != 1) {
                return z;
            }
            playSoundEffect(0);
            this.delegate.didPressHint(this, 1);
            this.psaHintPressed = false;
            if (Build.VERSION.SDK_INT >= 21 && (drawable = this.selectorDrawable[0]) != null) {
                drawable.setState(StateSet.NOTHING);
            }
        } else {
            if (this.forwardNamePressed) {
                if (motionEvent.getAction() != 1) {
                    if (motionEvent.getAction() == 3) {
                        this.forwardNamePressed = false;
                        forwardBackground = this.forwardBg;
                        if (forwardBackground == null) {
                            return z;
                        }
                    } else {
                        if (motionEvent.getAction() != 2) {
                            return z;
                        }
                        float f7 = this.forwardNameX;
                        if (eventX >= f7 && eventX <= f7 + this.forwardedNameWidth) {
                            if (eventY2 >= this.forwardNameY && eventY2 <= r0 + this.forwardHeight) {
                                return z;
                            }
                        }
                        this.forwardNamePressed = false;
                        forwardBackground = this.forwardBg;
                        if (forwardBackground == null) {
                            return z;
                        }
                    }
                    forwardBackground.setPressed(false);
                    return z;
                }
                this.forwardNamePressed = false;
                ForwardBackground forwardBackground3 = this.forwardBg;
                if (forwardBackground3 != null) {
                    forwardBackground3.setPressed(false);
                }
                playSoundEffect(0);
                chatMessageCellDelegate2 = this.delegate;
                if (chatMessageCellDelegate2 == null) {
                    return z;
                }
                chat = this.currentForwardChannel;
                if (chat != null) {
                    TLRPC.MessageFwdHeader messageFwdHeader2 = this.currentMessageObject.messageOwner.fwd_from;
                    i = messageFwdHeader2 != null ? messageFwdHeader2.channel_post : 0;
                    f3 = this.lastTouchX;
                    f4 = this.lastTouchY;
                    z3 = true;
                    chatMessageCell = this;
                    chatMessageCellDelegate2.didPressChannelAvatar(chatMessageCell, chat, i, f3, f4, z3);
                    return z;
                }
                user = this.currentForwardUser;
                if (user == null) {
                    if (this.currentForwardName == null) {
                        return z;
                    }
                    chatMessageCellDelegate2.didPressHiddenForward(this);
                    return z;
                }
                f = this.lastTouchX;
                f2 = this.lastTouchY;
                z2 = true;
                chatMessageCellDelegate2.didPressUserAvatar(this, user, f, f2, z2);
                return z;
            }
            if (this.forwardBotPressed) {
                if (motionEvent.getAction() == 1) {
                    this.forwardBotPressed = false;
                    playSoundEffect(0);
                    ChatMessageCellDelegate chatMessageCellDelegate4 = this.delegate;
                    if (chatMessageCellDelegate4 == null) {
                        return z;
                    }
                    TLRPC.User user2 = this.currentViaBotUser;
                    if (user2 == null || user2.bot_inline_placeholder != null) {
                        chatMessageCellDelegate4.didPressViaBot(this, user2 != null ? user2.username : this.currentMessageObject.messageOwner.via_bot_name);
                        return z;
                    }
                    chatMessageCellDelegate4.didPressViaBotNotInline(this, user2.id);
                    return z;
                }
                if (motionEvent.getAction() != 3) {
                    if (motionEvent.getAction() != 2) {
                        return z;
                    }
                    if (!this.drawForwardedName || this.forwardedNameLayout[0] == null) {
                        float f8 = this.nameX + this.viaNameWidth;
                        if (eventX >= f8 && eventX <= f8 + this.viaWidth && eventY2 >= this.nameY - AndroidUtilities.dp(4.0f) && eventY2 <= this.nameY + AndroidUtilities.dp(20.0f)) {
                            return z;
                        }
                    } else {
                        float f9 = this.forwardNameX;
                        if (eventX >= f9 && eventX <= f9 + this.forwardedNameWidth) {
                            if (eventY2 >= this.forwardNameY && eventY2 <= r0 + this.forwardHeight) {
                                return z;
                            }
                        }
                    }
                }
                this.forwardBotPressed = false;
                return z;
            }
            if (!this.sideButtonPressed) {
                return z;
            }
            if (motionEvent.getAction() == 1) {
                playSoundEffect(0);
                ChatMessageCellDelegate chatMessageCellDelegate5 = this.delegate;
                if (chatMessageCellDelegate5 != null) {
                    int i6 = this.pressedSideButton;
                    if (i6 == 4) {
                        chatMessageCellDelegate5.didPressSponsoredClose(this);
                    } else if (i6 == 5) {
                        chatMessageCellDelegate5.didPressSponsoredInfo(this, eventX, eventY2);
                    } else if (i6 == 3) {
                        chatMessageCellDelegate5.didPressCommentButton(this);
                    } else {
                        chatMessageCellDelegate5.didPressSideButton(this);
                    }
                }
            } else if (motionEvent.getAction() != 3) {
                if (motionEvent.getAction() == 2) {
                    if (this.sideButtonVisible && eventX >= this.sideStartX - AndroidUtilities.dp(24.0f) && eventX <= this.sideStartX + AndroidUtilities.dp(40.0f) && eventY2 >= this.sideStartY - AndroidUtilities.dp(24.0f)) {
                        if (eventY2 > this.sideStartY + AndroidUtilities.dp(38 + ((this.drawSideButton != 3 || this.commentLayout == null) ? 0 : 18) + (this.drawSideButton2 != 5 ? 0 : 38))) {
                        }
                    }
                }
            }
            this.sideButtonPressed = false;
            this.pressedSideButton = 0;
        }
        invalidate();
        return z;
    }

    public void overrideAudioVisualizer(AudioVisualizerDrawable audioVisualizerDrawable) {
        this.overridenAudioVisualizer = audioVisualizerDrawable;
    }

    public void overrideDuration(long j) {
        this.overridenDuration = j;
    }

    @Override // android.view.View
    public boolean performAccessibilityAction(int i, Bundle bundle) throws Resources.NotFoundException, NumberFormatException {
        ChatMessageCellDelegate chatMessageCellDelegate;
        ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
        if (chatMessageCellDelegate2 != null && chatMessageCellDelegate2.onAccessibilityAction(i, bundle)) {
            return false;
        }
        if (i == 16) {
            int iconForCurrentState = getIconForCurrentState();
            if (iconForCurrentState != 4 && iconForCurrentState != 5) {
                didPressButton(true, false);
            } else if (this.currentMessageObject.type == 16) {
                this.delegate.didPressOther(this, this.otherX, this.otherY);
            } else {
                didClickedImage();
            }
            return true;
        }
        if (i == R.id.acc_action_small_button) {
            didPressMiniButton(true);
        } else if (i == R.id.acc_action_msg_options) {
            ChatMessageCellDelegate chatMessageCellDelegate3 = this.delegate;
            if (chatMessageCellDelegate3 != null) {
                if (this.currentMessageObject.type == 16) {
                    chatMessageCellDelegate3.didLongPress(this, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED);
                } else {
                    chatMessageCellDelegate3.didPressOther(this, this.otherX, this.otherY);
                }
            }
        } else if (i == R.id.acc_action_open_forwarded_origin && (chatMessageCellDelegate = this.delegate) != null) {
            TLRPC.Chat chat = this.currentForwardChannel;
            if (chat != null) {
                chatMessageCellDelegate.didPressChannelAvatar(this, chat, this.currentMessageObject.messageOwner.fwd_from.channel_post, this.lastTouchX, this.lastTouchY, false);
            } else {
                TLRPC.User user = this.currentForwardUser;
                if (user != null) {
                    chatMessageCellDelegate.didPressUserAvatar(this, user, this.lastTouchX, this.lastTouchY, false);
                } else if (this.currentForwardName != null) {
                    chatMessageCellDelegate.didPressHiddenForward(this);
                }
            }
        }
        if ((this.currentMessageObject.isVoice() || this.currentMessageObject.isRoundVideo() || (this.currentMessageObject.isMusic() && MediaController.getInstance().isPlayingMessage(this.currentMessageObject))) && this.seekBarAccessibilityDelegate.performAccessibilityActionInternal(i, bundle)) {
            return true;
        }
        return super.performAccessibilityAction(i, bundle);
    }

    public void relayout() {
        this.forcedLayout = true;
        forceLayout();
    }

    @Override // android.view.View, android.view.ViewParent
    public void requestLayout() {
        if (this.inLayout) {
            return;
        }
        super.requestLayout();
    }

    public void resetPressedLink(int i) {
        LinkSpanDrawable.LinkCollector linkCollector = this.links;
        if (i != -1) {
            linkCollector.removeLinks(Integer.valueOf(i));
        } else {
            linkCollector.clear();
        }
        LinkSpanDrawable.LinkCollector linkCollector2 = this.factCheckLinks;
        if (linkCollector2 != null) {
            linkCollector2.clear();
        }
        this.pressedEmoji = null;
        this.pressedFactCheckLink = null;
        if (this.pressedLink != null) {
            if (this.pressedLinkType == i || i == -1) {
                this.pressedLink = null;
                this.pressedLinkType = -1;
                invalidate();
            }
        }
    }

    @Override // org.telegram.ui.Components.SeekBar.SeekBarDelegate
    public boolean reverseWaveform() {
        MessageObject messageObject = this.currentMessageObject;
        return messageObject != null && messageObject.isVoiceOnce();
    }

    public void setAllowAssistant(boolean z) {
        this.allowAssistant = z;
    }

    @Override // android.view.View
    public void setAlpha(float f) {
        if ((f == 1.0f) != (getAlpha() == 1.0f)) {
            invalidate();
        }
        if (this.ALPHA_PROPERTY_WORKAROUND) {
            this.alphaInternal = f;
            invalidate();
        } else {
            super.setAlpha(f);
        }
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if ((groupedMessagePosition != null && (groupedMessagePosition.minY != 0 || groupedMessagePosition.minX != 0)) || ((this.enterTransitionInProgress && !this.currentMessageObject.isVoice()) || this.replyNameLayout == null || this.replyTextLayout == null)) {
            MessageObject.GroupedMessagePosition groupedMessagePosition2 = this.currentPosition;
            if (groupedMessagePosition2 != null) {
                int i = groupedMessagePosition2.flags;
                if ((i & 8) == 0 || (i & 1) == 0) {
                    return;
                }
            }
            if (this.reactionsLayoutInBubble.isSmall) {
                return;
            }
        }
        invalidate();
    }

    public void setAnimationOffsetX(float f) {
        if (this.animationOffsetX != f) {
            this.animationOffsetX = f;
            updateTranslation();
        }
    }

    public void setAnimationRunning(boolean z, boolean z2) {
        this.animationRunning = z;
        if (z) {
            this.willRemoved = z2;
        } else {
            this.willRemoved = false;
        }
    }

    public void setAvatar(MessageObject messageObject) {
        TLRPC.Chat chat;
        if (messageObject == null) {
            return;
        }
        if (!this.isAvatarVisible) {
            this.currentPhoto = null;
            return;
        }
        Drawable drawable = messageObject.customAvatarDrawable;
        if (drawable != null) {
            this.avatarImage.setImageBitmap(drawable);
            return;
        }
        TLRPC.User user = this.currentUser;
        if (user != null) {
            TLRPC.UserProfilePhoto userProfilePhoto = user.photo;
            if (userProfilePhoto != null) {
                this.currentPhoto = userProfilePhoto.photo_small;
            } else {
                this.currentPhoto = null;
            }
            this.avatarDrawable.setInfo(this.currentAccount, user);
            this.avatarImage.setForUserOrChat(this.currentUser, this.avatarDrawable, null, LiteMode.isEnabled(LiteMode.FLAGS_CHAT), 1, false);
            return;
        }
        TLRPC.Chat chat2 = this.currentChat;
        if (chat2 == null) {
            if (!messageObject.isSponsored()) {
                this.currentPhoto = null;
                this.avatarDrawable.setInfo(messageObject.getFromChatId(), null, null);
                this.avatarImage.setImage(null, null, this.avatarDrawable, null, null, 0);
                return;
            } else {
                TLRPC.Photo photo = messageObject.sponsoredPhoto;
                if (photo != null) {
                    this.avatarImage.setImage(ImageLocation.getForPhoto(FileLoader.getClosestPhotoSizeWithSize(photo.sizes, AndroidUtilities.dp(50.0f), false, null, true), messageObject.sponsoredPhoto), "50_50", this.avatarDrawable, null, null, 0);
                    return;
                }
                return;
            }
        }
        TLRPC.ChatPhoto chatPhoto = chat2.photo;
        this.currentPhoto = chatPhoto != null ? chatPhoto.photo_small : null;
        if (!chat2.signature_profiles || messageObject.getDialogId() == UserObject.REPLY_BOT) {
            this.avatarDrawable.setInfo(this.currentAccount, this.currentChat);
            this.avatarImage.setForUserOrChat(this.currentChat, this.avatarDrawable);
            return;
        }
        long peerDialogId = DialogObject.getPeerDialogId(messageObject.messageOwner.from_id);
        MessagesController messagesController = MessagesController.getInstance(messageObject.currentAccount);
        if (peerDialogId >= 0) {
            TLRPC.User user2 = messagesController.getUser(Long.valueOf(peerDialogId));
            this.avatarDrawable.setInfo(this.currentAccount, user2);
            chat = user2;
        } else {
            TLRPC.Chat chat3 = messagesController.getChat(Long.valueOf(-peerDialogId));
            this.avatarDrawable.setInfo(this.currentAccount, chat3);
            chat = chat3;
        }
        this.avatarImage.setForUserOrChat(chat, this.avatarDrawable);
    }

    /* JADX WARN: Removed duplicated region for block: B:7:0x0029 A[PHI: r0 r1
      0x0029: PHI (r0v1 int) = (r0v0 int), (r0v5 int) binds: [B:3:0x0006, B:5:0x0016] A[DONT_GENERATE, DONT_INLINE]
      0x0029: PHI (r1v1 int) = (r1v0 int), (r1v4 int) binds: [B:3:0x0006, B:5:0x0016] A[DONT_GENERATE, DONT_INLINE]] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void setBackgroundTopY(int i) {
        int i2;
        int measuredHeight;
        Theme.MessageDrawable messageDrawable = this.currentBackgroundDrawable;
        int parentWidth = this.parentWidth;
        int i3 = this.parentHeight;
        if (i3 == 0) {
            parentWidth = getParentWidth();
            i3 = AndroidUtilities.displaySize.y;
            if (getParent() instanceof View) {
                View view = (View) getParent();
                int measuredWidth = view.getMeasuredWidth();
                measuredHeight = view.getMeasuredHeight();
                i2 = measuredWidth;
            } else {
                i2 = parentWidth;
                measuredHeight = i3;
            }
        }
        float f = this.parentViewTopOffset;
        messageDrawable.setTop((int) (i + f), i2, measuredHeight, (int) f, this.blurredViewTopOffset, this.blurredViewBottomOffset, this.pinnedTop, this.pinnedBottom || this.transitionParams.changePinnedBottomProgress != 1.0f);
        MessageObject messageObject = this.currentMessageObject;
        messageDrawable.setBotButtonsBottom(messageObject != null && messageObject.hasInlineBotButtons());
    }

    /* JADX WARN: Removed duplicated region for block: B:19:0x003d A[PHI: r4 r5
      0x003d: PHI (r4v1 int) = (r4v0 int), (r4v14 int) binds: [B:15:0x001a, B:17:0x002a] A[DONT_GENERATE, DONT_INLINE]
      0x003d: PHI (r5v1 int) = (r5v0 int), (r5v6 int) binds: [B:15:0x001a, B:17:0x002a] A[DONT_GENERATE, DONT_INLINE]] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void setBackgroundTopY(boolean z) {
        int i;
        int measuredHeight;
        int i2 = 0;
        while (i2 < 2) {
            if (i2 == 1 && !z) {
                return;
            }
            Theme.MessageDrawable messageDrawable = i2 == 0 ? this.currentBackgroundDrawable : this.currentBackgroundSelectedDrawable;
            if (messageDrawable != null) {
                int parentWidth = this.parentWidth;
                int i3 = this.parentHeight;
                if (i3 == 0) {
                    parentWidth = getParentWidth();
                    i3 = AndroidUtilities.displaySize.y;
                    if (getParent() instanceof View) {
                        View view = (View) getParent();
                        int measuredWidth = view.getMeasuredWidth();
                        measuredHeight = view.getMeasuredHeight();
                        i = measuredWidth;
                    } else {
                        i = parentWidth;
                        measuredHeight = i3;
                    }
                    float y = z ? getY() : getTop();
                    float f = this.parentViewTopOffset;
                    messageDrawable.setTop((int) (y + f), i, measuredHeight, (int) f, this.blurredViewTopOffset, this.blurredViewBottomOffset, this.pinnedTop, this.pinnedBottom || this.transitionParams.changePinnedBottomProgress != 1.0f);
                    MessageObject messageObject = this.currentMessageObject;
                    messageDrawable.setBotButtonsBottom(messageObject != null && messageObject.hasInlineBotButtons());
                }
            }
            i2++;
        }
    }

    public void setCheckBoxVisible(boolean z, boolean z2) {
        MessageObject.GroupedMessages groupedMessages;
        MessageObject.GroupedMessages groupedMessages2;
        MessageObject messageObject;
        if (z2 && (messageObject = this.currentMessageObject) != null && messageObject.deletedByThanos) {
            return;
        }
        if (z) {
            this.quoteHighlight = null;
            CheckBoxBase checkBoxBase = this.checkBox;
            if (checkBoxBase == null) {
                CheckBoxBase checkBoxBase2 = new CheckBoxBase(this, 21, this.resourcesProvider);
                this.checkBox = checkBoxBase2;
                if (this.attachedToWindow) {
                    checkBoxBase2.onAttachedToWindow();
                }
            } else {
                checkBoxBase.setResourcesProvider(this.resourcesProvider);
            }
        }
        if (z && (((groupedMessages = this.currentMessagesGroup) != null && groupedMessages.messages.size() > 1) || ((groupedMessages2 = this.groupedMessagesToSet) != null && groupedMessages2.messages.size() > 1))) {
            CheckBoxBase checkBoxBase3 = this.mediaCheckBox;
            if (checkBoxBase3 == null) {
                CheckBoxBase checkBoxBase4 = new CheckBoxBase(this, 21, this.resourcesProvider);
                this.mediaCheckBox = checkBoxBase4;
                checkBoxBase4.setUseDefaultCheck(true);
                if (this.attachedToWindow) {
                    this.mediaCheckBox.onAttachedToWindow();
                }
            } else {
                checkBoxBase3.setResourcesProvider(this.resourcesProvider);
            }
        }
        boolean z3 = this.checkBoxVisible;
        float f = BitmapDescriptorFactory.HUE_RED;
        if (z3 == z) {
            if (z2 == this.checkBoxAnimationInProgress || z2) {
                return;
            }
            if (z) {
                f = 1.0f;
            }
            this.checkBoxAnimationProgress = f;
            invalidate();
            return;
        }
        this.checkBoxAnimationInProgress = z2;
        this.checkBoxVisible = z;
        if (z2) {
            this.lastCheckBoxAnimationTime = SystemClock.elapsedRealtime();
        } else {
            if (z) {
                f = 1.0f;
            }
            this.checkBoxAnimationProgress = f;
        }
        invalidate();
    }

    public void setCheckPressed(boolean z, boolean z2) {
        this.isCheckPressed = z;
        this.isPressed = z2;
        updateRadialProgressBackground();
        if (this.useSeekBarWaveform) {
            this.seekBarWaveform.setSelected(isDrawSelectionBackground());
        } else {
            this.seekBar.setSelected(isDrawSelectionBackground());
        }
        invalidate();
    }

    public void setChecked(boolean z, boolean z2, boolean z3) {
        MessageObject messageObject;
        if (z || !z3 || (messageObject = this.currentMessageObject) == null || !messageObject.deletedByThanos) {
            CheckBoxBase checkBoxBase = this.checkBox;
            if (checkBoxBase != null) {
                checkBoxBase.setChecked(z2, z3);
            }
            CheckBoxBase checkBoxBase2 = this.mediaCheckBox;
            if (checkBoxBase2 != null) {
                checkBoxBase2.setChecked(z, z3);
            }
            this.backgroundDrawable.setSelected(z2, z3);
        }
    }

    public boolean setCurrentDiceValue(boolean z) {
        MessagesController.DiceFrameSuccess diceFrameSuccess;
        if (!this.currentMessageObject.isDice()) {
            return false;
        }
        Drawable drawable = this.photoImage.getDrawable();
        if (drawable instanceof RLottieDrawable) {
            RLottieDrawable rLottieDrawable = (RLottieDrawable) drawable;
            String diceEmoji = this.currentMessageObject.getDiceEmoji();
            TLRPC.TL_messages_stickerSet stickerSetByEmojiOrName = MediaDataController.getInstance(this.currentAccount).getStickerSetByEmojiOrName(diceEmoji);
            if (stickerSetByEmojiOrName != null) {
                int diceValue = this.currentMessageObject.getDiceValue();
                if ("".equals(this.currentMessageObject.getDiceEmoji())) {
                    if (diceValue >= 0 && diceValue <= 64) {
                        ((SlotsDrawable) rLottieDrawable).setDiceNumber(this, diceValue, stickerSetByEmojiOrName, z);
                        if (this.currentMessageObject.isOut()) {
                            rLottieDrawable.setOnFinishCallback(this.diceFinishCallback, Integer.MAX_VALUE);
                        }
                        this.currentMessageObject.wasUnread = false;
                    }
                    if (!rLottieDrawable.hasBaseDice() && stickerSetByEmojiOrName.documents.size() > 0) {
                        ((SlotsDrawable) rLottieDrawable).setBaseDice(this, stickerSetByEmojiOrName);
                    }
                } else {
                    if (!rLottieDrawable.hasBaseDice() && stickerSetByEmojiOrName.documents.size() > 0) {
                        TLRPC.Document document = (TLRPC.Document) stickerSetByEmojiOrName.documents.get(0);
                        if (rLottieDrawable.setBaseDice(FileLoader.getInstance(this.currentAccount).getPathToAttach(document, true))) {
                            DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
                        } else {
                            DownloadController.getInstance(this.currentAccount).addLoadingFileObserver(FileLoader.getAttachFileName(document), this.currentMessageObject, this);
                            FileLoader.getInstance(this.currentAccount).loadFile(document, stickerSetByEmojiOrName, 1, 1);
                        }
                    }
                    if (diceValue >= 0 && diceValue < stickerSetByEmojiOrName.documents.size()) {
                        if (!z && this.currentMessageObject.isOut() && (diceFrameSuccess = MessagesController.getInstance(this.currentAccount).diceSuccess.get(diceEmoji)) != null && diceFrameSuccess.num == diceValue) {
                            rLottieDrawable.setOnFinishCallback(this.diceFinishCallback, diceFrameSuccess.frame);
                        }
                        TLRPC.Document document2 = (TLRPC.Document) stickerSetByEmojiOrName.documents.get(Math.max(diceValue, 0));
                        if (rLottieDrawable.setDiceNumber(FileLoader.getInstance(this.currentAccount).getPathToAttach(document2, true), z)) {
                            DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
                        } else {
                            DownloadController.getInstance(this.currentAccount).addLoadingFileObserver(FileLoader.getAttachFileName(document2), this.currentMessageObject, this);
                            FileLoader.getInstance(this.currentAccount).loadFile(document2, stickerSetByEmojiOrName, 1, 1);
                        }
                        this.currentMessageObject.wasUnread = false;
                    }
                }
            } else {
                MediaDataController.getInstance(this.currentAccount).loadStickersByEmojiOrName(diceEmoji, true, true);
            }
        }
        return true;
    }

    public void setDelegate(ChatMessageCellDelegate chatMessageCellDelegate) {
        this.delegate = chatMessageCellDelegate;
    }

    public void setDrawSelectionBackground(boolean z) {
        if (this.drawSelectionBackground != z) {
            this.drawSelectionBackground = z;
            invalidate();
        }
    }

    public void setDrawableBoundsInner(Drawable drawable, int i, int i2, int i3, int i4) {
        if (drawable != null) {
            TransitionParams transitionParams = this.transitionParams;
            float f = i4 + i2 + transitionParams.deltaBottom;
            int i5 = (int) f;
            this.transitionYOffsetForDrawables = f - i5;
            drawable.setBounds((int) (i + transitionParams.deltaLeft), (int) (i2 + transitionParams.deltaTop), (int) (i + i3 + transitionParams.deltaRight), i5);
        }
    }

    public void setEnterTransitionInProgress(boolean z) {
        this.enterTransitionInProgress = z;
        invalidate();
    }

    public void setFullyDraw(boolean z) {
        this.fullyDraw = z;
    }

    public void setHideSideButtonByQuickShare(boolean z) {
        if (this.hideSideButtonByQuickShare != z) {
            this.hideSideButtonByQuickShare = z;
            boolean z2 = this.invalidatesParent;
            this.invalidatesParent = true;
            invalidate();
            this.invalidatesParent = z2;
        }
    }

    public void setHighlighted(boolean z) {
        int i;
        if (this.isHighlighted == z) {
            return;
        }
        this.isHighlighted = z;
        if (z) {
            this.quoteHighlight = null;
        }
        if (z) {
            i = 0;
            this.isHighlightedAnimated = false;
        } else {
            this.lastHighlightProgressTime = System.currentTimeMillis();
            this.isHighlightedAnimated = true;
            i = LocationRequest.PRIORITY_INDOOR;
        }
        this.highlightProgress = i;
        updateRadialProgressBackground();
        if (this.useSeekBarWaveform) {
            this.seekBarWaveform.setSelected(isDrawSelectionBackground());
        } else {
            this.seekBar.setSelected(isDrawSelectionBackground());
        }
        invalidate();
        if (getParent() != null) {
            ((View) getParent()).invalidate();
        }
    }

    public void setHighlightedAnimated() {
        this.isHighlightedAnimated = true;
        this.highlightProgress = 1000;
        this.lastHighlightProgressTime = System.currentTimeMillis();
        invalidate();
        if (getParent() != null) {
            ((View) getParent()).invalidate();
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:35:0x0065  */
    /* JADX WARN: Removed duplicated region for block: B:76:0x0115  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public boolean setHighlightedSpan(CharacterStyle characterStyle) {
        int spanEnd;
        int spanStart;
        int i;
        int spanEnd2;
        int spanStart2;
        int i2;
        MessageObject messageObject = this.messageObjectToSet;
        if (messageObject == null) {
            messageObject = this.currentMessageObject;
        }
        this.highlightedQuote = false;
        if (messageObject == null || messageObject.messageOwner.message == null || characterStyle == null) {
            if (!this.urlPathSelection.isEmpty()) {
                this.linkSelectionBlockNum = -1;
                this.highlightedQuote = false;
                resetUrlPaths();
                invalidate();
            }
            return false;
        }
        if (this.captionLayout != null && !TextUtils.isEmpty(messageObject.caption)) {
            CharSequence charSequence = messageObject.caption;
            if (charSequence instanceof Spannable) {
                Spanned spanned = (Spanned) charSequence;
                CharacterStyle[] characterStyleArr = (CharacterStyle[]) spanned.getSpans(0, spanned.length(), CharacterStyle.class);
                if (characterStyleArr == null || characterStyleArr.length <= 0) {
                    spanEnd2 = -1;
                    spanStart2 = -1;
                    if (spanStart2 >= 0 && spanEnd2 >= 0) {
                        int i3 = spanEnd2 - spanStart2;
                        for (i2 = 0; i2 < this.captionLayout.textLayoutBlocks.size(); i2++) {
                            MessageObject.TextLayoutBlock textLayoutBlock = this.captionLayout.textLayoutBlocks.get(i2);
                            if (spanStart2 >= textLayoutBlock.charactersOffset && spanStart2 < textLayoutBlock.charactersEnd) {
                                this.linkSelectionBlockNum = i2;
                                this.highlightedQuote = false;
                                resetUrlPaths();
                                try {
                                    LinkPath linkPathObtainNewUrlPath = obtainNewUrlPath();
                                    linkPathObtainNewUrlPath.setCurrentLayout(textLayoutBlock.textLayout, spanStart2, BitmapDescriptorFactory.HUE_RED);
                                    textLayoutBlock.textLayout.getSelectionPath(spanStart2, spanEnd2, linkPathObtainNewUrlPath);
                                    if (spanEnd2 >= textLayoutBlock.charactersOffset + i3) {
                                        for (int i4 = i2 + 1; i4 < this.captionLayout.textLayoutBlocks.size(); i4++) {
                                            MessageObject.TextLayoutBlock textLayoutBlock2 = this.captionLayout.textLayoutBlocks.get(i4);
                                            int i5 = textLayoutBlock2.charactersEnd - textLayoutBlock2.charactersOffset;
                                            LinkPath linkPathObtainNewUrlPath2 = obtainNewUrlPath();
                                            linkPathObtainNewUrlPath2.setCurrentLayout(textLayoutBlock2.textLayout, 0, textLayoutBlock2.height);
                                            textLayoutBlock2.textLayout.getSelectionPath(0, spanEnd2 - textLayoutBlock2.charactersOffset, linkPathObtainNewUrlPath2);
                                            if (spanEnd2 < (textLayoutBlock.charactersOffset + i5) - 1) {
                                                break;
                                            }
                                        }
                                    }
                                } catch (Exception e) {
                                    FileLog.e(e);
                                }
                                invalidate();
                                return true;
                            }
                        }
                    }
                } else {
                    for (CharacterStyle characterStyle2 : characterStyleArr) {
                        if (characterStyle2 == characterStyle) {
                            spanStart2 = spanned.getSpanStart(characterStyle);
                            spanEnd2 = spanned.getSpanEnd(characterStyle);
                            break;
                        }
                    }
                    spanEnd2 = -1;
                    spanStart2 = -1;
                    if (spanStart2 >= 0) {
                        int i32 = spanEnd2 - spanStart2;
                        while (i2 < this.captionLayout.textLayoutBlocks.size()) {
                        }
                    }
                }
            }
        }
        CharSequence charSequence2 = messageObject.messageText;
        if ((charSequence2 instanceof Spanned) && messageObject.textLayoutBlocks != null) {
            Spanned spanned2 = (Spanned) charSequence2;
            CharacterStyle[] characterStyleArr2 = (CharacterStyle[]) spanned2.getSpans(0, spanned2.length(), CharacterStyle.class);
            if (characterStyleArr2 == null || characterStyleArr2.length <= 0) {
                spanEnd = -1;
                spanStart = -1;
                if (spanStart >= 0 && spanEnd >= 0) {
                    int i6 = spanEnd - spanStart;
                    for (i = 0; i < messageObject.textLayoutBlocks.size(); i++) {
                        MessageObject.TextLayoutBlock textLayoutBlock3 = messageObject.textLayoutBlocks.get(i);
                        if (spanStart >= textLayoutBlock3.charactersOffset && spanStart < textLayoutBlock3.charactersEnd) {
                            this.linkSelectionBlockNum = i;
                            this.highlightedQuote = false;
                            resetUrlPaths();
                            try {
                                LinkPath linkPathObtainNewUrlPath3 = obtainNewUrlPath();
                                linkPathObtainNewUrlPath3.setCurrentLayout(textLayoutBlock3.textLayout, spanStart, BitmapDescriptorFactory.HUE_RED);
                                textLayoutBlock3.textLayout.getSelectionPath(spanStart, spanEnd, linkPathObtainNewUrlPath3);
                                if (spanEnd >= textLayoutBlock3.charactersOffset + i6) {
                                    for (int i7 = i + 1; i7 < messageObject.textLayoutBlocks.size(); i7++) {
                                        MessageObject.TextLayoutBlock textLayoutBlock4 = messageObject.textLayoutBlocks.get(i7);
                                        int i8 = textLayoutBlock4.charactersEnd - textLayoutBlock4.charactersOffset;
                                        LinkPath linkPathObtainNewUrlPath4 = obtainNewUrlPath();
                                        linkPathObtainNewUrlPath4.setCurrentLayout(textLayoutBlock4.textLayout, 0, textLayoutBlock4.height);
                                        textLayoutBlock4.textLayout.getSelectionPath(0, spanEnd - textLayoutBlock4.charactersOffset, linkPathObtainNewUrlPath4);
                                        if (spanEnd < (textLayoutBlock3.charactersOffset + i8) - 1) {
                                            break;
                                        }
                                    }
                                }
                            } catch (Exception e2) {
                                FileLog.e(e2);
                            }
                            invalidate();
                            return true;
                        }
                    }
                }
            } else {
                for (CharacterStyle characterStyle3 : characterStyleArr2) {
                    if (characterStyle3 == characterStyle) {
                        spanStart = spanned2.getSpanStart(characterStyle);
                        spanEnd = spanned2.getSpanEnd(characterStyle);
                        break;
                    }
                }
                spanEnd = -1;
                spanStart = -1;
                if (spanStart >= 0) {
                    int i62 = spanEnd - spanStart;
                    while (i < messageObject.textLayoutBlocks.size()) {
                    }
                }
            }
        }
        if (!this.urlPathSelection.isEmpty()) {
            this.linkSelectionBlockNum = -1;
            this.highlightedQuote = false;
            resetUrlPaths();
            invalidate();
        }
        return false;
    }

    public boolean setHighlightedTask(int i) {
        MessageObject messageObject = this.messageObjectToSet;
        if (messageObject == null) {
            messageObject = this.currentMessageObject;
        }
        if (messageObject == null) {
            this.quoteHighlight = null;
            return false;
        }
        QuoteHighlight quoteHighlight = this.quoteHighlight;
        if (quoteHighlight == null || !quoteHighlight.todo || quoteHighlight.start != (-i)) {
            this.quoteHighlight = new QuoteHighlight(this, messageObject.getId(), i);
        }
        this.highlightedQuote = true;
        return true;
    }

    public boolean setHighlightedText(String str) {
        return setHighlightedText(str, false, -1, false);
    }

    /* JADX WARN: Removed duplicated region for block: B:143:0x00b6 A[ADDED_TO_REGION, REMOVE, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:145:0x00b0 A[ADDED_TO_REGION, REMOVE, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:52:0x00a5  */
    /* JADX WARN: Removed duplicated region for block: B:57:0x00b2 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:95:0x0120  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public boolean setHighlightedText(String str, boolean z, int i, boolean z2) {
        String lowerCase;
        int length;
        int iFindQuoteStart;
        int i2;
        ArrayList<MessageObject.TextLayoutBlock> arrayList;
        QuoteHighlight quoteHighlight;
        if (this.highlightedQuote && !z && TextUtils.isEmpty(str)) {
            return false;
        }
        MessageObject messageObject = this.messageObjectToSet;
        if (messageObject == null) {
            messageObject = this.currentMessageObject;
        }
        MessageObject messageObject2 = messageObject;
        this.highlightedQuote = z;
        if (messageObject2 == null || TextUtils.isEmpty(str)) {
            if (!this.urlPathSelection.isEmpty()) {
                this.linkSelectionBlockNum = -1;
                this.highlightedQuote = false;
                resetUrlPaths();
                invalidate();
            }
            return false;
        }
        if (!z) {
            this.quoteHighlight = null;
        }
        CharSequence charSequence = this.currentCaption;
        String string = charSequence != null ? charSequence.toString() : messageObject2.messageOwner.message;
        if (string == null || TextUtils.isEmpty(string)) {
            if (!this.urlPathSelection.isEmpty()) {
                this.linkSelectionBlockNum = -1;
                this.highlightedQuote = false;
                resetUrlPaths();
                invalidate();
            }
            return false;
        }
        if (z) {
            lowerCase = str;
        } else {
            lowerCase = str.toLowerCase();
            string = string.toLowerCase();
        }
        if (z) {
            iFindQuoteStart = MessageObject.findQuoteStart(string, lowerCase, i);
            length = lowerCase.length();
        } else {
            int length2 = string.length();
            int i3 = -1;
            int i4 = -1;
            for (int i5 = 0; i5 < length2; i5++) {
                int iMin = Math.min(lowerCase.length(), length2 - i5);
                int i6 = 0;
                int i7 = 0;
                while (i6 < iMin) {
                    boolean z3 = string.charAt(i5 + i6) == lowerCase.charAt(i6);
                    if (!z3) {
                        i2 = i7;
                        if (z3 && i6 != iMin - 1) {
                            i6++;
                            i7 = i2;
                        } else if (i2 > 0 && i2 > i3) {
                            i4 = i5;
                            i3 = i2;
                        }
                    } else if (i7 != 0 || i5 == 0 || " !\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~\n".indexOf(string.charAt(i5 - 1)) >= 0) {
                        i7++;
                        i2 = i7;
                        if (z3) {
                        }
                        if (i2 > 0) {
                        }
                    } else {
                        i2 = i7;
                        z3 = false;
                        if (z3) {
                        }
                        if (i2 > 0) {
                        }
                    }
                }
            }
            length = i3;
            iFindQuoteStart = i4;
        }
        if (iFindQuoteStart == -1) {
            if (!this.urlPathSelection.isEmpty()) {
                this.linkSelectionBlockNum = -1;
                this.highlightedQuote = false;
                resetUrlPaths();
                invalidate();
            }
            return false;
        }
        if (!z) {
            int length3 = string.length();
            for (int i8 = iFindQuoteStart + length; i8 < length3 && " !\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~\n".indexOf(string.charAt(i8)) < 0; i8++) {
                length++;
            }
        }
        this.highlightedQuote = z;
        int i9 = iFindQuoteStart + length;
        if (!z || this.currentMessagesGroup != null || this.groupedMessagesToSet != null) {
            if (TextUtils.isEmpty(this.currentCaption)) {
                arrayList = messageObject2.textLayoutBlocks;
                if (arrayList == null) {
                    return true;
                }
            } else {
                MessageObject.TextLayoutBlocks textLayoutBlocks = this.captionLayout;
                if (textLayoutBlocks == null) {
                    this.highlightCaptionToSetStart = iFindQuoteStart;
                    this.highlightCaptionToSetEnd = i9;
                    return true;
                }
                arrayList = textLayoutBlocks.textLayoutBlocks;
            }
            highlight(iFindQuoteStart, i9, arrayList);
            return true;
        }
        QuoteHighlight quoteHighlight2 = this.quoteHighlight;
        boolean z4 = quoteHighlight2 == null || !quoteHighlight2.done();
        QuoteHighlight quoteHighlight3 = this.quoteHighlight;
        if (quoteHighlight3 == null || quoteHighlight3.todo || quoteHighlight3.id != messageObject2.getId()) {
            MessageObject.TextLayoutBlocks textLayoutBlocks2 = this.captionLayout;
            ViewParent parent = getParent();
            int id = messageObject2.getId();
            if (textLayoutBlocks2 != null) {
                MessageObject.TextLayoutBlocks textLayoutBlocks3 = this.captionLayout;
                quoteHighlight = new QuoteHighlight(this, parent, id, textLayoutBlocks3.textLayoutBlocks, iFindQuoteStart, i9, textLayoutBlocks3.textXOffset);
            } else {
                quoteHighlight = new QuoteHighlight(this, parent, id, messageObject2.textLayoutBlocks, iFindQuoteStart, i9, messageObject2.textXOffset);
            }
            this.quoteHighlight = quoteHighlight;
        } else {
            QuoteHighlight quoteHighlight4 = this.quoteHighlight;
            if (quoteHighlight4.start != iFindQuoteStart || quoteHighlight4.end != i9) {
            }
        }
        QuoteHighlight quoteHighlight5 = this.quoteHighlight;
        if (quoteHighlight5 == null || quoteHighlight5.quotesToExpand.isEmpty()) {
            return true;
        }
        if (!z2) {
            if (z4) {
                return true;
            }
            this.quoteHighlight = null;
            return true;
        }
        MessageObject primaryMessageObject = getPrimaryMessageObject();
        if (primaryMessageObject != null) {
            messageObject2 = primaryMessageObject;
        }
        HashSet<Integer> hashSet = messageObject2.expandedQuotes == null ? new HashSet<>() : new HashSet<>(messageObject2.expandedQuotes);
        messageObject2.expandedQuotes = hashSet;
        hashSet.addAll(this.quoteHighlight.quotesToExpand);
        ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
        if (chatMessageCellDelegate == null) {
            return true;
        }
        chatMessageCellDelegate.forceUpdate(this, false);
        return true;
    }

    public void setImageCoords(float f, float f2, float f3, float f4) {
        this.photoImage.setImageCoords(f, f2, f3, f4);
        int i = this.documentAttachType;
        if (i == 4 || i == 2) {
            this.videoButtonX = (int) (this.photoImage.getImageX() + AndroidUtilities.dp(8.0f));
            int imageY = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(8.0f));
            this.videoButtonY = imageY;
            RadialProgress2 radialProgress2 = this.videoRadialProgress;
            int i2 = this.videoButtonX;
            radialProgress2.setProgressRect(i2, imageY, AndroidUtilities.dp(24.0f) + i2, this.videoButtonY + AndroidUtilities.dp(24.0f));
            this.buttonX = (int) (f + ((this.photoImage.getImageWidth() - AndroidUtilities.dp(48.0f)) / 2.0f));
            int imageY2 = (int) (this.photoImage.getImageY() + ((this.photoImage.getImageHeight() - AndroidUtilities.dp(48.0f)) / 2.0f));
            this.buttonY = imageY2;
            RadialProgress2 radialProgress22 = this.radialProgress;
            int i3 = this.buttonX;
            radialProgress22.setProgressRect(i3, imageY2, AndroidUtilities.dp(48.0f) + i3, this.buttonY + AndroidUtilities.dp(48.0f));
        }
    }

    public void setImageCoords(RectF rectF) {
        setImageCoords(rectF.left, rectF.top, rectF.width(), rectF.height());
    }

    public void setInvalidateListener(Runnable runnable) {
        this.invalidateListener = runnable;
    }

    public void setInvalidateSpoilersParent(boolean z) {
        this.invalidateSpoilersParent = z;
    }

    public void setInvalidatesParent(boolean z) {
        this.invalidatesParent = z;
    }

    public void setIsUpdating(boolean z) {
        this.isUpdating = true;
    }

    public void setLastTouchCoords(float f, float f2) {
        this.lastTouchX = f;
        this.lastTouchY = f2;
        this.backgroundDrawable.setTouchCoords(f + getTranslationX(), this.lastTouchY);
    }

    public void setMessageObject(MessageObject messageObject, MessageObject.GroupedMessages groupedMessages, boolean z, boolean z2, boolean z3) throws Resources.NotFoundException, NumberFormatException {
        if (this.attachedToWindow && !this.frozen) {
            setMessageContent(messageObject, groupedMessages, z, z2, z3);
            return;
        }
        this.messageObjectToSet = messageObject;
        this.groupedMessagesToSet = groupedMessages;
        this.bottomNearToSet = z;
        this.topNearToSet = z2;
        this.firstInChatToSet = z3;
    }

    public void setOverrideInvalidate(Runnable runnable) {
        this.overrideInvalidate = runnable;
    }

    public void setParentBounds(float f, int i) {
        this.parentBoundsTop = f;
        this.parentBoundsBottom = i;
        if (this.photoImageOutOfBounds) {
            float y = getY() + getPaddingTop() + this.photoImage.getImageY();
            if (this.photoImage.getImageHeight() + y < this.parentBoundsTop || y > this.parentBoundsBottom) {
                return;
            }
            invalidate();
        }
    }

    public void setParentViewSize(int i, int i2) {
        Theme.MessageDrawable messageDrawable;
        this.parentWidth = i;
        this.parentHeight = i2;
        this.backgroundHeight = i2;
        if (!(this.currentMessageObject != null && hasGradientService() && this.currentMessageObject.shouldDrawWithoutBackground()) && ((messageDrawable = this.currentBackgroundDrawable) == null || messageDrawable.getGradientShader() == null)) {
            return;
        }
        invalidate();
    }

    @Override // android.view.View
    public void setPressed(boolean z) {
        super.setPressed(z);
        updateRadialProgressBackground();
        if (this.useSeekBarWaveform) {
            this.seekBarWaveform.setSelected(isDrawSelectionBackground());
        } else {
            this.seekBar.setSelected(isDrawSelectionBackground());
        }
        invalidate();
    }

    public void setResourcesProvider(Theme.ResourcesProvider resourcesProvider) {
        this.resourcesProvider = resourcesProvider;
        RadialProgress2 radialProgress2 = this.radialProgress;
        if (radialProgress2 != null) {
            radialProgress2.setResourcesProvider(resourcesProvider);
        }
        RadialProgress2 radialProgress22 = this.videoRadialProgress;
        if (radialProgress22 != null) {
            radialProgress22.setResourcesProvider(resourcesProvider);
        }
        RoundVideoPlayingDrawable roundVideoPlayingDrawable = this.roundVideoPlayingDrawable;
        if (roundVideoPlayingDrawable != null) {
            roundVideoPlayingDrawable.setResourcesProvider(resourcesProvider);
        }
    }

    public void setScrimReaction(Integer num) {
        this.reactionsLayoutInBubble.setScrimReaction(num);
    }

    public void setSelectedBackgroundProgress(float f) {
        this.selectedBackgroundProgress = f;
        invalidate();
    }

    public void setShowTopic(boolean z) {
        if (this.showTopicSeparator != z) {
            this.showTopicSeparator = z;
            invalidateOutbounds();
            invalidate();
        }
    }

    public void setSlidingOffset(float f) {
        if (this.slidingOffsetX != f) {
            this.slidingOffsetX = f;
            updateTranslation();
        }
    }

    public void setSpoilersSuppressed(boolean z) {
        for (int i = 0; i < this.replySpoilers.size(); i++) {
            ((SpoilerEffect) this.replySpoilers.get(i)).setSuppressUpdates(z);
        }
        MessageObject.TextLayoutBlocks textLayoutBlocks = this.captionLayout;
        if (textLayoutBlocks != null && textLayoutBlocks.textLayoutBlocks != null) {
            for (int i2 = 0; i2 < this.captionLayout.textLayoutBlocks.size(); i2++) {
                MessageObject.TextLayoutBlock textLayoutBlock = this.captionLayout.textLayoutBlocks.get(i2);
                for (int i3 = 0; i3 < textLayoutBlock.spoilers.size(); i3++) {
                    textLayoutBlock.spoilers.get(i3).setSuppressUpdates(z);
                }
            }
        }
        if (getMessageObject() == null || getMessageObject().textLayoutBlocks == null) {
            return;
        }
        for (int i4 = 0; i4 < getMessageObject().textLayoutBlocks.size(); i4++) {
            MessageObject.TextLayoutBlock textLayoutBlock2 = getMessageObject().textLayoutBlocks.get(i4);
            for (int i5 = 0; i5 < textLayoutBlock2.spoilers.size(); i5++) {
                textLayoutBlock2.spoilers.get(i5).setSuppressUpdates(z);
            }
        }
    }

    public void setTimeAlpha(float f) {
        this.timeAlpha = f;
    }

    @Override // android.view.View
    public void setTranslationX(float f) {
        super.setTranslationX(f);
    }

    public void setVisibleOnScreen(boolean z, float f, float f2) {
        if (this.visibleOnScreen != z) {
            this.visibleOnScreen = z;
            checkImageReceiversAttachState();
            if (z) {
                invalidate();
            }
        }
        float imageY = f - this.photoImage.getImageY();
        float measuredHeight = f2 - (getMeasuredHeight() - this.photoImage.getImageY2());
        float imageHeight = this.photoImage.getImageHeight();
        if (imageY > BitmapDescriptorFactory.HUE_RED) {
            imageHeight -= imageY;
        }
        if (measuredHeight > BitmapDescriptorFactory.HUE_RED) {
            imageHeight -= measuredHeight;
        }
        ImageReceiver imageReceiver = this.photoImage;
        boolean z2 = imageHeight / imageReceiver.getImageHeight() < 0.25f;
        this.skipFrameUpdate = z2;
        imageReceiver.setSkipUpdateFrame(z2);
    }

    public void setVisiblePart(int i, int i2, int i3, float f, float f2, int i4, int i5, int i6, int i7) {
        MessageObject messageObject;
        this.childPosition = i;
        this.visibleHeight = i2;
        this.visibleParent = i3;
        this.parentWidth = i4;
        this.parentHeight = i5;
        this.visibleTop = f2;
        this.visibleParentOffset = f;
        this.backgroundHeight = i5;
        this.blurredViewTopOffset = i6;
        this.blurredViewBottomOffset = i7;
        if ((!this.botButtons.isEmpty() || (this.channelRecommendationsCell != null && (messageObject = this.currentMessageObject) != null && messageObject.type == 27)) && this.viewTop != f2) {
            invalidate();
        }
        this.viewTop = f2;
        if (i3 != this.parentHeight || f != this.parentViewTopOffset) {
            this.parentViewTopOffset = f;
            this.parentHeight = i3;
        }
        if (this.currentMessageObject != null && hasGradientService() && this.currentMessageObject.shouldDrawWithoutBackground()) {
            invalidate();
        }
        MessageObject messageObject2 = this.currentMessageObject;
        if (messageObject2 == null || messageObject2.textLayoutBlocks == null) {
            return;
        }
        int i8 = i - this.textY;
        int i9 = 0;
        for (int i10 = 0; i10 < this.currentMessageObject.textLayoutBlocks.size() && this.currentMessageObject.textLayoutBlocks.get(i10).textYOffset(this.currentMessageObject.textLayoutBlocks, this.transitionParams) <= i8; i10++) {
            i9 = i10;
        }
        int i11 = -1;
        int i12 = -1;
        int i13 = 0;
        while (i9 < this.currentMessageObject.textLayoutBlocks.size()) {
            float fTextYOffset = this.currentMessageObject.textLayoutBlocks.get(i9).textYOffset(this.currentMessageObject.textLayoutBlocks, this.transitionParams);
            float fHeight = r13.padTop + fTextYOffset + r13.height(this.transitionParams) + r13.padBottom;
            float f3 = i8;
            if (!intersect(fTextYOffset, fHeight, f3, i8 + i2)) {
                if (fTextYOffset > f3) {
                    break;
                }
            } else {
                if (i11 == -1) {
                    i11 = i9;
                }
                i13++;
                i12 = i9;
            }
            i9++;
        }
        if (this.lastVisibleBlockNum == i12 && this.firstVisibleBlockNum == i11 && this.totalVisibleBlocksCount == i13) {
            if (this.animatedEmojiStack != null) {
                for (int i14 = 0; i14 < this.animatedEmojiStack.holders.size(); i14++) {
                    AnimatedEmojiSpan.AnimatedEmojiHolder animatedEmojiHolder = (AnimatedEmojiSpan.AnimatedEmojiHolder) this.animatedEmojiStack.holders.get(i14);
                    if (animatedEmojiHolder == null || !animatedEmojiHolder.skipDraw || animatedEmojiHolder.outOfBounds((this.parentBoundsTop - getY()) - animatedEmojiHolder.drawingYOffset, (this.parentBoundsBottom - getY()) - animatedEmojiHolder.drawingYOffset)) {
                    }
                }
                return;
            }
            return;
        }
        this.lastVisibleBlockNum = i12;
        this.firstVisibleBlockNum = i11;
        this.totalVisibleBlocksCount = i13;
        invalidate();
    }

    public void setupTextColors() {
        TextPaint textPaint;
        TextPaint textPaint2;
        TextPaint textPaint3;
        TextPaint textPaint4;
        TextPaint textPaint5;
        TextPaint textPaint6;
        TextPaint textPaint7;
        int i;
        TextPaint textPaint8;
        int i2;
        int themedColor;
        SeekBar seekBar;
        int themedColor2;
        int themedColor3;
        int themedColor4;
        int themedColor5;
        int i3;
        int iAdaptHue;
        SeekBar seekBar2;
        int iAdaptHue2;
        int iAdaptHue3;
        int iAdaptHue4;
        int iAdaptHue5;
        int iAdaptHue6;
        if (this.currentMessageObject.isOutOwner()) {
            TextPaint textPaint9 = Theme.chat_msgTextPaint;
            int i4 = Theme.key_chat_messageTextOut;
            textPaint9.setColor(getThemedColor(i4));
            Theme.chat_msgGameTextPaint.setColor(getThemedColor(i4));
            Theme.chat_msgTextCodePaint.setColor(getThemedColor(i4));
            Theme.chat_msgTextCode2Paint.setColor(getThemedColor(i4));
            Theme.chat_msgTextCode3Paint.setColor(getThemedColor(i4));
            textPaint = Theme.chat_msgGameTextPaint;
            textPaint2 = Theme.chat_replyTextPaint;
            textPaint3 = Theme.chat_quoteTextPaint;
            textPaint4 = Theme.chat_msgTextPaint;
            textPaint5 = Theme.chat_msgTextCodePaint;
            textPaint6 = Theme.chat_msgTextCode2Paint;
            textPaint7 = Theme.chat_msgTextCode3Paint;
            i = Theme.key_chat_messageLinkOut;
        } else {
            TextPaint textPaint10 = Theme.chat_msgTextPaint;
            int i5 = Theme.key_chat_messageTextIn;
            textPaint10.setColor(getThemedColor(i5));
            Theme.chat_msgGameTextPaint.setColor(getThemedColor(i5));
            Theme.chat_msgTextCodePaint.setColor(getThemedColor(i5));
            Theme.chat_msgTextCode2Paint.setColor(getThemedColor(i5));
            Theme.chat_msgTextCode3Paint.setColor(getThemedColor(i5));
            textPaint = Theme.chat_msgGameTextPaint;
            textPaint2 = Theme.chat_replyTextPaint;
            textPaint3 = Theme.chat_quoteTextPaint;
            textPaint4 = Theme.chat_msgTextPaint;
            textPaint5 = Theme.chat_msgTextCodePaint;
            textPaint6 = Theme.chat_msgTextCode2Paint;
            textPaint7 = Theme.chat_msgTextCode3Paint;
            i = Theme.key_chat_messageLinkIn;
        }
        int themedColor6 = getThemedColor(i);
        textPaint7.linkColor = themedColor6;
        textPaint6.linkColor = themedColor6;
        textPaint5.linkColor = themedColor6;
        textPaint4.linkColor = themedColor6;
        textPaint3.linkColor = themedColor6;
        textPaint2.linkColor = themedColor6;
        textPaint.linkColor = themedColor6;
        if (this.documentAttach != null) {
            int i6 = this.documentAttachType;
            if (i6 == 3 || i6 == 7) {
                if (this.currentMessageObject.isOutOwner()) {
                    this.seekBarWaveform.setColors(getThemedColor(Theme.key_chat_outVoiceSeekbar), getThemedColor(Theme.key_chat_outVoiceSeekbarFill), getThemedColor(Theme.key_chat_outVoiceSeekbarSelected));
                    seekBar = this.seekBar;
                    themedColor2 = getThemedColor(Theme.key_chat_outAudioSeekbar);
                    themedColor3 = getThemedColor(Theme.key_chat_outAudioCacheSeekbar);
                    int i7 = Theme.key_chat_outAudioSeekbarFill;
                    themedColor4 = getThemedColor(i7);
                    themedColor5 = getThemedColor(i7);
                    i3 = Theme.key_chat_outAudioSeekbarSelected;
                } else if (!this.hasLinkPreview || this.linkLine == null) {
                    this.seekBarWaveform.setColors(getThemedColor(Theme.key_chat_inVoiceSeekbar), getThemedColor(Theme.key_chat_inVoiceSeekbarFill), getThemedColor(Theme.key_chat_inVoiceSeekbarSelected));
                    seekBar = this.seekBar;
                    themedColor2 = getThemedColor(Theme.key_chat_inAudioSeekbar);
                    themedColor3 = getThemedColor(Theme.key_chat_inAudioCacheSeekbar);
                    int i8 = Theme.key_chat_inAudioSeekbarFill;
                    themedColor4 = getThemedColor(i8);
                    themedColor5 = getThemedColor(i8);
                    i3 = Theme.key_chat_inAudioSeekbarSelected;
                } else {
                    this.seekBarWaveform.setColors(Theme.adaptHue(getThemedColor(Theme.key_chat_inVoiceSeekbar), this.linkLine.getColor()), Theme.adaptHue(getThemedColor(Theme.key_chat_inVoiceSeekbarFill), this.linkLine.getColor()), Theme.adaptHue(getThemedColor(Theme.key_chat_inVoiceSeekbarSelected), this.linkLine.getColor()));
                    seekBar = this.seekBar;
                    themedColor2 = Theme.adaptHue(getThemedColor(Theme.key_chat_inAudioSeekbar), this.linkLine.getColor());
                    themedColor3 = Theme.adaptHue(getThemedColor(Theme.key_chat_inAudioCacheSeekbar), this.linkLine.getColor());
                    int i9 = Theme.key_chat_inAudioSeekbarFill;
                    themedColor4 = Theme.adaptHue(getThemedColor(i9), this.linkLine.getColor());
                    themedColor5 = Theme.adaptHue(getThemedColor(i9), this.linkLine.getColor());
                    iAdaptHue = Theme.adaptHue(getThemedColor(Theme.key_chat_inAudioSeekbarSelected), this.linkLine.getColor());
                    seekBar.setColors(themedColor2, themedColor3, themedColor4, themedColor5, iAdaptHue);
                }
                iAdaptHue = getThemedColor(i3);
                seekBar.setColors(themedColor2, themedColor3, themedColor4, themedColor5, iAdaptHue);
            } else if (i6 == 5) {
                if (this.currentMessageObject.isOutOwner()) {
                    seekBar2 = this.seekBar;
                    iAdaptHue2 = getThemedColor(Theme.key_chat_outAudioSeekbar);
                    iAdaptHue3 = getThemedColor(Theme.key_chat_outAudioCacheSeekbar);
                    int i10 = Theme.key_chat_outAudioSeekbarFill;
                    iAdaptHue4 = getThemedColor(i10);
                    iAdaptHue5 = getThemedColor(i10);
                    iAdaptHue6 = getThemedColor(Theme.key_chat_outAudioSeekbarSelected);
                } else if (!this.hasLinkPreview || this.linkLine == null) {
                    SeekBar seekBar3 = this.seekBar;
                    int themedColor7 = getThemedColor(Theme.key_chat_inAudioSeekbar);
                    int themedColor8 = getThemedColor(Theme.key_chat_inAudioCacheSeekbar);
                    int i11 = Theme.key_chat_inAudioSeekbarFill;
                    seekBar3.setColors(themedColor7, themedColor8, getThemedColor(i11), getThemedColor(i11), getThemedColor(Theme.key_chat_inAudioSeekbarSelected));
                } else {
                    seekBar2 = this.seekBar;
                    iAdaptHue2 = Theme.adaptHue(getThemedColor(Theme.key_chat_inAudioSeekbar), this.linkLine.getColor());
                    iAdaptHue3 = Theme.adaptHue(getThemedColor(Theme.key_chat_inAudioCacheSeekbar), this.linkLine.getColor());
                    int i12 = Theme.key_chat_inAudioSeekbarFill;
                    iAdaptHue4 = Theme.adaptHue(getThemedColor(i12), this.linkLine.getColor());
                    iAdaptHue5 = Theme.adaptHue(getThemedColor(i12), this.linkLine.getColor());
                    iAdaptHue6 = Theme.adaptHue(getThemedColor(Theme.key_chat_inAudioSeekbarSelected), this.linkLine.getColor());
                }
                seekBar2.setColors(iAdaptHue2, iAdaptHue3, iAdaptHue4, iAdaptHue5, iAdaptHue6);
            }
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject.type == 5) {
            textPaint8 = Theme.chat_timePaint;
            themedColor = ColorUtils.blendARGB(getThemedColor(Theme.key_chat_serviceText), getThemedColor(isDrawSelectionBackground() ? this.currentMessageObject.isOutOwner() ? Theme.key_chat_outTimeSelectedText : Theme.key_chat_inTimeSelectedText : this.currentMessageObject.isOutOwner() ? Theme.key_chat_outTimeText : Theme.key_chat_inTimeText), getVideoTranscriptionProgress());
        } else {
            if (this.mediaBackground) {
                if (messageObject.shouldDrawWithoutBackground()) {
                    textPaint8 = Theme.chat_timePaint;
                    i2 = Theme.key_chat_serviceText;
                } else {
                    textPaint8 = Theme.chat_timePaint;
                    i2 = Theme.key_chat_mediaTimeText;
                }
            } else if (messageObject.isOutOwner()) {
                textPaint8 = Theme.chat_timePaint;
                i2 = isDrawSelectionBackground() ? Theme.key_chat_outTimeSelectedText : Theme.key_chat_outTimeText;
            } else {
                textPaint8 = Theme.chat_timePaint;
                i2 = isDrawSelectionBackground() ? Theme.key_chat_inTimeSelectedText : Theme.key_chat_inTimeText;
            }
            themedColor = getThemedColor(i2);
        }
        textPaint8.setColor(themedColor);
    }

    public void shakeView() {
        PropertyValuesHolder propertyValuesHolderOfKeyframe = PropertyValuesHolder.ofKeyframe(View.ROTATION, Keyframe.ofFloat(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED), Keyframe.ofFloat(0.2f, 3.0f), Keyframe.ofFloat(0.4f, -3.0f), Keyframe.ofFloat(0.6f, 3.0f), Keyframe.ofFloat(0.8f, -3.0f), Keyframe.ofFloat(1.0f, BitmapDescriptorFactory.HUE_RED));
        Keyframe keyframeOfFloat = Keyframe.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f);
        Keyframe keyframeOfFloat2 = Keyframe.ofFloat(0.5f, 0.97f);
        Keyframe keyframeOfFloat3 = Keyframe.ofFloat(1.0f, 1.0f);
        PropertyValuesHolder propertyValuesHolderOfKeyframe2 = PropertyValuesHolder.ofKeyframe(View.SCALE_X, keyframeOfFloat, keyframeOfFloat2, keyframeOfFloat3);
        PropertyValuesHolder propertyValuesHolderOfKeyframe3 = PropertyValuesHolder.ofKeyframe(View.SCALE_Y, keyframeOfFloat, keyframeOfFloat2, keyframeOfFloat3);
        AnimatorSet animatorSet = new AnimatorSet();
        this.shakeAnimation = animatorSet;
        animatorSet.playTogether(ObjectAnimator.ofPropertyValuesHolder(this, propertyValuesHolderOfKeyframe), ObjectAnimator.ofPropertyValuesHolder(this, propertyValuesHolderOfKeyframe2), ObjectAnimator.ofPropertyValuesHolder(this, propertyValuesHolderOfKeyframe3));
        this.shakeAnimation.setDuration(500L);
        this.shakeAnimation.start();
    }

    public boolean shouldDrawAlphaLayer() {
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        return (groupedMessages == null || !groupedMessages.transitionParams.backgroundChangeBounds) && getAlpha() != 1.0f;
    }

    /* JADX WARN: Removed duplicated region for block: B:23:0x0032  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public boolean shouldDrawTimeOnMedia() {
        MessageObject messageObject;
        int i = this.overideShouldDrawTimeOnMedia;
        if (i != 0) {
            return i == 1;
        }
        if (this.mediaBackground && (this.captionLayout == null || this.captionAbove)) {
            ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
            if (!reactionsLayoutInBubble.isEmpty && !reactionsLayoutInBubble.isSmall && ((messageObject = this.currentMessageObject) == null || (!messageObject.isAnyKindOfSticker() && !this.currentMessageObject.isRoundVideo()))) {
            }
        } else {
            MessageObject messageObject2 = this.currentMessageObject;
            if (messageObject2 == null || messageObject2.type != 29) {
                return false;
            }
        }
        return true;
    }

    public void showHintButton(boolean z, boolean z2, int i) {
        float f = BitmapDescriptorFactory.HUE_RED;
        if (i == -1 || i == 0) {
            if (this.hintButtonVisible == z) {
                return;
            }
            this.hintButtonVisible = z;
            if (z2) {
                invalidate();
            } else {
                this.hintButtonProgress = z ? 1.0f : BitmapDescriptorFactory.HUE_RED;
            }
        }
        if ((i == -1 || i == 1) && this.psaButtonVisible != z) {
            this.psaButtonVisible = z;
            if (z2) {
                setInvalidatesParent(true);
                invalidate();
            } else {
                if (z) {
                    f = 1.0f;
                }
                this.psaButtonProgress = f;
            }
        }
    }

    public void startRevealMedia() throws Resources.NotFoundException, NumberFormatException {
        startRevealMedia(this.photoImage.getImageX() + (this.photoImage.getImageWidth() / 2.0f), this.photoImage.getImageY() + (this.photoImage.getImageHeight() / 2.0f));
    }

    public void startRevealMedia(float f, float f2) throws Resources.NotFoundException, NumberFormatException {
        float fSqrt = (float) Math.sqrt(Math.pow(this.photoImage.getImageWidth(), 2.0d) + Math.pow(this.photoImage.getImageHeight(), 2.0d));
        this.mediaSpoilerRevealMaxRadius = fSqrt;
        startRevealMedia(f, f2, fSqrt);
    }

    public void syncTodoCheck(int i, ChatMessageCell chatMessageCell) {
        CheckBoxBase checkBoxBase;
        CheckBoxBase[] checkBoxBaseArr;
        CheckBoxBase checkBoxBase2;
        CheckBoxBase[] checkBoxBaseArr2 = this.pollCheckBox;
        if (checkBoxBaseArr2 == null || i < 0 || i >= checkBoxBaseArr2.length || (checkBoxBase = checkBoxBaseArr2[i]) == null || chatMessageCell == null || (checkBoxBaseArr = chatMessageCell.pollCheckBox) == null || i < 0 || i >= checkBoxBaseArr.length || (checkBoxBase2 = checkBoxBaseArr[i]) == null) {
            return;
        }
        checkBoxBase.cancelCheckAnimator();
        checkBoxBase.setProgress(checkBoxBase2.getProgress());
        checkBoxBase.setChecked(checkBoxBase2.isChecked(), true);
    }

    public void toggleTodoCheck(int i, boolean z) {
        if (i < 0 || i >= this.pollButtons.size()) {
            return;
        }
        PollButton pollButton = (PollButton) this.pollButtons.get(i);
        if (!this.delegate.didPressToDoButton(this, pollButton.task, !pollButton.chosen)) {
            this.pollVoteInProgress = false;
            return;
        }
        if (z) {
            try {
                performHapticFeedback(3, 2);
            } catch (Exception unused) {
            }
        }
        TLRPC.TL_messageMediaToDo tL_messageMediaToDo = (TLRPC.TL_messageMediaToDo) MessageObject.getMedia(this.currentMessageObject);
        MessageObject.toggleTodo(tL_messageMediaToDo, pollButton.task.id, !pollButton.chosen, UserConfig.getInstance(this.currentAccount).getClientUserId(), ConnectionsManager.getInstance(this.currentAccount).getCurrentTime());
        if (!pollButton.chosen) {
            TLRPC.User currentUser = UserConfig.getInstance(this.currentAccount).getCurrentUser();
            pollButton.avatarDrawable.setInfo(currentUser);
            pollButton.avatarImageReceiver.setForUserOrChat(currentUser, pollButton.avatarDrawable);
            pollButton.author = new Text(DialogObject.getName(currentUser), 12.0f);
        }
        this.pollCheckBox[i].setChecked(!pollButton.chosen, true);
        if (this.animatedInfoLayout != null) {
            if (this.currentMessageObject.isOutOwner() || this.currentMessageObject.getDialogId() < 0 || tL_messageMediaToDo.todo.others_can_complete) {
                this.animatedInfoLayout.setText(LocaleController.formatPluralStringComma("TodoCompleted", tL_messageMediaToDo.todo.list.size(), Integer.valueOf(MessageObject.getCompletionsCount(tL_messageMediaToDo))));
            } else {
                this.animatedInfoLayout.setText(LocaleController.formatPluralStringComma("TodoCompletedBy", tL_messageMediaToDo.todo.list.size(), Integer.valueOf(MessageObject.getCompletionsCount(tL_messageMediaToDo)), DialogObject.getName(this.currentMessageObject.getFromChatId())));
            }
        }
        pollButton.chosen = !pollButton.chosen;
        invalidate();
    }

    public void updateAnimatedEmojis() {
        MessageObject messageObject;
        AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpansUpdate;
        ArrayList<MessageObject.TextLayoutBlock> arrayList;
        if (!this.imageReceiversAttachState || (messageObject = this.currentMessageObject) == null) {
            return;
        }
        int cacheTypeForEnterView = messageObject.wasJustSent ? AnimatedEmojiDrawable.getCacheTypeForEnterView() : 0;
        MessageObject.TextLayoutBlocks textLayoutBlocks = this.captionLayout;
        if (textLayoutBlocks == null || (arrayList = textLayoutBlocks.textLayoutBlocks) == null) {
            ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
            emojiGroupedSpansUpdate = AnimatedEmojiSpan.update(cacheTypeForEnterView, this, chatMessageCellDelegate == null || !chatMessageCellDelegate.canDrawOutboundsContent(), this.animatedEmojiStack, this.currentMessageObject.textLayoutBlocks);
        } else {
            emojiGroupedSpansUpdate = AnimatedEmojiSpan.update(cacheTypeForEnterView, (View) this, false, this.animatedEmojiStack, arrayList);
        }
        this.animatedEmojiStack = emojiGroupedSpansUpdate;
    }

    /*  JADX ERROR: JadxRuntimeException in pass: IfRegionVisitor
        jadx.core.utils.exceptions.JadxRuntimeException: Can't remove SSA var: r1v15 org.telegram.tgnet.TLObject, still in use, count: 2, list:
          (r1v15 org.telegram.tgnet.TLObject) from 0x006d: IF  (r1v15 org.telegram.tgnet.TLObject) != (null org.telegram.tgnet.TLObject)  -> B:25:0x004a A[HIDDEN]
          (r1v15 org.telegram.tgnet.TLObject) from 0x004a: PHI (r1v152 org.telegram.tgnet.TLObject) = (r1v15 org.telegram.tgnet.TLObject), (r1v16 org.telegram.tgnet.TLObject), (r1v154 org.telegram.tgnet.TLObject) binds: [B:39:0x006d, B:37:0x0068, B:22:0x0042] A[DONT_GENERATE, DONT_INLINE]
        	at jadx.core.utils.InsnRemover.removeSsaVar(InsnRemover.java:162)
        	at jadx.core.utils.InsnRemover.unbindResult(InsnRemover.java:127)
        	at jadx.core.dex.visitors.regions.TernaryMod.makeTernaryInsn(TernaryMod.java:125)
        	at jadx.core.dex.visitors.regions.TernaryMod.processRegion(TernaryMod.java:62)
        	at jadx.core.dex.visitors.regions.TernaryMod.enterRegion(TernaryMod.java:45)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.traverseInternal(DepthRegionTraversal.java:67)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.lambda$traverseInternal$0(DepthRegionTraversal.java:68)
        	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.traverseInternal(DepthRegionTraversal.java:68)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.lambda$traverseInternal$0(DepthRegionTraversal.java:68)
        	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
        	at java.base/java.util.Collections$UnmodifiableCollection.forEach(Collections.java:1092)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.traverseInternal(DepthRegionTraversal.java:68)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.lambda$traverseInternal$0(DepthRegionTraversal.java:68)
        	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.traverseInternal(DepthRegionTraversal.java:68)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.lambda$traverseInternal$0(DepthRegionTraversal.java:68)
        	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
        	at java.base/java.util.Collections$UnmodifiableCollection.forEach(Collections.java:1092)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.traverseInternal(DepthRegionTraversal.java:68)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.lambda$traverseInternal$0(DepthRegionTraversal.java:68)
        	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.traverseInternal(DepthRegionTraversal.java:68)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.lambda$traverseInternal$0(DepthRegionTraversal.java:68)
        	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
        	at java.base/java.util.Collections$UnmodifiableCollection.forEach(Collections.java:1092)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.traverseInternal(DepthRegionTraversal.java:68)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.lambda$traverseInternal$0(DepthRegionTraversal.java:68)
        	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.traverseInternal(DepthRegionTraversal.java:68)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.lambda$traverseInternal$0(DepthRegionTraversal.java:68)
        	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
        	at java.base/java.util.Collections$UnmodifiableCollection.forEach(Collections.java:1092)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.traverseInternal(DepthRegionTraversal.java:68)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.lambda$traverseInternal$0(DepthRegionTraversal.java:68)
        	at java.base/java.util.ArrayList.forEach(ArrayList.java:1511)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.traverseInternal(DepthRegionTraversal.java:68)
        	at jadx.core.dex.visitors.regions.DepthRegionTraversal.traverse(DepthRegionTraversal.java:19)
        	at jadx.core.dex.visitors.regions.TernaryMod.process(TernaryMod.java:35)
        	at jadx.core.dex.visitors.regions.IfRegionVisitor.process(IfRegionVisitor.java:34)
        	at jadx.core.dex.visitors.regions.IfRegionVisitor.visit(IfRegionVisitor.java:30)
        */
    /* JADX WARN: Removed duplicated region for block: B:102:0x0134  */
    /* JADX WARN: Removed duplicated region for block: B:105:0x013e  */
    /* JADX WARN: Removed duplicated region for block: B:167:0x020b  */
    /* JADX WARN: Removed duplicated region for block: B:227:0x032e  */
    /* JADX WARN: Removed duplicated region for block: B:378:0x0569  */
    /* JADX WARN: Removed duplicated region for block: B:427:0x060a  */
    /* JADX WARN: Removed duplicated region for block: B:444:0x0644  */
    /* JADX WARN: Removed duplicated region for block: B:451:0x065e  */
    /* JADX WARN: Removed duplicated region for block: B:460:0x0674  */
    /* JADX WARN: Removed duplicated region for block: B:463:0x0683  */
    /* JADX WARN: Removed duplicated region for block: B:60:0x00b3  */
    /* JADX WARN: Removed duplicated region for block: B:63:0x00bb  */
    /* JADX WARN: Removed duplicated region for block: B:66:0x00cf  */
    /* JADX WARN: Removed duplicated region for block: B:69:0x00d8  */
    /* JADX WARN: Removed duplicated region for block: B:71:0x00e0  */
    /* JADX WARN: Removed duplicated region for block: B:84:0x0103  */
    /* JADX WARN: Removed duplicated region for block: B:98:0x012b  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void updateButtonState(boolean r18, boolean r19, boolean r20) {
        /*
            Method dump skipped, instructions count: 2215
            To view this dump add '--comments-level debug' option
        */
        throw new UnsupportedOperationException("Method not decompiled: org.telegram.ui.Cells.ChatMessageCell.updateButtonState(boolean, boolean, boolean):void");
    }

    public void updateCaptionLayout() {
        float imageX;
        float imageY;
        float imageHeight;
        float f;
        int i;
        float fDp;
        int iDp;
        int iDp2;
        MessageObject messageObject = this.currentMessageObject;
        int i2 = messageObject.type;
        boolean z = true;
        if (i2 == 1 || i2 == 20 || this.documentAttachType == 4 || i2 == 8 || i2 == 23) {
            TransitionParams transitionParams = this.transitionParams;
            if (transitionParams.imageChangeBoundsTransition) {
                imageX = transitionParams.animateToImageX;
                imageY = transitionParams.animateToImageY;
                imageHeight = transitionParams.animateToImageH;
            } else {
                imageX = this.photoImage.getImageX();
                imageY = this.photoImage.getImageY();
                imageHeight = this.photoImage.getImageHeight();
            }
            this.captionX = imageX + AndroidUtilities.dp(5.0f) + this.captionOffsetX;
            float fDp2 = imageY + imageHeight + AndroidUtilities.dp(6.0f);
            this.captionY = imageY + AndroidUtilities.lerp(imageHeight + AndroidUtilities.dp(6.0f), (this.captionLayout == null ? 0 : -r6.textHeight()) - AndroidUtilities.dp(4.0f), mediaAbove());
            f = fDp2;
            z = false;
        } else {
            boolean z2 = this.hasOldCaptionPreview;
            float f2 = 43.0f;
            float f3 = BitmapDescriptorFactory.HUE_RED;
            if (z2) {
                this.captionX = this.backgroundDrawableLeft + AndroidUtilities.dp(messageObject.isOutOwner() ? 11.0f : 17.0f) + this.captionOffsetX;
                iDp = (((this.totalHeight - this.captionHeight) - AndroidUtilities.dp(this.drawPinnedTop ? 9.0f : 10.0f)) - this.linkPreviewHeight) - AndroidUtilities.dp(17.0f);
                if (!this.drawCommentButton || this.drawSideButton == 3) {
                    f2 = BitmapDescriptorFactory.HUE_RED;
                } else if (shouldDrawTimeOnMedia()) {
                    f2 = 41.3f;
                }
                iDp2 = AndroidUtilities.dp(f2);
            } else {
                if (this.isRoundVideo) {
                    fDp = getBackgroundDrawableLeft() + AndroidUtilities.dp((this.currentMessageObject.isOutOwner() ? 0 : 6) + 11);
                } else {
                    int i3 = this.backgroundDrawableLeft;
                    if (!messageObject.isOutOwner() && !this.mediaBackground && !this.drawPinnedBottom) {
                        f = 17.0f;
                    }
                    fDp = i3 + AndroidUtilities.dp(f) + this.captionOffsetX;
                }
                this.captionX = fDp;
                int iDp3 = (this.totalHeight - this.captionHeight) - AndroidUtilities.dp(this.drawPinnedTop ? 9.0f : 10.0f);
                if (!this.drawCommentButton || this.drawSideButton == 3) {
                    f2 = BitmapDescriptorFactory.HUE_RED;
                } else if (shouldDrawTimeOnMedia()) {
                    f2 = 41.3f;
                }
                iDp = iDp3 - AndroidUtilities.dp(f2);
                ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                if (reactionsLayoutInBubble.isEmpty || reactionsLayoutInBubble.isSmall) {
                    iDp2 = 0;
                } else {
                    if (this.currentMessageObject.type == 9 && this.currentPosition == null) {
                        f3 = 10.0f;
                    }
                    iDp2 = AndroidUtilities.dp(f3) + this.reactionsLayoutInBubble.totalHeight;
                }
            }
            f = iDp - iDp2;
            this.captionY = AndroidUtilities.lerp(f, AndroidUtilities.dp(9.0f) + this.namesOffset, mediaAbove());
        }
        this.captionX += getExtraTextX();
        MessageObject messageObject2 = this.currentMessageObject;
        if (messageObject2 == null || (i = messageObject2.type) == 0 || i == 24 || messageObject2.isGiveawayOrGiveawayResults() || this.currentMessageObject.isSponsored()) {
            return;
        }
        if (z && this.hasFactCheck) {
            this.captionY -= (this.factCheckHeight + AndroidUtilities.dp(16.0f)) * (1.0f - mediaAbove());
        }
        this.factCheckY = (int) (((f - (z ? this.factCheckHeight + AndroidUtilities.dp(14.0f) : 0)) + AndroidUtilities.lerp(this.captionLayout != null ? r1.textHeight(this.transitionParams) + AndroidUtilities.dp(4.0f) : 0, AndroidUtilities.dp(6.0f), mediaAbove())) - this.transitionParams.deltaTop);
    }

    /* JADX WARN: Removed duplicated region for block: B:78:0x0153  */
    /* JADX WARN: Removed duplicated region for block: B:79:0x0155  */
    /* JADX WARN: Removed duplicated region for block: B:84:0x0174  */
    /* JADX WARN: Removed duplicated region for block: B:87:0x01a4  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void updatePlayingMessageProgress() {
        StaticLayout staticLayout;
        double dMax;
        long j;
        float f;
        double duration;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            return;
        }
        OldVideoPlayerRewinder oldVideoPlayerRewinder = this.videoPlayerRewinder;
        if (oldVideoPlayerRewinder != null && oldVideoPlayerRewinder.rewindCount != 0 && oldVideoPlayerRewinder.rewindByBackSeek) {
            messageObject.audioProgress = oldVideoPlayerRewinder.getVideoProgress();
        }
        double d = 0.0d;
        if (this.documentAttachType == 4) {
            SeekBar seekBar = this.seekBar;
            if (seekBar != null) {
                seekBar.clearTimestamps();
            }
            if (this.infoLayout == null || !(PhotoViewer.isPlayingMessage(this.currentMessageObject) || MediaController.getInstance().isGoingToShowMessageObject(this.currentMessageObject))) {
                AnimatedFileDrawable animation = this.photoImage.getAnimation();
                if (animation != null) {
                    MessageObject messageObject2 = this.currentMessageObject;
                    int durationMs = animation.getDurationMs() / 1000;
                    messageObject2.audioPlayerDuration = durationMs;
                    duration = durationMs;
                    MessageObject messageObject3 = this.currentMessageObject;
                    TLRPC.Message message = messageObject3.messageOwner;
                    if (message.ttl > 0 && message.destroyTime == 0 && !messageObject3.needDrawBluredPreview() && this.currentMessageObject.isVideo() && animation.hasBitmap()) {
                        this.delegate.didStartVideoStream(this.currentMessageObject);
                    }
                } else {
                    duration = 0.0d;
                }
                if (duration == 0.0d) {
                    duration = this.currentMessageObject.getDuration();
                }
                if (MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                    double d2 = this.currentMessageObject.audioProgress;
                    Double.isNaN(d2);
                    duration -= d2 * duration;
                } else if (animation != null) {
                    if (duration != 0.0d) {
                        double currentProgressMs = animation.getCurrentProgressMs() / 1000;
                        Double.isNaN(currentProgressMs);
                        duration -= currentProgressMs;
                    }
                    if (this.delegate != null && animation.getCurrentProgressMs() >= 3000) {
                        this.delegate.videoTimerReached();
                    }
                }
                if (this.lastTime != duration) {
                    String shortDuration = AndroidUtilities.formatShortDuration((int) duration);
                    this.infoWidth = (int) Math.ceil(Theme.chat_infoPaint.measureText(shortDuration));
                    this.infoLayout = new StaticLayout(shortDuration, Theme.chat_infoPaint, this.infoWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                    this.lastTime = duration;
                    return;
                }
                return;
            }
            return;
        }
        if (this.isRoundVideo) {
            if (!this.useSeekBarWaveform) {
                if (!this.seekBar.isDragging()) {
                    this.seekBar.setProgress(this.currentMessageObject.audioProgress);
                    this.seekBar.setBufferedProgress(this.currentMessageObject.bufferedProgress);
                }
                this.seekBar.clearTimestamps();
            } else if (!this.seekBarWaveform.isDragging()) {
                this.seekBarWaveform.setProgress(this.currentMessageObject.audioProgress, true);
            }
            TLRPC.Document document = this.currentMessageObject.getDocument();
            if (document != null) {
                while (i < document.attributes.size()) {
                    TLRPC.DocumentAttribute documentAttribute = document.attributes.get(i);
                    if (documentAttribute instanceof TLRPC.TL_documentAttributeVideo) {
                        dMax = documentAttribute.duration;
                        break;
                    }
                    i++;
                }
                dMax = 0.0d;
                j = this.overridenDuration;
                if (j < 0) {
                    dMax = j;
                } else if (MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                    double d3 = this.currentMessageObject.audioProgressSec;
                    Double.isNaN(d3);
                    dMax = Math.max(0.0d, dMax - d3);
                }
                if (this.lastTime != dMax) {
                    this.lastTime = dMax;
                    String longDuration = AndroidUtilities.formatLongDuration((int) dMax);
                    this.timeWidthAudio = (int) Math.ceil(Theme.chat_timePaint.measureText(longDuration));
                    this.durationLayout = new StaticLayout(longDuration, Theme.chat_timePaint, this.timeWidthAudio, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                }
                f = this.currentMessageObject.audioProgress;
                if (f != BitmapDescriptorFactory.HUE_RED) {
                    this.lastDrawingAudioProgress = f;
                    if (f > 0.9f) {
                        this.lastDrawingAudioProgress = 1.0f;
                    }
                }
            } else {
                dMax = 0.0d;
                j = this.overridenDuration;
                if (j < 0) {
                }
                if (this.lastTime != dMax) {
                }
                f = this.currentMessageObject.audioProgress;
                if (f != BitmapDescriptorFactory.HUE_RED) {
                }
            }
        } else {
            if (this.documentAttach == null) {
                return;
            }
            if (!this.useSeekBarWaveform) {
                if (!this.seekBar.isDragging()) {
                    this.seekBar.setProgress(this.currentMessageObject.audioProgress);
                    this.seekBar.setBufferedProgress(this.currentMessageObject.bufferedProgress);
                }
                this.seekBar.updateTimestamps(this.currentMessageObject, null);
            } else if (!this.seekBarWaveform.isDragging()) {
                this.seekBarWaveform.setProgress(this.currentMessageObject.audioProgress, true);
            }
            if (this.documentAttachType == 3) {
                long j2 = this.overridenDuration;
                if (j2 >= 0) {
                    d = j2;
                } else if (!MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                    while (true) {
                        if (i >= this.documentAttach.attributes.size()) {
                            break;
                        }
                        TLRPC.DocumentAttribute documentAttribute2 = this.documentAttach.attributes.get(i);
                        if (documentAttribute2 instanceof TLRPC.TL_documentAttributeAudio) {
                            d = documentAttribute2.duration;
                            break;
                        }
                        i++;
                    }
                } else {
                    d = this.currentMessageObject.audioProgressSec;
                }
                if (this.lastTime != d) {
                    this.lastTime = d;
                    String longDuration2 = AndroidUtilities.formatLongDuration((int) d);
                    this.timeWidthAudio = (int) Math.ceil(Theme.chat_audioTimePaint.measureText(longDuration2));
                    staticLayout = new StaticLayout(longDuration2, Theme.chat_audioTimePaint, this.timeWidthAudio, Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                    this.durationLayout = staticLayout;
                }
            } else {
                double duration2 = this.currentMessageObject.getDuration();
                i = MediaController.getInstance().isPlayingMessage(this.currentMessageObject) ? this.currentMessageObject.audioProgressSec : 0;
                double d4 = i;
                if (this.lastTime != d4) {
                    this.lastTime = d4;
                    staticLayout = new StaticLayout(AndroidUtilities.formatShortDuration(i, (int) duration2), Theme.chat_audioTimePaint, (int) Math.ceil(Theme.chat_audioTimePaint.measureText(r3)), Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
                    this.durationLayout = staticLayout;
                }
            }
        }
        invalidate();
    }

    public void updateProgressLoadingLink() {
        MessageObject messageObject;
        ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
        if (chatMessageCellDelegate == null) {
            return;
        }
        if (!chatMessageCellDelegate.isProgressLoading(this, 1)) {
            this.progressLoadingLink = null;
            ArrayList arrayList = this.progressLoadingLinkDrawables;
            if (arrayList == null || arrayList.isEmpty()) {
                return;
            }
            for (int i = 0; i < this.progressLoadingLinkDrawables.size(); i++) {
                LoadingDrawableLocation loadingDrawableLocation = (LoadingDrawableLocation) this.progressLoadingLinkDrawables.get(i);
                if (!loadingDrawableLocation.drawable.isDisappearing()) {
                    loadingDrawableLocation.drawable.disappear();
                }
            }
            return;
        }
        CharacterStyle progressLoadingLink = this.delegate.getProgressLoadingLink(this);
        if (progressLoadingLink == this.progressLoadingLink) {
            return;
        }
        this.progressLoadingLink = progressLoadingLink;
        LoadingDrawable loadingDrawable = this.progressLoadingLinkCurrentDrawable;
        if (loadingDrawable != null) {
            loadingDrawable.disappear();
            this.progressLoadingLinkCurrentDrawable = null;
        }
        LoadingDrawable loadingDrawable2 = new LoadingDrawable();
        this.progressLoadingLinkCurrentDrawable = loadingDrawable2;
        loadingDrawable2.setAppearByGradient(true);
        LinkPath linkPath = new LinkPath(true);
        this.progressLoadingLinkCurrentDrawable.usePath(linkPath);
        this.progressLoadingLinkCurrentDrawable.setRadiiDp(5.0f);
        LoadingDrawableLocation loadingDrawableLocation2 = new LoadingDrawableLocation();
        loadingDrawableLocation2.drawable = this.progressLoadingLinkCurrentDrawable;
        loadingDrawableLocation2.blockNum = -3;
        if (this.progressLoadingLinkDrawables == null) {
            this.progressLoadingLinkDrawables = new ArrayList();
        }
        this.progressLoadingLinkDrawables.add(loadingDrawableLocation2);
        if (this.progressLoadingLink == null || findProgressLoadingLink(loadingDrawableLocation2, linkPath, this.descriptionLayout, BitmapDescriptorFactory.HUE_RED, -2)) {
            return;
        }
        MessageObject.TextLayoutBlocks textLayoutBlocks = this.captionLayout;
        if ((textLayoutBlocks == null || !findProgressLoadingLink(loadingDrawableLocation2, linkPath, textLayoutBlocks.textLayoutBlocks)) && (messageObject = this.currentMessageObject) != null) {
            findProgressLoadingLink(loadingDrawableLocation2, linkPath, messageObject.textLayoutBlocks);
        }
    }

    public void updateTranslation() {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            return;
        }
        float fDp = this.slidingOffsetX + this.animationOffsetX;
        if (!messageObject.isOutOwner() || this.currentMessageObject.hasWideCode) {
            fDp += this.checkBoxTranslation;
        }
        if (this.isSideMenued && !this.currentMessageObject.isOutOwner() && this.currentPosition != null) {
            fDp += AndroidUtilities.dp(64 - (needDrawAvatar() ? 48 : 0)) * this.sideMenuAlpha;
        }
        setTranslationX(fDp);
    }

    @Override // android.view.View
    protected boolean verifyDrawable(Drawable drawable) {
        ReactionsLayoutInBubble reactionsLayoutInBubble;
        if (!super.verifyDrawable(drawable)) {
            Drawable[] drawableArr = this.selectorDrawable;
            if (drawable != drawableArr[0] && drawable != this.animatedInfoLayout && drawable != drawableArr[1] && drawable != this.linkPreviewSelector && drawable != this.nameLayoutSelector && drawable != this.replySelector && (((reactionsLayoutInBubble = this.reactionsLayoutInBubble) == null || !reactionsLayoutInBubble.verifyDrawable(drawable)) && !(drawable instanceof LoadingDrawable))) {
                for (int i = 0; i < this.pollButtons.size(); i++) {
                    if (((PollButton) this.pollButtons.get(i)).selectorDrawable == drawable) {
                        return true;
                    }
                }
                return false;
            }
        }
        return true;
    }

    public boolean willRemovedAfterAnimation() {
        return this.willRemoved;
    }
}
