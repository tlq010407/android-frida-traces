package org.telegram.ui;

import android.animation.Animator;
import android.animation.AnimatorListenerAdapter;
import android.animation.AnimatorSet;
import android.animation.ArgbEvaluator;
import android.animation.ObjectAnimator;
import android.animation.TimeInterpolator;
import android.animation.ValueAnimator;
import android.app.Activity;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.SharedPreferences;
import android.content.res.Configuration;
import android.content.res.Resources;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.ColorMatrixColorFilter;
import android.graphics.Insets;
import android.graphics.LinearGradient;
import android.graphics.Matrix;
import android.graphics.Outline;
import android.graphics.Paint;
import android.graphics.Path;
import android.graphics.Point;
import android.graphics.PorterDuff;
import android.graphics.PorterDuffColorFilter;
import android.graphics.PorterDuffXfermode;
import android.graphics.RecordingCanvas;
import android.graphics.Rect;
import android.graphics.RectF;
import android.graphics.RenderEffect;
import android.graphics.RenderNode;
import android.graphics.Shader;
import android.graphics.SurfaceTexture;
import android.graphics.drawable.BitmapDrawable;
import android.graphics.drawable.ColorDrawable;
import android.graphics.drawable.Drawable;
import android.graphics.drawable.GradientDrawable;
import android.media.AudioManager;
import android.media.MediaCodec;
import android.media.MediaCodecInfo;
import android.net.Uri;
import android.os.Build;
import android.os.Bundle;
import android.os.SystemClock;
import android.text.Layout;
import android.text.Spannable;
import android.text.SpannableString;
import android.text.SpannableStringBuilder;
import android.text.Spanned;
import android.text.StaticLayout;
import android.text.TextPaint;
import android.text.TextUtils;
import android.text.style.ClickableSpan;
import android.text.style.ForegroundColorSpan;
import android.text.style.LineHeightSpan;
import android.text.style.URLSpan;
import android.transition.ChangeBounds;
import android.transition.Fade;
import android.transition.Transition;
import android.transition.TransitionManager;
import android.transition.TransitionSet;
import android.transition.TransitionValues;
import android.util.FloatProperty;
import android.util.Pair;
import android.util.Property;
import android.util.Range;
import android.util.SparseArray;
import android.view.ContextThemeWrapper;
import android.view.KeyEvent;
import android.view.MotionEvent;
import android.view.OrientationEventListener;
import android.view.SurfaceView;
import android.view.TextureView;
import android.view.VelocityTracker;
import android.view.View;
import android.view.ViewConfiguration;
import android.view.ViewGroup;
import android.view.ViewOutlineProvider;
import android.view.ViewPropertyAnimator;
import android.view.ViewTreeObserver;
import android.view.WindowInsets;
import android.view.WindowManager;
import android.view.accessibility.AccessibilityEvent;
import android.view.accessibility.AccessibilityManager;
import android.view.animation.DecelerateInterpolator;
import android.view.animation.Interpolator;
import android.view.animation.LinearInterpolator;
import android.view.animation.OvershootInterpolator;
import android.webkit.WebView;
import android.widget.FrameLayout;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.OverScroller;
import android.widget.Scroller;
import android.widget.Space;
import android.widget.TextView;
import android.widget.Toast;
import android.widget.ViewSwitcher;
import androidx.collection.LongSparseArray;
import androidx.core.content.ContextCompat;
import androidx.core.content.FileProvider;
import androidx.core.graphics.ColorUtils;
import androidx.core.view.WindowInsetsCompat;
import androidx.core.widget.NestedScrollView;
import androidx.dynamicanimation.animation.DynamicAnimation;
import androidx.dynamicanimation.animation.FloatValueHolder;
import androidx.dynamicanimation.animation.SpringAnimation;
import androidx.dynamicanimation.animation.SpringForce;
import androidx.recyclerview.widget.DefaultItemAnimator;
import androidx.recyclerview.widget.LinearLayoutManager;
import androidx.recyclerview.widget.LinearSmoothScrollerEnd;
import androidx.recyclerview.widget.RecyclerView;
import com.google.android.exoplayer2.ExoPlayer;
import com.google.android.exoplayer2.analytics.AnalyticsListener;
import com.google.android.exoplayer2.ui.AspectRatioFrameLayout;
import com.google.android.exoplayer2.video.VideoSize;
import com.google.android.gms.cast.framework.CastContext;
import com.google.android.gms.vision.Frame;
import com.google.android.gms.vision.face.FaceDetector;
import com.huawei.hms.maps.model.BitmapDescriptorFactory;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.lang.reflect.Array;
import java.lang.reflect.Field;
import java.lang.reflect.InvocationTargetException;
import java.lang.reflect.Method;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.Comparator;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Locale;
import java.util.Map;
import java.util.Objects;
import org.telegram.messenger.AccountInstance;
import org.telegram.messenger.AndroidUtilities;
import org.telegram.messenger.AnimationNotificationsLocker;
import org.telegram.messenger.ApplicationLoader;
import org.telegram.messenger.Bitmaps;
import org.telegram.messenger.BotWebViewVibrationEffect;
import org.telegram.messenger.BringAppForegroundService;
import org.telegram.messenger.BuildVars;
import org.telegram.messenger.ChatObject;
import org.telegram.messenger.ContactsController;
import org.telegram.messenger.DialogObject;
import org.telegram.messenger.DispatchQueue;
import org.telegram.messenger.DownloadController;
import org.telegram.messenger.Emoji;
import org.telegram.messenger.FileLoader;
import org.telegram.messenger.FileLog;
import org.telegram.messenger.FileStreamLoadOperation;
import org.telegram.messenger.ImageLoader;
import org.telegram.messenger.ImageLocation;
import org.telegram.messenger.ImageReceiver;
import org.telegram.messenger.LiteMode;
import org.telegram.messenger.LocaleController;
import org.telegram.messenger.MediaController;
import org.telegram.messenger.MediaDataController;
import org.telegram.messenger.MessageObject;
import org.telegram.messenger.MessageSuggestionParams;
import org.telegram.messenger.MessagesController;
import org.telegram.messenger.MessagesStorage;
import org.telegram.messenger.NotificationCenter;
import org.telegram.messenger.NotificationsSettingsFacade;
import org.telegram.messenger.R;
import org.telegram.messenger.SecureDocument;
import org.telegram.messenger.SendMessagesHelper;
import org.telegram.messenger.SharedConfig;
import org.telegram.messenger.TranslateController;
import org.telegram.messenger.UserConfig;
import org.telegram.messenger.UserObject;
import org.telegram.messenger.Utilities;
import org.telegram.messenger.VideoEditedInfo;
import org.telegram.messenger.WebFile;
import org.telegram.messenger.browser.Browser;
import org.telegram.messenger.camera.Size;
import org.telegram.messenger.chromecast.ChromecastController;
import org.telegram.messenger.chromecast.ChromecastMedia;
import org.telegram.messenger.chromecast.ChromecastMediaVariations;
import org.telegram.messenger.pip.PipSource;
import org.telegram.messenger.pip.source.IPipSourceDelegate;
import org.telegram.messenger.pip.utils.PipUtils;
import org.telegram.messenger.video.OldVideoPlayerRewinder;
import org.telegram.messenger.video.VideoAds;
import org.telegram.messenger.video.VideoFramesRewinder;
import org.telegram.messenger.video.VideoPlayerRewinder;
import org.telegram.tgnet.ConnectionsManager;
import org.telegram.tgnet.RequestDelegate;
import org.telegram.tgnet.TLObject;
import org.telegram.tgnet.TLRPC;
import org.telegram.tgnet.tl.TL_stories$StoryItem;
import org.telegram.ui.ActionBar.ActionBar;
import org.telegram.ui.ActionBar.ActionBarMenu;
import org.telegram.ui.ActionBar.ActionBarMenuItem;
import org.telegram.ui.ActionBar.ActionBarMenuSlider;
import org.telegram.ui.ActionBar.ActionBarMenuSubItem;
import org.telegram.ui.ActionBar.ActionBarPopupWindow;
import org.telegram.ui.ActionBar.AdjustPanLayoutHelper;
import org.telegram.ui.ActionBar.AlertDialog;
import org.telegram.ui.ActionBar.BaseFragment;
import org.telegram.ui.ActionBar.BottomSheet;
import org.telegram.ui.ActionBar.SimpleTextView;
import org.telegram.ui.ActionBar.Theme;
import org.telegram.ui.Cells.CheckBoxCell;
import org.telegram.ui.Cells.PhotoPickerPhotoCell;
import org.telegram.ui.Cells.TextSelectionHelper;
import org.telegram.ui.ChatActivity;
import org.telegram.ui.ChooseDownloadQualityLayout;
import org.telegram.ui.Components.AlertsCreator;
import org.telegram.ui.Components.AnimatedEmojiSpan;
import org.telegram.ui.Components.AnimatedFileDrawable;
import org.telegram.ui.Components.AnimatedFloat;
import org.telegram.ui.Components.AnimatedTextView;
import org.telegram.ui.Components.AnimationProperties;
import org.telegram.ui.Components.BackupImageView;
import org.telegram.ui.Components.BlurringShader;
import org.telegram.ui.Components.Bulletin;
import org.telegram.ui.Components.BulletinFactory;
import org.telegram.ui.Components.CaptionPhotoViewer;
import org.telegram.ui.Components.CastMediaRouteButton;
import org.telegram.ui.Components.ChatActivityEnterView;
import org.telegram.ui.Components.ChatAttachAlert;
import org.telegram.ui.Components.CheckBox;
import org.telegram.ui.Components.ClippingImageView;
import org.telegram.ui.Components.ColoredImageSpan;
import org.telegram.ui.Components.CombinedDrawable;
import org.telegram.ui.Components.Crop.CropAreaView;
import org.telegram.ui.Components.Crop.CropTransform;
import org.telegram.ui.Components.Crop.CropView;
import org.telegram.ui.Components.CubicBezierInterpolator;
import org.telegram.ui.Components.EditCoverButton;
import org.telegram.ui.Components.FilterGLThread;
import org.telegram.ui.Components.FilterShaders;
import org.telegram.ui.Components.FloatSeekBarAccessibilityDelegate;
import org.telegram.ui.Components.Forum.ForumUtilities;
import org.telegram.ui.Components.GestureDetector2;
import org.telegram.ui.Components.GroupedPhotosListView;
import org.telegram.ui.Components.HideViewAfterAnimation;
import org.telegram.ui.Components.ImageUpdater;
import org.telegram.ui.Components.ItemOptions;
import org.telegram.ui.Components.LayoutHelper;
import org.telegram.ui.Components.LinkSpanDrawable;
import org.telegram.ui.Components.LoadingDrawable;
import org.telegram.ui.Components.MediaActivity;
import org.telegram.ui.Components.MentionsContainerView;
import org.telegram.ui.Components.MuteDrawable;
import org.telegram.ui.Components.OtherDocumentPlaceholderDrawable;
import org.telegram.ui.Components.Paint.Views.LPhotoPaintView;
import org.telegram.ui.Components.Paint.Views.MaskPaintView;
import org.telegram.ui.Components.Paint.Views.PaintCancelView;
import org.telegram.ui.Components.Paint.Views.PaintDoneView;
import org.telegram.ui.Components.Paint.Views.PaintWeightChooserView;
import org.telegram.ui.Components.Paint.Views.StickerCutOutBtn;
import org.telegram.ui.Components.Paint.Views.StickerMakerBackgroundView;
import org.telegram.ui.Components.Paint.Views.StickerMakerView;
import org.telegram.ui.Components.PaintingOverlay;
import org.telegram.ui.Components.PhotoCropView;
import org.telegram.ui.Components.PhotoFilterBlurControl;
import org.telegram.ui.Components.PhotoFilterCurvesControl;
import org.telegram.ui.Components.PhotoFilterView;
import org.telegram.ui.Components.PhotoViewerBlurDrawable;
import org.telegram.ui.Components.PhotoViewerCoverEditor;
import org.telegram.ui.Components.PhotoViewerWebView;
import org.telegram.ui.Components.PickerBottomLayoutViewer;
import org.telegram.ui.Components.PipVideoOverlay;
import org.telegram.ui.Components.PlayPauseDrawable;
import org.telegram.ui.Components.Premium.LimitReachedBottomSheet;
import org.telegram.ui.Components.Premium.PremiumFeatureBottomSheet;
import org.telegram.ui.Components.QuoteSpan;
import org.telegram.ui.Components.RLottieDrawable;
import org.telegram.ui.Components.RadialProgressView;
import org.telegram.ui.Components.Reactions.ReactionsLayoutInBubble;
import org.telegram.ui.Components.RecyclerListView;
import org.telegram.ui.Components.ScaleStateListAnimator;
import org.telegram.ui.Components.SeekSpeedDrawable;
import org.telegram.ui.Components.ShareAlert;
import org.telegram.ui.Components.SizeNotifierFrameLayoutPhoto;
import org.telegram.ui.Components.SpeedIconDrawable;
import org.telegram.ui.Components.StickersAlert;
import org.telegram.ui.Components.TextViewSwitcher;
import org.telegram.ui.Components.ThanosEffect;
import org.telegram.ui.Components.Tooltip;
import org.telegram.ui.Components.TranslateAlert2;
import org.telegram.ui.Components.TypefaceSpan;
import org.telegram.ui.Components.URLSpanReplacement;
import org.telegram.ui.Components.UndoView;
import org.telegram.ui.Components.VideoCompressButton;
import org.telegram.ui.Components.VideoEditTextureView;
import org.telegram.ui.Components.VideoForwardDrawable;
import org.telegram.ui.Components.VideoPlayer;
import org.telegram.ui.Components.VideoPlayerSeekBar;
import org.telegram.ui.Components.VideoSeekPreviewImage;
import org.telegram.ui.Components.VideoTimelinePlayView;
import org.telegram.ui.Components.ViewHelper;
import org.telegram.ui.Components.spoilers.SpoilersTextView;
import org.telegram.ui.ContentPreviewViewer;
import org.telegram.ui.DialogsActivity;
import org.telegram.ui.PhotoViewer;
import org.telegram.ui.SpeedButtonsLayout;
import org.telegram.ui.Stars.StarsController;
import org.telegram.ui.Stories.DarkThemeResourceProvider;
import org.telegram.ui.Stories.recorder.CaptionContainerView;
import org.telegram.ui.Stories.recorder.HintView2;
import org.telegram.ui.Stories.recorder.KeyboardNotifier;
import org.webrtc.MediaStreamTrack;

/* loaded from: /Users/liqi/android-frida-traces/apk_test/dex_files/classes4.dex */
public class PhotoViewer implements NotificationCenter.NotificationCenterDelegate, GestureDetector2.OnGestureListener, GestureDetector2.OnDoubleTapListener, IPipSourceDelegate {
    private static volatile PhotoViewer Instance;
    private static volatile PhotoViewer Instance2;
    private static volatile PhotoViewer PipInstance;
    private static final Property VPC_PROGRESS;
    private static DecelerateInterpolator decelerateInterpolator;
    private static Drawable[] progressDrawables;
    private static Paint progressPaint;
    private boolean ALLOW_USE_SURFACE;
    public final Property FLASH_VIEW_VALUE;
    private int aboutToSwitchTo;
    private ActionBar actionBar;
    private AnimatorSet actionBarAnimator;
    private PhotoViewerActionBarContainer actionBarContainer;
    private Map actionBarItemsVisibility;
    private boolean actionBarWasShownBeforeByEnd;
    private Context activityContext;
    private TextView adButtonTextView;
    private FrameLayout adButtonView;
    private VideoAds ads;
    private ActionBarMenuSubItem allMediaItem;
    private boolean allowOrder;
    private boolean allowShare;
    private boolean allowShowFullscreenButton;
    private float animateToMirror;
    private float animateToRotate;
    private float animateToScale;
    private float animateToX;
    private float animateToY;
    private ClippingImageView animatingImageView;
    private Runnable animationEndRunnable;
    private int animationInProgress;
    private long animationStartTime;
    private float animationValue;
    private float[][] animationValues;
    private boolean applying;
    private AspectRatioFrameLayout aspectRatioFrameLayout;
    private boolean attachedToWindow;
    private long audioFramesSize;
    private float avatarStartProgress;
    private long avatarStartTime;
    private final ArrayList avatarsArr;
    private long avatarsDialogId;
    private BackgroundDrawable backgroundDrawable;
    private volatile int bitrate;
    private Paint blackPaint;
    private final AnimatedFloat blurAlpha;
    private RectF blurBounds;
    public BlurringShader.BlurManager blurManager;
    private FrameLayout bottomBulletinUnderCaption;
    private LinearGradient bottomFancyShadow;
    private Matrix bottomFancyShadowMatrix;
    private Paint bottomFancyShadowPaint;
    private FrameLayout bottomLayout;
    private LinearLayout btnLayout;
    private boolean canDragDown;
    private boolean canEditAvatar;
    private boolean canZoom;
    private FrameLayout captionContainer;
    private String captionDetectedLanguage;
    private CaptionPhotoViewer captionEdit;
    private final float[] captionEditAlpha;
    private FrameLayout captionEditContainer;
    public CharSequence captionForAllMedia;
    private boolean captionHwLayerEnabled;
    private CaptionScrollView captionScrollView;
    private CaptionTextViewSwitcher captionTextViewSwitcher;
    private boolean captionTranslated;
    private long captureFrameAtTime;
    private long captureFrameReadyAtTime;
    private ActionBarMenuSubItem castItem;
    private CastMediaRouteButton castItemButton;
    private BlurringShader.ThumbBlurer centerBlur;
    public ImageReceiver centerImage;
    private AnimatedFloat[] centerImageInsideBlur;
    private boolean centerImageIsVideo;
    private Matrix centerImageTransform;
    private boolean centerImageTransformLocked;
    private AnimatorSet changeModeAnimation;
    public TextureView changedTextureView;
    private boolean changingPage;
    private boolean changingTextureView;
    private CheckBox checkImageView;
    private ChooseDownloadQualityLayout chooseDownloadQualityLayout;
    private SpeedButtonsLayout chooseSpeedLayout;
    private int classGuid;
    private Path clipFancyShadows;
    private float clippingImageProgress;
    public boolean closePhotoAfterSelect;
    public boolean closePhotoAfterSelectWithAnimation;
    private VideoCompressButton compressItem;
    private HintView2 compressPhotoHint;
    private volatile int compressionsCount;
    private FrameLayoutDrawer containerView;
    private PhotoCountView countView;
    public PhotoViewerCoverEditor coverEditor;
    private boolean cropInitied;
    private ImageView cropItem;
    private CropTransform cropTransform;
    private int currentAccount;
    private AnimatedFileDrawable currentAnimation;
    private ImageLocation currentAvatarLocation;
    private Bitmap currentBitmap;
    private TLRPC.BotInlineResult currentBotInlineResult;
    private float currentCropScale;
    private float currentCropX;
    private float currentCropY;
    private long currentDialogId;
    private int currentEditMode;
    private ImageLocation currentFileLocation;
    private ImageLocation currentFileLocationVideo;
    private String[] currentFileNames;
    private String currentFilterQuery;
    private ReactionsLayoutInBubble.VisibleReaction currentFilterTag;
    private boolean currentFiltered;
    private String currentImageFaceKey;
    private int currentImageHasFace;
    private String currentImagePath;
    private int currentIndex;
    private AnimatorSet currentListViewAnimation;
    private Runnable currentLoadingVideoRunnable;
    private MessageObject currentMessageObject;
    private TLRPC.PageBlock currentPageBlock;
    private float currentPanTranslationY;
    private String currentPathObject;
    private PlaceProviderObject currentPlaceObject;
    private Uri currentPlayingVideoFile;
    private ArrayList currentPlayingVideoQualityFiles;
    private SecureDocument currentSecureDocument;
    private String currentSubtitle;
    private ImageReceiver.BitmapHolder currentThumb;
    private boolean currentVideoFinishedLoading;
    private float currentVideoSpeed;
    public Utilities.Callback2 customStickerHandler;
    private CharSequence customTitle;
    private BlurButton cutOutBtn;
    private int dateOverride;
    private MessagesController.DialogPhotos dialogPhotos;
    private boolean disableShowCheck;
    private boolean discardTap;
    private TextView docInfoTextView;
    private TextView docNameTextView;
    private TextView doneButtonFullWidth;
    public boolean doneButtonPressed;
    private boolean dontAutoPlay;
    private boolean dontChangeCaptionPosition;
    private boolean dontResetZoomOnFirstLayout;
    private boolean doubleTap;
    private boolean doubleTapEnabled;
    private float dragY;
    private boolean draggingDown;
    private boolean[] drawPressedDrawable;
    private EditCoverButton editCoverButton;
    private ActionBarMenuItem editItem;
    private EditState editState;
    private boolean editing;
    private PickerBottomLayoutViewer editorDoneLayout;
    private boolean[] endReached;
    private long endTime;
    private BlurButton eraseBtn;
    private long estimatedDuration;
    private long estimatedSize;
    private ImageView exitFullscreenButton;
    private boolean fancyShadows;
    private boolean firstAnimationDelay;
    private boolean firstFrameRendered;
    private FirstFrameView firstFrameView;
    private AnimatorSet flashAnimator;
    private View flashView;
    public final VideoFramesRewinder framesRewinder;
    boolean fromCamera;
    private ImageView[] fullscreenButton;
    private int fullscreenedByButton;
    private ActionBarMenuSubItem galleryButton;
    private ActionBarPopupWindow.GapView galleryGap;
    private GestureDetector2 gestureDetector;
    private GroupedPhotosListView groupedPhotosListView;
    public boolean hasCaptionForAllMedia;
    private Runnable hideActionBarRunnable;
    private PlaceProviderObject hideAfterAnimation;
    private UndoView hintView;
    private Rect hitRect;
    private boolean ignoreDidSetImage;
    private boolean ignorePlayerUpdate;
    private RectF imageBounds;
    private Matrix imageBoundsMatrix;
    private float[] imageBoundsPoints;
    private AnimatorSet imageMoveAnimation;
    private final ArrayList imagesArr;
    private final ArrayList imagesArrLocals;
    private final ArrayList imagesArrLocations;
    private final ArrayList imagesArrLocationsSizes;
    private final ArrayList imagesArrLocationsVideo;
    private final ArrayList imagesArrMessages;
    private final ArrayList imagesArrTemp;
    private final SparseArray[] imagesByIds;
    private final SparseArray[] imagesByIdsTemp;
    private boolean inBubbleMode;
    private boolean inPreview;
    private VideoPlayer injectingVideoPlayer;
    private SurfaceTexture injectingVideoPlayerSurface;
    private float inlineOutAnimationProgress;
    private final Rect insets;
    private DecelerateInterpolator interpolator;
    private boolean invalidCoords;
    private boolean isActionBarVisible;
    private boolean isCurrentVideo;
    private boolean isDocumentsPicker;
    private boolean isEmbedVideo;
    private boolean isEvent;
    private boolean isFirstLoading;
    private volatile boolean isH264Video;
    private boolean isInline;
    private boolean isPhotosListViewVisible;
    private boolean isPlaying;
    private boolean isStreaming;
    private boolean isVisible;
    private boolean isVisibleOrAnimating;
    private LinearLayout itemsLayout;
    private boolean keepScreenOnFlagSet;
    private int keyboardSize;
    private long lastBufferedPositionCheck;
    private boolean lastCaptionTranslating;
    private String lastControlFrameDuration;
    private Bitmap lastFrameBitmap;
    private ImageView lastFrameImageView;
    private int lastImageId;
    private long lastPhotoSetTime;
    private int lastQualityIndexSelected;
    private long lastSaveTime;
    private CharSequence lastTitle;
    float lastX;
    private BlurringShader.ThumbBlurer leftBlur;
    private MediaController.CropState leftCropState;
    private CropTransform leftCropTransform;
    private ImageReceiver leftImage;
    private boolean leftImageIsVideo;
    private PaintingOverlay leftPaintingOverlay;
    private Bulletin limitBulletin;
    private boolean loadInitialVideo;
    private boolean loadingMoreImages;
    Runnable longPressRunnable;
    float longPressX;
    OldVideoPlayerRewinder longVideoPlayerRewinder;
    private ActionBarMenuSubItem loopItem;
    private boolean manuallyPaused;
    private MaskPaintView maskPaintView;
    private boolean maskPaintViewEraser;
    private boolean maskPaintViewShuttingDown;
    private int maskPaintViewTouched;
    private StickersAlert masksAlert;
    private ActionBarMenuItem masksItem;
    private int maxSelectedPhotos;
    private float maxX;
    private float maxY;
    private ActionBarMenu menu;
    private ActionBarMenuItem menuItem;
    private long mergeDialogId;
    private float minX;
    private float minY;
    private AnimatorSet miniProgressAnimator;
    private final Runnable miniProgressShowRunnable;
    private RadialProgressView miniProgressView;
    private float mirror;
    private ImageView mirrorItem;
    private float moveStartX;
    private float moveStartY;
    private boolean moving;
    private ImageView muteButton;
    private MuteDrawable muteDrawable;
    private ArrayList muteHints;
    private boolean muteVideo;
    private String nameOverride;
    private View navigationBar;
    private int navigationBarHeight;
    private boolean needCaptionLayout;
    private long needCaptureFrameReadyAtTime;
    private boolean needSearchImageInArr;
    private boolean needShowOnReady;
    private Runnable onUserLeaveHintListener;
    private boolean openedFromProfile;
    private boolean openedFullScreenVideo;
    private boolean opennedFromMedia;
    private OrientationEventListener orientationEventListener;
    private volatile int originalBitrate;
    private volatile int originalHeight;
    private long originalSize;
    private volatile int originalWidth;
    private BlurButton outlineBtn;
    private boolean padImageForHorizontalInsets;
    private PageBlocksAdapter pageBlocksAdapter;
    private ImageView paintItem;
    private AnimatorSet paintKeyboardAnimator;
    private KeyboardNotifier paintKeyboardNotifier;
    private int paintViewTouched;
    private PaintingOverlay paintingOverlay;
    private Activity parentActivity;
    private ChatAttachAlert parentAlert;
    private ChatActivity parentChatActivity;
    private BaseFragment parentFragment;
    private PhotoCropView photoCropView;
    private PhotoFilterView photoFilterView;
    private LPhotoPaintView photoPaintView;
    private PhotoProgressView[] photoProgressViews;
    private PhotoViewerWebView photoViewerWebView;
    private CounterView photosCounterView;
    private FrameLayout pickerView;
    private ChatActivityEnterView.SendButton pickerViewSendButton;
    private float pinchCenterX;
    private float pinchCenterY;
    private float pinchStartAngle;
    private float pinchStartDistance;
    private float pinchStartRotate;
    private float pinchStartScale;
    private float pinchStartX;
    private float pinchStartY;
    private boolean pipAnimationInProgress;
    private boolean pipAvailable;
    public Runnable pipFirstFrameCallback;
    private ActionBarMenuSubItem pipItem;
    private View pipPlaceholderView;
    private int[] pipPosition;
    private PipSource pipSource;
    private TextureView pipTextureView;
    private boolean pipVideoOverlayAnimateFlag;
    private PhotoViewerProvider placeProvider;
    private View playButtonAccessibilityOverlay;
    private boolean playerAutoStarted;
    private boolean playerInjected;
    private boolean playerLooping;
    private boolean playerWasPlaying;
    private boolean playerWasReady;
    private GradientDrawable[] pressedDrawable;
    private float[] pressedDrawableAlpha;
    private int prevOrientation;
    private int previousCompression;
    private boolean previousCropMirrored;
    private int previousCropOrientation;
    private float previousCropPh;
    private float previousCropPw;
    private float previousCropPx;
    private float previousCropPy;
    private float previousCropRotation;
    private float previousCropScale;
    private boolean previousHasTransform;
    private RadialProgressView progressView;
    private QualityChooseView qualityChooseView;
    private AnimatorSet qualityChooseViewAnimation;
    private PickerBottomLayoutViewer qualityPicker;
    private RenderNode renderNode;
    public TLRPC.Document replacedSticker;
    private boolean requestingPreview;
    private TextView resetButton;
    private Theme.ResourcesProvider resourcesProvider;
    private BlurButton restoreBtn;
    private volatile int resultHeight;
    private volatile int resultWidth;
    private BlurringShader.ThumbBlurer rightBlur;
    private MediaController.CropState rightCropState;
    private CropTransform rightCropTransform;
    private ImageReceiver rightImage;
    private boolean rightImageIsVideo;
    private PaintingOverlay rightPaintingOverlay;
    private float rotate;
    private ImageView rotateItem;
    private int rotationValue;
    private float savedRotation;
    private float savedScale;
    private SavedState savedState;
    private float savedTx;
    private float savedTy;
    private float scale;
    private Scroller scroller;
    private final ArrayList secureDocuments;
    private SeekSpeedDrawable seekSpeedDrawable;
    private float seekToProgressPending;
    private float seekToProgressPending2;
    private volatile int selectedCompression;
    private ArrayList selectedEmojis;
    private ListAdapter selectedPhotosAdapter;
    private SelectedPhotosListView selectedPhotosListView;
    private ActionBarMenuItem sendItem;
    private int sendPhotoType;
    private ActionBarPopupWindow.ActionBarPopupWindowLayout sendPopupLayout;
    private ActionBarPopupWindow sendPopupWindow;
    private ImageUpdater.AvatarFor setAvatarFor;
    private Runnable setLoadingRunnable;
    private BlurringShader.StoryBlurDrawer shadowBlurer;
    private int sharedMediaType;
    private float shiftDp;
    private String shouldSavePositionForCurrentVideo;
    private String shouldSavePositionForCurrentVideoShortTerm;
    private PlaceProviderObject showAfterAnimation;
    private boolean shownControlsByEnd;
    private ImageReceiver sideImage;
    private boolean skipFirstBufferingProgress;
    public boolean skipLastFrameDraw;
    private int slideshowMessageId;
    private ActionBarPopupWindow.GapView speedGap;
    private ActionBarMenuSlider.SpeedSlider speedItem;
    private int startOffset;
    private boolean startReached;
    private long startTime;
    private long startedPlayTime;
    public boolean stickerEmpty;
    public boolean stickerEmptySent;
    private StickerMakerBackgroundView stickerMakerBackgroundView;
    public StickerMakerView stickerMakerView;
    private boolean streamingAlertShown;
    private Paint surfaceBlackoutPaint;
    private TextureView.SurfaceTextureListener surfaceTextureListener;
    private int switchImageAfterAnimation;
    private final Runnable switchToInlineRunnable;
    private boolean switchingInlineMode;
    private int switchingToIndex;
    private int switchingToMode;
    private int[] tempInt;
    private TextSelectionHelper.SimpleTextSelectionHelper textSelectionHelper;
    private ImageView textureImageView;
    private boolean textureUploaded;
    private boolean textureViewSkipRender;
    private Tooltip tooltip;
    private FrameLayout topBulletinUnderCaption;
    private CaptionPhotoViewer topCaptionEdit;
    private final float[] topCaptionEditAlpha;
    private FrameLayout topCaptionEditContainer;
    private LinearGradient topFancyShadow;
    private Matrix topFancyShadowMatrix;
    private Paint topFancyShadowPaint;
    private long topicId;
    private int totalImagesCount;
    private int totalImagesCountMerge;
    private int touchSlop;
    private long transitionAnimationStartTime;
    private AnimationNotificationsLocker transitionNotificationLocker;
    private float translateY;
    private ValueAnimator translateYAnimator;
    private float translationX;
    private float translationY;
    private boolean tryStartRequestPreviewOnFinish;
    private ImageView tuneItem;
    private BlurButton undoBtn;
    private final Runnable updateContainerFlagsRunnable;
    private Runnable updateProgressRunnable;
    private boolean usedSurfaceView;
    private VelocityTracker velocityTracker;
    private TextView videoAvatarTooltip;
    private volatile boolean videoConvertSupported;
    private float videoCrossfadeAlpha;
    private long videoCrossfadeAlphaLastTime;
    private boolean videoCrossfadeStarted;
    private float videoCutEnd;
    private float videoCutStart;
    private float videoDuration;
    private VideoForwardDrawable videoForwardDrawable;
    private Bitmap videoFrameBitmap;
    private Paint videoFrameBitmapPaint;
    private int videoFramerate;
    private long videoFramesSize;
    private int videoHeight;
    private ActionBarMenuItem videoItem;
    private ChooseQualityLayout$QualityIcon videoItemIcon;
    private Runnable videoPlayRunnable;
    private VideoPlayer videoPlayer;
    private Animator videoPlayerControlAnimator;
    private VideoPlayerControlFrameLayout videoPlayerControlFrameLayout;
    private boolean videoPlayerControlVisible;
    private int[] videoPlayerCurrentTime;
    private final VideoPlayerRewinder videoPlayerRewinder;
    private VideoPlayerSeekBar videoPlayerSeekbar;
    private View videoPlayerSeekbarView;
    private SimpleTextView videoPlayerTime;
    private int[] videoPlayerTotalTime;
    private VideoSeekPreviewImage videoPreviewFrame;
    private AnimatorSet videoPreviewFrameAnimation;
    private MessageObject videoPreviewMessageObject;
    private final ArrayList videoQualityItems;
    private LinearLayout videoQualityLayout;
    private boolean videoSizeSet;
    private SurfaceView videoSurfaceView;
    private TextureView videoTextureView;
    private ObjectAnimator videoTimelineAnimator;
    private VideoTimelinePlayView videoTimelineView;
    private FrameLayout videoTimelineViewContainer;
    private int videoWidth;
    private AlertDialog visibleDialog;
    private int waitingForDraw;
    private int waitingForFirstTextureUpload;
    private boolean wasCountViewShown;
    private boolean wasLayout;
    private boolean wasRotated;
    private WindowManager.LayoutParams windowLayoutParams;
    public FrameLayout windowView;
    private boolean windowViewSkipRender;
    private boolean zoomAnimation;
    private boolean zooming;
    public static Paint bitmapPaint = new Paint(2);
    private static final HashMap savedVideoPositions = new HashMap();

    /* renamed from: org.telegram.ui.PhotoViewer$14, reason: invalid class name */
    class AnonymousClass14 extends FrameLayout {
        AnonymousClass14(Context context) {
            super(context);
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onLayout$0() {
            FrameLayout.LayoutParams layoutParams = (FrameLayout.LayoutParams) PhotoViewer.this.checkImageView.getLayoutParams();
            ((WindowManager) ApplicationLoader.applicationContext.getSystemService("window")).getDefaultDisplay().getRotation();
            int currentActionBarHeight = ((ActionBar.getCurrentActionBarHeight() - AndroidUtilities.dp(34.0f)) / 2) + (PhotoViewer.this.isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0);
            if (currentActionBarHeight != layoutParams.topMargin) {
                layoutParams.topMargin = currentActionBarHeight;
                PhotoViewer.this.checkImageView.setLayoutParams(layoutParams);
            }
            FrameLayout.LayoutParams layoutParams2 = (FrameLayout.LayoutParams) PhotoViewer.this.photosCounterView.getLayoutParams();
            int currentActionBarHeight2 = ((ActionBar.getCurrentActionBarHeight() - AndroidUtilities.dp(40.0f)) / 2) + (PhotoViewer.this.isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0);
            if (layoutParams2.topMargin != currentActionBarHeight2) {
                layoutParams2.topMargin = currentActionBarHeight2;
                PhotoViewer.this.photosCounterView.setLayoutParams(layoutParams2);
            }
        }

        @Override // android.view.ViewGroup, android.view.View
        protected void dispatchDraw(Canvas canvas) {
            UndoView undoView;
            super.dispatchDraw(canvas);
            if (PhotoViewer.this.parentChatActivity == null || (undoView = PhotoViewer.this.parentChatActivity.getUndoView()) == null || undoView.getVisibility() != 0) {
                return;
            }
            canvas.save();
            View view = (View) undoView.getParent();
            canvas.clipRect(view.getX(), view.getY(), view.getX() + view.getWidth(), view.getY() + view.getHeight());
            canvas.translate(undoView.getX(), undoView.getY());
            undoView.draw(canvas);
            canvas.restore();
            invalidate();
        }

        @Override // android.view.ViewGroup, android.view.View
        public boolean dispatchKeyEvent(KeyEvent keyEvent) {
            keyEvent.getKeyCode();
            if (!PhotoViewer.this.muteVideo && PhotoViewer.this.sendPhotoType != 1 && PhotoViewer.this.isCurrentVideo && PhotoViewer.this.videoPlayer != null && keyEvent.getRepeatCount() == 0 && keyEvent.getAction() == 0 && (keyEvent.getKeyCode() == 24 || keyEvent.getKeyCode() == 25)) {
                PhotoViewer.this.videoPlayer.setVolume(1.0f);
            }
            return super.dispatchKeyEvent(keyEvent);
        }

        @Override // android.view.ViewGroup, android.view.View
        public boolean dispatchKeyEventPreIme(KeyEvent keyEvent) {
            if (keyEvent == null || keyEvent.getKeyCode() != 4 || keyEvent.getAction() != 1) {
                return super.dispatchKeyEventPreIme(keyEvent);
            }
            if (PhotoViewer.this.textSelectionHelper.isInSelectionMode()) {
                PhotoViewer.this.textSelectionHelper.clear();
            }
            if (PhotoViewer.this.isCaptionOpen()) {
                PhotoViewer.this.closeCaptionEnter(true);
                return false;
            }
            if (ContentPreviewViewer.getInstance().isVisible()) {
                ContentPreviewViewer.getInstance().closeWithMenu();
                return false;
            }
            PhotoViewer.getInstance().closePhoto(true, false);
            return true;
        }

        /* JADX WARN: Removed duplicated region for block: B:17:0x0023  */
        /* JADX WARN: Removed duplicated region for block: B:22:0x003d  */
        @Override // android.view.ViewGroup, android.view.View
        /*
            Code decompiled incorrectly, please refer to instructions dump.
        */
        public boolean dispatchTouchEvent(MotionEvent motionEvent) {
            if (PhotoViewer.this.videoPlayerControlVisible && PhotoViewer.this.isPlaying) {
                int actionMasked = motionEvent.getActionMasked();
                if (actionMasked == 0) {
                    AndroidUtilities.cancelRunOnUIThread(PhotoViewer.this.hideActionBarRunnable);
                } else if (actionMasked == 1 || actionMasked == 3) {
                    if (PhotoViewer.this.currentMessageObject == null || !PhotoViewer.this.currentMessageObject.isSponsored()) {
                        PhotoViewer.this.scheduleActionBarHide();
                    }
                } else if (actionMasked != 5) {
                    if (actionMasked == 6) {
                    }
                }
            }
            return super.dispatchTouchEvent(motionEvent);
        }

        @Override // android.view.View
        public void draw(Canvas canvas) {
            if (PhotoViewer.this.windowViewSkipRender) {
                return;
            }
            super.draw(canvas);
        }

        @Override // android.view.ViewGroup
        protected boolean drawChild(Canvas canvas, View view, long j) {
            try {
                return super.drawChild(canvas, view, j);
            } catch (Throwable unused) {
                return false;
            }
        }

        @Override // android.view.ViewGroup, android.view.View
        protected void onAttachedToWindow() {
            super.onAttachedToWindow();
            PhotoViewer.this.centerImage.onAttachedToWindow();
            PhotoViewer.this.leftImage.onAttachedToWindow();
            PhotoViewer.this.rightImage.onAttachedToWindow();
            PhotoViewer.this.attachedToWindow = true;
        }

        @Override // android.view.ViewGroup, android.view.View
        protected void onDetachedFromWindow() {
            super.onDetachedFromWindow();
            PhotoViewer.this.centerImage.onDetachedFromWindow();
            PhotoViewer.this.leftImage.onDetachedFromWindow();
            PhotoViewer.this.rightImage.onDetachedFromWindow();
            PhotoViewer.this.attachedToWindow = false;
            PhotoViewer.this.wasLayout = false;
        }

        @Override // android.view.View
        protected void onDraw(Canvas canvas) {
            if (PhotoViewer.this.stickerMakerBackgroundView != null && PhotoViewer.this.stickerMakerBackgroundView.getVisibility() == 0) {
                View view = (View) PhotoViewer.this.stickerMakerBackgroundView.getParent();
                float fMin = Math.min(PhotoViewer.this.stickerMakerBackgroundView.getAlpha(), view != null ? view.getAlpha() : 1.0f);
                if (fMin > BitmapDescriptorFactory.HUE_RED) {
                    canvas.saveLayerAlpha(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, getWidth(), getHeight(), (int) (fMin * 255.0f), 31);
                    PhotoViewer.this.stickerMakerBackgroundView.draw(canvas);
                    canvas.restore();
                }
            }
            if (Build.VERSION.SDK_INT < 21 || !PhotoViewer.this.isVisible) {
                return;
            }
            PhotoViewer.this.blackPaint.setAlpha(PhotoViewer.this.backgroundDrawable.getAlpha());
            canvas.drawRect(BitmapDescriptorFactory.HUE_RED, getMeasuredHeight(), getMeasuredWidth(), getMeasuredHeight() + PhotoViewer.this.insets.bottom, PhotoViewer.this.blackPaint);
        }

        @Override // android.view.ViewGroup
        public boolean onInterceptTouchEvent(MotionEvent motionEvent) {
            return PhotoViewer.this.isVisible && super.onInterceptTouchEvent(motionEvent);
        }

        @Override // android.widget.FrameLayout, android.view.ViewGroup, android.view.View
        protected void onLayout(boolean z, int i, int i2, int i3, int i4) {
            PhotoViewer.this.animatingImageView.layout(getPaddingLeft(), 0, getPaddingLeft() + PhotoViewer.this.animatingImageView.getMeasuredWidth(), PhotoViewer.this.animatingImageView.getMeasuredHeight());
            PhotoViewer.this.containerView.layout(getPaddingLeft(), 0, getPaddingLeft() + PhotoViewer.this.containerView.getMeasuredWidth(), PhotoViewer.this.containerView.getMeasuredHeight());
            PhotoViewer.this.navigationBar.layout(getPaddingLeft(), PhotoViewer.this.containerView.getMeasuredHeight(), PhotoViewer.this.navigationBar.getMeasuredWidth(), PhotoViewer.this.containerView.getMeasuredHeight() + PhotoViewer.this.navigationBar.getMeasuredHeight());
            PhotoViewer.this.wasLayout = true;
            if (z) {
                if (!PhotoViewer.this.dontResetZoomOnFirstLayout) {
                    PhotoViewer photoViewer = PhotoViewer.this;
                    photoViewer.scale = photoViewer.scale1();
                    PhotoViewer.this.translationX = BitmapDescriptorFactory.HUE_RED;
                    PhotoViewer.this.translationY = BitmapDescriptorFactory.HUE_RED;
                    PhotoViewer photoViewer2 = PhotoViewer.this;
                    photoViewer2.updateMinMax(photoViewer2.scale);
                }
                if (PhotoViewer.this.checkImageView != null) {
                    PhotoViewer.this.checkImageView.post(new Runnable() { // from class: org.telegram.ui.PhotoViewer$14$$ExternalSyntheticLambda0
                        @Override // java.lang.Runnable
                        public final void run() {
                            this.f$0.lambda$onLayout$0();
                        }
                    });
                }
            }
            if (PhotoViewer.this.dontResetZoomOnFirstLayout) {
                PhotoViewer.this.setScaleToFill();
                PhotoViewer.this.dontResetZoomOnFirstLayout = false;
            }
        }

        @Override // android.widget.FrameLayout, android.view.View
        protected void onMeasure(int i, int i2) {
            int i3;
            int i4;
            int size = View.MeasureSpec.getSize(i);
            int size2 = View.MeasureSpec.getSize(i2);
            int i5 = Build.VERSION.SDK_INT;
            if (i5 >= 21) {
                if (!PhotoViewer.this.inBubbleMode) {
                    if (AndroidUtilities.incorrectDisplaySizeFix) {
                        int i6 = AndroidUtilities.displaySize.y;
                        if (size2 > i6) {
                            size2 = i6;
                        }
                        size2 += AndroidUtilities.statusBarHeight;
                    } else if (PhotoViewer.this.insets.bottom >= 0 && (i3 = AndroidUtilities.statusBarHeight) >= 0 && (i4 = (size2 - i3) - PhotoViewer.this.insets.bottom) > 0 && i4 < 4096) {
                        AndroidUtilities.displaySize.y = i4;
                    }
                }
                size2 -= PhotoViewer.this.insets.bottom;
            } else {
                if (i5 < 21) {
                    PhotoViewer.this.insets.top = AndroidUtilities.statusBarHeight;
                    PhotoViewer.this.insets.bottom = AndroidUtilities.navigationBarHeight;
                }
                int i7 = AndroidUtilities.displaySize.y;
                if (size2 > i7) {
                    size2 = i7;
                }
            }
            int paddingLeft = size - (getPaddingLeft() + getPaddingRight());
            int paddingBottom = size2 - getPaddingBottom();
            setMeasuredDimension(paddingLeft, paddingBottom);
            ViewGroup.LayoutParams layoutParams = PhotoViewer.this.animatingImageView.getLayoutParams();
            PhotoViewer.this.animatingImageView.measure(View.MeasureSpec.makeMeasureSpec(layoutParams.width, Integer.MIN_VALUE), View.MeasureSpec.makeMeasureSpec(layoutParams.height, Integer.MIN_VALUE));
            PhotoViewer.this.containerView.measure(View.MeasureSpec.makeMeasureSpec(paddingLeft, 1073741824), View.MeasureSpec.makeMeasureSpec(paddingBottom, 1073741824));
            PhotoViewer.this.navigationBar.measure(View.MeasureSpec.makeMeasureSpec(paddingLeft, 1073741824), View.MeasureSpec.makeMeasureSpec(PhotoViewer.this.navigationBarHeight, 1073741824));
        }

        @Override // android.view.View
        public boolean onTouchEvent(MotionEvent motionEvent) {
            return PhotoViewer.this.isVisible && PhotoViewer.this.onTouchEvent(motionEvent);
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$17, reason: invalid class name */
    class AnonymousClass17 extends ActionBar.ActionBarMenuOnItemClick {
        final /* synthetic */ Theme.ResourcesProvider val$resourcesProvider;

        AnonymousClass17(Theme.ResourcesProvider resourcesProvider) {
            this.val$resourcesProvider = resourcesProvider;
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onItemClick$0(boolean z, Uri uri) {
            BulletinFactory.createSaveToGalleryBulletin(PhotoViewer.this.containerView, z, -115203550, -1).show();
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onItemClick$1(boolean z, Uri uri) {
            BulletinFactory.createSaveToGalleryBulletin(PhotoViewer.this.containerView, z, -115203550, -1).show();
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ boolean lambda$onItemClick$10(ArrayList arrayList, ChatActivity chatActivity, DialogsActivity dialogsActivity, ArrayList arrayList2, CharSequence charSequence, boolean z, boolean z2, int i, TopicsFragment topicsFragment) {
            UndoView undoView;
            long j;
            String str;
            if (arrayList2.size() > 1 || ((MessagesStorage.TopicKey) arrayList2.get(0)).dialogId == UserConfig.getInstance(PhotoViewer.this.currentAccount).getClientUserId() || charSequence != null) {
                for (int i2 = 0; i2 < arrayList2.size(); i2++) {
                    long j2 = ((MessagesStorage.TopicKey) arrayList2.get(i2)).dialogId;
                    if (charSequence != null) {
                        j = j2;
                        SendMessagesHelper.getInstance(PhotoViewer.this.currentAccount).sendMessage(SendMessagesHelper.SendMessageParams.of(charSequence.toString(), j2, null, null, null, true, null, null, null, true, 0, null, false));
                    } else {
                        j = j2;
                    }
                    SendMessagesHelper.getInstance(PhotoViewer.this.currentAccount).sendMessage(arrayList, j, false, false, true, 0, 0L);
                }
                dialogsActivity.lambda$onBackPressed$354();
                if (chatActivity != null && (undoView = chatActivity.getUndoView()) != null) {
                    if (arrayList2.size() == 1) {
                        undoView.showWithAction(((MessagesStorage.TopicKey) arrayList2.get(0)).dialogId, 53, Integer.valueOf(arrayList.size()));
                    } else {
                        undoView.showWithAction(0L, 53, Integer.valueOf(arrayList.size()), Integer.valueOf(arrayList2.size()), (Runnable) null, (Runnable) null);
                    }
                }
            } else {
                MessagesStorage.TopicKey topicKey = (MessagesStorage.TopicKey) arrayList2.get(0);
                long j3 = topicKey.dialogId;
                Bundle bundle = new Bundle();
                bundle.putBoolean("scrollToTopOnResume", true);
                if (DialogObject.isEncryptedDialog(j3)) {
                    bundle.putInt("enc_id", DialogObject.getEncryptedChatId(j3));
                } else {
                    if (DialogObject.isUserDialog(j3)) {
                        str = "user_id";
                    } else {
                        j3 = -j3;
                        str = "chat_id";
                    }
                    bundle.putLong(str, j3);
                }
                ChatActivity chatActivity2 = new ChatActivity(bundle);
                if (topicKey.topicId != 0) {
                    ForumUtilities.applyTopic(chatActivity2, topicKey);
                }
                if (((LaunchActivity) PhotoViewer.this.parentActivity).presentFragment(chatActivity2, true, false)) {
                    chatActivity2.showFieldPanelForForward(true, arrayList);
                } else {
                    dialogsActivity.lambda$onBackPressed$354();
                }
            }
            return true;
        }

        /* JADX INFO: Access modifiers changed from: private */
        public static /* synthetic */ void lambda$onItemClick$11(boolean[] zArr, View view) {
            boolean z = !zArr[0];
            zArr[0] = z;
            ((CheckBoxCell) view).setChecked(z, true);
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onItemClick$12(boolean[] zArr, AlertDialog alertDialog, int i) throws Resources.NotFoundException {
            ArrayList<Long> arrayList;
            TLRPC.EncryptedChat encryptedChat;
            if (!PhotoViewer.this.placeProvider.onDeletePhoto(PhotoViewer.this.currentIndex)) {
                PhotoViewer.this.closePhoto(false, false);
                return;
            }
            if (!PhotoViewer.this.imagesArr.isEmpty()) {
                if (PhotoViewer.this.currentIndex < 0 || PhotoViewer.this.currentIndex >= PhotoViewer.this.imagesArr.size()) {
                    return;
                }
                MessageObject messageObject = (MessageObject) PhotoViewer.this.imagesArr.get(PhotoViewer.this.currentIndex);
                if (messageObject.isSent()) {
                    PhotoViewer.this.closePhoto(false, false);
                    ArrayList<Integer> arrayList2 = new ArrayList<>();
                    arrayList2.add(Integer.valueOf(PhotoViewer.this.slideshowMessageId != 0 ? PhotoViewer.this.slideshowMessageId : messageObject.getId()));
                    if (!DialogObject.isEncryptedDialog(messageObject.getDialogId()) || messageObject.messageOwner.random_id == 0) {
                        arrayList = null;
                        encryptedChat = null;
                    } else {
                        ArrayList<Long> arrayList3 = new ArrayList<>();
                        arrayList3.add(Long.valueOf(messageObject.messageOwner.random_id));
                        encryptedChat = MessagesController.getInstance(PhotoViewer.this.currentAccount).getEncryptedChat(Integer.valueOf(DialogObject.getEncryptedChatId(messageObject.getDialogId())));
                        arrayList = arrayList3;
                    }
                    MessagesController.getInstance(PhotoViewer.this.currentAccount).deleteMessages(arrayList2, arrayList, encryptedChat, messageObject.getDialogId(), messageObject.getQuickReplyId(), zArr[0], messageObject.getChatMode());
                    return;
                }
                return;
            }
            if (PhotoViewer.this.avatarsArr.isEmpty()) {
                if (PhotoViewer.this.secureDocuments.isEmpty() || PhotoViewer.this.placeProvider == null) {
                    return;
                }
                PhotoViewer.this.secureDocuments.remove(PhotoViewer.this.currentIndex);
                PhotoViewer.this.placeProvider.deleteImageAtIndex(PhotoViewer.this.currentIndex);
                if (!PhotoViewer.this.secureDocuments.isEmpty()) {
                    int size = PhotoViewer.this.currentIndex;
                    if (size >= PhotoViewer.this.secureDocuments.size()) {
                        size = PhotoViewer.this.secureDocuments.size() - 1;
                    }
                    PhotoViewer.this.currentIndex = -1;
                    PhotoViewer.this.setImageIndex(size);
                    return;
                }
            } else {
                if (PhotoViewer.this.currentIndex < 0 || PhotoViewer.this.currentIndex >= PhotoViewer.this.avatarsArr.size()) {
                    return;
                }
                TLRPC.Message message = (TLRPC.Message) PhotoViewer.this.imagesArrMessages.get(PhotoViewer.this.currentIndex);
                if (message != null) {
                    ArrayList<Integer> arrayList4 = new ArrayList<>();
                    arrayList4.add(Integer.valueOf(message.id));
                    MessagesController.getInstance(PhotoViewer.this.currentAccount).deleteMessages(arrayList4, null, null, MessageObject.getDialogId(message), message.quick_reply_shortcut_id, true, 0);
                    NotificationCenter.getInstance(PhotoViewer.this.currentAccount).lambda$postNotificationNameOnUIThread$1(NotificationCenter.reloadDialogPhotos, new Object[0]);
                }
                if (!PhotoViewer.this.isCurrentAvatarSet()) {
                    TLRPC.Photo photo = (TLRPC.Photo) PhotoViewer.this.avatarsArr.get(PhotoViewer.this.currentIndex);
                    if (photo == null) {
                        return;
                    }
                    TLRPC.TL_inputPhoto tL_inputPhoto = new TLRPC.TL_inputPhoto();
                    tL_inputPhoto.id = photo.id;
                    tL_inputPhoto.access_hash = photo.access_hash;
                    byte[] bArr = photo.file_reference;
                    tL_inputPhoto.file_reference = bArr;
                    if (bArr == null) {
                        tL_inputPhoto.file_reference = new byte[0];
                    }
                    if (PhotoViewer.this.avatarsDialogId > 0) {
                        MessagesController.getInstance(PhotoViewer.this.currentAccount).deleteUserPhoto(tL_inputPhoto);
                    }
                    MessagesStorage.getInstance(PhotoViewer.this.currentAccount).clearUserPhoto(PhotoViewer.this.avatarsDialogId, photo.id);
                    PhotoViewer.this.imagesArrLocations.remove(PhotoViewer.this.currentIndex);
                    PhotoViewer.this.imagesArrLocationsSizes.remove(PhotoViewer.this.currentIndex);
                    PhotoViewer.this.imagesArrLocationsVideo.remove(PhotoViewer.this.currentIndex);
                    PhotoViewer.this.imagesArrMessages.remove(PhotoViewer.this.currentIndex);
                    PhotoViewer.this.avatarsArr.remove(PhotoViewer.this.currentIndex);
                    if (PhotoViewer.this.imagesArrLocations.isEmpty()) {
                        PhotoViewer.this.closePhoto(false, false);
                    } else {
                        int size2 = PhotoViewer.this.currentIndex;
                        if (size2 >= PhotoViewer.this.avatarsArr.size()) {
                            size2 = PhotoViewer.this.avatarsArr.size() - 1;
                        }
                        PhotoViewer.this.currentIndex = -1;
                        PhotoViewer.this.setImageIndex(size2);
                    }
                    if (message == null) {
                        NotificationCenter.getInstance(PhotoViewer.this.currentAccount).lambda$postNotificationNameOnUIThread$1(NotificationCenter.reloadDialogPhotos, new Object[0]);
                        return;
                    }
                    return;
                }
                if (PhotoViewer.this.avatarsDialogId > 0) {
                    MessagesController.getInstance(PhotoViewer.this.currentAccount).deleteUserPhoto(null);
                } else {
                    MessagesController.getInstance(PhotoViewer.this.currentAccount).changeChatAvatar(-PhotoViewer.this.avatarsDialogId, null, null, null, null, 0.0d, null, null, null, null);
                }
            }
            PhotoViewer.this.closePhoto(false, false);
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onItemClick$13(TLObject tLObject, UserConfig userConfig, TLRPC.Photo photo) {
            if (tLObject instanceof TLRPC.TL_photos_photo) {
                TLRPC.TL_photos_photo tL_photos_photo = (TLRPC.TL_photos_photo) tLObject;
                MessagesController.getInstance(PhotoViewer.this.currentAccount).putUsers(tL_photos_photo.users, false);
                TLRPC.User user = MessagesController.getInstance(PhotoViewer.this.currentAccount).getUser(Long.valueOf(userConfig.clientUserId));
                if (tL_photos_photo.photo instanceof TLRPC.TL_photo) {
                    int iIndexOf = PhotoViewer.this.avatarsArr.indexOf(photo);
                    if (iIndexOf >= 0) {
                        PhotoViewer.this.avatarsArr.set(iIndexOf, tL_photos_photo.photo);
                    }
                    if (user != null) {
                        user.photo.photo_id = tL_photos_photo.photo.id;
                        userConfig.setCurrentUser(user);
                        userConfig.saveConfig(true);
                    }
                }
            }
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onItemClick$14(final UserConfig userConfig, final TLRPC.Photo photo, final TLObject tLObject, TLRPC.TL_error tL_error) {
            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda18
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$onItemClick$13(tLObject, userConfig, photo);
                }
            });
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onItemClick$15() {
            if (PhotoViewer.this.menuItem == null) {
                return;
            }
            PhotoViewer.this.menuItem.hideSubItem(14);
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onItemClick$16() {
            PhotoViewer.this.menuItem.hideSubItem(19);
            PhotoViewer.this.menuItem.showSubItem(20);
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onItemClick$18() {
            PhotoViewer.this.menuItem.showSubItem(19);
            PhotoViewer.this.menuItem.hideSubItem(20);
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onItemClick$2(AlertDialog alertDialog, int i) {
            File pathToMessage;
            if (PhotoViewer.this.currentMessageObject == null) {
                return;
            }
            if ((MessageObject.getMedia(PhotoViewer.this.currentMessageObject.messageOwner) instanceof TLRPC.TL_messageMediaWebPage) && MessageObject.getMedia(PhotoViewer.this.currentMessageObject.messageOwner).webpage != null && MessageObject.getMedia(PhotoViewer.this.currentMessageObject.messageOwner).webpage.document == null) {
                PhotoViewer photoViewer = PhotoViewer.this;
                pathToMessage = FileLoader.getInstance(PhotoViewer.this.currentAccount).getPathToAttach(photoViewer.getFileLocation(photoViewer.currentIndex, null), true);
            } else {
                pathToMessage = FileLoader.getInstance(PhotoViewer.this.currentAccount).getPathToMessage(PhotoViewer.this.currentMessageObject.messageOwner);
            }
            final boolean zIsVideo = PhotoViewer.this.currentMessageObject.isVideo();
            if (pathToMessage == null || !pathToMessage.exists()) {
                PhotoViewer.this.showDownloadAlert();
                return;
            }
            MediaController.saveFile(pathToMessage.toString(), PhotoViewer.this.parentActivity, zIsVideo ? 1 : 0, null, null, new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda15
                @Override // org.telegram.messenger.Utilities.Callback
                public final void run(Object obj) {
                    this.f$0.lambda$onItemClick$1(zIsVideo, (Uri) obj);
                }
            });
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onItemClick$3(int[] iArr, int[] iArr2, boolean z) {
            int i = iArr[0] + 1;
            iArr[0] = i;
            if (i == iArr2[0]) {
                BulletinFactory.createSaveToGalleryBulletin(PhotoViewer.this.containerView, iArr2[0], z, -115203550, -1).show();
            }
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onItemClick$5(final boolean z, ArrayList arrayList, AlertDialog alertDialog, int i) {
            File pathToMessage;
            final int[] iArr = new int[1];
            final int[] iArr2 = new int[1];
            final Runnable runnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda16
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$onItemClick$3(iArr2, iArr, z);
                }
            };
            for (int i2 = 0; i2 < arrayList.size(); i2++) {
                MessageObject messageObject = (MessageObject) arrayList.get(i2);
                if (messageObject != null) {
                    if ((MessageObject.getMedia(messageObject.messageOwner) instanceof TLRPC.TL_messageMediaWebPage) && MessageObject.getMedia(messageObject.messageOwner).webpage != null && MessageObject.getMedia(messageObject.messageOwner).webpage.document == null) {
                        FileLoader fileLoader = FileLoader.getInstance(PhotoViewer.this.currentAccount);
                        PhotoViewer photoViewer = PhotoViewer.this;
                        pathToMessage = fileLoader.getPathToAttach(photoViewer.getFileLocation(photoViewer.currentIndex, null), true);
                    } else {
                        pathToMessage = FileLoader.getInstance(PhotoViewer.this.currentAccount).getPathToMessage(messageObject.messageOwner);
                    }
                    boolean zIsVideo = messageObject.isVideo();
                    if (pathToMessage != null && pathToMessage.exists()) {
                        iArr[0] = iArr[0] + 1;
                        MediaController.saveFile(pathToMessage.toString(), PhotoViewer.this.parentActivity, zIsVideo ? 1 : 0, null, null, new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda17
                            @Override // org.telegram.messenger.Utilities.Callback
                            public final void run(Object obj) {
                                AndroidUtilities.runOnUIThread(runnable);
                            }
                        });
                    }
                }
            }
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onItemClick$7(AlertDialog alertDialog, int i) {
            ArrayList arrayList = new ArrayList(1);
            arrayList.add(PhotoViewer.this.currentMessageObject);
            PhotoViewer.this.showShareAlert(arrayList);
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onItemClick$8(ArrayList arrayList, AlertDialog alertDialog, int i) {
            PhotoViewer.this.showShareAlert(arrayList);
        }

        @Override // org.telegram.ui.ActionBar.ActionBar.ActionBarMenuOnItemClick
        public boolean canOpenMenu() {
            if (PhotoViewer.this.currentMessageObject != null || PhotoViewer.this.currentSecureDocument != null) {
                return true;
            }
            if (PhotoViewer.this.currentFileLocationVideo == null) {
                return PhotoViewer.this.pageBlocksAdapter != null;
            }
            File pathToAttach = FileLoader.getInstance(PhotoViewer.this.currentAccount).getPathToAttach(PhotoViewer.getFileLocation(PhotoViewer.this.currentFileLocationVideo), PhotoViewer.getFileLocationExt(PhotoViewer.this.currentFileLocationVideo), PhotoViewer.this.avatarsDialogId != 0 || PhotoViewer.this.isEvent);
            return pathToAttach.exists() || new File(FileLoader.getDirectory(4), pathToAttach.getName()).exists() || FileLoader.getInstance(PhotoViewer.this.currentAccount).getPathToAttach(PhotoViewer.getFileLocation(PhotoViewer.this.currentFileLocationVideo), PhotoViewer.getFileLocationExt(PhotoViewer.this.currentFileLocationVideo), false).exists();
        }

        /* JADX WARN: Removed duplicated region for block: B:139:0x03bd  */
        /* JADX WARN: Removed duplicated region for block: B:177:0x04f9 A[PHI: r0 r1
          0x04f9: PHI (r0v297 org.telegram.ui.ActionBar.AlertDialog) = (r0v262 org.telegram.ui.ActionBar.AlertDialog), (r0v302 org.telegram.ui.ActionBar.AlertDialog) binds: [B:176:0x04f7, B:109:0x02f3] A[DONT_GENERATE, DONT_INLINE]
          0x04f9: PHI (r1v167 android.view.View) = (r1v158 android.view.View), (r1v177 android.view.View) binds: [B:176:0x04f7, B:109:0x02f3] A[DONT_GENERATE, DONT_INLINE]] */
        /* JADX WARN: Removed duplicated region for block: B:198:0x05ad  */
        /* JADX WARN: Removed duplicated region for block: B:369:0x0a4c  */
        /* JADX WARN: Removed duplicated region for block: B:437:0x0e2c A[RETURN] */
        /* JADX WARN: Removed duplicated region for block: B:438:0x0e2d  */
        /* JADX WARN: Removed duplicated region for block: B:524:? A[RETURN, SYNTHETIC] */
        /* JADX WARN: Type inference failed for: r10v4 */
        /* JADX WARN: Type inference failed for: r10v5, types: [boolean, int] */
        /* JADX WARN: Type inference failed for: r10v7 */
        /* JADX WARN: Type inference failed for: r10v8 */
        /* JADX WARN: Type inference failed for: r10v9 */
        @Override // org.telegram.ui.ActionBar.ActionBar.ActionBarMenuOnItemClick
        /*
            Code decompiled incorrectly, please refer to instructions dump.
        */
        public void onItemClick(int i) throws Resources.NotFoundException {
            String str;
            TLObject tLObject;
            ImageLocation imageLocation;
            TLRPC.Photo photo;
            TLRPC.Document document;
            MessagesController messagesController;
            Object parentObject;
            boolean zIsChannel;
            CharSequence string;
            TLRPC.Chat chat;
            TLRPC.User user;
            boolean z;
            AlertDialog alertDialogCreate;
            View button;
            String str2;
            MessageObject.GroupedMessages group;
            File pathToMessage;
            boolean z2 = true;
            final ?? IsVideo = 0;
            if (i == -1) {
                if (PhotoViewer.this.photoPaintView == null || !PhotoViewer.this.photoPaintView.onBackPressed()) {
                    if (PhotoViewer.this.isCaptionOpen()) {
                        PhotoViewer.this.closeCaptionEnter(false);
                        return;
                    } else {
                        PhotoViewer.this.closePhoto(true, false);
                        return;
                    }
                }
                return;
            }
            TLRPC.Photo photo2 = null;
            File file = null;
            photo2 = null;
            if (i == 2) {
                int i2 = Build.VERSION.SDK_INT;
                if (i2 >= 23 && ((i2 <= 28 || BuildVars.NO_SCOPED_STORAGE) && PhotoViewer.this.parentActivity.checkSelfPermission("android.permission.WRITE_EXTERNAL_STORAGE") != 0)) {
                    PhotoViewer.this.parentActivity.requestPermissions(new String[]{"android.permission.WRITE_EXTERNAL_STORAGE"}, 4);
                    return;
                }
                final ArrayList arrayList = new ArrayList(1);
                if (PhotoViewer.this.parentChatActivity != null) {
                    str2 = "AllNMedia";
                    group = PhotoViewer.this.parentChatActivity.getGroup(PhotoViewer.this.currentMessageObject.getGroupId());
                } else {
                    str2 = "AllNMedia";
                    group = null;
                }
                if (group != null) {
                    arrayList.addAll(group.messages);
                } else {
                    arrayList.add(PhotoViewer.this.currentMessageObject);
                }
                if (arrayList.size() <= 1) {
                    if (PhotoViewer.this.currentMessageObject != null) {
                        if ((MessageObject.getMedia(PhotoViewer.this.currentMessageObject.messageOwner) instanceof TLRPC.TL_messageMediaWebPage) && MessageObject.getMedia(PhotoViewer.this.currentMessageObject.messageOwner).webpage != null && MessageObject.getMedia(PhotoViewer.this.currentMessageObject.messageOwner).webpage.document == null) {
                            PhotoViewer photoViewer = PhotoViewer.this;
                            pathToMessage = FileLoader.getInstance(PhotoViewer.this.currentAccount).getPathToAttach(photoViewer.getFileLocation(photoViewer.currentIndex, null), true);
                            if (!pathToMessage.exists()) {
                                file = new File(FileLoader.getDirectory(4), pathToMessage.getName());
                            }
                            IsVideo = PhotoViewer.this.currentMessageObject.isVideo();
                        } else {
                            pathToMessage = FileLoader.getInstance(PhotoViewer.this.currentAccount).getPathToMessage(PhotoViewer.this.currentMessageObject.messageOwner);
                        }
                        file = pathToMessage;
                        IsVideo = PhotoViewer.this.currentMessageObject.isVideo();
                    } else if (PhotoViewer.this.currentFileLocationVideo != null) {
                        String fileLocationExt = PhotoViewer.getFileLocationExt(PhotoViewer.this.currentFileLocationVideo);
                        File pathToAttach = FileLoader.getInstance(PhotoViewer.this.currentAccount).getPathToAttach(PhotoViewer.getFileLocation(PhotoViewer.this.currentFileLocationVideo), fileLocationExt, PhotoViewer.this.avatarsDialogId != 0 || PhotoViewer.this.isEvent);
                        if (pathToAttach != null && !pathToAttach.exists()) {
                            pathToAttach = FileLoader.getInstance(PhotoViewer.this.currentAccount).getPathToAttach(PhotoViewer.getFileLocation(PhotoViewer.this.currentFileLocationVideo), fileLocationExt, false);
                        }
                        file = pathToAttach;
                        if (fileLocationExt != null) {
                            fileLocationExt = fileLocationExt.toLowerCase();
                        }
                        if (fileLocationExt == null || (!fileLocationExt.equals("webm") && !fileLocationExt.equals("mp4") && !fileLocationExt.equals("gif"))) {
                            z2 = false;
                        }
                        IsVideo = z2;
                    } else if (PhotoViewer.this.pageBlocksAdapter != null) {
                        file = PhotoViewer.this.pageBlocksAdapter.getFile(PhotoViewer.this.currentIndex);
                        IsVideo = PhotoViewer.this.pageBlocksAdapter.isVideo(PhotoViewer.this.currentIndex);
                    }
                    if (file != null && !file.exists()) {
                        file = new File(FileLoader.getDirectory(4), file.getName());
                    }
                    if (file == null || !file.exists()) {
                        PhotoViewer.this.showDownloadAlert();
                        return;
                    } else {
                        MediaController.saveFile(file.toString(), PhotoViewer.this.parentActivity, IsVideo, null, null, new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda7
                            @Override // org.telegram.messenger.Utilities.Callback
                            public final void run(Object obj) {
                                this.f$0.lambda$onItemClick$0(IsVideo, (Uri) obj);
                            }
                        });
                        return;
                    }
                }
                final boolean z3 = false;
                for (int i3 = 0; i3 < arrayList.size() && !z3; i3++) {
                    if (((MessageObject) arrayList.get(i3)).isVideo()) {
                        z3 = true;
                    }
                }
                AlertDialog.Builder negativeButton = new AlertDialog.Builder(PhotoViewer.this.parentActivity, this.val$resourcesProvider).setTitle(LocaleController.getString("SaveGroupMedia", R.string.SaveGroupMedia)).setMessage(LocaleController.getString("SaveGroupMediaMessage", R.string.SaveGroupMediaMessage)).setDialogButtonColorKey(Theme.key_voipgroup_listeningText).setNegativeButton(!z3 ? LocaleController.getString("ThisPhoto", R.string.ThisPhoto) : LocaleController.getString("ThisMedia", R.string.ThisMedia), new AlertDialog.OnButtonClickListener() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda8
                    @Override // org.telegram.ui.ActionBar.AlertDialog.OnButtonClickListener
                    public final void onClick(AlertDialog alertDialog, int i4) {
                        this.f$0.lambda$onItemClick$2(alertDialog, i4);
                    }
                });
                int size = arrayList.size();
                Object[] objArr = new Object[0];
                alertDialogCreate = negativeButton.setPositiveButton(!z3 ? LocaleController.formatPluralString("AllNPhotos", size, objArr) : LocaleController.formatPluralString(str2, size, objArr), new AlertDialog.OnButtonClickListener() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda9
                    @Override // org.telegram.ui.ActionBar.AlertDialog.OnButtonClickListener
                    public final void onClick(AlertDialog alertDialog, int i4) {
                        this.f$0.lambda$onItemClick$5(z3, arrayList, alertDialog, i4);
                    }
                }).setNeutralButton(LocaleController.getString("Cancel", R.string.Cancel), new AlertDialog.OnButtonClickListener() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda10
                    @Override // org.telegram.ui.ActionBar.AlertDialog.OnButtonClickListener
                    public final void onClick(AlertDialog alertDialog, int i4) {
                        alertDialog.dismiss();
                    }
                }).create();
                alertDialogCreate.setBackgroundColor(PhotoViewer.this.getThemedColor(Theme.key_voipgroup_dialogBackground));
                alertDialogCreate.show();
                button = alertDialogCreate.getButton(-3);
                if (button instanceof TextView) {
                    PhotoViewer photoViewer2 = PhotoViewer.this;
                    int i4 = Theme.key_text_RedBold;
                    ((TextView) button).setTextColor(photoViewer2.getThemedColor(i4));
                    button.setBackground(Theme.getRoundRectSelectorDrawable(PhotoViewer.this.getThemedColor(i4)));
                    if ((alertDialogCreate.getButtonsLayout() instanceof LinearLayout) && ((LinearLayout) alertDialogCreate.getButtonsLayout()).getOrientation() == 1) {
                        button.bringToFront();
                    }
                }
            } else {
                if (i == 24) {
                    ChromecastController.getInstance().setCurrentMediaAndCastIfNeeded(PhotoViewer.this.getCurrentChromecastMedia());
                    PhotoViewer.this.castItemButton.performClick();
                    return;
                }
                if (i == 3) {
                    if (PhotoViewer.this.currentDialogId != 0) {
                        PhotoViewer.this.disableShowCheck = true;
                        Bundle bundle = new Bundle();
                        bundle.putLong("dialog_id", PhotoViewer.this.currentDialogId);
                        MediaActivity mediaActivity = new MediaActivity(bundle, null);
                        if (PhotoViewer.this.parentChatActivity != null) {
                            mediaActivity.setChatInfo(PhotoViewer.this.parentChatActivity.getCurrentChatInfo());
                        }
                        PhotoViewer.this.closePhoto(false, false);
                        if (PhotoViewer.this.parentActivity instanceof LaunchActivity) {
                            ((LaunchActivity) PhotoViewer.this.parentActivity).presentFragment(mediaActivity, false, true);
                            return;
                        }
                        return;
                    }
                    return;
                }
                if (i == 5 || i == 21) {
                    if (PhotoViewer.this.currentMessageObject == null) {
                        return;
                    }
                    Bundle bundle2 = new Bundle();
                    long dialogId = PhotoViewer.this.currentDialogId;
                    if (PhotoViewer.this.currentMessageObject != null) {
                        dialogId = PhotoViewer.this.currentMessageObject.getDialogId();
                    }
                    if (DialogObject.isEncryptedDialog(dialogId)) {
                        bundle2.putInt("enc_id", DialogObject.getEncryptedChatId(dialogId));
                    } else {
                        if (DialogObject.isUserDialog(dialogId)) {
                            str = "user_id";
                        } else {
                            TLRPC.Chat chat2 = MessagesController.getInstance(PhotoViewer.this.currentAccount).getChat(Long.valueOf(-dialogId));
                            if (chat2 != null && chat2.migrated_to != null) {
                                bundle2.putLong("migrated_to", dialogId);
                                dialogId = -chat2.migrated_to.channel_id;
                            }
                            dialogId = -dialogId;
                            str = "chat_id";
                        }
                        bundle2.putLong(str, dialogId);
                    }
                    bundle2.putInt("message_id", PhotoViewer.this.currentMessageObject.getId());
                    if (i == 21) {
                        bundle2.putInt("reply_to", PhotoViewer.this.currentMessageObject.getId());
                    }
                    NotificationCenter.getInstance(PhotoViewer.this.currentAccount).lambda$postNotificationNameOnUIThread$1(NotificationCenter.closeChats, new Object[0]);
                    if (PhotoViewer.this.parentActivity instanceof LaunchActivity) {
                        LaunchActivity launchActivity = (LaunchActivity) PhotoViewer.this.parentActivity;
                        launchActivity.presentFragment(new ChatActivity(bundle2), launchActivity.getMainFragmentsCount() > 1 || AndroidUtilities.isTablet(), true);
                    }
                    PhotoViewer.this.closePhoto(false, false);
                    PhotoViewer.this.currentMessageObject = null;
                    if (PhotoViewer.this.ads != null) {
                        PhotoViewer.this.ads.stop();
                        PhotoViewer.this.ads = null;
                        return;
                    }
                    return;
                }
                if (i == 4) {
                    if (PhotoViewer.this.currentMessageObject == null || !(PhotoViewer.this.parentActivity instanceof LaunchActivity)) {
                        return;
                    }
                    if (!PhotoViewer.this.currentMessageObject.scheduled) {
                        long dialogId2 = PhotoViewer.this.currentMessageObject.getDialogId();
                        boolean zIsChannelAndNotMegaGroup = DialogObject.isChatDialog(dialogId2) ? ChatObject.isChannelAndNotMegaGroup(MessagesController.getInstance(PhotoViewer.this.currentAccount).getChat(Long.valueOf(-dialogId2))) : false;
                        ((LaunchActivity) PhotoViewer.this.parentActivity).switchToAccount(PhotoViewer.this.currentMessageObject.currentAccount, true);
                        final ArrayList arrayList2 = new ArrayList(1);
                        MessageObject.GroupedMessages group2 = PhotoViewer.this.parentChatActivity != null ? PhotoViewer.this.parentChatActivity.getGroup(PhotoViewer.this.currentMessageObject.getGroupId()) : null;
                        if (group2 != null) {
                            arrayList2.addAll(group2.messages);
                        } else {
                            arrayList2.add(PhotoViewer.this.currentMessageObject);
                        }
                        if (zIsChannelAndNotMegaGroup && arrayList2.size() <= 1) {
                            PhotoViewer.this.showShareAlert(arrayList2);
                            return;
                        }
                        if (arrayList2.size() <= 1) {
                            Bundle bundle3 = new Bundle();
                            bundle3.putBoolean("onlySelect", true);
                            bundle3.putBoolean("canSelectTopics", true);
                            bundle3.putInt("dialogsType", 3);
                            DialogsActivity dialogsActivity = new DialogsActivity(bundle3);
                            final ArrayList arrayList3 = new ArrayList();
                            arrayList3.add(PhotoViewer.this.currentMessageObject);
                            final ChatActivity chatActivity = PhotoViewer.this.parentChatActivity;
                            dialogsActivity.setDelegate(new DialogsActivity.DialogsActivityDelegate() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda14
                                @Override // org.telegram.ui.DialogsActivity.DialogsActivityDelegate
                                public final boolean didSelectDialogs(DialogsActivity dialogsActivity2, ArrayList arrayList4, CharSequence charSequence, boolean z4, boolean z5, int i5, TopicsFragment topicsFragment) {
                                    return this.f$0.lambda$onItemClick$10(arrayList3, chatActivity, dialogsActivity2, arrayList4, charSequence, z4, z5, i5, topicsFragment);
                                }
                            });
                            ((LaunchActivity) PhotoViewer.this.parentActivity).presentFragment(dialogsActivity, false, true);
                            PhotoViewer.this.closePhoto(false, false);
                            return;
                        }
                        for (int i5 = 0; i5 < arrayList2.size(); i5++) {
                            if (!((MessageObject) arrayList2.get(i5)).isPhoto() || ((MessageObject) arrayList2.get(i5)).isVideo()) {
                                z = false;
                                break;
                            }
                        }
                        z = true;
                        alertDialogCreate = new AlertDialog.Builder(PhotoViewer.this.parentActivity, this.val$resourcesProvider).setTitle(LocaleController.getString("ForwardGroupMedia", R.string.ForwardGroupMedia)).setMessage(LocaleController.getString("ForwardGroupMediaMessage", R.string.ForwardGroupMediaMessage)).setDialogButtonColorKey(Theme.key_voipgroup_listeningText).setNegativeButton(z ? LocaleController.getString("ThisPhoto", R.string.ThisPhoto) : LocaleController.getString("ThisMedia", R.string.ThisMedia), new AlertDialog.OnButtonClickListener() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda11
                            @Override // org.telegram.ui.ActionBar.AlertDialog.OnButtonClickListener
                            public final void onClick(AlertDialog alertDialog, int i6) {
                                this.f$0.lambda$onItemClick$7(alertDialog, i6);
                            }
                        }).setPositiveButton(z ? LocaleController.formatPluralString("AllNPhotos", arrayList2.size(), new Object[0]) : LocaleController.formatPluralString("AllNMedia", arrayList2.size(), new Object[0]), new AlertDialog.OnButtonClickListener() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda12
                            @Override // org.telegram.ui.ActionBar.AlertDialog.OnButtonClickListener
                            public final void onClick(AlertDialog alertDialog, int i6) {
                                this.f$0.lambda$onItemClick$8(arrayList2, alertDialog, i6);
                            }
                        }).setNeutralButton(LocaleController.getString("Cancel", R.string.Cancel), new AlertDialog.OnButtonClickListener() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda13
                            @Override // org.telegram.ui.ActionBar.AlertDialog.OnButtonClickListener
                            public final void onClick(AlertDialog alertDialog, int i6) {
                                alertDialog.dismiss();
                            }
                        }).create();
                        alertDialogCreate.setBackgroundColor(PhotoViewer.this.getThemedColor(Theme.key_voipgroup_dialogBackground));
                        alertDialogCreate.show();
                        button = alertDialogCreate.getButton(-3);
                        if (button instanceof TextView) {
                            PhotoViewer photoViewer3 = PhotoViewer.this;
                            int i6 = Theme.key_text_RedBold;
                            ((TextView) button).setTextColor(photoViewer3.getThemedColor(i6));
                            button.setBackground(Theme.getRoundRectSelectorDrawable(PhotoViewer.this.getThemedColor(i6)));
                            if ((alertDialogCreate.getButtonsLayout() instanceof LinearLayout) && ((LinearLayout) alertDialogCreate.getButtonsLayout()).getOrientation() == 1) {
                            }
                        }
                    }
                } else {
                    if (i == 18) {
                        PhotoViewer.this.openCurrentPhotoInPaintModeForSelect();
                        return;
                    }
                    if (i == 7) {
                        if (PhotoViewer.this.parentActivity == null || PhotoViewer.this.placeProvider == null) {
                            return;
                        }
                        if (PhotoViewer.this.currentMessageObject == null || PhotoViewer.this.currentMessageObject.scheduled) {
                            zIsChannel = false;
                        } else {
                            long dialogId3 = PhotoViewer.this.currentMessageObject.getDialogId();
                            if (DialogObject.isChatDialog(dialogId3)) {
                                zIsChannel = ChatObject.isChannel(MessagesController.getInstance(PhotoViewer.this.currentAccount).getChat(Long.valueOf(-dialogId3)));
                            }
                        }
                        AlertDialog.Builder builder = new AlertDialog.Builder(PhotoViewer.this.parentActivity);
                        CharSequence deleteMessageString = PhotoViewer.this.placeProvider.getDeleteMessageString();
                        if (deleteMessageString != null) {
                            builder.setTitle(LocaleController.getString("AreYouSureDeletePhotoTitle", R.string.AreYouSureDeletePhotoTitle));
                            builder.setMessage(deleteMessageString);
                        } else {
                            if (PhotoViewer.this.isEmbedVideo || (!(PhotoViewer.this.currentFileLocationVideo == null || PhotoViewer.this.currentFileLocationVideo == PhotoViewer.this.currentFileLocation) || (PhotoViewer.this.currentMessageObject != null && PhotoViewer.this.currentMessageObject.isVideo()))) {
                                builder.setTitle(LocaleController.getString("AreYouSureDeleteVideoTitle", R.string.AreYouSureDeleteVideoTitle));
                                string = zIsChannel ? LocaleController.formatString("AreYouSureDeleteVideoEveryone", R.string.AreYouSureDeleteVideoEveryone, new Object[0]) : LocaleController.formatString("AreYouSureDeleteVideo", R.string.AreYouSureDeleteVideo, new Object[0]);
                            } else if (PhotoViewer.this.currentMessageObject == null || !PhotoViewer.this.currentMessageObject.isGif()) {
                                builder.setTitle(LocaleController.getString("AreYouSureDeletePhotoTitle", R.string.AreYouSureDeletePhotoTitle));
                                string = zIsChannel ? LocaleController.formatString("AreYouSureDeletePhotoEveryone", R.string.AreYouSureDeletePhotoEveryone, new Object[0]) : LocaleController.formatString("AreYouSureDeletePhoto", R.string.AreYouSureDeletePhoto, new Object[0]);
                            } else {
                                builder.setTitle(LocaleController.getString("AreYouSureDeleteGIFTitle", R.string.AreYouSureDeleteGIFTitle));
                                string = zIsChannel ? LocaleController.formatString("AreYouSureDeleteGIFEveryone", R.string.AreYouSureDeleteGIFEveryone, new Object[0]) : LocaleController.formatString("AreYouSureDeleteGIF", R.string.AreYouSureDeleteGIF, new Object[0]);
                            }
                            builder.setMessage(string);
                        }
                        final boolean[] zArr = new boolean[1];
                        if (PhotoViewer.this.currentMessageObject != null && !PhotoViewer.this.currentMessageObject.scheduled) {
                            long dialogId4 = PhotoViewer.this.currentMessageObject.getDialogId();
                            if (!DialogObject.isEncryptedDialog(dialogId4)) {
                                if (DialogObject.isUserDialog(dialogId4)) {
                                    user = MessagesController.getInstance(PhotoViewer.this.currentAccount).getUser(Long.valueOf(dialogId4));
                                    chat = null;
                                } else {
                                    chat = MessagesController.getInstance(PhotoViewer.this.currentAccount).getChat(Long.valueOf(-dialogId4));
                                    user = null;
                                }
                                if (user != null || !ChatObject.isChannel(chat)) {
                                    int currentTime = ConnectionsManager.getInstance(PhotoViewer.this.currentAccount).getCurrentTime();
                                    MessagesController messagesController2 = MessagesController.getInstance(PhotoViewer.this.currentAccount);
                                    int i7 = user != null ? messagesController2.revokeTimePmLimit : messagesController2.revokeTimeLimit;
                                    if ((user != null && user.id != UserConfig.getInstance(PhotoViewer.this.currentAccount).getClientUserId()) || chat != null) {
                                        boolean z4 = user != null && MessagesController.getInstance(PhotoViewer.this.currentAccount).canRevokePmInbox;
                                        if ((PhotoViewer.this.currentMessageObject.messageOwner.action == null || (PhotoViewer.this.currentMessageObject.messageOwner.action instanceof TLRPC.TL_messageActionEmpty)) && ((PhotoViewer.this.currentMessageObject.isOut() || z4 || ChatObject.hasAdminRights(chat)) && currentTime - PhotoViewer.this.currentMessageObject.messageOwner.date <= i7)) {
                                            FrameLayout frameLayout = new FrameLayout(PhotoViewer.this.parentActivity);
                                            CheckBoxCell checkBoxCell = new CheckBoxCell(PhotoViewer.this.parentActivity, 1, this.val$resourcesProvider);
                                            checkBoxCell.setBackgroundDrawable(Theme.getSelectorDrawable(false));
                                            checkBoxCell.setText(chat != null ? LocaleController.getString("DeleteForAll", R.string.DeleteForAll) : LocaleController.formatString("DeleteForUser", R.string.DeleteForUser, UserObject.getFirstName(user)), "", false, false);
                                            checkBoxCell.setPadding(LocaleController.isRTL ? AndroidUtilities.dp(16.0f) : AndroidUtilities.dp(8.0f), 0, LocaleController.isRTL ? AndroidUtilities.dp(8.0f) : AndroidUtilities.dp(16.0f), 0);
                                            frameLayout.addView(checkBoxCell, LayoutHelper.createFrame(-1, 48.0f, 51, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED));
                                            checkBoxCell.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda0
                                                @Override // android.view.View.OnClickListener
                                                public final void onClick(View view) {
                                                    PhotoViewer.AnonymousClass17.lambda$onItemClick$11(zArr, view);
                                                }
                                            });
                                            builder.setView(frameLayout);
                                            builder.setCustomViewOffset(9);
                                        }
                                    }
                                }
                            }
                        }
                        builder.setPositiveButton(LocaleController.getString("Delete", R.string.Delete), new AlertDialog.OnButtonClickListener() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda1
                            @Override // org.telegram.ui.ActionBar.AlertDialog.OnButtonClickListener
                            public final void onClick(AlertDialog alertDialog, int i8) throws Resources.NotFoundException {
                                this.f$0.lambda$onItemClick$12(zArr, alertDialog, i8);
                            }
                        });
                        builder.setNegativeButton(LocaleController.getString("Cancel", R.string.Cancel), null);
                        AlertDialog alertDialogCreate2 = builder.create();
                        PhotoViewer.this.showAlertDialog(builder);
                        TextView textView = (TextView) alertDialogCreate2.getButton(-1);
                        if (textView != null) {
                            textView.setTextColor(PhotoViewer.this.getThemedColor(Theme.key_text_RedBold));
                            return;
                        }
                        return;
                    }
                    if (i == 9 || i == 16) {
                        PhotoViewer.this.onSharePressed();
                        return;
                    }
                    if (i == 10) {
                        try {
                            if (!PhotoViewer.this.isEmbedVideo) {
                                if (PhotoViewer.this.currentMessageObject == null) {
                                    if (PhotoViewer.this.pageBlocksAdapter != null) {
                                        if (AndroidUtilities.openForView(PhotoViewer.this.pageBlocksAdapter.getMedia(PhotoViewer.this.currentIndex), PhotoViewer.this.parentActivity)) {
                                        }
                                        PhotoViewer.this.showDownloadAlert();
                                        return;
                                    }
                                    return;
                                }
                                MessageObject messageObject = PhotoViewer.this.currentMessageObject;
                                Activity activity = PhotoViewer.this.parentActivity;
                                Theme.ResourcesProvider resourcesProvider = this.val$resourcesProvider;
                                if (!PhotoViewer.this.currentMessageObject.isVideo() && !PhotoViewer.this.currentMessageObject.isPhoto() && !PhotoViewer.this.currentMessageObject.isSticker()) {
                                    z2 = false;
                                }
                                if (AndroidUtilities.openForView(messageObject, activity, resourcesProvider, z2)) {
                                }
                                PhotoViewer.this.showDownloadAlert();
                                return;
                            }
                            Browser.openUrl(PhotoViewer.this.parentActivity, MessageObject.getMedia(PhotoViewer.this.currentMessageObject.messageOwner).webpage.url);
                            PhotoViewer.this.closePhoto(false, false);
                            return;
                        } catch (Exception e) {
                            FileLog.e(e);
                            return;
                        }
                    }
                    if (i == 11 || i == 13) {
                        if (PhotoViewer.this.parentActivity == null || PhotoViewer.this.currentMessageObject == null) {
                            return;
                        }
                        if (MessageObject.getMedia(PhotoViewer.this.currentMessageObject.messageOwner) instanceof TLRPC.TL_messageMediaPhoto) {
                            tLObject = MessageObject.getMedia(PhotoViewer.this.currentMessageObject.messageOwner).photo;
                        } else if (!(MessageObject.getMedia(PhotoViewer.this.currentMessageObject.messageOwner) instanceof TLRPC.TL_messageMediaDocument)) {
                            return;
                        } else {
                            tLObject = MessageObject.getMedia(PhotoViewer.this.currentMessageObject.messageOwner).document;
                        }
                        PhotoViewer.this.masksAlert = new StickersAlert(PhotoViewer.this.parentActivity, PhotoViewer.this.currentMessageObject, tLObject, this.val$resourcesProvider) { // from class: org.telegram.ui.PhotoViewer.17.1
                            @Override // org.telegram.ui.Components.StickersAlert, org.telegram.ui.ActionBar.BottomSheet, android.app.Dialog, android.content.DialogInterface, org.telegram.ui.ActionBar.BaseFragment.AttachedSheet
                            /* renamed from: dismiss */
                            public void lambda$new$0() {
                                super.lambda$new$0();
                                if (PhotoViewer.this.masksAlert == this) {
                                    PhotoViewer.this.masksAlert = null;
                                }
                            }
                        };
                        PhotoViewer.this.masksAlert.show();
                        return;
                    }
                    if (i == 6) {
                        if (PhotoViewer.this.menuItem.isSubItemVisible(6)) {
                            if (!PhotoViewer.this.isEmbedVideo) {
                                PhotoViewer.this.switchToPip(false);
                                return;
                            }
                            if (PhotoViewer.this.photoViewerWebView.openInPip()) {
                                if (PhotoViewer.PipInstance != null) {
                                    PhotoViewer.PipInstance.destroyPhotoViewer();
                                }
                                PhotoViewer.this.isInline = true;
                                PhotoViewer unused = PhotoViewer.PipInstance = PhotoViewer.Instance;
                                PhotoViewer unused2 = PhotoViewer.Instance = null;
                                PhotoViewer.this.isVisible = false;
                                PhotoViewer.this.isVisibleOrAnimating = false;
                                if (PhotoViewer.this.currentPlaceObject != null && !PhotoViewer.this.currentPlaceObject.imageReceiver.getVisible()) {
                                    PhotoViewer.this.currentPlaceObject.imageReceiver.setVisible(true, true);
                                }
                                PhotoViewer.this.clippingImageProgress = 1.0f;
                                PhotoViewer.this.containerView.invalidate();
                                PhotoViewer.this.dismissInternal();
                                return;
                            }
                            return;
                        }
                        return;
                    }
                    if (i == 8) {
                        if (PhotoViewer.this.currentMessageObject == null) {
                            return;
                        }
                        FileLoader.getInstance(PhotoViewer.this.currentAccount).cancelLoadFile(PhotoViewer.this.currentMessageObject.getDocument());
                        PhotoViewer.this.releasePlayer(false);
                        PhotoViewer.this.bottomLayout.setTag(num);
                        PhotoViewer.this.bottomLayout.setVisibility(0);
                        return;
                    }
                    if (i == 12) {
                        if (PhotoViewer.this.currentMessageObject == null) {
                            if (PhotoViewer.this.pageBlocksAdapter != null) {
                                TLObject media = PhotoViewer.this.pageBlocksAdapter.getMedia(PhotoViewer.this.currentIndex);
                                if (media instanceof TLRPC.Document) {
                                    document = (TLRPC.Document) media;
                                    MediaDataController.getInstance(PhotoViewer.this.currentAccount).addRecentGif(document, (int) (System.currentTimeMillis() / 1000), true);
                                    messagesController = MessagesController.getInstance(PhotoViewer.this.currentAccount);
                                    parentObject = PhotoViewer.this.pageBlocksAdapter.getParentObject();
                                }
                                if (PhotoViewer.this.containerView == null) {
                                    BulletinFactory.of(PhotoViewer.this.containerView, this.val$resourcesProvider).createDownloadBulletin(BulletinFactory.FileType.GIF, this.val$resourcesProvider).show();
                                    return;
                                }
                                return;
                            }
                            return;
                        }
                        document = PhotoViewer.this.currentMessageObject.getDocument();
                        if (PhotoViewer.this.parentChatActivity == null || PhotoViewer.this.parentChatActivity.chatActivityEnterView == null) {
                            MediaDataController.getInstance(PhotoViewer.this.currentAccount).addRecentGif(document, (int) (System.currentTimeMillis() / 1000), true);
                        } else {
                            PhotoViewer.this.parentChatActivity.chatActivityEnterView.addRecentGif(document);
                        }
                        messagesController = MessagesController.getInstance(PhotoViewer.this.currentAccount);
                        parentObject = PhotoViewer.this.currentMessageObject;
                        messagesController.saveGif(parentObject, document);
                        if (PhotoViewer.this.containerView == null) {
                        }
                    } else {
                        if (i == 14) {
                            final TLRPC.Photo photo3 = (TLRPC.Photo) PhotoViewer.this.avatarsArr.get(PhotoViewer.this.currentIndex);
                            if (photo3 == null || photo3.sizes.isEmpty()) {
                                return;
                            }
                            TLRPC.PhotoSize closestPhotoSizeWithSize = FileLoader.getClosestPhotoSizeWithSize(photo3.sizes, 800);
                            TLRPC.PhotoSize closestPhotoSizeWithSize2 = FileLoader.getClosestPhotoSizeWithSize(photo3.sizes, 90);
                            final UserConfig userConfig = UserConfig.getInstance(PhotoViewer.this.currentAccount);
                            if (PhotoViewer.this.avatarsDialogId == userConfig.clientUserId) {
                                TLRPC.TL_photos_updateProfilePhoto tL_photos_updateProfilePhoto = new TLRPC.TL_photos_updateProfilePhoto();
                                TLRPC.TL_inputPhoto tL_inputPhoto = new TLRPC.TL_inputPhoto();
                                tL_photos_updateProfilePhoto.id = tL_inputPhoto;
                                tL_inputPhoto.id = photo3.id;
                                tL_inputPhoto.access_hash = photo3.access_hash;
                                tL_inputPhoto.file_reference = photo3.file_reference;
                                ConnectionsManager.getInstance(PhotoViewer.this.currentAccount).sendRequest(tL_photos_updateProfilePhoto, new RequestDelegate() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda2
                                    @Override // org.telegram.tgnet.RequestDelegate
                                    public final void run(TLObject tLObject2, TLRPC.TL_error tL_error) {
                                        this.f$0.lambda$onItemClick$14(userConfig, photo3, tLObject2, tL_error);
                                    }
                                });
                                TLRPC.User user2 = MessagesController.getInstance(PhotoViewer.this.currentAccount).getUser(Long.valueOf(userConfig.clientUserId));
                                if (user2 != null) {
                                    TLRPC.UserProfilePhoto userProfilePhoto = user2.photo;
                                    userProfilePhoto.photo_id = photo3.id;
                                    userProfilePhoto.dc_id = photo3.dc_id;
                                    userProfilePhoto.photo_small = closestPhotoSizeWithSize2.location;
                                    userProfilePhoto.photo_big = closestPhotoSizeWithSize.location;
                                    userConfig.setCurrentUser(user2);
                                    userConfig.saveConfig(true);
                                    NotificationCenter.getInstance(PhotoViewer.this.currentAccount).lambda$postNotificationNameOnUIThread$1(NotificationCenter.mainUserInfoChanged, new Object[0]);
                                }
                            } else {
                                TLRPC.Chat chat3 = MessagesController.getInstance(PhotoViewer.this.currentAccount).getChat(Long.valueOf(-PhotoViewer.this.avatarsDialogId));
                                if (chat3 == null) {
                                    return;
                                }
                                TLRPC.TL_inputChatPhoto tL_inputChatPhoto = new TLRPC.TL_inputChatPhoto();
                                TLRPC.TL_inputPhoto tL_inputPhoto2 = new TLRPC.TL_inputPhoto();
                                tL_inputChatPhoto.id = tL_inputPhoto2;
                                tL_inputPhoto2.id = photo3.id;
                                tL_inputPhoto2.access_hash = photo3.access_hash;
                                tL_inputPhoto2.file_reference = photo3.file_reference;
                                MessagesController.getInstance(PhotoViewer.this.currentAccount).changeChatAvatar(-PhotoViewer.this.avatarsDialogId, tL_inputChatPhoto, null, null, null, 0.0d, null, null, null, null);
                                TLRPC.ChatPhoto chatPhoto = chat3.photo;
                                chatPhoto.dc_id = photo3.dc_id;
                                chatPhoto.photo_small = closestPhotoSizeWithSize2.location;
                                chatPhoto.photo_big = closestPhotoSizeWithSize.location;
                                NotificationCenter.getInstance(PhotoViewer.this.currentAccount).lambda$postNotificationNameOnUIThread$1(NotificationCenter.updateInterfaces, Integer.valueOf(MessagesController.UPDATE_MASK_AVATAR));
                            }
                            PhotoViewer.this.currentAvatarLocation = ImageLocation.getForPhoto(closestPhotoSizeWithSize, photo3);
                            PhotoViewer.this.avatarsArr.remove(PhotoViewer.this.currentIndex);
                            PhotoViewer.this.avatarsArr.add(0, photo3);
                            ImageLocation imageLocation2 = (ImageLocation) PhotoViewer.this.imagesArrLocations.get(PhotoViewer.this.currentIndex);
                            PhotoViewer.this.imagesArrLocations.remove(PhotoViewer.this.currentIndex);
                            PhotoViewer.this.imagesArrLocations.add(0, imageLocation2);
                            ImageLocation imageLocation3 = (ImageLocation) PhotoViewer.this.imagesArrLocationsVideo.get(PhotoViewer.this.currentIndex);
                            PhotoViewer.this.imagesArrLocationsVideo.remove(PhotoViewer.this.currentIndex);
                            PhotoViewer.this.imagesArrLocationsVideo.add(0, imageLocation3);
                            Long l = (Long) PhotoViewer.this.imagesArrLocationsSizes.get(PhotoViewer.this.currentIndex);
                            PhotoViewer.this.imagesArrLocationsSizes.remove(PhotoViewer.this.currentIndex);
                            PhotoViewer.this.imagesArrLocationsSizes.add(0, l);
                            TLRPC.Message message = (TLRPC.Message) PhotoViewer.this.imagesArrMessages.get(PhotoViewer.this.currentIndex);
                            PhotoViewer.this.imagesArrMessages.remove(PhotoViewer.this.currentIndex);
                            PhotoViewer.this.imagesArrMessages.add(0, message);
                            PhotoViewer.this.currentIndex = -1;
                            PhotoViewer.this.setImageIndex(0);
                            PhotoViewer.this.groupedPhotosListView.clear();
                            PhotoViewer.this.groupedPhotosListView.fillList();
                            PhotoViewer.this.hintView.showWithAction(PhotoViewer.this.avatarsDialogId, 22, PhotoViewer.this.currentFileLocationVideo == PhotoViewer.this.currentFileLocation ? null : 1);
                            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda3
                                @Override // java.lang.Runnable
                                public final void run() {
                                    this.f$0.lambda$onItemClick$15();
                                }
                            }, 300L);
                            return;
                        }
                        if (i == 15) {
                            File pathToAttach2 = FileLoader.getInstance(PhotoViewer.this.currentAccount).getPathToAttach(PhotoViewer.getFileLocation(PhotoViewer.this.currentFileLocationVideo), PhotoViewer.getFileLocationExt(PhotoViewer.this.currentFileLocationVideo), true);
                            boolean z5 = PhotoViewer.this.currentFileLocationVideo.imageType == 2;
                            PhotoViewer.this.placeProvider.openPhotoForEdit(pathToAttach2.getAbsolutePath(), z5 ? FileLoader.getInstance(PhotoViewer.this.currentAccount).getPathToAttach(PhotoViewer.getFileLocation(PhotoViewer.this.currentFileLocation), PhotoViewer.getFileLocationExt(PhotoViewer.this.currentFileLocation), true).getAbsolutePath() : null, z5);
                            return;
                        }
                        if (i == 19) {
                            if (PhotoViewer.this.switchingToIndex < 0 || PhotoViewer.this.switchingToIndex >= PhotoViewer.this.imagesArr.size()) {
                                return;
                            }
                            MessageObject messageObject2 = (MessageObject) PhotoViewer.this.imagesArr.get(PhotoViewer.this.switchingToIndex);
                            PhotoViewer.this.captionTranslated = true;
                            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda4
                                @Override // java.lang.Runnable
                                public final void run() {
                                    this.f$0.lambda$onItemClick$16();
                                }
                            }, 32L);
                            PhotoViewer.this.updateCaptionTranslated();
                            TranslateController translateController = MessagesController.getInstance(PhotoViewer.this.currentAccount).getTranslateController();
                            final PhotoViewer photoViewer4 = PhotoViewer.this;
                            translateController.translatePhoto(messageObject2, new Runnable() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda5
                                @Override // java.lang.Runnable
                                public final void run() {
                                    PhotoViewer.access$17900(photoViewer4);
                                }
                            });
                            return;
                        }
                        if (i == 20) {
                            PhotoViewer.this.captionTranslated = false;
                            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$17$$ExternalSyntheticLambda6
                                @Override // java.lang.Runnable
                                public final void run() {
                                    this.f$0.lambda$onItemClick$18();
                                }
                            }, 32L);
                            PhotoViewer.this.updateCaptionTranslated();
                            return;
                        }
                        if (i == 22) {
                            PhotoViewer.this.playerLooping = !r0.playerLooping;
                            VideoPlayer.saveLooping(PhotoViewer.this.playerLooping, PhotoViewer.this.currentMessageObject);
                            if (PhotoViewer.this.videoPlayer != null) {
                                PhotoViewer.this.videoPlayer.setLooping(PhotoViewer.this.playerLooping);
                            }
                            PhotoViewer.this.loopItem.setEnabledByColor(PhotoViewer.this.playerLooping, -1, -9194260);
                            PhotoViewer.this.loopItem.setSelectorColor(PhotoViewer.this.playerLooping ? 259241196 : 268435455);
                            return;
                        }
                        if (i != 23) {
                            return;
                        }
                        if (PhotoViewer.this.currentFileLocation == null || PhotoViewer.this.currentFileLocation.photo == null) {
                            if (PhotoViewer.this.currentFileLocationVideo != null && PhotoViewer.this.currentFileLocationVideo.photo != null) {
                                imageLocation = PhotoViewer.this.currentFileLocationVideo;
                            }
                            photo = photo2;
                            if (photo != null) {
                                return;
                            }
                            AlertsCreator.createReportPhotoAlert(PhotoViewer.this.currentAccount, PhotoViewer.this.parentActivity, PhotoViewer.this.avatarsDialogId, photo, new DarkThemeResourceProvider());
                            return;
                        }
                        imageLocation = PhotoViewer.this.currentFileLocation;
                        photo2 = imageLocation.photo;
                        photo = photo2;
                        if (photo != null) {
                        }
                    }
                }
            }
            alertDialogCreate.setTextColor(PhotoViewer.this.getThemedColor(Theme.key_voipgroup_actionBarItems));
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$28, reason: invalid class name */
    class AnonymousClass28 implements VideoTimelinePlayView.VideoTimelineViewDelegate {
        private int seekTo;
        private Runnable seekToRunnable;
        private boolean wasPlaying;

        AnonymousClass28() {
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$seekTo$0() {
            PhotoViewer.this.seekVideoOrWebTo(this.seekTo);
            if (PhotoViewer.this.sendPhotoType == 1) {
                PhotoViewer.this.needCaptureFrameReadyAtTime = this.seekTo;
                if (PhotoViewer.this.captureFrameReadyAtTime != PhotoViewer.this.needCaptureFrameReadyAtTime) {
                    PhotoViewer.this.captureFrameReadyAtTime = -1L;
                }
            }
            this.seekToRunnable = null;
        }

        private void seekTo(float f) {
            this.seekTo = (int) (PhotoViewer.this.videoDuration * f);
            if (SharedConfig.getDevicePerformanceClass() != 2) {
                if (this.seekToRunnable == null) {
                    Runnable runnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$28$$ExternalSyntheticLambda0
                        @Override // java.lang.Runnable
                        public final void run() {
                            this.f$0.lambda$seekTo$0();
                        }
                    };
                    this.seekToRunnable = runnable;
                    AndroidUtilities.runOnUIThread(runnable, 100L);
                    return;
                }
                return;
            }
            PhotoViewer.this.seekVideoOrWebTo(this.seekTo);
            if (PhotoViewer.this.sendPhotoType == 1) {
                PhotoViewer.this.needCaptureFrameReadyAtTime = this.seekTo;
                if (PhotoViewer.this.captureFrameReadyAtTime != PhotoViewer.this.needCaptureFrameReadyAtTime) {
                    PhotoViewer.this.captureFrameReadyAtTime = -1L;
                }
            }
            this.seekToRunnable = null;
        }

        private void updateAvatarStartTime(int i) {
            PhotoViewer photoViewer;
            float f;
            float rightProgress;
            if (PhotoViewer.this.sendPhotoType != 1) {
                return;
            }
            if (i == 0) {
                PhotoViewer photoViewer2 = PhotoViewer.this;
                photoViewer2.avatarStartProgress = photoViewer2.videoTimelineView.getProgress();
                PhotoViewer photoViewer3 = PhotoViewer.this;
                photoViewer3.avatarStartTime = (long) (photoViewer3.videoDuration * 1000.0f * PhotoViewer.this.avatarStartProgress);
                return;
            }
            if (PhotoViewer.this.photoCropView != null) {
                if (PhotoViewer.this.videoTimelineView.getLeftProgress() > PhotoViewer.this.avatarStartProgress || PhotoViewer.this.videoTimelineView.getRightProgress() < PhotoViewer.this.avatarStartProgress) {
                    PhotoViewer.this.photoCropView.setVideoThumbVisible(false);
                    if (i == 1) {
                        photoViewer = PhotoViewer.this;
                        f = photoViewer.videoDuration * 1000.0f;
                        rightProgress = PhotoViewer.this.videoTimelineView.getLeftProgress();
                    } else {
                        photoViewer = PhotoViewer.this;
                        f = photoViewer.videoDuration * 1000.0f;
                        rightProgress = PhotoViewer.this.videoTimelineView.getRightProgress();
                    }
                    photoViewer.avatarStartTime = (long) (f * rightProgress);
                    PhotoViewer.this.captureFrameAtTime = -1L;
                }
            }
        }

        @Override // org.telegram.ui.Components.VideoTimelinePlayView.VideoTimelineViewDelegate
        public void didStartDragging(int i) {
            if (i == VideoTimelinePlayView.TYPE_PROGRESS) {
                PhotoViewer.this.cancelVideoPlayRunnable();
                if (PhotoViewer.this.sendPhotoType == 1) {
                    PhotoViewer.this.cancelFlashAnimations();
                    PhotoViewer.this.captureFrameAtTime = -1L;
                }
                boolean zIsVideoPlaying = PhotoViewer.this.isVideoPlaying();
                this.wasPlaying = zIsVideoPlaying;
                if (zIsVideoPlaying) {
                    PhotoViewer.this.manuallyPaused = false;
                    PhotoViewer.this.pauseVideoOrWeb();
                    PhotoViewer.this.containerView.invalidate();
                }
            }
        }

        @Override // org.telegram.ui.Components.VideoTimelinePlayView.VideoTimelineViewDelegate
        public void didStopDragging(int i) {
            Runnable runnable = this.seekToRunnable;
            if (runnable != null) {
                AndroidUtilities.cancelRunOnUIThread(runnable);
                this.seekToRunnable.run();
            }
            PhotoViewer.this.cancelVideoPlayRunnable();
            if (PhotoViewer.this.sendPhotoType != 1 || PhotoViewer.this.flashView == null || i != VideoTimelinePlayView.TYPE_PROGRESS) {
                if (PhotoViewer.this.sendPhotoType == 1 || this.wasPlaying) {
                    PhotoViewer.this.manuallyPaused = false;
                    PhotoViewer.this.playVideoOrWeb();
                    return;
                }
                return;
            }
            PhotoViewer.this.cancelFlashAnimations();
            PhotoViewer photoViewer = PhotoViewer.this;
            photoViewer.captureFrameAtTime = photoViewer.avatarStartTime;
            if (PhotoViewer.this.captureFrameReadyAtTime == this.seekTo) {
                PhotoViewer.this.captureCurrentFrame();
            }
        }

        @Override // org.telegram.ui.Components.VideoTimelinePlayView.VideoTimelineViewDelegate
        public void onLeftProgressChanged(float f) {
            if (PhotoViewer.this.videoPlayer == null) {
                return;
            }
            if (PhotoViewer.this.videoPlayer.isPlaying()) {
                PhotoViewer.this.manuallyPaused = false;
                PhotoViewer.this.videoPlayer.pause();
                PhotoViewer.this.containerView.invalidate();
            }
            updateAvatarStartTime(1);
            seekTo(f);
            PhotoViewer.this.videoPlayerSeekbar.setProgress(BitmapDescriptorFactory.HUE_RED);
            PhotoViewer.this.videoTimelineView.setProgress(f);
            PhotoViewer.this.updateVideoInfo();
        }

        @Override // org.telegram.ui.Components.VideoTimelinePlayView.VideoTimelineViewDelegate
        public void onPlayProgressChanged(float f) {
            if (PhotoViewer.this.videoPlayer == null) {
                return;
            }
            if (PhotoViewer.this.sendPhotoType == 1) {
                updateAvatarStartTime(0);
            }
            seekTo(f);
        }

        @Override // org.telegram.ui.Components.VideoTimelinePlayView.VideoTimelineViewDelegate
        public void onRightProgressChanged(float f) {
            if (PhotoViewer.this.videoPlayer == null) {
                return;
            }
            if (PhotoViewer.this.videoPlayer.isPlaying()) {
                PhotoViewer.this.manuallyPaused = false;
                PhotoViewer.this.videoPlayer.pause();
                PhotoViewer.this.containerView.invalidate();
            }
            updateAvatarStartTime(2);
            seekTo(f);
            PhotoViewer.this.videoPlayerSeekbar.setProgress(1.0f);
            PhotoViewer.this.videoTimelineView.setProgress(f);
            PhotoViewer.this.updateVideoInfo();
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$38, reason: invalid class name */
    class AnonymousClass38 implements DialogInterface.OnDismissListener {
        AnonymousClass38() {
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onDismiss$0() {
            if (PhotoViewer.this.lastFrameImageView == null || PhotoViewer.this.lastFrameImageView.getParent() == null) {
                return;
            }
            ((ViewGroup) PhotoViewer.this.lastFrameImageView.getParent()).removeView(PhotoViewer.this.lastFrameImageView);
            if (PhotoViewer.this.lastFrameBitmap != null) {
                if (PhotoViewer.this.lastFrameImageView != null) {
                    PhotoViewer.this.lastFrameImageView.setBackground(null);
                }
                AndroidUtilities.recycleBitmap(PhotoViewer.this.lastFrameBitmap);
                PhotoViewer.this.lastFrameBitmap = null;
            }
            PhotoViewer.this.lastFrameImageView = null;
        }

        @Override // android.content.DialogInterface.OnDismissListener
        public void onDismiss(DialogInterface dialogInterface) {
            if (PhotoViewer.this.lastFrameImageView != null) {
                PhotoViewer.this.lastFrameImageView.animate().alpha(BitmapDescriptorFactory.HUE_RED).withEndAction(new Runnable() { // from class: org.telegram.ui.PhotoViewer$38$$ExternalSyntheticLambda0
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$onDismiss$0();
                    }
                }).setDuration(150L).start();
            }
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$40, reason: invalid class name */
    class AnonymousClass40 extends ShareAlert {
        final /* synthetic */ boolean val$finalOpenKeyboardOnShareAlertClose;
        final /* synthetic */ FrameLayout val$photoContainerView;

        /* JADX WARN: 'super' call moved to the top of the method (can break code semantics) */
        AnonymousClass40(Context context, ChatActivity chatActivity, ArrayList arrayList, String str, String str2, boolean z, String str3, String str4, boolean z2, boolean z3, boolean z4, Integer num, Theme.ResourcesProvider resourcesProvider, FrameLayout frameLayout, boolean z5) {
            super(context, chatActivity, arrayList, str, str2, z, str3, str4, z2, z3, z4, num, resourcesProvider);
            this.val$photoContainerView = frameLayout;
            this.val$finalOpenKeyboardOnShareAlertClose = z5;
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$dismissInternal$1() {
            if (PhotoViewer.this.parentChatActivity == null || PhotoViewer.this.parentChatActivity.getChatActivityEnterView() == null) {
                return;
            }
            PhotoViewer.this.parentChatActivity.getChatActivityEnterView().openKeyboard();
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onSend$0(FrameLayout frameLayout, LongSparseArray longSparseArray, int i) {
            BulletinFactory.createForwardedBulletin(PhotoViewer.this.parentActivity, null, frameLayout, longSparseArray.size(), longSparseArray.size() == 1 ? ((TLRPC.Dialog) longSparseArray.valueAt(0)).id : 0L, i, -115203550, -1, 1500).show();
        }

        @Override // org.telegram.ui.Components.ShareAlert, org.telegram.ui.ActionBar.BottomSheet
        public void dismissInternal() {
            super.dismissInternal();
            if (this.val$finalOpenKeyboardOnShareAlertClose) {
                AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$40$$ExternalSyntheticLambda1
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$dismissInternal$1();
                    }
                }, 50L);
            }
            PhotoViewer.this.requestAdjust();
        }

        @Override // org.telegram.ui.Components.ShareAlert
        protected void onSend(final LongSparseArray longSparseArray, final int i, TLRPC.TL_forumTopic tL_forumTopic, boolean z) {
            if (z) {
                final FrameLayout frameLayout = this.val$photoContainerView;
                AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$40$$ExternalSyntheticLambda0
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$onSend$0(frameLayout, longSparseArray, i);
                    }
                }, 250L);
            }
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$44, reason: invalid class name */
    class AnonymousClass44 extends AnimatorListenerAdapter {
        final /* synthetic */ View val$textureView;

        AnonymousClass44(View view) {
            this.val$textureView = view;
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onAnimationEnd$0(View view) {
            view.setOutlineProvider(null);
            if (PhotoViewer.this.textureImageView != null) {
                PhotoViewer.this.textureImageView.setOutlineProvider(null);
            }
            if (PhotoViewer.this.firstFrameView != null) {
                PhotoViewer.this.firstFrameView.setOutlineProvider(null);
            }
        }

        @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
        public void onAnimationEnd(Animator animator) {
            PhotoViewer.this.pipAnimationInProgress = false;
            PhotoViewer.this.switchToInlineRunnable.run();
            final View view = this.val$textureView;
            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$44$$ExternalSyntheticLambda0
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$onAnimationEnd$0(view);
                }
            }, 100L);
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$55, reason: invalid class name */
    class AnonymousClass55 implements VideoPlayer.VideoPlayerDelegate {
        private boolean firstState = true;

        AnonymousClass55() {
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onError$0(AlertDialog alertDialog, int i) {
            try {
                AndroidUtilities.openForView(PhotoViewer.this.currentMessageObject, PhotoViewer.this.parentActivity, PhotoViewer.this.resourcesProvider, true);
                PhotoViewer.this.closePhoto(false, false);
            } catch (Exception e) {
                FileLog.e(e);
            }
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onRenderedFirstFrame$1() {
            PhotoViewer.this.firstFrameView.updateAlpha();
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onRenderedFirstFrame$2() {
            PhotoViewer.this.firstFrameView.updateAlpha();
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onSurfaceTextureUpdated$3() {
            if (PhotoViewer.this.firstFrameView != null) {
                PhotoViewer.this.firstFrameView.checkFromPlayer(PhotoViewer.this.videoPlayer);
            }
        }

        @Override // org.telegram.ui.Components.VideoPlayer.VideoPlayerDelegate
        public void onError(VideoPlayer videoPlayer, Exception exc) {
            if (PhotoViewer.this.videoPlayer != videoPlayer) {
                return;
            }
            FileLog.e(exc);
            if (PhotoViewer.this.menuItem.isSubItemVisible(10)) {
                AlertDialog.Builder builder = new AlertDialog.Builder(PhotoViewer.this.parentActivity, PhotoViewer.this.resourcesProvider);
                builder.setTitle(LocaleController.getString("AppName", R.string.AppName));
                builder.setMessage(LocaleController.getString(R.string.CantPlayVideo));
                builder.setPositiveButton(LocaleController.getString("Open", R.string.Open), new AlertDialog.OnButtonClickListener() { // from class: org.telegram.ui.PhotoViewer$55$$ExternalSyntheticLambda2
                    @Override // org.telegram.ui.ActionBar.AlertDialog.OnButtonClickListener
                    public final void onClick(AlertDialog alertDialog, int i) {
                        this.f$0.lambda$onError$0(alertDialog, i);
                    }
                });
                builder.setNegativeButton(LocaleController.getString("Cancel", R.string.Cancel), null);
                PhotoViewer.this.showAlertDialog(builder);
            }
        }

        @Override // org.telegram.ui.Components.VideoPlayer.VideoPlayerDelegate
        public void onRenderedFirstFrame() {
            if (!PhotoViewer.this.textureUploaded) {
                PhotoViewer.this.textureUploaded = true;
                PhotoViewer.this.containerView.invalidate();
            }
            if (PhotoViewer.this.firstFrameView != null) {
                if (PhotoViewer.this.videoPlayer == null || !PhotoViewer.this.videoPlayer.isLooping()) {
                    AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$55$$ExternalSyntheticLambda1
                        @Override // java.lang.Runnable
                        public final void run() {
                            this.f$0.lambda$onRenderedFirstFrame$1();
                        }
                    }, 64L);
                }
            }
        }

        @Override // org.telegram.ui.Components.VideoPlayer.VideoPlayerDelegate
        public void onRenderedFirstFrame(AnalyticsListener.EventTime eventTime) {
            Runnable runnable = PhotoViewer.this.pipFirstFrameCallback;
            if (runnable != null) {
                runnable.run();
                PhotoViewer.this.pipFirstFrameCallback = null;
            }
            if (eventTime.eventPlaybackPositionMs == PhotoViewer.this.needCaptureFrameReadyAtTime) {
                PhotoViewer.this.captureFrameReadyAtTime = eventTime.eventPlaybackPositionMs;
                PhotoViewer.this.needCaptureFrameReadyAtTime = -1L;
                PhotoViewer.this.captureCurrentFrame();
            }
            if (PhotoViewer.this.firstFrameView != null) {
                if (PhotoViewer.this.videoPlayer == null || !PhotoViewer.this.videoPlayer.isLooping()) {
                    AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$55$$ExternalSyntheticLambda3
                        @Override // java.lang.Runnable
                        public final void run() {
                            this.f$0.lambda$onRenderedFirstFrame$2();
                        }
                    }, 64L);
                }
            }
        }

        @Override // org.telegram.ui.Components.VideoPlayer.VideoPlayerDelegate
        public /* synthetic */ void onSeekFinished(AnalyticsListener.EventTime eventTime) {
            VideoPlayer.VideoPlayerDelegate.CC.$default$onSeekFinished(this, eventTime);
        }

        @Override // org.telegram.ui.Components.VideoPlayer.VideoPlayerDelegate
        public /* synthetic */ void onSeekStarted(AnalyticsListener.EventTime eventTime) {
            VideoPlayer.VideoPlayerDelegate.CC.$default$onSeekStarted(this, eventTime);
        }

        @Override // org.telegram.ui.Components.VideoPlayer.VideoPlayerDelegate
        public void onStateChanged(boolean z, int i) {
            if (PhotoViewer.this.videoPlayer != null) {
                PhotoViewer.this.videoPlayer.setMute(CastSync.isActive() || PhotoViewer.this.muteVideo);
            }
            if (this.firstState && PhotoViewer.this.videoPlayer != null && PhotoViewer.this.videoPlayer.getDuration() != -9223372036854775807L) {
                this.firstState = false;
                if (PhotoViewer.this.imagesArr.isEmpty() && PhotoViewer.this.secureDocuments.isEmpty() && PhotoViewer.this.imagesArrLocations.isEmpty() && !PhotoViewer.this.imagesArrLocals.isEmpty() && PhotoViewer.this.switchingToIndex >= 0 && PhotoViewer.this.switchingToIndex < PhotoViewer.this.imagesArrLocals.size()) {
                    Object obj = PhotoViewer.this.imagesArrLocals.get(PhotoViewer.this.switchingToIndex);
                    if (obj instanceof MediaController.PhotoEntry) {
                        MediaController.PhotoEntry photoEntry = (MediaController.PhotoEntry) obj;
                        if (photoEntry.isVideo && photoEntry.editedInfo != null) {
                            PhotoViewer.this.videoPlayer.seekTo((long) (photoEntry.editedInfo.start * PhotoViewer.this.videoPlayer.getDuration()));
                            if (PhotoViewer.this.videoTimelineView != null) {
                                PhotoViewer.this.videoTimelineView.setProgress(photoEntry.editedInfo.start);
                            }
                        }
                    }
                }
            }
            PhotoViewer.this.updatePlayerState(z, i);
        }

        @Override // org.telegram.ui.Components.VideoPlayer.VideoPlayerDelegate
        public boolean onSurfaceDestroyed(SurfaceTexture surfaceTexture) {
            TextureView pipTextureView;
            TextureView textureView;
            if (PipVideoOverlay.getPipSource() == null || !PipVideoOverlay.getPipSource().state2.isAttachedToPip() || (textureView = PhotoViewer.this.changedTextureView) == null || textureView.getSurfaceTexture() != surfaceTexture) {
                if (PhotoViewer.this.changingTextureView) {
                    PhotoViewer.this.changingTextureView = false;
                    if (PhotoViewer.this.isInline) {
                        PhotoViewer.this.waitingForFirstTextureUpload = 1;
                        PhotoViewer.this.changedTextureView.setSurfaceTexture(surfaceTexture);
                        PhotoViewer photoViewer = PhotoViewer.this;
                        photoViewer.changedTextureView.setSurfaceTextureListener(photoViewer.surfaceTextureListener);
                        pipTextureView = PhotoViewer.this.changedTextureView;
                    }
                }
                return false;
            }
            PipVideoOverlay.getPipTextureView().setSurfaceTexture(surfaceTexture);
            pipTextureView = PipVideoOverlay.getPipTextureView();
            pipTextureView.setVisibility(0);
            return true;
        }

        @Override // org.telegram.ui.Components.VideoPlayer.VideoPlayerDelegate
        public void onSurfaceTextureUpdated(SurfaceTexture surfaceTexture) {
            PhotoViewer.this.checkChangedTextureView(false);
            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$55$$ExternalSyntheticLambda0
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$onSurfaceTextureUpdated$3();
                }
            });
        }

        @Override // org.telegram.ui.Components.VideoPlayer.VideoPlayerDelegate
        public void onVideoSizeChanged(int i, int i2, int i3, float f) {
            if (PhotoViewer.this.aspectRatioFrameLayout != null) {
                if (i3 == 90 || i3 == 270) {
                    i2 = i;
                    i = i2;
                }
                float f2 = i * f;
                int i4 = (int) f2;
                PhotoViewer.this.videoWidth = i4;
                float f3 = i2;
                PhotoViewer.this.videoHeight = (int) (f * f3);
                if (PhotoViewer.this.pipSource != null) {
                    PhotoViewer.this.pipSource.setContentRatio(PhotoViewer.this.videoWidth, PhotoViewer.this.videoHeight);
                }
                PhotoViewer.this.aspectRatioFrameLayout.setAspectRatio(i2 == 0 ? 1.0f : f2 / f3, i3);
                if (PhotoViewer.this.videoTextureView instanceof VideoEditTextureView) {
                    ((VideoEditTextureView) PhotoViewer.this.videoTextureView).setHDRInfo(PhotoViewer.this.videoPlayer.getHDRStaticInfo(null));
                    ((VideoEditTextureView) PhotoViewer.this.videoTextureView).setVideoSize(i4, i2);
                    if (PhotoViewer.this.sendPhotoType == 1) {
                        PhotoViewer.this.setCropBitmap();
                    }
                }
                PhotoViewer.this.videoSizeSet = true;
            }
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$58, reason: invalid class name */
    class AnonymousClass58 implements PhotoCropView.PhotoCropViewDelegate {
        AnonymousClass58() {
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onVideoThumbClick$0() {
            PhotoViewer.this.manuallyPaused = false;
            if (PhotoViewer.this.videoPlayer != null) {
                PhotoViewer.this.videoPlayer.play();
            }
            PhotoViewer.this.videoPlayRunnable = null;
        }

        @Override // org.telegram.ui.Components.PhotoCropView.PhotoCropViewDelegate
        public int getVideoThumbX() {
            return (int) (AndroidUtilities.dp(16.0f) + ((PhotoViewer.this.videoTimelineView.getMeasuredWidth() - AndroidUtilities.dp(32.0f)) * PhotoViewer.this.avatarStartProgress));
        }

        @Override // org.telegram.ui.Components.PhotoCropView.PhotoCropViewDelegate
        public boolean mirror() {
            return PhotoViewer.this.cropMirror();
        }

        @Override // org.telegram.ui.Components.PhotoCropView.PhotoCropViewDelegate
        public void onChange(boolean z) {
            PhotoViewer.this.updateResetButtonVisibility(!z);
        }

        @Override // org.telegram.ui.Components.PhotoCropView.PhotoCropViewDelegate
        public void onTapUp() {
            if (PhotoViewer.this.sendPhotoType == 1) {
                PhotoViewer.this.manuallyPaused = true;
                PhotoViewer.this.toggleVideoPlayer();
            }
        }

        @Override // org.telegram.ui.Components.PhotoCropView.PhotoCropViewDelegate
        public void onUpdate() {
            PhotoViewer.this.containerView.invalidate();
        }

        @Override // org.telegram.ui.Components.PhotoCropView.PhotoCropViewDelegate
        public void onVideoThumbClick() {
            if (PhotoViewer.this.videoPlayer == null) {
                return;
            }
            PhotoViewer.this.videoPlayer.seekTo((long) (PhotoViewer.this.videoPlayer.getDuration() * PhotoViewer.this.avatarStartProgress));
            PhotoViewer.this.videoPlayer.pause();
            PhotoViewer.this.videoTimelineView.setProgress(PhotoViewer.this.avatarStartProgress);
            PhotoViewer.this.cancelVideoPlayRunnable();
            AndroidUtilities.runOnUIThread(PhotoViewer.this.videoPlayRunnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$58$$ExternalSyntheticLambda0
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$onVideoThumbClick$0();
                }
            }, 860L);
        }

        @Override // org.telegram.ui.Components.PhotoCropView.PhotoCropViewDelegate
        public boolean rotate() {
            return PhotoViewer.this.cropRotate(-90.0f);
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$59, reason: invalid class name */
    class AnonymousClass59 extends AnimatorListenerAdapter {
        final /* synthetic */ int val$mode;

        AnonymousClass59(int i) {
            this.val$mode = i;
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onAnimationEnd$0(MaskPaintView maskPaintView) {
            maskPaintView.shutdown();
            try {
                PhotoViewer.this.containerView.removeView(maskPaintView);
            } catch (Exception e) {
                FileLog.e(e);
            }
        }

        /* JADX WARN: Removed duplicated region for block: B:79:0x02dc  */
        /* JADX WARN: Removed duplicated region for block: B:82:0x0302  */
        /* JADX WARN: Removed duplicated region for block: B:85:0x0324  */
        @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
        /*
            Code decompiled incorrectly, please refer to instructions dump.
        */
        public void onAnimationEnd(Animator animator) throws Resources.NotFoundException {
            ObjectAnimator objectAnimatorOfFloat;
            if (PhotoViewer.this.currentEditMode == 1) {
                PhotoViewer.this.photoCropView.onDisappear();
                PhotoViewer.this.photoCropView.onHide();
                PhotoViewer.this.editorDoneLayout.setVisibility(8);
                PhotoViewer.this.photoCropView.setVisibility(8);
                PhotoViewer.this.photoCropView.cropView.areaView.setRotationScaleTranslation(BitmapDescriptorFactory.HUE_RED, 1.0f, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED);
            } else if (PhotoViewer.this.currentEditMode == 2) {
                try {
                    PhotoViewer.this.containerView.removeView(PhotoViewer.this.photoFilterView);
                } catch (Exception e) {
                    FileLog.e(e);
                }
                PhotoViewer.this.photoFilterView = null;
            } else if (PhotoViewer.this.currentEditMode == 3) {
                PhotoViewer.this.photoPaintView.onAnimationStateChanged(false);
                try {
                    PhotoViewer.this.containerView.removeView(PhotoViewer.this.photoPaintView.getView());
                } catch (Exception e2) {
                    FileLog.e(e2);
                }
                PhotoViewer.this.photoPaintView = null;
            } else if (PhotoViewer.this.currentEditMode == 4) {
                PhotoViewer.this.maskPaintViewShuttingDown = true;
                PhotoViewer.this.containerView.invalidate();
                final MaskPaintView maskPaintView = PhotoViewer.this.maskPaintView;
                PhotoViewer.this.containerView.post(new Runnable() { // from class: org.telegram.ui.PhotoViewer$59$$ExternalSyntheticLambda0
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$onAnimationEnd$0(maskPaintView);
                    }
                });
                PhotoViewer.this.maskPaintView = null;
                PhotoViewer.this.eraseBtn.setActive(false, true);
                PhotoViewer.this.restoreBtn.setActive(false, true);
            } else if (PhotoViewer.this.currentEditMode == 5) {
                PhotoViewer.this.coverEditor.setVisibility(8);
                PhotoViewer.this.coverEditor.destroy();
            }
            PhotoViewer.this.imageMoveAnimation = null;
            final int i = PhotoViewer.this.currentEditMode;
            PhotoViewer.this.currentEditMode = this.val$mode;
            PhotoViewer.this.getCaptionView().keyboardNotifier.ignore(PhotoViewer.this.currentEditMode != 0);
            if (PhotoViewer.this.paintKeyboardNotifier != null) {
                PhotoViewer.this.paintKeyboardNotifier.ignore(PhotoViewer.this.currentEditMode != 3);
            }
            if (PhotoViewer.this.currentEditMode != 3) {
                PhotoViewer.this.translateY = BitmapDescriptorFactory.HUE_RED;
            }
            PhotoViewer.this.applying = false;
            if (PhotoViewer.this.sendPhotoType == 1) {
                PhotoViewer.this.photoCropView.setVisibility(0);
            }
            if (PhotoViewer.this.sendPhotoType == 11 && (i == 3 || i == 2 || i == 1 || i == 4)) {
                PhotoViewer photoViewer = PhotoViewer.this;
                photoViewer.animateToX = photoViewer.savedTx;
                PhotoViewer photoViewer2 = PhotoViewer.this;
                photoViewer2.animateToY = photoViewer2.savedTy;
                PhotoViewer photoViewer3 = PhotoViewer.this;
                photoViewer3.animateToScale = photoViewer3.savedScale;
                PhotoViewer photoViewer4 = PhotoViewer.this;
                photoViewer4.animateToRotate = photoViewer4.savedRotation;
            } else {
                PhotoViewer photoViewer5 = PhotoViewer.this;
                photoViewer5.scale = photoViewer5.animateToScale = photoViewer5.scale1(false);
                PhotoViewer photoViewer6 = PhotoViewer.this;
                photoViewer6.updateMinMax(photoViewer6.scale);
                PhotoViewer.this.animateToX = BitmapDescriptorFactory.HUE_RED;
                PhotoViewer.this.animateToY = BitmapDescriptorFactory.HUE_RED;
            }
            PhotoViewer.this.switchingToMode = -1;
            PhotoViewer.this.containerView.invalidate();
            if (PhotoViewer.this.savedState != null) {
                PhotoViewer.this.savedState.restore();
                PhotoViewer.this.savedState = null;
                ActionBarToggleParams actionBarToggleParamsEnableStatusBarAnimation = new ActionBarToggleParams().enableStatusBarAnimation(false);
                PhotoViewer.this.toggleActionBar(false, false, actionBarToggleParamsEnableStatusBarAnimation);
                PhotoViewer.this.toggleActionBar(true, true, actionBarToggleParamsEnableStatusBarAnimation);
                return;
            }
            AnimatorSet animatorSet = new AnimatorSet();
            ArrayList arrayList = new ArrayList();
            FrameLayout frameLayout = PhotoViewer.this.pickerView;
            Property property = View.TRANSLATION_Y;
            arrayList.add(ObjectAnimator.ofFloat(frameLayout, (Property<FrameLayout, Float>) property, BitmapDescriptorFactory.HUE_RED));
            FrameLayout frameLayout2 = PhotoViewer.this.pickerView;
            Property property2 = View.ALPHA;
            arrayList.add(ObjectAnimator.ofFloat(frameLayout2, (Property<FrameLayout, Float>) property2, 1.0f));
            StickerMakerView stickerMakerView = PhotoViewer.this.stickerMakerView;
            if (stickerMakerView != null) {
                arrayList.add(ObjectAnimator.ofFloat(stickerMakerView, (Property<StickerMakerView, Float>) property2, 1.0f));
            }
            if (PhotoViewer.this.stickerMakerBackgroundView != null) {
                arrayList.add(ObjectAnimator.ofFloat(PhotoViewer.this.stickerMakerBackgroundView, (Property<StickerMakerBackgroundView, Float>) property2, 1.0f));
            }
            arrayList.add(ObjectAnimator.ofFloat(PhotoViewer.this.pickerViewSendButton, (Property<ChatActivityEnterView.SendButton, Float>) property, BitmapDescriptorFactory.HUE_RED));
            if (PhotoViewer.this.sendPhotoType != 1) {
                arrayList.add(ObjectAnimator.ofFloat(PhotoViewer.this.actionBar, (Property<ActionBar, Float>) property, BitmapDescriptorFactory.HUE_RED));
            }
            if (PhotoViewer.this.needCaptionLayout) {
                arrayList.add(ObjectAnimator.ofFloat(PhotoViewer.this.captionTextViewSwitcher, (Property<CaptionTextViewSwitcher, Float>) property, BitmapDescriptorFactory.HUE_RED));
            }
            if (PhotoViewer.this.sendPhotoType != 0 && PhotoViewer.this.sendPhotoType != 4) {
                if (PhotoViewer.this.sendPhotoType == 1) {
                    objectAnimatorOfFloat = ObjectAnimator.ofFloat(PhotoViewer.this.photoCropView, (Property<PhotoCropView, Float>) property2, 1.0f);
                }
                if (PhotoViewer.this.muteButton.getTag() != null) {
                    PhotoViewer.this.muteButton.setVisibility(0);
                    arrayList.add(ObjectAnimator.ofFloat(PhotoViewer.this.muteButton, (Property<ImageView, Float>) property2, 1.0f));
                }
                if (PhotoViewer.this.editCoverButton.getTag() != null) {
                    PhotoViewer.this.editCoverButton.setVisibility(0);
                    arrayList.add(ObjectAnimator.ofFloat(PhotoViewer.this.editCoverButton, (Property<EditCoverButton, Float>) property2, 1.0f));
                }
                if (PhotoViewer.this.navigationBar != null) {
                    PhotoViewer.this.navigationBar.setVisibility(0);
                    arrayList.add(ObjectAnimator.ofFloat(PhotoViewer.this.navigationBar, (Property<View, Float>) property2, 1.0f));
                }
                animatorSet.playTogether(arrayList);
                animatorSet.setDuration(200L);
                animatorSet.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.59.1
                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationEnd(Animator animator2) {
                        if (PhotoViewer.this.videoConvertSupported && PhotoViewer.this.isCurrentVideo) {
                            PhotoViewer.this.updateVideoInfo();
                        }
                        if (i == 3) {
                            PhotoViewer photoViewer7 = PhotoViewer.this;
                            photoViewer7.setIsAboutToSwitchToIndex(photoViewer7.currentIndex, false, true, true);
                        }
                    }

                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationStart(Animator animator2) {
                        PhotoViewer.this.pickerView.setVisibility(0);
                        (PhotoViewer.this.useFullWidthSendButton() ? PhotoViewer.this.doneButtonFullWidth : PhotoViewer.this.pickerViewSendButton).setVisibility(0);
                        PhotoViewer.this.actionBar.setVisibility(0);
                        if (PhotoViewer.this.needCaptionLayout) {
                            PhotoViewer.this.captionTextViewSwitcher.setVisibility(PhotoViewer.this.captionTextViewSwitcher.getTag() != null ? 0 : 4);
                        }
                        if (PhotoViewer.this.sendPhotoType == 0 || PhotoViewer.this.sendPhotoType == 4 || ((PhotoViewer.this.sendPhotoType == 2 || PhotoViewer.this.sendPhotoType == 5) && PhotoViewer.this.imagesArrLocals.size() > 1)) {
                            PhotoViewer.this.checkImageView.setVisibility(0);
                            PhotoViewer.this.photosCounterView.setVisibility(0);
                            PhotoViewer.this.updateActionBarTitlePadding();
                        }
                    }
                });
                animatorSet.start();
            }
            arrayList.add(ObjectAnimator.ofFloat(PhotoViewer.this.checkImageView, (Property<CheckBox, Float>) property2, 1.0f));
            objectAnimatorOfFloat = ObjectAnimator.ofFloat(PhotoViewer.this.photosCounterView, (Property<CounterView, Float>) property2, 1.0f);
            arrayList.add(objectAnimatorOfFloat);
            if (PhotoViewer.this.muteButton.getTag() != null) {
            }
            if (PhotoViewer.this.editCoverButton.getTag() != null) {
            }
            if (PhotoViewer.this.navigationBar != null) {
            }
            animatorSet.playTogether(arrayList);
            animatorSet.setDuration(200L);
            animatorSet.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.59.1
                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                public void onAnimationEnd(Animator animator2) {
                    if (PhotoViewer.this.videoConvertSupported && PhotoViewer.this.isCurrentVideo) {
                        PhotoViewer.this.updateVideoInfo();
                    }
                    if (i == 3) {
                        PhotoViewer photoViewer7 = PhotoViewer.this;
                        photoViewer7.setIsAboutToSwitchToIndex(photoViewer7.currentIndex, false, true, true);
                    }
                }

                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                public void onAnimationStart(Animator animator2) {
                    PhotoViewer.this.pickerView.setVisibility(0);
                    (PhotoViewer.this.useFullWidthSendButton() ? PhotoViewer.this.doneButtonFullWidth : PhotoViewer.this.pickerViewSendButton).setVisibility(0);
                    PhotoViewer.this.actionBar.setVisibility(0);
                    if (PhotoViewer.this.needCaptionLayout) {
                        PhotoViewer.this.captionTextViewSwitcher.setVisibility(PhotoViewer.this.captionTextViewSwitcher.getTag() != null ? 0 : 4);
                    }
                    if (PhotoViewer.this.sendPhotoType == 0 || PhotoViewer.this.sendPhotoType == 4 || ((PhotoViewer.this.sendPhotoType == 2 || PhotoViewer.this.sendPhotoType == 5) && PhotoViewer.this.imagesArrLocals.size() > 1)) {
                        PhotoViewer.this.checkImageView.setVisibility(0);
                        PhotoViewer.this.photosCounterView.setVisibility(0);
                        PhotoViewer.this.updateActionBarTitlePadding();
                    }
                }
            });
            animatorSet.start();
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$6, reason: invalid class name */
    class AnonymousClass6 implements Runnable {
        AnonymousClass6() {
        }

        /* JADX INFO: Access modifiers changed from: private */
        public static /* synthetic */ void lambda$run$0(String str, float f) {
            ApplicationLoader.applicationContext.getSharedPreferences("media_saved_pos", 0).edit().putFloat(str, f).commit();
        }

        /* JADX WARN: Removed duplicated region for block: B:40:0x00f8  */
        @Override // java.lang.Runnable
        /*
            Code decompiled incorrectly, please refer to instructions dump.
        */
        public void run() {
            float bufferedProgressFromPosition;
            if (PhotoViewer.this.videoPlayer != null || (PhotoViewer.this.photoViewerWebView != null && PhotoViewer.this.photoViewerWebView.isControllable())) {
                boolean z = PhotoViewer.this.isCurrentVideo;
                float f = BitmapDescriptorFactory.HUE_RED;
                if (!z) {
                    final float currentVideoPosition = PhotoViewer.this.getCurrentVideoPosition() / PhotoViewer.this.getVideoDuration();
                    if (PhotoViewer.this.shownControlsByEnd && !PhotoViewer.this.actionBarWasShownBeforeByEnd) {
                        currentVideoPosition = BitmapDescriptorFactory.HUE_RED;
                    }
                    if (PhotoViewer.this.currentVideoFinishedLoading) {
                        bufferedProgressFromPosition = 1.0f;
                    } else {
                        long jElapsedRealtime = SystemClock.elapsedRealtime();
                        if (Math.abs(jElapsedRealtime - PhotoViewer.this.lastBufferedPositionCheck) >= 500) {
                            if (PhotoViewer.this.photoViewerWebView != null && PhotoViewer.this.photoViewerWebView.isControllable()) {
                                bufferedProgressFromPosition = PhotoViewer.this.photoViewerWebView.getBufferedPosition();
                            } else if (PhotoViewer.this.isStreaming) {
                                bufferedProgressFromPosition = FileLoader.getInstance(PhotoViewer.this.currentAccount).getBufferedProgressFromPosition(PhotoViewer.this.seekToProgressPending != BitmapDescriptorFactory.HUE_RED ? PhotoViewer.this.seekToProgressPending : currentVideoPosition, PhotoViewer.this.currentFileNames[0]);
                            } else {
                                bufferedProgressFromPosition = 1.0f;
                            }
                            PhotoViewer.this.lastBufferedPositionCheck = jElapsedRealtime;
                        } else {
                            bufferedProgressFromPosition = -1.0f;
                        }
                    }
                    if (PhotoViewer.this.inPreview || PhotoViewer.this.videoTimelineViewContainer.getVisibility() != 0) {
                        if (PhotoViewer.this.seekToProgressPending == BitmapDescriptorFactory.HUE_RED) {
                            PhotoViewer photoViewer = PhotoViewer.this;
                            OldVideoPlayerRewinder oldVideoPlayerRewinder = photoViewer.longVideoPlayerRewinder;
                            if (oldVideoPlayerRewinder.rewindCount == 0 || (!oldVideoPlayerRewinder.rewindByBackSeek && !photoViewer.videoPlayerRewinder.rewindByBackSeek)) {
                                PhotoViewer.this.videoPlayerSeekbar.setProgress(currentVideoPosition, false);
                            }
                        }
                        if (bufferedProgressFromPosition != -1.0f) {
                            PhotoViewer.this.videoPlayerSeekbar.setBufferedProgress(bufferedProgressFromPosition);
                            PipVideoOverlay.setBufferedProgress(bufferedProgressFromPosition);
                        }
                    } else if (currentVideoPosition >= PhotoViewer.this.videoTimelineView.getRightProgress()) {
                        PhotoViewer.this.manuallyPaused = false;
                        PhotoViewer.this.pauseVideoOrWeb();
                        PhotoViewer.this.videoPlayerSeekbar.setProgress(BitmapDescriptorFactory.HUE_RED);
                        PhotoViewer.this.seekVideoOrWebTo((int) (r1.videoTimelineView.getLeftProgress() * PhotoViewer.this.getVideoDuration()));
                        PhotoViewer.this.containerView.invalidate();
                    } else {
                        float leftProgress = currentVideoPosition - PhotoViewer.this.videoTimelineView.getLeftProgress();
                        if (leftProgress < BitmapDescriptorFactory.HUE_RED) {
                            leftProgress = BitmapDescriptorFactory.HUE_RED;
                        }
                        currentVideoPosition = leftProgress / (PhotoViewer.this.videoTimelineView.getRightProgress() - PhotoViewer.this.videoTimelineView.getLeftProgress());
                        if (currentVideoPosition > 1.0f) {
                            currentVideoPosition = 1.0f;
                        }
                        PhotoViewer.this.videoPlayerSeekbar.setProgress(currentVideoPosition);
                    }
                    PhotoViewer.this.videoPlayerSeekbarView.invalidate();
                    if (PhotoViewer.this.shouldSavePositionForCurrentVideo != null && currentVideoPosition >= BitmapDescriptorFactory.HUE_RED && SystemClock.elapsedRealtime() - PhotoViewer.this.lastSaveTime >= 1000) {
                        final String str = PhotoViewer.this.shouldSavePositionForCurrentVideo;
                        PhotoViewer.this.lastSaveTime = SystemClock.elapsedRealtime();
                        if (PhotoViewer.this.currentMessageObject != null) {
                            PhotoViewer.this.currentMessageObject.cachedSavedTimestamp = Float.valueOf(currentVideoPosition);
                        }
                        Utilities.globalQueue.postRunnable(new Runnable() { // from class: org.telegram.ui.PhotoViewer$6$$ExternalSyntheticLambda0
                            @Override // java.lang.Runnable
                            public final void run() {
                                PhotoViewer.AnonymousClass6.lambda$run$0(str, currentVideoPosition);
                            }
                        });
                    }
                } else if (!PhotoViewer.this.videoTimelineView.isDragging()) {
                    float currentVideoPosition2 = PhotoViewer.this.getCurrentVideoPosition() / PhotoViewer.this.getVideoDuration();
                    if (!PhotoViewer.this.shownControlsByEnd || PhotoViewer.this.actionBarWasShownBeforeByEnd) {
                        f = currentVideoPosition2;
                    }
                    if (PhotoViewer.this.inPreview || (PhotoViewer.this.currentEditMode == 0 && PhotoViewer.this.videoTimelineViewContainer.getVisibility() != 0)) {
                        if (PhotoViewer.this.sendPhotoType != 1) {
                            PhotoViewer.this.videoTimelineView.setProgress(f);
                        }
                    } else if (f >= PhotoViewer.this.videoTimelineView.getRightProgress()) {
                        PhotoViewer.this.videoTimelineView.setProgress(PhotoViewer.this.videoTimelineView.getLeftProgress());
                        PhotoViewer.this.videoPlayer.seekTo((int) (PhotoViewer.this.videoTimelineView.getLeftProgress() * PhotoViewer.this.getVideoDuration()));
                        PhotoViewer.this.manuallyPaused = false;
                        PhotoViewer.this.cancelVideoPlayRunnable();
                        if (PhotoViewer.this.muteVideo || PhotoViewer.this.sendPhotoType == 1 || PhotoViewer.this.currentEditMode != 0 || PhotoViewer.this.switchingToMode > 0) {
                            PhotoViewer.this.playVideoOrWeb();
                        } else {
                            PhotoViewer.this.pauseVideoOrWeb();
                        }
                        PhotoViewer.this.containerView.invalidate();
                    }
                }
                PhotoViewer.this.updateVideoPlayerTime();
            }
            if (PhotoViewer.this.firstFrameView != null) {
                PhotoViewer.this.firstFrameView.updateAlpha();
            }
            if (PhotoViewer.this.isPlaying) {
                AndroidUtilities.runOnUIThread(PhotoViewer.this.updateProgressRunnable, 17L);
            }
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$7, reason: invalid class name */
    class AnonymousClass7 implements Runnable {
        AnonymousClass7() {
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$run$0(TextureViewContainer textureViewContainer) {
            if (PhotoViewer.this.currentBitmap != null) {
                if (PhotoViewer.this.textureImageView != null) {
                    PhotoViewer.this.textureImageView.setVisibility(0);
                    PhotoViewer.this.textureImageView.setImageBitmap(PhotoViewer.this.currentBitmap);
                }
                textureViewContainer.imageReceiver.setImageBitmap(PhotoViewer.this.currentBitmap);
            }
        }

        @Override // java.lang.Runnable
        public void run() {
            ImageReceiver imageReceiver;
            PhotoViewer photoViewer;
            if (PipVideoOverlay.isVisible()) {
                PipVideoOverlay.dismiss();
                AndroidUtilities.runOnUIThread(this, 250L);
                return;
            }
            PhotoViewer.this.switchingInlineMode = false;
            if (PhotoViewer.this.currentBitmap != null) {
                PhotoViewer.this.currentBitmap.recycle();
                PhotoViewer.this.currentBitmap = null;
            }
            PhotoViewer.this.changingTextureView = true;
            final TextureViewContainer textureViewContainer = new TextureViewContainer(PhotoViewer.this.parentActivity);
            try {
                if (PhotoViewer.this.usedSurfaceView) {
                    Drawable drawable = PhotoViewer.this.textureImageView.getDrawable();
                    if (drawable instanceof BitmapDrawable) {
                        PhotoViewer.this.currentBitmap = ((BitmapDrawable) drawable).getBitmap();
                        if (PhotoViewer.this.currentBitmap != null) {
                            if (PhotoViewer.this.textureImageView != null) {
                                PhotoViewer.this.textureImageView.setVisibility(0);
                                PhotoViewer.this.textureImageView.setImageBitmap(PhotoViewer.this.currentBitmap);
                            }
                            imageReceiver = textureViewContainer.imageReceiver;
                            photoViewer = PhotoViewer.this;
                            imageReceiver.setImageBitmap(photoViewer.currentBitmap);
                        }
                    } else {
                        PhotoViewer photoViewer2 = PhotoViewer.this;
                        photoViewer2.currentBitmap = Bitmaps.createBitmap(photoViewer2.videoSurfaceView.getWidth(), PhotoViewer.this.videoSurfaceView.getHeight(), Bitmap.Config.ARGB_8888);
                        AndroidUtilities.getBitmapFromSurface(PhotoViewer.this.videoSurfaceView, PhotoViewer.this.currentBitmap, new Runnable() { // from class: org.telegram.ui.PhotoViewer$7$$ExternalSyntheticLambda0
                            @Override // java.lang.Runnable
                            public final void run() {
                                this.f$0.lambda$run$0(textureViewContainer);
                            }
                        });
                    }
                } else {
                    PhotoViewer photoViewer3 = PhotoViewer.this;
                    photoViewer3.currentBitmap = Bitmaps.createBitmap(photoViewer3.videoTextureView.getWidth(), PhotoViewer.this.videoTextureView.getHeight(), Bitmap.Config.ARGB_8888);
                    PhotoViewer.this.videoTextureView.getBitmap(PhotoViewer.this.currentBitmap);
                    if (PhotoViewer.this.currentBitmap != null) {
                        if (PhotoViewer.this.textureImageView != null) {
                            PhotoViewer.this.textureImageView.setVisibility(0);
                            PhotoViewer.this.textureImageView.setImageBitmap(PhotoViewer.this.currentBitmap);
                        }
                        imageReceiver = textureViewContainer.imageReceiver;
                        photoViewer = PhotoViewer.this;
                        imageReceiver.setImageBitmap(photoViewer.currentBitmap);
                    }
                }
            } catch (Throwable th) {
                if (PhotoViewer.this.currentBitmap != null) {
                    PhotoViewer.this.currentBitmap.recycle();
                    PhotoViewer.this.currentBitmap = null;
                }
                FileLog.e(th);
            }
            PhotoViewer.this.isInline = true;
            PhotoViewer photoViewer4 = PhotoViewer.this;
            photoViewer4.changedTextureView = textureViewContainer.textureView;
            if (PipVideoOverlay.show(false, photoViewer4.parentActivity, textureViewContainer, PhotoViewer.this.videoWidth, PhotoViewer.this.videoHeight, PhotoViewer.this.pipVideoOverlayAnimateFlag)) {
                PipVideoOverlay.setPhotoViewer(PhotoViewer.this);
            }
            PhotoViewer.this.pipVideoOverlayAnimateFlag = true;
            if (!PhotoViewer.this.usedSurfaceView) {
                PhotoViewer.this.changedTextureView.setVisibility(4);
                if (PhotoViewer.this.aspectRatioFrameLayout != null) {
                    PhotoViewer.this.aspectRatioFrameLayout.removeView(PhotoViewer.this.videoTextureView);
                    PhotoViewer.this.aspectRatioFrameLayout.removeView(PhotoViewer.this.videoSurfaceView);
                    return;
                }
                return;
            }
            if (PhotoViewer.this.aspectRatioFrameLayout != null) {
                PhotoViewer.this.aspectRatioFrameLayout.removeView(PhotoViewer.this.videoTextureView);
                PhotoViewer.this.aspectRatioFrameLayout.removeView(PhotoViewer.this.videoSurfaceView);
            }
            PhotoViewer.this.videoPlayer.setSurfaceView(null);
            PhotoViewer.this.videoPlayer.setTextureView(null);
            PhotoViewer.this.videoPlayer.play();
            PhotoViewer.this.videoPlayer.setTextureView(PhotoViewer.this.changedTextureView);
            PhotoViewer.this.checkChangedTextureView(true);
            PhotoViewer.this.changedTextureView.setVisibility(0);
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$72, reason: invalid class name */
    class AnonymousClass72 extends Fade {
        final /* synthetic */ boolean val$isCaptionEmpty;
        final /* synthetic */ boolean val$isCurrentCaptionEmpty;

        /* JADX WARN: 'super' call moved to the top of the method (can break code semantics) */
        AnonymousClass72(int i, boolean z, boolean z2) {
            super(i);
            this.val$isCurrentCaptionEmpty = z;
            this.val$isCaptionEmpty = z2;
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onAppear$0(ValueAnimator valueAnimator) {
            PhotoViewer.this.captionScrollView.backgroundAlpha = ((Float) valueAnimator.getAnimatedValue()).floatValue();
            PhotoViewer.this.captionScrollView.invalidate();
        }

        @Override // android.transition.Fade, android.transition.Visibility
        public Animator onAppear(ViewGroup viewGroup, View view, TransitionValues transitionValues, TransitionValues transitionValues2) {
            Animator animatorOnAppear = super.onAppear(viewGroup, view, transitionValues, transitionValues2);
            if (this.val$isCurrentCaptionEmpty && !this.val$isCaptionEmpty && view == PhotoViewer.this.captionTextViewSwitcher) {
                animatorOnAppear.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.72.1
                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationEnd(Animator animator) {
                        PhotoViewer.this.captionScrollView.backgroundAlpha = 1.0f;
                    }
                });
                ((ObjectAnimator) animatorOnAppear).addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$72$$ExternalSyntheticLambda0
                    @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                    public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                        this.f$0.lambda$onAppear$0(valueAnimator);
                    }
                });
            }
            return animatorOnAppear;
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$73, reason: invalid class name */
    class AnonymousClass73 extends Fade {
        final /* synthetic */ boolean val$isCaptionEmpty;
        final /* synthetic */ boolean val$isCurrentCaptionEmpty;

        /* JADX WARN: 'super' call moved to the top of the method (can break code semantics) */
        AnonymousClass73(int i, boolean z, boolean z2) {
            super(i);
            this.val$isCurrentCaptionEmpty = z;
            this.val$isCaptionEmpty = z2;
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onDisappear$0(ValueAnimator valueAnimator) {
            PhotoViewer.this.captionScrollView.backgroundAlpha = ((Float) valueAnimator.getAnimatedValue()).floatValue();
            PhotoViewer.this.captionScrollView.invalidate();
        }

        @Override // android.transition.Fade, android.transition.Visibility
        public Animator onDisappear(ViewGroup viewGroup, View view, TransitionValues transitionValues, TransitionValues transitionValues2) {
            Animator animatorOnDisappear = super.onDisappear(viewGroup, view, transitionValues, transitionValues2);
            if (!this.val$isCurrentCaptionEmpty && this.val$isCaptionEmpty && view == PhotoViewer.this.captionTextViewSwitcher) {
                animatorOnDisappear.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.73.1
                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationEnd(Animator animator) {
                        PhotoViewer.this.captionScrollView.setVisibility(4);
                        PhotoViewer.this.captionScrollView.backgroundAlpha = 1.0f;
                    }
                });
                ((ObjectAnimator) animatorOnDisappear).addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$73$$ExternalSyntheticLambda0
                    @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                    public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                        this.f$0.lambda$onDisappear$0(valueAnimator);
                    }
                });
            }
            return animatorOnDisappear;
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$74, reason: invalid class name */
    class AnonymousClass74 extends Transition {
        AnonymousClass74() {
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$createAnimator$0(ValueAnimator valueAnimator) {
            PhotoViewer.this.captionScrollView.scrollTo(0, ((Integer) valueAnimator.getAnimatedValue()).intValue());
        }

        @Override // android.transition.Transition
        public void captureEndValues(TransitionValues transitionValues) {
            if (transitionValues.view == PhotoViewer.this.captionTextViewSwitcher) {
                transitionValues.values.put("translationY", Integer.valueOf(PhotoViewer.this.captionScrollView.getPendingMarginTopDiff()));
            }
        }

        @Override // android.transition.Transition
        public void captureStartValues(TransitionValues transitionValues) {
            if (transitionValues.view == PhotoViewer.this.captionScrollView) {
                transitionValues.values.put("scrollY", Integer.valueOf(PhotoViewer.this.captionScrollView.getScrollY()));
            }
        }

        @Override // android.transition.Transition
        public Animator createAnimator(ViewGroup viewGroup, TransitionValues transitionValues, TransitionValues transitionValues2) {
            int iIntValue;
            if (transitionValues.view == PhotoViewer.this.captionScrollView) {
                ValueAnimator valueAnimatorOfInt = ValueAnimator.ofInt(((Integer) transitionValues.values.get("scrollY")).intValue(), 0);
                valueAnimatorOfInt.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.74.1
                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationEnd(Animator animator) {
                        PhotoViewer.this.captionTextViewSwitcher.getNextView().setText((CharSequence) null);
                        PhotoViewer.this.captionScrollView.applyPendingTopMargin();
                    }

                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationStart(Animator animator) throws IllegalAccessException, IllegalArgumentException, InvocationTargetException {
                        PhotoViewer.this.captionScrollView.stopScrolling();
                    }
                });
                valueAnimatorOfInt.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$74$$ExternalSyntheticLambda0
                    @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                    public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                        this.f$0.lambda$createAnimator$0(valueAnimator);
                    }
                });
                return valueAnimatorOfInt;
            }
            if (transitionValues2.view != PhotoViewer.this.captionTextViewSwitcher || (iIntValue = ((Integer) transitionValues2.values.get("translationY")).intValue()) == 0) {
                return null;
            }
            ObjectAnimator objectAnimatorOfFloat = ObjectAnimator.ofFloat(PhotoViewer.this.captionTextViewSwitcher, (Property<CaptionTextViewSwitcher, Float>) View.TRANSLATION_Y, BitmapDescriptorFactory.HUE_RED, iIntValue);
            objectAnimatorOfFloat.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.74.2
                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                public void onAnimationEnd(Animator animator) {
                    PhotoViewer.this.captionTextViewSwitcher.setTranslationY(BitmapDescriptorFactory.HUE_RED);
                }
            });
            return objectAnimatorOfFloat;
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$76, reason: invalid class name */
    class AnonymousClass76 implements ViewTreeObserver.OnPreDrawListener {
        final /* synthetic */ ClippingImageView[] val$animatingImageViews;
        final /* synthetic */ Integer val$embedSeekTime;
        final /* synthetic */ ViewGroup.LayoutParams val$layoutParams;
        final /* synthetic */ float val$left;
        final /* synthetic */ PlaceProviderObject val$object;
        final /* synthetic */ ArrayList val$photos;
        final /* synthetic */ PhotoViewerProvider val$provider;
        final /* synthetic */ float val$top;

        /* renamed from: org.telegram.ui.PhotoViewer$76$1, reason: invalid class name */
        class AnonymousClass1 extends AnimatorListenerAdapter {
            AnonymousClass1() {
            }

            /* JADX INFO: Access modifiers changed from: private */
            public /* synthetic */ void lambda$onAnimationEnd$0() {
                PhotoViewer.this.transitionNotificationLocker.unlock();
                if (PhotoViewer.this.animationEndRunnable != null) {
                    PhotoViewer.this.animationEndRunnable.run();
                    PhotoViewer.this.animationEndRunnable = null;
                }
                PhotoViewer.this.setCaptionHwLayerEnabled(true);
            }

            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
            public void onAnimationEnd(Animator animator) {
                AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$76$1$$ExternalSyntheticLambda0
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$onAnimationEnd$0();
                    }
                });
            }
        }

        AnonymousClass76(ClippingImageView[] clippingImageViewArr, ViewGroup.LayoutParams layoutParams, float f, PlaceProviderObject placeProviderObject, float f2, PhotoViewerProvider photoViewerProvider, ArrayList arrayList, Integer num) {
            this.val$animatingImageViews = clippingImageViewArr;
            this.val$layoutParams = layoutParams;
            this.val$left = f;
            this.val$object = placeProviderObject;
            this.val$top = f2;
            this.val$provider = photoViewerProvider;
            this.val$photos = arrayList;
            this.val$embedSeekTime = num;
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onPreDraw$0(ClippingImageView[] clippingImageViewArr, ArrayList arrayList, Integer num, PhotoViewerProvider photoViewerProvider) throws Resources.NotFoundException {
            PhotoViewer.this.animationEndRunnable = null;
            if (PhotoViewer.this.containerView != null) {
                PhotoViewer photoViewer = PhotoViewer.this;
                if (photoViewer.windowView == null) {
                    return;
                }
                photoViewer.containerView.setLayerType(0, null);
                PhotoViewer.this.animationInProgress = 0;
                PhotoViewer.this.invalidateBlur();
                PhotoViewer.this.transitionAnimationStartTime = 0L;
                PhotoViewer.this.leftCropState = null;
                PhotoViewer.this.leftCropTransform.setViewTransform(false);
                PhotoViewer.this.rightCropState = null;
                PhotoViewer.this.rightCropTransform.setViewTransform(false);
                PhotoViewer.this.setImages();
                PhotoViewer.this.setCropBitmap();
                PhotoViewer.this.containerView.invalidate();
                for (ClippingImageView clippingImageView : clippingImageViewArr) {
                    clippingImageView.setVisibility(8);
                }
                if (PhotoViewer.this.showAfterAnimation != null) {
                    PhotoViewer.this.showAfterAnimation.imageReceiver.setVisible(true, true);
                }
                if (PhotoViewer.this.hideAfterAnimation != null) {
                    PhotoViewer.this.hideAfterAnimation.imageReceiver.setVisible(false, true);
                }
                if (arrayList != null && PhotoViewer.this.sendPhotoType != 3 && PhotoViewer.this.sendPhotoType != 1 && (PhotoViewer.this.placeProvider == null || !PhotoViewer.this.placeProvider.closeKeyboard())) {
                    PhotoViewer.this.makeFocusable();
                }
                if (PhotoViewer.this.videoPlayer != null && PhotoViewer.this.videoPlayer.isPlaying() && PhotoViewer.this.isCurrentVideo && !PhotoViewer.this.imagesArrLocals.isEmpty()) {
                    PhotoViewer photoViewer2 = PhotoViewer.this;
                    photoViewer2.seekAnimatedStickersTo(photoViewer2.videoPlayer.getCurrentPosition());
                    PhotoViewer.this.playOrStopAnimatedStickers(true);
                }
                if (PhotoViewer.this.isEmbedVideo) {
                    PhotoViewer.this.initEmbedVideo(num.intValue());
                }
                if (photoViewerProvider != null) {
                    photoViewerProvider.onOpen();
                }
            }
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onPreDraw$1(ValueAnimator valueAnimator) {
            PhotoViewer.this.clippingImageProgress = 1.0f - ((Float) valueAnimator.getAnimatedValue()).floatValue();
            PhotoViewer.this.invalidateBlur();
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onPreDraw$2(AnimatorSet animatorSet) {
            PhotoViewer.this.transitionNotificationLocker.lock();
            animatorSet.start();
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onPreDraw$3(PlaceProviderObject placeProviderObject) {
            PhotoViewer.this.disableShowCheck = false;
            placeProviderObject.imageReceiver.setVisible(false, true);
        }

        @Override // android.view.ViewTreeObserver.OnPreDrawListener
        public boolean onPreDraw() {
            float fMax;
            float f;
            float measuredWidth;
            ClippingImageView[] clippingImageViewArr;
            ClippingImageView[] clippingImageViewArr2 = this.val$animatingImageViews;
            if (clippingImageViewArr2.length > 1) {
                clippingImageViewArr2[1].setAlpha(1.0f);
                this.val$animatingImageViews[1].setAdditionalTranslationX(-PhotoViewer.this.getLeftInset());
            }
            ClippingImageView clippingImageView = this.val$animatingImageViews[0];
            clippingImageView.setTranslationX(clippingImageView.getTranslationX() + PhotoViewer.this.getLeftInset());
            PhotoViewer.this.windowView.getViewTreeObserver().removeOnPreDrawListener(this);
            if (PhotoViewer.this.sendPhotoType == 1) {
                float f2 = PhotoViewer.this.isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0;
                float measuredHeight = (PhotoViewer.this.photoCropView.getMeasuredHeight() - AndroidUtilities.dp(64.0f)) - f2;
                float measuredWidth2 = PhotoViewer.this.photoCropView.getMeasuredWidth() / 2.0f;
                float f3 = f2 + (measuredHeight / 2.0f);
                float fMin = (Math.min(PhotoViewer.this.photoCropView.getMeasuredWidth(), measuredHeight) - (AndroidUtilities.dp(16.0f) * 2)) / 2.0f;
                float f4 = f3 - fMin;
                ViewGroup.LayoutParams layoutParams = this.val$layoutParams;
                float f5 = (f3 + fMin) - f4;
                fMax = Math.max(((measuredWidth2 + fMin) - (measuredWidth2 - fMin)) / layoutParams.width, f5 / layoutParams.height);
                f = f4 + ((f5 - (this.val$layoutParams.height * fMax)) / 2.0f);
                measuredWidth = ((((PhotoViewer.this.windowView.getMeasuredWidth() - PhotoViewer.this.getLeftInset()) - PhotoViewer.this.getRightInset()) - (this.val$layoutParams.width * fMax)) / 2.0f) + PhotoViewer.this.getLeftInset();
            } else {
                float fMin2 = Math.min(PhotoViewer.this.windowView.getMeasuredWidth() / this.val$layoutParams.width, (AndroidUtilities.displaySize.y + (PhotoViewer.this.isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0)) / this.val$layoutParams.height);
                if (PhotoViewer.this.sendPhotoType == 11) {
                    fMin2 *= PhotoViewer.this.scale1();
                }
                fMax = fMin2;
                f = ((AndroidUtilities.displaySize.y + (PhotoViewer.this.isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0)) - (this.val$layoutParams.height * fMax)) / 2.0f;
                measuredWidth = (PhotoViewer.this.windowView.getMeasuredWidth() - (this.val$layoutParams.width * fMax)) / 2.0f;
                PhotoViewer.this.rotate = BitmapDescriptorFactory.HUE_RED;
                PhotoViewer.this.animateToRotate = BitmapDescriptorFactory.HUE_RED;
            }
            int iAbs = (int) Math.abs(this.val$left - this.val$object.imageReceiver.getImageX());
            int iAbs2 = (int) Math.abs(this.val$top - this.val$object.imageReceiver.getImageY());
            if (this.val$object.imageReceiver.isAspectFit()) {
                iAbs = 0;
            }
            int[] iArr = new int[2];
            this.val$object.parentView.getLocationInWindow(iArr);
            int i = iArr[1];
            int i2 = Build.VERSION.SDK_INT;
            float f6 = i - ((i2 >= 21 || PhotoViewer.this.inBubbleMode) ? 0 : AndroidUtilities.statusBarHeight);
            PlaceProviderObject placeProviderObject = this.val$object;
            float f7 = placeProviderObject.viewY + this.val$top;
            int i3 = (int) ((f6 - f7) + placeProviderObject.clipTopAddition);
            if (i3 < 0) {
                i3 = 0;
            }
            int height = (int) (((f7 + this.val$layoutParams.height) - ((iArr[1] + placeProviderObject.parentView.getHeight()) - ((i2 >= 21 || PhotoViewer.this.inBubbleMode) ? 0 : AndroidUtilities.statusBarHeight))) + this.val$object.clipBottomAddition);
            if (height < 0) {
                height = 0;
            }
            int iMax = Math.max(i3, iAbs2);
            int iMax2 = Math.max(height, iAbs2);
            PhotoViewer.this.animationValues[0][0] = PhotoViewer.this.animatingImageView.getScaleX();
            PhotoViewer.this.animationValues[0][1] = PhotoViewer.this.animatingImageView.getScaleY();
            PhotoViewer.this.animationValues[0][2] = PhotoViewer.this.animatingImageView.getTranslationX();
            PhotoViewer.this.animationValues[0][3] = PhotoViewer.this.animatingImageView.getTranslationY();
            float f8 = iAbs;
            PhotoViewer.this.animationValues[0][4] = this.val$object.scale * f8;
            PhotoViewer.this.animationValues[0][5] = iMax * this.val$object.scale;
            PhotoViewer.this.animationValues[0][6] = iMax2 * this.val$object.scale;
            int[] radius = PhotoViewer.this.animatingImageView.getRadius();
            for (int i4 = 0; i4 < 4; i4++) {
                PhotoViewer.this.animationValues[0][i4 + 7] = radius != null ? radius[i4] : BitmapDescriptorFactory.HUE_RED;
            }
            PhotoViewer.this.animationValues[0][11] = iAbs2 * this.val$object.scale;
            PhotoViewer.this.animationValues[0][12] = f8 * this.val$object.scale;
            PhotoViewer.this.animationValues[1][0] = fMax;
            PhotoViewer.this.animationValues[1][1] = fMax;
            PhotoViewer.this.animationValues[1][2] = measuredWidth;
            PhotoViewer.this.animationValues[1][3] = f;
            PhotoViewer.this.animationValues[1][4] = 0.0f;
            PhotoViewer.this.animationValues[1][5] = 0.0f;
            PhotoViewer.this.animationValues[1][6] = 0.0f;
            PhotoViewer.this.animationValues[1][7] = 0.0f;
            PhotoViewer.this.animationValues[1][8] = 0.0f;
            PhotoViewer.this.animationValues[1][9] = 0.0f;
            PhotoViewer.this.animationValues[1][10] = 0.0f;
            PhotoViewer.this.animationValues[1][11] = 0.0f;
            PhotoViewer.this.animationValues[1][12] = 0.0f;
            int i5 = 0;
            while (true) {
                ClippingImageView[] clippingImageViewArr3 = this.val$animatingImageViews;
                if (i5 >= clippingImageViewArr3.length) {
                    break;
                }
                clippingImageViewArr3[i5].setAnimationProgress(BitmapDescriptorFactory.HUE_RED);
                i5++;
            }
            PhotoViewer.this.backgroundDrawable.setAlpha(0);
            PhotoViewer.this.containerView.setAlpha(BitmapDescriptorFactory.HUE_RED);
            PhotoViewer.this.navigationBar.setAlpha(BitmapDescriptorFactory.HUE_RED);
            PhotoViewerProvider photoViewerProvider = this.val$provider;
            if (photoViewerProvider != null) {
                photoViewerProvider.onPreOpen();
            }
            PhotoViewer photoViewer = PhotoViewer.this;
            final ClippingImageView[] clippingImageViewArr4 = this.val$animatingImageViews;
            final ArrayList arrayList = this.val$photos;
            final Integer num = this.val$embedSeekTime;
            final PhotoViewerProvider photoViewerProvider2 = this.val$provider;
            photoViewer.animationEndRunnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$76$$ExternalSyntheticLambda0
                @Override // java.lang.Runnable
                public final void run() throws Resources.NotFoundException {
                    this.f$0.lambda$onPreDraw$0(clippingImageViewArr4, arrayList, num, photoViewerProvider2);
                }
            };
            if (PhotoViewer.this.openedFullScreenVideo) {
                if (PhotoViewer.this.animationEndRunnable != null) {
                    PhotoViewer.this.animationEndRunnable.run();
                    PhotoViewer.this.animationEndRunnable = null;
                }
                PhotoViewer.this.containerView.setAlpha(1.0f);
                PhotoViewer.this.backgroundDrawable.setAlpha(255);
                int i6 = 0;
                while (true) {
                    ClippingImageView[] clippingImageViewArr5 = this.val$animatingImageViews;
                    if (i6 >= clippingImageViewArr5.length) {
                        break;
                    }
                    clippingImageViewArr5[i6].setAnimationProgress(1.0f);
                    i6++;
                }
                if (PhotoViewer.this.sendPhotoType == 1) {
                    PhotoViewer.this.photoCropView.setAlpha(1.0f);
                }
            } else {
                final AnimatorSet animatorSet = new AnimatorSet();
                int i7 = PhotoViewer.this.sendPhotoType != 1 ? 2 : 3;
                ClippingImageView[] clippingImageViewArr6 = this.val$animatingImageViews;
                ArrayList arrayList2 = new ArrayList(i7 + clippingImageViewArr6.length + (clippingImageViewArr6.length > 1 ? 1 : 0));
                int i8 = 0;
                while (true) {
                    clippingImageViewArr = this.val$animatingImageViews;
                    if (i8 >= clippingImageViewArr.length) {
                        break;
                    }
                    ObjectAnimator objectAnimatorOfFloat = ObjectAnimator.ofFloat(clippingImageViewArr[i8], (Property<ClippingImageView, Float>) AnimationProperties.CLIPPING_IMAGE_VIEW_PROGRESS, BitmapDescriptorFactory.HUE_RED, 1.0f);
                    if (i8 == 0) {
                        objectAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$76$$ExternalSyntheticLambda1
                            @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                            public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                                this.f$0.lambda$onPreDraw$1(valueAnimator);
                            }
                        });
                    }
                    arrayList2.add(objectAnimatorOfFloat);
                    i8++;
                }
                if (clippingImageViewArr.length > 1) {
                    arrayList2.add(ObjectAnimator.ofFloat(PhotoViewer.this.animatingImageView, (Property<ClippingImageView, Float>) View.ALPHA, BitmapDescriptorFactory.HUE_RED, 1.0f));
                }
                arrayList2.add(ObjectAnimator.ofInt(PhotoViewer.this.backgroundDrawable, (Property<BackgroundDrawable, Integer>) AnimationProperties.COLOR_DRAWABLE_ALPHA, 0, 255));
                FrameLayoutDrawer frameLayoutDrawer = PhotoViewer.this.containerView;
                Property property = View.ALPHA;
                arrayList2.add(ObjectAnimator.ofFloat(frameLayoutDrawer, (Property<FrameLayoutDrawer, Float>) property, BitmapDescriptorFactory.HUE_RED, 1.0f));
                arrayList2.add(ObjectAnimator.ofFloat(PhotoViewer.this.navigationBar, (Property<View, Float>) property, BitmapDescriptorFactory.HUE_RED, 1.0f));
                if (PhotoViewer.this.sendPhotoType == 1) {
                    arrayList2.add(ObjectAnimator.ofFloat(PhotoViewer.this.photoCropView, (Property<PhotoCropView, Float>) property, BitmapDescriptorFactory.HUE_RED, 1.0f));
                }
                animatorSet.playTogether(arrayList2);
                animatorSet.setDuration(200L);
                animatorSet.addListener(new AnonymousClass1());
                PhotoViewer.this.containerView.setLayerType(2, null);
                PhotoViewer.this.setCaptionHwLayerEnabled(false);
                PhotoViewer.this.transitionAnimationStartTime = System.currentTimeMillis();
                AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$76$$ExternalSyntheticLambda2
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$onPreDraw$2(animatorSet);
                    }
                });
            }
            BackgroundDrawable backgroundDrawable = PhotoViewer.this.backgroundDrawable;
            final PlaceProviderObject placeProviderObject2 = this.val$object;
            backgroundDrawable.drawRunnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$76$$ExternalSyntheticLambda3
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$onPreDraw$3(placeProviderObject2);
                }
            };
            if (PhotoViewer.this.parentChatActivity != null && PhotoViewer.this.parentChatActivity.getFragmentView() != null) {
                UndoView undoView = PhotoViewer.this.parentChatActivity.getUndoView();
                if (undoView != null) {
                    undoView.hide(false, 1);
                }
                PhotoViewer.this.parentChatActivity.getFragmentView().invalidate();
            }
            return true;
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$79, reason: invalid class name */
    class AnonymousClass79 extends AnimatorListenerAdapter {
        AnonymousClass79() {
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onAnimationEnd$0() {
            if (PhotoViewer.this.animationEndRunnable != null) {
                PhotoViewer.this.animationEndRunnable.run();
                PhotoViewer.this.animationEndRunnable = null;
            }
        }

        @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
        public void onAnimationEnd(Animator animator) {
            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$79$$ExternalSyntheticLambda0
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$onAnimationEnd$0();
                }
            });
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$85, reason: invalid class name */
    class AnonymousClass85 implements Runnable {
        final /* synthetic */ int val$compressQuality;
        final /* synthetic */ String val$videoPath;

        AnonymousClass85(String str, int i) {
            this.val$videoPath = str;
            this.val$compressQuality = i;
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$run$0(Runnable runnable, int[] iArr) {
            if (PhotoViewer.this.parentActivity == null || runnable != PhotoViewer.this.currentLoadingVideoRunnable) {
                return;
            }
            PhotoViewer.this.currentLoadingVideoRunnable = null;
            PhotoViewer.this.audioFramesSize = iArr[5];
            PhotoViewer.this.videoDuration = iArr[4];
            PhotoViewer.this.videoFramerate = iArr[7];
            PhotoViewer.this.videoFramesSize = (long) (((r5.bitrate / 8) * PhotoViewer.this.videoDuration) / 1000.0f);
            if (PhotoViewer.this.videoConvertSupported) {
                PhotoViewer.this.rotationValue = iArr[8];
                PhotoViewer.this.updateWidthHeightBitrateForCompression();
                if (PhotoViewer.this.selectedCompression > PhotoViewer.this.compressionsCount - 1) {
                    PhotoViewer photoViewer = PhotoViewer.this;
                    photoViewer.selectedCompression = photoViewer.compressionsCount - 1;
                }
                PhotoViewer.this.compressItem.setState(PhotoViewer.this.compressionsCount > 1, PhotoViewer.this.muteVideo, Math.min(PhotoViewer.this.resultWidth, PhotoViewer.this.resultHeight));
                if (BuildVars.LOGS_ENABLED) {
                    FileLog.d("compressionsCount = " + PhotoViewer.this.compressionsCount + " w = " + PhotoViewer.this.originalWidth + " h = " + PhotoViewer.this.originalHeight + " r = " + PhotoViewer.this.rotationValue);
                }
                PhotoViewer.this.qualityChooseView.invalidate();
            } else {
                PhotoViewer.this.compressItem.setState(false, PhotoViewer.this.muteVideo, Math.min(PhotoViewer.this.resultWidth, PhotoViewer.this.resultHeight));
                PhotoViewer.this.compressionsCount = 0;
            }
            PhotoViewer.this.updateVideoInfo();
            PhotoViewer.this.updateMuteButton();
        }

        @Override // java.lang.Runnable
        public void run() {
            if (PhotoViewer.this.currentLoadingVideoRunnable != this) {
                return;
            }
            int videoBitrate = MediaController.getVideoBitrate(this.val$videoPath);
            final int[] iArr = new int[11];
            AnimatedFileDrawable.getVideoInfo(this.val$videoPath, iArr);
            boolean z = false;
            boolean z2 = iArr[10] != 0;
            PhotoViewer photoViewer = PhotoViewer.this;
            if (iArr[0] != 0 && (!z2 || iArr[9] != 0)) {
                z = true;
            }
            photoViewer.videoConvertSupported = z;
            PhotoViewer photoViewer2 = PhotoViewer.this;
            if (videoBitrate == -1) {
                videoBitrate = iArr[3];
            }
            photoViewer2.originalBitrate = photoViewer2.bitrate = videoBitrate;
            if (PhotoViewer.this.videoConvertSupported) {
                PhotoViewer photoViewer3 = PhotoViewer.this;
                photoViewer3.resultWidth = photoViewer3.originalWidth = iArr[1];
                PhotoViewer photoViewer4 = PhotoViewer.this;
                photoViewer4.resultHeight = photoViewer4.originalHeight = iArr[2];
                PhotoViewer photoViewer5 = PhotoViewer.this;
                photoViewer5.updateCompressionsCount(photoViewer5.originalWidth, PhotoViewer.this.originalHeight);
                PhotoViewer photoViewer6 = PhotoViewer.this;
                int iSelectCompression = this.val$compressQuality;
                if (iSelectCompression == -1) {
                    iSelectCompression = photoViewer6.selectCompression();
                }
                photoViewer6.selectedCompression = iSelectCompression;
                PhotoViewer.this.prepareRealEncoderBitrate();
                PhotoViewer.this.isH264Video = MediaController.isH264Video(this.val$videoPath);
            }
            if (PhotoViewer.this.currentLoadingVideoRunnable != this) {
                return;
            }
            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$85$$ExternalSyntheticLambda0
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$run$0(this, iArr);
                }
            });
        }
    }

    /* renamed from: org.telegram.ui.PhotoViewer$9, reason: invalid class name */
    class AnonymousClass9 implements ViewTreeObserver.OnPreDrawListener {
        AnonymousClass9() {
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onPreDraw$0() {
            PhotoViewer.this.textureImageView.setVisibility(4);
            PhotoViewer.this.textureImageView.setImageDrawable(null);
            if (PhotoViewer.this.currentBitmap != null) {
                PhotoViewer.this.currentBitmap.recycle();
                PhotoViewer.this.currentBitmap = null;
            }
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$onPreDraw$1() {
            if (PhotoViewer.this.isInline) {
                PhotoViewer.this.dismissInternal();
            }
        }

        @Override // android.view.ViewTreeObserver.OnPreDrawListener
        public boolean onPreDraw() {
            PhotoViewer.this.changedTextureView.getViewTreeObserver().removeOnPreDrawListener(this);
            if (PhotoViewer.this.textureImageView != null) {
                if (PhotoViewer.this.isInline) {
                    AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$9$$ExternalSyntheticLambda0
                        @Override // java.lang.Runnable
                        public final void run() {
                            this.f$0.lambda$onPreDraw$0();
                        }
                    }, 300L);
                } else {
                    PhotoViewer.this.textureImageView.setVisibility(4);
                    PhotoViewer.this.textureImageView.setImageDrawable(null);
                    if (PhotoViewer.this.currentBitmap != null) {
                        PhotoViewer.this.currentBitmap.recycle();
                        PhotoViewer.this.currentBitmap = null;
                    }
                }
            }
            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$9$$ExternalSyntheticLambda1
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$onPreDraw$1();
                }
            });
            PhotoViewer.this.waitingForFirstTextureUpload = 0;
            return true;
        }
    }

    private static class ActionBarToggleParams {
        public static final ActionBarToggleParams DEFAULT = new ActionBarToggleParams();
        public Interpolator animationInterpolator;
        public int animationDuration = 200;
        public boolean enableStatusBarAnimation = true;
        public boolean enableTranslationAnimation = true;

        public ActionBarToggleParams animationDuration(int i) {
            this.animationDuration = i;
            return this;
        }

        public ActionBarToggleParams animationInterpolator(Interpolator interpolator) {
            this.animationInterpolator = interpolator;
            return this;
        }

        public ActionBarToggleParams enableStatusBarAnimation(boolean z) {
            this.enableStatusBarAnimation = z;
            return this;
        }

        public ActionBarToggleParams enableTranslationAnimation(boolean z) {
            this.enableTranslationAnimation = z;
            return this;
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    class BackgroundDrawable extends ColorDrawable {
        private boolean allowDrawContent;
        private Runnable drawRunnable;
        private final Paint paint;
        private final RectF rect;
        private final RectF visibleRect;

        public BackgroundDrawable(int i) {
            super(i);
            this.rect = new RectF();
            this.visibleRect = new RectF();
            Paint paint = new Paint(1);
            this.paint = paint;
            paint.setColor(i);
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$setAlpha$0() {
            if (PhotoViewer.this.parentAlert != null) {
                PhotoViewer.this.parentAlert.setAllowDrawContent(this.allowDrawContent);
            }
        }

        @Override // android.graphics.drawable.ColorDrawable, android.graphics.drawable.Drawable
        public void draw(Canvas canvas) {
            Runnable runnable;
            if (PhotoViewer.this.textureViewSkipRender) {
                return;
            }
            if (PhotoViewer.this.animationInProgress == 0 || AndroidUtilities.isTablet() || PhotoViewer.this.currentPlaceObject == null || PhotoViewer.this.currentPlaceObject.animatingImageView == null) {
                super.draw(canvas);
            } else {
                PhotoViewer.this.animatingImageView.getClippedVisibleRect(this.visibleRect);
                if (!this.visibleRect.isEmpty()) {
                    this.visibleRect.inset(AndroidUtilities.dp(1.0f), AndroidUtilities.dp(1.0f));
                    Rect bounds = getBounds();
                    float f = bounds.right;
                    float f2 = bounds.bottom;
                    for (int i = 0; i < 4; i++) {
                        if (i == 0) {
                            RectF rectF = this.rect;
                            RectF rectF2 = this.visibleRect;
                            rectF.set(BitmapDescriptorFactory.HUE_RED, rectF2.top, rectF2.left, rectF2.bottom);
                        } else if (i == 1) {
                            this.rect.set(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, f, this.visibleRect.top);
                        } else if (i == 2) {
                            RectF rectF3 = this.rect;
                            RectF rectF4 = this.visibleRect;
                            rectF3.set(rectF4.right, rectF4.top, f, rectF4.bottom);
                        } else if (i == 3) {
                            this.rect.set(BitmapDescriptorFactory.HUE_RED, this.visibleRect.bottom, f, f2);
                        }
                        canvas.drawRect(this.rect, this.paint);
                    }
                }
            }
            if (getAlpha() == 0 || (runnable = this.drawRunnable) == null) {
                return;
            }
            AndroidUtilities.runOnUIThread(runnable);
            this.drawRunnable = null;
        }

        @Override // android.graphics.drawable.ColorDrawable, android.graphics.drawable.Drawable
        public void setAlpha(int i) {
            if (PhotoViewer.this.parentActivity instanceof LaunchActivity) {
                this.allowDrawContent = (PhotoViewer.this.isVisible && i == 255) ? false : true;
                ((LaunchActivity) PhotoViewer.this.parentActivity).drawerLayoutContainer.setAllowDrawContent(this.allowDrawContent);
                if (PhotoViewer.this.parentAlert != null) {
                    if (this.allowDrawContent) {
                        PhotoViewer.this.parentAlert.setAllowDrawContent(true);
                    } else {
                        AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$BackgroundDrawable$$ExternalSyntheticLambda0
                            @Override // java.lang.Runnable
                            public final void run() {
                                this.f$0.lambda$setAlpha$0();
                            }
                        }, 50L);
                    }
                }
            }
            super.setAlpha(i);
            this.paint.setAlpha(i);
        }
    }

    private class BlurButton extends StickerCutOutBtn {
        private boolean active;
        private final AnimatedFloat activeFloat;
        private final Path path;

        public BlurButton() {
            super(PhotoViewer.this.stickerMakerView, PhotoViewer.this.activityContext, PhotoViewer.this.resourcesProvider, PhotoViewer.this.blurManager);
            this.path = new Path();
            this.activeFloat = new AnimatedFloat(this, 0L, 420L, CubicBezierInterpolator.EASE_OUT_QUINT);
        }

        public boolean isActive() {
            return this.active;
        }

        @Override // org.telegram.ui.Components.Paint.Views.StickerCutOutBtn, org.telegram.ui.Stories.recorder.ButtonWithCounterView, android.view.View
        protected void onDraw(Canvas canvas) {
            canvas.save();
            this.path.rewind();
            this.path.addRoundRect(this.bounds, AndroidUtilities.dp(this.rad), AndroidUtilities.dp(this.rad), Path.Direction.CW);
            canvas.clipPath(this.path);
            canvas.translate(-getX(), -getY());
            if (this == PhotoViewer.this.eraseBtn || this == PhotoViewer.this.restoreBtn) {
                canvas.translate(-PhotoViewer.this.btnLayout.getX(), -PhotoViewer.this.btnLayout.getY());
            }
            PhotoViewer.this.drawCaptionBlur(canvas, this.blurDrawer, -13948117, AndroidUtilities.DARK_STATUS_BAR_OVERLAY, false, true, false);
            float f = this.activeFloat.set(this.active);
            if (f > BitmapDescriptorFactory.HUE_RED) {
                canvas.drawColor(Theme.multAlpha(-1, f));
            }
            setTextColor(ColorUtils.blendARGB(-1, -16777216, f));
            canvas.restore();
            super.onDraw(canvas);
        }

        @Override // android.view.View
        public void onDrawForeground(Canvas canvas) {
            canvas.save();
            canvas.clipPath(this.path);
            super.onDrawForeground(canvas);
            canvas.restore();
        }

        public void setActive(boolean z, boolean z2) {
            this.active = z;
            if (!z2) {
                this.activeFloat.set(z, true);
            }
            invalidate();
        }
    }

    public static class CaptionScrollView extends NestedScrollView {
        private Method abortAnimatedScrollMethod;
        public float backgroundAlpha;
        private final FrameLayout captionContainer;
        private final CaptionTextViewSwitcher captionTextViewSwitcher;
        public boolean dontChangeTopMargin;
        private boolean isLandscape;
        private boolean nestedScrollStarted;
        private float overScrollY;
        private final Paint paint;
        private int pendingTopMargin;
        private int prevHeight;
        private OverScroller scroller;
        private final SpringAnimation springAnimation;
        private int textHash;
        private float velocitySign;
        private float velocityY;

        public CaptionScrollView(Context context, CaptionTextViewSwitcher captionTextViewSwitcher, FrameLayout frameLayout) throws NoSuchFieldException, NoSuchMethodException, SecurityException {
            super(context);
            Paint paint = new Paint(1);
            this.paint = paint;
            this.backgroundAlpha = 1.0f;
            this.pendingTopMargin = -1;
            this.captionTextViewSwitcher = captionTextViewSwitcher;
            this.captionContainer = frameLayout;
            setClipChildren(false);
            setOverScrollMode(2);
            paint.setColor(-16777216);
            setFadingEdgeLength(AndroidUtilities.dp(12.0f));
            setVerticalFadingEdgeEnabled(true);
            setWillNotDraw(false);
            SpringAnimation springAnimation = new SpringAnimation(captionTextViewSwitcher, DynamicAnimation.TRANSLATION_Y, BitmapDescriptorFactory.HUE_RED);
            this.springAnimation = springAnimation;
            springAnimation.getSpring().setStiffness(100.0f);
            springAnimation.setMinimumVisibleChange(1.0f);
            springAnimation.addUpdateListener(new DynamicAnimation.OnAnimationUpdateListener() { // from class: org.telegram.ui.PhotoViewer$CaptionScrollView$$ExternalSyntheticLambda0
                @Override // androidx.dynamicanimation.animation.DynamicAnimation.OnAnimationUpdateListener
                public final void onAnimationUpdate(DynamicAnimation dynamicAnimation, float f, float f2) {
                    this.f$0.lambda$new$0(dynamicAnimation, f, f2);
                }
            });
            springAnimation.addEndListener(new DynamicAnimation.OnAnimationEndListener() { // from class: org.telegram.ui.PhotoViewer$CaptionScrollView$$ExternalSyntheticLambda1
                @Override // androidx.dynamicanimation.animation.DynamicAnimation.OnAnimationEndListener
                public final void onAnimationEnd(DynamicAnimation dynamicAnimation, boolean z, float f, float f2) {
                    this.f$0.lambda$new$1(dynamicAnimation, z, f, f2);
                }
            });
            springAnimation.getSpring().setDampingRatio(1.0f);
            try {
                Method declaredMethod = NestedScrollView.class.getDeclaredMethod("abortAnimatedScroll", null);
                this.abortAnimatedScrollMethod = declaredMethod;
                declaredMethod.setAccessible(true);
            } catch (Exception e) {
                this.abortAnimatedScrollMethod = null;
                FileLog.e(e);
            }
            try {
                Field declaredField = NestedScrollView.class.getDeclaredField("mScroller");
                declaredField.setAccessible(true);
                this.scroller = (OverScroller) declaredField.get(this);
            } catch (Exception e2) {
                this.scroller = null;
                FileLog.e(e2);
            }
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$new$0(DynamicAnimation dynamicAnimation, float f, float f2) {
            this.overScrollY = f;
            this.velocityY = f2;
            onScrollUpdate();
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$new$1(DynamicAnimation dynamicAnimation, boolean z, float f, float f2) {
            onScrollEnd();
        }

        private void startSpringAnimationIfNotRunning(float f) {
            if (this.springAnimation.isRunning()) {
                return;
            }
            this.springAnimation.setStartVelocity(f);
            this.springAnimation.start();
        }

        private void updateTopMargin(int i, int i2) {
            int iCalculateNewContainerMarginTop = calculateNewContainerMarginTop(i, i2);
            if (iCalculateNewContainerMarginTop >= 0) {
                if (!this.dontChangeTopMargin) {
                    ((ViewGroup.MarginLayoutParams) this.captionContainer.getLayoutParams()).topMargin = iCalculateNewContainerMarginTop;
                    iCalculateNewContainerMarginTop = -1;
                }
                this.pendingTopMargin = iCalculateNewContainerMarginTop;
            }
        }

        public void applyPendingTopMargin() {
            this.dontChangeTopMargin = false;
            if (this.pendingTopMargin >= 0) {
                ((ViewGroup.MarginLayoutParams) this.captionContainer.getLayoutParams()).topMargin = this.pendingTopMargin;
                this.pendingTopMargin = -1;
                requestLayout();
            }
        }

        public int calculateNewContainerMarginTop(int i, int i2) {
            int fontMetricsInt;
            int iDp;
            if (i == 0 || i2 == 0) {
                return -1;
            }
            TextView currentView = this.captionTextViewSwitcher.getCurrentView();
            CharSequence text = currentView.getText();
            int iHashCode = text.hashCode();
            Point point = AndroidUtilities.displaySize;
            boolean z = point.x > point.y;
            if (this.textHash == iHashCode && this.isLandscape == z && this.prevHeight == i2) {
                return -1;
            }
            this.textHash = iHashCode;
            this.isLandscape = z;
            this.prevHeight = i2;
            currentView.measure(View.MeasureSpec.makeMeasureSpec(i, 1073741824), View.MeasureSpec.makeMeasureSpec(i2, Integer.MIN_VALUE));
            Layout layout = currentView.getLayout();
            int lineCount = layout.getLineCount();
            if ((!z || lineCount > 2) && (z || lineCount > 5)) {
                int iMin = Math.min(z ? 2 : 5, lineCount);
                loop0: while (iMin > 1) {
                    int i3 = iMin - 1;
                    for (int lineStart = layout.getLineStart(i3); lineStart < layout.getLineEnd(i3); lineStart++) {
                        if (!Character.isWhitespace(text.charAt(lineStart))) {
                            break loop0;
                        }
                    }
                    iMin--;
                }
                fontMetricsInt = i2 - (currentView.getPaint().getFontMetricsInt(null) * iMin);
                iDp = AndroidUtilities.dp(8.0f);
            } else {
                fontMetricsInt = i2 - currentView.getMeasuredHeight();
                iDp = this.captionTextViewSwitcher.getPaddingBottom();
            }
            return fontMetricsInt - iDp;
        }

        @Override // androidx.core.widget.NestedScrollView, android.view.View
        public void computeScroll() {
            OverScroller overScroller;
            super.computeScroll();
            if (!this.nestedScrollStarted && this.overScrollY != BitmapDescriptorFactory.HUE_RED && (overScroller = this.scroller) != null && overScroller.isFinished()) {
                startSpringAnimationIfNotRunning(BitmapDescriptorFactory.HUE_RED);
            }
            onScrollUpdate();
        }

        @Override // androidx.core.widget.NestedScrollView
        public boolean dispatchNestedPreScroll(int i, int i2, int[] iArr, int[] iArr2, int i3) {
            iArr[1] = 0;
            if (this.nestedScrollStarted) {
                float f = this.overScrollY;
                if ((f > BitmapDescriptorFactory.HUE_RED && i2 > 0) || (f < BitmapDescriptorFactory.HUE_RED && i2 < 0)) {
                    float f2 = i2;
                    float f3 = f - f2;
                    if (f > BitmapDescriptorFactory.HUE_RED) {
                        if (f3 < BitmapDescriptorFactory.HUE_RED) {
                            this.overScrollY = BitmapDescriptorFactory.HUE_RED;
                            iArr[1] = (int) (0 + f2 + f3);
                        } else {
                            this.overScrollY = f3;
                            iArr[1] = i2;
                        }
                    } else if (f3 > BitmapDescriptorFactory.HUE_RED) {
                        this.overScrollY = BitmapDescriptorFactory.HUE_RED;
                        iArr[1] = (int) (0 + f2 + f3);
                    } else {
                        this.overScrollY = f3;
                        iArr[1] = i2;
                    }
                    onScrollUpdate();
                    this.captionTextViewSwitcher.setTranslationY(this.overScrollY);
                    return true;
                }
            }
            return false;
        }

        @Override // androidx.core.widget.NestedScrollView
        public void dispatchNestedScroll(int i, int i2, int i3, int i4, int[] iArr, int i5, int[] iArr2) {
            float f;
            if (i4 != 0) {
                int iRound = Math.round(i4 * (1.0f - Math.abs((-this.overScrollY) / (this.captionContainer.getTop() - ((isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0) + ActionBar.getCurrentActionBarHeight())))));
                if (iRound != 0) {
                    if (this.nestedScrollStarted) {
                        float f2 = this.overScrollY - iRound;
                        this.overScrollY = f2;
                        this.captionTextViewSwitcher.setTranslationY(f2);
                    } else if (!this.springAnimation.isRunning()) {
                        OverScroller overScroller = this.scroller;
                        float currVelocity = overScroller != null ? overScroller.getCurrVelocity() : Float.NaN;
                        if (Float.isNaN(currVelocity)) {
                            f = BitmapDescriptorFactory.HUE_RED;
                        } else {
                            Point point = AndroidUtilities.displaySize;
                            float fMin = Math.min(point.x > point.y ? 3000.0f : 5000.0f, currVelocity);
                            iRound = (int) ((iRound * fMin) / currVelocity);
                            f = fMin * (-this.velocitySign);
                        }
                        if (iRound != 0) {
                            float f3 = this.overScrollY - iRound;
                            this.overScrollY = f3;
                            this.captionTextViewSwitcher.setTranslationY(f3);
                        }
                        startSpringAnimationIfNotRunning(f);
                    }
                }
                onScrollUpdate();
            }
        }

        @Override // androidx.core.widget.NestedScrollView, android.view.View
        public void draw(Canvas canvas) {
            int width = getWidth();
            int height = getHeight();
            int scrollY = getScrollY();
            int iSave = canvas.save();
            int i = height + scrollY;
            canvas.clipRect(0, scrollY, width, i);
            this.paint.setAlpha((int) (this.backgroundAlpha * 127.0f));
            canvas.drawRect(BitmapDescriptorFactory.HUE_RED, this.captionContainer.getTop() + this.captionTextViewSwitcher.getTranslationY(), width, i, this.paint);
            super.draw(canvas);
            canvas.restoreToCount(iSave);
        }

        @Override // androidx.core.widget.NestedScrollView
        public void fling(int i) {
            super.fling(i);
            this.velocitySign = Math.signum(i);
            this.velocityY = BitmapDescriptorFactory.HUE_RED;
        }

        @Override // androidx.core.widget.NestedScrollView, android.view.View
        protected float getBottomFadingEdgeStrength() {
            return 1.0f;
        }

        public int getPendingMarginTopDiff() {
            int i = this.pendingTopMargin;
            if (i >= 0) {
                return i - ((ViewGroup.MarginLayoutParams) this.captionContainer.getLayoutParams()).topMargin;
            }
            return 0;
        }

        @Override // androidx.core.widget.NestedScrollView, android.view.View
        protected float getTopFadingEdgeStrength() {
            return 1.0f;
        }

        protected boolean isStatusBarVisible() {
            return true;
        }

        @Override // androidx.core.widget.NestedScrollView, android.widget.FrameLayout, android.view.View
        protected void onMeasure(int i, int i2) {
            updateTopMargin(View.MeasureSpec.getSize(i), View.MeasureSpec.getSize(i2));
            super.onMeasure(i, i2);
        }

        protected void onScrollEnd() {
        }

        protected void onScrollStart() {
        }

        protected void onScrollUpdate() {
        }

        @Override // androidx.core.widget.NestedScrollView, android.view.View
        public boolean onTouchEvent(MotionEvent motionEvent) {
            if (motionEvent.getAction() != 0 || motionEvent.getY() >= (this.captionContainer.getTop() - getScrollY()) + this.captionTextViewSwitcher.getTranslationY()) {
                return super.onTouchEvent(motionEvent);
            }
            return false;
        }

        public void reset() {
            scrollTo(0, 0);
        }

        @Override // androidx.core.widget.NestedScrollView
        public boolean startNestedScroll(int i, int i2) {
            if (i2 == 0) {
                this.springAnimation.cancel();
                this.nestedScrollStarted = true;
                this.overScrollY = this.captionTextViewSwitcher.getTranslationY();
                onScrollStart();
            }
            return true;
        }

        @Override // androidx.core.widget.NestedScrollView
        public void stopNestedScroll(int i) {
            OverScroller overScroller;
            if (this.nestedScrollStarted && i == 0) {
                this.nestedScrollStarted = false;
                if (this.overScrollY != BitmapDescriptorFactory.HUE_RED && (overScroller = this.scroller) != null && overScroller.isFinished()) {
                    startSpringAnimationIfNotRunning(this.velocityY);
                }
                onScrollEnd();
            }
        }

        public void stopScrolling() throws IllegalAccessException, IllegalArgumentException, InvocationTargetException {
            Method method = this.abortAnimatedScrollMethod;
            if (method != null) {
                try {
                    method.invoke(this, null);
                } catch (Exception e) {
                    FileLog.e(e);
                }
            }
        }

        public void updateTopMargin() {
            updateTopMargin(getWidth(), getHeight());
        }
    }

    public static class CaptionTextView extends SpoilersTextView {
        private AnimatedEmojiSpan.EmojiGroupedSpans animatedEmojiDrawables;
        private boolean hasQuote;
        private Layout lastLayout;
        private Layout lastLoadingLayout;
        private boolean loading;
        private LoadingDrawable loadingDrawable;
        private Path loadingPath;
        private ArrayList quoteBlocks;
        private final TextSelectionHelper.SimpleTextSelectionHelper textSelectionHelper;

        public CaptionTextView(Context context, final CaptionScrollView captionScrollView, TextSelectionHelper.SimpleTextSelectionHelper simpleTextSelectionHelper, final Utilities.Callback2 callback2, final Utilities.Callback3 callback3) {
            super(context);
            setClearLinkOnLongPress(false);
            setDisablePaddingsOffsetY(false);
            this.onPressListener = new LinkSpanDrawable.LinksTextView.OnLinkPress() { // from class: org.telegram.ui.PhotoViewer$CaptionTextView$$ExternalSyntheticLambda0
                @Override // org.telegram.ui.Components.LinkSpanDrawable.LinksTextView.OnLinkPress
                public final void run(ClickableSpan clickableSpan) {
                    this.f$0.lambda$new$0(callback2, clickableSpan);
                }
            };
            this.onLongPressListener = new LinkSpanDrawable.LinksTextView.OnLinkPress() { // from class: org.telegram.ui.PhotoViewer$CaptionTextView$$ExternalSyntheticLambda1
                @Override // org.telegram.ui.Components.LinkSpanDrawable.LinksTextView.OnLinkPress
                public final void run(ClickableSpan clickableSpan) {
                    this.f$0.lambda$new$1(callback3, clickableSpan);
                }
            };
            this.textSelectionHelper = simpleTextSelectionHelper;
            ViewHelper.setPadding(this, 16.0f, 8.0f, 16.0f, 8.0f);
            setLinkTextColor(-8796932);
            setTextColor(-1);
            setHighlightColor(872415231);
            setGravity(LayoutHelper.getAbsoluteGravityStart() | 16);
            setTextSize(1, 16.0f);
            setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$CaptionTextView$$ExternalSyntheticLambda2
                @Override // android.view.View.OnClickListener
                public final void onClick(View view) {
                    PhotoViewer.CaptionTextView.lambda$new$2(captionScrollView, view);
                }
            });
        }

        private void checkLoadingPath() {
            Layout layout = getLayout();
            Path path = this.loadingPath;
            if (path == null || this.lastLoadingLayout != layout) {
                if (path == null) {
                    this.loadingPath = new Path();
                } else {
                    path.rewind();
                }
                if (layout != null) {
                    float fDp = AndroidUtilities.dp(16.0f);
                    float fDp2 = AndroidUtilities.dp(8.0f);
                    float lineTop = BitmapDescriptorFactory.HUE_RED;
                    int i = 0;
                    while (i < layout.getLineCount()) {
                        float f = fDp / 3.0f;
                        float lineLeft = layout.getLineLeft(i) - f;
                        float lineRight = layout.getLineRight(i) + f;
                        if (i == 0) {
                            lineTop = layout.getLineTop(i) - (fDp2 / 3.0f);
                        }
                        float lineBottom = layout.getLineBottom(i);
                        if (i >= layout.getLineCount() - 1) {
                            lineBottom += fDp2 / 3.0f;
                        }
                        this.loadingPath.addRect(getPaddingLeft() + lineLeft, getPaddingTop() + lineTop, getPaddingLeft() + lineRight, getPaddingTop() + lineBottom, Path.Direction.CW);
                        i++;
                        lineTop = lineBottom;
                    }
                }
                this.lastLoadingLayout = layout;
            }
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$new$0(Utilities.Callback2 callback2, ClickableSpan clickableSpan) {
            callback2.run(clickableSpan, this);
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$new$1(Utilities.Callback3 callback3, ClickableSpan clickableSpan) {
            callback3.run(clickableSpan, this, new Runnable() { // from class: org.telegram.ui.PhotoViewer$CaptionTextView$$ExternalSyntheticLambda3
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.clearLinks();
                }
            });
        }

        /* JADX INFO: Access modifiers changed from: private */
        public static /* synthetic */ void lambda$new$2(CaptionScrollView captionScrollView, View view) {
            if (captionScrollView != null) {
                captionScrollView.smoothScrollBy(0, AndroidUtilities.dp(64.0f));
            }
        }

        @Override // android.view.View
        protected void dispatchDraw(Canvas canvas) {
            if (this.loading) {
                checkLoadingPath();
                if (this.loadingDrawable == null) {
                    LoadingDrawable loadingDrawable = new LoadingDrawable();
                    this.loadingDrawable = loadingDrawable;
                    loadingDrawable.usePath(this.loadingPath);
                    this.loadingDrawable.setRadiiDp(4.0f);
                    this.loadingDrawable.setColors(Theme.multAlpha(-1, 0.3f), Theme.multAlpha(-1, 0.1f), Theme.multAlpha(-1, 0.2f), Theme.multAlpha(-1, 0.7f));
                    this.loadingDrawable.setCallback(this);
                }
                this.loadingDrawable.setBounds(0, 0, getWidth(), getHeight());
                this.loadingDrawable.draw(canvas);
            }
            if (this.loading) {
                canvas.saveLayerAlpha(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, getWidth(), getHeight(), 178, 31);
            }
            if (this.quoteBlocks != null && this.hasQuote) {
                canvas.save();
                canvas.translate(getPaddingLeft(), getPaddingTop());
                for (int i = 0; i < this.quoteBlocks.size(); i++) {
                    ((QuoteSpan.Block) this.quoteBlocks.get(i)).draw(canvas, BitmapDescriptorFactory.HUE_RED, ((getWidth() - getPaddingLeft()) - getPaddingRight()) + (this.hasQuote ? AndroidUtilities.dp(32.0f) : 0), -1, 1.0f, getPaint());
                }
                canvas.restore();
            }
            super.dispatchDraw(canvas);
            if (this.loading) {
                canvas.restore();
            }
            canvas.save();
            canvas.translate(getPaddingLeft(), getPaddingTop());
            canvas.clipRect(BitmapDescriptorFactory.HUE_RED, getScrollY(), getWidth() - getPaddingRight(), (getHeight() + getScrollY()) - (getPaddingBottom() * 0.75f));
            AnimatedEmojiSpan.drawAnimatedEmojis(canvas, getLayout(), this.animatedEmojiDrawables, BitmapDescriptorFactory.HUE_RED, null, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 1.0f);
            canvas.restore();
        }

        @Override // android.view.View
        protected void onDetachedFromWindow() {
            super.onDetachedFromWindow();
            AnimatedEmojiSpan.release(this, this.animatedEmojiDrawables);
            this.quoteBlocks = QuoteSpan.updateQuoteBlocksSpanned(null, this.quoteBlocks);
        }

        @Override // org.telegram.ui.Components.spoilers.SpoilersTextView, android.widget.TextView, android.view.View
        protected void onDraw(Canvas canvas) {
            TextSelectionHelper.SimpleTextSelectionHelper simpleTextSelectionHelper = this.textSelectionHelper;
            if (simpleTextSelectionHelper != null && simpleTextSelectionHelper.isInSelectionMode()) {
                canvas.save();
                canvas.translate(getPaddingLeft(), getPaddingTop());
                if (this.textSelectionHelper != null && getStaticTextLayout() != null && this.textSelectionHelper.isCurrent(this)) {
                    this.textSelectionHelper.draw(canvas);
                }
                canvas.restore();
            }
            super.onDraw(canvas);
            if (this.lastLayout != getLayout()) {
                this.animatedEmojiDrawables = AnimatedEmojiSpan.update(0, this, this.animatedEmojiDrawables, getLayout());
                this.quoteBlocks = QuoteSpan.updateQuoteBlocksSpanned(getLayout(), this.quoteBlocks);
                boolean z = getLayout() != null && (getLayout().getText() instanceof Spanned) && ((QuoteSpan.QuoteStyleSpan[]) ((Spanned) getLayout().getText()).getSpans(0, getLayout().getText().length(), QuoteSpan.QuoteStyleSpan.class)).length > 0;
                this.hasQuote = z;
                ViewHelper.setPadding(this, 16.0f, 8.0f, (z ? 32 : 0) + 16, 8.0f);
                this.lastLayout = getLayout();
            }
        }

        @Override // org.telegram.ui.Components.spoilers.SpoilersTextView, android.widget.TextView
        protected void onTextChanged(CharSequence charSequence, int i, int i2, int i3) {
            super.onTextChanged(charSequence, i, i2, i3);
            this.animatedEmojiDrawables = AnimatedEmojiSpan.update(0, this, this.animatedEmojiDrawables, getLayout());
            this.quoteBlocks = QuoteSpan.updateQuoteBlocksSpanned(getLayout(), this.quoteBlocks);
        }

        public void setLoading(boolean z) {
            if (this.loading == z) {
                return;
            }
            this.loading = z;
            invalidate();
        }

        @Override // android.view.View
        public void setPressed(boolean z) {
            boolean z2 = z != isPressed();
            super.setPressed(z);
            if (z2) {
                invalidate();
            }
        }

        @Override // android.widget.TextView, android.view.View
        protected boolean verifyDrawable(Drawable drawable) {
            return drawable == this.loadingDrawable || super.verifyDrawable(drawable);
        }
    }

    public static class CaptionTextViewSwitcher extends TextViewSwitcher {
        private float alpha;
        private FrameLayout container;
        private boolean inScrollView;
        private NestedScrollView scrollView;

        public CaptionTextViewSwitcher(Context context) {
            super(context);
            this.inScrollView = false;
            this.alpha = 1.0f;
        }

        @Override // android.view.View
        public float getAlpha() {
            return this.inScrollView ? this.alpha : super.getAlpha();
        }

        @Override // android.view.ViewGroup, android.view.View
        protected void onAttachedToWindow() {
            super.onAttachedToWindow();
            if (this.container == null || getParent() != this.container) {
                return;
            }
            this.inScrollView = true;
            this.scrollView.setVisibility(getVisibility());
            this.scrollView.setAlpha(this.alpha);
            super.setAlpha(1.0f);
        }

        @Override // android.view.ViewGroup, android.view.View
        protected void onDetachedFromWindow() {
            super.onDetachedFromWindow();
            if (this.inScrollView) {
                this.inScrollView = false;
                this.scrollView.setVisibility(8);
                super.setAlpha(this.alpha);
            }
        }

        @Override // android.view.View
        public void setAlpha(float f) {
            this.alpha = f;
            if (this.inScrollView) {
                this.scrollView.setAlpha(f);
            } else {
                super.setAlpha(f);
            }
        }

        public void setContainer(FrameLayout frameLayout) {
            this.container = frameLayout;
        }

        public void setScrollView(NestedScrollView nestedScrollView) {
            this.scrollView = nestedScrollView;
        }

        @Override // android.view.View
        public void setTranslationY(float f) {
            super.setTranslationY(f);
            if (this.inScrollView) {
                this.scrollView.invalidate();
            }
        }

        @Override // android.view.View
        public void setVisibility(int i) {
            setVisibility(i, true);
        }

        public void setVisibility(int i, boolean z) {
            super.setVisibility(i);
            if (this.inScrollView && z) {
                this.scrollView.setVisibility(i);
            }
        }
    }

    private static class CounterView extends View {
        private int currentCount;
        private int height;
        private Paint paint;
        private RectF rect;
        private float rotation;
        private StaticLayout staticLayout;
        private TextPaint textPaint;
        private int width;

        public CounterView(Context context) {
            super(context);
            this.currentCount = 0;
            TextPaint textPaint = new TextPaint(1);
            this.textPaint = textPaint;
            textPaint.setTextSize(AndroidUtilities.dp(15.0f));
            this.textPaint.setTypeface(AndroidUtilities.bold());
            this.textPaint.setColor(-1);
            Paint paint = new Paint(1);
            this.paint = paint;
            paint.setColor(-1);
            this.paint.setStrokeWidth(AndroidUtilities.dp(2.0f));
            this.paint.setStyle(Paint.Style.STROKE);
            this.paint.setStrokeJoin(Paint.Join.ROUND);
            this.rect = new RectF();
            setCount(0);
        }

        @Override // android.view.View
        public float getRotationX() {
            return this.rotation;
        }

        @Override // android.view.View
        protected void onDraw(Canvas canvas) {
            int measuredHeight = getMeasuredHeight() / 2;
            this.paint.setAlpha(255);
            this.rect.set(AndroidUtilities.dp(1.0f), measuredHeight - AndroidUtilities.dp(14.0f), getMeasuredWidth() - AndroidUtilities.dp(1.0f), measuredHeight + AndroidUtilities.dp(14.0f));
            canvas.drawRoundRect(this.rect, AndroidUtilities.dp(15.0f), AndroidUtilities.dp(15.0f), this.paint);
            if (this.staticLayout != null) {
                this.textPaint.setAlpha((int) ((1.0f - this.rotation) * 255.0f));
                canvas.save();
                canvas.translate((getMeasuredWidth() - this.width) / 2, ((getMeasuredHeight() - this.height) / 2) + AndroidUtilities.dpf2(0.2f) + (this.rotation * AndroidUtilities.dp(5.0f)));
                this.staticLayout.draw(canvas);
                canvas.restore();
                this.paint.setAlpha((int) (this.rotation * 255.0f));
                int iCenterX = (int) this.rect.centerX();
                int iCenterY = (int) (((int) this.rect.centerY()) - (AndroidUtilities.dp(5.0f) * (1.0f - this.rotation)));
                canvas.drawLine(AndroidUtilities.dp(5.0f) + iCenterX, iCenterY - AndroidUtilities.dp(5.0f), iCenterX - AndroidUtilities.dp(5.0f), AndroidUtilities.dp(5.0f) + iCenterY, this.paint);
                canvas.drawLine(iCenterX - AndroidUtilities.dp(5.0f), iCenterY - AndroidUtilities.dp(5.0f), iCenterX + AndroidUtilities.dp(5.0f), iCenterY + AndroidUtilities.dp(5.0f), this.paint);
            }
        }

        @Override // android.view.View
        protected void onMeasure(int i, int i2) {
            super.onMeasure(View.MeasureSpec.makeMeasureSpec(Math.max(this.width + AndroidUtilities.dp(20.0f), AndroidUtilities.dp(30.0f)), 1073741824), View.MeasureSpec.makeMeasureSpec(AndroidUtilities.dp(40.0f), 1073741824));
        }

        public void setCount(int i) {
            TimeInterpolator overshootInterpolator;
            StaticLayout staticLayout = new StaticLayout("" + Math.max(1, i), this.textPaint, AndroidUtilities.dp(100.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
            this.staticLayout = staticLayout;
            this.width = (int) Math.ceil((double) staticLayout.getLineWidth(0));
            this.height = this.staticLayout.getLineBottom(0);
            AnimatorSet animatorSet = new AnimatorSet();
            if (i == 0) {
                ObjectAnimator objectAnimatorOfFloat = ObjectAnimator.ofFloat(this, (Property<CounterView, Float>) View.SCALE_X, BitmapDescriptorFactory.HUE_RED);
                ObjectAnimator objectAnimatorOfFloat2 = ObjectAnimator.ofFloat(this, (Property<CounterView, Float>) View.SCALE_Y, BitmapDescriptorFactory.HUE_RED);
                Paint paint = this.paint;
                Property property = AnimationProperties.PAINT_ALPHA;
                animatorSet.playTogether(objectAnimatorOfFloat, objectAnimatorOfFloat2, ObjectAnimator.ofInt(paint, (Property<Paint, Integer>) property, 0), ObjectAnimator.ofInt(this.textPaint, (Property<TextPaint, Integer>) property, 0));
                overshootInterpolator = new DecelerateInterpolator();
            } else {
                int i2 = this.currentCount;
                if (i2 == 0) {
                    ObjectAnimator objectAnimatorOfFloat3 = ObjectAnimator.ofFloat(this, (Property<CounterView, Float>) View.SCALE_X, BitmapDescriptorFactory.HUE_RED, 1.0f);
                    ObjectAnimator objectAnimatorOfFloat4 = ObjectAnimator.ofFloat(this, (Property<CounterView, Float>) View.SCALE_Y, BitmapDescriptorFactory.HUE_RED, 1.0f);
                    Paint paint2 = this.paint;
                    Property property2 = AnimationProperties.PAINT_ALPHA;
                    animatorSet.playTogether(objectAnimatorOfFloat3, objectAnimatorOfFloat4, ObjectAnimator.ofInt(paint2, (Property<Paint, Integer>) property2, 0, 255), ObjectAnimator.ofInt(this.textPaint, (Property<TextPaint, Integer>) property2, 0, 255));
                    overshootInterpolator = new DecelerateInterpolator();
                } else {
                    Property property3 = View.SCALE_X;
                    float[] fArr = {0.9f, 1.0f};
                    if (i < i2) {
                        // fill-array-data instruction
                        fArr[0] = 1.1f;
                        fArr[1] = 1.0f;
                        animatorSet.playTogether(ObjectAnimator.ofFloat(this, (Property<CounterView, Float>) property3, fArr), ObjectAnimator.ofFloat(this, (Property<CounterView, Float>) View.SCALE_Y, 1.1f, 1.0f));
                        overshootInterpolator = new OvershootInterpolator();
                    } else {
                        animatorSet.playTogether(ObjectAnimator.ofFloat(this, (Property<CounterView, Float>) property3, fArr), ObjectAnimator.ofFloat(this, (Property<CounterView, Float>) View.SCALE_Y, 0.9f, 1.0f));
                        overshootInterpolator = new OvershootInterpolator();
                    }
                }
            }
            animatorSet.setInterpolator(overshootInterpolator);
            animatorSet.setDuration(180L);
            animatorSet.start();
            requestLayout();
            this.currentCount = i;
        }

        @Override // android.view.View
        public void setRotationX(float f) {
            this.rotation = f;
            invalidate();
        }

        @Override // android.view.View
        public void setScaleX(float f) {
            super.setScaleX(f);
            invalidate();
        }
    }

    public static class EditState {
        public long averageDuration;
        public MediaController.CropState cropState;
        public ArrayList croppedMediaEntities;
        public String croppedPaintPath;
        public ArrayList mediaEntities;
        public String paintPath;
        public MediaController.SavedFilterState savedFilterState;

        public void reset() {
            this.paintPath = null;
            this.cropState = null;
            this.savedFilterState = null;
            this.mediaEntities = null;
            this.croppedPaintPath = null;
            this.croppedMediaEntities = null;
            this.averageDuration = 0L;
        }
    }

    public static class EmptyPhotoViewerProvider implements PhotoViewerProvider {
        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public boolean allowCaption() {
            return true;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public boolean allowSendingSubmenu() {
            return true;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public boolean canCaptureMorePhotos() {
            return true;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public boolean canEdit(int i) {
            return false;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public /* synthetic */ boolean canLoadMoreAvatars() {
            return PhotoViewerProvider.CC.$default$canLoadMoreAvatars(this);
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public /* synthetic */ boolean canMoveCaptionAbove() {
            return PhotoViewerProvider.CC.$default$canMoveCaptionAbove(this);
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public boolean canReplace(int i) {
            return false;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public boolean canScrollAway() {
            return true;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public boolean cancelButtonPressed() {
            return true;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public boolean closeKeyboard() {
            return false;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public void deleteImageAtIndex(int i) {
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public /* synthetic */ boolean forceAllInGroup() {
            return PhotoViewerProvider.CC.$default$forceAllInGroup(this);
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public String getDeleteMessageString() {
            return null;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public /* bridge */ /* synthetic */ long getDialogId() {
            return PhotoViewerProvider.CC.$default$getDialogId(this);
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public MessageObject getEditingMessageObject() {
            return null;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public int getPhotoIndex(int i) {
            return -1;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public PlaceProviderObject getPlaceForPhoto(MessageObject messageObject, TLRPC.FileLocation fileLocation, int i, boolean z, boolean z2) {
            return null;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public int getSelectedCount() {
            return 0;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public HashMap getSelectedPhotos() {
            return null;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public ArrayList getSelectedPhotosOrder() {
            return null;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public ImageReceiver.BitmapHolder getThumbForPhoto(MessageObject messageObject, TLRPC.FileLocation fileLocation, int i) {
            return null;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public int getTotalImageCount() {
            return -1;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public /* synthetic */ boolean isCaptionAbove() {
            return PhotoViewerProvider.CC.$default$isCaptionAbove(this);
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public /* synthetic */ boolean isEditingMessage() {
            return PhotoViewerProvider.CC.$default$isEditingMessage(this);
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public /* synthetic */ boolean isEditingMessageResend() {
            return PhotoViewerProvider.CC.$default$isEditingMessageResend(this);
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public boolean isPhotoChecked(int i) {
            return false;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public boolean loadMore() {
            return false;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public /* synthetic */ void moveCaptionAbove(boolean z) {
            PhotoViewerProvider.CC.$default$moveCaptionAbove(this, z);
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public void needAddMorePhotos() {
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public void onApplyCaption(CharSequence charSequence) {
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public void onClose() {
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public /* synthetic */ boolean onDeletePhoto(int i) {
            return PhotoViewerProvider.CC.$default$onDeletePhoto(this, i);
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public /* synthetic */ void onEditModeChanged(boolean z) {
            PhotoViewerProvider.CC.$default$onEditModeChanged(this, z);
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public void onOpen() {
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public /* synthetic */ void onPreClose() {
            PhotoViewerProvider.CC.$default$onPreClose(this);
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public /* synthetic */ void onPreOpen() {
            PhotoViewerProvider.CC.$default$onPreOpen(this);
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public /* synthetic */ void onReleasePlayerBeforeClose(int i) {
            PhotoViewerProvider.CC.$default$onReleasePlayerBeforeClose(this, i);
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public void openPhotoForEdit(String str, String str2, boolean z) {
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public void replaceButtonPressed(int i, VideoEditedInfo videoEditedInfo) {
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public boolean scaleToFill() {
            return false;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public void sendButtonPressed(int i, VideoEditedInfo videoEditedInfo, boolean z, int i2, boolean z2) {
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public int setPhotoChecked(int i, VideoEditedInfo videoEditedInfo) {
            return -1;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public int setPhotoUnchecked(Object obj) {
            return -1;
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public void updatePhotoAtIndex(int i) {
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public void willHidePhotoViewer() {
        }

        @Override // org.telegram.ui.PhotoViewer.PhotoViewerProvider
        public void willSwitchFromPhoto(MessageObject messageObject, TLRPC.FileLocation fileLocation, int i) {
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    class FirstFrameView extends ImageView {
        private VideoPlayer currentVideoPlayer;
        private ValueAnimator fadeAnimator;
        private final TimeInterpolator fadeInterpolator;
        private boolean gettingFrame;
        private int gettingFrameIndex;
        private boolean gotError;
        private boolean hasFrame;

        public FirstFrameView(Context context) {
            super(context);
            this.gettingFrameIndex = 0;
            this.gettingFrame = false;
            this.hasFrame = false;
            this.gotError = false;
            this.fadeInterpolator = CubicBezierInterpolator.EASE_IN;
            setAlpha(BitmapDescriptorFactory.HUE_RED);
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$checkFromPlayer$0(int i, Bitmap bitmap) {
            if (i == this.gettingFrameIndex) {
                setImageBitmap(bitmap);
                this.hasFrame = true;
                this.gettingFrame = false;
            }
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$checkFromPlayer$1() {
            this.gotError = true;
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$checkFromPlayer$2(Uri uri, final int i) {
            try {
                File file = new File(uri.getPath());
                int i2 = UserConfig.selectedAccount;
                Point point = AndroidUtilities.displaySize;
                AnimatedFileDrawable animatedFileDrawable = new AnimatedFileDrawable(file, true, 0L, 0, null, null, null, 0L, i2, false, point.x, point.y, null);
                final Bitmap frameAtTime = animatedFileDrawable.getFrameAtTime(0L);
                animatedFileDrawable.recycle();
                AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$FirstFrameView$$ExternalSyntheticLambda2
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$checkFromPlayer$0(i, frameAtTime);
                    }
                });
            } catch (Throwable th) {
                FileLog.e(th);
                AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$FirstFrameView$$ExternalSyntheticLambda3
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$checkFromPlayer$1();
                    }
                });
            }
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$updateAlpha$3(ValueAnimator valueAnimator) {
            setAlpha(((Float) valueAnimator.getAnimatedValue()).floatValue());
        }

        /* JADX INFO: Access modifiers changed from: private */
        public void updateAlpha() {
            if (PhotoViewer.this.videoPlayer == null || PhotoViewer.this.videoPlayer.getDuration() == -9223372036854775807L) {
                ValueAnimator valueAnimator = this.fadeAnimator;
                if (valueAnimator != null) {
                    valueAnimator.cancel();
                    this.fadeAnimator = null;
                }
                setAlpha(BitmapDescriptorFactory.HUE_RED);
                return;
            }
            long jMax = Math.max(0L, PhotoViewer.this.videoPlayer.getDuration() - PhotoViewer.this.videoPlayer.getCurrentPosition());
            float fMax = 1.0f - Math.max(Math.min(jMax / 250.0f, 1.0f), BitmapDescriptorFactory.HUE_RED);
            if (fMax <= BitmapDescriptorFactory.HUE_RED) {
                ValueAnimator valueAnimator2 = this.fadeAnimator;
                if (valueAnimator2 != null) {
                    valueAnimator2.cancel();
                    this.fadeAnimator = null;
                }
                setAlpha(BitmapDescriptorFactory.HUE_RED);
                return;
            }
            if (!PhotoViewer.this.videoPlayer.isPlaying()) {
                ValueAnimator valueAnimator3 = this.fadeAnimator;
                if (valueAnimator3 != null) {
                    valueAnimator3.cancel();
                    this.fadeAnimator = null;
                }
            } else {
                if (this.fadeAnimator != null) {
                    return;
                }
                ValueAnimator valueAnimatorOfFloat = ValueAnimator.ofFloat(fMax, 1.0f);
                this.fadeAnimator = valueAnimatorOfFloat;
                valueAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$FirstFrameView$$ExternalSyntheticLambda0
                    @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                    public final void onAnimationUpdate(ValueAnimator valueAnimator4) {
                        this.f$0.lambda$updateAlpha$3(valueAnimator4);
                    }
                });
                this.fadeAnimator.setDuration(jMax);
                this.fadeAnimator.setInterpolator(this.fadeInterpolator);
                this.fadeAnimator.start();
            }
            setAlpha(fMax);
        }

        public void checkFromPlayer(VideoPlayer videoPlayer) {
            if (this.currentVideoPlayer != videoPlayer) {
                this.gotError = false;
                clear();
            }
            if (videoPlayer != null && !videoPlayer.isHDR()) {
                long duration = videoPlayer.getDuration() - videoPlayer.getCurrentPosition();
                if (!this.hasFrame && !this.gotError && !this.gettingFrame && duration < 5250.0f) {
                    final Uri currentUri = videoPlayer.getCurrentUri();
                    final int i = this.gettingFrameIndex + 1;
                    this.gettingFrameIndex = i;
                    Utilities.globalQueue.postRunnable(new Runnable() { // from class: org.telegram.ui.PhotoViewer$FirstFrameView$$ExternalSyntheticLambda1
                        @Override // java.lang.Runnable
                        public final void run() {
                            this.f$0.lambda$checkFromPlayer$2(currentUri, i);
                        }
                    });
                    this.gettingFrame = true;
                }
            }
            this.currentVideoPlayer = videoPlayer;
        }

        public void clear() {
            this.hasFrame = false;
            this.gotError = false;
            if (this.gettingFrame) {
                this.gettingFrameIndex++;
                this.gettingFrame = false;
            }
            setImageResource(android.R.color.transparent);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    class FrameLayoutDrawer extends SizeNotifierFrameLayoutPhoto {
        private boolean captionAbove;
        private ArrayList exclusionRects;
        private boolean ignoreLayout;
        private Paint paint;

        public FrameLayoutDrawer(Context context, Activity activity) {
            super(context, activity, false);
            this.paint = new Paint();
            setWillNotDraw(false);
            this.paint.setColor(AndroidUtilities.DARK_STATUS_BAR_OVERLAY);
            setLayerType(2, null);
        }

        @Override // android.view.View
        public void draw(Canvas canvas) {
            super.draw(canvas);
            if (PhotoViewer.this.photoViewerWebView == null || !PhotoViewer.this.photoViewerWebView.isControllable()) {
                return;
            }
            int measuredHeight = ((int) (PhotoViewer.this.photoViewerWebView.getWebView().getMeasuredHeight() * (PhotoViewer.this.scale - 1.0f))) / 2;
            if (PhotoViewer.this.videoForwardDrawable != null && PhotoViewer.this.videoForwardDrawable.isAnimating()) {
                PhotoViewer.this.videoForwardDrawable.setBounds(PhotoViewer.this.photoViewerWebView.getLeft(), (PhotoViewer.this.photoViewerWebView.getWebView().getTop() - measuredHeight) + ((int) (PhotoViewer.this.translationY / PhotoViewer.this.scale)), PhotoViewer.this.photoViewerWebView.getRight(), PhotoViewer.this.photoViewerWebView.getWebView().getBottom() + measuredHeight + ((int) (PhotoViewer.this.translationY / PhotoViewer.this.scale)));
                PhotoViewer.this.videoForwardDrawable.draw(canvas);
            }
            if (PhotoViewer.this.seekSpeedDrawable == null || !PhotoViewer.this.seekSpeedDrawable.isShown()) {
                return;
            }
            PhotoViewer.this.seekSpeedDrawable.setBounds(PhotoViewer.this.photoViewerWebView.getLeft(), (int) (AndroidUtilities.statusBarHeight + (AndroidUtilities.dp(90.0f) * PhotoViewer.this.actionBar.getAlpha())), PhotoViewer.this.photoViewerWebView.getRight(), PhotoViewer.this.photoViewerWebView.getWebView().getBottom() + measuredHeight + ((int) (PhotoViewer.this.translationY / PhotoViewer.this.scale)));
            PhotoViewer.this.seekSpeedDrawable.draw(canvas);
        }

        @Override // android.view.ViewGroup
        protected boolean drawChild(Canvas canvas, View view, long j) {
            if (view == PhotoViewer.this.leftPaintingOverlay || view == PhotoViewer.this.rightPaintingOverlay) {
                return false;
            }
            return drawChildInternal(canvas, view, j);
        }

        protected boolean drawChildInternal(Canvas canvas, View view, long j) {
            if (view == PhotoViewer.this.miniProgressView) {
                return false;
            }
            if (view == PhotoViewer.this.videoTimelineViewContainer && PhotoViewer.this.videoTimelineViewContainer.getTranslationY() > BitmapDescriptorFactory.HUE_RED && PhotoViewer.this.pickerView.getTranslationY() == BitmapDescriptorFactory.HUE_RED) {
                canvas.save();
                canvas.clipRect(PhotoViewer.this.videoTimelineViewContainer.getX(), PhotoViewer.this.videoTimelineViewContainer.getY(), PhotoViewer.this.videoTimelineViewContainer.getX() + PhotoViewer.this.videoTimelineViewContainer.getMeasuredWidth(), PhotoViewer.this.videoTimelineViewContainer.getBottom());
                boolean zDrawChild = super.drawChild(canvas, view, j);
                canvas.restore();
                return zDrawChild;
            }
            try {
                if (view == PhotoViewer.this.aspectRatioFrameLayout || view == PhotoViewer.this.paintingOverlay) {
                    return false;
                }
                return super.drawChild(canvas, view, j);
            } catch (Throwable unused) {
                return true;
            }
        }

        @Override // org.telegram.ui.Components.SizeNotifierFrameLayoutPhoto, org.telegram.ui.Components.SizeNotifierFrameLayout
        public void notifyHeightChanged() {
            super.notifyHeightChanged();
            if (PhotoViewer.this.isCurrentVideo) {
                PhotoViewer.this.photoProgressViews[0].setIndexedAlpha(2, getKeyboardHeight() <= AndroidUtilities.dp(20.0f) ? 1.0f : BitmapDescriptorFactory.HUE_RED, true);
            }
        }

        @Override // org.telegram.ui.Components.SizeNotifierFrameLayout, android.view.ViewGroup, android.view.View
        protected void onAttachedToWindow() {
            super.onAttachedToWindow();
            Bulletin.addDelegate(this, new Bulletin.Delegate() { // from class: org.telegram.ui.PhotoViewer.FrameLayoutDrawer.1
                @Override // org.telegram.ui.Components.Bulletin.Delegate
                public /* synthetic */ boolean allowLayoutChanges() {
                    return Bulletin.Delegate.CC.$default$allowLayoutChanges(this);
                }

                @Override // org.telegram.ui.Components.Bulletin.Delegate
                public /* synthetic */ boolean bottomOffsetAnimated() {
                    return Bulletin.Delegate.CC.$default$bottomOffsetAnimated(this);
                }

                @Override // org.telegram.ui.Components.Bulletin.Delegate
                public /* synthetic */ boolean clipWithGradient(int i) {
                    return Bulletin.Delegate.CC.$default$clipWithGradient(this, i);
                }

                @Override // org.telegram.ui.Components.Bulletin.Delegate
                public int getBottomOffset(int i) {
                    int height = 0;
                    if (!PhotoViewer.this.editing) {
                        if (PhotoViewer.this.bottomLayout != null && PhotoViewer.this.bottomLayout.getVisibility() == 0) {
                            height = (int) (0 + (PhotoViewer.this.bottomLayout.getHeight() * PhotoViewer.this.bottomLayout.getAlpha()));
                        }
                        return (PhotoViewer.this.groupedPhotosListView == null || !PhotoViewer.this.groupedPhotosListView.hasPhotos()) ? height : (AndroidUtilities.isTablet() || PhotoViewer.this.containerView.getMeasuredHeight() > PhotoViewer.this.containerView.getMeasuredWidth()) ? (int) (height + (PhotoViewer.this.groupedPhotosListView.getHeight() * PhotoViewer.this.groupedPhotosListView.getAlpha())) : height;
                    }
                    if (PhotoViewer.this.captionEdit != null) {
                        height = PhotoViewer.this.captionEdit.keyboardNotifier.getKeyboardHeight();
                        if (PhotoViewer.this.captionEdit.getVisibility() == 0 && (PhotoViewer.this.placeProvider == null || !PhotoViewer.this.placeProvider.isCaptionAbove())) {
                            height += PhotoViewer.this.captionEdit.getEditTextHeight() + AndroidUtilities.dp(12.0f);
                        }
                    }
                    return (PhotoViewer.this.pickerView == null || PhotoViewer.this.pickerView.getVisibility() != 0) ? height : (PhotoViewer.this.captionEdit == null || !PhotoViewer.this.captionEdit.keyboardNotifier.keyboardVisible()) ? height + PhotoViewer.this.pickerView.getHeight() : height;
                }

                @Override // org.telegram.ui.Components.Bulletin.Delegate
                public int getTopOffset(int i) {
                    return (FrameLayoutDrawer.this.isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0) + ActionBar.getCurrentActionBarHeight() + ((int) (PhotoViewer.this.topCaptionEdit.getAlpha() * PhotoViewer.this.topCaptionEdit.getEditTextHeight()));
                }

                @Override // org.telegram.ui.Components.Bulletin.Delegate
                public /* synthetic */ void onBottomOffsetChange(float f) {
                    Bulletin.Delegate.CC.$default$onBottomOffsetChange(this, f);
                }

                @Override // org.telegram.ui.Components.Bulletin.Delegate
                public /* synthetic */ void onHide(Bulletin bulletin) {
                    Bulletin.Delegate.CC.$default$onHide(this, bulletin);
                }

                @Override // org.telegram.ui.Components.Bulletin.Delegate
                public /* synthetic */ void onShow(Bulletin bulletin) {
                    Bulletin.Delegate.CC.$default$onShow(this, bulletin);
                }
            });
        }

        @Override // org.telegram.ui.Components.SizeNotifierFrameLayout, android.view.ViewGroup, android.view.View
        protected void onDetachedFromWindow() {
            super.onDetachedFromWindow();
            Bulletin.removeDelegate(this);
        }

        @Override // android.view.View
        protected void onDraw(Canvas canvas) {
            PhotoViewer.this.onDraw(canvas);
            if (!isStatusBarVisible() || AndroidUtilities.statusBarHeight == 0 || PhotoViewer.this.actionBar == null) {
                return;
            }
            if (Build.VERSION.SDK_INT < 21) {
                this.paint.setAlpha((int) (PhotoViewer.this.actionBar.getAlpha() * 255.0f * 0.2f));
                canvas.drawRect(BitmapDescriptorFactory.HUE_RED, PhotoViewer.this.currentPanTranslationY, getMeasuredWidth(), PhotoViewer.this.currentPanTranslationY + AndroidUtilities.statusBarHeight, this.paint);
            }
            this.paint.setAlpha((int) (PhotoViewer.this.actionBar.getAlpha() * 255.0f * 0.498f));
            if (getPaddingRight() > 0) {
                canvas.drawRect(getMeasuredWidth() - getPaddingRight(), BitmapDescriptorFactory.HUE_RED, getMeasuredWidth(), getMeasuredHeight(), this.paint);
            }
            if (getPaddingLeft() > 0) {
                canvas.drawRect(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, getPaddingLeft(), getMeasuredHeight(), this.paint);
            }
            if (getPaddingBottom() > 0) {
                float fDpf2 = AndroidUtilities.dpf2(24.0f) * (1.0f - PhotoViewer.this.actionBar.getAlpha());
                canvas.drawRect(BitmapDescriptorFactory.HUE_RED, (getMeasuredHeight() - getPaddingBottom()) + fDpf2, getMeasuredWidth(), getMeasuredHeight() + fDpf2, this.paint);
            }
        }

        /* JADX WARN: Removed duplicated region for block: B:23:0x0075  */
        /* JADX WARN: Removed duplicated region for block: B:28:0x0083  */
        /* JADX WARN: Removed duplicated region for block: B:32:0x0098  */
        @Override // org.telegram.ui.Components.SizeNotifierFrameLayoutPhoto, org.telegram.ui.Components.SizeNotifierFrameLayout, android.widget.FrameLayout, android.view.ViewGroup, android.view.View
        /*
            Code decompiled incorrectly, please refer to instructions dump.
        */
        protected void onLayout(boolean z, int i, int i2, int i3, int i4) {
            int paddingLeft;
            int paddingRight;
            int paddingBottom;
            int i5;
            int i6;
            int i7;
            int measuredHeight;
            int iDp;
            int measuredHeight2;
            int height;
            float f;
            int childCount = getChildCount();
            PhotoViewer.this.keyboardSize = measureKeyboardHeight();
            for (int i8 = 0; i8 < childCount; i8++) {
                View childAt = getChildAt(i8);
                if (childAt.getVisibility() != 8) {
                    if (childAt == PhotoViewer.this.aspectRatioFrameLayout) {
                        paddingLeft = i;
                        paddingRight = i3;
                        paddingBottom = i4;
                    } else {
                        paddingLeft = i + getPaddingLeft();
                        paddingRight = i3 - getPaddingRight();
                        paddingBottom = i4 - getPaddingBottom();
                    }
                    FrameLayout.LayoutParams layoutParams = (FrameLayout.LayoutParams) childAt.getLayoutParams();
                    int measuredWidth = childAt.getMeasuredWidth();
                    int measuredHeight3 = childAt.getMeasuredHeight();
                    int i9 = layoutParams.gravity;
                    if (i9 == -1) {
                        i9 = 51;
                    }
                    int i10 = i9 & 7;
                    int i11 = i9 & R.styleable.AppCompatTheme_toolbarNavigationButtonStyle;
                    if (i10 == 1) {
                        i5 = (((paddingRight - paddingLeft) - measuredWidth) / 2) + layoutParams.leftMargin;
                    } else if (i10 != 5) {
                        i6 = layoutParams.leftMargin;
                        if (i11 != 16) {
                            i7 = (((paddingBottom - i2) - measuredHeight3) / 2) + layoutParams.topMargin;
                        } else if (i11 != 80) {
                            measuredHeight = layoutParams.topMargin;
                            if (childAt != PhotoViewer.this.captionEdit.mentionContainer) {
                                if (childAt == PhotoViewer.this.topCaptionEdit.mentionContainer) {
                                    measuredHeight += PhotoViewer.this.actionBar.getMeasuredHeight();
                                } else if (PhotoViewer.this.captionEdit.editText.isPopupView(childAt) || PhotoViewer.this.topCaptionEdit.editText.isPopupView(childAt)) {
                                    measuredHeight = ((i4 - i2) - measuredHeight3) + ((PhotoViewer.this.inBubbleMode || AndroidUtilities.isInMultiwindow) ? 0 : AndroidUtilities.navigationBarHeight);
                                } else if (childAt == PhotoViewer.this.selectedPhotosListView) {
                                    measuredHeight = PhotoViewer.this.actionBar.getMeasuredHeight() + AndroidUtilities.dp(5.0f);
                                } else {
                                    float f2 = 40.0f;
                                    if (childAt == PhotoViewer.this.muteButton || childAt == PhotoViewer.this.editCoverButton) {
                                        int top = ((PhotoViewer.this.videoTimelineViewContainer == null || PhotoViewer.this.videoTimelineViewContainer.getVisibility() != 0) ? PhotoViewer.this.pickerView : PhotoViewer.this.videoTimelineViewContainer).getTop();
                                        if (PhotoViewer.this.sendPhotoType != 4 && PhotoViewer.this.sendPhotoType != 5) {
                                            f2 = 15.0f;
                                        }
                                        iDp = (top - AndroidUtilities.dp(f2)) + AndroidUtilities.dp(12.0f);
                                    } else if (PhotoViewer.this.muteHints != null && PhotoViewer.this.muteHints.contains(childAt)) {
                                        int top2 = ((PhotoViewer.this.videoTimelineViewContainer == null || PhotoViewer.this.videoTimelineViewContainer.getVisibility() != 0) ? PhotoViewer.this.pickerView : PhotoViewer.this.videoTimelineViewContainer).getTop();
                                        if (PhotoViewer.this.sendPhotoType != 4 && PhotoViewer.this.sendPhotoType != 5) {
                                            f2 = 15.0f;
                                        }
                                        iDp = ((top2 - AndroidUtilities.dp(f2)) + AndroidUtilities.dp(12.0f)) - AndroidUtilities.dp(36.0f);
                                    } else if (childAt == PhotoViewer.this.videoTimelineViewContainer) {
                                        measuredHeight -= PhotoViewer.this.pickerView.getHeight();
                                        if (PhotoViewer.this.sendPhotoType != 1) {
                                            f = PhotoViewer.this.captionEdit.getVisibility() == 0 ? 56.0f : 52.0f;
                                        }
                                        height = AndroidUtilities.dp(f);
                                        measuredHeight -= height;
                                    } else {
                                        if (childAt != PhotoViewer.this.captionEditContainer) {
                                            if (childAt == PhotoViewer.this.topCaptionEditContainer || childAt == PhotoViewer.this.topBulletinUnderCaption) {
                                                measuredHeight = PhotoViewer.this.actionBar.getMeasuredHeight();
                                            } else if (childAt != PhotoViewer.this.bottomBulletinUnderCaption) {
                                                if (childAt == PhotoViewer.this.videoAvatarTooltip) {
                                                    height = PhotoViewer.this.pickerView.getHeight() + AndroidUtilities.dp(31.0f);
                                                    measuredHeight -= height;
                                                }
                                            }
                                        }
                                        iDp = ((paddingBottom - i2) - measuredHeight3) - layoutParams.bottomMargin;
                                        measuredHeight2 = PhotoViewer.this.pickerView.getHeight();
                                        measuredHeight = iDp - measuredHeight2;
                                    }
                                    measuredHeight2 = childAt.getMeasuredHeight();
                                    measuredHeight = iDp - measuredHeight2;
                                }
                            }
                            childAt.layout(i6 + paddingLeft, measuredHeight, i6 + measuredWidth + paddingLeft, measuredHeight3 + measuredHeight);
                        } else {
                            i7 = (paddingBottom - i2) - measuredHeight3;
                        }
                        measuredHeight = i7 - layoutParams.bottomMargin;
                        if (childAt != PhotoViewer.this.captionEdit.mentionContainer) {
                        }
                        childAt.layout(i6 + paddingLeft, measuredHeight, i6 + measuredWidth + paddingLeft, measuredHeight3 + measuredHeight);
                    } else {
                        i5 = (paddingRight - paddingLeft) - measuredWidth;
                    }
                    i6 = i5 - layoutParams.rightMargin;
                    if (i11 != 16) {
                    }
                    measuredHeight = i7 - layoutParams.bottomMargin;
                    if (childAt != PhotoViewer.this.captionEdit.mentionContainer) {
                    }
                    childAt.layout(i6 + paddingLeft, measuredHeight, i6 + measuredWidth + paddingLeft, measuredHeight3 + measuredHeight);
                }
            }
            notifyHeightChanged();
            updateExclusionRects();
        }

        /* JADX WARN: Removed duplicated region for block: B:106:0x028e A[PHI: r17
          0x028e: PHI (r17v4 int) = (r17v3 int), (r17v8 int) binds: [B:105:0x028c, B:101:0x0274] A[DONT_GENERATE, DONT_INLINE]] */
        /* JADX WARN: Removed duplicated region for block: B:107:0x0291 A[PHI: r17
          0x0291: PHI (r17v6 int) = (r17v3 int), (r17v8 int) binds: [B:105:0x028c, B:101:0x0274] A[DONT_GENERATE, DONT_INLINE]] */
        /* JADX WARN: Removed duplicated region for block: B:90:0x022a  */
        /* JADX WARN: Removed duplicated region for block: B:91:0x022d  */
        @Override // android.widget.FrameLayout, android.view.View
        /*
            Code decompiled incorrectly, please refer to instructions dump.
        */
        protected void onMeasure(int i, int i2) {
            int i3;
            int i4;
            int iMakeMeasureSpec;
            int iMin;
            int iMakeMeasureSpec2;
            int i5;
            int i6;
            int bitmapWidth;
            int bitmapHeight;
            int size = View.MeasureSpec.getSize(i);
            int size2 = View.MeasureSpec.getSize(i2);
            if (getLayoutParams().height > 0) {
                size2 = getLayoutParams().height;
            }
            int i7 = size2;
            setMeasuredDimension(size, i7);
            if (!PhotoViewer.this.isCurrentVideo) {
                this.ignoreLayout = true;
                if (PhotoViewer.this.needCaptionLayout) {
                    Point point = AndroidUtilities.displaySize;
                    int i8 = point.x > point.y ? 5 : 10;
                    PhotoViewer.this.captionTextViewSwitcher.getCurrentView().setMaxLines(i8);
                    PhotoViewer.this.captionTextViewSwitcher.getNextView().setMaxLines(i8);
                } else {
                    PhotoViewer.this.captionTextViewSwitcher.getCurrentView().setMaxLines(Integer.MAX_VALUE);
                    PhotoViewer.this.captionTextViewSwitcher.getNextView().setMaxLines(Integer.MAX_VALUE);
                }
                this.ignoreLayout = false;
            }
            int iDp = PhotoViewer.this.bottomLayout.getVisibility() != 8 ? AndroidUtilities.dp(48.0f) : 0;
            if (PhotoViewer.this.groupedPhotosListView == null || PhotoViewer.this.groupedPhotosListView.getVisibility() == 8) {
                i3 = 0;
            } else {
                ((ViewGroup.MarginLayoutParams) PhotoViewer.this.groupedPhotosListView.getLayoutParams()).bottomMargin = iDp;
                measureChildWithMargins(PhotoViewer.this.groupedPhotosListView, i, 0, i2, 0);
                int measuredHeight = PhotoViewer.this.groupedPhotosListView.getMeasuredHeight();
                this.ignoreLayout = true;
                if (AndroidUtilities.isTablet() || i7 >= size) {
                    if (PhotoViewer.this.groupedPhotosListView.getVisibility() != 0) {
                        PhotoViewer.this.groupedPhotosListView.setVisibility(0);
                    }
                } else if (PhotoViewer.this.groupedPhotosListView.getVisibility() != 4) {
                    PhotoViewer.this.groupedPhotosListView.setVisibility(4);
                }
                this.ignoreLayout = false;
                i3 = measuredHeight;
            }
            if (PhotoViewer.this.videoPlayerControlFrameLayout != null) {
                PhotoViewer.this.videoPlayerControlFrameLayout.parentWidth = size;
                PhotoViewer.this.videoPlayerControlFrameLayout.parentHeight = i7;
            }
            int paddingRight = size - (getPaddingRight() + getPaddingLeft());
            int paddingBottom = i7 - getPaddingBottom();
            int childCount = getChildCount();
            for (int i9 = 0; i9 < childCount; i9 = i4 + 1) {
                View childAt = getChildAt(i9);
                if (childAt.getVisibility() == 8 || childAt == PhotoViewer.this.groupedPhotosListView) {
                    i4 = i9;
                } else {
                    if (childAt == PhotoViewer.this.aspectRatioFrameLayout) {
                        childAt.measure(i, View.MeasureSpec.makeMeasureSpec(AndroidUtilities.displaySize.y + (isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0), 1073741824));
                    } else if (childAt == PhotoViewer.this.paintingOverlay) {
                        if (PhotoViewer.this.aspectRatioFrameLayout == null || PhotoViewer.this.aspectRatioFrameLayout.getVisibility() != 0) {
                            bitmapWidth = PhotoViewer.this.centerImage.getBitmapWidth();
                            bitmapHeight = PhotoViewer.this.centerImage.getBitmapHeight();
                        } else {
                            View view = PhotoViewer.this.usedSurfaceView ? PhotoViewer.this.videoSurfaceView : PhotoViewer.this.videoTextureView;
                            bitmapWidth = view.getMeasuredWidth();
                            bitmapHeight = view.getMeasuredHeight();
                        }
                        if (bitmapWidth == 0 || bitmapHeight == 0) {
                            bitmapWidth = paddingRight;
                            bitmapHeight = paddingBottom;
                        }
                        PhotoViewer.this.paintingOverlay.measure(View.MeasureSpec.makeMeasureSpec(bitmapWidth, 1073741824), View.MeasureSpec.makeMeasureSpec(bitmapHeight, 1073741824));
                    } else if (PhotoViewer.this.captionEdit.editText.isPopupView(childAt) || PhotoViewer.this.topCaptionEdit.editText.isPopupView(childAt)) {
                        i4 = i9;
                        if (PhotoViewer.this.inBubbleMode) {
                            iMakeMeasureSpec = View.MeasureSpec.makeMeasureSpec(paddingRight, 1073741824);
                            iMakeMeasureSpec2 = View.MeasureSpec.makeMeasureSpec(paddingBottom, 1073741824);
                        } else {
                            if (!AndroidUtilities.isInMultiwindow) {
                                iMakeMeasureSpec = View.MeasureSpec.makeMeasureSpec(paddingRight, 1073741824);
                                iMin = childAt.getLayoutParams().height + AndroidUtilities.navigationBarHeight;
                            } else if (AndroidUtilities.isTablet()) {
                                iMakeMeasureSpec = View.MeasureSpec.makeMeasureSpec(paddingRight, 1073741824);
                                iMin = Math.min(AndroidUtilities.dp(320.0f), paddingBottom - AndroidUtilities.statusBarHeight);
                            } else {
                                iMakeMeasureSpec = View.MeasureSpec.makeMeasureSpec(paddingRight, 1073741824);
                                iMin = paddingBottom - AndroidUtilities.statusBarHeight;
                            }
                            iMakeMeasureSpec2 = View.MeasureSpec.makeMeasureSpec(iMin, 1073741824);
                        }
                        childAt.measure(iMakeMeasureSpec, iMakeMeasureSpec2);
                    } else if (childAt != PhotoViewer.this.captionScrollView) {
                        if (childAt == PhotoViewer.this.topCaptionEditContainer || childAt == PhotoViewer.this.topBulletinUnderCaption) {
                            i4 = i9;
                            i5 = isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0;
                        } else if (childAt == PhotoViewer.this.topCaptionEdit.mentionContainer) {
                            i4 = i9;
                            if (isStatusBarVisible()) {
                            }
                        } else {
                            i4 = i9;
                            measureChildWithMargins(childAt, i, 0, i2, 0);
                        }
                        childAt.measure(i, View.MeasureSpec.makeMeasureSpec(paddingBottom - (i5 + ActionBar.getCurrentActionBarHeight()), 1073741824));
                    } else if (PhotoViewer.this.dontChangeCaptionPosition) {
                        i6 = this.captionAbove ? iDp + i3 : iDp;
                        int currentActionBarHeight = (paddingBottom - ((isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0) + ActionBar.getCurrentActionBarHeight())) - i6;
                        ((ViewGroup.MarginLayoutParams) PhotoViewer.this.captionScrollView.getLayoutParams()).bottomMargin = i6;
                        childAt.measure(View.MeasureSpec.makeMeasureSpec(paddingRight, 1073741824), View.MeasureSpec.makeMeasureSpec(currentActionBarHeight, 1073741824));
                    } else if (!PhotoViewer.this.groupedPhotosListView.hasPhotos() || (!AndroidUtilities.isTablet() && paddingBottom <= paddingRight)) {
                        this.captionAbove = false;
                        int currentActionBarHeight2 = (paddingBottom - ((isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0) + ActionBar.getCurrentActionBarHeight())) - i6;
                        ((ViewGroup.MarginLayoutParams) PhotoViewer.this.captionScrollView.getLayoutParams()).bottomMargin = i6;
                        childAt.measure(View.MeasureSpec.makeMeasureSpec(paddingRight, 1073741824), View.MeasureSpec.makeMeasureSpec(currentActionBarHeight2, 1073741824));
                    } else {
                        i6 = iDp + i3;
                        this.captionAbove = true;
                        int currentActionBarHeight22 = (paddingBottom - ((isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0) + ActionBar.getCurrentActionBarHeight())) - i6;
                        ((ViewGroup.MarginLayoutParams) PhotoViewer.this.captionScrollView.getLayoutParams()).bottomMargin = i6;
                        childAt.measure(View.MeasureSpec.makeMeasureSpec(paddingRight, 1073741824), View.MeasureSpec.makeMeasureSpec(currentActionBarHeight22, 1073741824));
                    }
                    i4 = i9;
                }
            }
        }

        @Override // android.view.View, android.view.ViewParent
        public void requestLayout() {
            if (this.ignoreLayout) {
                return;
            }
            super.requestLayout();
        }

        public void updateExclusionRects() {
            if (Build.VERSION.SDK_INT >= 29) {
                if (this.exclusionRects == null) {
                    this.exclusionRects = new ArrayList();
                }
                this.exclusionRects.clear();
                if (PhotoViewer.this.currentEditMode == 1 || PhotoViewer.this.switchingToMode == 1) {
                    int measuredHeight = getMeasuredHeight();
                    int measuredWidth = getMeasuredWidth();
                    this.exclusionRects.add(new Rect(0, (measuredHeight - AndroidUtilities.dp(200.0f)) / 2, AndroidUtilities.dp(100.0f), (AndroidUtilities.dp(200.0f) + measuredHeight) / 2));
                    this.exclusionRects.add(new Rect(measuredWidth - AndroidUtilities.dp(100.0f), (measuredHeight - AndroidUtilities.dp(200.0f)) / 2, measuredWidth, (measuredHeight + AndroidUtilities.dp(200.0f)) / 2));
                }
                setSystemGestureExclusionRects(this.exclusionRects);
                invalidate();
            }
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    class ListAdapter extends RecyclerListView.SelectionAdapter {
        private Context mContext;

        public ListAdapter(Context context) {
            this.mContext = context;
        }

        /* JADX INFO: Access modifiers changed from: private */
        /* JADX WARN: Removed duplicated region for block: B:15:0x0068  */
        /*
            Code decompiled incorrectly, please refer to instructions dump.
        */
        public /* synthetic */ void lambda$onCreateViewHolder$0(View view) {
            Object tag = ((View) view.getParent()).getTag();
            int iIndexOf = PhotoViewer.this.imagesArrLocals.indexOf(tag);
            if (iIndexOf >= 0) {
                int photoChecked = PhotoViewer.this.placeProvider.setPhotoChecked(iIndexOf, PhotoViewer.this.getCurrentVideoEditedInfo());
                boolean zIsPhotoChecked = PhotoViewer.this.placeProvider.isPhotoChecked(iIndexOf);
                if (iIndexOf == PhotoViewer.this.currentIndex) {
                    PhotoViewer.this.checkImageView.setChecked(-1, zIsPhotoChecked, true);
                }
                if (photoChecked >= 0) {
                    PhotoViewer.this.selectedPhotosAdapter.notifyItemRemoved(photoChecked);
                    if (photoChecked == 0) {
                        PhotoViewer.this.selectedPhotosAdapter.notifyItemChanged(0);
                    }
                }
            } else {
                int photoUnchecked = PhotoViewer.this.placeProvider.setPhotoUnchecked(tag);
                if (photoUnchecked < 0) {
                    return;
                }
                PhotoViewer.this.selectedPhotosAdapter.notifyItemRemoved(photoUnchecked);
                if (photoUnchecked == 0) {
                }
            }
            PhotoViewer.this.updateSelectedCount();
        }

        @Override // androidx.recyclerview.widget.RecyclerView.Adapter
        public int getItemCount() {
            if (PhotoViewer.this.placeProvider == null || PhotoViewer.this.placeProvider.getSelectedPhotosOrder() == null) {
                return 0;
            }
            return PhotoViewer.this.placeProvider.getSelectedPhotosOrder().size();
        }

        @Override // androidx.recyclerview.widget.RecyclerView.Adapter
        public int getItemViewType(int i) {
            return 0;
        }

        @Override // org.telegram.ui.Components.RecyclerListView.SelectionAdapter
        public boolean isEnabled(RecyclerView.ViewHolder viewHolder) {
            return false;
        }

        @Override // androidx.recyclerview.widget.RecyclerView.Adapter
        public void onBindViewHolder(RecyclerView.ViewHolder viewHolder, int i) {
            StringBuilder sb;
            String str;
            PhotoPickerPhotoCell photoPickerPhotoCell = (PhotoPickerPhotoCell) viewHolder.itemView;
            photoPickerPhotoCell.setItemWidth(AndroidUtilities.dp(85.0f), i != 0 ? AndroidUtilities.dp(6.0f) : 0);
            BackupImageView backupImageView = photoPickerPhotoCell.imageView;
            backupImageView.setOrientation(0, true);
            Object obj = PhotoViewer.this.placeProvider.getSelectedPhotos().get(PhotoViewer.this.placeProvider.getSelectedPhotosOrder().get(i));
            if (obj instanceof MediaController.PhotoEntry) {
                MediaController.PhotoEntry photoEntry = (MediaController.PhotoEntry) obj;
                photoPickerPhotoCell.setTag(photoEntry);
                photoPickerPhotoCell.videoInfoContainer.setVisibility(4);
                String str2 = photoEntry.thumbPath;
                if (str2 != null) {
                    backupImageView.setImage(str2, null, this.mContext.getResources().getDrawable(R.drawable.nophotos));
                } else if (photoEntry.path != null) {
                    backupImageView.setOrientation(photoEntry.orientation, photoEntry.invert, true);
                    if (photoEntry.isVideo) {
                        photoPickerPhotoCell.videoInfoContainer.setVisibility(0);
                        photoPickerPhotoCell.videoTextView.setText(AndroidUtilities.formatShortDuration(photoEntry.duration));
                        sb = new StringBuilder();
                        str = "vthumb://";
                    } else {
                        sb = new StringBuilder();
                        str = "thumb://";
                    }
                    sb.append(str);
                    sb.append(photoEntry.imageId);
                    sb.append(":");
                    sb.append(photoEntry.path);
                    backupImageView.setImage(sb.toString(), null, this.mContext.getResources().getDrawable(R.drawable.nophotos));
                } else {
                    backupImageView.setImageResource(R.drawable.nophotos);
                }
            } else {
                if (!(obj instanceof MediaController.SearchImage)) {
                    return;
                }
                MediaController.SearchImage searchImage = (MediaController.SearchImage) obj;
                photoPickerPhotoCell.setTag(searchImage);
                photoPickerPhotoCell.setImage(searchImage);
                photoPickerPhotoCell.videoInfoContainer.setVisibility(4);
            }
            photoPickerPhotoCell.setChecked(-1, true, false);
            photoPickerPhotoCell.checkBox.setVisibility(0);
        }

        @Override // androidx.recyclerview.widget.RecyclerView.Adapter
        public RecyclerView.ViewHolder onCreateViewHolder(ViewGroup viewGroup, int i) {
            PhotoPickerPhotoCell photoPickerPhotoCell = new PhotoPickerPhotoCell(this.mContext);
            photoPickerPhotoCell.checkFrame.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$ListAdapter$$ExternalSyntheticLambda0
                @Override // android.view.View.OnClickListener
                public final void onClick(View view) {
                    this.f$0.lambda$onCreateViewHolder$0(view);
                }
            });
            return new RecyclerListView.Holder(photoPickerPhotoCell);
        }
    }

    public interface PageBlocksAdapter {
        TLRPC.PageBlock get(int i);

        List getAll();

        CharSequence getCaption(int i);

        File getFile(int i);

        TLRPC.PhotoSize getFileLocation(TLObject tLObject, int[] iArr);

        String getFileName(int i);

        int getItemsCount();

        TLObject getMedia(int i);

        Object getParentObject();

        boolean isHardwarePlayer(int i);

        boolean isVideo(int i);

        void updateSlideshowCell(TLRPC.PageBlock pageBlock);
    }

    private static class PhotoCountView extends View {
        Paint backgroundPaint;
        StaticLayout center;
        float centerTop;
        float centerWidth;
        AnimatedTextView.AnimatedTextDrawable left;
        private String lng;
        private int marginTop;
        private boolean nextNotAnimate;
        TextPaint paint;
        AnimatedTextView.AnimatedTextDrawable right;
        private AnimatedFloat showT;
        private boolean shown;

        public PhotoCountView(Context context) {
            super(context);
            this.backgroundPaint = new Paint(1);
            this.paint = new TextPaint(1);
            this.shown = false;
            CubicBezierInterpolator cubicBezierInterpolator = CubicBezierInterpolator.EASE_OUT_QUINT;
            this.showT = new AnimatedFloat(this, 0L, 350L, cubicBezierInterpolator);
            this.backgroundPaint.setColor(2130706432);
            AnimatedTextView.AnimatedTextDrawable animatedTextDrawable = new AnimatedTextView.AnimatedTextDrawable(false, true, true);
            this.left = animatedTextDrawable;
            animatedTextDrawable.setAnimationProperties(0.3f, 0L, 320L, cubicBezierInterpolator);
            this.left.setTextColor(-1);
            this.left.setTextSize(AndroidUtilities.dp(14.0f));
            this.left.setTypeface(AndroidUtilities.bold());
            this.left.setCallback(this);
            this.left.setText("0");
            this.left.setOverrideFullWidth(AndroidUtilities.displaySize.x);
            this.paint.setColor(-1);
            this.paint.setTextSize(AndroidUtilities.dp(14.0f));
            this.paint.setTypeface(AndroidUtilities.bold());
            setCenterText();
            AnimatedTextView.AnimatedTextDrawable animatedTextDrawable2 = new AnimatedTextView.AnimatedTextDrawable(false, true, true);
            this.right = animatedTextDrawable2;
            animatedTextDrawable2.setAnimationProperties(0.3f, 0L, 320L, cubicBezierInterpolator);
            this.right.setTextColor(-1);
            this.right.setTextSize(AndroidUtilities.dp(14.0f));
            this.right.setTypeface(AndroidUtilities.bold());
            this.right.setCallback(this);
            this.right.setText("0");
            this.right.setOverrideFullWidth(AndroidUtilities.displaySize.x);
        }

        private String getOf() {
            this.lng = LocaleController.getInstance().getCurrentLocaleInfo().shortName;
            return LocaleController.getString(R.string.Of).replace("%1$d", "").replace("%2$d", "");
        }

        private void setCenterText() {
            float lineDescent;
            StaticLayout staticLayout = new StaticLayout(getOf(), this.paint, AndroidUtilities.dp(200.0f), Layout.Alignment.ALIGN_CENTER, 1.0f, BitmapDescriptorFactory.HUE_RED, false);
            this.center = staticLayout;
            if (staticLayout.getLineCount() >= 1) {
                this.centerWidth = this.center.getLineWidth(0);
                lineDescent = this.center.getLineDescent(0);
            } else {
                lineDescent = BitmapDescriptorFactory.HUE_RED;
                this.centerWidth = BitmapDescriptorFactory.HUE_RED;
            }
            this.centerTop = lineDescent;
        }

        @Override // android.view.View
        public boolean isShown() {
            return this.shown;
        }

        @Override // android.view.View
        protected void onDraw(Canvas canvas) {
            super.onDraw(canvas);
            float f = this.showT.set(this.shown ? 1.0f : BitmapDescriptorFactory.HUE_RED);
            if (f <= BitmapDescriptorFactory.HUE_RED) {
                return;
            }
            float currentWidth = this.left.getCurrentWidth() + this.centerWidth + this.right.getCurrentWidth() + AndroidUtilities.dp(18.0f);
            float f2 = this.marginTop + ((1.0f - f) * (-AndroidUtilities.dp(8.0f)));
            RectF rectF = AndroidUtilities.rectTmp;
            rectF.set((getWidth() - currentWidth) / 2.0f, AndroidUtilities.dpf2(10.0f) + f2, (getWidth() + currentWidth) / 2.0f, AndroidUtilities.dpf2(33.0f) + f2);
            int alpha = this.backgroundPaint.getAlpha();
            this.backgroundPaint.setAlpha((int) (alpha * f));
            canvas.drawRoundRect(rectF, AndroidUtilities.dpf2(12.0f), AndroidUtilities.dpf2(12.0f), this.backgroundPaint);
            this.backgroundPaint.setAlpha(alpha);
            canvas.save();
            canvas.translate(((getWidth() - currentWidth) / 2.0f) + AndroidUtilities.dp(9.0f), f2 + AndroidUtilities.dp(9.5f));
            AnimatedTextView.AnimatedTextDrawable animatedTextDrawable = this.left;
            animatedTextDrawable.setBounds(0, 0, (int) animatedTextDrawable.getCurrentWidth(), AndroidUtilities.dp(23.0f));
            int i = (int) (f * 255.0f);
            this.left.setAlpha(i);
            this.left.draw(canvas);
            canvas.translate(this.left.getCurrentWidth(), BitmapDescriptorFactory.HUE_RED);
            canvas.save();
            canvas.translate((-(this.center.getWidth() - this.centerWidth)) / 2.0f, ((AndroidUtilities.dp(23.0f) - this.center.getHeight()) + (this.centerTop / 2.0f)) / 2.0f);
            this.paint.setAlpha(i);
            this.center.draw(canvas);
            canvas.restore();
            canvas.translate(this.centerWidth, BitmapDescriptorFactory.HUE_RED);
            AnimatedTextView.AnimatedTextDrawable animatedTextDrawable2 = this.right;
            animatedTextDrawable2.setBounds(0, 0, (int) animatedTextDrawable2.getCurrentWidth(), AndroidUtilities.dp(23.0f));
            this.right.setAlpha(i);
            this.right.draw(canvas);
            canvas.restore();
        }

        @Override // android.view.View
        protected void onMeasure(int i, int i2) {
            int size = View.MeasureSpec.getSize(i);
            this.marginTop = ActionBar.getCurrentActionBarHeight() + (Build.VERSION.SDK_INT >= 21 ? AndroidUtilities.statusBarHeight : 0);
            this.left.setOverrideFullWidth(size);
            this.right.setOverrideFullWidth(size);
            super.onMeasure(View.MeasureSpec.makeMeasureSpec(size, 1073741824), View.MeasureSpec.makeMeasureSpec(this.marginTop + AndroidUtilities.dp(43.0f), 1073741824));
        }

        public void set(int i, int i2) {
            set(i, i2, true);
        }

        public void set(int i, int i2, boolean z) {
            boolean z2 = false;
            int iMax = Math.max(0, i);
            int iMax2 = Math.max(iMax, i2);
            if (LocaleController.getInstance().getCurrentLocaleInfo() != null && !TextUtils.equals(this.lng, LocaleController.getInstance().getCurrentLocaleInfo().shortName)) {
                setCenterText();
            }
            this.left.setText(String.format("%d", Integer.valueOf(LocaleController.isRTL ? iMax2 : iMax)), (!z || this.nextNotAnimate || LocaleController.isRTL) ? false : true);
            AnimatedTextView.AnimatedTextDrawable animatedTextDrawable = this.right;
            if (!LocaleController.isRTL) {
                iMax = iMax2;
            }
            String str = String.format("%d", Integer.valueOf(iMax));
            if (z && !this.nextNotAnimate && !LocaleController.isRTL) {
                z2 = true;
            }
            animatedTextDrawable.setText(str, z2);
            this.nextNotAnimate = !z;
        }

        public void updateShow(boolean z, boolean z2) {
            if (this.shown != z) {
                this.shown = z;
                if (!z) {
                    this.nextNotAnimate = true;
                }
                if (!z2) {
                    this.showT.set(z ? 1.0f : BitmapDescriptorFactory.HUE_RED, true);
                }
                invalidate();
            }
        }

        @Override // android.view.View
        protected boolean verifyDrawable(Drawable drawable) {
            return this.left == drawable || this.right == drawable || super.verifyDrawable(drawable);
        }
    }

    private class PhotoProgressView {
        private View parent;
        private final CombinedDrawable playDrawable;
        private final PlayPauseDrawable playPauseDrawable;
        private boolean visible;
        private long lastUpdateTime = 0;
        private float radOffset = BitmapDescriptorFactory.HUE_RED;
        private float currentProgress = BitmapDescriptorFactory.HUE_RED;
        private float animationProgressStart = BitmapDescriptorFactory.HUE_RED;
        private long currentProgressTime = 0;
        private float animatedProgressValue = BitmapDescriptorFactory.HUE_RED;
        private RectF progressRect = new RectF();
        private int backgroundState = -1;
        private int size = AndroidUtilities.dp(64.0f);
        private int previousBackgroundState = -2;
        private float animatedAlphaValue = 1.0f;
        private float[] animAlphas = new float[3];
        private float[] alphas = new float[3];
        private float scale = 1.0f;

        public PhotoProgressView(View view) {
            if (PhotoViewer.decelerateInterpolator == null) {
                DecelerateInterpolator unused = PhotoViewer.decelerateInterpolator = new DecelerateInterpolator(1.5f);
                Paint unused2 = PhotoViewer.progressPaint = new Paint(1);
                PhotoViewer.progressPaint.setStyle(Paint.Style.STROKE);
                PhotoViewer.progressPaint.setStrokeCap(Paint.Cap.ROUND);
                PhotoViewer.progressPaint.setStrokeWidth(AndroidUtilities.dp(3.0f));
                PhotoViewer.progressPaint.setColor(-1);
            }
            this.parent = view;
            resetAlphas();
            PlayPauseDrawable playPauseDrawable = new PlayPauseDrawable(28);
            this.playPauseDrawable = playPauseDrawable;
            playPauseDrawable.setDuration(200);
            this.playDrawable = new CombinedDrawable(ContextCompat.getDrawable(PhotoViewer.this.parentActivity, R.drawable.circle_big).mutate(), playPauseDrawable);
        }

        private float calculateAlpha() {
            float interpolation = 1.0f;
            int i = 0;
            while (true) {
                float[] fArr = this.animAlphas;
                if (i >= fArr.length) {
                    return interpolation;
                }
                interpolation *= i == 2 ? AndroidUtilities.accelerateInterpolator.getInterpolation(fArr[i]) : fArr[i];
                i++;
            }
        }

        private void checkVisibility() {
            boolean z = false;
            int i = 0;
            while (true) {
                float[] fArr = this.alphas;
                if (i >= fArr.length) {
                    z = true;
                    break;
                } else if (fArr[i] != 1.0f) {
                    break;
                } else {
                    i++;
                }
            }
            if (z != this.visible) {
                this.visible = z;
                onVisibilityChanged(z);
            }
        }

        private void updateAnimation(boolean z) {
            boolean z2;
            long jCurrentTimeMillis = System.currentTimeMillis();
            long j = jCurrentTimeMillis - this.lastUpdateTime;
            if (j > 18) {
                j = 18;
            }
            this.lastUpdateTime = jCurrentTimeMillis;
            int i = 0;
            if (z) {
                if (this.animatedProgressValue == 1.0f && this.currentProgress == 1.0f) {
                    z2 = false;
                } else {
                    this.radOffset += (360 * j) / 3000.0f;
                    float f = this.currentProgress - this.animationProgressStart;
                    if (Math.abs(f) > BitmapDescriptorFactory.HUE_RED) {
                        long j2 = this.currentProgressTime + j;
                        this.currentProgressTime = j2;
                        if (j2 >= 300) {
                            float f2 = this.currentProgress;
                            this.animatedProgressValue = f2;
                            this.animationProgressStart = f2;
                            this.currentProgressTime = 0L;
                        } else {
                            this.animatedProgressValue = this.animationProgressStart + (f * PhotoViewer.decelerateInterpolator.getInterpolation(this.currentProgressTime / 300.0f));
                        }
                    }
                    z2 = true;
                }
                float f3 = this.animatedAlphaValue;
                if (f3 > BitmapDescriptorFactory.HUE_RED && this.previousBackgroundState != -2) {
                    float f4 = f3 - (j / 200.0f);
                    this.animatedAlphaValue = f4;
                    if (f4 <= BitmapDescriptorFactory.HUE_RED) {
                        this.animatedAlphaValue = BitmapDescriptorFactory.HUE_RED;
                        this.previousBackgroundState = -2;
                    }
                    z2 = true;
                }
            } else {
                z2 = false;
            }
            while (true) {
                float[] fArr = this.alphas;
                if (i >= fArr.length) {
                    break;
                }
                float f5 = fArr[i];
                float[] fArr2 = this.animAlphas;
                float f6 = fArr2[i];
                if (f5 > f6) {
                    fArr2[i] = Math.min(1.0f, f6 + (j / 200.0f));
                } else if (f5 < f6) {
                    fArr2[i] = Math.max(BitmapDescriptorFactory.HUE_RED, f6 - (j / 200.0f));
                } else {
                    i++;
                }
                z2 = true;
                i++;
            }
            if (z2) {
                this.parent.postInvalidateOnAnimation();
            }
        }

        public int getX() {
            return (PhotoViewer.this.containerView.getWidth() - ((int) (this.size * this.scale))) / 2;
        }

        public int getY() {
            int i = (int) ((((AndroidUtilities.displaySize.y + (PhotoViewer.this.isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0)) - ((int) (this.size * this.scale))) / 2) + PhotoViewer.this.currentPanTranslationY);
            return PhotoViewer.this.sendPhotoType == 1 ? i - AndroidUtilities.dp(38.0f) : i;
        }

        public boolean isVisible() {
            return this.visible;
        }

        protected abstract void onBackgroundStateUpdated(int i);

        public void onDraw(Canvas canvas) {
            Paint paint;
            int i;
            int i2;
            int i3 = (int) (this.size * this.scale);
            int x = getX();
            int y = getY();
            float fCalculateAlpha = calculateAlpha();
            int i4 = this.previousBackgroundState;
            if (i4 >= 0 && i4 < PhotoViewer.progressDrawables.length + 2) {
                Drawable drawable = this.previousBackgroundState < PhotoViewer.progressDrawables.length ? PhotoViewer.progressDrawables[this.previousBackgroundState] : this.playDrawable;
                if (drawable != null) {
                    drawable.setAlpha((int) (this.animatedAlphaValue * 255.0f * fCalculateAlpha));
                    drawable.setBounds(x, y, x + i3, y + i3);
                    drawable.draw(canvas);
                }
            }
            int i5 = this.backgroundState;
            if (i5 >= 0 && i5 < PhotoViewer.progressDrawables.length + 2) {
                Drawable drawable2 = this.backgroundState < PhotoViewer.progressDrawables.length ? PhotoViewer.progressDrawables[this.backgroundState] : this.playDrawable;
                if (drawable2 != null) {
                    drawable2.setAlpha(this.previousBackgroundState != -2 ? (int) ((1.0f - this.animatedAlphaValue) * 255.0f * fCalculateAlpha) : (int) (fCalculateAlpha * 255.0f));
                    drawable2.setBounds(x, y, x + i3, y + i3);
                    drawable2.draw(canvas);
                }
            }
            int i6 = this.backgroundState;
            if (i6 != 0 && i6 != 1 && (i2 = this.previousBackgroundState) != 0 && i2 != 1) {
                updateAnimation(false);
                return;
            }
            int iDp = AndroidUtilities.dp(4.0f);
            if (this.previousBackgroundState != -2) {
                paint = PhotoViewer.progressPaint;
                i = (int) (this.animatedAlphaValue * 255.0f * fCalculateAlpha);
            } else {
                paint = PhotoViewer.progressPaint;
                i = (int) (fCalculateAlpha * 255.0f);
            }
            paint.setAlpha(i);
            this.progressRect.set(x + iDp, y + iDp, (x + i3) - iDp, (y + i3) - iDp);
            canvas.drawArc(this.progressRect, this.radOffset - 90.0f, Math.max(4.0f, this.animatedProgressValue * 360.0f), false, PhotoViewer.progressPaint);
            updateAnimation(true);
        }

        protected abstract void onVisibilityChanged(boolean z);

        public void resetAlphas() {
            int i = 0;
            while (true) {
                float[] fArr = this.alphas;
                if (i >= fArr.length) {
                    checkVisibility();
                    return;
                } else {
                    this.animAlphas[i] = 1.0f;
                    fArr[i] = 1.0f;
                    i++;
                }
            }
        }

        public void setAlpha(float f) {
            setIndexedAlpha(0, f, false);
        }

        public void setBackgroundState(int i, boolean z, boolean z2) {
            int i2;
            int i3 = this.backgroundState;
            if (i3 == i) {
                return;
            }
            PlayPauseDrawable playPauseDrawable = this.playPauseDrawable;
            if (playPauseDrawable != null) {
                boolean z3 = z2 && (i3 == 3 || i3 == 4);
                if (i == 3) {
                    playPauseDrawable.setPause(false, z3);
                } else if (i == 4) {
                    playPauseDrawable.setPause(true, z3);
                }
                this.playPauseDrawable.setParent(this.parent);
                this.playPauseDrawable.invalidateSelf();
            }
            this.lastUpdateTime = System.currentTimeMillis();
            if (!z || (i2 = this.backgroundState) == i) {
                this.previousBackgroundState = -2;
            } else {
                this.previousBackgroundState = i2;
                this.animatedAlphaValue = 1.0f;
            }
            this.backgroundState = i;
            onBackgroundStateUpdated(i);
            this.parent.invalidate();
        }

        public void setIndexedAlpha(int i, float f, boolean z) {
            float[] fArr = this.alphas;
            if (fArr[i] != f) {
                fArr[i] = f;
                if (!z) {
                    this.animAlphas[i] = f;
                }
                checkVisibility();
                this.parent.invalidate();
            }
        }

        public void setProgress(float f, boolean z) {
            if (z) {
                this.animationProgressStart = this.animatedProgressValue;
            } else {
                this.animatedProgressValue = f;
                this.animationProgressStart = f;
            }
            this.currentProgress = f;
            this.currentProgressTime = 0L;
            this.parent.invalidate();
        }

        public void setScale(float f) {
            this.scale = f;
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    static class PhotoViewerActionBarContainer extends FrameLayout implements NotificationCenter.NotificationCenterDelegate {
        private FrameLayout container;
        private boolean hasSubtitle;
        int lastHeight;
        private float rightPadding;
        private ValueAnimator rightPaddingAnimator;
        private AnimatorSet subtitleAnimator;
        AnimatedTextView subtitleTextView;
        private AnimatorSet titleAnimator;
        private FrameLayout titleLayout;
        SimpleTextView[] titleTextView;

        public PhotoViewerActionBarContainer(Context context) {
            super(context);
            FrameLayout frameLayout = new FrameLayout(context);
            this.container = frameLayout;
            frameLayout.setPadding(AndroidUtilities.dp((AndroidUtilities.isTablet() ? 80 : 72) - 16), 0, 0, 0);
            addView(this.container, LayoutHelper.createFrame(-1, -1, R.styleable.AppCompatTheme_windowActionModeOverlay));
            FrameLayout frameLayout2 = new FrameLayout(context) { // from class: org.telegram.ui.PhotoViewer.PhotoViewerActionBarContainer.1
                @Override // android.widget.FrameLayout, android.view.View
                protected void onMeasure(int i, int i2) {
                    super.onMeasure(i, i2);
                    setPivotY(getMeasuredHeight());
                }
            };
            this.titleLayout = frameLayout2;
            frameLayout2.setPivotX(AndroidUtilities.dp(16.0f));
            this.titleLayout.setPadding(AndroidUtilities.dp(16.0f), 0, 0, 0);
            this.titleLayout.setClipToPadding(false);
            this.container.addView(this.titleLayout, LayoutHelper.createFrame(-1, -1, R.styleable.AppCompatTheme_windowActionModeOverlay));
            this.titleTextView = new SimpleTextView[2];
            for (int i = 0; i < 2; i++) {
                this.titleTextView[i] = new SimpleTextView(context);
                this.titleTextView[i].setGravity(19);
                this.titleTextView[i].setTextColor(-1);
                this.titleTextView[i].setTextSize(20);
                this.titleTextView[i].setTypeface(AndroidUtilities.bold());
                this.titleTextView[i].setDrawablePadding(AndroidUtilities.dp(4.0f));
                this.titleTextView[i].setScrollNonFitText(true);
                this.titleLayout.addView(this.titleTextView[i], LayoutHelper.createFrame(-1, -2, 19));
            }
            AnimatedTextView animatedTextView = new AnimatedTextView(context, true, false, false);
            this.subtitleTextView = animatedTextView;
            animatedTextView.setAnimationProperties(0.4f, 0L, 320L, CubicBezierInterpolator.EASE_OUT_QUINT);
            this.subtitleTextView.setTextSize(AndroidUtilities.dp(14.0f));
            this.subtitleTextView.setGravity(19);
            this.subtitleTextView.setTextColor(-1);
            this.subtitleTextView.setEllipsizeByGradient(true);
            this.container.addView(this.subtitleTextView, LayoutHelper.createFrame(-1, 20.0f, 51, 16.0f, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED));
        }

        private boolean areStringsEqual(CharSequence charSequence, CharSequence charSequence2) {
            if (charSequence == null && charSequence2 == null) {
                return true;
            }
            if ((charSequence == null) != (charSequence2 == null)) {
                return false;
            }
            return TextUtils.equals(charSequence.toString(), charSequence2.toString());
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$updateRightPadding$0(float f, ValueAnimator valueAnimator) {
            this.rightPadding = ((Float) valueAnimator.getAnimatedValue()).floatValue();
            int i = (int) f;
            this.titleTextView[0].setRightPadding(i);
            this.titleTextView[1].setRightPadding(i);
            this.subtitleTextView.setRightPadding(f);
        }

        @Override // org.telegram.messenger.NotificationCenter.NotificationCenterDelegate
        public void didReceivedNotification(int i, int i2, Object... objArr) {
            if (i == NotificationCenter.emojiLoaded) {
                this.titleTextView[0].invalidate();
                this.titleTextView[1].invalidate();
                this.subtitleTextView.invalidate();
            }
        }

        @Override // android.view.ViewGroup, android.view.View
        protected void onAttachedToWindow() {
            super.onAttachedToWindow();
            NotificationCenter.getGlobalInstance().addObserver(this, NotificationCenter.emojiLoaded);
        }

        @Override // android.view.ViewGroup, android.view.View
        protected void onDetachedFromWindow() {
            super.onDetachedFromWindow();
            NotificationCenter.getGlobalInstance().removeObserver(this, NotificationCenter.emojiLoaded);
        }

        @Override // android.widget.FrameLayout, android.view.ViewGroup, android.view.View
        protected void onLayout(boolean z, int i, int i2, int i3, int i4) {
            this.container.layout(0, Build.VERSION.SDK_INT >= 21 ? AndroidUtilities.statusBarHeight : 0, i3 - i, i4 - i2);
        }

        @Override // android.widget.FrameLayout, android.view.View
        protected void onMeasure(int i, int i2) {
            int size = View.MeasureSpec.getSize(i);
            int size2 = View.MeasureSpec.getSize(i2);
            int i3 = Build.VERSION.SDK_INT >= 21 ? AndroidUtilities.statusBarHeight : 0;
            int i4 = this.lastHeight;
            int i5 = AndroidUtilities.displaySize.y;
            if (i4 != i5) {
                this.lastHeight = i5;
                updateOrientation();
            }
            this.container.measure(View.MeasureSpec.makeMeasureSpec(size, 1073741824), View.MeasureSpec.makeMeasureSpec(size2 - i3, 1073741824));
            setMeasuredDimension(size, size2);
        }

        public void setSubtitle(CharSequence charSequence) {
            setSubtitle(charSequence, true);
        }

        public void setSubtitle(CharSequence charSequence, boolean z) {
            boolean z2 = !TextUtils.isEmpty(charSequence);
            if (z2 != this.hasSubtitle) {
                this.hasSubtitle = z2;
                AnimatorSet animatorSet = this.subtitleAnimator;
                if (animatorSet != null) {
                    animatorSet.cancel();
                }
                Point point = AndroidUtilities.displaySize;
                int iDp = AndroidUtilities.dp((z2 ? 30 : 33) - (point.x > point.y ? AndroidUtilities.isTablet() ? -4 : 6 : 0));
                float fDp = BitmapDescriptorFactory.HUE_RED;
                if (z) {
                    ArrayList arrayList = new ArrayList();
                    arrayList.add(ObjectAnimator.ofFloat(this.subtitleTextView, (Property<AnimatedTextView, Float>) View.ALPHA, z2 ? 1.0f : BitmapDescriptorFactory.HUE_RED));
                    AnimatedTextView animatedTextView = this.subtitleTextView;
                    Property property = View.TRANSLATION_Y;
                    arrayList.add(ObjectAnimator.ofFloat(animatedTextView, (Property<AnimatedTextView, Float>) property, iDp));
                    FrameLayout frameLayout = this.titleLayout;
                    if (z2) {
                        fDp = AndroidUtilities.dp(-12.0f);
                    }
                    arrayList.add(ObjectAnimator.ofFloat(frameLayout, (Property<FrameLayout, Float>) property, fDp));
                    arrayList.add(ObjectAnimator.ofFloat(this.titleLayout, (Property<FrameLayout, Float>) View.SCALE_X, z2 ? 0.87f : 1.0f));
                    arrayList.add(ObjectAnimator.ofFloat(this.titleLayout, (Property<FrameLayout, Float>) View.SCALE_Y, z2 ? 0.87f : 1.0f));
                    AnimatorSet animatorSet2 = new AnimatorSet();
                    this.subtitleAnimator = animatorSet2;
                    animatorSet2.playTogether(arrayList);
                    this.subtitleAnimator.setInterpolator(CubicBezierInterpolator.EASE_OUT_QUINT);
                    this.subtitleAnimator.start();
                } else {
                    this.subtitleTextView.setAlpha(z2 ? 1.0f : BitmapDescriptorFactory.HUE_RED);
                    this.subtitleTextView.setTranslationY(iDp);
                    FrameLayout frameLayout2 = this.titleLayout;
                    if (z2) {
                        fDp = AndroidUtilities.dp(-12.0f);
                    }
                    frameLayout2.setTranslationY(fDp);
                    this.titleLayout.setScaleX(z2 ? 0.87f : 1.0f);
                    this.titleLayout.setScaleY(z2 ? 0.87f : 1.0f);
                }
            }
            this.subtitleTextView.setText(charSequence, z);
        }

        public void setTextShadows(boolean z) {
            this.titleTextView[0].getPaint().setShadowLayer(AndroidUtilities.dpf2(0.66f), BitmapDescriptorFactory.HUE_RED, 1.0f, z ? 1912602624 : 0);
            this.titleTextView[1].getPaint().setShadowLayer(AndroidUtilities.dpf2(0.66f), BitmapDescriptorFactory.HUE_RED, 1.0f, z ? 1912602624 : 0);
            this.subtitleTextView.getDrawable().setShadowLayer(AndroidUtilities.dpf2(0.66f), BitmapDescriptorFactory.HUE_RED, 1.0f, z ? 1912602624 : 0);
        }

        public void setTitle(CharSequence charSequence) {
            this.titleTextView[1].setAlpha(BitmapDescriptorFactory.HUE_RED);
            this.titleTextView[1].setVisibility(8);
            if (!areStringsEqual(this.titleTextView[0].getText(), charSequence)) {
                this.titleTextView[0].resetScrolling();
            }
            this.titleTextView[0].setText(charSequence);
            this.titleTextView[0].setAlpha(1.0f);
            this.titleTextView[0].setTranslationX(BitmapDescriptorFactory.HUE_RED);
            this.titleTextView[0].setTranslationY(BitmapDescriptorFactory.HUE_RED);
        }

        public void setTitleAnimated(CharSequence charSequence, boolean z, boolean z2) {
            if (areStringsEqual(this.titleTextView[0].getText(), charSequence)) {
                return;
            }
            AnimatorSet animatorSet = this.titleAnimator;
            if (animatorSet != null) {
                animatorSet.cancel();
                this.titleAnimator = null;
            }
            SimpleTextView[] simpleTextViewArr = this.titleTextView;
            simpleTextViewArr[1].copyScrolling(simpleTextViewArr[0]);
            SimpleTextView[] simpleTextViewArr2 = this.titleTextView;
            simpleTextViewArr2[1].setText(simpleTextViewArr2[0].getText());
            this.titleTextView[1].setRightPadding((int) this.rightPadding);
            this.titleTextView[0].resetScrolling();
            this.titleTextView[0].setText(charSequence);
            float fDp = AndroidUtilities.dp(8.0f) * (z2 ? 1 : -1);
            this.titleTextView[1].setTranslationX(BitmapDescriptorFactory.HUE_RED);
            this.titleTextView[1].setTranslationY(BitmapDescriptorFactory.HUE_RED);
            SimpleTextView[] simpleTextViewArr3 = this.titleTextView;
            if (z) {
                simpleTextViewArr3[0].setTranslationX(BitmapDescriptorFactory.HUE_RED);
                this.titleTextView[0].setTranslationY(-fDp);
            } else {
                simpleTextViewArr3[0].setTranslationX(-fDp);
                this.titleTextView[0].setTranslationY(BitmapDescriptorFactory.HUE_RED);
            }
            this.titleTextView[0].setAlpha(BitmapDescriptorFactory.HUE_RED);
            this.titleTextView[1].setAlpha(1.0f);
            this.titleTextView[0].setVisibility(0);
            this.titleTextView[1].setVisibility(0);
            ArrayList arrayList = new ArrayList();
            SimpleTextView simpleTextView = this.titleTextView[1];
            Property property = View.ALPHA;
            arrayList.add(ObjectAnimator.ofFloat(simpleTextView, (Property<SimpleTextView, Float>) property, BitmapDescriptorFactory.HUE_RED));
            arrayList.add(ObjectAnimator.ofFloat(this.titleTextView[0], (Property<SimpleTextView, Float>) property, 1.0f));
            arrayList.add(ObjectAnimator.ofFloat(this.titleTextView[1], (Property<SimpleTextView, Float>) (z ? View.TRANSLATION_Y : View.TRANSLATION_X), fDp));
            arrayList.add(ObjectAnimator.ofFloat(this.titleTextView[0], (Property<SimpleTextView, Float>) (z ? View.TRANSLATION_Y : View.TRANSLATION_X), BitmapDescriptorFactory.HUE_RED));
            AnimatorSet animatorSet2 = new AnimatorSet();
            this.titleAnimator = animatorSet2;
            animatorSet2.playTogether(arrayList);
            this.titleAnimator.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.PhotoViewerActionBarContainer.2
                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                public void onAnimationEnd(Animator animator) {
                    if (PhotoViewerActionBarContainer.this.titleAnimator == animator) {
                        PhotoViewerActionBarContainer.this.titleTextView[1].setVisibility(8);
                        PhotoViewerActionBarContainer.this.titleAnimator = null;
                    }
                }
            });
            this.titleAnimator.setDuration(320L);
            this.titleAnimator.setInterpolator(CubicBezierInterpolator.EASE_OUT_QUINT);
            this.titleAnimator.start();
        }

        public void updateOrientation() {
            this.hasSubtitle = !this.hasSubtitle;
            setSubtitle(this.subtitleTextView.getText(), false);
        }

        public void updateRightPadding(final float f, boolean z) {
            ValueAnimator valueAnimator = this.rightPaddingAnimator;
            if (valueAnimator != null) {
                valueAnimator.cancel();
                this.rightPaddingAnimator = null;
            }
            if (!z) {
                this.rightPadding = f;
                this.titleTextView[0].setRightPadding((int) f);
                this.subtitleTextView.setRightPadding(f);
                return;
            }
            ValueAnimator valueAnimatorOfFloat = ValueAnimator.ofFloat(this.rightPadding, f);
            this.rightPaddingAnimator = valueAnimatorOfFloat;
            valueAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$PhotoViewerActionBarContainer$$ExternalSyntheticLambda0
                @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                public final void onAnimationUpdate(ValueAnimator valueAnimator2) {
                    this.f$0.lambda$updateRightPadding$0(f, valueAnimator2);
                }
            });
            this.rightPaddingAnimator.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.PhotoViewerActionBarContainer.3
                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                public void onAnimationEnd(Animator animator) {
                    PhotoViewerActionBarContainer.this.updateRightPadding(f, false);
                }
            });
            this.rightPaddingAnimator.setDuration(320L);
            this.rightPaddingAnimator.setInterpolator(CubicBezierInterpolator.EASE_OUT_QUINT);
            this.rightPaddingAnimator.start();
        }
    }

    public interface PhotoViewerProvider {

        /* renamed from: org.telegram.ui.PhotoViewer$PhotoViewerProvider$-CC, reason: invalid class name */
        public abstract /* synthetic */ class CC {
            public static boolean $default$canLoadMoreAvatars(PhotoViewerProvider photoViewerProvider) {
                return true;
            }

            public static boolean $default$canMoveCaptionAbove(PhotoViewerProvider photoViewerProvider) {
                return false;
            }

            public static boolean $default$forceAllInGroup(PhotoViewerProvider photoViewerProvider) {
                return false;
            }

            public static long $default$getDialogId(PhotoViewerProvider photoViewerProvider) {
                return 0L;
            }

            public static boolean $default$isCaptionAbove(PhotoViewerProvider photoViewerProvider) {
                return false;
            }

            public static boolean $default$isEditingMessage(PhotoViewerProvider photoViewerProvider) {
                return false;
            }

            public static boolean $default$isEditingMessageResend(PhotoViewerProvider photoViewerProvider) {
                return false;
            }

            public static void $default$moveCaptionAbove(PhotoViewerProvider photoViewerProvider, boolean z) {
            }

            public static boolean $default$onDeletePhoto(PhotoViewerProvider photoViewerProvider, int i) {
                return true;
            }

            public static void $default$onEditModeChanged(PhotoViewerProvider photoViewerProvider, boolean z) {
            }

            public static void $default$onPreClose(PhotoViewerProvider photoViewerProvider) {
            }

            public static void $default$onPreOpen(PhotoViewerProvider photoViewerProvider) {
            }

            public static void $default$onReleasePlayerBeforeClose(PhotoViewerProvider photoViewerProvider, int i) {
            }
        }

        boolean allowCaption();

        boolean allowSendingSubmenu();

        boolean canCaptureMorePhotos();

        boolean canEdit(int i);

        boolean canLoadMoreAvatars();

        boolean canMoveCaptionAbove();

        boolean canReplace(int i);

        boolean canScrollAway();

        boolean cancelButtonPressed();

        boolean closeKeyboard();

        void deleteImageAtIndex(int i);

        boolean forceAllInGroup();

        String getDeleteMessageString();

        long getDialogId();

        MessageObject getEditingMessageObject();

        int getPhotoIndex(int i);

        PlaceProviderObject getPlaceForPhoto(MessageObject messageObject, TLRPC.FileLocation fileLocation, int i, boolean z, boolean z2);

        int getSelectedCount();

        HashMap getSelectedPhotos();

        ArrayList getSelectedPhotosOrder();

        ImageReceiver.BitmapHolder getThumbForPhoto(MessageObject messageObject, TLRPC.FileLocation fileLocation, int i);

        int getTotalImageCount();

        boolean isCaptionAbove();

        boolean isEditingMessage();

        boolean isEditingMessageResend();

        boolean isPhotoChecked(int i);

        boolean loadMore();

        void moveCaptionAbove(boolean z);

        void needAddMorePhotos();

        void onApplyCaption(CharSequence charSequence);

        void onClose();

        boolean onDeletePhoto(int i);

        void onEditModeChanged(boolean z);

        void onOpen();

        void onPreClose();

        void onPreOpen();

        void onReleasePlayerBeforeClose(int i);

        void openPhotoForEdit(String str, String str2, boolean z);

        void replaceButtonPressed(int i, VideoEditedInfo videoEditedInfo);

        boolean scaleToFill();

        void sendButtonPressed(int i, VideoEditedInfo videoEditedInfo, boolean z, int i2, boolean z2);

        int setPhotoChecked(int i, VideoEditedInfo videoEditedInfo);

        int setPhotoUnchecked(Object obj);

        void updatePhotoAtIndex(int i);

        void willHidePhotoViewer();

        void willSwitchFromPhoto(MessageObject messageObject, TLRPC.FileLocation fileLocation, int i);
    }

    public static class PlaceProviderObject {
        public ClippingImageView animatingImageView;
        public int animatingImageViewYOffset;
        public boolean canEdit;
        public int clipBottomAddition;
        public int clipTopAddition;
        public long dialogId;
        public ImageReceiver imageReceiver;
        public boolean isEvent;
        public View parentView;
        public int[] radius;
        public long size;
        public int starOffset;
        public ImageReceiver.BitmapHolder thumb;
        public int viewX;
        public int viewY;
        public float scale = 1.0f;
        public boolean allowTakeAnimation = true;
    }

    private class QualityChooseView extends View {
        private int circleSize;
        private int gapSize;
        private String hightQualityDescription;
        private int lineSize;
        private String lowQualityDescription;
        private Paint paint;
        private int sideSide;
        private int startMovingQuality;
        private TextPaint textPaint;

        public QualityChooseView(Context context) {
            super(context);
            this.paint = new Paint(1);
            TextPaint textPaint = new TextPaint(1);
            this.textPaint = textPaint;
            textPaint.setTextSize(AndroidUtilities.dp(14.0f));
            this.textPaint.setColor(-3289651);
            this.lowQualityDescription = LocaleController.getString("AccDescrVideoCompressLow", R.string.AccDescrVideoCompressLow);
            this.hightQualityDescription = LocaleController.getString("AccDescrVideoCompressHigh", R.string.AccDescrVideoCompressHigh);
        }

        @Override // android.view.View
        protected void onDraw(Canvas canvas) {
            Paint paint;
            int i;
            this.lineSize = PhotoViewer.this.compressionsCount != 1 ? (((getMeasuredWidth() - (this.circleSize * PhotoViewer.this.compressionsCount)) - (this.gapSize * ((PhotoViewer.this.compressionsCount * 2) - 2))) - (this.sideSide * 2)) / (PhotoViewer.this.compressionsCount - 1) : ((getMeasuredWidth() - (this.circleSize * PhotoViewer.this.compressionsCount)) - (this.gapSize * 2)) - (this.sideSide * 2);
            int measuredHeight = (getMeasuredHeight() / 2) + AndroidUtilities.dp(6.0f);
            int i2 = 0;
            while (i2 < PhotoViewer.this.compressionsCount) {
                int i3 = this.sideSide;
                int i4 = this.lineSize + (this.gapSize * 2);
                int i5 = this.circleSize;
                int i6 = i3 + ((i4 + i5) * i2) + (i5 / 2);
                if (i2 <= PhotoViewer.this.selectedCompression) {
                    paint = this.paint;
                    i = -11292945;
                } else {
                    paint = this.paint;
                    i = 1728053247;
                }
                paint.setColor(i);
                canvas.drawCircle(i6, measuredHeight, i2 == PhotoViewer.this.selectedCompression ? AndroidUtilities.dp(6.0f) : this.circleSize / 2, this.paint);
                if (i2 != 0) {
                    int i7 = ((i6 - (this.circleSize / 2)) - this.gapSize) - this.lineSize;
                    int i8 = PhotoViewer.this.selectedCompression + 1;
                    float fDpf2 = BitmapDescriptorFactory.HUE_RED;
                    float fDpf22 = i2 == i8 ? AndroidUtilities.dpf2(2.0f) : BitmapDescriptorFactory.HUE_RED;
                    if (i2 == PhotoViewer.this.selectedCompression) {
                        fDpf2 = AndroidUtilities.dpf2(2.0f);
                    }
                    canvas.drawRect(fDpf22 + i7, measuredHeight - AndroidUtilities.dp(1.0f), (i7 + this.lineSize) - fDpf2, AndroidUtilities.dp(2.0f) + measuredHeight, this.paint);
                }
                i2++;
            }
            canvas.drawText(this.lowQualityDescription, this.sideSide, measuredHeight - AndroidUtilities.dp(16.0f), this.textPaint);
            canvas.drawText(this.hightQualityDescription, (getMeasuredWidth() - this.sideSide) - this.textPaint.measureText(this.hightQualityDescription), measuredHeight - AndroidUtilities.dp(16.0f), this.textPaint);
        }

        @Override // android.view.View
        protected void onMeasure(int i, int i2) {
            super.onMeasure(i, i2);
            this.circleSize = AndroidUtilities.dp(8.0f);
            this.gapSize = AndroidUtilities.dp(2.0f);
            this.sideSide = AndroidUtilities.dp(18.0f);
        }

        @Override // android.view.View
        public boolean onTouchEvent(MotionEvent motionEvent) {
            float x = motionEvent.getX();
            if (motionEvent.getAction() == 0) {
                this.startMovingQuality = PhotoViewer.this.selectedCompression;
                getParent().requestDisallowInterceptTouchEvent(true);
            }
            if (motionEvent.getAction() == 0 || motionEvent.getAction() == 2) {
                int i = 0;
                while (true) {
                    if (i >= PhotoViewer.this.compressionsCount) {
                        break;
                    }
                    int i2 = this.sideSide;
                    int i3 = this.lineSize;
                    int i4 = this.gapSize;
                    int i5 = this.circleSize;
                    int i6 = i2 + (((i4 * 2) + i3 + i5) * i);
                    int i7 = i5 / 2;
                    int i8 = i6 + i7;
                    int i9 = (i3 / 2) + i7 + i4;
                    if (x <= i8 - i9 || x >= i8 + i9) {
                        i++;
                    } else if (PhotoViewer.this.selectedCompression != i) {
                        PhotoViewer.this.selectedCompression = i;
                        PhotoViewer.this.didChangedCompressionLevel(false);
                        invalidate();
                    }
                }
            } else if (motionEvent.getAction() == 1 || motionEvent.getAction() == 3) {
                if (PhotoViewer.this.selectedCompression != this.startMovingQuality) {
                    PhotoViewer.this.requestVideoPreview(1);
                }
                PhotoViewer.this.moving = false;
            }
            return true;
        }
    }

    private class SavedState {
        private int index;
        private ArrayList messages;
        private PhotoViewerProvider provider;

        public SavedState(int i, ArrayList arrayList, PhotoViewerProvider photoViewerProvider) {
            this.messages = arrayList;
            this.index = i;
            this.provider = photoViewerProvider;
        }

        public void restore() throws Resources.NotFoundException {
            WindowManager.LayoutParams layoutParams;
            int i;
            PhotoViewer.this.placeProvider = this.provider;
            if (Build.VERSION.SDK_INT >= 21) {
                layoutParams = PhotoViewer.this.windowLayoutParams;
                i = -2147286784;
            } else {
                layoutParams = PhotoViewer.this.windowLayoutParams;
                i = 131072;
            }
            layoutParams.flags = i;
            PhotoViewer.this.windowLayoutParams.softInputMode = 272;
            PhotoViewer.this.windowView.setFocusable(false);
            PhotoViewer.this.containerView.setFocusable(false);
            PhotoViewer.this.backgroundDrawable.setAlpha(255);
            PhotoViewer.this.containerView.setAlpha(1.0f);
            PhotoViewer photoViewer = PhotoViewer.this;
            ArrayList arrayList = this.messages;
            int i2 = this.index;
            photoViewer.onPhotoShow(null, null, null, null, arrayList, null, null, i2, this.provider.getPlaceForPhoto((MessageObject) arrayList.get(i2), null, this.index, true, false));
        }
    }

    private static class SavedVideoPosition {
        public final float position;
        public final long timestamp;

        public SavedVideoPosition(float f, long j) {
            this.position = f;
            this.timestamp = j;
        }
    }

    private static class SelectedPhotosListView extends RecyclerListView {
        private Drawable arrowDrawable;
        private Paint paint;
        private RectF rect;

        public SelectedPhotosListView(Context context) {
            super(context);
            this.paint = new Paint(1);
            this.rect = new RectF();
            setWillNotDraw(false);
            setClipToPadding(false);
            setTranslationY(-AndroidUtilities.dp(10.0f));
            DefaultItemAnimator defaultItemAnimator = new DefaultItemAnimator() { // from class: org.telegram.ui.PhotoViewer.SelectedPhotosListView.1
                @Override // androidx.recyclerview.widget.DefaultItemAnimator
                protected void onMoveAnimationUpdate(RecyclerView.ViewHolder viewHolder) {
                    SelectedPhotosListView.this.invalidate();
                }
            };
            setItemAnimator(defaultItemAnimator);
            defaultItemAnimator.setDelayAnimations(false);
            defaultItemAnimator.setSupportsChangeAnimations(false);
            setPadding(AndroidUtilities.dp(12.0f), AndroidUtilities.dp(12.0f), AndroidUtilities.dp(12.0f), AndroidUtilities.dp(6.0f));
            this.paint.setColor(2130706432);
            this.arrowDrawable = context.getResources().getDrawable(R.drawable.photo_tooltip2).mutate();
        }

        @Override // androidx.recyclerview.widget.RecyclerView, android.view.View
        public void onDraw(Canvas canvas) {
            super.onDraw(canvas);
            int childCount = getChildCount();
            if (childCount > 0) {
                int measuredWidth = getMeasuredWidth() - AndroidUtilities.dp(87.0f);
                Drawable drawable = this.arrowDrawable;
                drawable.setBounds(measuredWidth, 0, drawable.getIntrinsicWidth() + measuredWidth, AndroidUtilities.dp(6.0f));
                this.arrowDrawable.draw(canvas);
                int iMin = Integer.MAX_VALUE;
                int iMax = Integer.MIN_VALUE;
                for (int i = 0; i < childCount; i++) {
                    View childAt = getChildAt(i);
                    iMin = (int) Math.min(iMin, Math.floor(childAt.getX()));
                    iMax = (int) Math.max(iMax, Math.ceil(childAt.getX() + childAt.getMeasuredWidth()));
                }
                if (iMin == Integer.MAX_VALUE || iMax == Integer.MIN_VALUE) {
                    return;
                }
                this.rect.set(iMin - AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), iMax + AndroidUtilities.dp(6.0f), AndroidUtilities.dp(103.0f));
                canvas.drawRoundRect(this.rect, AndroidUtilities.dp(8.0f), AndroidUtilities.dp(8.0f), this.paint);
            }
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    class VideoPlayerControlFrameLayout extends FrameLayout {
        private boolean ignoreLayout;
        private int lastTimeWidth;
        private int parentHeight;
        private int parentWidth;
        private float progress;
        private boolean seekBarTransitionEnabled;
        private SpringAnimation timeSpring;
        private FloatValueHolder timeValue;
        private boolean translationYAnimationEnabled;

        public VideoPlayerControlFrameLayout(Context context) {
            super(context);
            this.progress = 1.0f;
            this.translationYAnimationEnabled = true;
            this.timeValue = new FloatValueHolder(BitmapDescriptorFactory.HUE_RED);
            this.timeSpring = (SpringAnimation) new SpringAnimation(this.timeValue).setSpring(new SpringForce(BitmapDescriptorFactory.HUE_RED).setStiffness(750.0f).setDampingRatio(1.0f)).addUpdateListener(new DynamicAnimation.OnAnimationUpdateListener() { // from class: org.telegram.ui.PhotoViewer$VideoPlayerControlFrameLayout$$ExternalSyntheticLambda0
                @Override // androidx.dynamicanimation.animation.DynamicAnimation.OnAnimationUpdateListener
                public final void onAnimationUpdate(DynamicAnimation dynamicAnimation, float f, float f2) {
                    this.f$0.lambda$new$0(dynamicAnimation, f, f2);
                }
            });
            setWillNotDraw(false);
        }

        /* JADX INFO: Access modifiers changed from: private */
        public /* synthetic */ void lambda$new$0(DynamicAnimation dynamicAnimation, float f, float f2) {
            PhotoViewer.this.videoPlayerSeekbar.setSize((int) (((getMeasuredWidth() - AndroidUtilities.dp(16.0f)) - f) - (this.parentWidth > this.parentHeight ? AndroidUtilities.dp(48.0f) : 0)), getMeasuredHeight());
        }

        private void onProgressChanged(float f) {
            PhotoViewer.this.videoPlayerTime.setAlpha(f);
            PhotoViewer.this.exitFullscreenButton.setAlpha(f);
            if (!this.seekBarTransitionEnabled) {
                if (this.translationYAnimationEnabled) {
                    setTranslationY(AndroidUtilities.dpf2(24.0f) * (1.0f - f));
                }
                PhotoViewer.this.videoPlayerSeekbarView.setAlpha(f);
                return;
            }
            PhotoViewer.this.videoPlayerTime.setPivotX(PhotoViewer.this.videoPlayerTime.getWidth());
            PhotoViewer.this.videoPlayerTime.setPivotY(PhotoViewer.this.videoPlayerTime.getHeight());
            float f2 = 1.0f - f;
            float f3 = 1.0f - (0.1f * f2);
            PhotoViewer.this.videoPlayerTime.setScaleX(f3);
            PhotoViewer.this.videoPlayerTime.setScaleY(f3);
            PhotoViewer.this.videoPlayerSeekbar.setTransitionProgress(f2);
        }

        public float getProgress() {
            return this.progress;
        }

        @Override // android.view.ViewGroup, android.view.View
        protected void onDetachedFromWindow() {
            super.onDetachedFromWindow();
            this.timeValue.setValue(BitmapDescriptorFactory.HUE_RED);
            this.lastTimeWidth = 0;
        }

        @Override // android.widget.FrameLayout, android.view.ViewGroup, android.view.View
        protected void onLayout(boolean z, int i, int i2, int i3, int i4) {
            super.onLayout(z, i, i2, i3, i4);
            float currentPosition = PhotoViewer.this.videoPlayer != null ? PhotoViewer.this.videoPlayer.getCurrentPosition() / PhotoViewer.this.videoPlayer.getDuration() : BitmapDescriptorFactory.HUE_RED;
            if (PhotoViewer.this.playerWasReady) {
                PhotoViewer.this.videoPlayerSeekbar.setProgress(currentPosition);
            }
            PhotoViewer.this.videoTimelineView.setProgress(currentPosition);
        }

        /* JADX WARN: Removed duplicated region for block: B:22:0x009b  */
        /* JADX WARN: Removed duplicated region for block: B:32:0x0124  */
        @Override // android.widget.FrameLayout, android.view.View
        /*
            Code decompiled incorrectly, please refer to instructions dump.
        */
        protected void onMeasure(int i, int i2) {
            int iDp;
            long videoDuration;
            this.ignoreLayout = true;
            FrameLayout.LayoutParams layoutParams = (FrameLayout.LayoutParams) PhotoViewer.this.videoPlayerTime.getLayoutParams();
            if (this.parentWidth > this.parentHeight) {
                if (PhotoViewer.this.exitFullscreenButton.getVisibility() != 0) {
                    PhotoViewer.this.exitFullscreenButton.setVisibility(0);
                }
                iDp = AndroidUtilities.dp(48.0f);
                layoutParams.rightMargin = AndroidUtilities.dp(47.0f);
            } else {
                if (PhotoViewer.this.exitFullscreenButton.getVisibility() != 4) {
                    PhotoViewer.this.exitFullscreenButton.setVisibility(4);
                }
                layoutParams.rightMargin = AndroidUtilities.dp(12.0f);
                iDp = 0;
            }
            this.ignoreLayout = false;
            super.onMeasure(i, i2);
            if (PhotoViewer.this.videoPlayer != null) {
                videoDuration = PhotoViewer.this.videoPlayer.getDuration();
                if (videoDuration == -9223372036854775807L) {
                    videoDuration = 0;
                }
            } else if (PhotoViewer.this.photoViewerWebView != null && PhotoViewer.this.photoViewerWebView.isControllable()) {
                videoDuration = PhotoViewer.this.photoViewerWebView.getVideoDuration();
            }
            int iCeil = (int) Math.ceil(PhotoViewer.this.videoPlayerTime.getPaint().measureText(String.format(Locale.ROOT, "%1$s / %1$s", (videoDuration / 1000) / 60 > 60 ? String.format(Locale.ROOT, "%02d:%02d:%02d", Long.valueOf(r8 / 60), Long.valueOf(r8 % 60), Long.valueOf(r13 % 60)) : String.format(Locale.ROOT, "%02d:%02d", Long.valueOf(r8), Long.valueOf(r13 % 60)))));
            this.timeSpring.cancel();
            if (this.lastTimeWidth != 0) {
                float f = iCeil;
                if (this.timeValue.getValue() != f) {
                    this.timeSpring.getSpring().setFinalPosition(f);
                    this.timeSpring.start();
                } else {
                    PhotoViewer.this.videoPlayerSeekbar.setSize(((getMeasuredWidth() - AndroidUtilities.dp(16.0f)) - iCeil) - iDp, getMeasuredHeight());
                    this.timeValue.setValue(iCeil);
                }
            }
            this.lastTimeWidth = iCeil;
        }

        @Override // android.view.View
        public boolean onTouchEvent(MotionEvent motionEvent) {
            if (this.progress < 1.0f) {
                return false;
            }
            if (PhotoViewer.this.videoPlayerSeekbar.onTouch(motionEvent.getAction(), motionEvent.getX() - AndroidUtilities.dp(2.0f), motionEvent.getY())) {
                getParent().requestDisallowInterceptTouchEvent(true);
                PhotoViewer.this.videoPlayerSeekbarView.invalidate();
            }
            return true;
        }

        @Override // android.view.View, android.view.ViewParent
        public void requestLayout() {
            if (this.ignoreLayout) {
                return;
            }
            super.requestLayout();
        }

        public void setProgress(float f) {
            if (this.progress != f) {
                this.progress = f;
                onProgressChanged(f);
            }
        }

        public void setSeekBarTransitionEnabled(boolean z) {
            if (this.seekBarTransitionEnabled != z) {
                this.seekBarTransitionEnabled = z;
                if (z) {
                    setTranslationY(BitmapDescriptorFactory.HUE_RED);
                    PhotoViewer.this.videoPlayerSeekbarView.setAlpha(1.0f);
                } else {
                    PhotoViewer.this.videoPlayerTime.setScaleX(1.0f);
                    PhotoViewer.this.videoPlayerTime.setScaleY(1.0f);
                    PhotoViewer.this.videoPlayerSeekbar.setTransitionProgress(BitmapDescriptorFactory.HUE_RED);
                }
                onProgressChanged(this.progress);
            }
        }

        public void setTranslationYAnimationEnabled(boolean z) {
            if (this.translationYAnimationEnabled != z) {
                this.translationYAnimationEnabled = z;
                if (!z) {
                    setTranslationY(BitmapDescriptorFactory.HUE_RED);
                }
                onProgressChanged(this.progress);
            }
        }
    }

    static {
        String str = "progress";
        VPC_PROGRESS = Build.VERSION.SDK_INT >= 24 ? new FloatProperty(str) { // from class: org.telegram.ui.PhotoViewer.12
            @Override // android.util.Property
            public Float get(VideoPlayerControlFrameLayout videoPlayerControlFrameLayout) {
                return Float.valueOf(videoPlayerControlFrameLayout.getProgress());
            }

            @Override // android.util.FloatProperty
            public void setValue(VideoPlayerControlFrameLayout videoPlayerControlFrameLayout, float f) {
                videoPlayerControlFrameLayout.setProgress(f);
            }
        } : new Property(Float.class, str) { // from class: org.telegram.ui.PhotoViewer.13
            @Override // android.util.Property
            public Float get(VideoPlayerControlFrameLayout videoPlayerControlFrameLayout) {
                return Float.valueOf(videoPlayerControlFrameLayout.getProgress());
            }

            @Override // android.util.Property
            public void set(VideoPlayerControlFrameLayout videoPlayerControlFrameLayout, Float f) {
                videoPlayerControlFrameLayout.setProgress(f.floatValue());
            }
        };
        Instance = null;
        PipInstance = null;
        Instance2 = null;
    }

    public PhotoViewer() {
        this.ALLOW_USE_SURFACE = Build.VERSION.SDK_INT >= 30;
        this.maxSelectedPhotos = -1;
        this.allowOrder = true;
        this.miniProgressShowRunnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda71
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$new$0();
            }
        };
        this.isActionBarVisible = true;
        this.closePhotoAfterSelect = true;
        this.closePhotoAfterSelectWithAnimation = false;
        this.videoQualityItems = new ArrayList();
        this.actionBarItemsVisibility = new HashMap(3);
        this.backgroundDrawable = new BackgroundDrawable(-16777216);
        this.blackPaint = new Paint();
        this.photoProgressViews = new PhotoProgressView[3];
        this.onUserLeaveHintListener = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda72
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.onUserLeaveHint();
            }
        };
        this.pressedDrawable = new GradientDrawable[2];
        this.drawPressedDrawable = new boolean[2];
        this.pressedDrawableAlpha = new float[2];
        this.cropTransform = new CropTransform();
        this.leftCropTransform = new CropTransform();
        this.rightCropTransform = new CropTransform();
        this.shiftDp = -8.0f;
        this.insets = new Rect();
        this.setLoadingRunnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer.1
            @Override // java.lang.Runnable
            public void run() {
                if (PhotoViewer.this.currentMessageObject == null) {
                    return;
                }
                FileLoader.getInstance(PhotoViewer.this.currentMessageObject.currentAccount).setLoadingVideo(PhotoViewer.this.currentMessageObject.getDocument(), true, false);
            }
        };
        this.hideActionBarRunnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer.2
            @Override // java.lang.Runnable
            public void run() {
                if (PhotoViewer.this.videoPlayerControlVisible && PhotoViewer.this.isPlaying && !ApplicationLoader.mainInterfacePaused) {
                    if (PhotoViewer.this.menuItem == null || !PhotoViewer.this.menuItem.isSubMenuShowing()) {
                        if (PhotoViewer.this.videoItem == null || !PhotoViewer.this.videoItem.isSubMenuShowing()) {
                            if (PhotoViewer.this.captionScrollView == null || PhotoViewer.this.captionScrollView.getScrollY() == 0) {
                                if (PhotoViewer.this.miniProgressView == null || PhotoViewer.this.miniProgressView.getVisibility() != 0) {
                                    PhotoViewer photoViewer = PhotoViewer.PipInstance;
                                    PhotoViewer photoViewer2 = PhotoViewer.this;
                                    if (photoViewer == photoViewer2) {
                                        return;
                                    }
                                    photoViewer2.toggleActionBar(false, true);
                                }
                            }
                        }
                    }
                }
            }
        };
        this.videoPlayerControlVisible = true;
        this.videoPlayerCurrentTime = new int[2];
        this.videoPlayerTotalTime = new int[2];
        this.fullscreenButton = new ImageView[3];
        this.pipPosition = new int[2];
        this.pipVideoOverlayAnimateFlag = true;
        this.lastImageId = -1;
        this.prevOrientation = -10;
        this.longVideoPlayerRewinder = new OldVideoPlayerRewinder() { // from class: org.telegram.ui.PhotoViewer.3
            @Override // org.telegram.messenger.video.OldVideoPlayerRewinder
            protected void onRewindCanceled() {
                PhotoViewer.this.onTouchEvent(MotionEvent.obtain(0L, 0L, 3, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 0));
                PhotoViewer.this.videoForwardDrawable.setShowing(false);
                PipVideoOverlay.onRewindCanceled();
            }

            @Override // org.telegram.messenger.video.OldVideoPlayerRewinder
            protected void onRewindStart(boolean z) {
                PhotoViewer.this.videoForwardDrawable.setOneShootAnimation(false);
                PhotoViewer.this.videoForwardDrawable.setLeftSide(!z);
                PhotoViewer.this.videoForwardDrawable.setShowing(true);
                PhotoViewer.this.containerView.invalidate();
                PipVideoOverlay.onRewindStart(z);
            }

            @Override // org.telegram.messenger.video.OldVideoPlayerRewinder
            protected void updateRewindProgressUi(long j, float f, boolean z) {
                PhotoViewer.this.videoForwardDrawable.setTime(Math.abs(j));
                if (z) {
                    PhotoViewer.this.videoPlayerSeekbar.setProgress(f);
                    PhotoViewer.this.videoPlayerSeekbarView.invalidate();
                }
                PipVideoOverlay.onUpdateRewindProgressUi(j, f, z);
            }
        };
        VideoFramesRewinder videoFramesRewinder = new VideoFramesRewinder();
        this.framesRewinder = videoFramesRewinder;
        this.videoPlayerRewinder = new VideoPlayerRewinder(videoFramesRewinder) { // from class: org.telegram.ui.PhotoViewer.4
            @Override // org.telegram.messenger.video.VideoPlayerRewinder
            protected void onRewindCanceled() {
                PhotoViewer.this.onTouchEvent(MotionEvent.obtain(0L, 0L, 3, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 0));
                PhotoViewer.this.videoForwardDrawable.setShowing(false);
                PipVideoOverlay.onRewindCanceled();
            }

            @Override // org.telegram.messenger.video.VideoPlayerRewinder
            protected void onRewindStart(boolean z) {
                PhotoViewer.this.videoForwardDrawable.setOneShootAnimation(false);
                PhotoViewer.this.videoForwardDrawable.setLeftSide(!z);
                PhotoViewer.this.videoForwardDrawable.setShowing(true);
                PhotoViewer.this.containerView.invalidate();
                PipVideoOverlay.onRewindStart(z);
            }

            @Override // org.telegram.messenger.video.VideoPlayerRewinder
            protected void updateRewindProgressUi(long j, float f, boolean z) {
                PhotoViewer.this.videoForwardDrawable.setTime(Math.abs(j));
                if (z) {
                    PhotoViewer.this.videoPlayerSeekbar.setProgress(f);
                    PhotoViewer.this.videoPlayerSeekbarView.invalidate();
                }
                PipVideoOverlay.onUpdateRewindProgressUi(j, f, z);
            }
        };
        this.FLASH_VIEW_VALUE = new AnimationProperties.FloatProperty("flashViewAlpha") { // from class: org.telegram.ui.PhotoViewer.5
            @Override // android.util.Property
            public Float get(View view) {
                return Float.valueOf(view.getAlpha());
            }

            @Override // org.telegram.ui.Components.AnimationProperties.FloatProperty
            public void setValue(View view, float f) {
                view.setAlpha(f);
                if (PhotoViewer.this.photoCropView != null) {
                    PhotoViewer.this.photoCropView.setVideoThumbFlashAlpha(f);
                }
            }
        };
        this.updateProgressRunnable = new AnonymousClass6();
        this.switchToInlineRunnable = new AnonymousClass7();
        this.surfaceTextureListener = new TextureView.SurfaceTextureListener() { // from class: org.telegram.ui.PhotoViewer.8
            @Override // android.view.TextureView.SurfaceTextureListener
            public void onSurfaceTextureAvailable(SurfaceTexture surfaceTexture, int i, int i2) {
            }

            @Override // android.view.TextureView.SurfaceTextureListener
            public boolean onSurfaceTextureDestroyed(SurfaceTexture surfaceTexture) {
                if (PhotoViewer.this.videoTextureView == null) {
                    return true;
                }
                if (PipVideoOverlay.isVisible() && PipVideoOverlay.getPipSource() != null && PipVideoOverlay.getPipSource().state2.isAttachedToPip()) {
                    PipVideoOverlay.getPipTextureView().setSurfaceTexture(surfaceTexture);
                    PipVideoOverlay.getPipTextureView().setVisibility(0);
                    return false;
                }
                if (!PhotoViewer.this.changingTextureView) {
                    return true;
                }
                if (PhotoViewer.this.switchingInlineMode) {
                    PhotoViewer.this.waitingForFirstTextureUpload = 2;
                }
                PhotoViewer.this.videoTextureView.setSurfaceTexture(surfaceTexture);
                PhotoViewer.this.videoTextureView.setVisibility(0);
                PhotoViewer.this.changingTextureView = false;
                PhotoViewer.this.containerView.invalidate();
                return false;
            }

            @Override // android.view.TextureView.SurfaceTextureListener
            public void onSurfaceTextureSizeChanged(SurfaceTexture surfaceTexture, int i, int i2) {
            }

            @Override // android.view.TextureView.SurfaceTextureListener
            public void onSurfaceTextureUpdated(SurfaceTexture surfaceTexture) {
                if (PhotoViewer.this.waitingForFirstTextureUpload == 1) {
                    PhotoViewer.this.checkChangedTextureView(true);
                }
            }
        };
        this.animationValues = (float[][]) Array.newInstance((Class<?>) Float.TYPE, 2, 13);
        this.updateContainerFlagsRunnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda73
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$new$5();
            }
        };
        this.leftImage = new ImageReceiver();
        this.centerImage = new ImageReceiver() { // from class: org.telegram.ui.PhotoViewer.11
            @Override // org.telegram.messenger.ImageReceiver
            protected boolean setImageBitmapByKey(Drawable drawable, String str, int i, boolean z, int i2) {
                boolean imageBitmapByKey = super.setImageBitmapByKey(drawable, str, i, z, i2);
                PhotoViewer.this.prepareSegmentImage();
                return imageBitmapByKey;
            }
        };
        this.rightImage = new ImageReceiver();
        this.leftBlur = new BlurringShader.ThumbBlurer(1, new PhotoViewer$$ExternalSyntheticLambda74(this));
        this.centerBlur = new BlurringShader.ThumbBlurer(1, new PhotoViewer$$ExternalSyntheticLambda74(this));
        this.rightBlur = new BlurringShader.ThumbBlurer(1, new PhotoViewer$$ExternalSyntheticLambda74(this));
        this.centerImageTransformLocked = false;
        this.centerImageTransform = new Matrix();
        this.videoFrameBitmapPaint = new Paint();
        this.videoFrameBitmap = null;
        this.editState = new EditState();
        this.currentFileNames = new String[3];
        this.endReached = new boolean[]{false, true};
        this.startReached = false;
        this.scale = 1.0f;
        this.currentCropScale = 1.0f;
        this.currentCropX = BitmapDescriptorFactory.HUE_RED;
        this.currentCropY = BitmapDescriptorFactory.HUE_RED;
        this.rotate = BitmapDescriptorFactory.HUE_RED;
        this.mirror = BitmapDescriptorFactory.HUE_RED;
        this.switchingToMode = -1;
        this.interpolator = new DecelerateInterpolator(1.5f);
        this.pinchStartScale = 1.0f;
        this.pinchStartRotate = BitmapDescriptorFactory.HUE_RED;
        this.canZoom = true;
        this.canDragDown = true;
        this.shownControlsByEnd = false;
        this.actionBarWasShownBeforeByEnd = false;
        this.imagesArrTemp = new ArrayList();
        this.imagesByIdsTemp = new SparseArray[]{new SparseArray(), new SparseArray()};
        this.imagesArr = new ArrayList();
        this.imagesByIds = new SparseArray[]{new SparseArray(), new SparseArray()};
        this.imagesArrLocations = new ArrayList();
        this.imagesArrLocationsVideo = new ArrayList();
        this.imagesArrLocationsSizes = new ArrayList();
        this.imagesArrMessages = new ArrayList();
        this.secureDocuments = new ArrayList();
        this.avatarsArr = new ArrayList();
        this.imagesArrLocals = new ArrayList();
        this.currentAvatarLocation = null;
        this.savedState = null;
        this.hitRect = new Rect();
        this.transitionNotificationLocker = new AnimationNotificationsLocker(new int[]{NotificationCenter.dialogsNeedReload, NotificationCenter.closeChats, NotificationCenter.mediaCountDidLoad, NotificationCenter.mediaDidLoad, NotificationCenter.dialogPhotosUpdate});
        this.captionEditAlpha = new float[]{1.0f};
        this.topCaptionEditAlpha = new float[]{1.0f};
        this.longPressRunnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda75
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.onLongPress();
            }
        };
        this.tempInt = new int[2];
        this.captureFrameAtTime = -1L;
        this.captureFrameReadyAtTime = -1L;
        this.needCaptureFrameReadyAtTime = -1L;
        this.compressionsCount = -1;
        this.blurAlpha = new AnimatedFloat(new PhotoViewer$$ExternalSyntheticLambda74(this), 180L, CubicBezierInterpolator.EASE_OUT);
        this.blackPaint.setColor(-16777216);
        this.videoFrameBitmapPaint.setColor(-1);
        this.centerImage.setFileLoadingPriority(3);
    }

    /* JADX INFO: Access modifiers changed from: package-private */
    public static /* synthetic */ void access$17900(PhotoViewer photoViewer) {
        photoViewer.updateCaptionTranslated();
    }

    private boolean allowLoopingOnPause() {
        return AndroidUtilities.isInPictureInPictureMode(this.parentActivity);
    }

    private void animateTo(float f, float f2, float f3, boolean z) {
        animateTo(f, f2, f3, z, MediaDataController.MAX_LINKS_COUNT);
    }

    private void animateTo(float f, float f2, float f3, boolean z, int i) {
        if (this.scale == f && this.translationX == f2 && this.translationY == f3) {
            return;
        }
        this.zoomAnimation = z;
        this.animateToScale = f;
        this.animateToX = f2;
        this.animateToY = f3;
        this.animationStartTime = System.currentTimeMillis();
        AnimatorSet animatorSet = new AnimatorSet();
        this.imageMoveAnimation = animatorSet;
        animatorSet.playTogether(ObjectAnimator.ofFloat(this, (Property<PhotoViewer, Float>) AnimationProperties.PHOTO_VIEWER_ANIMATION_VALUE, BitmapDescriptorFactory.HUE_RED, 1.0f));
        this.imageMoveAnimation.setInterpolator(this.interpolator);
        this.imageMoveAnimation.setDuration(i);
        this.imageMoveAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.81
            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
            public void onAnimationEnd(Animator animator) {
                PhotoViewer.this.imageMoveAnimation = null;
                PhotoViewer.this.containerView.invalidate();
            }
        });
        this.imageMoveAnimation.start();
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:34:0x008b  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public CharSequence applyCaption() {
        int i;
        PhotoViewerProvider photoViewerProvider;
        MediaController.MediaEditState mediaEditState;
        if (!isVisible() || this.placeProvider == null || (i = this.currentIndex) < 0 || i >= this.imagesArrLocals.size()) {
            return null;
        }
        Object obj = this.imagesArrLocals.get(this.currentIndex);
        CharSequence text = getCaptionView().getText();
        CharSequence[] charSequenceArr = {text};
        if (this.hasCaptionForAllMedia && !TextUtils.equals(this.captionForAllMedia, text) && this.placeProvider.getPhotoIndex(this.currentIndex) != 0 && this.placeProvider.getSelectedCount() > 0) {
            this.hasCaptionForAllMedia = false;
        }
        ArrayList<TLRPC.MessageEntity> entities = MediaDataController.getInstance(this.currentAccount).getEntities(charSequenceArr, supportsSendingNewEntities());
        CharSequence charSequence = charSequenceArr[0];
        this.captionForAllMedia = charSequence;
        if (!(obj instanceof MediaController.PhotoEntry)) {
            if (obj instanceof MediaController.SearchImage) {
                MediaController.SearchImage searchImage = (MediaController.SearchImage) obj;
                searchImage.caption = charSequence;
                mediaEditState = searchImage;
            }
            if (text.length() != 0 && !this.placeProvider.isPhotoChecked(this.currentIndex)) {
                setPhotoChecked();
            }
            photoViewerProvider = this.placeProvider;
            if (photoViewerProvider != null) {
                photoViewerProvider.onApplyCaption(text);
            }
            return text;
        }
        MediaController.MediaEditState mediaEditState2 = (MediaController.PhotoEntry) obj;
        mediaEditState2.caption = charSequence;
        mediaEditState = mediaEditState2;
        mediaEditState.entities = entities;
        if (text.length() != 0) {
            setPhotoChecked();
        }
        photoViewerProvider = this.placeProvider;
        if (photoViewerProvider != null) {
        }
        return text;
    }

    /* JADX WARN: Removed duplicated region for block: B:37:0x0069  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private int[] applyCrop(Canvas canvas, int i, int i2, int i3, int i4, float f, CropTransform cropTransform, MediaController.CropState cropState) {
        float f2;
        int i5;
        float f3;
        float minScale;
        int i6;
        float f4 = i;
        int i7 = i3;
        float f5 = i7;
        float f6 = f4 / f5;
        float f7 = i2;
        int i8 = i4;
        float f8 = i8;
        float f9 = f7 / f8;
        float fMin = Math.min(f6, f9);
        int orientation = cropTransform.getOrientation();
        if (orientation != 90 && orientation != 270) {
            i8 = i7;
            i7 = i8;
        }
        if (this.sendPhotoType == 1 || (this.currentEditMode != 3 && this.switchingToMode != 3)) {
            if (this.imageMoveAnimation == null || (i5 = this.switchingToMode) == -1) {
                int i9 = this.currentEditMode;
                f2 = (i9 == 2 || i9 == 3) ? BitmapDescriptorFactory.HUE_RED : 1.0f;
            } else {
                int i10 = this.currentEditMode;
                if (i10 != 1 && i5 != 1 && ((i10 != 2 && i10 != 3) || i5 != -1)) {
                    f2 = i5 == 0 ? this.animationValue : 1.0f - this.animationValue;
                }
            }
        }
        float cropPw = cropTransform.getCropPw();
        float cropPh = cropTransform.getCropPh();
        float f10 = i8;
        float f11 = 1.0f - f2;
        int i11 = (int) ((cropPw + ((1.0f - cropPw) * f11)) * f10);
        float f12 = i7;
        int i12 = (int) ((cropPh + ((1.0f - cropPh) * f11)) * f12);
        float f13 = i11;
        float f14 = f4 / f13;
        float f15 = i12;
        if (f14 * f15 > f7) {
            f14 = f7 / f15;
        }
        if (this.sendPhotoType != 1 && ((this.currentEditMode != 1 || this.switchingToMode == 0) && cropState != null)) {
            float f16 = f13 * f14;
            float f17 = f15 * f14;
            if (f6 * f8 > f7) {
                f6 = f9;
            }
            float f18 = f16 + ((((f5 * f6) / f) - f16) * f11);
            float f19 = f17 + ((((f8 * f6) / f) - f17) * f11);
            canvas.clipRect((-f18) / 2.0f, (-f19) / 2.0f, f18 / 2.0f, f19 / 2.0f);
        }
        if (this.sendPhotoType == 1 || cropTransform.hasViewTransform()) {
            if (this.currentEditMode == 1 || this.sendPhotoType == 1) {
                float scale = cropTransform.getScale() / (((cropTransform.getTrueCropScale() - 1.0f) * f11) + 1.0f);
                float f20 = f4 / f10;
                if (f20 * f12 > f7) {
                    f20 = f7 / f12;
                }
                f3 = (f20 / fMin) * scale;
                if (this.sendPhotoType == 1) {
                    if (this.currentEditMode == 3 || (i6 = this.switchingToMode) == 3) {
                        minScale = ((cropTransform.getMinScale() - 1.0f) * f11) + 1.0f;
                    } else if (i6 == 0) {
                        minScale = cropTransform.getMinScale();
                    }
                    f3 /= minScale;
                }
            } else {
                float f21 = cropState != null ? cropState.cropScale : 1.0f;
                f3 = f21 * ((f14 / fMin) / (((f21 - 1.0f) * f11) + 1.0f));
            }
            canvas.translate(cropTransform.getCropAreaX() * f2, cropTransform.getCropAreaY() * f2);
            canvas.scale(f3, f3);
            canvas.translate(cropTransform.getCropPx() * f10 * fMin * f2, cropTransform.getCropPy() * f12 * fMin * f2);
            float rotation = cropTransform.getRotation() + orientation;
            if (rotation > 180.0f) {
                rotation -= 360.0f;
            }
            if (this.sendPhotoType != 1 || (this.currentEditMode != 3 && this.switchingToMode != 3)) {
                rotation *= f2;
            }
            canvas.rotate(rotation);
        }
        int[] iArr = this.tempInt;
        iArr[0] = i11;
        iArr[1] = i12;
        return iArr;
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Multi-variable type inference failed */
    /* JADX WARN: Removed duplicated region for block: B:108:0x030b  */
    /* JADX WARN: Removed duplicated region for block: B:200:0x0588  */
    /* JADX WARN: Removed duplicated region for block: B:279:0x07a9  */
    /* JADX WARN: Removed duplicated region for block: B:282:0x07b0  */
    /* JADX WARN: Removed duplicated region for block: B:61:0x0187 A[RETURN] */
    /* JADX WARN: Removed duplicated region for block: B:62:0x0188  */
    /* JADX WARN: Type inference failed for: r15v1 */
    /* JADX WARN: Type inference failed for: r15v10 */
    /* JADX WARN: Type inference failed for: r15v11 */
    /* JADX WARN: Type inference failed for: r15v12 */
    /* JADX WARN: Type inference failed for: r15v13 */
    /* JADX WARN: Type inference failed for: r15v14 */
    /* JADX WARN: Type inference failed for: r15v15 */
    /* JADX WARN: Type inference failed for: r15v16 */
    /* JADX WARN: Type inference failed for: r15v17 */
    /* JADX WARN: Type inference failed for: r15v18 */
    /* JADX WARN: Type inference failed for: r15v19 */
    /* JADX WARN: Type inference failed for: r15v2, types: [boolean, int] */
    /* JADX WARN: Type inference failed for: r15v22 */
    /* JADX WARN: Type inference failed for: r15v23 */
    /* JADX WARN: Type inference failed for: r15v3 */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void applyCurrentEditMode() {
        Bitmap bitmap;
        int[] iArr;
        ArrayList<VideoEditedInfo.MediaEntity> arrayList;
        List<TLRPC.InputDocument> list;
        Object savedFilterState;
        Bitmap bitmapCreateVideoThumbnailAtTime;
        boolean z;
        Object obj;
        ?? r15;
        ImageView imageView;
        PorterDuffColorFilter porterDuffColorFilter;
        int i;
        PhotoViewerProvider photoViewerProvider;
        int i2;
        Bitmap bitmapCreateCroppedBitmap;
        boolean z2;
        Bitmap bitmap2;
        boolean z3;
        Bitmap bitmapCreateBitmap;
        long j;
        int[] iArr2;
        Bitmap bitmapLoadBitmap;
        int bitmapWidth;
        int bitmapHeight;
        Bitmap bitmap3;
        Bitmap bitmap4;
        boolean z4;
        boolean z5;
        Bitmap bitmapCreateCroppedBitmap2;
        boolean z6;
        int i3;
        int i4;
        int i5 = this.currentIndex;
        if (i5 < 0 || i5 >= this.imagesArrLocals.size() || !(this.imagesArrLocals.get(this.currentIndex) instanceof MediaController.MediaEditState)) {
            return;
        }
        Bitmap[] bitmapArr = new Bitmap[1];
        MediaController.MediaEditState mediaEditState = (MediaController.MediaEditState) this.imagesArrLocals.get(this.currentIndex);
        int i6 = this.currentEditMode;
        if (i6 == 1 || (i6 == 0 && this.sendPhotoType == 1)) {
            this.photoCropView.makeCrop(mediaEditState);
            if (mediaEditState.cropState == null && this.currentEditMode != 1) {
                return;
            }
            if (this.isCurrentVideo) {
                if (!TextUtils.isEmpty(mediaEditState.filterPath)) {
                    bitmapCreateVideoThumbnailAtTime = ImageLoader.loadBitmap(mediaEditState.filterPath, null, 512.0f, 512.0f, true);
                } else if (this.sendPhotoType == 1) {
                    iArr = new int[1];
                    bitmap = SendMessagesHelper.createVideoThumbnailAtTime(mediaEditState.getPath(), this.avatarStartTime / 1000, iArr, true);
                } else {
                    bitmapCreateVideoThumbnailAtTime = SendMessagesHelper.createVideoThumbnailAtTime(mediaEditState.getPath(), (long) (this.videoTimelineView.getLeftProgress() * this.videoPlayer.getDuration() * 1000.0f));
                }
                bitmap = bitmapCreateVideoThumbnailAtTime;
                iArr = null;
                arrayList = null;
                list = arrayList;
                savedFilterState = list;
            } else {
                bitmap = this.centerImage.getBitmap();
                iArr = new int[]{this.centerImage.getOrientation(), this.centerImage.getInvert()};
            }
            arrayList = null;
            list = arrayList;
            savedFilterState = list;
        } else if (i6 == 2) {
            bitmap = this.stickerMakerView.cutSegmentInFilteredBitmap(this.photoFilterView.getBitmap(), this.centerImage.getOrientation());
            savedFilterState = this.photoFilterView.getSavedFilterState();
            iArr = null;
            arrayList = null;
            list = null;
        } else {
            if (i6 == 3) {
                int i7 = this.sendPhotoType;
                ArrayList<VideoEditedInfo.MediaEntity> arrayList2 = (i7 == 0 || i7 == 1 || i7 == 11 || i7 == 2) ? new ArrayList<>() : null;
                boolean zHasChanges = this.photoPaintView.hasChanges();
                Bitmap bitmap5 = this.photoPaintView.getBitmap(arrayList2, bitmapArr);
                List<TLRPC.InputDocument> masks = this.photoPaintView.getMasks();
                this.photoPaintView.onCleanupEntities();
                z = zHasChanges;
                list = masks;
                arrayList = arrayList2;
                bitmap = bitmap5;
                iArr = null;
                savedFilterState = null;
                if (bitmap != null) {
                    return;
                }
                if (mediaEditState.thumbPath != null) {
                    new File(mediaEditState.thumbPath).delete();
                    mediaEditState.thumbPath = null;
                }
                if (mediaEditState.imagePath != null) {
                    new File(mediaEditState.imagePath).delete();
                    mediaEditState.imagePath = null;
                }
                int i8 = this.currentEditMode;
                if (i8 == 1 || (i8 == 0 && this.sendPhotoType == 1)) {
                    obj = savedFilterState;
                    r15 = 0;
                    r15 = 0;
                    r15 = 0;
                    r15 = 0;
                    EditState editState = this.editState;
                    MediaController.CropState cropState = mediaEditState.cropState;
                    editState.cropState = cropState;
                    editState.croppedPaintPath = mediaEditState.croppedPaintPath;
                    editState.croppedMediaEntities = mediaEditState.croppedMediaEntities;
                    if (cropState != null) {
                        Bitmap bitmapCreateCroppedBitmap3 = createCroppedBitmap(bitmap, cropState, iArr, true);
                        if (mediaEditState.paintPath != null) {
                            Bitmap bitmapDecodeFile = BitmapFactory.decodeFile(mediaEditState.fullPaintPath);
                            Bitmap bitmapCreateCroppedBitmap4 = createCroppedBitmap(bitmapDecodeFile, mediaEditState.cropState, null, false);
                            if (!this.isCurrentVideo) {
                                if (hasAnimatedMediaEntities()) {
                                    String string = FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmapCreateCroppedBitmap3, getCompressFormat(), AndroidUtilities.getPhotoSize(), AndroidUtilities.getPhotoSize(), 87, false, 101, 101), true).toString();
                                    this.currentImagePath = string;
                                    mediaEditState.imagePath = string;
                                } else {
                                    String tempFileAbsolutePath = getTempFileAbsolutePath();
                                    mediaEditState.imagePath = tempFileAbsolutePath;
                                    mergeImages(tempFileAbsolutePath, null, bitmapCreateCroppedBitmap4, bitmapCreateCroppedBitmap3, AndroidUtilities.getPhotoSize(), true);
                                }
                            }
                            String tempFileAbsolutePath2 = getTempFileAbsolutePath();
                            mediaEditState.thumbPath = tempFileAbsolutePath2;
                            mergeImages(tempFileAbsolutePath2, null, bitmapCreateCroppedBitmap4, bitmapCreateCroppedBitmap3, 512.0f, true);
                            if (bitmapCreateCroppedBitmap4 != null) {
                                bitmapCreateCroppedBitmap4.recycle();
                            }
                            if (bitmapDecodeFile != null) {
                                bitmapDecodeFile.recycle();
                            }
                        } else {
                            if (!this.isCurrentVideo) {
                                String string2 = FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmapCreateCroppedBitmap3, getCompressFormat(), AndroidUtilities.getPhotoSize(), AndroidUtilities.getPhotoSize(), 87, false, 101, 101), true).toString();
                                this.currentImagePath = string2;
                                mediaEditState.imagePath = string2;
                            }
                            mediaEditState.thumbPath = FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmapCreateCroppedBitmap3, 512.0f, 512.0f, 70, false, 101, 101), true).toString();
                        }
                        if (this.currentEditMode == 0 && this.isCurrentVideo) {
                            bitmap.recycle();
                            bitmap = bitmapCreateCroppedBitmap3;
                        }
                    }
                } else if (i8 == 2) {
                    if (mediaEditState.filterPath != null) {
                        new File(mediaEditState.filterPath).delete();
                    }
                    mediaEditState.filterPath = FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmap, getCompressFormat(), AndroidUtilities.getPhotoSize(true), AndroidUtilities.getPhotoSize(true), 87, false, 101, 101), true).toString();
                    MediaController.CropState cropState2 = mediaEditState.cropState;
                    Bitmap bitmapCreateCroppedBitmap5 = cropState2 != null ? createCroppedBitmap(bitmap, cropState2, null, true) : bitmap;
                    String str = mediaEditState.paintPath;
                    if (str == null) {
                        if (!this.isCurrentVideo) {
                            String string3 = FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmapCreateCroppedBitmap5, getCompressFormat(), AndroidUtilities.getPhotoSize(), AndroidUtilities.getPhotoSize(), 87, false, 101, 101), true).toString();
                            this.currentImagePath = string3;
                            mediaEditState.imagePath = string3;
                        }
                        mediaEditState.thumbPath = FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmapCreateCroppedBitmap5, getCompressFormat(), 512.0f, 512.0f, 83, false, 101, 101), true).toString();
                        obj = savedFilterState;
                        z6 = false;
                    } else {
                        String str2 = mediaEditState.fullPaintPath;
                        Bitmap bitmap6 = str.equals(str2) ? this.paintingOverlay.getBitmap() : null;
                        MediaController.CropState cropState3 = mediaEditState.cropState;
                        if (cropState3 != null) {
                            if (bitmap6 == null) {
                                Bitmap bitmapDecodeFile2 = BitmapFactory.decodeFile(mediaEditState.fullPaintPath);
                                Bitmap bitmapCreateCroppedBitmap6 = createCroppedBitmap(bitmapDecodeFile2, mediaEditState.cropState, null, false);
                                bitmapDecodeFile2.recycle();
                                bitmapCreateCroppedBitmap2 = bitmapCreateCroppedBitmap6;
                            } else {
                                bitmapCreateCroppedBitmap2 = createCroppedBitmap(bitmap6, cropState3, null, false);
                            }
                            bitmap4 = bitmapCreateCroppedBitmap2;
                            z4 = true;
                        } else {
                            bitmap4 = bitmap6;
                            z4 = false;
                        }
                        if (this.isCurrentVideo) {
                            obj = savedFilterState;
                            z5 = false;
                            String tempFileAbsolutePath3 = getTempFileAbsolutePath();
                            mediaEditState.thumbPath = tempFileAbsolutePath3;
                            mergeImages(tempFileAbsolutePath3, str2, bitmap4, bitmapCreateCroppedBitmap5, 512.0f, true);
                            z6 = z5;
                            if (z4) {
                                bitmap4.recycle();
                                z6 = z5;
                            }
                        } else if (hasAnimatedMediaEntities()) {
                            String string4 = FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmapCreateCroppedBitmap5, getCompressFormat(), AndroidUtilities.getPhotoSize(), AndroidUtilities.getPhotoSize(), 87, false, 101, 101), true).toString();
                            this.currentImagePath = string4;
                            mediaEditState.imagePath = string4;
                            obj = savedFilterState;
                            z5 = false;
                            String tempFileAbsolutePath32 = getTempFileAbsolutePath();
                            mediaEditState.thumbPath = tempFileAbsolutePath32;
                            mergeImages(tempFileAbsolutePath32, str2, bitmap4, bitmapCreateCroppedBitmap5, 512.0f, true);
                            z6 = z5;
                            if (z4) {
                            }
                        } else {
                            String tempFileAbsolutePath4 = getTempFileAbsolutePath();
                            mediaEditState.imagePath = tempFileAbsolutePath4;
                            obj = savedFilterState;
                            z5 = false;
                            mergeImages(tempFileAbsolutePath4, str2, bitmap4, bitmapCreateCroppedBitmap5, AndroidUtilities.getPhotoSize(), true);
                            String tempFileAbsolutePath322 = getTempFileAbsolutePath();
                            mediaEditState.thumbPath = tempFileAbsolutePath322;
                            mergeImages(tempFileAbsolutePath322, str2, bitmap4, bitmapCreateCroppedBitmap5, 512.0f, true);
                            z6 = z5;
                            if (z4) {
                            }
                        }
                    }
                    r15 = z6;
                    if (mediaEditState.cropState != null) {
                        bitmapCreateCroppedBitmap5.recycle();
                        r15 = z6;
                    }
                } else {
                    obj = savedFilterState;
                    r15 = 0;
                    r15 = 0;
                    r15 = 0;
                    r15 = 0;
                    r15 = 0;
                    r15 = 0;
                    r15 = 0;
                    r15 = 0;
                    if (i8 == 3) {
                        if (mediaEditState.paintPath != null) {
                            new File(mediaEditState.paintPath).delete();
                            if (!mediaEditState.paintPath.equals(mediaEditState.fullPaintPath)) {
                                new File(mediaEditState.fullPaintPath).delete();
                            }
                        }
                        Bitmap.CompressFormat compressFormat = Bitmap.CompressFormat.PNG;
                        TLRPC.PhotoSize photoSizeScaleAndSaveImage = ImageLoader.scaleAndSaveImage(bitmap, compressFormat, AndroidUtilities.getPhotoSize(), AndroidUtilities.getPhotoSize(), 87, false, 101, 101);
                        mediaEditState.stickers = list != null ? new ArrayList<>(list) : null;
                        EditState editState2 = this.editState;
                        String string5 = FileLoader.getInstance(this.currentAccount).getPathToAttach(photoSizeScaleAndSaveImage, true).toString();
                        editState2.paintPath = string5;
                        mediaEditState.paintPath = string5;
                        PaintingOverlay paintingOverlay = this.paintingOverlay;
                        EditState editState3 = this.editState;
                        ArrayList<VideoEditedInfo.MediaEntity> arrayList3 = (arrayList == null || arrayList.isEmpty()) ? null : arrayList;
                        editState3.mediaEntities = arrayList3;
                        mediaEditState.mediaEntities = arrayList3;
                        paintingOverlay.setEntities(arrayList3, this.isCurrentVideo, true, this.sendPhotoType != 11);
                        EditState editState4 = this.editState;
                        long lcm = this.photoPaintView.getLcm();
                        editState4.averageDuration = lcm;
                        mediaEditState.averageDuration = lcm;
                        mediaEditState.fullPaintPath = (mediaEditState.mediaEntities == null || (bitmap3 = bitmapArr[0]) == null) ? mediaEditState.paintPath : FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmap3, compressFormat, AndroidUtilities.getPhotoSize(), AndroidUtilities.getPhotoSize(), 87, false, 101, 101), true).toString();
                        this.paintingOverlay.setBitmap(bitmap);
                        MediaController.CropState cropState4 = mediaEditState.cropState;
                        if (cropState4 != null && cropState4.initied) {
                            String copy = CropView.getCopy(this.editState.paintPath);
                            if (this.editState.croppedPaintPath != null) {
                                new File(this.editState.croppedPaintPath).delete();
                                this.editState.croppedPaintPath = null;
                            }
                            EditState editState5 = this.editState;
                            editState5.croppedPaintPath = copy;
                            ArrayList arrayList4 = editState5.mediaEntities;
                            if (arrayList4 == null || arrayList4.isEmpty()) {
                                this.editState.croppedMediaEntities = null;
                            } else {
                                this.editState.croppedMediaEntities = new ArrayList(this.editState.mediaEntities.size());
                                int size = this.editState.mediaEntities.size();
                                for (int i9 = 0; i9 < size; i9++) {
                                    EditState editState6 = this.editState;
                                    editState6.croppedMediaEntities.add(((VideoEditedInfo.MediaEntity) editState6.mediaEntities.get(i9)).copy());
                                }
                            }
                            MediaController.CropState cropState5 = mediaEditState.cropState;
                            Bitmap bitmapCreateBitmap2 = Bitmap.createBitmap(cropState5.width, cropState5.height, Bitmap.Config.ARGB_8888);
                            Canvas canvas = new Canvas(bitmapCreateBitmap2);
                            if (this.isCurrentVideo) {
                                VideoEditTextureView videoEditTextureView = (VideoEditTextureView) this.videoTextureView;
                                int videoWidth = videoEditTextureView.getVideoWidth();
                                bitmapHeight = videoEditTextureView.getVideoHeight();
                                bitmapWidth = videoWidth;
                            } else {
                                bitmapWidth = this.centerImage.getBitmapWidth();
                                bitmapHeight = this.centerImage.getBitmapHeight();
                            }
                            Activity activity = this.parentActivity;
                            Bitmap.CompressFormat compressFormat2 = Bitmap.CompressFormat.PNG;
                            MediaController.CropState cropState6 = mediaEditState.cropState;
                            CropView.editBitmap(activity, copy, null, canvas, bitmapCreateBitmap2, compressFormat2, cropState6.matrix, bitmapWidth, bitmapHeight, cropState6.stateScale, cropState6.cropRotate, cropState6.transformRotation, cropState6.scale, false, this.editState.croppedMediaEntities, false);
                            bitmapCreateBitmap2.recycle();
                            EditState editState7 = this.editState;
                            mediaEditState.croppedPaintPath = editState7.croppedPaintPath;
                            mediaEditState.croppedMediaEntities = editState7.croppedMediaEntities;
                        }
                        Bitmap bitmap7 = bitmapArr[0];
                        if (bitmap7 == null) {
                            bitmap7 = bitmap;
                        }
                        MediaController.CropState cropState7 = mediaEditState.cropState;
                        if (cropState7 == null || !cropState7.initied) {
                            bitmapCreateCroppedBitmap = bitmap7;
                            z2 = false;
                        } else {
                            bitmapCreateCroppedBitmap = createCroppedBitmap(bitmap7, cropState7, null, false);
                            z2 = true;
                        }
                        if (this.isCurrentVideo) {
                            String str3 = mediaEditState.filterPath;
                            if (str3 == null) {
                                bitmapLoadBitmap = SendMessagesHelper.createVideoThumbnailAtTime(mediaEditState.getPath(), (long) (this.videoTimelineView.getLeftProgress() * this.videoPlayer.getDuration() * 1000.0f));
                                iArr2 = null;
                            } else {
                                iArr2 = null;
                                bitmapLoadBitmap = ImageLoader.loadBitmap(str3, null, 512.0f, 512.0f, true);
                            }
                            MediaController.CropState cropState8 = mediaEditState.cropState;
                            bitmapCreateBitmap = cropState8 != null ? createCroppedBitmap(bitmapLoadBitmap, cropState8, iArr2, true) : bitmapLoadBitmap;
                            if (mediaEditState.cropState != null) {
                                bitmapLoadBitmap.recycle();
                            }
                        } else {
                            int[] iArr3 = {this.centerImage.getOrientation(), this.centerImage.getInvert()};
                            if (mediaEditState.cropState != null) {
                                bitmapCreateBitmap = createCroppedBitmap(this.centerImage.getBitmap(), mediaEditState.cropState, iArr3, true);
                            } else {
                                Bitmap bitmap8 = this.centerImage.getBitmap();
                                if (iArr3[0] != 0) {
                                    Matrix matrix = new Matrix();
                                    matrix.postRotate(iArr3[0]);
                                    int i10 = iArr3[1];
                                    if (i10 == 1) {
                                        matrix.postScale(-1.0f, 1.0f);
                                    } else if (i10 == 2) {
                                        matrix.postScale(1.0f, -1.0f);
                                    }
                                    bitmapCreateBitmap = Bitmaps.createBitmap(bitmap8, 0, 0, bitmap8.getWidth(), bitmap8.getHeight(), matrix, true);
                                } else {
                                    bitmap2 = bitmap8;
                                    z3 = false;
                                    if (!this.isCurrentVideo) {
                                        if (hasAnimatedMediaEntities()) {
                                            String string6 = FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmap2, getCompressFormat(), AndroidUtilities.getPhotoSize(), AndroidUtilities.getPhotoSize(), 87, false, 101, 101), true).toString();
                                            this.currentImagePath = string6;
                                            mediaEditState.imagePath = string6;
                                        } else {
                                            String tempFileAbsolutePath5 = getTempFileAbsolutePath();
                                            mediaEditState.imagePath = tempFileAbsolutePath5;
                                            mergeImages(tempFileAbsolutePath5, null, bitmap2, bitmapCreateCroppedBitmap, AndroidUtilities.getPhotoSize(), false);
                                        }
                                    }
                                    String tempFileAbsolutePath6 = getTempFileAbsolutePath();
                                    mediaEditState.thumbPath = tempFileAbsolutePath6;
                                    mergeImages(tempFileAbsolutePath6, null, bitmap2, bitmapCreateCroppedBitmap, 512.0f, false);
                                    if (z2 && bitmapCreateCroppedBitmap != null) {
                                        bitmapCreateCroppedBitmap.recycle();
                                    }
                                    if (z3 && bitmap2 != null) {
                                        bitmap2.recycle();
                                    }
                                    if (this.sendPhotoType == 1 && this.videoPlayer != null && this.isCurrentVideo && getAnimatedMediaEntitiesCount(false) == 1 && this.videoTimelineView.getLeftProgress() <= BitmapDescriptorFactory.HUE_RED && this.videoTimelineView.getRightProgress() >= 1.0f) {
                                        j = mediaEditState.averageDuration;
                                        long duration = this.videoPlayer.getDuration();
                                        while (j < 3000 && j < duration) {
                                            j += mediaEditState.averageDuration;
                                        }
                                        this.videoTimelineView.setRightProgress(Math.min(1.0f, j / duration));
                                    }
                                }
                            }
                        }
                        bitmap2 = bitmapCreateBitmap;
                        z3 = true;
                        if (!this.isCurrentVideo) {
                        }
                        String tempFileAbsolutePath62 = getTempFileAbsolutePath();
                        mediaEditState.thumbPath = tempFileAbsolutePath62;
                        mergeImages(tempFileAbsolutePath62, null, bitmap2, bitmapCreateCroppedBitmap, 512.0f, false);
                        if (z2) {
                            bitmapCreateCroppedBitmap.recycle();
                        }
                        if (z3) {
                            bitmap2.recycle();
                        }
                        if (this.sendPhotoType == 1) {
                            j = mediaEditState.averageDuration;
                            long duration2 = this.videoPlayer.getDuration();
                            while (j < 3000) {
                                j += mediaEditState.averageDuration;
                            }
                            this.videoTimelineView.setRightProgress(Math.min(1.0f, j / duration2));
                        }
                    }
                }
                SharedConfig.saveConfig();
                MediaController.SavedFilterState savedFilterState2 = obj;
                if (savedFilterState2 != 0) {
                    this.editState.savedFilterState = savedFilterState2;
                    mediaEditState.savedFilterState = savedFilterState2;
                }
                int i11 = this.currentEditMode;
                if (i11 == 1) {
                    mediaEditState.isCropped = true;
                    imageView = this.cropItem;
                    porterDuffColorFilter = new PorterDuffColorFilter(getThemedColor(Theme.key_chat_editMediaButton), PorterDuff.Mode.MULTIPLY);
                } else {
                    if (i11 != 2) {
                        if (i11 == 3) {
                            if (z) {
                                mediaEditState.isPainted = true;
                                imageView = this.paintItem;
                                porterDuffColorFilter = new PorterDuffColorFilter(getThemedColor(Theme.key_chat_editMediaButton), PorterDuff.Mode.MULTIPLY);
                            } else if (this.sendPhotoType == 11) {
                                mediaEditState.isPainted = true;
                            }
                        }
                        i = this.sendPhotoType;
                        if ((i != 0 || i == 4) && (photoViewerProvider = this.placeProvider) != null) {
                            photoViewerProvider.updatePhotoAtIndex(this.currentIndex);
                            if (!this.placeProvider.isPhotoChecked(this.currentIndex)) {
                                setPhotoChecked();
                            }
                        }
                        if (this.currentEditMode == 1) {
                            this.scale = Math.max(this.photoCropView.getRectSizeX() / getContainerViewWidth(), this.photoCropView.getRectSizeY() / getContainerViewHeight());
                            this.translationX = (this.photoCropView.getRectX() + (this.photoCropView.getRectSizeX() / 2.0f)) - (getContainerViewWidth() / 2);
                            this.translationY = (this.photoCropView.getRectY() + (this.photoCropView.getRectSizeY() / 2.0f)) - (getContainerViewHeight() / 2);
                            this.zoomAnimation = true;
                            this.applying = true;
                            this.photoCropView.onDisappear();
                        }
                        this.centerImage.setParentView(null);
                        this.ignoreDidSetImage = true;
                        if (!this.isCurrentVideo ? this.currentEditMode == 2 : !((i2 = this.currentEditMode) != 1 && (i2 != 0 || this.sendPhotoType != 1))) {
                            this.centerImage.setImageBitmap(bitmap);
                            this.centerImage.setOrientation(r15, true);
                            this.centerBlur.destroy();
                            this.containerView.requestLayout();
                        }
                        this.ignoreDidSetImage = r15;
                        this.centerImage.setParentView(this.containerView);
                        return;
                    }
                    mediaEditState.isFiltered = true;
                    imageView = this.tuneItem;
                    porterDuffColorFilter = new PorterDuffColorFilter(getThemedColor(Theme.key_chat_editMediaButton), PorterDuff.Mode.MULTIPLY);
                }
                imageView.setColorFilter(porterDuffColorFilter);
                i = this.sendPhotoType;
                if (i != 0) {
                    photoViewerProvider.updatePhotoAtIndex(this.currentIndex);
                    if (!this.placeProvider.isPhotoChecked(this.currentIndex)) {
                    }
                } else {
                    photoViewerProvider.updatePhotoAtIndex(this.currentIndex);
                    if (!this.placeProvider.isPhotoChecked(this.currentIndex)) {
                    }
                }
                if (this.currentEditMode == 1) {
                }
                this.centerImage.setParentView(null);
                this.ignoreDidSetImage = true;
                if (!this.isCurrentVideo) {
                    this.centerImage.setImageBitmap(bitmap);
                    this.centerImage.setOrientation(r15, true);
                    this.centerBlur.destroy();
                    this.containerView.requestLayout();
                }
                this.ignoreDidSetImage = r15;
                this.centerImage.setParentView(this.containerView);
                return;
            }
            if (i6 == 4) {
                Bitmap bitmap9 = this.maskPaintView.getBitmap();
                this.centerImage.setImageBitmap(bitmap9);
                lambda$setParentActivity$42(bitmap9);
                this.eraseBtn.setActive(false, true);
                this.restoreBtn.setActive(false, true);
                if (this.stickerMakerView != null) {
                    int orientation = this.centerImage.getOrientation();
                    StickerMakerView stickerMakerView = this.stickerMakerView;
                    int i12 = orientation - stickerMakerView.orientation;
                    if (i12 == 0) {
                        stickerMakerView.updateOutlinePath(bitmap9);
                        return;
                    }
                    int width = bitmap9.getWidth();
                    int height = bitmap9.getHeight();
                    if ((i12 / 90) % 2 != 0) {
                        i4 = width;
                        i3 = height;
                    } else {
                        i3 = width;
                        i4 = height;
                    }
                    Bitmap bitmapCreateBitmap3 = Bitmap.createBitmap(i3, i4, Bitmap.Config.ARGB_8888);
                    Canvas canvas2 = new Canvas(bitmapCreateBitmap3);
                    canvas2.translate((-width) / 2.0f, (-height) / 2.0f);
                    canvas2.rotate(i12);
                    canvas2.translate(i3 / 2.0f, i4 / 2.0f);
                    canvas2.drawBitmap(bitmap9, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, new Paint(3));
                    this.stickerMakerView.updateOutlinePath(bitmapCreateBitmap3);
                    return;
                }
                return;
            }
            iArr = null;
            arrayList = null;
            list = null;
            savedFilterState = null;
            bitmap = null;
        }
        z = false;
        if (bitmap != null) {
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:26:0x006e  */
    /* JADX WARN: Removed duplicated region for block: B:34:0x00d7  */
    /* renamed from: applyCurrentEditMode, reason: merged with bridge method [inline-methods] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void lambda$setParentActivity$42(Bitmap bitmap) {
        boolean z;
        int i;
        String tempFileAbsolutePath;
        float f;
        boolean z2;
        String str;
        PhotoViewer photoViewer;
        Bitmap bitmap2;
        Bitmap bitmap3;
        MediaController.MediaEditState mediaEditState = (MediaController.MediaEditState) this.imagesArrLocals.get(this.currentIndex);
        int[] iArr = {this.centerImage.getOrientation(), this.centerImage.getInvert()};
        MediaController.CropState cropState = mediaEditState.cropState;
        if (cropState != null) {
            bitmap = createCroppedBitmap(bitmap, cropState, iArr, true);
        } else {
            if (iArr[0] == 0) {
                z = false;
                i = this.currentEditMode;
                if ((i != 0 || i == 4) && this.sendPhotoType == 11 && !this.isCurrentVideo) {
                    if (mediaEditState.cropState != null) {
                        if (mediaEditState.paintPath != null) {
                            Bitmap bitmapCreateCroppedBitmap = createCroppedBitmap(BitmapFactory.decodeFile(mediaEditState.fullPaintPath), mediaEditState.cropState, null, false);
                            if (hasAnimatedMediaEntities()) {
                                String string = FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmap, getCompressFormat(), AndroidUtilities.getPhotoSize(), AndroidUtilities.getPhotoSize(), 87, false, 101, 101), true).toString();
                                this.currentImagePath = string;
                                mediaEditState.imagePath = string;
                            } else {
                                String tempFileAbsolutePath2 = getTempFileAbsolutePath();
                                mediaEditState.imagePath = tempFileAbsolutePath2;
                                mergeImages(tempFileAbsolutePath2, null, bitmapCreateCroppedBitmap, bitmap, AndroidUtilities.getPhotoSize(), true);
                            }
                            tempFileAbsolutePath = getTempFileAbsolutePath();
                            mediaEditState.thumbPath = tempFileAbsolutePath;
                            f = 512.0f;
                            z2 = true;
                            str = null;
                            photoViewer = this;
                            bitmap2 = bitmapCreateCroppedBitmap;
                            bitmap3 = bitmap;
                            photoViewer.mergeImages(tempFileAbsolutePath, str, bitmap2, bitmap3, f, z2);
                        }
                        Bitmap bitmap4 = bitmap;
                        String string2 = FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmap4, getCompressFormat(), AndroidUtilities.getPhotoSize(), AndroidUtilities.getPhotoSize(), 87, false, 101, 101), true).toString();
                        this.currentImagePath = string2;
                        mediaEditState.imagePath = string2;
                        mediaEditState.thumbPath = FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmap4, 512.0f, 512.0f, 70, false, 101, 101), true).toString();
                    } else {
                        if (mediaEditState.paintPath != null) {
                            Bitmap bitmapDecodeFile = BitmapFactory.decodeFile(mediaEditState.fullPaintPath);
                            if (hasAnimatedMediaEntities()) {
                                String string3 = FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmap, getCompressFormat(), AndroidUtilities.getPhotoSize(), AndroidUtilities.getPhotoSize(), 87, false, 101, 101), true).toString();
                                this.currentImagePath = string3;
                                mediaEditState.imagePath = string3;
                            } else {
                                String tempFileAbsolutePath3 = getTempFileAbsolutePath();
                                mediaEditState.imagePath = tempFileAbsolutePath3;
                                mergeImages(tempFileAbsolutePath3, null, bitmap, bitmapDecodeFile, AndroidUtilities.getPhotoSize(), false);
                            }
                            tempFileAbsolutePath = getTempFileAbsolutePath();
                            mediaEditState.thumbPath = tempFileAbsolutePath;
                            f = 512.0f;
                            z2 = false;
                            str = null;
                            photoViewer = this;
                            bitmap2 = bitmap;
                            bitmap3 = bitmapDecodeFile;
                            photoViewer.mergeImages(tempFileAbsolutePath, str, bitmap2, bitmap3, f, z2);
                        }
                        Bitmap bitmap42 = bitmap;
                        String string22 = FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmap42, getCompressFormat(), AndroidUtilities.getPhotoSize(), AndroidUtilities.getPhotoSize(), 87, false, 101, 101), true).toString();
                        this.currentImagePath = string22;
                        mediaEditState.imagePath = string22;
                        mediaEditState.thumbPath = FileLoader.getInstance(this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmap42, 512.0f, 512.0f, 70, false, 101, 101), true).toString();
                    }
                }
                if (z || bitmap == null) {
                }
                bitmap.recycle();
                return;
            }
            Matrix matrix = new Matrix();
            matrix.postRotate(iArr[0]);
            int i2 = iArr[1];
            if (i2 == 1) {
                matrix.postScale(-1.0f, 1.0f);
            } else if (i2 == 2) {
                matrix.postScale(1.0f, -1.0f);
            }
            bitmap = Bitmaps.createBitmap(bitmap, 0, 0, bitmap.getWidth(), bitmap.getHeight(), matrix, true);
        }
        z = true;
        i = this.currentEditMode;
        if (i != 0) {
            if (mediaEditState.cropState != null) {
            }
        } else if (mediaEditState.cropState != null) {
        }
        if (z) {
        }
    }

    private void applyTransformToMatrix(Matrix matrix) {
        float fLerp;
        float fLerp2;
        float fLerp3;
        float fLerp4;
        float fLerp5;
        MediaController.CropState cropState;
        if (this.imageMoveAnimation != null) {
            fLerp2 = AndroidUtilities.lerp(this.mirror, this.animateToMirror, this.animationValue);
            fLerp = AndroidUtilities.lerp(this.scale, this.animateToScale, this.animationValue);
            fLerp3 = AndroidUtilities.lerp(this.rotate, this.animateToRotate, this.animationValue);
            fLerp4 = AndroidUtilities.lerp(this.translationY, this.animateToY, this.animationValue);
            fLerp5 = AndroidUtilities.lerp(this.translationX, this.animateToX, this.animationValue);
        } else {
            fLerp = this.scale;
            fLerp2 = this.mirror;
            fLerp3 = this.rotate;
            fLerp4 = this.translationY;
            fLerp5 = this.translationX;
            if (this.animationStartTime != 0) {
                fLerp5 = this.animateToX;
                fLerp4 = this.animateToY;
                fLerp = this.animateToScale;
            }
        }
        int containerViewWidth = getContainerViewWidth();
        int containerViewHeight = getContainerViewHeight();
        matrix.preTranslate(fLerp5, fLerp4 + (this.currentEditMode != 3 ? this.currentPanTranslationY : BitmapDescriptorFactory.HUE_RED));
        matrix.preScale(fLerp, fLerp);
        matrix.preRotate(fLerp3);
        int bitmapWidth = this.centerImage.getBitmapWidth();
        int bitmapHeight = this.centerImage.getBitmapHeight();
        float f = containerViewWidth;
        float f2 = containerViewHeight;
        float fMin = Math.min(f / bitmapWidth, f2 / bitmapHeight);
        int orientation = this.cropTransform.getOrientation();
        if (orientation != 90 && orientation != 270) {
            bitmapHeight = bitmapWidth;
            bitmapWidth = bitmapHeight;
        }
        float cropPw = this.cropTransform.getCropPw();
        float cropPh = this.cropTransform.getCropPh();
        float f3 = bitmapHeight;
        float f4 = bitmapWidth;
        float f5 = f / ((int) ((cropPw + ((1.0f - cropPw) * BitmapDescriptorFactory.HUE_RED)) * f3));
        float f6 = (int) ((cropPh + ((1.0f - cropPh) * BitmapDescriptorFactory.HUE_RED)) * f4);
        if (f5 * f6 > f2) {
            f5 = f2 / f6;
        }
        if (this.sendPhotoType == 1 || this.cropTransform.hasViewTransform()) {
            TextureView textureView = this.videoTextureView;
            if (textureView != null) {
                MediaController.CropState cropState2 = this.editState.cropState;
                textureView.setScaleX((cropState2 == null || !cropState2.mirrored) ? 1.0f : -1.0f);
                FirstFrameView firstFrameView = this.firstFrameView;
                if (firstFrameView != null) {
                    firstFrameView.setScaleX(this.videoTextureView.getScaleX());
                }
            }
            MediaController.CropState cropState3 = this.editState.cropState;
            float f7 = cropState3 != null ? cropState3.cropScale : 1.0f;
            float f8 = f7 * ((f5 / fMin) / (((f7 - 1.0f) * BitmapDescriptorFactory.HUE_RED) + 1.0f));
            matrix.preTranslate(this.cropTransform.getCropAreaX() * 1.0f, this.cropTransform.getCropAreaY() * 1.0f);
            matrix.preScale(f8, f8);
            matrix.preTranslate(this.cropTransform.getCropPx() * f3 * fMin * 1.0f, this.cropTransform.getCropPy() * f4 * fMin * 1.0f);
            float rotation = this.cropTransform.getRotation() + orientation;
            if (rotation > 180.0f) {
                rotation -= 360.0f;
            }
            matrix.preRotate(rotation);
        }
        if (!this.imagesArrLocals.isEmpty() && (cropState = this.editState.cropState) != null && cropState.mirrored) {
            matrix.preScale(-1.0f, 1.0f);
        }
        if (fLerp2 > BitmapDescriptorFactory.HUE_RED) {
            matrix.preScale(1.0f - (2.0f * fLerp2), 1.0f);
            matrix.preSkew(BitmapDescriptorFactory.HUE_RED, 4.0f * fLerp2 * (1.0f - fLerp2) * 0.25f);
        }
    }

    private void applyTransformToOutline(Canvas canvas) {
        float fLerp;
        float fLerp2;
        float fLerp3;
        float fLerp4;
        float fLerp5;
        float f;
        float f2;
        float f3;
        MediaController.CropState cropState;
        if (this.imageMoveAnimation != null) {
            fLerp2 = AndroidUtilities.lerp(this.mirror, this.animateToMirror, this.animationValue);
            fLerp = AndroidUtilities.lerp(this.scale, this.animateToScale, this.animationValue);
            fLerp3 = AndroidUtilities.lerp(this.rotate, this.animateToRotate, this.animationValue);
            fLerp4 = AndroidUtilities.lerp(this.translationY, this.animateToY, this.animationValue);
            fLerp5 = AndroidUtilities.lerp(this.translationX, this.animateToX, this.animationValue);
        } else {
            fLerp = this.scale;
            fLerp2 = this.mirror;
            fLerp3 = this.rotate;
            fLerp4 = this.translationY;
            fLerp5 = this.translationX;
            if (this.animationStartTime != 0) {
                fLerp5 = this.animateToX;
                fLerp4 = this.animateToY;
                fLerp = this.animateToScale;
            }
        }
        int containerViewWidth = getContainerViewWidth();
        int containerViewHeight = getContainerViewHeight();
        canvas.translate(getAdditionX(this.currentEditMode), getAdditionY(this.currentEditMode));
        canvas.translate(fLerp5, fLerp4 + (this.currentEditMode != 3 ? this.currentPanTranslationY : BitmapDescriptorFactory.HUE_RED));
        canvas.scale(fLerp, fLerp);
        canvas.rotate(fLerp3);
        int bitmapWidth = this.centerImage.getBitmapWidth();
        int bitmapHeight = this.centerImage.getBitmapHeight();
        float f4 = containerViewWidth;
        float f5 = bitmapWidth;
        float f6 = f4 / f5;
        float f7 = containerViewHeight;
        float f8 = bitmapHeight;
        float f9 = f7 / f8;
        float fMin = Math.min(f6, f9);
        int orientation = this.cropTransform.getOrientation();
        if (orientation == 90 || orientation == 270) {
            bitmapHeight = bitmapWidth;
            bitmapWidth = bitmapHeight;
        }
        float cropPw = this.cropTransform.getCropPw();
        float cropPh = this.cropTransform.getCropPh();
        float f10 = bitmapWidth;
        float f11 = bitmapHeight;
        float f12 = (int) ((cropPw + ((1.0f - cropPw) * BitmapDescriptorFactory.HUE_RED)) * f10);
        float f13 = f4 / f12;
        float f14 = (int) ((cropPh + ((1.0f - cropPh) * BitmapDescriptorFactory.HUE_RED)) * f11);
        if (f13 * f14 > f7) {
            f13 = f7 / f14;
        }
        float f15 = fLerp2;
        if (this.sendPhotoType != 1 && ((this.currentEditMode != 1 || this.switchingToMode == 0) && this.editState.cropState != null)) {
            float f16 = f12 * f13;
            float f17 = f14 * f13;
            if (f6 * f8 > f7) {
                f6 = f9;
            }
            float f18 = f16 + ((((f5 * f6) / fLerp) - f16) * BitmapDescriptorFactory.HUE_RED);
            float f19 = f17 + ((((f8 * f6) / fLerp) - f17) * BitmapDescriptorFactory.HUE_RED);
            canvas.clipRect((-f18) / 2.0f, (-f19) / 2.0f, f18 / 2.0f, f19 / 2.0f);
        }
        if (this.sendPhotoType == 1 || this.cropTransform.hasViewTransform()) {
            TextureView textureView = this.videoTextureView;
            if (textureView != null) {
                MediaController.CropState cropState2 = this.editState.cropState;
                textureView.setScaleX((cropState2 == null || !cropState2.mirrored) ? 1.0f : -1.0f);
                FirstFrameView firstFrameView = this.firstFrameView;
                if (firstFrameView != null) {
                    firstFrameView.setScaleX(this.videoTextureView.getScaleX());
                }
            }
            MediaController.CropState cropState3 = this.editState.cropState;
            if (cropState3 != null) {
                f2 = cropState3.cropScale;
                f = 1.0f;
            } else {
                f = 1.0f;
                f2 = 1.0f;
            }
            float f20 = f2 * ((f13 / fMin) / (((f2 - f) * BitmapDescriptorFactory.HUE_RED) + f));
            canvas.translate(this.cropTransform.getCropAreaX() * f, this.cropTransform.getCropAreaY() * f);
            canvas.scale(f20, f20);
            canvas.translate(this.cropTransform.getCropPx() * f10 * fMin * f, this.cropTransform.getCropPy() * f11 * fMin * f);
            float rotation = this.cropTransform.getRotation() + orientation;
            if (rotation > 180.0f) {
                rotation -= 360.0f;
            }
            canvas.rotate(rotation);
        }
        if (this.imagesArrLocals.isEmpty() || (cropState = this.editState.cropState) == null || !cropState.mirrored) {
            f3 = 1.0f;
        } else {
            f3 = 1.0f;
            canvas.scale(-1.0f, 1.0f);
        }
        if (f15 > BitmapDescriptorFactory.HUE_RED) {
            canvas.scale(f3 - (f15 * 2.0f), f3);
            canvas.skew(BitmapDescriptorFactory.HUE_RED, 4.0f * f15 * (f3 - f15) * 0.25f);
        }
    }

    private void calculateEstimatedVideoSize(boolean z, boolean z2) {
        if (z) {
            long j = (long) (((z2 ? 0L : this.audioFramesSize) + this.videoFramesSize) * (this.estimatedDuration / this.videoDuration));
            this.estimatedSize = j + ((j / 32768) * 16);
            return;
        }
        float f = this.originalSize;
        float f2 = this.estimatedDuration / this.videoDuration;
        long j2 = (long) (f * f2);
        this.estimatedSize = j2;
        if (z2) {
            this.estimatedSize = j2 - ((long) (this.audioFramesSize * f2));
        }
    }

    private Size calculateResultVideoSize() {
        int iRound;
        int i;
        if (this.compressionsCount == 1) {
            return new Size(this.originalWidth, this.originalHeight);
        }
        int i2 = this.selectedCompression;
        float f = (i2 != 0 ? i2 != 1 ? i2 != 2 ? 1920.0f : 1280.0f : 854.0f : 480.0f) / (this.originalWidth > this.originalHeight ? this.originalWidth : this.originalHeight);
        if (this.selectedCompression != this.compressionsCount - 1 || f < 1.0f) {
            int iRound2 = Math.round((this.originalWidth * f) / 2.0f) * 2;
            iRound = Math.round((this.originalHeight * f) / 2.0f) * 2;
            i = iRound2;
        } else {
            i = this.originalWidth;
            iRound = this.originalHeight;
        }
        int i3 = i % 4;
        if (i3 != 0 || iRound % 4 != 0) {
            i = (i - i3) - (iRound % 4);
        }
        return new Size(i, iRound);
    }

    private boolean canDoubleTapSeekVideo(MotionEvent motionEvent) {
        PhotoViewerWebView photoViewerWebView;
        if (this.videoPlayer == null && ((photoViewerWebView = this.photoViewerWebView) == null || !photoViewerWebView.isControllable())) {
            return false;
        }
        boolean z = motionEvent.getX() >= ((float) ((getContainerViewWidth() / 3) * 2));
        long currentVideoPosition = getCurrentVideoPosition();
        long videoDuration = getVideoDuration();
        if (currentVideoPosition == -9223372036854775807L || videoDuration <= 15000) {
            return false;
        }
        return !z || videoDuration - currentVideoPosition > 10000;
    }

    private boolean canSendMediaToParentChatActivity() {
        TLRPC.Chat chat;
        ChatActivity chatActivity = this.parentChatActivity;
        return (chatActivity == null || (chatActivity.currentUser == null && ((chat = chatActivity.currentChat) == null || ChatObject.isNotInChat(chat) || (!ChatObject.canSendPhoto(this.parentChatActivity.currentChat) && !ChatObject.canSendVideo(this.parentChatActivity.currentChat))))) ? false : true;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void cancelFlashAnimations() {
        View view = this.flashView;
        if (view != null) {
            view.animate().setListener(null).cancel();
            this.flashView.setAlpha(BitmapDescriptorFactory.HUE_RED);
        }
        AnimatorSet animatorSet = this.flashAnimator;
        if (animatorSet != null) {
            animatorSet.cancel();
            this.flashAnimator = null;
        }
        PhotoCropView photoCropView = this.photoCropView;
        if (photoCropView != null) {
            photoCropView.cancelThumbAnimation();
        }
    }

    private void cancelMoveZoomAnimation() {
        AnimatorSet animatorSet = this.imageMoveAnimation;
        if (animatorSet == null) {
            return;
        }
        float f = this.scale;
        float f2 = this.animateToScale - f;
        float f3 = this.animationValue;
        float f4 = f + (f2 * f3);
        float f5 = this.translationX;
        float f6 = f5 + ((this.animateToX - f5) * f3);
        float f7 = this.translationY;
        float f8 = f7 + ((this.animateToY - f7) * f3);
        float f9 = this.rotate;
        float f10 = f9 + ((this.animateToRotate - f9) * f3);
        animatorSet.cancel();
        this.scale = f4;
        this.translationX = f6;
        this.translationY = f8;
        this.animationStartTime = 0L;
        this.rotate = f10;
        updateMinMax(f4);
        this.zoomAnimation = false;
        this.containerView.invalidate();
    }

    private void cancelStickerClippingMode() {
        if (this.sendPhotoType == 11 && this.cutOutBtn.isCancelState()) {
            this.cutOutBtn.setCutOutState(true);
            showEditStickerMode(true, true);
            this.stickerMakerView.disableClippingMode();
            this.containerView.invalidate();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void cancelVideoPlayRunnable() {
        Runnable runnable = this.videoPlayRunnable;
        if (runnable != null) {
            AndroidUtilities.cancelRunOnUIThread(runnable);
            this.videoPlayRunnable = null;
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void captureCurrentFrame() {
        TextureView textureView;
        if (this.captureFrameAtTime == -1 || (textureView = this.videoTextureView) == null) {
            return;
        }
        this.captureFrameAtTime = -1L;
        final Bitmap bitmap = textureView.getBitmap();
        this.flashView.animate().alpha(1.0f).setInterpolator(CubicBezierInterpolator.EASE_BOTH).setDuration(85L).setListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.41

            /* renamed from: org.telegram.ui.PhotoViewer$41$1, reason: invalid class name */
            class AnonymousClass1 extends AnimatorListenerAdapter {
                AnonymousClass1() {
                }

                /* JADX INFO: Access modifiers changed from: private */
                public /* synthetic */ void lambda$onAnimationEnd$0() {
                    PhotoViewer.this.manuallyPaused = false;
                    if (PhotoViewer.this.videoPlayer != null) {
                        PhotoViewer.this.videoPlayer.play();
                    }
                    PhotoViewer.this.videoPlayRunnable = null;
                }

                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                public void onAnimationCancel(Animator animator) {
                    PhotoViewer.this.flashAnimator = null;
                }

                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                public void onAnimationEnd(Animator animator) {
                    if (PhotoViewer.this.flashAnimator == null) {
                        return;
                    }
                    AndroidUtilities.runOnUIThread(PhotoViewer.this.videoPlayRunnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$41$1$$ExternalSyntheticLambda0
                        @Override // java.lang.Runnable
                        public final void run() {
                            this.f$0.lambda$onAnimationEnd$0();
                        }
                    }, 860L);
                }
            }

            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
            public void onAnimationEnd(Animator animator) {
                PhotoViewer.this.photoCropView.setVideoThumb(bitmap, 0);
                PhotoViewer.this.flashAnimator = new AnimatorSet();
                PhotoViewer.this.flashAnimator.playTogether(ObjectAnimator.ofFloat(PhotoViewer.this.flashView, (Property<View, Float>) PhotoViewer.this.FLASH_VIEW_VALUE, BitmapDescriptorFactory.HUE_RED));
                PhotoViewer.this.flashAnimator.setDuration(85L);
                PhotoViewer.this.flashAnimator.setInterpolator(CubicBezierInterpolator.EASE_OUT);
                PhotoViewer.this.flashAnimator.addListener(new AnonymousClass1());
                PhotoViewer.this.flashAnimator.start();
            }
        }).start();
    }

    private boolean checkAnimation() {
        if (this.animationInProgress != 0) {
            invalidateBlur();
            if (Math.abs(this.transitionAnimationStartTime - System.currentTimeMillis()) >= 500) {
                Runnable runnable = this.animationEndRunnable;
                if (runnable != null) {
                    runnable.run();
                    this.animationEndRunnable = null;
                }
                this.animationInProgress = 0;
            }
        }
        return this.animationInProgress != 0;
    }

    private void checkBufferedProgress(float f) {
        MessageObject messageObject;
        TLRPC.Document document;
        if (!this.isStreaming || this.parentActivity == null || this.streamingAlertShown || this.videoPlayer == null || (messageObject = this.currentMessageObject) == null || (document = messageObject.getDocument()) == null || this.currentMessageObject.getDuration() < 20.0d) {
            return;
        }
        boolean z = document.size >= 2147483648L;
        if ((DownloadController.getInstance(this.currentAccount).getAutodownloadMask() & 4) == 0 || f >= 0.9f) {
            return;
        }
        long j = document.size;
        if (j * f >= 5242880.0f || (f >= 0.5f && j >= 2097152)) {
            if (Math.abs(SystemClock.elapsedRealtime() - this.startedPlayTime) >= (z ? 10000 : 3000)) {
                if (this.videoPlayer.getDuration() == -9223372036854775807L) {
                    Toast.makeText(this.parentActivity, LocaleController.getString(R.string.VideoDoesNotSupportStreaming), 1).show();
                }
                this.streamingAlertShown = true;
            }
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void checkChangedTextureView(boolean z) {
        if (z) {
            TextureView textureView = this.changedTextureView;
            if (textureView == null) {
                return;
            }
            textureView.getViewTreeObserver().addOnPreDrawListener(new AnonymousClass9());
            this.changedTextureView.invalidate();
            return;
        }
        if (this.waitingForFirstTextureUpload == 2) {
            ImageView imageView = this.textureImageView;
            if (imageView != null) {
                imageView.setVisibility(4);
                this.textureImageView.setImageDrawable(null);
                Bitmap bitmap = this.currentBitmap;
                if (bitmap != null) {
                    bitmap.recycle();
                    this.currentBitmap = null;
                }
            }
            this.switchingInlineMode = false;
            if (Build.VERSION.SDK_INT >= 21) {
                final View view = this.usedSurfaceView ? this.videoSurfaceView : this.videoTextureView;
                AspectRatioFrameLayout aspectRatioFrameLayout = this.aspectRatioFrameLayout;
                if (aspectRatioFrameLayout == null) {
                    return;
                }
                aspectRatioFrameLayout.getLocationInWindow(this.pipPosition);
                this.pipPosition[1] = (int) (r5[1] - this.containerView.getTranslationY());
                ImageView imageView2 = this.textureImageView;
                if (imageView2 != null) {
                    imageView2.setTranslationX(imageView2.getTranslationX() + getLeftInset());
                }
                if (view != null) {
                    view.setTranslationX((view.getTranslationX() + getLeftInset()) - this.aspectRatioFrameLayout.getX());
                }
                FirstFrameView firstFrameView = this.firstFrameView;
                if (firstFrameView != null) {
                    firstFrameView.setTranslationX(view.getTranslationX());
                }
                ValueAnimator valueAnimatorOfFloat = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f);
                valueAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda114
                    @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                    public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                        this.f$0.lambda$checkChangedTextureView$3(valueAnimator);
                    }
                });
                float x = this.usedSurfaceView ? BitmapDescriptorFactory.HUE_RED : this.pipPosition[0] - this.aspectRatioFrameLayout.getX();
                float y = this.usedSurfaceView ? BitmapDescriptorFactory.HUE_RED : this.pipPosition[1] - this.aspectRatioFrameLayout.getY();
                AnimatorSet animatorSet = new AnimatorSet();
                ArrayList arrayList = new ArrayList();
                arrayList.add(valueAnimatorOfFloat);
                ImageView imageView3 = this.textureImageView;
                Property property = View.SCALE_X;
                arrayList.add(ObjectAnimator.ofFloat(imageView3, (Property<ImageView, Float>) property, 1.0f));
                ImageView imageView4 = this.textureImageView;
                Property property2 = View.SCALE_Y;
                arrayList.add(ObjectAnimator.ofFloat(imageView4, (Property<ImageView, Float>) property2, 1.0f));
                ImageView imageView5 = this.textureImageView;
                Property property3 = View.TRANSLATION_X;
                arrayList.add(ObjectAnimator.ofFloat(imageView5, (Property<ImageView, Float>) property3, this.usedSurfaceView ? BitmapDescriptorFactory.HUE_RED : this.pipPosition[0]));
                ImageView imageView6 = this.textureImageView;
                Property property4 = View.TRANSLATION_Y;
                arrayList.add(ObjectAnimator.ofFloat(imageView6, (Property<ImageView, Float>) property4, this.usedSurfaceView ? BitmapDescriptorFactory.HUE_RED : this.pipPosition[1]));
                arrayList.add(ObjectAnimator.ofFloat(view, (Property<View, Float>) property, 1.0f));
                arrayList.add(ObjectAnimator.ofFloat(view, (Property<View, Float>) property2, 1.0f));
                arrayList.add(ObjectAnimator.ofFloat(view, (Property<View, Float>) property3, x));
                arrayList.add(ObjectAnimator.ofFloat(view, (Property<View, Float>) property4, y));
                arrayList.add(ObjectAnimator.ofInt(this.backgroundDrawable, (Property<BackgroundDrawable, Integer>) AnimationProperties.COLOR_DRAWABLE_ALPHA, 255));
                FirstFrameView firstFrameView2 = this.firstFrameView;
                if (firstFrameView2 != null) {
                    arrayList.add(ObjectAnimator.ofFloat(firstFrameView2, (Property<FirstFrameView, Float>) property, 1.0f));
                    arrayList.add(ObjectAnimator.ofFloat(this.firstFrameView, (Property<FirstFrameView, Float>) property2, 1.0f));
                    arrayList.add(ObjectAnimator.ofFloat(this.firstFrameView, (Property<FirstFrameView, Float>) property3, x));
                    arrayList.add(ObjectAnimator.ofFloat(this.firstFrameView, (Property<FirstFrameView, Float>) property4, y));
                }
                float f = PipVideoOverlay.getPipRect(false, this.aspectRatioFrameLayout.getAspectRatio()).width;
                view.getWidth();
                ValueAnimator valueAnimatorOfFloat2 = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f);
                valueAnimatorOfFloat2.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda115
                    @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                    public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                        this.f$0.lambda$checkChangedTextureView$4(view, valueAnimator);
                    }
                });
                arrayList.add(valueAnimatorOfFloat2);
                animatorSet.playTogether(arrayList);
                DecelerateInterpolator decelerateInterpolator2 = new DecelerateInterpolator();
                animatorSet.setInterpolator(decelerateInterpolator2);
                animatorSet.setDuration(250L);
                SurfaceView surfaceView = this.videoSurfaceView;
                if (surfaceView != null) {
                    surfaceView.setVisibility(0);
                }
                animatorSet.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.10
                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationEnd(Animator animator) {
                        PhotoViewer.this.pipAnimationInProgress = false;
                        view.setOutlineProvider(null);
                        if (PhotoViewer.this.textureImageView != null) {
                            PhotoViewer.this.textureImageView.setOutlineProvider(null);
                        }
                        if (PhotoViewer.this.firstFrameView != null) {
                            PhotoViewer.this.firstFrameView.setOutlineProvider(null);
                        }
                        if (PhotoViewer.this.videoSurfaceView != null) {
                            PhotoViewer.this.videoSurfaceView.setVisibility(0);
                        }
                    }
                });
                animatorSet.start();
                toggleActionBar(true, true, new ActionBarToggleParams().enableStatusBarAnimation(false).enableTranslationAnimation(false).animationDuration(MediaDataController.MAX_LINKS_COUNT).animationInterpolator(decelerateInterpolator2));
            } else {
                toggleActionBar(true, false);
            }
            this.waitingForFirstTextureUpload = 0;
        }
    }

    private boolean checkInlinePermissions() {
        Activity activity = this.parentActivity;
        if (activity == null) {
            return false;
        }
        if (Build.VERSION.SDK_INT < 23 || PipUtils.checkAnyPipPermissions(activity)) {
            return true;
        }
        AlertsCreator.createDrawOverlayPermissionDialog(this.parentActivity, null, true).show();
        return false;
    }

    /* JADX WARN: Removed duplicated region for block: B:10:0x0022 A[PHI: r3
      0x0022: PHI (r3v4 float) = (r3v2 float), (r3v3 float) binds: [B:9:0x0020, B:12:0x0028] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:4:0x0011 A[PHI: r3
      0x0011: PHI (r3v5 float) = (r3v0 float), (r3v1 float) binds: [B:3:0x000f, B:6:0x0017] A[DONT_GENERATE, DONT_INLINE]] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void checkMinMax(boolean z) {
        float f = this.translationX;
        float f2 = this.translationY;
        updateMinMax(this.scale);
        float f3 = this.translationX;
        float f4 = this.minX;
        if (f3 < f4) {
            f = f4;
        } else {
            f4 = this.maxX;
            if (f3 > f4) {
            }
        }
        float f5 = this.translationY;
        float f6 = this.minY;
        if (f5 < f6) {
            f2 = f6;
        } else {
            f6 = this.maxY;
            if (f5 > f6) {
            }
        }
        animateTo(this.scale, f, f2, z);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void checkProgress(final int i, boolean z, final boolean z2) {
        File file;
        boolean z3;
        FileLoader.FileResolver fileResolver;
        MessageObject messageObject;
        boolean z4;
        boolean zShouldIndexAutoPlayed;
        PhotoProgressView photoProgressView;
        File pathToAttach;
        File pathToAttach2;
        File file2;
        boolean z5;
        AnimatedFileDrawable animatedFileDrawable;
        int i2 = this.currentIndex;
        int i3 = i == 1 ? i2 + 1 : i == 2 ? i2 - 1 : i2;
        boolean z6 = false;
        if (this.currentFileNames[i] == null) {
            if (!this.imagesArrLocals.isEmpty() && i3 >= 0 && i3 < this.imagesArrLocals.size()) {
                Object obj = this.imagesArrLocals.get(i3);
                if (obj instanceof MediaController.PhotoEntry) {
                    z6 = ((MediaController.PhotoEntry) obj).isVideo;
                }
            }
            PhotoProgressView[] photoProgressViewArr = this.photoProgressViews;
            if (z6) {
                photoProgressViewArr[i].setBackgroundState(3, z2, true);
                return;
            } else {
                photoProgressViewArr[i].setBackgroundState(-1, z2, true);
                return;
            }
        }
        boolean zHasBitmap = (i == 0 && i2 == 0 && (animatedFileDrawable = this.currentAnimation) != null) ? animatedFileDrawable.hasBitmap() : false;
        File file3 = null;
        if (this.currentMessageObject != null) {
            if (i3 < 0 || i3 >= this.imagesArr.size()) {
                photoProgressView = this.photoProgressViews[i];
            } else {
                MessageObject messageObject2 = (MessageObject) this.imagesArr.get(i3);
                zShouldIndexAutoPlayed = shouldMessageObjectAutoPlayed(messageObject2);
                if (this.sharedMediaType != 1 || messageObject2.canPreviewDocument()) {
                    file = !TextUtils.isEmpty(messageObject2.messageOwner.attachPath) ? new File(messageObject2.messageOwner.attachPath) : null;
                    if ((MessageObject.getMedia(messageObject2.messageOwner) instanceof TLRPC.TL_messageMediaWebPage) && MessageObject.getMedia(messageObject2.messageOwner).webpage != null && MessageObject.getMedia(messageObject2.messageOwner).webpage.document == null) {
                        final TLObject fileLocation = getFileLocation(i3, null);
                        fileResolver = new FileLoader.FileResolver() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda67
                            @Override // org.telegram.messenger.FileLoader.FileResolver
                            public final File getFile() {
                                return this.f$0.lambda$checkProgress$126(fileLocation);
                            }
                        };
                    } else {
                        final TLRPC.Message message = messageObject2.messageOwner;
                        fileResolver = new FileLoader.FileResolver() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda68
                            @Override // org.telegram.messenger.FileLoader.FileResolver
                            public final File getFile() {
                                return this.f$0.lambda$checkProgress$127(message);
                            }
                        };
                    }
                    if (messageObject2.isVideo()) {
                        messageObject = messageObject2;
                        z4 = (SharedConfig.streamMedia && messageObject2.canStreamVideo() && !DialogObject.isEncryptedDialog(messageObject2.getDialogId())) || messageObject2.hasVideoQualities();
                        z3 = true;
                    } else {
                        messageObject = messageObject2;
                        z4 = false;
                        z3 = false;
                    }
                } else {
                    photoProgressView = this.photoProgressViews[i];
                }
            }
            photoProgressView.setBackgroundState(-1, z2, true);
            return;
        }
        if (this.currentBotInlineResult != null) {
            if (i3 < 0 || i3 >= this.imagesArrLocals.size()) {
                photoProgressView = this.photoProgressViews[i];
                photoProgressView.setBackgroundState(-1, z2, true);
                return;
            }
            TLRPC.BotInlineResult botInlineResult = (TLRPC.BotInlineResult) this.imagesArrLocals.get(i3);
            if (botInlineResult.type.equals(MediaStreamTrack.VIDEO_TRACK_KIND) || MessageObject.isVideoDocument(botInlineResult.document)) {
                if (botInlineResult.document != null) {
                    file2 = FileLoader.getInstance(this.currentAccount).getPathToAttach(botInlineResult.document);
                } else if (botInlineResult.content instanceof TLRPC.TL_webDocument) {
                    file2 = new File(FileLoader.getDirectory(4), Utilities.MD5(botInlineResult.content.url) + "." + ImageLoader.getHttpUrlExtension(botInlineResult.content.url, "mp4"));
                } else {
                    file2 = null;
                }
                z5 = true;
            } else {
                file2 = botInlineResult.document != null ? new File(FileLoader.getDirectory(3), this.currentFileNames[i]) : botInlineResult.photo != null ? new File(FileLoader.getDirectory(0), this.currentFileNames[i]) : null;
                z5 = false;
            }
            file = file2;
            z3 = z5;
            fileResolver = null;
            messageObject = null;
            z4 = false;
            file3 = new File(FileLoader.getDirectory(4), this.currentFileNames[i]);
            zShouldIndexAutoPlayed = false;
        } else if (this.currentFileLocation != null) {
            if (i3 < 0 || i3 >= this.imagesArrLocationsVideo.size()) {
                photoProgressView = this.photoProgressViews[i];
                photoProgressView.setBackgroundState(-1, z2, true);
                return;
            }
            ImageLocation imageLocation = (ImageLocation) this.imagesArrLocationsVideo.get(i3);
            if (imageLocation != null) {
                pathToAttach = FileLoader.getInstance(this.currentAccount).getPathToAttach(imageLocation.location, getFileLocationExt(imageLocation), false);
                pathToAttach2 = FileLoader.getInstance(this.currentAccount).getPathToAttach(imageLocation.location, getFileLocationExt(imageLocation), true);
                file = pathToAttach;
                fileResolver = null;
                messageObject = null;
                zShouldIndexAutoPlayed = false;
                z4 = false;
                z3 = false;
                file3 = pathToAttach2;
            }
            file = null;
            fileResolver = null;
            messageObject = null;
            zShouldIndexAutoPlayed = false;
            z4 = false;
            z3 = false;
        } else if (this.currentSecureDocument != null) {
            if (i3 < 0 || i3 >= this.secureDocuments.size()) {
                photoProgressView = this.photoProgressViews[i];
                photoProgressView.setBackgroundState(-1, z2, true);
                return;
            }
            SecureDocument secureDocument = (SecureDocument) this.secureDocuments.get(i3);
            pathToAttach = FileLoader.getInstance(this.currentAccount).getPathToAttach(secureDocument, true);
            pathToAttach2 = FileLoader.getInstance(this.currentAccount).getPathToAttach(secureDocument, false);
            file = pathToAttach;
            fileResolver = null;
            messageObject = null;
            zShouldIndexAutoPlayed = false;
            z4 = false;
            z3 = false;
            file3 = pathToAttach2;
        } else if (this.currentPathObject != null) {
            file = new File(FileLoader.getDirectory(3), this.currentFileNames[i]);
            fileResolver = null;
            messageObject = null;
            zShouldIndexAutoPlayed = false;
            z4 = false;
            z3 = false;
            file3 = new File(FileLoader.getDirectory(4), this.currentFileNames[i]);
        } else {
            PageBlocksAdapter pageBlocksAdapter = this.pageBlocksAdapter;
            if (pageBlocksAdapter != null) {
                file = pageBlocksAdapter.getFile(i3);
                z3 = this.pageBlocksAdapter.isVideo(i3) || this.pageBlocksAdapter.isHardwarePlayer(i3);
                fileResolver = null;
                messageObject = null;
                z4 = false;
                zShouldIndexAutoPlayed = shouldIndexAutoPlayed(i3);
            }
            file = null;
            fileResolver = null;
            messageObject = null;
            zShouldIndexAutoPlayed = false;
            z4 = false;
            z3 = false;
        }
        boolean z7 = !(i == 0 && this.dontAutoPlay) && zShouldIndexAutoPlayed;
        final boolean z8 = zHasBitmap;
        final File file4 = file;
        final File file5 = file3;
        final FileLoader.FileResolver fileResolver2 = fileResolver;
        final MessageObject messageObject3 = messageObject;
        final boolean z9 = z4;
        final boolean z10 = z3;
        final boolean z11 = z7;
        Utilities.globalQueue.postRunnable(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda69
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$checkProgress$129(z8, file4, file5, fileResolver2, i, messageObject3, z9, z10, z11, z2);
            }
        });
    }

    private void chooseQuality(int i) throws NumberFormatException {
        VideoPlayer videoPlayer = this.videoPlayer;
        if (videoPlayer != null) {
            videoPlayer.setSelectedQuality(i);
        }
        if (i == -1) {
            VideoPlayer.saveQuality(null, this.currentMessageObject);
        } else {
            VideoPlayer videoPlayer2 = this.videoPlayer;
            if (videoPlayer2 != null) {
                VideoPlayer.saveQuality(videoPlayer2.getQuality(i), this.currentMessageObject);
            }
        }
        updateQualityItems();
        this.videoItem.toggleSubMenu();
        try {
            CastSync.check(0);
            if (ChromecastController.getInstance().isCasting()) {
                ChromecastController.getInstance().setCurrentMediaAndCastIfNeeded(getCurrentChromecastMedia());
            }
            VideoPlayer videoPlayer3 = this.videoPlayer;
            if (videoPlayer3 != null) {
                CastSync.setPlaying(videoPlayer3.isPlaying());
            }
        } catch (Exception e) {
            FileLog.e(e);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void chooseSpeed(float f, boolean z, boolean z2) {
        SharedPreferences.Editor editorPutFloat;
        if (f != this.currentVideoSpeed) {
            this.currentVideoSpeed = f;
            if (this.currentMessageObject != null) {
                SharedPreferences sharedPreferences = ApplicationLoader.applicationContext.getSharedPreferences("playback_speed", 0);
                float fAbs = Math.abs(this.currentVideoSpeed - 1.0f);
                SharedPreferences.Editor editorEdit = sharedPreferences.edit();
                if (fAbs < 0.001f) {
                    editorPutFloat = editorEdit.remove("speed" + this.currentMessageObject.getDialogId() + "_" + this.currentMessageObject.getId());
                } else {
                    editorPutFloat = editorEdit.putFloat("speed" + this.currentMessageObject.getDialogId() + "_" + this.currentMessageObject.getId(), this.currentVideoSpeed);
                }
                editorPutFloat.commit();
            }
            VideoPlayer videoPlayer = this.videoPlayer;
            if (videoPlayer != null) {
                videoPlayer.setPlaybackSpeed(this.currentVideoSpeed);
            }
            PhotoViewerWebView photoViewerWebView = this.photoViewerWebView;
            if (photoViewerWebView != null) {
                photoViewerWebView.setPlaybackSpeed(this.currentVideoSpeed);
            }
        }
        setMenuItemIcon(true, z);
        if (z2) {
            this.videoItem.toggleSubMenu();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void closeCaptionEnter(boolean z) {
        int i = this.currentIndex;
        if (i < 0 || i >= this.imagesArrLocals.size() || !isCaptionOpen()) {
            return;
        }
        if (z) {
            applyCaption();
        }
        getCaptionView().onBackPressed();
    }

    private void closePaintMode() {
        this.photoPaintView.maybeShowDismissalAlert(this, this.parentActivity, new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda108
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$closePaintMode$112();
            }
        });
    }

    private void createAdButtonView() {
        if (this.adButtonView != null) {
            return;
        }
        FrameLayout frameLayout = new FrameLayout(this.activityContext);
        this.adButtonView = frameLayout;
        frameLayout.setBackground(Theme.createRadSelectorDrawable(620756991, 369098751, 8, 8));
        ScaleStateListAnimator.apply(this.adButtonView, 0.05f, 1.25f);
        TextView textView = new TextView(this.activityContext);
        this.adButtonTextView = textView;
        textView.setTextSize(1, 14.0f);
        this.adButtonTextView.setTextColor(-1);
        this.adButtonTextView.setTypeface(AndroidUtilities.bold());
        this.adButtonView.addView(this.adButtonTextView, LayoutHelper.createFrame(-2, -2, 17));
        this.adButtonView.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda149
            @Override // android.view.View.OnClickListener
            public final void onClick(View view) {
                this.f$0.lambda$createAdButtonView$154(view);
            }
        });
    }

    private void createCropView() {
        if (this.photoCropView != null) {
            return;
        }
        PhotoCropView photoCropView = new PhotoCropView(this.activityContext, this.resourcesProvider);
        this.photoCropView = photoCropView;
        photoCropView.setVisibility(8);
        this.photoCropView.onDisappear();
        this.containerView.addView(this.photoCropView, this.containerView.indexOfChild(this.videoTimelineViewContainer) - 1, LayoutHelper.createFrame(-1, -1.0f, 51, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 48.0f));
        this.photoCropView.setDelegate(new AnonymousClass58());
    }

    public static Bitmap createCroppedBitmap(Bitmap bitmap, MediaController.CropState cropState, int[] iArr, boolean z) {
        int i;
        int i2;
        try {
            int i3 = 0;
            int i4 = (cropState.transformRotation + (iArr != null ? iArr[0] : 0)) % 360;
            if (iArr != null && iArr.length > 1) {
                i3 = iArr[1];
            }
            int width = bitmap.getWidth();
            int height = bitmap.getHeight();
            if (i4 == 90 || i4 == 270) {
                i = width;
                i2 = height;
            } else {
                i2 = width;
                i = height;
            }
            float f = i2;
            float f2 = i;
            Bitmap bitmapCreateBitmap = Bitmap.createBitmap((int) (cropState.cropPw * f), (int) (cropState.cropPh * f2), Bitmap.Config.ARGB_8888);
            Matrix matrix = new Matrix();
            matrix.postTranslate((-width) / 2, (-height) / 2);
            if (z && cropState.mirrored) {
                if (i4 == 90 || i4 == 270) {
                    matrix.postScale(1.0f, -1.0f);
                } else {
                    matrix.postScale(-1.0f, 1.0f);
                }
            }
            if (i3 == 1) {
                matrix.postScale(-1.0f, 1.0f);
            } else if (i3 == 2) {
                matrix.postScale(1.0f, -1.0f);
            }
            matrix.postRotate(cropState.cropRotate + i4);
            matrix.postTranslate(cropState.cropPx * f, cropState.cropPy * f2);
            float f3 = cropState.cropScale;
            matrix.postScale(f3, f3);
            matrix.postTranslate(r10 / 2, r11 / 2);
            new Canvas(bitmapCreateBitmap).drawBitmap(bitmap, matrix, new Paint(2));
            return bitmapCreateBitmap;
        } catch (Throwable th) {
            FileLog.e(th);
            return null;
        }
    }

    private void createMaskPaintView() {
        MediaController.CropState cropState;
        if (this.maskPaintView != null) {
            return;
        }
        if (this.sendPhotoType == 1) {
            cropState = new MediaController.CropState();
            cropState.transformRotation = this.cropTransform.getOrientation();
        } else {
            cropState = this.editState.cropState;
        }
        MediaController.CropState cropState2 = cropState;
        int bitmapWidth = this.centerImage.getBitmapWidth();
        int bitmapHeight = this.centerImage.getBitmapHeight();
        Bitmap.Config config = Bitmap.Config.ARGB_8888;
        Bitmap bitmapCreateBitmap = Bitmap.createBitmap(bitmapWidth, bitmapHeight, config);
        StickerMakerView stickerMakerView = this.stickerMakerView;
        if (stickerMakerView != null && stickerMakerView.getSourceBitmap() != null) {
            Bitmap sourceBitmap = this.stickerMakerView.getSourceBitmap();
            Canvas canvas = new Canvas(bitmapCreateBitmap);
            canvas.translate(bitmapCreateBitmap.getWidth() / 2.0f, bitmapCreateBitmap.getHeight() / 2.0f);
            canvas.rotate(this.stickerMakerView.orientation);
            float width = bitmapCreateBitmap.getWidth() / ((this.stickerMakerView.orientation / 90) % 2 != 0 ? sourceBitmap.getHeight() : sourceBitmap.getWidth());
            RectF rectF = AndroidUtilities.rectTmp;
            rectF.set(((-sourceBitmap.getWidth()) / 2.0f) * width, ((-sourceBitmap.getHeight()) / 2.0f) * width, (sourceBitmap.getWidth() / 2.0f) * width, (sourceBitmap.getHeight() / 2.0f) * width);
            canvas.drawBitmap(sourceBitmap, (Rect) null, rectF, new Paint(3));
        }
        Bitmap bitmapCreateBitmap2 = Bitmap.createBitmap(this.centerImage.getBitmapWidth(), this.centerImage.getBitmapHeight(), config);
        if (this.centerImage.getBitmap() != null) {
            Bitmap bitmap = this.centerImage.getBitmap();
            Canvas canvas2 = new Canvas(bitmapCreateBitmap2);
            canvas2.translate(bitmapCreateBitmap2.getWidth() / 2.0f, bitmapCreateBitmap2.getHeight() / 2.0f);
            canvas2.rotate(this.centerImage.getOrientation());
            float width2 = bitmapCreateBitmap2.getWidth() / ((this.centerImage.getOrientation() / 90) % 2 != 0 ? bitmap.getHeight() : bitmap.getWidth());
            RectF rectF2 = AndroidUtilities.rectTmp;
            rectF2.set(((-bitmap.getWidth()) / 2.0f) * width2, ((-bitmap.getHeight()) / 2.0f) * width2, (bitmap.getWidth() / 2.0f) * width2, (bitmap.getHeight() / 2.0f) * width2);
            canvas2.drawBitmap(bitmap, (Rect) null, rectF2, new Paint(3));
        }
        MaskPaintView maskPaintView = new MaskPaintView(this.parentActivity, this.currentAccount, bitmapCreateBitmap2, bitmapCreateBitmap, this.centerImage.getOrientation(), cropState2) { // from class: org.telegram.ui.PhotoViewer.65
            @Override // org.telegram.ui.Components.Paint.Views.MaskPaintView
            protected void onDrawn() {
                PhotoViewer.this.showEditStickerMode(true, true);
            }

            @Override // org.telegram.ui.Components.Paint.Views.MaskPaintView
            protected void onRenderViewAlphaUpdate(ValueAnimator valueAnimator) {
                super.onRenderViewAlphaUpdate(valueAnimator);
                PhotoViewer.this.containerView.invalidate();
            }
        };
        this.maskPaintView = maskPaintView;
        maskPaintView.cancelButton.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda150
            @Override // android.view.View.OnClickListener
            public final void onClick(View view) {
                this.f$0.lambda$createMaskPaintView$104(view);
            }
        });
        this.maskPaintView.doneButton.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda151
            @Override // android.view.View.OnClickListener
            public final void onClick(View view) {
                this.f$0.lambda$createMaskPaintView$105(view);
            }
        });
        this.maskPaintView.setEraser(this.maskPaintViewEraser);
        int iIndexOfChild = this.containerView.indexOfChild(this.btnLayout) - 1;
        if (iIndexOfChild < 0) {
            iIndexOfChild = this.containerView.getChildCount();
        }
        this.containerView.addView(this.maskPaintView, iIndexOfChild, LayoutHelper.createFrame(-1, -1.0f));
        this.maskPaintViewShuttingDown = false;
    }

    private void createPaintView() {
        int bitmapWidth;
        int bitmapHeight;
        MediaController.CropState cropState;
        if (this.photoPaintView == null) {
            TextureView textureView = this.videoTextureView;
            if (textureView != null) {
                VideoEditTextureView videoEditTextureView = (VideoEditTextureView) textureView;
                bitmapWidth = videoEditTextureView.getVideoWidth();
                bitmapHeight = videoEditTextureView.getVideoHeight();
                while (true) {
                    if (bitmapWidth <= 1280 && bitmapHeight <= 1280) {
                        break;
                    }
                    bitmapWidth /= 2;
                    bitmapHeight /= 2;
                }
            } else {
                bitmapWidth = this.centerImage.getBitmapWidth();
                bitmapHeight = this.centerImage.getBitmapHeight();
            }
            Bitmap bitmap = this.paintingOverlay.getBitmap();
            Bitmap bitmapCreateBitmap = bitmap == null ? Bitmap.createBitmap(bitmapWidth, bitmapHeight, Bitmap.Config.ARGB_8888) : bitmap;
            if (this.sendPhotoType == 1) {
                cropState = new MediaController.CropState();
                cropState.transformRotation = this.cropTransform.getOrientation();
            } else {
                cropState = this.editState.cropState;
            }
            MediaController.CropState cropState2 = cropState;
            KeyboardNotifier keyboardNotifier = new KeyboardNotifier(this.windowView, new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda162
                @Override // org.telegram.messenger.Utilities.Callback
                public final void run(Object obj) {
                    this.f$0.lambda$createPaintView$107((Integer) obj);
                }
            });
            this.paintKeyboardNotifier = keyboardNotifier;
            keyboardNotifier.ignore(this.currentEditMode != 3);
            Activity activity = this.parentActivity;
            LPhotoPaintView lPhotoPaintView = new LPhotoPaintView(activity, activity, this.currentAccount, bitmapCreateBitmap, this.isCurrentVideo ? null : this.centerImage.getBitmap(), this.centerImage.getOrientation(), this.editState.mediaEntities, cropState2, new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda163
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$createPaintView$108();
                }
            }, this.resourcesProvider) { // from class: org.telegram.ui.PhotoViewer.66
                @Override // org.telegram.ui.Components.Paint.Views.LPhotoPaintView
                protected void didSetAnimatedSticker(RLottieDrawable rLottieDrawable) {
                    if (PhotoViewer.this.videoPlayer == null) {
                        return;
                    }
                    rLottieDrawable.setProgressMs(PhotoViewer.this.videoPlayer.getCurrentPosition() - (PhotoViewer.this.startTime > 0 ? PhotoViewer.this.startTime / 1000 : 0L));
                }

                @Override // org.telegram.ui.Components.Paint.Views.LPhotoPaintView
                protected int getPKeyboardHeight() {
                    if (PhotoViewer.this.paintKeyboardNotifier != null) {
                        return PhotoViewer.this.paintKeyboardNotifier.getKeyboardHeight();
                    }
                    return 0;
                }

                @Override // org.telegram.ui.Components.Paint.Views.LPhotoPaintView
                protected void onEmojiViewCloseByClick() {
                    if (PhotoViewer.this.paintKeyboardNotifier != null) {
                        PhotoViewer.this.paintKeyboardNotifier.awaitKeyboard();
                    }
                }

                @Override // org.telegram.ui.Components.Paint.Views.LPhotoPaintView
                protected void onOpenCloseStickersAlert(boolean z) {
                    if (PhotoViewer.this.videoPlayer == null) {
                        return;
                    }
                    PhotoViewer.this.manuallyPaused = false;
                    PhotoViewer.this.cancelVideoPlayRunnable();
                    if (z) {
                        PhotoViewer.this.videoPlayer.pause();
                    } else {
                        PhotoViewer.this.videoPlayer.play();
                    }
                }

                @Override // org.telegram.ui.Components.Paint.Views.LPhotoPaintView
                protected void onTextAdd() {
                    PhotoViewer.this.windowView.isFocusable();
                }

                @Override // org.telegram.ui.Components.Paint.Views.LPhotoPaintView
                protected void updateKeyboard() {
                    if (PhotoViewer.this.paintKeyboardNotifier != null) {
                        PhotoViewer.this.paintKeyboardNotifier.fire();
                    }
                }
            };
            this.photoPaintView = lPhotoPaintView;
            this.containerView.addView(lPhotoPaintView.getView(), LayoutHelper.createFrame(-1, -1.0f));
            this.photoPaintView.setOnDoneButtonClickedListener(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda164
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$createPaintView$109();
                }
            });
            this.photoPaintView.getCancelView().setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda165
                @Override // android.view.View.OnClickListener
                public final void onClick(View view) {
                    this.f$0.lambda$createPaintView$110(view);
                }
            });
            this.photoPaintView.setOffsetTranslationY(AndroidUtilities.dp(126.0f), BitmapDescriptorFactory.HUE_RED, 0, false);
            this.photoPaintView.setOffsetTranslationX(-AndroidUtilities.dp(12.0f));
        }
    }

    private void createVideoControlsInterface() {
        VideoPlayerControlFrameLayout videoPlayerControlFrameLayout = new VideoPlayerControlFrameLayout(this.containerView.getContext());
        this.videoPlayerControlFrameLayout = videoPlayerControlFrameLayout;
        this.containerView.addView(videoPlayerControlFrameLayout, LayoutHelper.createFrame(-1, 48, 83));
        final VideoPlayerSeekBar.SeekBarDelegate seekBarDelegate = new VideoPlayerSeekBar.SeekBarDelegate() { // from class: org.telegram.ui.PhotoViewer.49
            @Override // org.telegram.ui.Components.VideoPlayerSeekBar.SeekBarDelegate
            public void onSeekBarContinuousDrag(float f) {
                if (PhotoViewer.this.photoViewerWebView != null && PhotoViewer.this.photoViewerWebView.isYouTube() && PhotoViewer.this.videoPreviewFrame != null) {
                    PhotoViewer.this.videoPreviewFrame.setProgressForYouTube(PhotoViewer.this.photoViewerWebView, f, PhotoViewer.this.videoPlayerSeekbar.getWidth());
                } else if (PhotoViewer.this.videoPlayer != null && PhotoViewer.this.videoPreviewFrame != null) {
                    PhotoViewer.this.videoPreviewFrame.setProgress(PhotoViewer.this.currentMessageObject, f, PhotoViewer.this.videoPlayerSeekbar.getWidth());
                }
                PhotoViewer.this.showVideoSeekPreviewPosition(true);
                PhotoViewer.this.updateVideoSeekPreviewPosition();
            }

            @Override // org.telegram.ui.Components.VideoPlayerSeekBar.SeekBarDelegate
            public void onSeekBarDrag(float f) {
                if (PhotoViewer.this.videoPlayer != null || (PhotoViewer.this.photoViewerWebView != null && PhotoViewer.this.photoViewerWebView.isControllable())) {
                    if (!PhotoViewer.this.inPreview && PhotoViewer.this.videoTimelineViewContainer.getVisibility() == 0) {
                        f = PhotoViewer.this.videoTimelineView.getLeftProgress() + ((PhotoViewer.this.videoTimelineView.getRightProgress() - PhotoViewer.this.videoTimelineView.getLeftProgress()) * f);
                    }
                    if (PhotoViewer.this.getVideoDuration() == -9223372036854775807L) {
                        PhotoViewer.this.seekToProgressPending = f;
                    } else {
                        PhotoViewer.this.seekVideoOrWebTo((int) (f * r0));
                    }
                    PhotoViewer.this.showVideoSeekPreviewPosition(false);
                    PhotoViewer.this.needShowOnReady = false;
                }
            }
        };
        FloatSeekBarAccessibilityDelegate floatSeekBarAccessibilityDelegate = new FloatSeekBarAccessibilityDelegate() { // from class: org.telegram.ui.PhotoViewer.50
            @Override // org.telegram.ui.Components.SeekBarAccessibilityDelegate
            public String getContentDescription(View view) {
                return LocaleController.formatString("AccDescrPlayerDuration", R.string.AccDescrPlayerDuration, LocaleController.formatPluralString("Minutes", PhotoViewer.this.videoPlayerCurrentTime[0], new Object[0]) + ' ' + LocaleController.formatPluralString("Seconds", PhotoViewer.this.videoPlayerCurrentTime[1], new Object[0]), LocaleController.formatPluralString("Minutes", PhotoViewer.this.videoPlayerTotalTime[0], new Object[0]) + ' ' + LocaleController.formatPluralString("Seconds", PhotoViewer.this.videoPlayerTotalTime[1], new Object[0]));
            }

            @Override // org.telegram.ui.Components.FloatSeekBarAccessibilityDelegate
            public float getProgress() {
                return PhotoViewer.this.videoPlayerSeekbar.getProgress();
            }

            @Override // org.telegram.ui.Components.FloatSeekBarAccessibilityDelegate
            public void setProgress(float f) {
                seekBarDelegate.onSeekBarDrag(f);
                PhotoViewer.this.videoPlayerSeekbar.setProgress(f);
                PhotoViewer.this.videoPlayerSeekbarView.invalidate();
            }
        };
        View view = new View(this.containerView.getContext()) { // from class: org.telegram.ui.PhotoViewer.51
            @Override // android.view.View
            protected void onDraw(Canvas canvas) {
                PhotoViewer.this.videoPlayerSeekbar.draw(canvas, this);
            }
        };
        this.videoPlayerSeekbarView = view;
        view.setAccessibilityDelegate(floatSeekBarAccessibilityDelegate);
        this.videoPlayerSeekbarView.setImportantForAccessibility(1);
        this.videoPlayerControlFrameLayout.addView(this.videoPlayerSeekbarView, LayoutHelper.createFrame(-1, -1.0f));
        VideoPlayerSeekBar videoPlayerSeekBar = new VideoPlayerSeekBar(this.videoPlayerSeekbarView);
        this.videoPlayerSeekbar = videoPlayerSeekBar;
        videoPlayerSeekBar.setHorizontalPadding(AndroidUtilities.dp(2.0f));
        this.videoPlayerSeekbar.setColors(872415231, 872415231, -1, -1, -1, 1509949439);
        this.videoPlayerSeekbar.setDelegate(seekBarDelegate);
        VideoSeekPreviewImage videoSeekPreviewImage = new VideoSeekPreviewImage(this.containerView.getContext(), new VideoSeekPreviewImage.VideoSeekPreviewImageDelegate() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda83
            @Override // org.telegram.ui.Components.VideoSeekPreviewImage.VideoSeekPreviewImageDelegate
            public final void onReady() {
                this.f$0.lambda$createVideoControlsInterface$89();
            }
        }) { // from class: org.telegram.ui.PhotoViewer.52
            @Override // android.view.View
            protected void onLayout(boolean z, int i, int i2, int i3, int i4) {
                super.onLayout(z, i, i2, i3, i4);
                PhotoViewer.this.updateVideoSeekPreviewPosition();
            }

            @Override // android.view.View
            public void setVisibility(int i) {
                super.setVisibility(i);
                if (i == 0) {
                    PhotoViewer.this.updateVideoSeekPreviewPosition();
                }
            }
        };
        this.videoPreviewFrame = videoSeekPreviewImage;
        videoSeekPreviewImage.setAlpha(BitmapDescriptorFactory.HUE_RED);
        this.containerView.addView(this.videoPreviewFrame, LayoutHelper.createFrame(-2, -2.0f, 83, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 58.0f));
        SimpleTextView simpleTextView = new SimpleTextView(this.containerView.getContext());
        this.videoPlayerTime = simpleTextView;
        simpleTextView.setTextColor(-1);
        this.videoPlayerTime.setGravity(53);
        this.videoPlayerTime.setTextSize(14);
        this.videoPlayerTime.setImportantForAccessibility(2);
        this.videoPlayerControlFrameLayout.addView(this.videoPlayerTime, LayoutHelper.createFrame(-2, -2.0f, 53, BitmapDescriptorFactory.HUE_RED, 15.0f, 12.0f, BitmapDescriptorFactory.HUE_RED));
        ImageView imageView = new ImageView(this.containerView.getContext());
        this.exitFullscreenButton = imageView;
        imageView.setImageResource(R.drawable.msg_minvideo);
        this.exitFullscreenButton.setContentDescription(LocaleController.getString("AccExitFullscreen", R.string.AccExitFullscreen));
        this.exitFullscreenButton.setScaleType(ImageView.ScaleType.CENTER);
        this.exitFullscreenButton.setBackground(Theme.createSelectorDrawable(1090519039));
        this.exitFullscreenButton.setVisibility(4);
        this.videoPlayerControlFrameLayout.addView(this.exitFullscreenButton, LayoutHelper.createFrame(48, 48, 53));
        this.exitFullscreenButton.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda84
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$createVideoControlsInterface$90(view2);
            }
        });
    }

    private void createVideoTextureView(final MediaController.SavedFilterState savedFilterState) {
        AspectRatioFrameLayout aspectRatioFrameLayout;
        View view;
        if (this.videoTextureView != null) {
            return;
        }
        AspectRatioFrameLayout aspectRatioFrameLayout2 = new AspectRatioFrameLayout(this.parentActivity) { // from class: org.telegram.ui.PhotoViewer.56
            @Override // android.view.View
            public void draw(Canvas canvas) {
                if (PhotoViewer.this.textureViewSkipRender) {
                    return;
                }
                super.draw(canvas);
            }

            @Override // android.view.ViewGroup
            protected boolean drawChild(Canvas canvas, View view2, long j) {
                if (view2 == PhotoViewer.this.lastFrameImageView && PhotoViewer.this.skipLastFrameDraw) {
                    return true;
                }
                return super.drawChild(canvas, view2, j);
            }

            @Override // com.google.android.exoplayer2.ui.AspectRatioFrameLayout, android.widget.FrameLayout, android.view.View
            protected void onMeasure(int i, int i2) {
                float measuredWidth;
                FirstFrameView firstFrameView;
                super.onMeasure(i, i2);
                if (PhotoViewer.this.textureImageView != null) {
                    ViewGroup.LayoutParams layoutParams = PhotoViewer.this.textureImageView.getLayoutParams();
                    layoutParams.width = getMeasuredWidth();
                    layoutParams.height = getMeasuredHeight();
                }
                if (PhotoViewer.this.videoTextureView instanceof VideoEditTextureView) {
                    PhotoViewer.this.videoTextureView.setPivotX(PhotoViewer.this.videoTextureView.getMeasuredWidth() / 2);
                    firstFrameView = PhotoViewer.this.firstFrameView;
                    measuredWidth = PhotoViewer.this.videoTextureView.getMeasuredWidth() / 2;
                } else {
                    TextureView textureView = PhotoViewer.this.videoTextureView;
                    measuredWidth = BitmapDescriptorFactory.HUE_RED;
                    if (textureView != null) {
                        PhotoViewer.this.videoTextureView.setPivotX(BitmapDescriptorFactory.HUE_RED);
                    }
                    if (PhotoViewer.this.videoSurfaceView != null) {
                        PhotoViewer.this.videoSurfaceView.setPivotX(BitmapDescriptorFactory.HUE_RED);
                    }
                    firstFrameView = PhotoViewer.this.firstFrameView;
                }
                firstFrameView.setPivotX(measuredWidth);
                PhotoViewer.this.checkFullscreenButton();
            }
        };
        this.aspectRatioFrameLayout = aspectRatioFrameLayout2;
        aspectRatioFrameLayout2.setWillNotDraw(false);
        this.aspectRatioFrameLayout.setVisibility(4);
        this.containerView.addView(this.aspectRatioFrameLayout, 0, LayoutHelper.createFrame(-1, -1, 17));
        this.usedSurfaceView = false;
        if (!this.imagesArrLocals.isEmpty()) {
            VideoEditTextureView videoEditTextureView = new VideoEditTextureView(this.parentActivity, this.videoPlayer);
            this.blurManager.resetBitmap();
            videoEditTextureView.updateUiBlurManager(this.blurManager);
            if (savedFilterState != null) {
                videoEditTextureView.setDelegate(new VideoEditTextureView.VideoEditTextureViewDelegate() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda107
                    @Override // org.telegram.ui.Components.VideoEditTextureView.VideoEditTextureViewDelegate
                    public final void onEGLThreadAvailable(FilterGLThread filterGLThread) {
                        PhotoViewer.lambda$createVideoTextureView$91(savedFilterState, filterGLThread);
                    }
                });
            }
            this.videoTextureView = videoEditTextureView;
        } else if (this.ALLOW_USE_SURFACE && this.injectingVideoPlayerSurface == null) {
            this.videoSurfaceView = new SurfaceView(this.parentActivity);
            this.usedSurfaceView = true;
        } else {
            this.videoTextureView = new TextureView(this.parentActivity);
        }
        SurfaceTexture surfaceTexture = this.injectingVideoPlayerSurface;
        if (surfaceTexture != null) {
            this.videoTextureView.setSurfaceTexture(surfaceTexture);
            this.textureUploaded = true;
            this.videoSizeSet = true;
            this.injectingVideoPlayerSurface = null;
        }
        TextureView textureView = this.videoTextureView;
        if (textureView != null) {
            textureView.setPivotX(BitmapDescriptorFactory.HUE_RED);
            this.videoTextureView.setPivotY(BitmapDescriptorFactory.HUE_RED);
            this.videoTextureView.setOpaque(false);
            aspectRatioFrameLayout = this.aspectRatioFrameLayout;
            view = this.videoTextureView;
        } else {
            aspectRatioFrameLayout = this.aspectRatioFrameLayout;
            view = this.videoSurfaceView;
        }
        aspectRatioFrameLayout.addView(view, LayoutHelper.createFrame(-1, -1, 17));
        FirstFrameView firstFrameView = new FirstFrameView(this.parentActivity);
        this.firstFrameView = firstFrameView;
        firstFrameView.setPivotX(BitmapDescriptorFactory.HUE_RED);
        this.firstFrameView.setPivotY(BitmapDescriptorFactory.HUE_RED);
        this.firstFrameView.setScaleType(ImageView.ScaleType.FIT_XY);
        this.aspectRatioFrameLayout.addView(this.firstFrameView, LayoutHelper.createFrame(-1, -1, 17));
        View view2 = new View(this.parentActivity);
        this.pipPlaceholderView = view2;
        this.aspectRatioFrameLayout.addView(view2, LayoutHelper.createFrame(-1, -1.0f));
        if (this.sendPhotoType == 1) {
            View view3 = new View(this.parentActivity);
            this.flashView = view3;
            view3.setBackgroundColor(-1);
            this.flashView.setAlpha(BitmapDescriptorFactory.HUE_RED);
            this.aspectRatioFrameLayout.addView(this.flashView, LayoutHelper.createFrame(-1, -1, 17));
        }
        PipSource pipSource = this.pipSource;
        if (pipSource != null) {
            pipSource.setContentView(this.aspectRatioFrameLayout);
            this.pipSource.setPlaceholderView(this.pipPlaceholderView);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public boolean cropMirror() {
        if (this.imageMoveAnimation != null || this.photoCropView == null) {
            return false;
        }
        this.mirror = BitmapDescriptorFactory.HUE_RED;
        this.animateToMirror = 1.0f;
        this.animationStartTime = System.currentTimeMillis();
        AnimatorSet animatorSet = new AnimatorSet();
        this.imageMoveAnimation = animatorSet;
        animatorSet.playTogether(ObjectAnimator.ofFloat(this, (Property<PhotoViewer, Float>) AnimationProperties.PHOTO_VIEWER_ANIMATION_VALUE, BitmapDescriptorFactory.HUE_RED, 1.0f));
        this.imageMoveAnimation.setDuration(250L);
        this.imageMoveAnimation.setInterpolator(CubicBezierInterpolator.DEFAULT);
        this.imageMoveAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.45
            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
            public void onAnimationEnd(Animator animator) {
                ImageView imageView;
                PorterDuffColorFilter porterDuffColorFilter = null;
                PhotoViewer.this.imageMoveAnimation = null;
                if (PhotoViewer.this.photoCropView == null) {
                    return;
                }
                if (PhotoViewer.this.photoCropView.mirror()) {
                    imageView = PhotoViewer.this.mirrorItem;
                    porterDuffColorFilter = new PorterDuffColorFilter(PhotoViewer.this.getThemedColor(Theme.key_chat_editMediaButton), PorterDuff.Mode.MULTIPLY);
                } else {
                    imageView = PhotoViewer.this.mirrorItem;
                }
                imageView.setColorFilter(porterDuffColorFilter);
                PhotoViewer photoViewer = PhotoViewer.this;
                photoViewer.mirror = photoViewer.animateToMirror = BitmapDescriptorFactory.HUE_RED;
                PhotoViewer.this.containerView.invalidate();
            }
        });
        this.imageMoveAnimation.start();
        return !this.photoCropView.cropView.isMirrored();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public boolean cropRotate(float f) {
        return cropRotate(f, false, null);
    }

    private boolean cropRotate(final float f, boolean z, final Runnable runnable) {
        PhotoCropView photoCropView;
        if (this.imageMoveAnimation != null || (photoCropView = this.photoCropView) == null) {
            return false;
        }
        photoCropView.cropView.maximize(true);
        this.rotate = BitmapDescriptorFactory.HUE_RED;
        this.animateToRotate = f + BitmapDescriptorFactory.HUE_RED;
        if (z) {
            this.mirror = BitmapDescriptorFactory.HUE_RED;
            this.animateToMirror = 1.0f;
        }
        this.animationStartTime = System.currentTimeMillis();
        this.imageMoveAnimation = new AnimatorSet();
        if (this.sendPhotoType == 1) {
            this.animateToScale = 1.0f;
            this.scale = 1.0f;
        } else {
            ImageReceiver imageReceiver = this.centerImage;
            if (imageReceiver != null) {
                int bitmapWidth = imageReceiver.getBitmapWidth();
                int bitmapHeight = this.centerImage.getBitmapHeight();
                if (Math.abs((((int) this.photoCropView.cropView.getStateOrientation()) / 90) % 2) != 1) {
                    bitmapHeight = bitmapWidth;
                    bitmapWidth = bitmapHeight;
                }
                MediaController.CropState cropState = this.editState.cropState;
                if (cropState != null) {
                    bitmapHeight = (int) (bitmapHeight * cropState.cropPw);
                    bitmapWidth = (int) (bitmapWidth * cropState.cropPh);
                }
                float f2 = bitmapHeight;
                float f3 = bitmapWidth;
                float fMin = Math.min(getContainerViewWidth(1) / f2, getContainerViewHeight(1) / f3);
                this.animateToScale = (Math.abs((f / 90.0f) % 2.0f) == 1.0f ? Math.min(getContainerViewWidth(1) / f3, getContainerViewHeight(1) / f2) : fMin) / fMin;
            }
        }
        if (this.sendPhotoType == 11) {
            this.scale *= scale1(false);
            this.animateToScale *= scale1(false);
        }
        ValueAnimator valueAnimatorOfFloat = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f);
        final float rotation = this.photoCropView.wheelView.getRotation();
        valueAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda77
            @Override // android.animation.ValueAnimator.AnimatorUpdateListener
            public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                this.f$0.lambda$cropRotate$88(f, rotation, valueAnimator);
            }
        });
        this.imageMoveAnimation.playTogether(ObjectAnimator.ofFloat(this, (Property<PhotoViewer, Float>) AnimationProperties.PHOTO_VIEWER_ANIMATION_VALUE, BitmapDescriptorFactory.HUE_RED, 1.0f), valueAnimatorOfFloat);
        this.imageMoveAnimation.setDuration(250L);
        this.imageMoveAnimation.setInterpolator(CubicBezierInterpolator.DEFAULT);
        this.imageMoveAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.46
            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
            public void onAnimationEnd(Animator animator) {
                ImageView imageView;
                PorterDuffColorFilter porterDuffColorFilter = null;
                PhotoViewer.this.imageMoveAnimation = null;
                PhotoViewer photoViewer = PhotoViewer.this;
                photoViewer.rotate = photoViewer.animateToRotate = BitmapDescriptorFactory.HUE_RED;
                PhotoViewer photoViewer2 = PhotoViewer.this;
                photoViewer2.mirror = photoViewer2.animateToMirror = BitmapDescriptorFactory.HUE_RED;
                PhotoViewer photoViewer3 = PhotoViewer.this;
                photoViewer3.scale = photoViewer3.animateToScale = photoViewer3.scale1(false);
                PhotoViewer.this.containerView.invalidate();
                PhotoViewer.this.photoCropView.cropView.areaView.setRotationScaleTranslation(BitmapDescriptorFactory.HUE_RED, PhotoViewer.this.scale1(false), BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED);
                PhotoViewer.this.photoCropView.wheelView.setRotated(false);
                if (Math.abs(f) > BitmapDescriptorFactory.HUE_RED) {
                    if (PhotoViewer.this.photoCropView.rotate(f)) {
                        imageView = PhotoViewer.this.rotateItem;
                        porterDuffColorFilter = new PorterDuffColorFilter(PhotoViewer.this.getThemedColor(Theme.key_chat_editMediaButton), PorterDuff.Mode.MULTIPLY);
                    } else {
                        imageView = PhotoViewer.this.rotateItem;
                    }
                    imageView.setColorFilter(porterDuffColorFilter);
                }
                if (PhotoViewer.this.editState.cropState != null) {
                    MediaController.CropState cropState2 = PhotoViewer.this.editState.cropState;
                    PhotoViewer.this.editState.cropState.cropPy = BitmapDescriptorFactory.HUE_RED;
                    cropState2.cropPx = BitmapDescriptorFactory.HUE_RED;
                    MediaController.CropState cropState3 = PhotoViewer.this.editState.cropState;
                    PhotoViewer.this.editState.cropState.cropPh = 1.0f;
                    cropState3.cropPw = 1.0f;
                }
                Runnable runnable2 = runnable;
                if (runnable2 != null) {
                    runnable2.run();
                }
            }
        });
        this.imageMoveAnimation.start();
        return Math.abs(this.photoCropView.cropView.getStateOrientation() + f) > 0.01f;
    }

    private void detectFaces() {
        if (this.centerImage.getAnimation() != null || this.imagesArrLocals.isEmpty() || this.sendPhotoType == 1) {
            return;
        }
        String imageKey = this.centerImage.getImageKey();
        String str = this.currentImageFaceKey;
        if (str == null || !str.equals(imageKey)) {
            this.currentImageHasFace = 0;
            detectFaces(imageKey, this.centerImage.getBitmapSafe(), this.centerImage.getOrientation());
        }
    }

    private void detectFaces(final String str, final ImageReceiver.BitmapHolder bitmapHolder, final int i) {
        if (str == null || bitmapHolder == null || bitmapHolder.bitmap == null) {
            return;
        }
        Utilities.globalQueue.postRunnable(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda133
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$detectFaces$97(bitmapHolder, i, str);
            }
        });
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void didChangedCompressionLevel(boolean z) {
        SharedPreferences.Editor editorEdit = MessagesController.getGlobalMainSettings().edit();
        editorEdit.putInt(String.format("compress_video_%d", Integer.valueOf(this.compressionsCount)), this.selectedCompression);
        editorEdit.commit();
        updateWidthHeightBitrateForCompression();
        updateVideoInfo();
        if (z) {
            requestVideoPreview(1);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void dismissInternal() {
        try {
            if (this.windowView.getParent() != null) {
                Activity activity = this.parentActivity;
                if (activity instanceof LaunchActivity) {
                    ((LaunchActivity) activity).drawerLayoutContainer.setAllowDrawContent(true);
                }
                ((WindowManager) this.parentActivity.getSystemService("window")).removeView(this.windowView);
                onHideView();
            }
        } catch (Exception e) {
            FileLog.e(e);
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:14:0x001f  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void drawCenterImageInternal(Canvas canvas, float f, float f2) {
        boolean zIsMirrored;
        boolean z;
        if (this.imagesArrLocals.isEmpty()) {
            zIsMirrored = false;
        } else if (this.currentEditMode == 1 || this.sendPhotoType == 1) {
            zIsMirrored = this.cropTransform.isMirrored();
        } else {
            MediaController.CropState cropState = this.editState.cropState;
            if (cropState != null && cropState.mirrored) {
                zIsMirrored = true;
            }
        }
        if (zIsMirrored) {
            canvas.save();
            canvas.scale(-1.0f, 1.0f);
            z = true;
        } else {
            z = false;
        }
        if (f > BitmapDescriptorFactory.HUE_RED) {
            if (!z) {
                canvas.save();
                z = true;
            }
            canvas.scale(1.0f - (2.0f * f), 1.0f);
            canvas.skew(BitmapDescriptorFactory.HUE_RED, 4.0f * f * (1.0f - f) * 0.25f);
        }
        PhotoViewerWebView photoViewerWebView = this.photoViewerWebView;
        if (photoViewerWebView == null || !photoViewerWebView.isLoaded()) {
            if (!this.centerImageTransformLocked) {
                this.centerImageTransform.preTranslate(this.centerImage.getImageX(), this.centerImage.getImageY());
            }
            this.stickerMakerView.drawOutline(canvas, false, this.containerView, this.switchingToMode != -1);
            this.centerImage.setAlpha(f2);
            this.centerImage.draw(canvas);
            this.stickerMakerView.drawOutline(canvas, true, this.containerView, this.switchingToMode != -1);
            this.stickerMakerView.drawSegmentBorderPath(canvas, this.centerImage, this.centerImageTransform, this.containerView);
            this.centerImageTransformLocked = true;
        }
        if (z) {
            canvas.restore();
        }
    }

    private void drawFancyShadows(Canvas canvas) {
        float f;
        if (this.fancyShadows) {
            if (SharedConfig.photoViewerBlur) {
                AnimatedFloat animatedFloat = this.blurAlpha;
                int i = this.animationInProgress;
                f = animatedFloat.set(i == 0 || i == 2 || i == 3);
            } else {
                f = 1.0f;
            }
            if (f <= BitmapDescriptorFactory.HUE_RED) {
                return;
            }
            int currentActionBarHeight = ((int) (AndroidUtilities.statusBarHeight * 1.5f)) + ActionBar.getCurrentActionBarHeight();
            int height = AndroidUtilities.navigationBarHeight + this.pickerView.getHeight() + (this.captionEdit.getVisibility() == 0 ? (this.captionEdit.getEditTextHeightClosedKeyboard() / 2) + AndroidUtilities.dp(20.0f) : 0);
            if (this.clipFancyShadows == null) {
                this.clipFancyShadows = new Path();
                Paint paint = new Paint(1);
                this.topFancyShadowPaint = paint;
                PorterDuff.Mode mode = PorterDuff.Mode.DST_IN;
                paint.setXfermode(new PorterDuffXfermode(mode));
                Paint paint2 = new Paint(1);
                this.bottomFancyShadowPaint = paint2;
                paint2.setXfermode(new PorterDuffXfermode(mode));
                float[] fArr = {BitmapDescriptorFactory.HUE_RED, 1.0f};
                Shader.TileMode tileMode = Shader.TileMode.CLAMP;
                this.topFancyShadow = new LinearGradient(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 16.0f, new int[]{-16777216, 0}, fArr, tileMode);
                this.bottomFancyShadow = new LinearGradient(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 16.0f, new int[]{0, -16777216}, new float[]{BitmapDescriptorFactory.HUE_RED, 1.0f}, tileMode);
                this.topFancyShadowMatrix = new Matrix();
                this.bottomFancyShadowMatrix = new Matrix();
                this.topFancyShadowPaint.setShader(this.topFancyShadow);
                this.bottomFancyShadowPaint.setShader(this.bottomFancyShadow);
            }
            canvas.saveLayerAlpha(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, this.containerView.getWidth(), this.containerView.getHeight() + AndroidUtilities.navigationBarHeight, (int) (f * (this.backgroundDrawable.getAlpha() - 127) * 2.007874f), 31);
            this.clipFancyShadows.rewind();
            Path path = this.clipFancyShadows;
            float width = this.containerView.getWidth();
            float f2 = currentActionBarHeight;
            Path.Direction direction = Path.Direction.CW;
            path.addRect(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, width, f2, direction);
            this.clipFancyShadows.addRect(BitmapDescriptorFactory.HUE_RED, (this.containerView.getHeight() + AndroidUtilities.navigationBarHeight) - height, this.containerView.getWidth(), this.containerView.getHeight() + AndroidUtilities.navigationBarHeight, direction);
            canvas.clipPath(this.clipFancyShadows);
            canvas.drawColor(-16777216);
            drawCaptionBlur(canvas, this.shadowBlurer, 0, 0, true, true, false);
            canvas.save();
            this.topFancyShadowMatrix.reset();
            this.topFancyShadowMatrix.postScale(1.0f, f2 / 16.0f);
            this.topFancyShadow.setLocalMatrix(this.topFancyShadowMatrix);
            this.topFancyShadowPaint.setAlpha(208);
            canvas.drawRect(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, this.containerView.getWidth(), f2, this.topFancyShadowPaint);
            this.bottomFancyShadowMatrix.reset();
            this.bottomFancyShadowMatrix.postScale(1.0f, height / 16.0f);
            this.bottomFancyShadowMatrix.postTranslate(BitmapDescriptorFactory.HUE_RED, (this.containerView.getHeight() - height) + AndroidUtilities.navigationBarHeight);
            this.bottomFancyShadow.setLocalMatrix(this.bottomFancyShadowMatrix);
            this.bottomFancyShadowPaint.setAlpha(187);
            canvas.drawRect(BitmapDescriptorFactory.HUE_RED, (this.containerView.getHeight() + AndroidUtilities.navigationBarHeight) - height, this.containerView.getWidth(), this.containerView.getHeight() + AndroidUtilities.navigationBarHeight, this.bottomFancyShadowPaint);
            canvas.restore();
            canvas.restore();
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:35:0x004d  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void drawProgress(Canvas canvas, float f, float f2, float f3, float f4) {
        VideoTimelinePlayView videoTimelinePlayView;
        VideoPlayer videoPlayer;
        boolean z = true;
        boolean z2 = !this.isCurrentVideo || (((videoTimelinePlayView = this.videoTimelineView) == null || !videoTimelinePlayView.isDragging()) && ((this.sendPhotoType != 1 || this.manuallyPaused) && !(((videoPlayer = this.videoPlayer) != null && videoPlayer.isPlaying()) || this.switchingToMode == 5 || this.currentEditMode == 5)));
        if (this.miniProgressView.getVisibility() != 0 && this.miniProgressAnimator == null) {
            z = false;
        }
        if (z2) {
            boolean z3 = this.zoomAnimation;
            float fDpf2 = BitmapDescriptorFactory.HUE_RED;
            if (!z3) {
                float f5 = -f;
                float f6 = this.maxX;
                float f7 = f5 > f6 ? f6 + f : BitmapDescriptorFactory.HUE_RED;
                if (f2 == 1.0f) {
                    fDpf2 = f3;
                }
                float alpha = z ? (1.0f - this.miniProgressView.getAlpha()) * f4 : f4;
                if (this.pipAnimationInProgress) {
                    alpha *= this.actionBar.getAlpha();
                } else if (this.photoProgressViews[0].backgroundState == 4) {
                    fDpf2 += AndroidUtilities.dpf2(8.0f) * (1.0f - this.actionBar.getAlpha());
                }
                SeekSpeedDrawable seekSpeedDrawable = this.seekSpeedDrawable;
                if (seekSpeedDrawable == null || !seekSpeedDrawable.isShown()) {
                    canvas.save();
                    canvas.translate(f7, fDpf2);
                    this.photoProgressViews[0].setScale(1.0f);
                    this.photoProgressViews[0].setAlpha(alpha);
                    this.photoProgressViews[0].onDraw(canvas);
                    if (this.isActionBarVisible && this.allowShowFullscreenButton && this.fullscreenButton[0].getTag() == null) {
                        ImageView imageView = this.fullscreenButton[0];
                        imageView.setAlpha(Math.min(imageView.getAlpha(), f4));
                    }
                    canvas.restore();
                }
            }
        }
        if (!z || this.pipAnimationInProgress) {
            return;
        }
        canvas.save();
        canvas.translate(this.miniProgressView.getLeft() + f, this.miniProgressView.getTop() + (f3 / f2));
        this.miniProgressView.draw(canvas);
        canvas.restore();
    }

    private boolean enableSwipeToPiP() {
        return false;
    }

    private int[] fixVideoWidthHeight(int i, int i2) {
        int[] iArr = {i, i2};
        if (Build.VERSION.SDK_INT >= 21) {
            MediaCodec mediaCodecCreateEncoderByType = null;
            try {
                mediaCodecCreateEncoderByType = MediaCodec.createEncoderByType(MediaController.VIDEO_MIME_TYPE);
                MediaCodecInfo.VideoCapabilities videoCapabilities = mediaCodecCreateEncoderByType.getCodecInfo().getCapabilitiesForType(MediaController.VIDEO_MIME_TYPE).getVideoCapabilities();
                Range supportedWidths = videoCapabilities.getSupportedWidths();
                Range supportedHeights = videoCapabilities.getSupportedHeights();
                iArr[0] = Math.max(((Integer) supportedWidths.getLower()).intValue(), Math.round(i / 16.0f) * 16);
                iArr[1] = Math.max(((Integer) supportedHeights.getLower()).intValue(), Math.round(i2 / 16.0f) * 16);
            } catch (Exception unused) {
                if (mediaCodecCreateEncoderByType != null) {
                }
            } catch (Throwable th) {
                if (mediaCodecCreateEncoderByType != null) {
                    try {
                        mediaCodecCreateEncoderByType.release();
                    } catch (Exception unused2) {
                    }
                }
                throw th;
            }
            try {
                mediaCodecCreateEncoderByType.release();
            } catch (Exception unused3) {
            }
        }
        return iArr;
    }

    private String format(int i, int i2) {
        char c = (char) (((i >= 100 ? 99 : i) / 10) + 48);
        if (i >= 100) {
            i = 99;
        }
        char c2 = (char) ((i % 10) + 48);
        char c3 = (char) (((i2 >= 100 ? 99 : i2) / 10) + 48);
        if (i2 >= 100) {
            i2 = 99;
        }
        return new String(new char[]{c, c2, ':', c3, (char) ((i2 % 10) + 48)});
    }

    private String format(int i, int i2, int i3) {
        char c = (char) (((i >= 100 ? 99 : i) / 10) + 48);
        if (i >= 100) {
            i = 99;
        }
        char c2 = (char) ((i % 10) + 48);
        char c3 = (char) (((i2 >= 100 ? 99 : i2) / 10) + 48);
        if (i2 >= 100) {
            i2 = 99;
        }
        char c4 = (char) ((i2 % 10) + 48);
        char c5 = (char) (((i3 >= 100 ? 99 : i3) / 10) + 48);
        if (i3 >= 100) {
            i3 = 99;
        }
        return new String(new char[]{c, c2, ':', c3, c4, ':', c5, (char) ((i3 % 10) + 48)});
    }

    private int getAdditionX(int i) {
        float f;
        if (i == 1 || (i == 0 && this.sendPhotoType == 1)) {
            f = 16.0f;
        } else {
            if (i == 0 || i == 5 || i == 4 || i == 3) {
                return 0;
            }
            f = 14.0f;
        }
        return AndroidUtilities.dp(f);
    }

    private int getAdditionY(int i) {
        if (i < 0) {
            return 0;
        }
        if (i == 1 || (i == 0 && this.sendPhotoType == 1)) {
            return AndroidUtilities.dp(16.0f) + (isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0);
        }
        if (i == 3 && this.photoPaintView != null) {
            return AndroidUtilities.dp(8.0f) + (isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0) + this.photoPaintView.getAdditionalTop();
        }
        if (i == 0 || i == 4 || i == 5) {
            return 0;
        }
        return AndroidUtilities.dp(14.0f) + (isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0);
    }

    /* JADX WARN: Code restructure failed: missing block: B:11:0x0024, code lost:
    
        if ((r4 & 4) == 0) goto L12;
     */
    /* JADX WARN: Removed duplicated region for block: B:20:0x0032 A[EDGE_INSN: B:20:0x0032->B:16:0x0032 BREAK  A[LOOP:0: B:5:0x000c->B:17:0x0034], SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:22:0x0034 A[SYNTHETIC] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private int getAnimatedMediaEntitiesCount(boolean z) {
        ArrayList arrayList = this.editState.mediaEntities;
        if (arrayList == null) {
            return 0;
        }
        int size = arrayList.size();
        int i = 0;
        for (int i2 = 0; i2 < size; i2++) {
            VideoEditedInfo.MediaEntity mediaEntity = (VideoEditedInfo.MediaEntity) this.editState.mediaEntities.get(i2);
            if (mediaEntity.type == 0) {
                byte b = mediaEntity.subType;
                if ((b & 1) == 0) {
                }
                i++;
                if (!z) {
                    break;
                }
            }
            if (mediaEntity.entities.isEmpty()) {
                continue;
            } else {
                i++;
                if (!z) {
                }
            }
        }
        return i;
    }

    private ClippingImageView[] getAnimatingImageViews(PlaceProviderObject placeProviderObject) {
        int i = (AndroidUtilities.isTablet() || placeProviderObject == null || placeProviderObject.animatingImageView == null) ? 0 : 1;
        ClippingImageView[] clippingImageViewArr = new ClippingImageView[i + 1];
        clippingImageViewArr[0] = this.animatingImageView;
        if (i != 0) {
            ClippingImageView clippingImageView = placeProviderObject.animatingImageView;
            clippingImageViewArr[1] = clippingImageView;
            clippingImageView.setAdditionalTranslationY(placeProviderObject.animatingImageViewYOffset);
        }
        return clippingImageViewArr;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public CaptionContainerView getCaptionView() {
        PhotoViewerProvider photoViewerProvider = this.placeProvider;
        return (photoViewerProvider == null || !photoViewerProvider.isCaptionAbove()) ? this.captionEdit : this.topCaptionEdit;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public Bitmap.CompressFormat getCompressFormat() {
        return this.sendPhotoType == 11 ? Bitmap.CompressFormat.PNG : Bitmap.CompressFormat.JPEG;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int getContainerViewHeight() {
        return getContainerViewHeight(this.currentEditMode);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int getContainerViewHeight(int i) {
        return getContainerViewHeight(false, i);
    }

    private int getContainerViewHeight(boolean z, int i) {
        int measuredHeight;
        int iDp;
        float f;
        if (z || this.inBubbleMode) {
            measuredHeight = this.containerView.getMeasuredHeight();
        } else {
            measuredHeight = AndroidUtilities.displaySize.y;
            if ((i == 0 || i == 4 || i == 5) && this.sendPhotoType != 1 && isStatusBarVisible()) {
                measuredHeight += AndroidUtilities.statusBarHeight;
            }
        }
        if ((i == 0 && this.sendPhotoType == 1) || i == 1) {
            f = 144.0f;
        } else {
            if (i != 2) {
                if (i != 3) {
                    return measuredHeight;
                }
                iDp = AndroidUtilities.dp(48.0f) + this.photoPaintView.getAdditionalBottom() + ActionBar.getCurrentActionBarHeight() + this.photoPaintView.getAdditionalTop();
                return measuredHeight - iDp;
            }
            f = 214.0f;
        }
        iDp = AndroidUtilities.dp(f);
        return measuredHeight - iDp;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int getContainerViewWidth() {
        return getContainerViewWidth(this.currentEditMode);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int getContainerViewWidth(int i) {
        float f;
        int width = this.containerView.getWidth();
        if (i == 1 || (i == 0 && this.sendPhotoType == 1)) {
            f = 32.0f;
        } else {
            if (i == 0 || i == 4 || i == 5 || i == 3) {
                return width;
            }
            f = 28.0f;
        }
        return width - AndroidUtilities.dp(f);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public float getCropFillScale(boolean z) {
        ImageReceiver imageReceiver = this.centerImage;
        int bitmapHeight = z ? imageReceiver.getBitmapHeight() : imageReceiver.getBitmapWidth();
        int bitmapWidth = z ? this.centerImage.getBitmapWidth() : this.centerImage.getBitmapHeight();
        float fMin = Math.min(this.photoCropView.getMeasuredWidth(), (this.photoCropView.getMeasuredHeight() - AndroidUtilities.dp(64.0f)) - (isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0)) - (AndroidUtilities.dp(16.0f) * 2);
        return Math.max(fMin / bitmapHeight, fMin / bitmapWidth);
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:16:0x0055  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public ChromecastMediaVariations getCurrentChromecastMedia() {
        String name;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            return null;
        }
        TLRPC.Document document = messageObject.getDocument();
        String documentName = this.currentMessageObject.getDocumentName();
        if (TextUtils.isEmpty(documentName)) {
            documentName = this.currentMessageObject.getFileName();
        }
        long dialogId = this.currentMessageObject.getDialogId();
        if (DialogObject.isUserDialog(dialogId)) {
            TLRPC.User user = MessagesController.getInstance(UserConfig.selectedAccount).getUser(Long.valueOf(dialogId));
            name = user != null ? ContactsController.formatName(user.first_name, user.last_name) : null;
        } else {
            TLRPC.Chat chat = MessagesController.getInstance(UserConfig.selectedAccount).getChat(Long.valueOf(-dialogId));
            if (chat != null) {
                name = chat.title;
            }
        }
        if (!this.currentMessageObject.isPhoto()) {
            VideoPlayer videoPlayer = this.videoPlayer;
            if (videoPlayer == null) {
                return null;
            }
            StringBuilder sb = new StringBuilder();
            sb.append(document != null ? document.id : this.currentMessageObject.getId());
            sb.append("");
            return videoPlayer.getCurrentChromecastMedia(sb.toString(), name, documentName);
        }
        File pathToMessage = FileLoader.getInstance(this.currentMessageObject.currentAccount).getPathToMessage(this.currentMessageObject.messageOwner);
        if (pathToMessage == null || !pathToMessage.exists()) {
            return null;
        }
        return ChromecastMediaVariations.of(ChromecastMedia.Builder.fromUri(Uri.parse("file://" + pathToMessage.getAbsolutePath()), "/photo_" + this.currentMessageObject.getId(), "image/jpeg").setTitle(name).setSubtitle(documentName).build());
    }

    /* JADX INFO: Access modifiers changed from: private */
    public VideoEditedInfo getCurrentVideoEditedInfo() {
        int i;
        MediaController.CropState cropState;
        float f;
        float f2;
        long j;
        ArrayList<VideoEditedInfo.MediaEntity> arrayList = null;
        if (!this.isCurrentVideo && hasAnimatedMediaEntities() && this.centerImage.getBitmapWidth() > 0) {
            int i2 = this.sendPhotoType;
            float f3 = i2 == 1 ? 800.0f : i2 == 11 ? 500.0f : 854.0f;
            VideoEditedInfo videoEditedInfo = new VideoEditedInfo();
            videoEditedInfo.startTime = 0L;
            videoEditedInfo.start = 0L;
            long jMin = Math.min(3000L, this.editState.averageDuration);
            while (true) {
                videoEditedInfo.endTime = jMin;
                j = videoEditedInfo.endTime;
                if (j <= 0 || j >= 1000) {
                    break;
                }
                jMin = j * 2;
            }
            videoEditedInfo.end = j;
            videoEditedInfo.compressQuality = this.selectedCompression;
            videoEditedInfo.rotationValue = 0;
            videoEditedInfo.originalPath = this.currentImagePath;
            long j2 = videoEditedInfo.endTime;
            videoEditedInfo.estimatedSize = (int) ((j2 / 1000.0f) * 115200.0f);
            videoEditedInfo.estimatedDuration = j2;
            videoEditedInfo.framerate = 30;
            videoEditedInfo.originalDuration = j2;
            EditState editState = this.editState;
            videoEditedInfo.filterState = editState.savedFilterState;
            String str = editState.croppedPaintPath;
            if (str != null) {
                videoEditedInfo.paintPath = str;
                ArrayList arrayList2 = editState.croppedMediaEntities;
                if (arrayList2 != null && !arrayList2.isEmpty()) {
                    arrayList = this.editState.croppedMediaEntities;
                }
                videoEditedInfo.mediaEntities = arrayList;
            } else {
                videoEditedInfo.paintPath = editState.paintPath;
                videoEditedInfo.mediaEntities = editState.mediaEntities;
            }
            videoEditedInfo.isPhoto = true;
            int bitmapWidth = this.centerImage.getBitmapWidth();
            int bitmapHeight = this.centerImage.getBitmapHeight();
            MediaController.CropState cropState2 = this.editState.cropState;
            if (cropState2 != null) {
                int i3 = cropState2.transformRotation;
                if (i3 != 90 && i3 != 270) {
                    bitmapHeight = bitmapWidth;
                    bitmapWidth = bitmapHeight;
                }
                int i4 = (int) (bitmapHeight * cropState2.cropPw);
                bitmapHeight = (int) (bitmapWidth * cropState2.cropPh);
                bitmapWidth = i4;
            }
            int i5 = this.sendPhotoType;
            if (i5 == 1 || i5 == 11) {
                bitmapWidth = bitmapHeight;
            }
            float f4 = bitmapWidth;
            float f5 = bitmapHeight;
            float fMax = Math.max(f4 / f3, f5 / f3);
            if (fMax < 1.0f) {
                fMax = 1.0f;
            }
            int iMax = (int) (f4 / fMax);
            int iMax2 = (int) (f5 / fMax);
            if (iMax % 16 != 0) {
                iMax = Math.max(1, Math.round(iMax / 16.0f)) * 16;
            }
            if (iMax2 % 16 != 0) {
                iMax2 = Math.max(1, Math.round(iMax2 / 16.0f)) * 16;
            }
            videoEditedInfo.resultWidth = iMax;
            videoEditedInfo.originalWidth = iMax;
            videoEditedInfo.resultHeight = iMax2;
            videoEditedInfo.originalHeight = iMax2;
            videoEditedInfo.bitrate = -1;
            videoEditedInfo.muted = true;
            videoEditedInfo.avatarStartTime = 0L;
            return videoEditedInfo;
        }
        int i6 = -1;
        if (!this.isCurrentVideo || ((this.currentPlayingVideoFile == null && this.currentPlayingVideoQualityFiles == null) || this.compressionsCount == 0)) {
            return null;
        }
        VideoEditedInfo videoEditedInfo2 = new VideoEditedInfo();
        videoEditedInfo2.startTime = this.startTime;
        videoEditedInfo2.endTime = this.endTime;
        videoEditedInfo2.start = this.videoCutStart;
        videoEditedInfo2.end = this.videoCutEnd;
        videoEditedInfo2.compressQuality = this.selectedCompression;
        videoEditedInfo2.rotationValue = this.rotationValue;
        videoEditedInfo2.originalWidth = this.originalWidth;
        videoEditedInfo2.originalHeight = this.originalHeight;
        videoEditedInfo2.bitrate = this.bitrate;
        videoEditedInfo2.originalPath = this.currentPathObject;
        long j3 = this.estimatedSize;
        if (j3 == 0) {
            j3 = 1;
        }
        videoEditedInfo2.estimatedSize = j3;
        videoEditedInfo2.estimatedDuration = this.estimatedDuration;
        videoEditedInfo2.framerate = this.videoFramerate;
        videoEditedInfo2.originalDuration = (long) (this.videoDuration * 1000.0f);
        EditState editState2 = this.editState;
        videoEditedInfo2.filterState = editState2.savedFilterState;
        String str2 = editState2.croppedPaintPath;
        if (str2 != null) {
            videoEditedInfo2.paintPath = str2;
            ArrayList arrayList3 = editState2.croppedMediaEntities;
            if (arrayList3 != null && !arrayList3.isEmpty()) {
                arrayList = this.editState.croppedMediaEntities;
            }
        } else {
            videoEditedInfo2.paintPath = editState2.paintPath;
            ArrayList arrayList4 = editState2.mediaEntities;
            if (arrayList4 != null && !arrayList4.isEmpty()) {
                arrayList = this.editState.mediaEntities;
            }
        }
        videoEditedInfo2.mediaEntities = arrayList;
        if (this.sendPhotoType == 1 || this.muteVideo || !(this.compressItem.getTag() == null || (videoEditedInfo2.resultWidth == this.originalWidth && videoEditedInfo2.resultHeight == this.originalHeight))) {
            if (this.muteVideo || this.sendPhotoType == 1) {
                this.selectedCompression = 1;
                updateWidthHeightBitrateForCompression();
            }
            videoEditedInfo2.resultWidth = this.resultWidth;
            videoEditedInfo2.resultHeight = this.resultHeight;
            if (!this.muteVideo && this.sendPhotoType != 1) {
                i6 = this.bitrate;
            }
        } else {
            videoEditedInfo2.resultWidth = this.originalWidth;
            videoEditedInfo2.resultHeight = this.originalHeight;
            if (!this.muteVideo) {
                i6 = this.originalBitrate;
            }
        }
        videoEditedInfo2.bitrate = i6;
        MediaController.CropState cropState3 = this.editState.cropState;
        videoEditedInfo2.cropState = cropState3;
        if (cropState3 != null) {
            videoEditedInfo2.rotationValue += cropState3.transformRotation;
            while (true) {
                i = videoEditedInfo2.rotationValue;
                if (i < 360) {
                    break;
                }
                videoEditedInfo2.rotationValue = i - 360;
            }
            if (i == 90 || i == 270) {
                cropState = videoEditedInfo2.cropState;
                cropState.transformWidth = (int) (videoEditedInfo2.resultWidth * cropState.cropPh);
                f = videoEditedInfo2.resultHeight;
                f2 = cropState.cropPw;
            } else {
                cropState = videoEditedInfo2.cropState;
                cropState.transformWidth = (int) (videoEditedInfo2.resultWidth * cropState.cropPw);
                f = videoEditedInfo2.resultHeight;
                f2 = cropState.cropPh;
            }
            cropState.transformHeight = (int) (f * f2);
            if (this.sendPhotoType == 1) {
                MediaController.CropState cropState4 = videoEditedInfo2.cropState;
                if (cropState4.transformWidth > 800) {
                    cropState4.transformWidth = 800;
                }
                if (cropState4.transformHeight > 800) {
                    cropState4.transformHeight = 800;
                }
                int iMin = Math.min(cropState4.transformWidth, cropState4.transformHeight);
                cropState4.transformHeight = iMin;
                cropState4.transformWidth = iMin;
            }
            if (BuildVars.LOGS_ENABLED) {
                FileLog.d("original transformed w = " + videoEditedInfo2.cropState.transformWidth + " h = " + videoEditedInfo2.cropState.transformHeight + " r = " + videoEditedInfo2.rotationValue);
            }
            MediaController.CropState cropState5 = videoEditedInfo2.cropState;
            int[] iArrFixVideoWidthHeight = fixVideoWidthHeight(cropState5.transformWidth, cropState5.transformHeight);
            MediaController.CropState cropState6 = videoEditedInfo2.cropState;
            cropState6.transformWidth = iArrFixVideoWidthHeight[0];
            cropState6.transformHeight = iArrFixVideoWidthHeight[1];
            if (BuildVars.LOGS_ENABLED) {
                FileLog.d("fixed transformed w = " + videoEditedInfo2.cropState.transformWidth + " h = " + videoEditedInfo2.cropState.transformHeight);
            }
        }
        if (this.sendPhotoType == 1) {
            videoEditedInfo2.avatarStartTime = this.avatarStartTime;
            videoEditedInfo2.originalBitrate = this.originalBitrate;
        }
        videoEditedInfo2.muted = this.muteVideo || this.sendPhotoType == 1;
        return videoEditedInfo2;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public long getCurrentVideoPosition() {
        PhotoViewerWebView photoViewerWebView = this.photoViewerWebView;
        if (photoViewerWebView != null && photoViewerWebView.isControllable()) {
            return this.photoViewerWebView.getCurrentPosition();
        }
        VideoPlayer videoPlayer = this.videoPlayer;
        if (videoPlayer == null) {
            return 0L;
        }
        return videoPlayer.getCurrentPosition();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public TLObject getFileLocation(int i, long[] jArr) {
        if (i < 0) {
            return null;
        }
        if (!this.secureDocuments.isEmpty()) {
            if (i >= this.secureDocuments.size()) {
                return null;
            }
            if (jArr != null) {
                jArr[0] = ((SecureDocument) this.secureDocuments.get(i)).secureFile.size;
            }
            return (TLObject) this.secureDocuments.get(i);
        }
        if (!this.imagesArrLocations.isEmpty()) {
            if (i >= this.imagesArrLocations.size()) {
                return null;
            }
            if (jArr != null && this.imagesArrLocationsSizes.get(i) != null) {
                jArr[0] = ((Long) this.imagesArrLocationsSizes.get(i)).longValue();
            }
            if (this.imagesArrLocationsVideo.get(i) != null) {
                return ((ImageLocation) this.imagesArrLocationsVideo.get(i)).location;
            }
            return null;
        }
        if (this.imagesArr.isEmpty() || i >= this.imagesArr.size()) {
            return null;
        }
        MessageObject messageObject = (MessageObject) this.imagesArr.get(i);
        TLRPC.Message message = messageObject.messageOwner;
        if (message instanceof TLRPC.TL_messageService) {
            TLRPC.MessageAction messageAction = message.action;
            if (messageAction instanceof TLRPC.TL_messageActionUserUpdatedPhoto) {
                return messageAction.newUserPhoto.photo_big;
            }
            TLRPC.PhotoSize closestPhotoSizeWithSize = FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, AndroidUtilities.getPhotoSize());
            if (closestPhotoSizeWithSize != null) {
                if (jArr != null) {
                    long j = closestPhotoSizeWithSize.size;
                    jArr[0] = j;
                    if (j == 0) {
                        jArr[0] = -1;
                    }
                }
                return closestPhotoSizeWithSize;
            }
            if (jArr != null) {
                jArr[0] = -1;
            }
        } else {
            TLRPC.MessageMedia messageMedia = messageObject.sponsoredMedia;
            if (messageMedia != null) {
                TLRPC.Document document = messageMedia.document;
                if (document != null) {
                    TLRPC.PhotoSize closestPhotoSizeWithSize2 = FileLoader.getClosestPhotoSizeWithSize(document.thumbs, 90);
                    if (jArr != null) {
                        long j2 = closestPhotoSizeWithSize2.size;
                        jArr[0] = j2;
                        if (j2 == 0) {
                            jArr[0] = -1;
                        }
                    }
                    return closestPhotoSizeWithSize2;
                }
                TLRPC.Photo photo = messageMedia.photo;
                if (photo != null) {
                    TLRPC.PhotoSize closestPhotoSizeWithSize3 = FileLoader.getClosestPhotoSizeWithSize(photo.sizes, AndroidUtilities.getPhotoSize(), false, null, true);
                    if (closestPhotoSizeWithSize3 != null) {
                        if (jArr != null) {
                            long j3 = closestPhotoSizeWithSize3.size;
                            jArr[0] = j3;
                            if (j3 == 0) {
                                jArr[0] = -1;
                            }
                        }
                        return closestPhotoSizeWithSize3;
                    }
                    if (jArr != null) {
                        jArr[0] = -1;
                    }
                }
            } else if (((MessageObject.getMedia(message) instanceof TLRPC.TL_messageMediaPhoto) && MessageObject.getMedia(messageObject.messageOwner).photo != null) || ((MessageObject.getMedia(messageObject.messageOwner) instanceof TLRPC.TL_messageMediaWebPage) && MessageObject.getMedia(messageObject.messageOwner).webpage != null)) {
                TLRPC.PhotoSize closestPhotoSizeWithSize4 = FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, AndroidUtilities.getPhotoSize(true), false, null, true);
                if (closestPhotoSizeWithSize4 != null) {
                    if (jArr != null) {
                        long j4 = closestPhotoSizeWithSize4.size;
                        jArr[0] = j4;
                        if (j4 == 0) {
                            jArr[0] = -1;
                        }
                    }
                    return closestPhotoSizeWithSize4;
                }
                if (jArr != null) {
                    jArr[0] = -1;
                }
            } else {
                if (MessageObject.getMedia(messageObject.messageOwner) instanceof TLRPC.TL_messageMediaInvoice) {
                    return ((TLRPC.TL_messageMediaInvoice) MessageObject.getMedia(messageObject.messageOwner)).photo;
                }
                if (messageObject.getDocument() != null && MessageObject.isDocumentHasThumb(messageObject.getDocument())) {
                    TLRPC.PhotoSize closestPhotoSizeWithSize5 = FileLoader.getClosestPhotoSizeWithSize(messageObject.getDocument().thumbs, 90);
                    if (jArr != null) {
                        long j5 = closestPhotoSizeWithSize5.size;
                        jArr[0] = j5;
                        if (j5 == 0) {
                            jArr[0] = -1;
                        }
                    }
                    return closestPhotoSizeWithSize5;
                }
            }
        }
        return null;
    }

    public static TLRPC.FileLocation getFileLocation(ImageLocation imageLocation) {
        if (imageLocation == null) {
            return null;
        }
        return imageLocation.location;
    }

    public static String getFileLocationExt(ImageLocation imageLocation) {
        if (imageLocation == null || imageLocation.imageType != 2) {
            return null;
        }
        return "mp4";
    }

    private String getFileName(int i) {
        if (i < 0) {
            return null;
        }
        if (!this.secureDocuments.isEmpty()) {
            if (i >= this.secureDocuments.size()) {
                return null;
            }
            SecureDocument secureDocument = (SecureDocument) this.secureDocuments.get(i);
            return secureDocument.secureFile.dc_id + "_" + secureDocument.secureFile.id + ".jpg";
        }
        if (!this.imagesArrLocations.isEmpty() || !this.imagesArr.isEmpty()) {
            if (this.imagesArrLocations.isEmpty()) {
                if (i >= this.imagesArr.size()) {
                    return null;
                }
                return FileLoader.getMessageFileName(((MessageObject) this.imagesArr.get(i)).messageOwner);
            }
            if (i >= this.imagesArrLocations.size()) {
                return null;
            }
            ImageLocation imageLocation = (ImageLocation) this.imagesArrLocations.get(i);
            ImageLocation imageLocation2 = (ImageLocation) this.imagesArrLocationsVideo.get(i);
            if (imageLocation == null) {
                return null;
            }
            if (imageLocation2 == null || imageLocation2 == imageLocation) {
                return imageLocation.location.volume_id + "_" + imageLocation.location.local_id + ".jpg";
            }
            return imageLocation2.location.volume_id + "_" + imageLocation2.location.local_id + ".mp4";
        }
        if (this.imagesArrLocals.isEmpty()) {
            PageBlocksAdapter pageBlocksAdapter = this.pageBlocksAdapter;
            if (pageBlocksAdapter != null) {
                return pageBlocksAdapter.getFileName(i);
            }
        } else {
            if (i >= this.imagesArrLocals.size()) {
                return null;
            }
            Object obj = this.imagesArrLocals.get(i);
            if (obj instanceof MediaController.SearchImage) {
                return ((MediaController.SearchImage) obj).getAttachName();
            }
            if (obj instanceof TLRPC.BotInlineResult) {
                TLRPC.BotInlineResult botInlineResult = (TLRPC.BotInlineResult) obj;
                TLRPC.Document document = botInlineResult.document;
                if (document != null) {
                    return FileLoader.getAttachFileName(document);
                }
                TLRPC.Photo photo = botInlineResult.photo;
                if (photo != null) {
                    return FileLoader.getAttachFileName(FileLoader.getClosestPhotoSizeWithSize(photo.sizes, AndroidUtilities.getPhotoSize()));
                }
                if (botInlineResult.content instanceof TLRPC.TL_webDocument) {
                    StringBuilder sb = new StringBuilder();
                    sb.append(Utilities.MD5(botInlineResult.content.url));
                    sb.append(".");
                    TLRPC.WebDocument webDocument = botInlineResult.content;
                    sb.append(ImageLoader.getHttpUrlExtension(webDocument.url, FileLoader.getMimeTypePart(webDocument.mime_type)));
                    return sb.toString();
                }
            }
        }
        return null;
    }

    private ImageLocation getImageLocation(int i, long[] jArr) {
        if (i < 0) {
            return null;
        }
        if (!this.secureDocuments.isEmpty()) {
            if (i >= this.secureDocuments.size()) {
                return null;
            }
            if (jArr != null) {
                jArr[0] = ((SecureDocument) this.secureDocuments.get(i)).secureFile.size;
            }
            return ImageLocation.getForSecureDocument((SecureDocument) this.secureDocuments.get(i));
        }
        if (!this.imagesArrLocations.isEmpty()) {
            if (i >= this.imagesArrLocations.size()) {
                return null;
            }
            if (jArr != null && this.imagesArrLocationsSizes.get(i) != null) {
                jArr[0] = ((Long) this.imagesArrLocationsSizes.get(i)).longValue();
            }
            return (ImageLocation) this.imagesArrLocationsVideo.get(i);
        }
        if (this.imagesArr.isEmpty() || i >= this.imagesArr.size()) {
            return null;
        }
        MessageObject messageObject = (MessageObject) this.imagesArr.get(i);
        TLRPC.Message message = messageObject.messageOwner;
        if (!(message instanceof TLRPC.TL_messageService)) {
            TLRPC.MessageMedia messageMedia = messageObject.sponsoredMedia;
            if (messageMedia != null) {
                TLRPC.Document document = messageMedia.document;
                if (document != null) {
                    return ImageLocation.getForDocument(document);
                }
                TLRPC.Photo photo = messageMedia.photo;
                if (photo != null) {
                    TLRPC.PhotoSize closestPhotoSizeWithSize = FileLoader.getClosestPhotoSizeWithSize(photo.sizes, AndroidUtilities.getPhotoSize(), false, null, true);
                    if (closestPhotoSizeWithSize != null) {
                        if (jArr != null) {
                            long j = closestPhotoSizeWithSize.size;
                            jArr[0] = j;
                            if (j == 0) {
                                jArr[0] = -1;
                            }
                        }
                        return ImageLocation.getForObject(closestPhotoSizeWithSize, messageObject.sponsoredMedia.photo);
                    }
                    if (jArr != null) {
                        jArr[0] = -1;
                    }
                }
            } else if ((!(MessageObject.getMedia(message) instanceof TLRPC.TL_messageMediaPhoto) || MessageObject.getMedia(messageObject.messageOwner).photo == null) && (!(MessageObject.getMedia(messageObject.messageOwner) instanceof TLRPC.TL_messageMediaWebPage) || MessageObject.getMedia(messageObject.messageOwner).webpage == null)) {
                if (MessageObject.getMedia(messageObject.messageOwner) instanceof TLRPC.TL_messageMediaInvoice) {
                    return ImageLocation.getForWebFile(WebFile.createWithWebDocument(((TLRPC.TL_messageMediaInvoice) MessageObject.getMedia(messageObject.messageOwner)).webPhoto));
                }
                if (messageObject.getDocument() != null) {
                    TLRPC.Document document2 = messageObject.getDocument();
                    if (this.sharedMediaType == 5) {
                        return ImageLocation.getForDocument(document2);
                    }
                    if (MessageObject.isDocumentHasThumb(messageObject.getDocument())) {
                        TLRPC.PhotoSize closestPhotoSizeWithSize2 = FileLoader.getClosestPhotoSizeWithSize(document2.thumbs, 90);
                        if (jArr != null) {
                            long j2 = closestPhotoSizeWithSize2.size;
                            jArr[0] = j2;
                            if (j2 == 0) {
                                jArr[0] = -1;
                            }
                        }
                        return ImageLocation.getForDocument(closestPhotoSizeWithSize2, document2);
                    }
                }
            } else {
                if (messageObject.isGif()) {
                    return ImageLocation.getForDocument(messageObject.getDocument());
                }
                TLRPC.PhotoSize closestPhotoSizeWithSize3 = FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, AndroidUtilities.getPhotoSize(true), false, null, true);
                if (closestPhotoSizeWithSize3 != null) {
                    if (jArr != null) {
                        long j3 = closestPhotoSizeWithSize3.size;
                        jArr[0] = j3;
                        if (j3 == 0) {
                            jArr[0] = -1;
                        }
                    }
                    return ImageLocation.getForObject(closestPhotoSizeWithSize3, messageObject.photoThumbsObject);
                }
                if (jArr != null) {
                    jArr[0] = -1;
                }
            }
        } else {
            if (message.action instanceof TLRPC.TL_messageActionUserUpdatedPhoto) {
                return null;
            }
            TLRPC.PhotoSize closestPhotoSizeWithSize4 = FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, AndroidUtilities.getPhotoSize());
            if (closestPhotoSizeWithSize4 != null) {
                if (jArr != null) {
                    long j4 = closestPhotoSizeWithSize4.size;
                    jArr[0] = j4;
                    if (j4 == 0) {
                        jArr[0] = -1;
                    }
                }
                return ImageLocation.getForObject(closestPhotoSizeWithSize4, messageObject.photoThumbsObject);
            }
            if (jArr != null) {
                jArr[0] = -1;
            }
        }
        return null;
    }

    public static PhotoViewer getInstance() {
        PhotoViewer photoViewer = Instance;
        if (photoViewer == null) {
            synchronized (PhotoViewer.class) {
                try {
                    photoViewer = Instance;
                    if (photoViewer == null) {
                        photoViewer = new PhotoViewer();
                        Instance = photoViewer;
                    }
                } finally {
                }
            }
        }
        return photoViewer;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int getLeftInset() {
        return this.insets.left;
    }

    public static PhotoViewer getPipInstance() {
        return PipInstance;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int getRightInset() {
        return this.insets.right;
    }

    public static float getSavedProgress(MessageObject messageObject) {
        int duration = (int) messageObject.getDuration();
        String fileNameFast = messageObject.isEmbedVideo() ? messageObject.messageOwner.media.webpage.url : messageObject.getFileNameFast();
        if (!TextUtils.isEmpty(fileNameFast)) {
            if (duration >= 10) {
                SavedVideoPosition savedVideoPosition = (SavedVideoPosition) savedVideoPositions.get(fileNameFast);
                if (messageObject.forceSeekTo < BitmapDescriptorFactory.HUE_RED && savedVideoPosition != null) {
                    float f = savedVideoPosition.position;
                    if (f > BitmapDescriptorFactory.HUE_RED && f < 0.999f) {
                        return f;
                    }
                }
            }
            if (duration >= 120 && messageObject.forceSeekTo < BitmapDescriptorFactory.HUE_RED) {
                float f2 = ApplicationLoader.applicationContext.getSharedPreferences("media_saved_pos", 0).getFloat(fileNameFast, -1.0f);
                if (f2 > BitmapDescriptorFactory.HUE_RED && f2 < 0.999f) {
                    return f2;
                }
            }
        }
        return BitmapDescriptorFactory.HUE_RED;
    }

    public static float getSavedProgressFast(MessageObject messageObject) {
        int duration = (int) messageObject.getDuration();
        String fileNameFast = messageObject.isEmbedVideo() ? messageObject.messageOwner.media.webpage.url : messageObject.getFileNameFast();
        if (!TextUtils.isEmpty(fileNameFast) && duration >= 10) {
            SavedVideoPosition savedVideoPosition = (SavedVideoPosition) savedVideoPositions.get(fileNameFast);
            if (messageObject.forceSeekTo < BitmapDescriptorFactory.HUE_RED && savedVideoPosition != null) {
                float f = savedVideoPosition.position;
                if (f > BitmapDescriptorFactory.HUE_RED && f < 0.999f) {
                    return f;
                }
            }
        }
        return BitmapDescriptorFactory.HUE_RED;
    }

    public static String getTempFileAbsolutePath() {
        return new File(FileLoader.getDirectory(4), SharedConfig.getLastLocalId() + "_temp.jpg").getAbsolutePath();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int getThemedColor(int i) {
        Theme.ResourcesProvider resourcesProvider = this.resourcesProvider;
        return resourcesProvider != null ? resourcesProvider.getColor(i) : Theme.getColor(i);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public long getVideoDuration() {
        PhotoViewerWebView photoViewerWebView = this.photoViewerWebView;
        if (photoViewerWebView != null && photoViewerWebView.isControllable()) {
            return this.photoViewerWebView.getVideoDuration();
        }
        VideoPlayer videoPlayer = this.videoPlayer;
        if (videoPlayer == null) {
            return 0L;
        }
        return videoPlayer.getDuration();
    }

    private void goToNext() {
        float containerViewWidth = this.scale != 1.0f ? ((getContainerViewWidth() - this.centerImage.getImageWidth()) / 2.0f) * this.scale : BitmapDescriptorFactory.HUE_RED;
        this.switchImageAfterAnimation = 1;
        animateTo(this.scale, ((this.minX - getContainerViewWidth()) - containerViewWidth) - (AndroidUtilities.dp(30.0f) / 2), this.translationY, false);
    }

    private void goToPrev() {
        float containerViewWidth = this.scale != 1.0f ? ((getContainerViewWidth() - this.centerImage.getImageWidth()) / 2.0f) * this.scale : BitmapDescriptorFactory.HUE_RED;
        this.switchImageAfterAnimation = 2;
        animateTo(this.scale, this.maxX + getContainerViewWidth() + containerViewWidth + (AndroidUtilities.dp(30.0f) / 2), this.translationY, false);
    }

    private boolean hasAnimatedMediaEntities() {
        return getAnimatedMediaEntitiesCount(true) != 0;
    }

    public static boolean hasInstance() {
        return Instance != null;
    }

    private void hidePressedDrawables() {
        boolean[] zArr = this.drawPressedDrawable;
        zArr[1] = false;
        zArr[0] = false;
        this.containerView.invalidate();
    }

    private void initCropView() {
        PhotoCropView photoCropView = this.photoCropView;
        if (photoCropView == null) {
            return;
        }
        photoCropView.setBitmap(null, 0, false, false, null, null, null, null);
        if (this.sendPhotoType != 1) {
            return;
        }
        this.photoCropView.onAppear();
        this.photoCropView.setVisibility(0);
        this.photoCropView.setAlpha(1.0f);
        this.photoCropView.onAppeared();
        this.padImageForHorizontalInsets = true;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void initEmbedVideo(int i) {
        if (this.isEmbedVideo) {
            PhotoViewerWebView photoViewerWebView = new PhotoViewerWebView(this, this.parentActivity, this.pipItem) { // from class: org.telegram.ui.PhotoViewer.78
                Rect rect = new Rect();

                @Override // org.telegram.ui.Components.PhotoViewerWebView
                protected void drawBlackBackground(Canvas canvas, int i2, int i3) {
                    Bitmap bitmap = PhotoViewer.this.centerImage.getBitmap();
                    if (bitmap != null) {
                        float fMin = Math.min(i2 / bitmap.getWidth(), i3 / bitmap.getHeight());
                        int width = (int) (bitmap.getWidth() * fMin);
                        int height = (int) (bitmap.getHeight() * fMin);
                        int i4 = (i3 - height) / 2;
                        int i5 = (i2 - width) / 2;
                        this.rect.set(i5, i4, width + i5, height + i4);
                        canvas.drawBitmap(bitmap, (Rect) null, this.rect, (Paint) null);
                    }
                }

                @Override // org.telegram.ui.Components.PhotoViewerWebView
                protected void processTouch(MotionEvent motionEvent) {
                }
            };
            this.photoViewerWebView = photoViewerWebView;
            photoViewerWebView.init(i, MessageObject.getMedia(this.currentMessageObject.messageOwner).webpage);
            this.photoViewerWebView.setPlaybackSpeed(this.currentVideoSpeed);
            this.containerView.addView(this.photoViewerWebView, 0, LayoutHelper.createFrame(-1, -1.0f));
            if (this.photoViewerWebView.isControllable()) {
                setVideoPlayerControlVisible(true, true);
            }
            this.videoPlayerSeekbar.clearTimestamps();
            updateVideoPlayerTime();
            this.shouldSavePositionForCurrentVideo = null;
            this.shouldSavePositionForCurrentVideoShortTerm = null;
            this.lastSaveTime = 0L;
            this.seekToProgressPending = this.seekToProgressPending2;
            this.videoPlayerSeekbar.setProgress(BitmapDescriptorFactory.HUE_RED);
            this.videoTimelineView.setProgress(BitmapDescriptorFactory.HUE_RED);
            this.videoPlayerSeekbar.setBufferedProgress(BitmapDescriptorFactory.HUE_RED);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void invalidateBlur() {
        StickerMakerView stickerMakerView = this.stickerMakerView;
        if (stickerMakerView == null || !stickerMakerView.isThanosInProgress) {
            CaptionPhotoViewer captionPhotoViewer = this.captionEdit;
            if (captionPhotoViewer != null) {
                captionPhotoViewer.invalidateBlur();
            }
            CaptionPhotoViewer captionPhotoViewer2 = this.topCaptionEdit;
            if (captionPhotoViewer2 != null) {
                captionPhotoViewer2.invalidateBlur();
            }
            BlurButton blurButton = this.cutOutBtn;
            if (blurButton != null) {
                blurButton.invalidateBlur();
            }
            BlurButton blurButton2 = this.eraseBtn;
            if (blurButton2 != null) {
                blurButton2.invalidateBlur();
            }
            BlurButton blurButton3 = this.restoreBtn;
            if (blurButton3 != null) {
                blurButton3.invalidateBlur();
            }
            BlurButton blurButton4 = this.undoBtn;
            if (blurButton4 != null) {
                blurButton4.invalidateBlur();
            }
            BlurButton blurButton5 = this.outlineBtn;
            if (blurButton5 != null) {
                blurButton5.invalidateBlur();
            }
            VideoTimelinePlayView videoTimelinePlayView = this.videoTimelineView;
            if (videoTimelinePlayView != null) {
                videoTimelinePlayView.invalidateBlur();
            }
            FrameLayoutDrawer frameLayoutDrawer = this.containerView;
            if (frameLayoutDrawer != null) {
                frameLayoutDrawer.invalidate();
            }
        }
    }

    private boolean isAccessibilityEnabled() {
        try {
            AccessibilityManager accessibilityManager = (AccessibilityManager) this.activityContext.getSystemService("accessibility");
            if (accessibilityManager.isEnabled()) {
                return accessibilityManager.isTouchExplorationEnabled();
            }
            return false;
        } catch (Exception e) {
            FileLog.e(e);
            return false;
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public boolean isCaptionOpen() {
        CaptionContainerView captionView = getCaptionView();
        return captionView != null && (captionView.keyboardNotifier.keyboardVisible() || captionView.editText.isPopupShowing());
    }

    /* JADX INFO: Access modifiers changed from: private */
    public boolean isCurrentAvatarSet() {
        int i;
        if (this.currentAvatarLocation != null && (i = this.currentIndex) >= 0 && i < this.avatarsArr.size()) {
            TLRPC.Photo photo = (TLRPC.Photo) this.avatarsArr.get(this.currentIndex);
            ImageLocation imageLocation = (ImageLocation) this.imagesArrLocations.get(this.currentIndex);
            if (photo instanceof TLRPC.TL_photoEmpty) {
                photo = null;
            }
            if (photo != null) {
                int size = photo.sizes.size();
                for (int i2 = 0; i2 < size; i2++) {
                    TLRPC.FileLocation fileLocation = ((TLRPC.PhotoSize) photo.sizes.get(i2)).location;
                    if (fileLocation != null) {
                        int i3 = fileLocation.local_id;
                        TLRPC.TL_fileLocationToBeDeprecated tL_fileLocationToBeDeprecated = this.currentAvatarLocation.location;
                        if (i3 == tL_fileLocationToBeDeprecated.local_id && fileLocation.volume_id == tL_fileLocationToBeDeprecated.volume_id) {
                            return true;
                        }
                    }
                }
            } else if (imageLocation != null) {
                TLRPC.TL_fileLocationToBeDeprecated tL_fileLocationToBeDeprecated2 = imageLocation.location;
                int i4 = tL_fileLocationToBeDeprecated2.local_id;
                TLRPC.TL_fileLocationToBeDeprecated tL_fileLocationToBeDeprecated3 = this.currentAvatarLocation.location;
                if (i4 == tL_fileLocationToBeDeprecated3.local_id && tL_fileLocationToBeDeprecated2.volume_id == tL_fileLocationToBeDeprecated3.volume_id) {
                    return true;
                }
            }
        }
        return false;
    }

    public static boolean isPlayingMessage(MessageObject messageObject) {
        return (Instance == null || Instance.pipAnimationInProgress || !Instance.isVisible || messageObject == null || Instance.currentMessageObject == null || Instance.currentMessageObject.getId() != messageObject.getId() || Instance.currentMessageObject.getDialogId() != messageObject.getDialogId()) ? false : true;
    }

    public static boolean isPlayingMessageInPip(MessageObject messageObject) {
        return (PipInstance == null || messageObject == null || PipInstance.currentMessageObject == null || PipInstance.currentMessageObject.getId() != messageObject.getId() || PipInstance.currentMessageObject.getDialogId() != messageObject.getDialogId()) ? false : true;
    }

    public static boolean isShowingImage(String str) {
        return (Instance == null || !Instance.isVisible || Instance.disableShowCheck || str == null || !str.equals(Instance.currentPathObject)) ? false : true;
    }

    /* JADX WARN: Removed duplicated region for block: B:22:0x0048  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public static boolean isShowingImage(MessageObject messageObject) {
        boolean z;
        if (Instance == null || Instance.pipAnimationInProgress || !Instance.isVisible || Instance.disableShowCheck || messageObject == null) {
            z = false;
        } else {
            MessageObject editingMessageObject = Instance.currentMessageObject;
            if (editingMessageObject == null && Instance.placeProvider != null) {
                editingMessageObject = Instance.placeProvider.getEditingMessageObject();
            }
            if (editingMessageObject != null && editingMessageObject.getId() == messageObject.getId() && editingMessageObject.getDialogId() == messageObject.getDialogId()) {
                z = true;
            }
        }
        return (z || PipInstance == null) ? z : PipInstance.isVisible && !PipInstance.disableShowCheck && messageObject != null && PipInstance.currentMessageObject != null && PipInstance.currentMessageObject.getId() == messageObject.getId() && PipInstance.currentMessageObject.getDialogId() == messageObject.getDialogId();
    }

    public static boolean isShowingImage(TLRPC.BotInlineResult botInlineResult) {
        return (Instance == null || !Instance.isVisible || Instance.disableShowCheck || botInlineResult == null || Instance.currentBotInlineResult == null || botInlineResult.id != Instance.currentBotInlineResult.id) ? false : true;
    }

    public static boolean isShowingImage(TLRPC.FileLocation fileLocation) {
        if (Instance == null || !Instance.isVisible || Instance.disableShowCheck || fileLocation == null) {
            return false;
        }
        return (Instance.currentFileLocation != null && fileLocation.local_id == Instance.currentFileLocation.location.local_id && fileLocation.volume_id == Instance.currentFileLocation.location.volume_id && fileLocation.dc_id == Instance.currentFileLocation.dc_id) || (Instance.currentFileLocationVideo != null && fileLocation.local_id == Instance.currentFileLocationVideo.location.local_id && fileLocation.volume_id == Instance.currentFileLocationVideo.location.volume_id && fileLocation.dc_id == Instance.currentFileLocationVideo.dc_id);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public boolean isStatusBarVisible() {
        return Build.VERSION.SDK_INT >= 21 && !this.inBubbleMode;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public boolean isVideoPlaying() {
        PhotoViewerWebView photoViewerWebView = this.photoViewerWebView;
        if (photoViewerWebView != null && photoViewerWebView.isControllable()) {
            return this.photoViewerWebView.isPlaying();
        }
        VideoPlayer videoPlayer = this.videoPlayer;
        return videoPlayer != null && videoPlayer.isPlaying();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$checkChangedTextureView$3(ValueAnimator valueAnimator) {
        this.clippingImageProgress = 1.0f - ((Float) valueAnimator.getAnimatedValue()).floatValue();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$checkChangedTextureView$4(View view, ValueAnimator valueAnimator) {
        this.inlineOutAnimationProgress = ((Float) valueAnimator.getAnimatedValue()).floatValue();
        view.invalidateOutline();
        ImageView imageView = this.textureImageView;
        if (imageView != null) {
            imageView.invalidateOutline();
        }
        FirstFrameView firstFrameView = this.firstFrameView;
        if (firstFrameView != null) {
            firstFrameView.invalidateOutline();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ File lambda$checkProgress$126(TLObject tLObject) {
        return FileLoader.getInstance(this.currentAccount).getPathToAttach(tLObject, true);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ File lambda$checkProgress$127(TLRPC.Message message) {
        return FileLoader.getInstance(this.currentAccount).getPathToMessage(message);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$checkProgress$128(int i, File file, File file2, boolean z, boolean z2, boolean z3, boolean z4, boolean z5) {
        boolean z6 = false;
        if (this.shownControlsByEnd && !this.actionBarWasShownBeforeByEnd && this.isPlaying) {
            this.photoProgressViews[i].setBackgroundState(3, false, false);
            return;
        }
        if (!(file == null && file2 == null) && (z || z2)) {
            if (i != 0 || !this.isPlaying) {
                if (!z3 || (z4 && !(i == 0 && this.playerWasPlaying))) {
                    this.photoProgressViews[i].setBackgroundState(-1, z5, true);
                } else {
                    this.photoProgressViews[i].setBackgroundState(3, z5, true);
                }
            }
            if (i == 0 && !this.menuItem.isSubMenuShowing()) {
                if (z || !FileLoader.getInstance(this.currentAccount).isLoadingFile(this.currentFileNames[i])) {
                    this.menuItem.hideSubItem(8);
                } else {
                    this.menuItem.showSubItem(8);
                }
            }
        } else {
            if (!z3) {
                this.photoProgressViews[i].setBackgroundState(0, z5, true);
            } else if (FileLoader.getInstance(this.currentAccount).isLoadingFile(this.currentFileNames[i])) {
                this.photoProgressViews[i].setBackgroundState(1, false, true);
            } else {
                this.photoProgressViews[i].setBackgroundState(2, false, true);
            }
            Float fileProgress = ImageLoader.getInstance().getFileProgress(this.currentFileNames[i]);
            if (fileProgress == null) {
                fileProgress = Float.valueOf(BitmapDescriptorFactory.HUE_RED);
            }
            this.photoProgressViews[i].setProgress(fileProgress.floatValue(), false);
        }
        if (i == 0) {
            if (!this.isEmbedVideo && (!this.imagesArrLocals.isEmpty() || (this.currentFileNames[0] != null && this.photoProgressViews[0].backgroundState != 0))) {
                z6 = true;
            }
            this.canZoom = z6;
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$checkProgress$129(boolean z, final File file, File file2, FileLoader.FileResolver fileResolver, final int i, MessageObject messageObject, final boolean z2, final boolean z3, final boolean z4, final boolean z5) {
        final File file3;
        ChatActivity chatActivity;
        TLRPC.Document document;
        boolean zExists = (z || file == null) ? z : file.exists();
        if (file2 != null || fileResolver == null) {
            file = fileResolver != null ? fileResolver.getFile() : null;
            file3 = file2;
        } else {
            file3 = fileResolver.getFile();
        }
        if (!zExists && file3 != null) {
            zExists = file3.exists();
        }
        if (!zExists && file != null) {
            zExists = file.exists();
        }
        final boolean z6 = zExists;
        if (!z6 && i != 0 && messageObject != null && z2 && DownloadController.getInstance(this.currentAccount).canDownloadMedia(messageObject.messageOwner) != 0 && (((chatActivity = this.parentChatActivity) == null || chatActivity.getCurrentEncryptedChat() == null) && !messageObject.shouldEncryptPhotoOrVideo() && (document = messageObject.getDocument()) != null)) {
            FileLoader.getInstance(this.currentAccount).loadFile(document, messageObject, 0, 10);
        }
        AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda110
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$checkProgress$128(i, file, file3, z6, z2, z3, z4, z5);
            }
        });
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$closePaintMode$112() {
        switchToEditMode(0);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$closePhoto$131(MaskPaintView maskPaintView) {
        maskPaintView.shutdown();
        this.containerView.removeView(this.maskPaintView);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$closePhoto$132(AnimatedFileDrawable animatedFileDrawable, TLRPC.Document document, long j, PlaceProviderObject placeProviderObject) {
        ImageReceiver imageReceiver;
        if (animatedFileDrawable != null && document != null) {
            FileLog.d("seeking from photo viewer to animation object");
            animatedFileDrawable.seekTo(j, !FileLoader.getInstance(this.currentAccount).isLoadingVideo(document, true), true);
        }
        if (placeProviderObject == null || (imageReceiver = placeProviderObject.imageReceiver) == null) {
            return;
        }
        imageReceiver.setAllowStartAnimation(true);
        placeProviderObject.imageReceiver.startAnimation();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$closePhoto$133(ValueAnimator valueAnimator) {
        this.clippingImageProgress = ((Float) valueAnimator.getAnimatedValue()).floatValue();
        invalidateBlur();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$closePhoto$134(ValueAnimator valueAnimator) {
        this.clippingImageProgress = ((Float) valueAnimator.getAnimatedValue()).floatValue();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$closePhoto$135(PlaceProviderObject placeProviderObject) {
        ArrayList arrayList;
        this.animationEndRunnable = null;
        this.containerView.setLayerType(0, null);
        this.animationInProgress = 0;
        invalidateBlur();
        onPhotoClosed(placeProviderObject);
        MediaController.getInstance().tryResumePausedAudio();
        if (!this.stickerEmpty || this.stickerEmptySent || (arrayList = this.imagesArrLocals) == null) {
            return;
        }
        Iterator it = arrayList.iterator();
        while (it.hasNext()) {
            Object next = it.next();
            if (next instanceof MediaController.PhotoEntry) {
                ((MediaController.PhotoEntry) next).deleteAll();
            }
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$closePhoto$136(PlaceProviderObject placeProviderObject, AnimatorSet animatorSet) {
        if (placeProviderObject != null) {
            placeProviderObject.imageReceiver.setVisible(false, true);
        }
        if (!this.doneButtonPressed) {
            releasePlayer(true);
        }
        this.animationInProgress = 3;
        this.containerView.invalidate();
        this.transitionAnimationStartTime = System.currentTimeMillis();
        this.containerView.setLayerType(2, null);
        animatorSet.start();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$closePhoto$137(ValueAnimator valueAnimator) {
        this.clippingImageProgress = ((Float) valueAnimator.getAnimatedValue()).floatValue();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$closePhoto$138(PlaceProviderObject placeProviderObject) {
        ArrayList arrayList;
        this.animationEndRunnable = null;
        FrameLayoutDrawer frameLayoutDrawer = this.containerView;
        if (frameLayoutDrawer == null) {
            return;
        }
        frameLayoutDrawer.setLayerType(0, null);
        this.animationInProgress = 0;
        onPhotoClosed(placeProviderObject);
        this.containerView.setScaleX(1.0f);
        this.containerView.setScaleY(1.0f);
        MediaController.getInstance().tryResumePausedAudio();
        if (!this.stickerEmpty || this.stickerEmptySent || (arrayList = this.imagesArrLocals) == null) {
            return;
        }
        Iterator it = arrayList.iterator();
        while (it.hasNext()) {
            Object next = it.next();
            if (next instanceof MediaController.PhotoEntry) {
                ((MediaController.PhotoEntry) next).deleteAll();
            }
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$closePhoto$139(AnimatorSet animatorSet, PlaceProviderObject placeProviderObject) {
        if (!this.doneButtonPressed) {
            releasePlayer(true);
        }
        this.animationInProgress = 2;
        this.transitionAnimationStartTime = System.currentTimeMillis();
        this.containerView.setLayerType(2, null);
        animatorSet.start();
        if (placeProviderObject != null) {
            placeProviderObject.imageReceiver.setVisible(true, true);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$createAdButtonView$154(View view) {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || !messageObject.isSponsored()) {
            return;
        }
        BaseFragment baseFragment = this.parentFragment;
        if (baseFragment instanceof ChatActivity) {
            ((ChatActivity) baseFragment).logSponsoredClicked(this.currentMessageObject, false, true);
        }
        closePhoto(true, false);
        String str = this.currentMessageObject.sponsoredUrl;
        if (str != null) {
            Context context = LaunchActivity.instance;
            if (context == null) {
                context = this.activityContext;
            }
            Browser.openUrl(context, Uri.parse(str), true, false, false, null, null, false, MessagesController.getInstance(this.currentAccount).sponsoredLinksInappAllow, false);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$createMaskPaintView$104(View view) {
        this.eraseBtn.setActive(false, true);
        this.restoreBtn.setActive(false, true);
        switchToEditMode(0);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$createMaskPaintView$105(View view) {
        this.eraseBtn.setActive(false, true);
        this.restoreBtn.setActive(false, true);
        applyCurrentEditMode();
        switchToEditMode(0);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$createPaintView$106(ValueAnimator valueAnimator) {
        LPhotoPaintView lPhotoPaintView = this.photoPaintView;
        if (lPhotoPaintView != null) {
            lPhotoPaintView.overlayLayout.invalidate();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$createPaintView$107(Integer num) {
        this.photoPaintView.keyboardVisible = this.paintKeyboardNotifier.keyboardVisible();
        this.containerView.invalidate();
        int iMax = Math.max(num.intValue(), this.photoPaintView.getEmojiPadding(false));
        boolean zIsCurrentText = this.photoPaintView.isCurrentText();
        float f = BitmapDescriptorFactory.HUE_RED;
        translateY((!zIsCurrentText || iMax <= 0) ? BitmapDescriptorFactory.HUE_RED : ((AndroidUtilities.displaySize.y - iMax) - AndroidUtilities.dp(80.0f)) - this.photoPaintView.getSelectedEntityBottom());
        AnimatorSet animatorSet = this.paintKeyboardAnimator;
        if (animatorSet != null) {
            animatorSet.cancel();
        }
        ValueAnimator valueAnimatorOfFloat = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f);
        valueAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda168
            @Override // android.animation.ValueAnimator.AnimatorUpdateListener
            public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                this.f$0.lambda$createPaintView$106(valueAnimator);
            }
        });
        AnimatorSet animatorSet2 = new AnimatorSet();
        this.paintKeyboardAnimator = animatorSet2;
        PaintWeightChooserView paintWeightChooserView = this.photoPaintView.weightChooserView;
        Property property = View.TRANSLATION_Y;
        ObjectAnimator objectAnimatorOfFloat = ObjectAnimator.ofFloat(paintWeightChooserView, (Property<PaintWeightChooserView, Float>) property, (-iMax) / 2.5f);
        ObjectAnimator objectAnimatorOfFloat2 = ObjectAnimator.ofFloat(this.photoPaintView.bottomLayout, (Property<FrameLayout, Float>) property, Math.min(0, r11 + AndroidUtilities.dp(40.0f)));
        LinearLayout linearLayout = this.photoPaintView.tabsLayout;
        Property property2 = View.ALPHA;
        ObjectAnimator objectAnimatorOfFloat3 = ObjectAnimator.ofFloat(linearLayout, (Property<LinearLayout, Float>) property2, iMax > AndroidUtilities.dp(20.0f) ? BitmapDescriptorFactory.HUE_RED : 1.0f);
        ObjectAnimator objectAnimatorOfFloat4 = ObjectAnimator.ofFloat(this.photoPaintView.cancelButton, (Property<PaintCancelView, Float>) property2, iMax > AndroidUtilities.dp(20.0f) ? BitmapDescriptorFactory.HUE_RED : 1.0f);
        PaintDoneView paintDoneView = this.photoPaintView.doneButton;
        if (iMax <= AndroidUtilities.dp(20.0f)) {
            f = 1.0f;
        }
        animatorSet2.playTogether(objectAnimatorOfFloat, objectAnimatorOfFloat2, objectAnimatorOfFloat3, objectAnimatorOfFloat4, ObjectAnimator.ofFloat(paintDoneView, (Property<PaintDoneView, Float>) property2, f), valueAnimatorOfFloat);
        animatorSet2.setDuration(320L);
        animatorSet2.setInterpolator(CubicBezierInterpolator.EASE_OUT_QUINT);
        animatorSet2.start();
        this.photoPaintView.updatePlusEmojiKeyboardButton();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$createPaintView$108() {
        this.paintingOverlay.hideBitmap();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$createPaintView$109() {
        this.savedState = null;
        applyCurrentEditMode();
        switchToEditMode(0);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$createPaintView$110(View view) {
        closePaintMode();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$createVideoControlsInterface$89() {
        if (this.needShowOnReady) {
            showVideoSeekPreviewPosition(true);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$createVideoControlsInterface$90(View view) {
        Activity activity = this.parentActivity;
        if (activity == null) {
            return;
        }
        this.wasRotated = false;
        this.fullscreenedByButton = 2;
        if (this.prevOrientation == -10) {
            this.prevOrientation = activity.getRequestedOrientation();
        }
        this.parentActivity.setRequestedOrientation(1);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public static /* synthetic */ void lambda$createVideoTextureView$91(MediaController.SavedFilterState savedFilterState, FilterGLThread filterGLThread) {
        filterGLThread.setFilterGLThreadDelegate(FilterShaders.getFilterShadersDelegate(savedFilterState));
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$cropRotate$88(float f, float f2, ValueAnimator valueAnimator) {
        CropAreaView cropAreaView = this.photoCropView.cropView.areaView;
        float fFloatValue = ((Float) valueAnimator.getAnimatedValue()).floatValue() * f;
        float f3 = this.scale;
        cropAreaView.setRotationScaleTranslation(fFloatValue, f3 + ((this.animateToScale - f3) * this.animationValue), BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED);
        this.photoCropView.wheelView.setRotation(AndroidUtilities.lerp(f2, BitmapDescriptorFactory.HUE_RED, ((Float) valueAnimator.getAnimatedValue()).floatValue()), false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$detectFaces$95(String str, boolean z) {
        if (str.equals(this.centerImage.getImageKey())) {
            this.currentImageHasFace = z ? 1 : 0;
            this.currentImageFaceKey = str;
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$detectFaces$96(ImageReceiver.BitmapHolder bitmapHolder, String str) {
        bitmapHolder.release();
        if (str.equals(this.centerImage.getImageKey())) {
            this.currentImageHasFace = 2;
            this.currentImageFaceKey = str;
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$detectFaces$97(final ImageReceiver.BitmapHolder bitmapHolder, int i, final String str) {
        Runnable runnable;
        FaceDetector faceDetectorBuild = null;
        try {
            try {
                final boolean z = false;
                faceDetectorBuild = new FaceDetector.Builder(ApplicationLoader.applicationContext).setMode(0).setLandmarkType(0).setTrackingEnabled(false).build();
                if (faceDetectorBuild.isOperational()) {
                    SparseArray sparseArrayDetect = faceDetectorBuild.detect(new Frame.Builder().setBitmap(bitmapHolder.bitmap).setRotation(i).build());
                    if (sparseArrayDetect != null && sparseArrayDetect.size() != 0) {
                        z = true;
                    }
                    runnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda160
                        @Override // java.lang.Runnable
                        public final void run() {
                            this.f$0.lambda$detectFaces$95(str, z);
                        }
                    };
                } else {
                    if (BuildVars.LOGS_ENABLED) {
                        FileLog.e("face detection is not operational");
                    }
                    runnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda161
                        @Override // java.lang.Runnable
                        public final void run() {
                            this.f$0.lambda$detectFaces$96(bitmapHolder, str);
                        }
                    };
                }
                AndroidUtilities.runOnUIThread(runnable);
            } catch (Exception e) {
                FileLog.e(e);
                if (faceDetectorBuild == null) {
                    return;
                }
            }
            faceDetectorBuild.release();
        } catch (Throwable th) {
            if (faceDetectorBuild != null) {
                faceDetectorBuild.release();
            }
            throw th;
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$new$0() {
        toggleMiniProgressInternal(true);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$new$5() {
        if (this.isVisible && this.animationInProgress == 0) {
            updateContainerFlags(this.isActionBarVisible);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$onDraw$142() throws Resources.NotFoundException {
        switchToNextIndex(1, false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$onDraw$143() throws Resources.NotFoundException {
        switchToNextIndex(-1, false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$onDraw$144() {
        checkChangedTextureView(false);
        PipVideoOverlay.dismiss(true, true);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$onLinkLongPress$1(ClickableSpan clickableSpan, TextView textView, String str, boolean z, DialogInterface dialogInterface, int i) {
        int i2;
        String str2;
        if (i == 0) {
            onLinkClick(clickableSpan, textView);
            return;
        }
        if (i == 1) {
            AndroidUtilities.addToClipboard(str);
            if (z) {
                i2 = R.string.PhoneCopied;
                str2 = "PhoneCopied";
            } else if (str.startsWith("#")) {
                i2 = R.string.HashtagCopied;
                str2 = "HashtagCopied";
            } else if (str.startsWith("@")) {
                i2 = R.string.UsernameCopied;
                str2 = "UsernameCopied";
            } else {
                i2 = R.string.LinkCopied;
                str2 = "LinkCopied";
            }
            String string = LocaleController.getString(str2, i2);
            if (AndroidUtilities.shouldShowClipboardToast()) {
                BulletinFactory.of(this.containerView, this.resourcesProvider).createSimpleBulletin(R.raw.voip_invite, string).show();
            }
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$onPhotoClosed$140(PlaceProviderObject placeProviderObject) {
        ClippingImageView clippingImageView;
        this.animatingImageView.setImageBitmap(null);
        if (placeProviderObject != null && !AndroidUtilities.isTablet() && (clippingImageView = placeProviderObject.animatingImageView) != null) {
            clippingImageView.setImageBitmap(null);
        }
        try {
            if (this.windowView.getParent() != null) {
                ((WindowManager) this.parentActivity.getSystemService("window")).removeView(this.windowView);
                onHideView();
            }
        } catch (Exception e) {
            FileLog.e(e);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public static /* synthetic */ int lambda$onPhotoShow$119(MessageObject messageObject, MessageObject messageObject2) {
        return messageObject.getId() - messageObject2.getId();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$openAdsMenu$146(ItemOptions itemOptions, View view) {
        if (this.currentMessageObject == null) {
            return;
        }
        itemOptions.dismiss();
        BaseFragment baseFragment = this.parentFragment;
        if (baseFragment instanceof ChatActivity) {
            ((ChatActivity) baseFragment).logSponsoredClicked(this.currentMessageObject, false, true);
        }
        Browser.openUrl(this.activityContext, Uri.parse(this.currentMessageObject.sponsoredUrl), true, false, false, null, null, false, MessagesController.getInstance(this.currentAccount).sponsoredLinksInappAllow, false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ boolean lambda$openAdsMenu$147(Theme.ResourcesProvider resourcesProvider, View view) {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            return false;
        }
        if (!AndroidUtilities.addToClipboard(messageObject.sponsoredUrl)) {
            return true;
        }
        BulletinFactory.of(Bulletin.BulletinWindow.make(this.activityContext), resourcesProvider).createCopyLinkBulletin().show();
        return true;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$openAdsMenu$148(Theme.ResourcesProvider resourcesProvider, View view) {
        if (AndroidUtilities.addToClipboard(this.currentMessageObject.sponsoredInfo)) {
            BulletinFactory.of(Bulletin.BulletinWindow.make(this.activityContext), resourcesProvider).createCopyBulletin(LocaleController.getString(R.string.TextCopied)).show();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$openAdsMenu$149(Theme.ResourcesProvider resourcesProvider, View view) {
        if (AndroidUtilities.addToClipboard(this.currentMessageObject.sponsoredAdditionalInfo)) {
            BulletinFactory.of(Bulletin.BulletinWindow.make(this.activityContext), resourcesProvider).createCopyBulletin(LocaleController.getString(R.string.TextCopied)).show();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$openAdsMenu$151(int i, Theme.ResourcesProvider resourcesProvider) {
        if (!UserConfig.getInstance(i).isPremium()) {
            new PremiumFeatureBottomSheet(this.parentFragment, 3, true).show();
            return;
        }
        BulletinFactory.of(this.containerView, resourcesProvider).createAdReportedBulletin(LocaleController.getString(R.string.AdHidden)).show();
        MessagesController.getInstance(i).disableAds(true);
        BaseFragment baseFragment = this.parentFragment;
        if (baseFragment instanceof ChatActivity) {
            ChatActivity chatActivity = (ChatActivity) baseFragment;
            chatActivity.removeFromSponsored(this.currentMessageObject);
            chatActivity.removeMessageWithThanos(this.currentMessageObject);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$openAdsMenu$152(Theme.ResourcesProvider resourcesProvider) {
        RevenueSharingAdsInfoBottomSheet.showAlert(this.activityContext, this.parentFragment, false, resourcesProvider);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$openAdsMenu$153(int i, Theme.ResourcesProvider resourcesProvider) {
        if (!UserConfig.getInstance(i).isPremium()) {
            new PremiumFeatureBottomSheet(this.parentFragment, 3, true).show();
            return;
        }
        BulletinFactory.of(this.containerView, resourcesProvider).createAdReportedBulletin(LocaleController.getString(R.string.AdHidden)).show();
        MessagesController.getInstance(i).disableAds(true);
        BaseFragment baseFragment = this.parentFragment;
        if (baseFragment instanceof ChatActivity) {
            ChatActivity chatActivity = (ChatActivity) baseFragment;
            chatActivity.removeFromSponsored(this.currentMessageObject);
            chatActivity.removeMessageWithThanos(this.currentMessageObject);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$openCurrentPhotoInPaintModeForSelect$130(File file, boolean z, final MessageObject messageObject, final boolean z2, final boolean z3) throws Resources.NotFoundException {
        Pair<Integer, Integer> imageOrientation = AndroidUtilities.getImageOrientation(file);
        int i = this.lastImageId;
        this.lastImageId = i - 1;
        final MediaController.PhotoEntry orientation = new MediaController.PhotoEntry(0, i, 0L, file.getAbsolutePath(), z ? 0 : ((Integer) imageOrientation.first).intValue(), z, 0, 0, 0L).setOrientation(imageOrientation);
        this.sendPhotoType = 2;
        this.doneButtonPressed = false;
        final PhotoViewerProvider photoViewerProvider = this.placeProvider;
        this.placeProvider = new EmptyPhotoViewerProvider() { // from class: org.telegram.ui.PhotoViewer.75
            private final ImageReceiver.BitmapHolder thumbHolder;

            {
                this.thumbHolder = PhotoViewer.this.centerImage.getBitmapSafe();
            }

            private void sendMedia(VideoEditedInfo videoEditedInfo, boolean z4, int i2, boolean z5, boolean z6) {
                AccountInstance accountInstance;
                MediaController.PhotoEntry photoEntry;
                String str;
                VideoEditedInfo videoEditedInfo2;
                String str2;
                TLRPC.Photo photo;
                TL_stories$StoryItem tL_stories$StoryItem;
                if (PhotoViewer.this.parentChatActivity != null) {
                    MessageObject messageObject2 = z5 ? messageObject : null;
                    if (messageObject2 != null && !TextUtils.isEmpty(orientation.caption)) {
                        MediaController.PhotoEntry photoEntry2 = orientation;
                        messageObject2.editingMessage = photoEntry2.caption;
                        messageObject2.editingMessageEntities = photoEntry2.entities;
                    }
                    MediaController.PhotoEntry photoEntry3 = orientation;
                    if (!photoEntry3.isVideo) {
                        if (photoEntry3.imagePath != null) {
                            accountInstance = PhotoViewer.this.parentChatActivity.getAccountInstance();
                            photoEntry = orientation;
                            str = photoEntry.imagePath;
                        } else {
                            if (photoEntry3.path == null) {
                                return;
                            }
                            accountInstance = PhotoViewer.this.parentChatActivity.getAccountInstance();
                            photoEntry = orientation;
                            str = photoEntry.path;
                        }
                        String str3 = str;
                        String str4 = photoEntry.thumbPath;
                        long dialogId = PhotoViewer.this.parentChatActivity.getDialogId();
                        MessageObject replyMessage = PhotoViewer.this.parentChatActivity.getReplyMessage();
                        MessageObject threadMessage = PhotoViewer.this.parentChatActivity.getThreadMessage();
                        ChatActivity.ReplyQuote replyQuote = PhotoViewer.this.parentChatActivity.getReplyQuote();
                        MediaController.PhotoEntry photoEntry4 = orientation;
                        SendMessagesHelper.prepareSendingPhoto(accountInstance, str3, str4, null, dialogId, replyMessage, threadMessage, null, replyQuote, photoEntry4.entities, photoEntry4.stickers, null, photoEntry4.ttl, messageObject2, videoEditedInfo, z4, i2, 0, z6, photoEntry4.caption, PhotoViewer.this.parentChatActivity.quickReplyShortcut, PhotoViewer.this.parentChatActivity.getQuickReplyId(), 0L, 0L, PhotoViewer.this.parentChatActivity.getSendMonoForumPeerId(), PhotoViewer.this.parentChatActivity.getSendMessageSuggestionParams());
                        return;
                    }
                    AccountInstance accountInstance2 = PhotoViewer.this.parentChatActivity.getAccountInstance();
                    String str5 = orientation.path;
                    long dialogId2 = PhotoViewer.this.parentChatActivity.getDialogId();
                    MessageObject replyMessage2 = PhotoViewer.this.parentChatActivity.getReplyMessage();
                    MessageObject threadMessage2 = PhotoViewer.this.parentChatActivity.getThreadMessage();
                    ChatActivity.ReplyQuote replyQuote2 = PhotoViewer.this.parentChatActivity.getReplyQuote();
                    MediaController.PhotoEntry photoEntry5 = orientation;
                    ArrayList<TLRPC.MessageEntity> arrayList = photoEntry5.entities;
                    int i3 = photoEntry5.ttl;
                    boolean z7 = photoEntry5.hasSpoiler;
                    CharSequence charSequence = photoEntry5.caption;
                    String str6 = PhotoViewer.this.parentChatActivity.quickReplyShortcut;
                    int quickReplyId = PhotoViewer.this.parentChatActivity.getQuickReplyId();
                    long sendMonoForumPeerId = PhotoViewer.this.parentChatActivity.getSendMonoForumPeerId();
                    MessageSuggestionParams sendMessageSuggestionParams = PhotoViewer.this.parentChatActivity.getSendMessageSuggestionParams();
                    if (videoEditedInfo != null) {
                        str2 = null;
                        photo = null;
                        tL_stories$StoryItem = null;
                        videoEditedInfo2 = videoEditedInfo;
                    } else {
                        videoEditedInfo2 = null;
                        str2 = null;
                        photo = null;
                        tL_stories$StoryItem = null;
                    }
                    SendMessagesHelper.prepareSendingVideo(accountInstance2, str5, videoEditedInfo2, str2, photo, dialogId2, replyMessage2, threadMessage2, tL_stories$StoryItem, replyQuote2, arrayList, i3, messageObject2, z4, i2, z6, z7, charSequence, str6, quickReplyId, 0L, 0L, sendMonoForumPeerId, sendMessageSuggestionParams);
                }
            }

            @Override // org.telegram.ui.PhotoViewer.EmptyPhotoViewerProvider, org.telegram.ui.PhotoViewer.PhotoViewerProvider
            public boolean canCaptureMorePhotos() {
                return false;
            }

            @Override // org.telegram.ui.PhotoViewer.EmptyPhotoViewerProvider, org.telegram.ui.PhotoViewer.PhotoViewerProvider
            public boolean canEdit(int i2) {
                return photoViewerProvider != null && z2;
            }

            @Override // org.telegram.ui.PhotoViewer.EmptyPhotoViewerProvider, org.telegram.ui.PhotoViewer.PhotoViewerProvider
            public boolean canReplace(int i2) {
                return photoViewerProvider != null && z3;
            }

            @Override // org.telegram.ui.PhotoViewer.EmptyPhotoViewerProvider, org.telegram.ui.PhotoViewer.PhotoViewerProvider
            public MessageObject getEditingMessageObject() {
                return messageObject;
            }

            @Override // org.telegram.ui.PhotoViewer.EmptyPhotoViewerProvider, org.telegram.ui.PhotoViewer.PhotoViewerProvider
            public PlaceProviderObject getPlaceForPhoto(MessageObject messageObject2, TLRPC.FileLocation fileLocation, int i2, boolean z4, boolean z5) {
                PhotoViewerProvider photoViewerProvider2 = photoViewerProvider;
                if (photoViewerProvider2 != null) {
                    return photoViewerProvider2.getPlaceForPhoto(messageObject, null, 0, z4, false);
                }
                return null;
            }

            @Override // org.telegram.ui.PhotoViewer.EmptyPhotoViewerProvider, org.telegram.ui.PhotoViewer.PhotoViewerProvider
            public ImageReceiver.BitmapHolder getThumbForPhoto(MessageObject messageObject2, TLRPC.FileLocation fileLocation, int i2) {
                return this.thumbHolder;
            }

            @Override // org.telegram.ui.PhotoViewer.EmptyPhotoViewerProvider, org.telegram.ui.PhotoViewer.PhotoViewerProvider
            public void replaceButtonPressed(int i2, VideoEditedInfo videoEditedInfo) {
                MediaController.PhotoEntry photoEntry = orientation;
                if (photoEntry.isCropped || photoEntry.isPainted || photoEntry.isFiltered || videoEditedInfo != null || !TextUtils.isEmpty(photoEntry.caption)) {
                    sendMedia(videoEditedInfo, false, 0, true, false);
                }
            }

            @Override // org.telegram.ui.PhotoViewer.EmptyPhotoViewerProvider, org.telegram.ui.PhotoViewer.PhotoViewerProvider
            public void sendButtonPressed(int i2, VideoEditedInfo videoEditedInfo, boolean z4, int i3, boolean z5) {
                sendMedia(videoEditedInfo, z4, i3, false, z5);
            }
        };
        this.selectedPhotosAdapter.notifyDataSetChanged();
        if (this.velocityTracker == null) {
            this.velocityTracker = VelocityTracker.obtain();
        }
        this.aboutToSwitchTo = 3;
        togglePhotosListView(false, false);
        toggleActionBar(true, false);
        ChatActivity chatActivity = this.parentChatActivity;
        if (chatActivity == null || chatActivity.getChatActivityEnterView() == null || !this.parentChatActivity.isKeyboardVisible()) {
            makeFocusable();
        } else {
            this.parentChatActivity.getChatActivityEnterView().closeKeyboard();
        }
        this.backgroundDrawable.setAlpha(255);
        this.containerView.setAlpha(1.0f);
        onPhotoShow(null, null, null, null, null, null, Collections.singletonList(orientation), 0, null);
        this.pickerView.setTranslationY(AndroidUtilities.dp(this.isCurrentVideo ? 154.0f : 96.0f));
        this.pickerViewSendButton.setTranslationY(AndroidUtilities.dp(this.isCurrentVideo ? 154.0f : 96.0f));
        this.actionBar.setTranslationY(-r0.getHeight());
        this.captionTextViewSwitcher.setTranslationY(AndroidUtilities.dp(this.isCurrentVideo ? 154.0f : 96.0f));
        createPaintView();
        switchToPaintMode();
        this.aboutToSwitchTo = 0;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$prepareSegmentImage$121(StickerMakerView.SegmentedObject segmentedObject) {
        try {
            boolean z = !TextUtils.isEmpty(((MediaController.MediaEditState) this.imagesArrLocals.get(this.currentIndex)).filterPath);
            this.stickerMakerView.setSegmentedState(true, segmentedObject);
            this.centerImage.setImageBitmap(this.stickerMakerView.getSegmentedImage(this.centerImage.getBitmap(), z, this.centerImage.getOrientation()));
            this.cutOutBtn.setUndoCutState(true);
            showStickerMode(true, true, true);
            this.cutOutBtn.post(new PhotoViewer$$ExternalSyntheticLambda139(this));
        } catch (Exception e) {
            FileLog.e(e);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$redraw$141(int i) {
        redraw(i + 1);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public static /* synthetic */ void lambda$sendPressed$75(AlertDialog alertDialog, int i) {
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$sendPressed$76(boolean z, int i, boolean z2, boolean z3, AlertDialog alertDialog, int i2) {
        sendPressed(z, i, z2, z3, true);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$sendPressed$77() {
        closePhoto(true, false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setImageIndex$125() {
        if (!this.ads.isPopupShown()) {
            VideoPlayer videoPlayer = this.videoPlayer;
            if (videoPlayer == null || !this.ads.videoWasPlaying) {
                return;
            }
            videoPlayer.play();
            return;
        }
        VideoAds videoAds = this.ads;
        VideoPlayer videoPlayer2 = this.videoPlayer;
        videoAds.videoWasPlaying = videoPlayer2 == null ? true : videoPlayer2.isPlaying();
        VideoPlayer videoPlayer3 = this.videoPlayer;
        if (videoPlayer3 != null) {
            videoPlayer3.pause();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setIsAboutToSwitchToIndex$120(int i, TranslateController translateController, MessageObject messageObject, String str) {
        if (i != this.switchingToIndex) {
            return;
        }
        this.captionDetectedLanguage = str;
        if (!translateController.isContextTranslateEnabled() || !translateController.canTranslatePhoto(messageObject, this.captionDetectedLanguage)) {
            this.menuItem.hideSubItem(19);
        } else {
            if (this.captionTranslated) {
                this.menuItem.showSubItem(20);
                this.menuItem.hideSubItem(19);
                return;
            }
            this.menuItem.showSubItem(19);
        }
        this.menuItem.hideSubItem(20);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setItemVisible$117(ValueAnimator valueAnimator) {
        updateActionBarTitlePadding();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setItemVisible$118(boolean z, View view) {
        if (!z) {
            view.setVisibility(8);
        }
        updateActionBarTitlePadding();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$10(Boolean bool) {
        checkProgress(0, false, false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$11(Uri uri) {
        BulletinFactory.createSaveToGalleryBulletin(this.containerView, true, -115203550, -1).show();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$12(int i) {
        FrameLayoutDrawer frameLayoutDrawer;
        if (this.parentActivity == null || (frameLayoutDrawer = this.containerView) == null || i <= 0) {
            return;
        }
        BulletinFactory.createSaveToGalleryBulletin(frameLayoutDrawer, true, -115203550, -1).show();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$13(MessageObject messageObject, VideoPlayer.Quality quality) {
        TLRPC.Document downloadDocument;
        if (quality == null || (downloadDocument = quality.getDownloadDocument()) == null) {
            return;
        }
        File pathToAttach = FileLoader.getInstance(this.currentAccount).getPathToAttach(downloadDocument, null, false, true);
        if (pathToAttach == null || !pathToAttach.exists()) {
            pathToAttach = FileLoader.getInstance(this.currentAccount).getPathToAttach(downloadDocument, null, true, true);
        }
        if (pathToAttach == null || !pathToAttach.exists()) {
            ArrayList arrayList = new ArrayList();
            messageObject.qualityToSave = downloadDocument;
            arrayList.add(messageObject);
            MediaController.saveFilesFromMessages(this.parentActivity, AccountInstance.getInstance(this.currentAccount), arrayList, new MessagesStorage.IntCallback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda153
                @Override // org.telegram.messenger.MessagesStorage.IntCallback
                public final void run(int i) {
                    this.f$0.lambda$setParentActivity$12(i);
                }
            });
        } else {
            MediaController.saveFile(pathToAttach.toString(), this.parentActivity, 1, null, null, new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda152
                @Override // org.telegram.messenger.Utilities.Callback
                public final void run(Object obj) {
                    this.f$0.lambda$setParentActivity$11((Uri) obj);
                }
            });
        }
        this.menuItem.toggleSubMenu();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$14(View view) {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && messageObject.hasVideoQualities() && this.chooseDownloadQualityLayout.update(this.currentMessageObject)) {
            this.galleryButton.openSwipeBack();
            return;
        }
        ActionBar actionBar = this.actionBar;
        if (actionBar == null || actionBar.getActionBarMenuOnItemClick() == null) {
            return;
        }
        this.actionBar.getActionBarMenuOnItemClick().onItemClick(2);
        this.menuItem.toggleSubMenu();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$15(View view) {
        Activity activity = this.parentActivity;
        if (activity == null) {
            return;
        }
        this.wasRotated = false;
        this.fullscreenedByButton = 1;
        if (this.prevOrientation == -10) {
            this.prevOrientation = activity.getRequestedOrientation();
        }
        if (((WindowManager) this.parentActivity.getSystemService("window")).getDefaultDisplay().getRotation() == 3) {
            this.parentActivity.setRequestedOrientation(8);
        } else {
            this.parentActivity.setRequestedOrientation(0);
        }
        toggleActionBar(false, false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ View lambda$setParentActivity$16() {
        return new CaptionTextView(this.activityContext, this.captionScrollView, this.textSelectionHelper, new Utilities.Callback2() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda134
            @Override // org.telegram.messenger.Utilities.Callback2
            public final void run(Object obj, Object obj2) {
                this.f$0.onLinkClick((ClickableSpan) obj, (TextView) obj2);
            }
        }, new Utilities.Callback3() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda135
            @Override // org.telegram.messenger.Utilities.Callback3
            public final void run(Object obj, Object obj2, Object obj3) {
                this.f$0.onLinkLongPress((ClickableSpan) obj, (TextView) obj2, (Runnable) obj3);
            }
        });
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$17(View view) {
        this.selectedCompression = this.previousCompression;
        didChangedCompressionLevel(false);
        showQualityView(false);
        requestVideoPreview(2);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$18(View view) {
        Object obj = this.imagesArrLocals.get(this.currentIndex);
        if (obj instanceof MediaController.MediaEditState) {
            ((MediaController.MediaEditState) obj).editedInfo = getCurrentVideoEditedInfo();
        }
        showQualityView(false);
        requestVideoPreview(2);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$19(View view) {
        sendPressed(false, 0);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$20(View view) {
        switchToEditMode(5);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$21() {
        switchToEditMode(0);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$22() {
        this.coverEditor.button.setLoading(false);
        switchToEditMode(0);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$23() {
        this.coverEditor.button.setLoading(false);
        switchToEditMode(0);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$24(MediaController.PhotoEntry photoEntry, long j, String str, Bitmap bitmap) {
        if (photoEntry.coverPath != null) {
            try {
                new File(photoEntry.coverPath).delete();
            } catch (Exception e) {
                FileLog.e(e);
            }
        }
        photoEntry.coverSavedPosition = j;
        photoEntry.coverPath = str;
        photoEntry.coverPhoto = null;
        photoEntry.coverPhotoParentObject = null;
        this.coverEditor.button.setLoading(false);
        PhotoViewerProvider photoViewerProvider = this.placeProvider;
        if (photoViewerProvider != null) {
            photoViewerProvider.updatePhotoAtIndex(this.currentIndex);
        }
        EditCoverButton editCoverButton = this.editCoverButton;
        if (editCoverButton != null) {
            editCoverButton.lambda$setImage$0(bitmap);
        }
        switchToEditMode(0);
        if (this.checkImageView.isChecked()) {
            return;
        }
        this.checkImageView.callOnClick();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$25(final String str, final MediaController.PhotoEntry photoEntry, final long j, Bitmap bitmap) throws IOException {
        if (bitmap == null) {
            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda169
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$setParentActivity$22();
                }
            });
            return;
        }
        try {
            FileOutputStream fileOutputStream = new FileOutputStream(new File(str));
            bitmap.compress(Bitmap.CompressFormat.JPEG, 90, fileOutputStream);
            fileOutputStream.close();
            final Bitmap bitmapCreateBitmap = Bitmap.createBitmap(AndroidUtilities.dp(26.0f), AndroidUtilities.dp(26.0f), Bitmap.Config.ARGB_8888);
            Canvas canvas = new Canvas(bitmapCreateBitmap);
            Paint paint = new Paint(3);
            canvas.translate(bitmapCreateBitmap.getWidth() / 2.0f, bitmapCreateBitmap.getHeight() / 2.0f);
            float fMax = Math.max(bitmapCreateBitmap.getWidth() / bitmap.getWidth(), bitmapCreateBitmap.getHeight() / bitmap.getHeight());
            canvas.scale(fMax, fMax);
            canvas.drawBitmap(bitmap, (-bitmap.getWidth()) / 2.0f, (-bitmap.getHeight()) / 2.0f, paint);
            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda170
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$setParentActivity$24(photoEntry, j, str, bitmapCreateBitmap);
                }
            });
        } catch (Exception e) {
            FileLog.e(e);
            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda171
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$setParentActivity$23();
                }
            });
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$27(final String str, final MediaController.PhotoEntry photoEntry, final long j) {
        final Utilities.Callback callback = new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda166
            @Override // org.telegram.messenger.Utilities.Callback
            public final void run(Object obj) throws IOException {
                this.f$0.lambda$setParentActivity$25(str, photoEntry, j, (Bitmap) obj);
            }
        };
        if (this.usedSurfaceView) {
            final Bitmap bitmapCreateBitmap = Bitmap.createBitmap(this.videoSurfaceView.getWidth(), this.videoSurfaceView.getHeight(), Bitmap.Config.ARGB_8888);
            AndroidUtilities.getBitmapFromSurface(this.videoSurfaceView, bitmapCreateBitmap, new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda167
                @Override // java.lang.Runnable
                public final void run() {
                    callback.run(bitmapCreateBitmap);
                }
            });
            return;
        }
        TextureView textureView = this.videoTextureView;
        Bitmap bitmap = textureView.getBitmap(textureView.getWidth(), this.videoTextureView.getHeight());
        if (bitmap == null) {
            bitmap = SendMessagesHelper.createVideoThumbnailAtTime(photoEntry.path, j, null, true);
        }
        callback.run(bitmap);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$28(View view) {
        int i;
        if (this.coverEditor.button.isLoading() || (i = this.currentIndex) < 0 || i >= this.imagesArrLocals.size() || !(this.imagesArrLocals.get(this.currentIndex) instanceof MediaController.PhotoEntry)) {
            return;
        }
        final MediaController.PhotoEntry photoEntry = (MediaController.PhotoEntry) this.imagesArrLocals.get(this.currentIndex);
        final long time = this.coverEditor.getTime();
        final String tempFileAbsolutePath = getTempFileAbsolutePath();
        this.coverEditor.button.setLoading(true);
        Utilities.globalQueue.postRunnable(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda119
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$setParentActivity$27(tempFileAbsolutePath, photoEntry, time);
            }
        });
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$29() {
        this.coverEditor.button.setLoading(false);
        switchToEditMode(0);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$30() {
        this.coverEditor.button.setLoading(false);
        switchToEditMode(0);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$31(MediaController.PhotoEntry photoEntry, String str, Bitmap bitmap) {
        if (photoEntry.coverPath != null) {
            try {
                new File(photoEntry.coverPath).delete();
            } catch (Exception e) {
                FileLog.e(e);
            }
        }
        photoEntry.coverSavedPosition = -1L;
        photoEntry.coverPath = str;
        photoEntry.coverPhoto = null;
        photoEntry.coverPhotoParentObject = null;
        this.coverEditor.button.setLoading(false);
        PhotoViewerProvider photoViewerProvider = this.placeProvider;
        if (photoViewerProvider != null) {
            photoViewerProvider.updatePhotoAtIndex(this.currentIndex);
        }
        EditCoverButton editCoverButton = this.editCoverButton;
        if (editCoverButton != null) {
            editCoverButton.lambda$setImage$0(bitmap);
        }
        switchToEditMode(0);
        if (this.checkImageView.isChecked()) {
            return;
        }
        this.checkImageView.callOnClick();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$32(MediaController.PhotoEntry photoEntry, final MediaController.PhotoEntry photoEntry2, final String str) throws IOException {
        Bitmap bitmapDecodeFile = BitmapFactory.decodeFile(photoEntry.path);
        if (bitmapDecodeFile == null) {
            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda146
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$setParentActivity$29();
                }
            });
            return;
        }
        int[] iArr = new int[11];
        AnimatedFileDrawable.getVideoInfo(photoEntry2.path, iArr);
        int iMax = Math.max(iArr[1], photoEntry2.width);
        int iMax2 = Math.max(iArr[2], photoEntry2.height);
        if ((iArr[8] / 90) % 2 == 1) {
            iMax2 = iMax;
            iMax = iMax2;
        }
        float f = iMax;
        float f2 = iMax2;
        float fMax = Math.max(bitmapDecodeFile.getWidth() / f, bitmapDecodeFile.getHeight() / f2);
        Bitmap.Config config = Bitmap.Config.ARGB_8888;
        Bitmap bitmapCreateBitmap = Bitmap.createBitmap((int) (f * fMax), (int) (f2 * fMax), config);
        Canvas canvas = new Canvas(bitmapCreateBitmap);
        Paint paint = new Paint(3);
        canvas.translate(bitmapCreateBitmap.getWidth() / 2, bitmapCreateBitmap.getHeight() / 2);
        float fMax2 = Math.max(bitmapCreateBitmap.getWidth() / bitmapDecodeFile.getWidth(), bitmapCreateBitmap.getHeight() / bitmapDecodeFile.getHeight());
        canvas.scale(fMax2, fMax2);
        canvas.drawBitmap(bitmapDecodeFile, (-bitmapDecodeFile.getWidth()) / 2, (-bitmapDecodeFile.getHeight()) / 2, paint);
        try {
            FileOutputStream fileOutputStream = new FileOutputStream(new File(str));
            bitmapCreateBitmap.compress(Bitmap.CompressFormat.JPEG, 90, fileOutputStream);
            fileOutputStream.close();
            final Bitmap bitmapCreateBitmap2 = Bitmap.createBitmap(AndroidUtilities.dp(26.0f), AndroidUtilities.dp(26.0f), config);
            Canvas canvas2 = new Canvas(bitmapCreateBitmap2);
            canvas2.translate(bitmapCreateBitmap2.getWidth() / 2.0f, bitmapCreateBitmap2.getHeight() / 2.0f);
            float fMax3 = Math.max(bitmapCreateBitmap2.getWidth() / bitmapCreateBitmap.getWidth(), bitmapCreateBitmap2.getHeight() / bitmapCreateBitmap.getHeight());
            canvas2.scale(fMax3, fMax3);
            canvas2.drawBitmap(bitmapCreateBitmap, (-bitmapCreateBitmap.getWidth()) / 2.0f, (-bitmapCreateBitmap.getHeight()) / 2.0f, paint);
            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda147
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$setParentActivity$31(photoEntry2, str, bitmapCreateBitmap2);
                }
            });
        } catch (Exception e) {
            FileLog.e(e);
            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda148
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$setParentActivity$30();
                }
            });
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$33(final MediaController.PhotoEntry photoEntry) {
        int i;
        if (this.coverEditor.button.isLoading() || (i = this.currentIndex) < 0 || i >= this.imagesArrLocals.size() || !(this.imagesArrLocals.get(this.currentIndex) instanceof MediaController.PhotoEntry)) {
            return;
        }
        this.coverEditor.closeGallery();
        this.coverEditor.button.setLoading(true);
        final MediaController.PhotoEntry photoEntry2 = (MediaController.PhotoEntry) this.imagesArrLocals.get(this.currentIndex);
        final String tempFileAbsolutePath = getTempFileAbsolutePath();
        Utilities.globalQueue.postRunnable(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda118
            @Override // java.lang.Runnable
            public final void run() throws IOException {
                this.f$0.lambda$setParentActivity$32(photoEntry, photoEntry2, tempFileAbsolutePath);
            }
        });
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$34(HintView2 hintView2) {
        ArrayList arrayList = this.muteHints;
        if (arrayList != null) {
            arrayList.remove(hintView2);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$35(View view) {
        if (isCaptionOpen()) {
            return;
        }
        this.muteVideo = !this.muteVideo;
        ArrayList arrayList = this.muteHints;
        if (arrayList != null) {
            Iterator it = arrayList.iterator();
            while (it.hasNext()) {
                ((HintView2) it.next()).hide();
            }
        }
        if (this.muteVideo) {
            final HintView2 hintView2 = new HintView2(this.parentActivity, 3);
            hintView2.setMultilineText(true);
            hintView2.setText(LocaleController.getString(R.string.EditorMuteHint));
            hintView2.setMaxWidthPx(HintView2.cutInFancyHalf(hintView2.getText(), hintView2.getTextPaint()));
            hintView2.setPadding(AndroidUtilities.dp(6.0f), 0, AndroidUtilities.dp(6.0f), 0);
            hintView2.setJoint(BitmapDescriptorFactory.HUE_RED, 22.0f);
            hintView2.setOnHiddenListener(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda131
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$setParentActivity$34(hintView2);
                }
            });
            if (this.muteHints == null) {
                this.muteHints = new ArrayList();
            }
            this.containerView.addView(hintView2, LayoutHelper.createFrame(-1, 200, 83));
            this.muteHints.add(hintView2);
            hintView2.show();
        }
        updateMuteButton();
        updateVideoInfo();
        if (this.muteVideo && !this.checkImageView.isChecked()) {
            this.checkImageView.callOnClick();
            return;
        }
        Object obj = this.imagesArrLocals.get(this.currentIndex);
        if (obj instanceof MediaController.MediaEditState) {
            ((MediaController.MediaEditState) obj).editedInfo = getCurrentVideoEditedInfo();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$36(Integer num) {
        MediaController.MediaEditState mediaEditState;
        Object obj = this.imagesArrLocals.get(this.currentIndex);
        if (!(obj instanceof MediaController.PhotoEntry)) {
            if (obj instanceof MediaController.SearchImage) {
                mediaEditState = (MediaController.SearchImage) obj;
            }
            if (num.intValue() != 0 && !this.placeProvider.isPhotoChecked(this.currentIndex)) {
                setPhotoChecked();
            }
            this.topCaptionEdit.setTimer(num.intValue());
        }
        mediaEditState = (MediaController.PhotoEntry) obj;
        mediaEditState.ttl = num.intValue();
        if (num.intValue() != 0) {
            setPhotoChecked();
        }
        this.topCaptionEdit.setTimer(num.intValue());
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$37(Integer num) {
        FrameLayout frameLayout = this.videoTimelineViewContainer;
        if (frameLayout != null && frameLayout.getVisibility() != 8) {
            this.videoTimelineViewContainer.setTranslationY(this.pickerView.getTranslationY() - (Math.max(0, this.captionEdit.getEditTextHeight() - AndroidUtilities.dp(46.0f)) * this.captionEdit.getAlpha()));
        }
        this.muteButton.setTranslationY((-Math.max(0, num.intValue() - AndroidUtilities.dp(46.0f))) * this.captionEdit.getAlpha());
        this.editCoverButton.setTranslationY((-Math.max(0, num.intValue() - AndroidUtilities.dp(46.0f))) * this.captionEdit.getAlpha());
        MentionsContainerView mentionsContainerView = this.captionEdit.mentionContainer;
        if (mentionsContainerView != null) {
            mentionsContainerView.setTranslationY(-num.intValue());
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$38(View view) {
        if (this.placeProvider == null || isCaptionOpen()) {
            return;
        }
        this.placeProvider.needAddMorePhotos();
        closePhoto(true, false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$39(Integer num) {
        MediaController.MediaEditState mediaEditState;
        Object obj = this.imagesArrLocals.get(this.currentIndex);
        if (!(obj instanceof MediaController.PhotoEntry)) {
            if (obj instanceof MediaController.SearchImage) {
                mediaEditState = (MediaController.SearchImage) obj;
            }
            if (num.intValue() != 0 && !this.placeProvider.isPhotoChecked(this.currentIndex)) {
                setPhotoChecked();
            }
            this.captionEdit.setTimer(num.intValue());
        }
        mediaEditState = (MediaController.PhotoEntry) obj;
        mediaEditState.ttl = num.intValue();
        if (num.intValue() != 0) {
            setPhotoChecked();
        }
        this.captionEdit.setTimer(num.intValue());
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$40(Integer num) {
        MentionsContainerView mentionsContainerView = this.topCaptionEdit.mentionContainer;
        if (mentionsContainerView != null) {
            mentionsContainerView.setTranslationY(num.intValue());
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$41(View view) {
        if (this.placeProvider == null || isCaptionOpen()) {
            return;
        }
        this.placeProvider.needAddMorePhotos();
        closePhoto(true, false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$43() {
        this.stickerMakerView.isThanosInProgress = false;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$44(Bitmap bitmap, Runnable runnable) {
        this.centerImage.setImageBitmap(bitmap);
        this.cutOutBtn.setUndoCutState(true);
        showStickerMode(true, true);
        AndroidUtilities.cancelRunOnUIThread(runnable);
        AndroidUtilities.runOnUIThread(runnable, 800L);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public static /* synthetic */ void lambda$setParentActivity$45() {
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:29:0x00fa  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public /* synthetic */ void lambda$setParentActivity$46(boolean z, MediaController.MediaEditState mediaEditState, StickerMakerView.SegmentedObject segmentedObject) {
        float f;
        float fSqrt;
        float f2;
        if (this.stickerMakerView.hasSegmentedBitmap()) {
            ThanosEffect thanosEffect = this.stickerMakerView.getThanosEffect();
            this.stickerMakerView.setSegmentedState(true, segmentedObject);
            final Bitmap segmentedImage = this.stickerMakerView.getSegmentedImage(this.centerImage.getBitmap(), z, this.centerImage.getOrientation());
            MediaController.PhotoEntry photoEntry = (MediaController.PhotoEntry) this.imagesArrLocals.get(this.currentIndex);
            if (thanosEffect == null) {
                this.centerImage.setImageBitmap(segmentedImage);
                this.cutOutBtn.setUndoCutState(true);
                showStickerMode(true, true);
                this.cutOutBtn.post(new PhotoViewer$$ExternalSyntheticLambda139(this));
                return;
            }
            Bitmap thanosImage = this.stickerMakerView.getThanosImage(photoEntry, this.centerImage.getOrientation());
            if (thanosImage == null) {
                this.centerImage.setImageBitmap(segmentedImage);
                this.cutOutBtn.setUndoCutState(true);
                showStickerMode(true, true);
                this.cutOutBtn.post(new PhotoViewer$$ExternalSyntheticLambda139(this));
                return;
            }
            MediaController.CropState cropState = mediaEditState.cropState;
            if (cropState != null) {
                thanosImage = createCroppedBitmap(thanosImage, cropState, new int[]{this.centerImage.getOrientation(), this.centerImage.getInvert()}, true);
            }
            if (thanosImage == null) {
                this.centerImage.setImageBitmap(segmentedImage);
                this.cutOutBtn.setUndoCutState(true);
                showEditStickerMode(true, true);
                this.cutOutBtn.post(new PhotoViewer$$ExternalSyntheticLambda139(this));
                return;
            }
            Matrix matrix = new Matrix();
            int width = thanosImage.getWidth();
            int height = thanosImage.getHeight();
            if (!photoEntry.isCropped && (this.centerImage.getOrientation() / 90) % 2 != 0) {
                width = thanosImage.getHeight();
                height = thanosImage.getWidth();
            }
            float f3 = width;
            float f4 = height;
            float fMin = Math.min(getContainerViewWidth() / f3, getContainerViewHeight() / f4);
            float f5 = f3 * fMin;
            float f6 = f4 * fMin;
            if (this.centerImage.getOrientation() == 0 || photoEntry.isCropped) {
                float f7 = this.rotate;
                float f8 = BitmapDescriptorFactory.HUE_RED;
                if (f7 != BitmapDescriptorFactory.HUE_RED) {
                    float width2 = thanosImage.getWidth();
                    float height2 = thanosImage.getHeight();
                    float f9 = width2 / 2.0f;
                    float f10 = height2 / 2.0f;
                    float fSqrt2 = (float) Math.sqrt((f9 * f9) + (f10 * f10));
                    float f11 = fSqrt2 * 2.0f;
                    int i = (int) f11;
                    Bitmap bitmapCreateBitmap = Bitmap.createBitmap(i, i, Bitmap.Config.ARGB_8888);
                    Canvas canvas = new Canvas(bitmapCreateBitmap);
                    canvas.save();
                    canvas.rotate((photoEntry.isCropped ? 0 : this.centerImage.getOrientation()) + this.rotate, fSqrt2, fSqrt2);
                    canvas.drawBitmap(thanosImage, (f11 - width2) / 2.0f, (f11 - height2) / 2.0f, (Paint) null);
                    thanosImage.recycle();
                    float f12 = f5 / 2.0f;
                    float f13 = f6 / 2.0f;
                    fSqrt = ((float) Math.sqrt((f12 * f12) + (f13 * f13))) * 2.0f;
                    f8 = (-(fSqrt - f5)) / 2.0f;
                    f2 = (-(fSqrt - f6)) / 2.0f;
                    thanosImage = bitmapCreateBitmap;
                    f = fSqrt;
                } else {
                    f = f5;
                    fSqrt = f6;
                    f2 = BitmapDescriptorFactory.HUE_RED;
                }
                matrix.postScale(f, fSqrt);
                float f14 = this.scale;
                matrix.postScale(f14, f14, f / 2.0f, fSqrt / 2.0f);
                matrix.postTranslate(this.translationX + f8 + Math.max(0, (int) ((getContainerViewWidth() - f5) / 2.0f)), this.translationY + f2 + Math.max(0, (int) ((getContainerViewHeight() - f6) / 2.0f)));
                this.stickerMakerView.isThanosInProgress = true;
                Utilities.themeQueue.postRunnable(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda141
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$setParentActivity$42(segmentedImage);
                    }
                });
                final Runnable runnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda142
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$setParentActivity$43();
                    }
                };
                thanosEffect.animate(matrix, thanosImage, new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda143
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$setParentActivity$44(segmentedImage, runnable);
                    }
                }, new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda144
                    @Override // java.lang.Runnable
                    public final void run() {
                        PhotoViewer.lambda$setParentActivity$45();
                    }
                });
                AndroidUtilities.runOnUIThread(runnable, 1200L);
            }
        } else {
            this.cutOutBtn.setCutOutState(true);
            showEditStickerMode(false, true);
        }
        this.stickerMakerView.disableClippingMode();
        this.containerView.invalidate();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$47(View view) {
        int i;
        if (this.stickerEmpty || this.cutOutBtn.isLoading() || this.cutOutBtn.isUndoCutState() || (i = this.currentIndex) < 0 || i >= this.imagesArrLocals.size() || this.stickerMakerView.isThanosInProgress) {
            return;
        }
        final MediaController.MediaEditState mediaEditState = (MediaController.MediaEditState) this.imagesArrLocals.get(this.currentIndex);
        final boolean z = !TextUtils.isEmpty(mediaEditState.filterPath);
        if (this.cutOutBtn.isCutOutState()) {
            this.cutOutBtn.setCancelState(true);
            this.stickerMakerView.enableClippingMode(new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda116
                @Override // org.telegram.messenger.Utilities.Callback
                public final void run(Object obj) {
                    this.f$0.lambda$setParentActivity$46(z, mediaEditState, (StickerMakerView.SegmentedObject) obj);
                }
            });
        } else {
            if (!this.cutOutBtn.isCancelState()) {
                this.stickerMakerView.resetPaths();
                this.stickerMakerView.getThanosEffect();
                this.stickerMakerView.setSegmentedState(false, null);
                this.centerImage.setImageBitmap(this.stickerMakerView.getSourceBitmap(z));
                this.cutOutBtn.setCutOutState(true);
                showEditStickerMode(false, true);
                applyCurrentEditMode();
                return;
            }
            this.cutOutBtn.setCutOutState(true);
            showEditStickerMode(false, true);
            this.stickerMakerView.disableClippingMode();
        }
        this.containerView.invalidate();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$48(View view) {
        this.eraseBtn.setActive(true, true);
        this.restoreBtn.setActive(false, true);
        StickerMakerView stickerMakerView = this.stickerMakerView;
        if (stickerMakerView != null) {
            stickerMakerView.setOutlineVisible(false);
        }
        this.maskPaintViewEraser = true;
        MaskPaintView maskPaintView = this.maskPaintView;
        if (maskPaintView != null) {
            maskPaintView.setEraser(true);
        }
        switchToEditMode(4);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$49(View view) {
        this.eraseBtn.setActive(false, true);
        this.restoreBtn.setActive(true, true);
        StickerMakerView stickerMakerView = this.stickerMakerView;
        if (stickerMakerView != null) {
            stickerMakerView.setOutlineVisible(false);
        }
        this.maskPaintViewEraser = false;
        MaskPaintView maskPaintView = this.maskPaintView;
        if (maskPaintView != null) {
            maskPaintView.setEraser(false);
        }
        switchToEditMode(4);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$50(View view) {
        MaskPaintView maskPaintView = this.maskPaintView;
        if (maskPaintView == null || !maskPaintView.undo()) {
            switchToEditMode(0);
            this.stickerMakerView.resetPaths();
            boolean z = !TextUtils.isEmpty(((MediaController.MediaEditState) this.imagesArrLocals.get(this.currentIndex)).filterPath);
            StickerMakerView stickerMakerView = this.stickerMakerView;
            if (stickerMakerView != null && !stickerMakerView.empty) {
                stickerMakerView.setSegmentedState(false, null);
            }
            this.centerImage.setImageBitmap(this.stickerMakerView.getSourceBitmap(z));
            StickerMakerView stickerMakerView2 = this.stickerMakerView;
            if (stickerMakerView2 == null || !stickerMakerView2.empty) {
                this.cutOutBtn.setCutOutState(true);
            }
            showStickerMode(true, true);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$51(View view) {
        if (this.stickerMakerView != null) {
            this.outlineBtn.setActive(!r3.isActive(), true);
            this.stickerMakerView.setOutlineVisible((!this.outlineBtn.isActive() || this.eraseBtn.isActive() || this.restoreBtn.isActive()) ? false : true);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$52(View view) {
        MessageObject messageObject;
        MessageSuggestionParams messageSuggestionParamsOf;
        ChatActivity chatActivity = this.parentChatActivity;
        if (chatActivity != null && (messageObject = chatActivity.editingMessageObject) != null && messageObject.needResendWhenEdit() && !ChatObject.canManageMonoForum(this.currentAccount, this.parentChatActivity.editingMessageObject.getDialogId())) {
            if (this.parentFragment == null || (messageSuggestionParamsOf = this.parentChatActivity.messageSuggestionParams) == null) {
                messageSuggestionParamsOf = MessageSuggestionParams.of(this.parentChatActivity.editingMessageObject.messageOwner.suggested_post);
            }
            if (!StarsController.isEnoughAmount(this.currentAccount, messageSuggestionParamsOf.amount)) {
                ChatActivity chatActivity2 = this.parentChatActivity;
                if (chatActivity2 != null) {
                    chatActivity2.showSuggestionOfferForEditMessage(messageSuggestionParamsOf);
                    return;
                }
                return;
            }
        }
        if (!this.captionEdit.isCaptionOverLimit()) {
            ChatActivity chatActivity3 = this.parentChatActivity;
            if (chatActivity3 == null || !chatActivity3.isInScheduleMode() || this.parentChatActivity.isEditingMessageMedia()) {
                sendPressed(true, 0);
                return;
            } else {
                showScheduleDatePickerDialog();
                return;
            }
        }
        AnimatedTextView animatedTextView = this.captionEdit.limitTextView;
        float f = -this.shiftDp;
        this.shiftDp = f;
        AndroidUtilities.shakeViewSpring(animatedTextView, f);
        BotWebViewVibrationEffect.APP_ERROR.vibrate();
        if (MessagesController.getInstance(this.currentAccount).premiumFeaturesBlocked() || MessagesController.getInstance(this.currentAccount).captionLengthLimitPremium <= this.captionEdit.getCodePointCount()) {
            return;
        }
        showCaptionLimitBulletin(this.containerView);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ boolean lambda$setParentActivity$53(View view, MotionEvent motionEvent) {
        ActionBarPopupWindow actionBarPopupWindow;
        if (motionEvent.getActionMasked() != 0 || (actionBarPopupWindow = this.sendPopupWindow) == null || !actionBarPopupWindow.isShowing()) {
            return false;
        }
        view.getHitRect(this.hitRect);
        if (this.hitRect.contains((int) motionEvent.getX(), (int) motionEvent.getY())) {
            return false;
        }
        this.sendPopupWindow.dismiss();
        return false;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$54(KeyEvent keyEvent) {
        ActionBarPopupWindow actionBarPopupWindow;
        if (keyEvent.getKeyCode() == 4 && keyEvent.getRepeatCount() == 0 && (actionBarPopupWindow = this.sendPopupWindow) != null && actionBarPopupWindow.isShowing()) {
            this.sendPopupWindow.dismiss();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$55(int i, View view) {
        ActionBarPopupWindow actionBarPopupWindow = this.sendPopupWindow;
        if (actionBarPopupWindow != null && actionBarPopupWindow.isShowing()) {
            this.sendPopupWindow.dismiss();
        }
        if (i == 0) {
            showScheduleDatePickerDialog();
            return;
        }
        if (i == 1) {
            sendPressed(false, 0);
            return;
        }
        if (i == 2) {
            replacePressed();
        } else if (i == 3) {
            sendPressed(true, 0);
        } else if (i == 4) {
            sendPressed(true, 0, false, true, false);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:100:0x0148  */
    /* JADX WARN: Removed duplicated region for block: B:43:0x00a4  */
    /* JADX WARN: Removed duplicated region for block: B:86:0x011f  */
    /* JADX WARN: Removed duplicated region for block: B:87:0x0121  */
    /* JADX WARN: Removed duplicated region for block: B:90:0x0126  */
    /* JADX WARN: Removed duplicated region for block: B:91:0x0128  */
    /* JADX WARN: Removed duplicated region for block: B:94:0x012e  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public /* synthetic */ boolean lambda$setParentActivity$56(Theme.ResourcesProvider resourcesProvider, View view) {
        ChatActivity chatActivity;
        String string;
        int i;
        int i2;
        String str;
        PhotoViewerProvider photoViewerProvider;
        PhotoViewerProvider photoViewerProvider2 = this.placeProvider;
        if ((photoViewerProvider2 != null && !photoViewerProvider2.allowSendingSubmenu()) || this.sendPhotoType == 11) {
            return false;
        }
        BaseFragment baseFragment = this.parentFragment;
        if (((baseFragment == null || baseFragment.getLastStoryViewer() == null) && ((chatActivity = this.parentChatActivity) == null || chatActivity.isInScheduleMode())) || this.captionEdit.isCaptionOverLimit()) {
            return false;
        }
        this.parentChatActivity.getCurrentChat();
        TLRPC.User currentUser = this.parentChatActivity.getCurrentUser();
        ActionBarPopupWindow.ActionBarPopupWindowLayout actionBarPopupWindowLayout = new ActionBarPopupWindow.ActionBarPopupWindowLayout(this.parentActivity);
        this.sendPopupLayout = actionBarPopupWindowLayout;
        actionBarPopupWindowLayout.setAnimationEnabled(false);
        this.sendPopupLayout.setOnTouchListener(new View.OnTouchListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda85
            @Override // android.view.View.OnTouchListener
            public final boolean onTouch(View view2, MotionEvent motionEvent) {
                return this.f$0.lambda$setParentActivity$53(view2, motionEvent);
            }
        });
        this.sendPopupLayout.setDispatchKeyEventListener(new ActionBarPopupWindow.OnDispatchKeyEventListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda86
            @Override // org.telegram.ui.ActionBar.ActionBarPopupWindow.OnDispatchKeyEventListener
            public final void onDispatchKeyEvent(KeyEvent keyEvent) {
                this.f$0.lambda$setParentActivity$54(keyEvent);
            }
        });
        this.sendPopupLayout.setShownFromBottom(false);
        this.sendPopupLayout.setBackgroundColor(-115203550);
        PhotoViewerProvider photoViewerProvider3 = this.placeProvider;
        boolean z = photoViewerProvider3 != null && photoViewerProvider3.canEdit(this.currentIndex);
        PhotoViewerProvider photoViewerProvider4 = this.placeProvider;
        boolean z2 = photoViewerProvider4 != null && photoViewerProvider4.canReplace(this.currentIndex);
        int i3 = 4;
        int[] iArr = {4, 3, 2, 0, 1};
        int i4 = 0;
        while (i4 < 5) {
            final int i5 = iArr[i4];
            if ((i5 == 2 || i5 == 3 || !z || !z2) && ((i5 == 1 || !z || z2) && (i5 != 0 || this.parentChatActivity.canScheduleMessage()))) {
                if (i5 == 0 && (photoViewerProvider = this.placeProvider) != null && photoViewerProvider.getSelectedPhotos() != null) {
                    Iterator it = this.placeProvider.getSelectedPhotos().entrySet().iterator();
                    while (it.hasNext()) {
                        Object value = ((Map.Entry) it.next()).getValue();
                        if (!(value instanceof MediaController.PhotoEntry)) {
                            if ((value instanceof MediaController.SearchImage) && ((MediaController.SearchImage) value).ttl != 0) {
                                break;
                                break;
                            }
                        } else if (((MediaController.PhotoEntry) value).ttl != 0) {
                            break;
                            break;
                        }
                    }
                    ActionBarMenuSubItem actionBarMenuSubItem = new ActionBarMenuSubItem(this.parentActivity, i5 != 0, i5 != 3, resourcesProvider);
                    if (i5 != 0) {
                    }
                    actionBarMenuSubItem.setTextAndIcon(string, i);
                    actionBarMenuSubItem.setMinimumWidth(AndroidUtilities.dp(196.0f));
                    actionBarMenuSubItem.setColors(-1, -1);
                    this.sendPopupLayout.addView((View) actionBarMenuSubItem, LayoutHelper.createLinear(-1, 48));
                    actionBarMenuSubItem.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda87
                        @Override // android.view.View.OnClickListener
                        public final void onClick(View view2) {
                            this.f$0.lambda$setParentActivity$55(i5, view2);
                        }
                    });
                } else {
                    if ((i5 == 1 && UserObject.isUserSelf(currentUser)) || (((i5 == 2 || i5 == 3) && !z2) || (i5 == i3 && (this.isCurrentVideo || this.captionEdit.hasTimer())))) {
                        break;
                    }
                    ActionBarMenuSubItem actionBarMenuSubItem2 = new ActionBarMenuSubItem(this.parentActivity, i5 != 0, i5 != 3, resourcesProvider);
                    if (i5 != 0) {
                        if (UserObject.isUserSelf(currentUser)) {
                            i2 = R.string.SetReminder;
                            str = "SetReminder";
                        } else {
                            i2 = R.string.ScheduleMessage;
                            str = "ScheduleMessage";
                        }
                        string = LocaleController.getString(str, i2);
                        i = R.drawable.msg_calendar2;
                    } else if (i5 == 1) {
                        string = LocaleController.getString("SendWithoutSound", R.string.SendWithoutSound);
                        i = R.drawable.input_notify_off;
                    } else if (i5 == 2) {
                        string = LocaleController.getString("ReplacePhoto", R.string.ReplacePhoto);
                        i = R.drawable.msg_replace;
                    } else if (i5 == 3) {
                        string = LocaleController.getString("SendAsNewPhoto", R.string.SendAsNewPhoto);
                        i = R.drawable.msg_send;
                    } else {
                        if (i5 == 4) {
                            PhotoViewerProvider photoViewerProvider5 = this.placeProvider;
                            actionBarMenuSubItem2.setTextAndIcon(LocaleController.getString((photoViewerProvider5 == null || photoViewerProvider5.getSelectedCount() <= 1) ? R.string.SendAsFile : R.string.SendAsFiles), R.drawable.msg_sendfile);
                        }
                        actionBarMenuSubItem2.setMinimumWidth(AndroidUtilities.dp(196.0f));
                        actionBarMenuSubItem2.setColors(-1, -1);
                        this.sendPopupLayout.addView((View) actionBarMenuSubItem2, LayoutHelper.createLinear(-1, 48));
                        actionBarMenuSubItem2.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda87
                            @Override // android.view.View.OnClickListener
                            public final void onClick(View view2) {
                                this.f$0.lambda$setParentActivity$55(i5, view2);
                            }
                        });
                    }
                    actionBarMenuSubItem2.setTextAndIcon(string, i);
                    actionBarMenuSubItem2.setMinimumWidth(AndroidUtilities.dp(196.0f));
                    actionBarMenuSubItem2.setColors(-1, -1);
                    this.sendPopupLayout.addView((View) actionBarMenuSubItem2, LayoutHelper.createLinear(-1, 48));
                    actionBarMenuSubItem2.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda87
                        @Override // android.view.View.OnClickListener
                        public final void onClick(View view2) {
                            this.f$0.lambda$setParentActivity$55(i5, view2);
                        }
                    });
                }
            }
            i4++;
            i3 = 4;
        }
        if (this.sendPopupLayout.getChildCount() == 0) {
            return false;
        }
        this.sendPopupLayout.setupRadialSelectors(620756991);
        ActionBarPopupWindow actionBarPopupWindow = new ActionBarPopupWindow(this.sendPopupLayout, -2, -2);
        this.sendPopupWindow = actionBarPopupWindow;
        actionBarPopupWindow.setAnimationEnabled(false);
        this.sendPopupWindow.setAnimationStyle(R.style.PopupContextAnimation2);
        this.sendPopupWindow.setOutsideTouchable(true);
        this.sendPopupWindow.setClippingEnabled(true);
        this.sendPopupWindow.setInputMethodMode(2);
        this.sendPopupWindow.setSoftInputMode(0);
        this.sendPopupWindow.getContentView().setFocusableInTouchMode(true);
        this.sendPopupLayout.measure(View.MeasureSpec.makeMeasureSpec(AndroidUtilities.dp(1000.0f), Integer.MIN_VALUE), View.MeasureSpec.makeMeasureSpec(AndroidUtilities.dp(1000.0f), Integer.MIN_VALUE));
        this.sendPopupWindow.setFocusable(true);
        int[] iArr2 = new int[2];
        view.getLocationInWindow(iArr2);
        this.sendPopupWindow.showAtLocation(view, 51, ((iArr2[0] + view.getMeasuredWidth()) - this.sendPopupLayout.getMeasuredWidth()) + AndroidUtilities.dp(14.0f), (iArr2[1] - this.sendPopupLayout.getMeasuredHeight()) - AndroidUtilities.dp(18.0f));
        try {
            view.performHapticFeedback(3, 2);
        } catch (Exception unused) {
        }
        return false;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$57(View view) {
        cancelStickerClippingMode();
        if (isCaptionOpen()) {
            return;
        }
        if (this.isCurrentVideo) {
            if (!this.videoConvertSupported) {
                return;
            }
            TextureView textureView = this.videoTextureView;
            if (!(textureView instanceof VideoEditTextureView)) {
                return;
            }
            VideoEditTextureView videoEditTextureView = (VideoEditTextureView) textureView;
            if (videoEditTextureView.getVideoWidth() <= 0 || videoEditTextureView.getVideoHeight() <= 0) {
                return;
            }
        }
        switchToEditMode(1);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$58(View view) {
        cropRotate(-90.0f);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$59(View view) {
        cropMirror();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ WindowInsets lambda$setParentActivity$6(View view, WindowInsets windowInsets) {
        Rect rect = new Rect(this.insets);
        int i = Build.VERSION.SDK_INT;
        if (i >= 30) {
            Insets insets = windowInsets.getInsets(WindowInsetsCompat.Type.displayCutout() | WindowInsetsCompat.Type.systemBars());
            this.insets.set(insets.left, insets.top, insets.right, insets.bottom);
        } else {
            this.insets.set(windowInsets.getStableInsetLeft(), windowInsets.getStableInsetTop(), windowInsets.getStableInsetRight(), windowInsets.getStableInsetBottom());
        }
        int i2 = this.insets.top;
        Activity activity = this.parentActivity;
        if ((activity instanceof LaunchActivity) && ((i2 != 0 || AndroidUtilities.isInMultiwindow) && !this.inBubbleMode && AndroidUtilities.statusBarHeight != i2)) {
            AndroidUtilities.statusBarHeight = i2;
            ((LaunchActivity) activity).drawerLayoutContainer.requestLayout();
        }
        if (!rect.equals(windowInsets)) {
            int i3 = this.animationInProgress;
            if (i3 == 1 || i3 == 3) {
                ClippingImageView clippingImageView = this.animatingImageView;
                clippingImageView.setTranslationX(clippingImageView.getTranslationX() - getLeftInset());
                this.animationValues[0][2] = this.animatingImageView.getTranslationX();
            }
            FrameLayout frameLayout = this.windowView;
            if (frameLayout != null) {
                frameLayout.requestLayout();
            }
        }
        View view2 = this.navigationBar;
        if (view2 != null) {
            this.navigationBarHeight = this.insets.bottom;
            ViewGroup.MarginLayoutParams marginLayoutParams = (ViewGroup.MarginLayoutParams) view2.getLayoutParams();
            int i4 = this.navigationBarHeight;
            marginLayoutParams.height = i4;
            marginLayoutParams.bottomMargin = (-i4) / 2;
            this.navigationBar.setLayoutParams(marginLayoutParams);
        }
        this.containerView.setPadding(windowInsets.getSystemWindowInsetLeft(), 0, windowInsets.getSystemWindowInsetRight(), 0);
        if (this.actionBar != null) {
            AndroidUtilities.cancelRunOnUIThread(this.updateContainerFlagsRunnable);
            if (this.isVisible && this.animationInProgress == 0) {
                AndroidUtilities.runOnUIThread(this.updateContainerFlagsRunnable, 200L);
            }
        }
        return i >= 30 ? WindowInsets.CONSUMED : windowInsets.consumeSystemWindowInsets();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$60(View view) {
        cancelStickerClippingMode();
        if (isCaptionOpen()) {
            return;
        }
        if (this.isCurrentVideo) {
            if (!this.videoConvertSupported) {
                return;
            }
            TextureView textureView = this.videoTextureView;
            if (!(textureView instanceof VideoEditTextureView)) {
                return;
            }
            VideoEditTextureView videoEditTextureView = (VideoEditTextureView) textureView;
            if (videoEditTextureView.getVideoWidth() <= 0 || videoEditTextureView.getVideoHeight() <= 0) {
                return;
            }
        }
        switchToEditMode(3);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$61(Activity activity, View view) {
        if (isCaptionOpen() || this.muteVideo) {
            return;
        }
        int i = this.currentIndex;
        if (i >= 0 && i < this.imagesArrLocals.size()) {
            Object obj = this.imagesArrLocals.get(this.currentIndex);
            if (obj instanceof MediaController.PhotoEntry) {
                MediaController.PhotoEntry photoEntry = (MediaController.PhotoEntry) obj;
                if (!photoEntry.isVideo) {
                    boolean z = !photoEntry.highQuality;
                    photoEntry.highQuality = z;
                    this.compressItem.setPhotoState(z);
                    showPhotoQualityHint(photoEntry.highQuality);
                    return;
                }
            }
        }
        if (this.compressItem.getTag() != null) {
            showQualityView(true);
            requestVideoPreview(1);
        } else if (this.videoConvertSupported) {
            if (this.tooltip == null) {
                this.tooltip = new Tooltip(activity, this.containerView, -871296751, -1);
            }
            this.tooltip.setText(LocaleController.getString("VideoQualityIsTooLow", R.string.VideoQualityIsTooLow));
            this.tooltip.show(this.compressItem);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$62(View view) {
        if (view.getAlpha() < 0.9f) {
            return;
        }
        cancelStickerClippingMode();
        if (isCaptionOpen()) {
            return;
        }
        if (this.isCurrentVideo) {
            if (!this.videoConvertSupported) {
                return;
            }
            TextureView textureView = this.videoTextureView;
            if (!(textureView instanceof VideoEditTextureView)) {
                return;
            }
            VideoEditTextureView videoEditTextureView = (VideoEditTextureView) textureView;
            if (videoEditTextureView.getVideoWidth() <= 0 || videoEditTextureView.getVideoHeight() <= 0) {
                return;
            }
        }
        switchToEditMode(2);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$63() {
        this.cropTransform.setViewTransform(this.previousHasTransform, this.previousCropPx, this.previousCropPy, this.previousCropRotation, this.previousCropOrientation, this.previousCropScale, scale1(), scale1(), this.previousCropPw, this.previousCropPh, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, this.previousCropMirrored);
        switchToEditMode(0);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$64(View view) {
        if (this.imageMoveAnimation != null) {
            return;
        }
        Runnable runnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda101
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$setParentActivity$63();
            }
        };
        if (this.previousHasTransform) {
            runnable.run();
            return;
        }
        float stateOrientation = this.previousCropOrientation - this.photoCropView.cropView.getStateOrientation();
        if (Math.abs(stateOrientation) > 180.0f) {
            stateOrientation = stateOrientation < BitmapDescriptorFactory.HUE_RED ? stateOrientation + 360.0f : -(360.0f - stateOrientation);
        }
        cropRotate(stateOrientation, this.photoCropView.cropView.getStateMirror(), runnable);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$65(View view) {
        if (this.currentEditMode != 1 || this.photoCropView.isReady()) {
            applyCurrentEditMode();
            switchToEditMode(0);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$66() {
        this.photoCropView.reset(true);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$67(View view) {
        float f = -this.photoCropView.cropView.getStateOrientation();
        if (Math.abs(f) > 180.0f) {
            f = f < BitmapDescriptorFactory.HUE_RED ? f + 360.0f : -(360.0f - f);
        }
        cropRotate(f, this.photoCropView.cropView.getStateMirror(), new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda109
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$setParentActivity$66();
            }
        });
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$68(ImageReceiver imageReceiver, boolean z, boolean z2, boolean z3) {
        PhotoViewerProvider photoViewerProvider;
        int i;
        Bitmap bitmap;
        int i2;
        if (imageReceiver == this.centerImage && z && !z2) {
            if (!this.isCurrentVideo && ((this.currentEditMode == 1 || (i2 = this.sendPhotoType) == 1 || i2 == 11) && this.photoCropView != null && (bitmap = imageReceiver.getBitmap()) != null)) {
                PhotoCropView photoCropView = this.photoCropView;
                int orientation = imageReceiver.getOrientation();
                int i3 = this.sendPhotoType;
                photoCropView.setBitmap(bitmap, orientation, (i3 == 1 || i3 == 11) ? false : true, true, this.paintingOverlay, this.cropTransform, null, null);
            }
            if (this.paintingOverlay.getVisibility() == 0) {
                this.containerView.requestLayout();
            }
            detectFaces();
        }
        if (imageReceiver != this.centerImage || !z || (photoViewerProvider = this.placeProvider) == null || !photoViewerProvider.scaleToFill() || this.ignoreDidSetImage || (i = this.sendPhotoType) == 1 || i == 11) {
            return;
        }
        if (this.wasLayout) {
            setScaleToFill();
        } else {
            this.dontResetZoomOnFirstLayout = true;
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$69(View view) {
        if (isCaptionOpen()) {
            return;
        }
        setPhotoChecked();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$7(Float f, Boolean bool) {
        chooseSpeed((f.floatValue() * 2.8f) + 0.2f, bool.booleanValue(), false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$70(View view) {
        PhotoViewerProvider photoViewerProvider;
        if (isCaptionOpen() || (photoViewerProvider = this.placeProvider) == null || photoViewerProvider.getSelectedPhotosOrder() == null || this.placeProvider.getSelectedPhotosOrder().isEmpty()) {
            return;
        }
        togglePhotosListView(!this.isPhotosListViewVisible, true);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$71(View view, int i) throws Resources.NotFoundException {
        int i2;
        if (!this.imagesArrLocals.isEmpty() && (i2 = this.currentIndex) >= 0 && i2 < this.imagesArrLocals.size()) {
            Object obj = this.imagesArrLocals.get(this.currentIndex);
            if (obj instanceof MediaController.MediaEditState) {
                ((MediaController.MediaEditState) obj).editedInfo = getCurrentVideoEditedInfo();
            }
        }
        this.ignoreDidSetImage = true;
        int iIndexOf = this.imagesArrLocals.indexOf(view.getTag());
        if (iIndexOf >= 0) {
            this.currentIndex = -1;
            setImageIndex(iIndexOf);
        }
        this.ignoreDidSetImage = false;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$8(Boolean bool) {
        checkProgress(0, false, false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setParentActivity$9(View view) {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && messageObject.isSponsored()) {
            openAdsMenu();
        } else if (this.actionBar.actionBarMenuOnItemClick.canOpenMenu()) {
            this.menuItem.toggleSubMenu();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$setVideoPlayerControlVisible$92(ValueAnimator valueAnimator) {
        this.videoPlayerControlFrameLayout.setAlpha(((Float) valueAnimator.getAnimatedValue()).floatValue());
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$showAlertDialog$93(DialogInterface dialogInterface) {
        this.visibleDialog = null;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$showCaptionLimitBulletin$72() {
        closePhoto(false, false);
        ChatAttachAlert chatAttachAlert = this.parentAlert;
        if (chatAttachAlert != null) {
            chatAttachAlert.dismiss(true);
        }
        BaseFragment baseFragment = this.parentFragment;
        if (baseFragment != null) {
            baseFragment.presentFragment(new PremiumPreviewFragment("caption_limit"));
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$showCaptionLimitBulletin$73() {
        this.limitBulletin = null;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$showEditCaption$122(View view, float[] fArr, ValueAnimator valueAnimator) {
        float alpha = this.pickerView.getAlpha();
        float animatedFraction = valueAnimator.getAnimatedFraction();
        fArr[0] = animatedFraction;
        view.setAlpha(alpha * animatedFraction);
        if (view == this.captionEdit) {
            FrameLayout frameLayout = this.videoTimelineViewContainer;
            if (frameLayout != null) {
                frameLayout.setTranslationY(this.pickerView.getTranslationY() - (Math.max(0, this.captionEdit.getEditTextHeight() - AndroidUtilities.dp(46.0f)) * this.captionEdit.getAlpha()));
            }
            this.muteButton.setTranslationY((-Math.max(0, this.captionEdit.getEditTextHeight() - AndroidUtilities.dp(46.0f))) * this.captionEdit.getAlpha());
            this.editCoverButton.setTranslationY((-Math.max(0, this.captionEdit.getEditTextHeight() - AndroidUtilities.dp(46.0f))) * this.captionEdit.getAlpha());
        }
        invalidateBlur();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$showEditCaption$123(View view, float[] fArr, ValueAnimator valueAnimator) {
        float alpha = this.pickerView.getAlpha();
        float animatedFraction = 1.0f - valueAnimator.getAnimatedFraction();
        fArr[0] = animatedFraction;
        view.setAlpha(alpha * animatedFraction);
        if (view == this.captionEdit) {
            FrameLayout frameLayout = this.videoTimelineViewContainer;
            if (frameLayout != null) {
                frameLayout.setTranslationY(this.pickerView.getTranslationY() - (Math.max(0, this.captionEdit.getEditTextHeight() - AndroidUtilities.dp(46.0f)) * this.captionEdit.getAlpha()));
            }
            this.muteButton.setTranslationY((-Math.max(0, this.captionEdit.getEditTextHeight() - AndroidUtilities.dp(46.0f))) * this.captionEdit.getAlpha());
            this.editCoverButton.setTranslationY((-Math.max(0, this.captionEdit.getEditTextHeight() - AndroidUtilities.dp(46.0f))) * this.captionEdit.getAlpha());
        }
        invalidateBlur();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$showShareAlert$78(ShareAlert shareAlert) {
        if (shareAlert == null || shareAlert.getWindow() == null) {
            return;
        }
        shareAlert.setFocusable(true);
        ChatActivity chatActivity = this.parentChatActivity;
        if (chatActivity == null || chatActivity.getChatActivityEnterView() == null) {
            return;
        }
        this.parentChatActivity.getChatActivityEnterView().hidePopup(false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$switchToEditMode$100(ValueAnimator valueAnimator) {
        this.photoPaintView.setOffsetTranslationX(((Float) valueAnimator.getAnimatedValue()).floatValue());
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$switchToEditMode$101(View view) {
        applyCurrentEditMode();
        switchToEditMode(0);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$switchToEditMode$102(AlertDialog alertDialog, int i) {
        switchToEditMode(0);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$switchToEditMode$103(View view) {
        if (!this.photoFilterView.hasChanges()) {
            switchToEditMode(0);
            return;
        }
        Activity activity = this.parentActivity;
        if (activity == null) {
            return;
        }
        AlertDialog.Builder builder = new AlertDialog.Builder(activity, this.resourcesProvider);
        builder.setMessage(LocaleController.getString("DiscardChanges", R.string.DiscardChanges));
        builder.setTitle(LocaleController.getString("AppName", R.string.AppName));
        builder.setPositiveButton(LocaleController.getString("OK", R.string.OK), new AlertDialog.OnButtonClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda145
            @Override // org.telegram.ui.ActionBar.AlertDialog.OnButtonClickListener
            public final void onClick(AlertDialog alertDialog, int i) {
                this.f$0.lambda$switchToEditMode$102(alertDialog, i);
            }
        });
        builder.setNegativeButton(LocaleController.getString("Cancel", R.string.Cancel), null);
        showAlertDialog(builder);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$switchToEditMode$98(ValueAnimator valueAnimator) {
        this.photoCropView.cropView.areaView.setRotationScaleTranslation(BitmapDescriptorFactory.HUE_RED, AndroidUtilities.lerp(this.scale, this.animateToScale, this.animationValue), AndroidUtilities.lerp(this.translationX, this.animateToX, this.animationValue), AndroidUtilities.lerp(this.translationY, this.animateToY, this.animationValue));
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$switchToEditMode$99(ValueAnimator valueAnimator) {
        this.photoPaintView.setOffsetTranslationY(((Float) valueAnimator.getAnimatedValue()).floatValue(), BitmapDescriptorFactory.HUE_RED, 0, false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$switchToPaintMode$113(ValueAnimator valueAnimator) {
        this.photoPaintView.setOffsetTranslationY(((Float) valueAnimator.getAnimatedValue()).floatValue(), BitmapDescriptorFactory.HUE_RED, 0, false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$switchToPaintMode$114(ValueAnimator valueAnimator) {
        this.photoPaintView.setOffsetTranslationX(((Float) valueAnimator.getAnimatedValue()).floatValue());
    }

    /* JADX INFO: Access modifiers changed from: private */
    public static /* synthetic */ void lambda$switchToPip$81(AnimatedFileDrawable animatedFileDrawable, Bitmap bitmap) {
        if (animatedFileDrawable == null) {
            return;
        }
        animatedFileDrawable.replaceAnimatedBitmap(bitmap);
        animatedFileDrawable.invalidateInternal();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public static /* synthetic */ void lambda$switchToPip$82(ImageReceiver imageReceiver, ValueAnimator valueAnimator) {
        imageReceiver.setAlpha(((Float) valueAnimator.getAnimatedValue()).floatValue());
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$switchToPip$83(View view, ViewOutlineProvider viewOutlineProvider, float f, float f2, AnimatorSet animatorSet) {
        view.setOutlineProvider(viewOutlineProvider);
        view.setClipToOutline(true);
        this.textureImageView.setOutlineProvider(viewOutlineProvider);
        this.textureImageView.setClipToOutline(true);
        FirstFrameView firstFrameView = this.firstFrameView;
        if (firstFrameView != null) {
            firstFrameView.setOutlineProvider(viewOutlineProvider);
            this.firstFrameView.setClipToOutline(true);
        }
        this.textureImageView.setTranslationY(f);
        view.setTranslationY(f2);
        FirstFrameView firstFrameView2 = this.firstFrameView;
        if (firstFrameView2 != null) {
            firstFrameView2.setTranslationY(f2);
        }
        this.translationY = BitmapDescriptorFactory.HUE_RED;
        this.containerView.invalidate();
        animatorSet.start();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$switchToPip$84(Bitmap bitmap, boolean[] zArr, Runnable runnable) {
        ImageView imageView = this.textureImageView;
        if (imageView != null) {
            imageView.setImageBitmap(bitmap);
            this.textureImageView.setVisibility(0);
            SurfaceView surfaceView = this.videoSurfaceView;
            if (surfaceView != null) {
                surfaceView.setVisibility(4);
            }
            if (zArr[0]) {
                return;
            }
            zArr[0] = true;
            runnable.run();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$switchToPip$85(boolean[] zArr, Runnable runnable) {
        if (zArr[0]) {
            return;
        }
        ImageView imageView = this.textureImageView;
        if (imageView != null) {
            imageView.setVisibility(0);
        }
        SurfaceView surfaceView = this.videoSurfaceView;
        if (surfaceView != null) {
            surfaceView.setVisibility(4);
        }
        zArr[0] = true;
        runnable.run();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$switchToPip$86(CubicBezierInterpolator cubicBezierInterpolator, float f, float f2, float f3, float f4, View view, float f5, float f6, float f7, ValueAnimator valueAnimator) {
        float fFloatValue = ((Float) valueAnimator.getAnimatedValue()).floatValue();
        float interpolation = cubicBezierInterpolator == null ? fFloatValue : cubicBezierInterpolator.getInterpolation(fFloatValue);
        ImageView imageView = this.textureImageView;
        if (imageView != null) {
            imageView.setTranslationX(((1.0f - fFloatValue) * f) + (f2 * fFloatValue));
            this.textureImageView.setTranslationY((f3 * (1.0f - interpolation)) + (f4 * interpolation));
            this.textureImageView.invalidateOutline();
        }
        view.setTranslationX((f * (1.0f - fFloatValue)) + (f5 * fFloatValue));
        view.setTranslationY((f6 * (1.0f - interpolation)) + (f7 * interpolation));
        view.invalidateOutline();
        FirstFrameView firstFrameView = this.firstFrameView;
        if (firstFrameView != null) {
            firstFrameView.setTranslationX(view.getTranslationX());
            this.firstFrameView.setTranslationY(view.getTranslationY());
            this.firstFrameView.setScaleX(view.getScaleX());
            this.firstFrameView.setScaleY(view.getScaleY());
            this.firstFrameView.invalidateOutline();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$switchToPip$87(ValueAnimator valueAnimator) {
        this.clippingImageProgress = ((Float) valueAnimator.getAnimatedValue()).floatValue();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$toggleActionBar$116(ValueAnimator valueAnimator) {
        this.photoProgressViews[0].setIndexedAlpha(1, ((Float) valueAnimator.getAnimatedValue()).floatValue(), false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$translateY$111(ValueAnimator valueAnimator) {
        float fFloatValue = ((Float) valueAnimator.getAnimatedValue()).floatValue();
        this.translateY = fFloatValue;
        LPhotoPaintView lPhotoPaintView = this.photoPaintView;
        if (lPhotoPaintView != null) {
            lPhotoPaintView.translateY(fFloatValue);
        }
        this.containerView.invalidate();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$updateQualityItems$79(int i, View view) throws NumberFormatException {
        chooseQuality(i);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$updateQualityItems$80(int i, View view) throws NumberFormatException {
        chooseQuality(i);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$updateResetButtonVisibility$94(boolean z) {
        if (z) {
            return;
        }
        this.resetButton.setVisibility(8);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void makeFocusable() {
        WindowManager.LayoutParams layoutParams;
        int i;
        if (Build.VERSION.SDK_INT >= 21) {
            layoutParams = this.windowLayoutParams;
            i = -2147417856;
        } else {
            layoutParams = this.windowLayoutParams;
            i = 0;
        }
        layoutParams.flags = i;
        this.windowLayoutParams.softInputMode = 272;
        try {
            ((WindowManager) this.parentActivity.getSystemService("window")).updateViewLayout(this.windowView, this.windowLayoutParams);
        } catch (Exception e) {
            FileLog.e(e);
        }
        this.windowView.setFocusable(true);
        this.containerView.setFocusable(true);
    }

    public static void mergeImages(String str, String str2, Bitmap bitmap, Bitmap bitmap2, Bitmap.CompressFormat compressFormat, float f, boolean z) {
        boolean z2;
        if (bitmap == null) {
            try {
                bitmap = BitmapFactory.decodeFile(str2);
                z2 = true;
            } catch (Throwable th) {
                FileLog.e(th);
                return;
            }
        } else {
            z2 = false;
        }
        int width = bitmap.getWidth();
        int height = bitmap.getHeight();
        float f2 = width;
        if (f2 > f || height > f) {
            float fMax = Math.max(width, height) / f;
            height = (int) (height / fMax);
            width = (int) (f2 / fMax);
        }
        Bitmap bitmapCreateBitmap = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888);
        Canvas canvas = new Canvas(bitmapCreateBitmap);
        Rect rect = new Rect(0, 0, width, height);
        if (z) {
            canvas.drawBitmap(bitmap2, (Rect) null, rect, bitmapPaint);
            canvas.drawBitmap(bitmap, (Rect) null, rect, bitmapPaint);
        } else {
            canvas.drawBitmap(bitmap, (Rect) null, rect, bitmapPaint);
            canvas.drawBitmap(bitmap2, (Rect) null, rect, bitmapPaint);
        }
        FileOutputStream fileOutputStream = new FileOutputStream(new File(str));
        bitmapCreateBitmap.compress(compressFormat, f == 512.0f ? 83 : 87, fileOutputStream);
        try {
            fileOutputStream.close();
        } catch (Exception e) {
            FileLog.e(e);
        }
        if (z2) {
            bitmap.recycle();
        }
        bitmapCreateBitmap.recycle();
    }

    /* JADX WARN: Removed duplicated region for block: B:14:0x0024  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean needEncoding() {
        ArrayList arrayList;
        EditState editState = this.editState;
        if (editState.croppedPaintPath != null) {
            ArrayList arrayList2 = editState.croppedMediaEntities;
            arrayList = (arrayList2 == null || arrayList2.isEmpty()) ? null : this.editState.croppedMediaEntities;
        } else {
            ArrayList arrayList3 = editState.mediaEntities;
            if (arrayList3 != null && !arrayList3.isEmpty()) {
                arrayList = this.editState.mediaEntities;
            }
        }
        EditState editState2 = this.editState;
        String str = editState2.croppedPaintPath;
        if (str == null) {
            str = editState2.paintPath;
        }
        if (!this.isH264Video || this.videoCutStart != BitmapDescriptorFactory.HUE_RED || this.rotationValue != 0 || this.resultWidth != this.originalWidth || this.resultHeight != this.originalHeight) {
            return true;
        }
        EditState editState3 = this.editState;
        return (editState3.cropState == null && arrayList == null && str == null && editState3.savedFilterState == null && this.sendPhotoType != 1) ? false : true;
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:129:0x0294  */
    /* JADX WARN: Removed duplicated region for block: B:21:0x003e  */
    /* JADX WARN: Removed duplicated region for block: B:23:0x0041  */
    /* JADX WARN: Removed duplicated region for block: B:41:0x0081 A[PHI: r0
      0x0081: PHI (r0v22 java.io.File) = (r0v11 java.io.File), (r0v18 java.io.File), (r0v21 java.io.File), (r0v63 java.io.File), (r0v64 java.io.File) binds: [B:77:0x0165, B:65:0x012e, B:60:0x00ef, B:22:0x003f, B:39:0x007e] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:90:0x0198 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:94:0x01a2 A[ADDED_TO_REGION] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void onActionClick(boolean z) {
        int i;
        File file;
        File file2;
        ArrayList arrayList;
        Uri uriFromFile;
        FileLoader fileLoader;
        TLRPC.Document document;
        FileLoader fileLoader2;
        TLRPC.Document document2;
        TLRPC.Document document3;
        TLRPC.MessageMedia messageMedia;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null && this.currentBotInlineResult == null && ((this.pageBlocksAdapter == null || this.currentFileNames[0] == null) && this.sendPhotoType != -1)) {
            return;
        }
        this.isStreaming = false;
        if (messageObject != null) {
            String str = messageObject.messageOwner.attachPath;
            if (str == null || str.length() == 0) {
                file2 = null;
                if (file2 == null) {
                    ArrayList arrayList2 = new ArrayList();
                    MessageObject messageObject2 = this.currentMessageObject;
                    TLRPC.Message message = messageObject2.messageOwner;
                    if (message == null || (messageMedia = message.media) == null || (document3 = messageMedia.document) == null) {
                        document3 = messageObject2.getDocument();
                    } else {
                        arrayList2.addAll(messageMedia.alt_documents);
                    }
                    if ((document3 != null ? 1 : 0) + arrayList2.size() <= 1) {
                        file2 = FileLoader.getInstance(this.currentAccount).getPathToMessage(this.currentMessageObject.messageOwner);
                    }
                    if (file2 == null || !file2.exists()) {
                        if (this.currentMessageObject.isVideo() && ((this.currentMessageObject.hasVideoQualities() || SharedConfig.streamMedia) && !DialogObject.isEncryptedDialog(this.currentMessageObject.getDialogId()) && this.currentMessageObject.canStreamVideo())) {
                            int fileReference = FileLoader.getInstance(this.currentMessageObject.currentAccount).getFileReference(this.currentMessageObject);
                            arrayList = new ArrayList();
                            arrayList.addAll(VideoPlayer.getQualities(this.currentAccount, document3, arrayList2, fileReference, false));
                            this.isStreaming = true;
                            checkProgress(0, false, false);
                            file2 = null;
                            uriFromFile = null;
                        }
                        file2 = null;
                        uriFromFile = null;
                    }
                }
                uriFromFile = null;
            } else {
                file2 = new File(this.currentMessageObject.messageOwner.attachPath);
                if (!file2.exists()) {
                }
                if (file2 == null) {
                }
                uriFromFile = null;
            }
            if (file2 != null && uriFromFile == null && arrayList == null) {
                uriFromFile = Uri.fromFile(file2);
            }
            if (uriFromFile == null || arrayList != null) {
                if (this.sharedMediaType != 1 && !this.currentMessageObject.canPreviewDocument()) {
                    AndroidUtilities.openDocument(this.currentMessageObject, this.parentActivity, null);
                    return;
                } else {
                    preparePlayer(arrayList, uriFromFile, true, false);
                    this.videoSizeSet = true;
                }
            }
            if (z) {
                if (this.currentMessageObject == null) {
                    TLRPC.BotInlineResult botInlineResult = this.currentBotInlineResult;
                    if (botInlineResult != null) {
                        if (botInlineResult.document != null) {
                            if (FileLoader.getInstance(this.currentAccount).isLoadingFile(this.currentFileNames[0])) {
                                fileLoader = FileLoader.getInstance(this.currentAccount);
                                document = this.currentBotInlineResult.document;
                                fileLoader.cancelLoadFile(document);
                            } else {
                                fileLoader2 = FileLoader.getInstance(this.currentAccount);
                                document2 = this.currentBotInlineResult.document;
                                fileLoader2.loadFile(document2, this.currentMessageObject, 1, 0);
                            }
                        } else if (botInlineResult.content instanceof TLRPC.TL_webDocument) {
                            if (ImageLoader.getInstance().isLoadingHttpFile(this.currentBotInlineResult.content.url)) {
                                ImageLoader.getInstance().cancelLoadHttpFile(this.currentBotInlineResult.content.url);
                            } else {
                                ImageLoader.getInstance().loadHttpFile(this.currentBotInlineResult.content.url, "mp4", this.currentAccount);
                            }
                        }
                    } else if (this.pageBlocksAdapter != null) {
                        if (FileLoader.getInstance(this.currentAccount).isLoadingFile(this.currentFileNames[0])) {
                            fileLoader = FileLoader.getInstance(this.currentAccount);
                            document = (TLRPC.Document) this.pageBlocksAdapter.getMedia(this.currentIndex);
                            fileLoader.cancelLoadFile(document);
                        } else {
                            FileLoader.getInstance(this.currentAccount).loadFile((TLRPC.Document) this.pageBlocksAdapter.getMedia(this.currentIndex), this.pageBlocksAdapter.getParentObject(), 1, 1);
                        }
                    }
                } else if (FileLoader.getInstance(this.currentAccount).isLoadingFile(this.currentFileNames[0])) {
                    fileLoader = FileLoader.getInstance(this.currentAccount);
                    document = this.currentMessageObject.getDocument();
                    fileLoader.cancelLoadFile(document);
                } else {
                    fileLoader2 = FileLoader.getInstance(this.currentAccount);
                    document2 = this.currentMessageObject.getDocument();
                    fileLoader2.loadFile(document2, this.currentMessageObject, 1, 0);
                }
                Drawable staticThumb = this.centerImage.getStaticThumb();
                if (staticThumb instanceof OtherDocumentPlaceholderDrawable) {
                    ((OtherDocumentPlaceholderDrawable) staticThumb).checkFileExist();
                    return;
                }
                return;
            }
            return;
        }
        TLRPC.BotInlineResult botInlineResult2 = this.currentBotInlineResult;
        if (botInlineResult2 == null) {
            PageBlocksAdapter pageBlocksAdapter = this.pageBlocksAdapter;
            if (pageBlocksAdapter != null) {
                TLObject media = pageBlocksAdapter.getMedia(this.currentIndex);
                if (!(media instanceof TLRPC.Document)) {
                    return;
                }
                file = this.pageBlocksAdapter.getFile(this.currentIndex);
                if (file != null && !file.exists()) {
                    Uri uriPrepareUri = FileStreamLoadOperation.prepareUri(this.currentAccount, (TLRPC.Document) media, this.pageBlocksAdapter.getParentObject());
                    this.isStreaming = true;
                    arrayList = null;
                    uriFromFile = uriPrepareUri;
                    file2 = file;
                    if (file2 != null) {
                        uriFromFile = Uri.fromFile(file2);
                    }
                    if (uriFromFile == null) {
                    }
                    if (this.sharedMediaType != 1) {
                    }
                    preparePlayer(arrayList, uriFromFile, true, false);
                    this.videoSizeSet = true;
                }
            } else {
                if (this.sendPhotoType == -1 && !this.imagesArrLocals.isEmpty() && (i = this.currentIndex) >= 0 && i < this.imagesArrLocals.size()) {
                    Object obj = this.imagesArrLocals.get(this.currentIndex);
                    if (obj instanceof MediaController.PhotoEntry) {
                        file = new File(((MediaController.PhotoEntry) obj).path);
                    }
                }
                file2 = null;
                uriFromFile = null;
            }
            file2 = file;
            uriFromFile = null;
        } else if (botInlineResult2.document != null) {
            file2 = FileLoader.getInstance(this.currentAccount).getPathToAttach(this.currentBotInlineResult.document);
            if (file2.exists()) {
                uriFromFile = null;
            } else {
                file2 = null;
                uriFromFile = null;
            }
        } else {
            if (botInlineResult2.content instanceof TLRPC.TL_webDocument) {
                file2 = new File(FileLoader.getDirectory(4), Utilities.MD5(this.currentBotInlineResult.content.url) + "." + ImageLoader.getHttpUrlExtension(this.currentBotInlineResult.content.url, "mp4"));
                if (!file2.exists()) {
                }
            }
            file2 = null;
            uriFromFile = null;
        }
        arrayList = uriFromFile;
        if (file2 != null) {
        }
        if (uriFromFile == null) {
        }
        if (this.sharedMediaType != 1) {
        }
        preparePlayer(arrayList, uriFromFile, true, false);
        this.videoSizeSet = true;
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:154:0x0373  */
    /* JADX WARN: Removed duplicated region for block: B:157:0x0384  */
    /* JADX WARN: Removed duplicated region for block: B:160:0x038b  */
    /* JADX WARN: Removed duplicated region for block: B:191:0x0460  */
    /* JADX WARN: Removed duplicated region for block: B:192:0x0462  */
    /* JADX WARN: Removed duplicated region for block: B:207:0x0495  */
    /* JADX WARN: Removed duplicated region for block: B:209:0x049a  */
    /* JADX WARN: Removed duplicated region for block: B:215:0x04b3  */
    /* JADX WARN: Removed duplicated region for block: B:216:0x04b5  */
    /* JADX WARN: Removed duplicated region for block: B:220:0x04bc  */
    /* JADX WARN: Removed duplicated region for block: B:229:0x04e2  */
    /* JADX WARN: Removed duplicated region for block: B:233:0x050b  */
    /* JADX WARN: Removed duplicated region for block: B:238:0x0534  */
    /* JADX WARN: Removed duplicated region for block: B:261:0x05fc  */
    /* JADX WARN: Removed duplicated region for block: B:264:0x0606  */
    /* JADX WARN: Removed duplicated region for block: B:277:0x067e  */
    /* JADX WARN: Removed duplicated region for block: B:291:0x06fb  */
    /* JADX WARN: Removed duplicated region for block: B:296:0x071a  */
    /* JADX WARN: Removed duplicated region for block: B:305:0x0742  */
    /* JADX WARN: Removed duplicated region for block: B:308:0x074b  */
    /* JADX WARN: Removed duplicated region for block: B:313:0x0758  */
    /* JADX WARN: Removed duplicated region for block: B:316:0x0765  */
    /* JADX WARN: Removed duplicated region for block: B:324:0x0785  */
    /* JADX WARN: Removed duplicated region for block: B:327:0x078e A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:332:0x07a3  */
    /* JADX WARN: Removed duplicated region for block: B:341:0x07c4  */
    /* JADX WARN: Removed duplicated region for block: B:345:0x0851  */
    /* JADX WARN: Removed duplicated region for block: B:346:0x0854  */
    /* JADX WARN: Removed duplicated region for block: B:349:0x085f  */
    /* JADX WARN: Removed duplicated region for block: B:350:0x0862  */
    /* JADX WARN: Removed duplicated region for block: B:353:0x087e  */
    /* JADX WARN: Removed duplicated region for block: B:360:0x08d4  */
    /* JADX WARN: Removed duplicated region for block: B:373:0x08f1  */
    /* JADX WARN: Removed duplicated region for block: B:399:0x09cb  */
    /* JADX WARN: Removed duplicated region for block: B:408:0x09e5  */
    /* JADX WARN: Removed duplicated region for block: B:411:0x0a11  */
    /* JADX WARN: Removed duplicated region for block: B:437:0x0a46  */
    /* JADX WARN: Removed duplicated region for block: B:440:0x0a4d  */
    /* JADX WARN: Removed duplicated region for block: B:474:0x0ad9  */
    /* JADX WARN: Removed duplicated region for block: B:477:0x0ae4  */
    /* JADX WARN: Removed duplicated region for block: B:485:0x0afc  */
    /* JADX WARN: Removed duplicated region for block: B:489:0x0b1c  */
    /* JADX WARN: Removed duplicated region for block: B:497:0x0b41  */
    /* JADX WARN: Removed duplicated region for block: B:519:0x0b87  */
    /* JADX WARN: Removed duplicated region for block: B:521:0x0b8b  */
    /* JADX WARN: Removed duplicated region for block: B:530:0x0bc3  */
    /* JADX WARN: Removed duplicated region for block: B:533:0x0bcd  */
    /* JADX WARN: Removed duplicated region for block: B:544:0x0c05  */
    /* JADX WARN: Removed duplicated region for block: B:547:0x0c23  */
    /* JADX WARN: Removed duplicated region for block: B:550:0x0c4b  */
    /* JADX WARN: Removed duplicated region for block: B:553:0x0c76  */
    /* JADX WARN: Removed duplicated region for block: B:563:0x0c8f  */
    /* JADX WARN: Removed duplicated region for block: B:565:0x0c98 A[PHI: r1
      0x0c98: PHI (r1v120 float) = (r1v119 float), (r1v118 float) binds: [B:564:0x0c96, B:561:0x0c8c] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:567:0x0ca4  */
    /* JADX WARN: Removed duplicated region for block: B:570:0x0cb7  */
    /* JADX WARN: Removed duplicated region for block: B:575:0x0ce3  */
    /* JADX WARN: Removed duplicated region for block: B:579:0x0cfd  */
    /* JADX WARN: Removed duplicated region for block: B:582:0x0d09  */
    /* JADX WARN: Removed duplicated region for block: B:585:0x0d15  */
    /* JADX WARN: Removed duplicated region for block: B:586:0x0d34  */
    /* JADX WARN: Removed duplicated region for block: B:591:0x0d4d  */
    /* JADX WARN: Removed duplicated region for block: B:593:0x0d52  */
    /* JADX WARN: Removed duplicated region for block: B:652:0x0e5c  */
    /* JADX WARN: Removed duplicated region for block: B:654:0x0e64  */
    /* JADX WARN: Removed duplicated region for block: B:656:0x0e68  */
    /* JADX WARN: Removed duplicated region for block: B:673:0x0e99  */
    /* JADX WARN: Removed duplicated region for block: B:682:0x0ec1  */
    /* JADX WARN: Removed duplicated region for block: B:686:0x0ed1  */
    /* JADX WARN: Removed duplicated region for block: B:713:0x0f81  */
    /* JADX WARN: Removed duplicated region for block: B:735:0x1029  */
    /* JADX WARN: Removed duplicated region for block: B:739:0x1035  */
    /* JADX WARN: Removed duplicated region for block: B:750:0x10a4  */
    /* JADX WARN: Removed duplicated region for block: B:761:0x1111  */
    /* JADX WARN: Removed duplicated region for block: B:766:0x1123  */
    /* JADX WARN: Removed duplicated region for block: B:791:0x117b  */
    /* JADX WARN: Removed duplicated region for block: B:794:0x1182  */
    /* JADX WARN: Removed duplicated region for block: B:802:0x1204  */
    /* JADX WARN: Removed duplicated region for block: B:803:0x1211  */
    /* JADX WARN: Removed duplicated region for block: B:818:0x0f6f A[EDGE_INSN: B:818:0x0f6f->B:711:0x0f6f BREAK  A[LOOP:1: B:684:0x0ecc->B:710:0x0f6b], SYNTHETIC] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void onDraw(Canvas canvas) {
        Canvas canvasBeginRecording;
        float f;
        float f2;
        float f3;
        float f4;
        float f5;
        float f6;
        float f7;
        float f8;
        Runnable runnable;
        int i;
        PhotoViewerWebView photoViewerWebView;
        int i2;
        int i3;
        int i4;
        long j;
        int i5;
        int i6;
        float f9;
        float f10;
        float f11;
        float f12;
        float f13;
        float f14;
        float f15;
        boolean z;
        boolean z2;
        StickerMakerView stickerMakerView;
        float f16;
        float f17;
        float f18;
        int i7;
        float f19;
        float f20;
        float f21;
        int i8;
        float f22;
        float f23;
        boolean z3;
        int bitmapWidth;
        int bitmapHeight;
        int i9;
        int i10;
        boolean z4;
        boolean z5;
        int i11;
        boolean z6;
        float f24;
        float f25;
        int i12;
        int i13;
        float f26;
        int i14;
        float f27;
        float f28;
        int i15;
        boolean z7;
        long j2;
        int i16;
        GradientDrawable[] gradientDrawableArr;
        float f29;
        int i17;
        int i18;
        float f30;
        int i19;
        float f31;
        float f32;
        float f33;
        float f34;
        float f35;
        float f36;
        TextureView textureView;
        float f37;
        float f38;
        float minScale;
        int i20;
        float rotation;
        int i21;
        int i22;
        int i23;
        boolean z8;
        ImageReceiver imageReceiver;
        int i24;
        Canvas canvas2;
        Drawable drawable;
        float f39;
        float f40;
        char c;
        float f41;
        int i25;
        int i26;
        int i27;
        int i28;
        boolean zIsMirrored;
        PaintingOverlay paintingOverlay;
        AspectRatioFrameLayout aspectRatioFrameLayout;
        int i29;
        float fDp;
        float f42;
        float f43;
        float f44;
        float f45;
        float f46;
        int i30;
        float f47;
        int i31;
        int i32;
        int i33;
        boolean zIsMirrored2;
        PaintingOverlay paintingOverlay2;
        float fDp2;
        int i34;
        ImageReceiver imageReceiver2;
        int i35;
        Canvas canvas3 = canvas;
        if (BLUR_RENDERNODE()) {
            if (this.renderNode == null) {
                this.renderNode = new RenderNode("photo viewer");
            }
            this.renderNode.setPosition(0, 0, canvas.getWidth(), canvas.getHeight() + AndroidUtilities.navigationBarHeight);
            canvasBeginRecording = this.renderNode.beginRecording();
        } else {
            canvasBeginRecording = canvas3;
        }
        BaseFragment baseFragment = this.parentFragment;
        float f48 = 1.0f;
        if (baseFragment != null && baseFragment.getFragmentView() != null) {
            if (!this.scroller.isFinished() && this.scroller.computeScrollOffset()) {
                if (this.scroller.getStartX() < this.maxX && this.scroller.getStartX() > this.minX) {
                    this.translationX = this.scroller.getCurrX();
                }
                if (this.scroller.getStartY() < this.maxY && this.scroller.getStartY() > this.minY) {
                    this.translationY = this.scroller.getCurrY();
                }
                invalidateBlur();
                this.containerView.invalidate();
            }
            float fAbs = Math.abs(this.translationY) / (getContainerViewHeight() / 2.0f);
            float f49 = this.clippingImageProgress;
            if (f49 != BitmapDescriptorFactory.HUE_RED) {
                fAbs += (1.0f - fAbs) * f49;
            }
            float fClamp = ((1.0f - Utilities.clamp(fAbs, 1.0f, BitmapDescriptorFactory.HUE_RED)) * 0.1f) + 1.0f;
            if (!LiteMode.isEnabled(LiteMode.FLAG_CHAT_SCALE)) {
                fClamp = 1.0f;
            }
            View fragmentView = this.parentFragment.getFragmentView();
            if (fragmentView.getScaleX() != fClamp || fragmentView.getScaleY() != fClamp) {
                fragmentView.setPivotX(fragmentView.getWidth() / 2.0f);
                fragmentView.setPivotY(fragmentView.getHeight() / 2.0f);
                fragmentView.setScaleX(fClamp);
                fragmentView.setScaleY(fClamp);
            }
            ChatAttachAlert chatAttachAlert = this.parentAlert;
            if (chatAttachAlert != null) {
                BottomSheet.ContainerView container = chatAttachAlert.getContainer();
                if (container.getScaleX() != fClamp || container.getScaleY() != fClamp) {
                    container.setPivotX(container.getWidth() / 2.0f);
                    container.setPivotY(container.getHeight() / 2.0f);
                    container.setScaleX(fClamp);
                    container.setScaleY(fClamp);
                }
            }
            int i36 = this.animationInProgress;
            if (i36 == 1 || i36 == 2 || i36 == 3 || this.pipAnimationInProgress) {
                this.containerView.invalidate();
            }
        }
        int i37 = this.animationInProgress;
        if (i37 == 1) {
            if (this.padImageForHorizontalInsets) {
                canvas.save();
                canvas3.translate((getLeftInset() / 2.0f) - (getRightInset() / 2.0f), BitmapDescriptorFactory.HUE_RED);
            }
            if (this.animatingImageView != null) {
                canvas.save();
                canvas3.translate(this.animatingImageView.getCenterX() - (canvas.getWidth() / 2.0f), this.animatingImageView.getCenterY() - (canvas.getHeight() / 2.0f));
                float animationProgress = this.animatingImageView.getAnimationProgress();
                if (this.animationInProgress != 1) {
                    animationProgress = 1.0f - animationProgress;
                }
                canvas3.scale(animationProgress, animationProgress, canvas.getWidth() / 2.0f, canvas.getHeight() / 2.0f);
                f48 = animationProgress;
            }
            drawProgress(canvas, BitmapDescriptorFactory.HUE_RED, 1.0f, BitmapDescriptorFactory.HUE_RED, f48);
            if (this.animatingImageView != null) {
                canvas.restore();
            }
            if (this.padImageForHorizontalInsets) {
                canvas.restore();
            }
            if (this.animatingImageView != null && canvasBeginRecording != canvas3) {
                canvasBeginRecording.save();
                canvasBeginRecording.translate(this.animatingImageView.getX(), this.animatingImageView.getY());
                canvasBeginRecording.scale(this.animatingImageView.getScaleX(), this.animatingImageView.getScaleY());
                this.animatingImageView.draw(canvasBeginRecording);
                canvasBeginRecording.restore();
            }
            if (BLUR_RENDERNODE()) {
                this.renderNode.endRecording();
            } else {
                canvas3 = canvasBeginRecording;
            }
            drawFancyShadows(canvas3);
            return;
        }
        if (i37 == 3 || !(this.isVisible || i37 == 2 || this.pipAnimationInProgress)) {
            if (BLUR_RENDERNODE()) {
                this.renderNode.endRecording();
                canvas3.drawRenderNode(this.renderNode);
                return;
            }
            return;
        }
        if (this.padImageForHorizontalInsets) {
            canvasBeginRecording.save();
            canvasBeginRecording.translate((getLeftInset() / 2) - (getRightInset() / 2), BitmapDescriptorFactory.HUE_RED);
        }
        this.currentCropScale = 1.0f;
        this.currentCropX = BitmapDescriptorFactory.HUE_RED;
        this.currentCropY = BitmapDescriptorFactory.HUE_RED;
        long jCurrentTimeMillis = System.currentTimeMillis();
        long j3 = jCurrentTimeMillis - this.videoCrossfadeAlphaLastTime;
        if (j3 > 20) {
            j3 = 17;
        }
        long j4 = j3;
        this.videoCrossfadeAlphaLastTime = jCurrentTimeMillis;
        if (this.imageMoveAnimation != null) {
            if (!this.scroller.isFinished()) {
                this.scroller.abortAnimation();
            }
            float f50 = this.scale;
            float f51 = this.animateToScale;
            float f52 = this.animationValue;
            f = ((f51 - f50) * f52) + f50;
            float f53 = this.rotate;
            f3 = f53 + ((this.animateToRotate - f53) * f52);
            float f54 = this.translationX;
            f5 = ((this.animateToX - f54) * f52) + f54;
            float f55 = this.translationY;
            f4 = f55 + ((this.animateToY - f55) * f52);
            float f56 = this.mirror;
            f2 = f56 + ((this.animateToMirror - f56) * f52);
            f8 = (f51 == 1.0f && f50 == 1.0f && f54 == BitmapDescriptorFactory.HUE_RED) ? f4 : -1.0f;
            updateMinMax(f);
            this.containerView.invalidate();
        } else {
            if (this.animationStartTime != 0) {
                this.translationX = this.animateToX;
                this.translationY = this.animateToY;
                float f57 = this.animateToScale;
                this.scale = f57;
                this.rotate = this.animateToRotate;
                this.animationStartTime = 0L;
                updateMinMax(f57);
                this.zoomAnimation = false;
            }
            if (!this.scroller.isFinished() && this.scroller.computeScrollOffset()) {
                if (this.scroller.getStartX() < this.maxX && this.scroller.getStartX() > this.minX) {
                    this.translationX = this.scroller.getCurrX();
                }
                if (this.scroller.getStartY() < this.maxY && this.scroller.getStartY() > this.minY) {
                    this.translationY = this.scroller.getCurrY();
                }
                invalidateBlur();
                this.containerView.invalidate();
            }
            if (this.switchImageAfterAnimation != 0) {
                this.openedFullScreenVideo = false;
                if (!this.imagesArrLocals.isEmpty() && (i = this.currentIndex) >= 0 && i < this.imagesArrLocals.size()) {
                    Object obj = this.imagesArrLocals.get(this.currentIndex);
                    if (obj instanceof MediaController.MediaEditState) {
                        ((MediaController.MediaEditState) obj).editedInfo = getCurrentVideoEditedInfo();
                    }
                }
                int i38 = this.switchImageAfterAnimation;
                if (i38 == 1) {
                    runnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda98
                        @Override // java.lang.Runnable
                        public final void run() throws Resources.NotFoundException {
                            this.f$0.lambda$onDraw$142();
                        }
                    };
                } else {
                    if (i38 == 2) {
                        runnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda99
                            @Override // java.lang.Runnable
                            public final void run() throws Resources.NotFoundException {
                                this.f$0.lambda$onDraw$143();
                            }
                        };
                    }
                    this.switchImageAfterAnimation = 0;
                }
                AndroidUtilities.runOnUIThread(runnable);
                this.switchImageAfterAnimation = 0;
            }
            f = this.scale;
            f2 = this.mirror;
            f3 = this.rotate;
            f4 = this.translationY;
            f5 = this.translationX;
            if (this.moving) {
                f6 = f5;
                f7 = f3;
                f8 = -1.0f;
                float f58 = f2;
                float f59 = f;
                float emojiPadding = f4 + this.translateY;
                if (this.currentEditMode == 3) {
                    emojiPadding += this.photoPaintView.getEmojiPadding(false) / 2.0f;
                }
                float f60 = emojiPadding;
                photoViewerWebView = this.photoViewerWebView;
                if (photoViewerWebView != null) {
                    photoViewerWebView.setTranslationY(f60);
                }
                if (this.isActionBarVisible) {
                    if (f59 <= 1.0001f) {
                        if (!this.allowShowFullscreenButton && this.fullscreenButton[0].getTag() == null) {
                            this.fullscreenButton[0].animate().alpha(1.0f).setDuration(120L).setListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.82
                                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                                public void onAnimationEnd(Animator animator) {
                                    PhotoViewer.this.fullscreenButton[0].setTag(null);
                                }
                            }).start();
                            this.fullscreenButton[0].setTag(1);
                            this.allowShowFullscreenButton = true;
                        }
                    } else if (this.allowShowFullscreenButton) {
                        this.fullscreenButton[0].animate().alpha(BitmapDescriptorFactory.HUE_RED).setDuration(120L).setListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.83
                            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                            public void onAnimationEnd(Animator animator) {
                                PhotoViewer.this.fullscreenButton[0].setTag(null);
                            }
                        }).start();
                        this.fullscreenButton[0].setTag(1);
                        this.allowShowFullscreenButton = false;
                    }
                }
                int containerViewWidth = getContainerViewWidth();
                int containerViewHeight = getContainerViewHeight();
                i2 = this.animationInProgress;
                if (i2 != 2 || i2 == 4 || this.pipAnimationInProgress || this.isInline) {
                    if (i2 == 4) {
                        canvasBeginRecording.drawColor(-16777216);
                    }
                } else if (this.currentEditMode != 0 || (i35 = this.sendPhotoType) == 1 || i35 == 11 || this.scale != 1.0f || f8 == -1.0f || this.zoomAnimation) {
                    this.backgroundDrawable.setAlpha(255);
                } else {
                    float f61 = containerViewWidth / 4.0f;
                    this.backgroundDrawable.setAlpha((int) Math.max(127.0f, (1.0f - (Math.min(Math.abs(f8), f61) / f61)) * 255.0f));
                }
                this.sideImage = null;
                if (this.currentEditMode == 0 && (i34 = this.sendPhotoType) != 1 && i34 != 11) {
                    if (this.scale >= 1.0f && !this.zoomAnimation && !this.zooming) {
                        if (f6 <= this.maxX + AndroidUtilities.dp(5.0f)) {
                            imageReceiver2 = this.leftImage;
                        } else if (f6 < this.minX - AndroidUtilities.dp(5.0f)) {
                            imageReceiver2 = this.rightImage;
                        } else {
                            this.groupedPhotosListView.setMoveProgress(BitmapDescriptorFactory.HUE_RED);
                        }
                        this.sideImage = imageReceiver2;
                    }
                    this.changingPage = this.sideImage == null;
                }
                i3 = 0;
                for (i4 = 3; i3 < i4; i4 = 3) {
                    if (i3 != 1) {
                        if (i3 == 2) {
                            fDp2 = ((-this.containerView.getMeasuredWidth()) - AndroidUtilities.dp(15.0f)) + (f6 - this.maxX);
                        } else {
                            float f62 = this.minX;
                            fDp2 = f6 < f62 ? f6 - f62 : BitmapDescriptorFactory.HUE_RED;
                        }
                    }
                    this.fullscreenButton[i3].setTranslationX((fDp2 + this.containerView.getMeasuredWidth()) - AndroidUtilities.dp(48.0f));
                    i3++;
                }
                if (this.sideImage == this.rightImage) {
                    j = j4;
                    i5 = containerViewHeight;
                    i6 = containerViewWidth;
                    f9 = f7;
                    f10 = f6;
                    f11 = f58;
                    f12 = f60;
                    if (this.isActionBarVisible) {
                        this.fullscreenButton[1].setAlpha(BitmapDescriptorFactory.HUE_RED);
                    }
                    if (this.zoomAnimation) {
                    }
                    if (this.videoSizeSet) {
                        z = false;
                        z2 = false;
                    }
                    this.centerImageTransformLocked = z;
                    this.centerImageTransform.reset();
                    MaskPaintView maskPaintView = this.maskPaintView;
                    if (maskPaintView != null) {
                    }
                    if (this.centerImage.hasBitmapImage()) {
                        stickerMakerView = this.stickerMakerView;
                        if (stickerMakerView == null) {
                            f16 = f10;
                            f17 = f9;
                            canvasBeginRecording.save();
                            f18 = i6;
                            float f63 = f18 / 2.0f;
                            i7 = i5;
                            float f64 = i7;
                            float f65 = f64 / 2.0f;
                            canvasBeginRecording.translate(f63 + getAdditionX(this.currentEditMode), f65 + getAdditionY(this.currentEditMode));
                            this.centerImageTransform.preTranslate(f63 + getAdditionX(this.currentEditMode), f65 + getAdditionY(this.currentEditMode));
                            canvasBeginRecording.translate(f13, (this.currentEditMode == 3 ? this.currentPanTranslationY : BitmapDescriptorFactory.HUE_RED) + f12);
                            this.centerImageTransform.preTranslate(f13, (this.currentEditMode == 3 ? this.currentPanTranslationY : BitmapDescriptorFactory.HUE_RED) + f12);
                            float f66 = f59 - f14;
                            canvasBeginRecording.scale(f66, f66);
                            this.centerImageTransform.preScale(f66, f66);
                            canvasBeginRecording.rotate(f17);
                            this.centerImageTransform.preRotate(f17);
                            if (this.currentEditMode == 3) {
                            }
                        }
                    }
                    drawProgress(canvasBeginRecording, f22, f25, f12, f28);
                    imageReceiver = this.sideImage;
                    if (imageReceiver != this.leftImage) {
                    }
                    i24 = this.waitingForDraw;
                    if (i24 != 0) {
                    }
                    if (this.padImageForHorizontalInsets) {
                    }
                    if (this.aspectRatioFrameLayout != null) {
                    }
                    if (BLUR_RENDERNODE()) {
                    }
                    drawFancyShadows(canvas2);
                }
                if (!this.zoomAnimation) {
                    float f67 = this.minX;
                    if (f6 < f67) {
                        float fMin = Math.min(1.0f, (f67 - f6) / containerViewWidth);
                        fDp = (-containerViewWidth) - (AndroidUtilities.dp(30.0f) / 2);
                        f43 = fMin;
                        f42 = (1.0f - fMin) * 0.3f;
                    } else {
                        fDp = f6;
                        f42 = BitmapDescriptorFactory.HUE_RED;
                        f43 = 1.0f;
                    }
                    if (this.sideImage.hasBitmapImage()) {
                        canvasBeginRecording.save();
                        float f68 = f43;
                        canvasBeginRecording.translate(containerViewWidth / 2, containerViewHeight / 2);
                        canvasBeginRecording.translate((AndroidUtilities.dp(30.0f) / 2) + containerViewWidth + fDp, BitmapDescriptorFactory.HUE_RED);
                        float f69 = 1.0f - f42;
                        canvasBeginRecording.scale(f69, f69);
                        int bitmapWidth2 = this.sideImage.getBitmapWidth();
                        int bitmapHeight2 = this.sideImage.getBitmapHeight();
                        if (this.rightImageIsVideo || this.rightCropState == null || !this.rightCropTransform.hasViewTransform()) {
                            f46 = fDp;
                            i31 = bitmapHeight2;
                            j = j4;
                            f47 = f60;
                            f9 = f7;
                            f10 = f6;
                            f11 = f58;
                            f45 = f68;
                            i32 = containerViewHeight;
                            i33 = containerViewWidth;
                        } else {
                            f45 = f68;
                            f11 = f58;
                            i31 = bitmapHeight2;
                            f10 = f6;
                            j = j4;
                            i32 = containerViewHeight;
                            f46 = fDp;
                            i33 = containerViewWidth;
                            f47 = f60;
                            f9 = f7;
                            applyCrop(canvasBeginRecording, containerViewWidth, containerViewHeight, bitmapWidth2, i31, 1.0f, this.rightCropTransform, this.rightCropState);
                        }
                        float f70 = bitmapWidth2;
                        int i39 = i31;
                        float f71 = i39;
                        float fMin2 = Math.min(i33 / f70, i32 / f71);
                        int i40 = (int) (f70 * fMin2);
                        int i41 = (int) (f71 * fMin2);
                        if (this.imagesArrLocals.isEmpty()) {
                            zIsMirrored2 = false;
                            if (zIsMirrored2) {
                                canvasBeginRecording.scale(-1.0f, 1.0f);
                            }
                            this.sideImage.setAlpha(f45);
                            int i42 = (-i40) / 2;
                            i5 = i32;
                            int i43 = (-i41) / 2;
                            f44 = f42;
                            i30 = i33;
                            this.sideImage.setImageCoords(i42, i43, i40, i41);
                            this.sideImage.draw(canvasBeginRecording);
                            paintingOverlay2 = this.rightPaintingOverlay;
                            if (paintingOverlay2 == null && paintingOverlay2.getVisibility() == 0) {
                                canvasBeginRecording.clipRect(i42, i43, i40 / 2, i41 / 2);
                                if (this.rightPaintingOverlay.getMeasuredWidth() != bitmapWidth2 || this.rightPaintingOverlay.getMeasuredHeight() != i39) {
                                    this.rightPaintingOverlay.measure(View.MeasureSpec.makeMeasureSpec(bitmapWidth2, 1073741824), View.MeasureSpec.makeMeasureSpec(i39, 1073741824));
                                    this.rightPaintingOverlay.layout(0, 0, bitmapWidth2, i39);
                                }
                                canvasBeginRecording.scale(fMin2, fMin2);
                                canvasBeginRecording.translate((-bitmapWidth2) / 2, (-i39) / 2);
                                this.rightPaintingOverlay.setAlpha(1.0f);
                                this.rightPaintingOverlay.draw(canvasBeginRecording);
                            }
                            canvasBeginRecording.restore();
                        } else {
                            if (this.currentEditMode == 1 || this.sendPhotoType == 1) {
                                zIsMirrored2 = this.rightCropTransform.isMirrored();
                            } else {
                                MediaController.CropState cropState = this.rightCropState;
                                if (cropState != null && cropState.mirrored) {
                                    zIsMirrored2 = true;
                                }
                            }
                            if (zIsMirrored2) {
                            }
                            this.sideImage.setAlpha(f45);
                            int i422 = (-i40) / 2;
                            i5 = i32;
                            int i432 = (-i41) / 2;
                            f44 = f42;
                            i30 = i33;
                            this.sideImage.setImageCoords(i422, i432, i40, i41);
                            this.sideImage.draw(canvasBeginRecording);
                            paintingOverlay2 = this.rightPaintingOverlay;
                            if (paintingOverlay2 == null) {
                                canvasBeginRecording.restore();
                            }
                        }
                    } else {
                        f44 = f42;
                        f45 = f43;
                        f46 = fDp;
                        j = j4;
                        i5 = containerViewHeight;
                        i30 = containerViewWidth;
                        f47 = f60;
                        f9 = f7;
                        f10 = f6;
                        f11 = f58;
                    }
                    this.groupedPhotosListView.setMoveProgress(-f45);
                    SeekSpeedDrawable seekSpeedDrawable = this.seekSpeedDrawable;
                    if (seekSpeedDrawable == null || !seekSpeedDrawable.isShown()) {
                        canvasBeginRecording.save();
                        f12 = f47;
                        canvasBeginRecording.translate(f46, f12 / f59);
                        i6 = i30;
                        canvasBeginRecording.translate(((i6 * (this.scale + 1.0f)) + AndroidUtilities.dp(30.0f)) / 2.0f, (-f12) / f59);
                        this.photoProgressViews[1].setScale(1.0f - f44);
                        this.photoProgressViews[1].setAlpha(f45);
                        this.photoProgressViews[1].onDraw(canvasBeginRecording);
                        if (this.isActionBarVisible) {
                            this.fullscreenButton[1].setAlpha(f45);
                        }
                        canvasBeginRecording.restore();
                    } else {
                        i6 = i30;
                        f12 = f47;
                    }
                }
                if (this.zoomAnimation) {
                    float f72 = this.maxX;
                    if (f10 <= f72 || (!((i29 = this.currentEditMode) == 0 || i29 == 4) || this.sendPhotoType == 1)) {
                        f13 = f10;
                        f14 = BitmapDescriptorFactory.HUE_RED;
                        f15 = 1.0f;
                    } else {
                        float fMin3 = Math.min(1.0f, (f10 - f72) / i6);
                        f15 = 1.0f - fMin3;
                        f13 = this.maxX;
                        f14 = fMin3 * 0.3f;
                    }
                }
                if (this.videoSizeSet || (aspectRatioFrameLayout = this.aspectRatioFrameLayout) == null || aspectRatioFrameLayout.getVisibility() != 0) {
                    z = false;
                    z2 = false;
                } else {
                    z = false;
                    z2 = true;
                }
                this.centerImageTransformLocked = z;
                this.centerImageTransform.reset();
                MaskPaintView maskPaintView2 = this.maskPaintView;
                float f73 = (maskPaintView2 != null || this.maskPaintViewShuttingDown || maskPaintView2.getRenderView() == null) ? f15 : this.maskPaintView.getRenderView().getAlpha() > 0.99f ? BitmapDescriptorFactory.HUE_RED : 1.0f;
                if (!this.centerImage.hasBitmapImage() || (z2 && this.textureUploaded)) {
                    stickerMakerView = this.stickerMakerView;
                    if (stickerMakerView == null && stickerMakerView.outlineVisible) {
                        try {
                            z8 = ((MediaController.PhotoEntry) this.imagesArrLocals.get(this.currentIndex)).isCropped;
                        } catch (Exception unused) {
                            z8 = false;
                        }
                        if (z8) {
                            this.stickerMakerView.updateOutlineBounds(false);
                            f16 = f10;
                            f17 = f9;
                            canvasBeginRecording.save();
                            f18 = i6;
                            float f632 = f18 / 2.0f;
                            i7 = i5;
                            float f642 = i7;
                            float f652 = f642 / 2.0f;
                            canvasBeginRecording.translate(f632 + getAdditionX(this.currentEditMode), f652 + getAdditionY(this.currentEditMode));
                            this.centerImageTransform.preTranslate(f632 + getAdditionX(this.currentEditMode), f652 + getAdditionY(this.currentEditMode));
                            canvasBeginRecording.translate(f13, (this.currentEditMode == 3 ? this.currentPanTranslationY : BitmapDescriptorFactory.HUE_RED) + f12);
                            this.centerImageTransform.preTranslate(f13, (this.currentEditMode == 3 ? this.currentPanTranslationY : BitmapDescriptorFactory.HUE_RED) + f12);
                            float f662 = f59 - f14;
                            canvasBeginRecording.scale(f662, f662);
                            this.centerImageTransform.preScale(f662, f662);
                            canvasBeginRecording.rotate(f17);
                            this.centerImageTransform.preRotate(f17);
                            if (this.currentEditMode == 3) {
                                f19 = f18;
                                if (this.pipAnimationInProgress) {
                                    f20 = f17;
                                    f21 = f16;
                                    i8 = i7;
                                    f22 = f13;
                                    f23 = f73;
                                    z3 = false;
                                    if (z2) {
                                    }
                                }
                            }
                        } else {
                            int iDp = i6 - AndroidUtilities.dp(20.0f);
                            this.stickerMakerView.outlineMatrix.reset();
                            this.stickerMakerView.outlineMatrix.postTranslate(-0.5f, -0.5f);
                            float f74 = iDp;
                            this.stickerMakerView.outlineMatrix.postScale(f74, f74);
                            float f75 = 1.0f / f59;
                            this.stickerMakerView.outlineMatrix.postScale(f75, f75);
                            f16 = f10;
                            this.stickerMakerView.outlineMatrix.postTranslate((-f16) / f59, (-f12) / f59);
                            f17 = f9;
                            this.stickerMakerView.outlineMatrix.postRotate(-f17);
                            this.stickerMakerView.updateOutlineBounds(true);
                            canvasBeginRecording.save();
                            f18 = i6;
                            float f6322 = f18 / 2.0f;
                            i7 = i5;
                            float f6422 = i7;
                            float f6522 = f6422 / 2.0f;
                            canvasBeginRecording.translate(f6322 + getAdditionX(this.currentEditMode), f6522 + getAdditionY(this.currentEditMode));
                            this.centerImageTransform.preTranslate(f6322 + getAdditionX(this.currentEditMode), f6522 + getAdditionY(this.currentEditMode));
                            canvasBeginRecording.translate(f13, (this.currentEditMode == 3 ? this.currentPanTranslationY : BitmapDescriptorFactory.HUE_RED) + f12);
                            this.centerImageTransform.preTranslate(f13, (this.currentEditMode == 3 ? this.currentPanTranslationY : BitmapDescriptorFactory.HUE_RED) + f12);
                            float f6622 = f59 - f14;
                            canvasBeginRecording.scale(f6622, f6622);
                            this.centerImageTransform.preScale(f6622, f6622);
                            canvasBeginRecording.rotate(f17);
                            this.centerImageTransform.preRotate(f17);
                            if (this.currentEditMode == 3) {
                            }
                        }
                    } else {
                        f16 = f10;
                        f17 = f9;
                        canvasBeginRecording.save();
                        f18 = i6;
                        float f63222 = f18 / 2.0f;
                        i7 = i5;
                        float f64222 = i7;
                        float f65222 = f64222 / 2.0f;
                        canvasBeginRecording.translate(f63222 + getAdditionX(this.currentEditMode), f65222 + getAdditionY(this.currentEditMode));
                        this.centerImageTransform.preTranslate(f63222 + getAdditionX(this.currentEditMode), f65222 + getAdditionY(this.currentEditMode));
                        canvasBeginRecording.translate(f13, (this.currentEditMode == 3 ? this.currentPanTranslationY : BitmapDescriptorFactory.HUE_RED) + f12);
                        this.centerImageTransform.preTranslate(f13, (this.currentEditMode == 3 ? this.currentPanTranslationY : BitmapDescriptorFactory.HUE_RED) + f12);
                        float f66222 = f59 - f14;
                        canvasBeginRecording.scale(f66222, f66222);
                        this.centerImageTransform.preScale(f66222, f66222);
                        canvasBeginRecording.rotate(f17);
                        this.centerImageTransform.preRotate(f17);
                        if (this.currentEditMode == 3 || this.photoPaintView == null) {
                            f19 = f18;
                        } else {
                            f19 = f18;
                            float emojiPadding2 = ((r3 - this.photoPaintView.getEmojiPadding(Math.abs((AndroidUtilities.displaySize.y + AndroidUtilities.statusBarHeight) - getContainerViewHeight(true, 0)) < AndroidUtilities.dp(20.0f))) - getContainerViewHeight(false, 0)) / 2.0f;
                            canvasBeginRecording.translate(BitmapDescriptorFactory.HUE_RED, (1.0f - this.photoPaintView.adjustPanLayoutHelperProgress()) * emojiPadding2);
                            this.centerImageTransform.preTranslate(BitmapDescriptorFactory.HUE_RED, emojiPadding2 * (1.0f - this.photoPaintView.adjustPanLayoutHelperProgress()));
                        }
                        if (!this.pipAnimationInProgress || (z2 && ((this.textureUploaded || this.videoSizeSet) && this.videoCrossfadeStarted && this.videoCrossfadeAlpha == 1.0f))) {
                            f20 = f17;
                            f21 = f16;
                            i8 = i7;
                            f22 = f13;
                            f23 = f73;
                        } else {
                            Bitmap bitmap = this.videoFrameBitmap;
                            if (bitmap == null || !this.isCurrentVideo) {
                                f20 = f17;
                                f21 = f16;
                                i8 = i7;
                                f22 = f13;
                                f23 = f73;
                                this.centerImage.setAlpha(f23);
                                int bitmapWidth3 = this.centerImage.getBitmapWidth();
                                int bitmapHeight3 = this.centerImage.getBitmapHeight();
                                float cropFillScale = (this.isCurrentVideo && this.currentEditMode == 0 && this.sendPhotoType == 1) ? getCropFillScale(false) : Math.min(f19 / bitmapWidth3, f64222 / bitmapHeight3);
                                this.centerImage.setImageCoords((-r1) / 2, (-r2) / 2, (int) (bitmapWidth3 * cropFillScale), (int) (bitmapHeight3 * cropFillScale));
                                if (this.isCurrentVideo) {
                                    this.centerImage.draw(canvasBeginRecording);
                                    this.centerImageTransformLocked = true;
                                } else {
                                    z3 = true;
                                    if (z2 && this.textureUploaded && this.videoSizeSet) {
                                        View view = this.usedSurfaceView ? this.videoSurfaceView : this.videoTextureView;
                                        bitmapWidth = view.getMeasuredWidth();
                                        bitmapHeight = view.getMeasuredHeight();
                                    } else {
                                        bitmapWidth = this.centerImage.getBitmapWidth();
                                        bitmapHeight = this.centerImage.getBitmapHeight();
                                    }
                                    float f76 = bitmapWidth;
                                    float f77 = f19 / f76;
                                    float f78 = bitmapHeight;
                                    float f79 = f64222 / f78;
                                    float fMin4 = Math.min(f77, f79);
                                    int i44 = bitmapHeight;
                                    int i45 = (int) (f76 * fMin4);
                                    int i46 = bitmapWidth;
                                    int i47 = (int) (f78 * fMin4);
                                    i9 = i6;
                                    if (this.imagesArrLocals.isEmpty()) {
                                        int i48 = this.currentEditMode;
                                        if (i48 != 3) {
                                            z4 = z2;
                                            int i49 = this.switchingToMode;
                                            if (i49 != 3) {
                                                i10 = i47;
                                                if (this.sendPhotoType != 1) {
                                                    if (this.imageMoveAnimation != null) {
                                                        i21 = -1;
                                                        if (i49 == -1) {
                                                        }
                                                    } else {
                                                        i21 = -1;
                                                    }
                                                    if (i48 == 0 || i48 == 4 || i48 == 1 || i49 != i21) {
                                                    }
                                                } else if (i49 == 0 || i48 != 2) {
                                                }
                                                if (z5) {
                                                    i11 = i45;
                                                    z6 = z3;
                                                    f24 = f23;
                                                    f25 = f59;
                                                    i12 = i44;
                                                    i13 = i46;
                                                    f26 = 1.0f;
                                                } else {
                                                    int orientation = this.cropTransform.getOrientation();
                                                    if (orientation == 90 || orientation == 270) {
                                                        i17 = i44;
                                                        i18 = i46;
                                                    } else {
                                                        i18 = i44;
                                                        i17 = i46;
                                                    }
                                                    i11 = i45;
                                                    if (this.sendPhotoType != 1 && (this.currentEditMode == 3 || this.switchingToMode == 3)) {
                                                        f24 = f23;
                                                    } else if (this.imageMoveAnimation == null || (i19 = this.switchingToMode) == -1) {
                                                        f24 = f23;
                                                        int i50 = this.currentEditMode;
                                                        if (i50 == 2 || i50 == 3) {
                                                            f30 = BitmapDescriptorFactory.HUE_RED;
                                                        }
                                                        float cropPw = this.cropTransform.getCropPw();
                                                        float cropPh = this.cropTransform.getCropPh();
                                                        f31 = i17;
                                                        f32 = 1.0f - f30;
                                                        int i51 = (int) ((cropPw + ((1.0f - cropPw) * f32)) * f31);
                                                        f33 = i18;
                                                        int i52 = (int) ((cropPh + ((1.0f - cropPh) * f32)) * f33);
                                                        z6 = z3;
                                                        f34 = i51;
                                                        f35 = f19 / f34;
                                                        f36 = i52;
                                                        if (f35 * f36 > f64222) {
                                                            f35 = f64222 / f36;
                                                        }
                                                        f25 = f59;
                                                        if (this.sendPhotoType != 1 && ((this.currentEditMode != 1 || this.switchingToMode == 0) && this.editState.cropState != null)) {
                                                            float f80 = f34 * f35;
                                                            float f81 = f36 * f35;
                                                            if (f77 * f78 > f64222) {
                                                                f77 = f79;
                                                            }
                                                            float f82 = f80 + ((((f76 * f77) / f66222) - f80) * f32);
                                                            float f83 = f81 + ((((f78 * f77) / f66222) - f81) * f32);
                                                            canvasBeginRecording.clipRect((-f82) / 2.0f, (-f83) / 2.0f, f82 / 2.0f, f83 / 2.0f);
                                                        }
                                                        if (this.sendPhotoType == 1 || this.cropTransform.hasViewTransform()) {
                                                            if (this.currentEditMode != 1 || this.sendPhotoType == 1) {
                                                                textureView = this.videoTextureView;
                                                                if (textureView != null) {
                                                                    textureView.setScaleX(this.cropTransform.isMirrored() ? -1.0f : 1.0f);
                                                                    FirstFrameView firstFrameView = this.firstFrameView;
                                                                    if (firstFrameView != null) {
                                                                        firstFrameView.setScaleX(this.videoTextureView.getScaleX());
                                                                    }
                                                                }
                                                                float scale = this.cropTransform.getScale() / (((this.cropTransform.getTrueCropScale() - 1.0f) * f32) + 1.0f);
                                                                f37 = f19 / f31;
                                                                if (f37 * f33 > f64222) {
                                                                    f37 = f64222 / f33;
                                                                }
                                                                f38 = scale * (f37 / fMin4);
                                                                if (this.sendPhotoType == 1) {
                                                                    if (this.currentEditMode == 3 || (i20 = this.switchingToMode) == 3) {
                                                                        minScale = ((this.cropTransform.getMinScale() - 1.0f) * f32) + 1.0f;
                                                                    } else if (i20 == 0) {
                                                                        minScale = this.cropTransform.getMinScale();
                                                                    }
                                                                    f38 /= minScale;
                                                                }
                                                            } else {
                                                                TextureView textureView2 = this.videoTextureView;
                                                                if (textureView2 != null) {
                                                                    MediaController.CropState cropState2 = this.editState.cropState;
                                                                    textureView2.setScaleX((cropState2 == null || !cropState2.mirrored) ? 1.0f : -1.0f);
                                                                    FirstFrameView firstFrameView2 = this.firstFrameView;
                                                                    if (firstFrameView2 != null) {
                                                                        firstFrameView2.setScaleX(this.videoTextureView.getScaleX());
                                                                    }
                                                                }
                                                                MediaController.CropState cropState3 = this.editState.cropState;
                                                                float f84 = cropState3 != null ? cropState3.cropScale : 1.0f;
                                                                f38 = f84 * ((f35 / fMin4) / (((f84 - 1.0f) * f32) + 1.0f));
                                                            }
                                                            canvasBeginRecording.translate(this.cropTransform.getCropAreaX() * f30, this.cropTransform.getCropAreaY() * f30);
                                                            if (!this.centerImageTransformLocked) {
                                                                this.centerImageTransform.preTranslate(this.cropTransform.getCropAreaX() * f30, this.cropTransform.getCropAreaY() * f30);
                                                            }
                                                            this.currentCropScale = f38;
                                                            canvasBeginRecording.scale(f38, f38);
                                                            if (!this.centerImageTransformLocked) {
                                                                this.centerImageTransform.preScale(f38, f38);
                                                            }
                                                            float cropPx = this.cropTransform.getCropPx() * f31 * fMin4 * f30;
                                                            this.currentCropX = cropPx;
                                                            float cropPy = this.cropTransform.getCropPy() * f33 * fMin4 * f30;
                                                            this.currentCropY = cropPy;
                                                            canvasBeginRecording.translate(cropPx, cropPy);
                                                            if (!this.centerImageTransformLocked) {
                                                                this.centerImageTransform.preTranslate(this.cropTransform.getCropPx() * f31 * fMin4 * f30, this.cropTransform.getCropPy() * f33 * fMin4 * f30);
                                                            }
                                                            rotation = this.cropTransform.getRotation() + orientation;
                                                            if (rotation > 180.0f) {
                                                                rotation -= 360.0f;
                                                            }
                                                            if (this.sendPhotoType == 1 || !(this.currentEditMode == 3 || this.switchingToMode == 3)) {
                                                                rotation *= f30;
                                                                canvasBeginRecording.rotate(rotation);
                                                                if (!this.centerImageTransformLocked) {
                                                                    this.centerImageTransform.preRotate(rotation);
                                                                }
                                                            } else {
                                                                canvasBeginRecording.rotate(rotation);
                                                                if (!this.centerImageTransformLocked) {
                                                                }
                                                            }
                                                        } else {
                                                            TextureView textureView3 = this.videoTextureView;
                                                            if (textureView3 != null) {
                                                                textureView3.setScaleX(1.0f);
                                                                this.videoTextureView.setScaleY(1.0f);
                                                                FirstFrameView firstFrameView3 = this.firstFrameView;
                                                                if (firstFrameView3 != null) {
                                                                    firstFrameView3.setScaleX(1.0f);
                                                                    this.firstFrameView.setScaleY(1.0f);
                                                                }
                                                            }
                                                        }
                                                        f26 = f35;
                                                        i13 = i51;
                                                        i12 = i52;
                                                    } else {
                                                        f24 = f23;
                                                        if (this.currentEditMode != 1 && i19 != 1) {
                                                            f30 = i19 == 0 ? this.animationValue : 1.0f - this.animationValue;
                                                        }
                                                        float cropPw2 = this.cropTransform.getCropPw();
                                                        float cropPh2 = this.cropTransform.getCropPh();
                                                        f31 = i17;
                                                        f32 = 1.0f - f30;
                                                        int i512 = (int) ((cropPw2 + ((1.0f - cropPw2) * f32)) * f31);
                                                        f33 = i18;
                                                        int i522 = (int) ((cropPh2 + ((1.0f - cropPh2) * f32)) * f33);
                                                        z6 = z3;
                                                        f34 = i512;
                                                        f35 = f19 / f34;
                                                        f36 = i522;
                                                        if (f35 * f36 > f64222) {
                                                        }
                                                        f25 = f59;
                                                        if (this.sendPhotoType != 1) {
                                                            float f802 = f34 * f35;
                                                            float f812 = f36 * f35;
                                                            if (f77 * f78 > f64222) {
                                                            }
                                                            float f822 = f802 + ((((f76 * f77) / f66222) - f802) * f32);
                                                            float f832 = f812 + ((((f78 * f77) / f66222) - f812) * f32);
                                                            canvasBeginRecording.clipRect((-f822) / 2.0f, (-f832) / 2.0f, f822 / 2.0f, f832 / 2.0f);
                                                        }
                                                        if (this.sendPhotoType == 1) {
                                                            if (this.currentEditMode != 1) {
                                                                textureView = this.videoTextureView;
                                                                if (textureView != null) {
                                                                }
                                                                float scale2 = this.cropTransform.getScale() / (((this.cropTransform.getTrueCropScale() - 1.0f) * f32) + 1.0f);
                                                                f37 = f19 / f31;
                                                                if (f37 * f33 > f64222) {
                                                                }
                                                                f38 = scale2 * (f37 / fMin4);
                                                                if (this.sendPhotoType == 1) {
                                                                }
                                                                canvasBeginRecording.translate(this.cropTransform.getCropAreaX() * f30, this.cropTransform.getCropAreaY() * f30);
                                                                if (!this.centerImageTransformLocked) {
                                                                }
                                                                this.currentCropScale = f38;
                                                                canvasBeginRecording.scale(f38, f38);
                                                                if (!this.centerImageTransformLocked) {
                                                                }
                                                                float cropPx2 = this.cropTransform.getCropPx() * f31 * fMin4 * f30;
                                                                this.currentCropX = cropPx2;
                                                                float cropPy2 = this.cropTransform.getCropPy() * f33 * fMin4 * f30;
                                                                this.currentCropY = cropPy2;
                                                                canvasBeginRecording.translate(cropPx2, cropPy2);
                                                                if (!this.centerImageTransformLocked) {
                                                                }
                                                                rotation = this.cropTransform.getRotation() + orientation;
                                                                if (rotation > 180.0f) {
                                                                }
                                                                if (this.sendPhotoType == 1) {
                                                                    rotation *= f30;
                                                                    canvasBeginRecording.rotate(rotation);
                                                                    if (!this.centerImageTransformLocked) {
                                                                    }
                                                                    f26 = f35;
                                                                    i13 = i512;
                                                                    i12 = i522;
                                                                }
                                                            }
                                                        }
                                                    }
                                                    f30 = 1.0f;
                                                    float cropPw22 = this.cropTransform.getCropPw();
                                                    float cropPh22 = this.cropTransform.getCropPh();
                                                    f31 = i17;
                                                    f32 = 1.0f - f30;
                                                    int i5122 = (int) ((cropPw22 + ((1.0f - cropPw22) * f32)) * f31);
                                                    f33 = i18;
                                                    int i5222 = (int) ((cropPh22 + ((1.0f - cropPh22) * f32)) * f33);
                                                    z6 = z3;
                                                    f34 = i5122;
                                                    f35 = f19 / f34;
                                                    f36 = i5222;
                                                    if (f35 * f36 > f64222) {
                                                    }
                                                    f25 = f59;
                                                    if (this.sendPhotoType != 1) {
                                                    }
                                                    if (this.sendPhotoType == 1) {
                                                    }
                                                }
                                                i14 = this.currentEditMode;
                                                if (i14 != 3) {
                                                    LPhotoPaintView lPhotoPaintView = this.photoPaintView;
                                                    lPhotoPaintView.setTransform(f25, f21, f12 + ((this.sendPhotoType == 1 ? AndroidUtilities.statusBarHeight / 2.0f : BitmapDescriptorFactory.HUE_RED) * lPhotoPaintView.getRenderView().getScaleX()), i13 * f26, i12 * f26);
                                                } else if (i14 == 4) {
                                                    this.maskPaintView.setTransform(f25, f21, f12, f20, i13 * f26, i12 * f26);
                                                }
                                                if (z6 || this.usedSurfaceView) {
                                                    f27 = f11;
                                                    f28 = f24;
                                                } else {
                                                    f27 = f11;
                                                    f28 = f24;
                                                    drawCenterImageInternal(canvasBeginRecording, f27, f28);
                                                }
                                                canvasBeginRecording.save();
                                                if (f27 <= BitmapDescriptorFactory.HUE_RED) {
                                                    canvasBeginRecording.save();
                                                    canvasBeginRecording.scale(1.0f - (f27 * 2.0f), 1.0f);
                                                    canvasBeginRecording.skew(BitmapDescriptorFactory.HUE_RED, f27 * 4.0f * (1.0f - f27) * 0.25f);
                                                    i15 = i11;
                                                    z7 = true;
                                                } else {
                                                    i15 = i11;
                                                    z7 = false;
                                                }
                                                float f85 = (-i15) / 2;
                                                int i53 = i10;
                                                float f86 = (-i53) / 2;
                                                canvasBeginRecording.translate(f85, f86);
                                                if (!z4 || this.paintingOverlay.getVisibility() == 0) {
                                                    canvasBeginRecording.scale(fMin4, fMin4);
                                                }
                                                if (z4) {
                                                    j2 = j;
                                                } else {
                                                    if (!this.videoCrossfadeStarted && ((this.usedSurfaceView && this.firstFrameRendered) || (this.textureUploaded && this.videoSizeSet))) {
                                                        this.videoCrossfadeStarted = true;
                                                        this.videoCrossfadeAlpha = BitmapDescriptorFactory.HUE_RED;
                                                        this.videoCrossfadeAlphaLastTime = System.currentTimeMillis();
                                                        this.containerView.getMeasuredHeight();
                                                    }
                                                    TextureView textureView4 = this.videoTextureView;
                                                    if (textureView4 != null) {
                                                        textureView4.setAlpha(this.videoCrossfadeAlpha * f28);
                                                    }
                                                    TextureView textureView5 = this.videoTextureView;
                                                    if (textureView5 instanceof VideoEditTextureView) {
                                                        ((VideoEditTextureView) textureView5).setViewRect(((i9 - i15) / 2.0f) + getAdditionX(this.currentEditMode) + f22, ((i8 - i53) / 2.0f) + getAdditionY(this.currentEditMode) + f12 + this.currentPanTranslationY, i15, i53);
                                                    }
                                                    SurfaceView surfaceView = this.videoSurfaceView;
                                                    if (surfaceView != null && this.waitingForDraw == 0 && !this.changingTextureView && !this.switchingInlineMode && !this.pipAnimationInProgress && surfaceView.getVisibility() != 0) {
                                                        this.videoSurfaceView.setVisibility(0);
                                                    }
                                                    if (!this.usedSurfaceView || this.firstFrameRendered) {
                                                        this.aspectRatioFrameLayout.draw(canvasBeginRecording);
                                                        VideoFramesRewinder videoFramesRewinder = this.framesRewinder;
                                                        if (videoFramesRewinder != null) {
                                                            videoFramesRewinder.draw(canvasBeginRecording, this.aspectRatioFrameLayout.getWidth(), this.aspectRatioFrameLayout.getHeight());
                                                        }
                                                    }
                                                    if (this.usedSurfaceView && f28 != 1.0f) {
                                                        if (this.surfaceBlackoutPaint == null) {
                                                            this.surfaceBlackoutPaint = new Paint();
                                                        }
                                                        this.surfaceBlackoutPaint.setAlpha((int) ((1.0f - f28) * 255.0f));
                                                        canvasBeginRecording.drawRect(-1.0f, -1.0f, this.aspectRatioFrameLayout.getWidth() + 1.0f, this.aspectRatioFrameLayout.getHeight() + 1.0f, this.surfaceBlackoutPaint);
                                                    }
                                                    if (this.videoCrossfadeStarted) {
                                                        float f87 = this.videoCrossfadeAlpha;
                                                        if (f87 < 1.0f) {
                                                            j2 = j;
                                                            this.videoCrossfadeAlpha = f87 + (j2 / (this.playerInjected ? 100.0f : 200.0f));
                                                            this.containerView.invalidate();
                                                            invalidateBlur();
                                                            if (this.videoCrossfadeAlpha > 1.0f) {
                                                                this.videoCrossfadeAlpha = 1.0f;
                                                            }
                                                        } else {
                                                            j2 = j;
                                                        }
                                                        this.paintingOverlay.setAlpha(f28);
                                                    }
                                                }
                                                if (z7) {
                                                    canvasBeginRecording.restore();
                                                    canvasBeginRecording.translate(f85, f86);
                                                    if (z4 || this.paintingOverlay.getVisibility() == 0) {
                                                        canvasBeginRecording.scale(fMin4, fMin4);
                                                    }
                                                }
                                                if (this.paintingOverlay.getVisibility() == 0 && (this.isCurrentVideo || this.currentEditMode != 2 || this.switchingToMode != -1)) {
                                                    if (this.sendPhotoType != 11) {
                                                        canvasBeginRecording.clipRect(0, 0, this.paintingOverlay.getMeasuredWidth(), this.paintingOverlay.getMeasuredHeight());
                                                    }
                                                    this.paintingOverlay.draw(canvasBeginRecording);
                                                }
                                                canvasBeginRecording.restore();
                                                if (z6 && this.usedSurfaceView) {
                                                    f29 = this.videoCrossfadeAlpha;
                                                    if (f29 != 1.0f) {
                                                        drawCenterImageInternal(canvasBeginRecording, f27, (1.0f - f29) * f28);
                                                    }
                                                }
                                                canvasBeginRecording.restore();
                                                i16 = 0;
                                                while (true) {
                                                    gradientDrawableArr = this.pressedDrawable;
                                                    if (i16 < gradientDrawableArr.length) {
                                                        break;
                                                    }
                                                    if (this.drawPressedDrawable[i16] || this.pressedDrawableAlpha[i16] != BitmapDescriptorFactory.HUE_RED) {
                                                        gradientDrawableArr[i16].setAlpha((int) (this.pressedDrawableAlpha[i16] * 255.0f));
                                                        GradientDrawable[] gradientDrawableArr2 = this.pressedDrawable;
                                                        if (i16 == 0) {
                                                            gradientDrawableArr2[i16].setBounds(0, 0, this.containerView.getMeasuredWidth() / 5, this.containerView.getMeasuredHeight());
                                                        } else {
                                                            gradientDrawableArr2[i16].setBounds(this.containerView.getMeasuredWidth() - (this.containerView.getMeasuredWidth() / 5), 0, this.containerView.getMeasuredWidth(), this.containerView.getMeasuredHeight());
                                                        }
                                                        this.pressedDrawable[i16].draw(canvasBeginRecording);
                                                    }
                                                    if (this.drawPressedDrawable[i16]) {
                                                        float[] fArr = this.pressedDrawableAlpha;
                                                        float f88 = fArr[i16];
                                                        if (f88 < 1.0f) {
                                                            float f89 = f88 + (j2 / 180.0f);
                                                            fArr[i16] = f89;
                                                            if (f89 > 1.0f) {
                                                                fArr[i16] = 1.0f;
                                                            }
                                                            this.containerView.invalidate();
                                                        }
                                                    } else {
                                                        float[] fArr2 = this.pressedDrawableAlpha;
                                                        float f90 = fArr2[i16];
                                                        if (f90 > BitmapDescriptorFactory.HUE_RED) {
                                                            float f91 = f90 - (j2 / 180.0f);
                                                            fArr2[i16] = f91;
                                                            if (f91 < BitmapDescriptorFactory.HUE_RED) {
                                                                fArr2[i16] = 0.0f;
                                                            }
                                                            this.containerView.invalidate();
                                                        }
                                                    }
                                                    i16++;
                                                }
                                            } else {
                                                i10 = i47;
                                            }
                                        } else {
                                            i10 = i47;
                                            z4 = z2;
                                        }
                                        z5 = true;
                                        if (z5) {
                                        }
                                        i14 = this.currentEditMode;
                                        if (i14 != 3) {
                                        }
                                        if (z6) {
                                            f27 = f11;
                                            f28 = f24;
                                            canvasBeginRecording.save();
                                            if (f27 <= BitmapDescriptorFactory.HUE_RED) {
                                            }
                                            float f852 = (-i15) / 2;
                                            int i532 = i10;
                                            float f862 = (-i532) / 2;
                                            canvasBeginRecording.translate(f852, f862);
                                            if (!z4) {
                                                canvasBeginRecording.scale(fMin4, fMin4);
                                                if (z4) {
                                                }
                                                if (z7) {
                                                }
                                                if (this.paintingOverlay.getVisibility() == 0) {
                                                    if (this.sendPhotoType != 11) {
                                                    }
                                                    this.paintingOverlay.draw(canvasBeginRecording);
                                                }
                                                canvasBeginRecording.restore();
                                                if (z6) {
                                                    f29 = this.videoCrossfadeAlpha;
                                                    if (f29 != 1.0f) {
                                                    }
                                                }
                                                canvasBeginRecording.restore();
                                                i16 = 0;
                                                while (true) {
                                                    gradientDrawableArr = this.pressedDrawable;
                                                    if (i16 < gradientDrawableArr.length) {
                                                    }
                                                    i16++;
                                                }
                                            }
                                        }
                                    } else {
                                        i10 = i47;
                                        z4 = z2;
                                    }
                                    z5 = false;
                                    if (z5) {
                                    }
                                    i14 = this.currentEditMode;
                                    if (i14 != 3) {
                                    }
                                    if (z6) {
                                    }
                                }
                            } else {
                                int width = bitmap.getWidth();
                                int i54 = (-width) / 2;
                                float f92 = f17;
                                int i55 = (-this.videoFrameBitmap.getHeight()) / 2;
                                if (f73 < 1.0f) {
                                    i22 = i55;
                                    f20 = f92;
                                    i8 = i7;
                                    f21 = f16;
                                    i23 = i54;
                                    f22 = f13;
                                    f23 = f73;
                                    canvasBeginRecording.saveLayerAlpha(i54, i55, width + i54, r2 + i55, (int) (f73 * 255.0f), 31);
                                } else {
                                    i22 = i55;
                                    f21 = f16;
                                    i8 = i7;
                                    f22 = f13;
                                    f20 = f92;
                                    i23 = i54;
                                    f23 = f73;
                                }
                                canvasBeginRecording.drawBitmap(this.videoFrameBitmap, i23, i22, this.videoFrameBitmapPaint);
                                if (f23 < 1.0f) {
                                    canvasBeginRecording.restore();
                                }
                            }
                        }
                        z3 = false;
                        if (z2) {
                            bitmapWidth = this.centerImage.getBitmapWidth();
                            bitmapHeight = this.centerImage.getBitmapHeight();
                            float f762 = bitmapWidth;
                            float f772 = f19 / f762;
                            float f782 = bitmapHeight;
                            float f792 = f64222 / f782;
                            float fMin42 = Math.min(f772, f792);
                            int i442 = bitmapHeight;
                            int i452 = (int) (f762 * fMin42);
                            int i462 = bitmapWidth;
                            int i472 = (int) (f782 * fMin42);
                            i9 = i6;
                            if (this.imagesArrLocals.isEmpty()) {
                            }
                            z5 = false;
                            if (z5) {
                            }
                            i14 = this.currentEditMode;
                            if (i14 != 3) {
                            }
                            if (z6) {
                            }
                        }
                    }
                } else {
                    f22 = f13;
                    f25 = f59;
                    i8 = i5;
                    f21 = f10;
                    i9 = i6;
                    f28 = f73;
                }
                drawProgress(canvasBeginRecording, f22, f25, f12, f28);
                imageReceiver = this.sideImage;
                if (imageReceiver != this.leftImage) {
                    if (imageReceiver.hasBitmapImage()) {
                        canvasBeginRecording.save();
                        canvasBeginRecording.translate(i9 / 2, i8 / 2);
                        int i56 = i9;
                        float f93 = i56;
                        float f94 = f21;
                        canvasBeginRecording.translate(((-(((this.scale + 1.0f) * f93) + AndroidUtilities.dp(30.0f))) / 2.0f) + f94, BitmapDescriptorFactory.HUE_RED);
                        int bitmapWidth4 = this.sideImage.getBitmapWidth();
                        int bitmapHeight4 = this.sideImage.getBitmapHeight();
                        if (this.leftImageIsVideo || this.leftCropState == null || !this.leftCropTransform.hasViewTransform()) {
                            f39 = f28;
                            i26 = bitmapHeight4;
                            i25 = i56;
                            f41 = f94;
                            i27 = i8;
                            c = 2;
                            i28 = bitmapWidth4;
                        } else {
                            float f95 = f28;
                            i26 = bitmapHeight4;
                            i25 = i56;
                            f41 = f94;
                            i27 = i8;
                            i28 = bitmapWidth4;
                            f39 = f95;
                            c = 2;
                            applyCrop(canvasBeginRecording, i56, i8, bitmapWidth4, bitmapHeight4, f25, this.leftCropTransform, this.leftCropState);
                        }
                        float f96 = i28;
                        float f97 = i26;
                        float fMin5 = Math.min(f93 / f96, i27 / f97);
                        int i57 = (int) (f96 * fMin5);
                        int i58 = (int) (f97 * fMin5);
                        if (this.imagesArrLocals.isEmpty()) {
                            zIsMirrored = false;
                            if (zIsMirrored) {
                                canvasBeginRecording.scale(-1.0f, 1.0f);
                            }
                            this.sideImage.setAlpha(1.0f);
                            int i59 = (-i57) / 2;
                            int i60 = (-i58) / 2;
                            this.sideImage.setImageCoords(i59, i60, i57, i58);
                            this.sideImage.draw(canvasBeginRecording);
                            paintingOverlay = this.leftPaintingOverlay;
                            if (paintingOverlay == null && paintingOverlay.getVisibility() == 0) {
                                canvasBeginRecording.clipRect(i59, i60, i57 / 2, i58 / 2);
                                if (this.leftPaintingOverlay.getMeasuredWidth() != i28 || this.leftPaintingOverlay.getMeasuredHeight() != i26) {
                                    this.leftPaintingOverlay.measure(View.MeasureSpec.makeMeasureSpec(i28, 1073741824), View.MeasureSpec.makeMeasureSpec(i26, 1073741824));
                                    this.leftPaintingOverlay.layout(0, 0, i28, i26);
                                }
                                canvasBeginRecording.scale(fMin5, fMin5);
                                canvasBeginRecording.translate((-i28) / 2, (-i26) / 2);
                                f40 = 1.0f;
                                this.leftPaintingOverlay.setAlpha(1.0f);
                                this.leftPaintingOverlay.draw(canvasBeginRecording);
                            } else {
                                f40 = 1.0f;
                            }
                            canvasBeginRecording.restore();
                        } else {
                            if (this.currentEditMode == 1 || this.sendPhotoType == 1) {
                                zIsMirrored = this.leftCropTransform.isMirrored();
                            } else {
                                MediaController.CropState cropState4 = this.leftCropState;
                                if (cropState4 != null && cropState4.mirrored) {
                                    zIsMirrored = true;
                                }
                            }
                            if (zIsMirrored) {
                            }
                            this.sideImage.setAlpha(1.0f);
                            int i592 = (-i57) / 2;
                            int i602 = (-i58) / 2;
                            this.sideImage.setImageCoords(i592, i602, i57, i58);
                            this.sideImage.draw(canvasBeginRecording);
                            paintingOverlay = this.leftPaintingOverlay;
                            if (paintingOverlay == null) {
                                f40 = 1.0f;
                                canvasBeginRecording.restore();
                            }
                        }
                    } else {
                        f39 = f28;
                        f40 = 1.0f;
                        c = 2;
                        int i61 = i9;
                        f41 = f21;
                        i25 = i61;
                    }
                    this.groupedPhotosListView.setMoveProgress(f40 - f39);
                    SeekSpeedDrawable seekSpeedDrawable2 = this.seekSpeedDrawable;
                    if (seekSpeedDrawable2 == null || !seekSpeedDrawable2.isShown()) {
                        canvasBeginRecording.save();
                        canvasBeginRecording.translate(f41, f12 / f25);
                        canvasBeginRecording.translate((-((i25 * (this.scale + 1.0f)) + AndroidUtilities.dp(30.0f))) / 2.0f, (-f12) / f25);
                        this.photoProgressViews[c].setScale(1.0f);
                        this.photoProgressViews[c].setAlpha(1.0f);
                        this.photoProgressViews[c].onDraw(canvasBeginRecording);
                        if (this.isActionBarVisible) {
                            this.fullscreenButton[c].setAlpha(1.0f);
                        }
                        canvasBeginRecording.restore();
                    }
                } else if (this.isActionBarVisible) {
                    this.fullscreenButton[2].setAlpha(BitmapDescriptorFactory.HUE_RED);
                }
                i24 = this.waitingForDraw;
                if (i24 != 0) {
                    int i62 = i24 - 1;
                    this.waitingForDraw = i62;
                    if (i62 == 0) {
                        TextureView textureView6 = this.changedTextureView;
                        if (textureView6 != null && !this.usedSurfaceView) {
                            try {
                                this.currentBitmap = textureView6.getBitmap();
                                drawable = null;
                            } catch (Throwable th) {
                                Bitmap bitmap2 = this.currentBitmap;
                                if (bitmap2 != null) {
                                    bitmap2.recycle();
                                    drawable = null;
                                    this.currentBitmap = null;
                                } else {
                                    drawable = null;
                                }
                                FileLog.e(th);
                            }
                            if (this.currentBitmap != null) {
                                this.textureImageView.setVisibility(0);
                                this.textureImageView.setImageBitmap(this.currentBitmap);
                            } else {
                                this.textureImageView.setImageDrawable(drawable);
                            }
                        }
                        if (this.usedSurfaceView) {
                            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda100
                                @Override // java.lang.Runnable
                                public final void run() {
                                    this.f$0.lambda$onDraw$144();
                                }
                            });
                        } else {
                            PipVideoOverlay.dismiss(true);
                        }
                    } else {
                        this.containerView.invalidate();
                    }
                }
                if (this.padImageForHorizontalInsets) {
                    canvasBeginRecording.restore();
                }
                if (this.aspectRatioFrameLayout != null) {
                    int measuredHeight = ((int) (r0.getMeasuredHeight() * (f25 - 1.0f))) / 2;
                    if (this.videoForwardDrawable.isAnimating()) {
                        int i63 = (int) (f12 / f25);
                        this.videoForwardDrawable.setBounds(this.aspectRatioFrameLayout.getLeft(), (this.aspectRatioFrameLayout.getTop() - measuredHeight) + i63, this.aspectRatioFrameLayout.getRight(), this.aspectRatioFrameLayout.getBottom() + measuredHeight + i63);
                        this.videoForwardDrawable.draw(canvasBeginRecording);
                    }
                    if (this.seekSpeedDrawable.isShown()) {
                        this.seekSpeedDrawable.setBounds(this.aspectRatioFrameLayout.getLeft(), (int) (AndroidUtilities.statusBarHeight + (AndroidUtilities.dp(90.0f) * this.actionBar.getAlpha())), this.aspectRatioFrameLayout.getRight(), this.aspectRatioFrameLayout.getBottom() + measuredHeight + ((int) (f12 / f25)));
                        this.seekSpeedDrawable.draw(canvasBeginRecording);
                    }
                }
                if (BLUR_RENDERNODE()) {
                    canvas2 = canvasBeginRecording;
                } else {
                    this.renderNode.endRecording();
                    canvas2 = canvas;
                    canvas2.drawRenderNode(this.renderNode);
                }
                drawFancyShadows(canvas2);
                if (this.zoomAnimation) {
                }
                if (this.videoSizeSet) {
                }
                this.centerImageTransformLocked = z;
                this.centerImageTransform.reset();
                MaskPaintView maskPaintView22 = this.maskPaintView;
                if (maskPaintView22 != null) {
                }
                if (this.centerImage.hasBitmapImage()) {
                }
                drawProgress(canvasBeginRecording, f22, f25, f12, f28);
                imageReceiver = this.sideImage;
                if (imageReceiver != this.leftImage) {
                }
                i24 = this.waitingForDraw;
                if (i24 != 0) {
                }
                if (this.padImageForHorizontalInsets) {
                }
                if (this.aspectRatioFrameLayout != null) {
                }
                if (BLUR_RENDERNODE()) {
                }
                drawFancyShadows(canvas2);
            }
            f8 = f4;
        }
        f6 = f5;
        f7 = f3;
        float f582 = f2;
        float f592 = f;
        float emojiPadding3 = f4 + this.translateY;
        if (this.currentEditMode == 3) {
        }
        float f602 = emojiPadding3;
        photoViewerWebView = this.photoViewerWebView;
        if (photoViewerWebView != null) {
        }
        if (this.isActionBarVisible) {
        }
        int containerViewWidth2 = getContainerViewWidth();
        int containerViewHeight2 = getContainerViewHeight();
        i2 = this.animationInProgress;
        if (i2 != 2) {
            if (i2 == 4) {
            }
        }
        this.sideImage = null;
        if (this.currentEditMode == 0) {
            if (this.scale >= 1.0f) {
                if (f6 <= this.maxX + AndroidUtilities.dp(5.0f)) {
                }
                this.sideImage = imageReceiver2;
            }
            this.changingPage = this.sideImage == null;
        }
        i3 = 0;
        while (i3 < i4) {
        }
        if (this.sideImage == this.rightImage) {
        }
        if (this.zoomAnimation) {
        }
        if (this.videoSizeSet) {
        }
        this.centerImageTransformLocked = z;
        this.centerImageTransform.reset();
        MaskPaintView maskPaintView222 = this.maskPaintView;
        if (maskPaintView222 != null) {
        }
        if (this.centerImage.hasBitmapImage()) {
        }
        drawProgress(canvasBeginRecording, f22, f25, f12, f28);
        imageReceiver = this.sideImage;
        if (imageReceiver != this.leftImage) {
        }
        i24 = this.waitingForDraw;
        if (i24 != 0) {
        }
        if (this.padImageForHorizontalInsets) {
        }
        if (this.aspectRatioFrameLayout != null) {
        }
        if (BLUR_RENDERNODE()) {
        }
        drawFancyShadows(canvas2);
    }

    private void onHideView() {
        Activity activity = this.parentActivity;
        if (activity instanceof LaunchActivity) {
            ((LaunchActivity) activity).removeOnUserLeaveHintListener(this.onUserLeaveHintListener);
        }
        BaseFragment baseFragment = this.parentFragment;
        if (baseFragment == null || baseFragment.getFragmentView() == null) {
            return;
        }
        this.clippingImageProgress = 1.0f;
        View fragmentView = this.parentFragment.getFragmentView();
        fragmentView.setScaleX(1.0f);
        fragmentView.setScaleY(1.0f);
        ChatAttachAlert chatAttachAlert = this.parentAlert;
        if (chatAttachAlert != null) {
            BottomSheet.ContainerView container = chatAttachAlert.getContainer();
            container.setScaleX(1.0f);
            container.setScaleY(1.0f);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void onLinkClick(ClickableSpan clickableSpan, TextView textView) {
        if (textView != null && (clickableSpan instanceof URLSpan)) {
            String url = ((URLSpan) clickableSpan).getURL();
            if (url.startsWith(MediaStreamTrack.VIDEO_TRACK_KIND)) {
                if (this.videoPlayer == null || this.currentMessageObject == null) {
                    return;
                }
                int iIntValue = Utilities.parseInt((CharSequence) url).intValue();
                if (this.videoPlayer.getDuration() == -9223372036854775807L) {
                    this.seekToProgressPending = iIntValue / ((float) this.currentMessageObject.getDuration());
                    return;
                }
                long j = iIntValue * 1000;
                this.videoPlayer.seekTo(j);
                this.videoPlayerSeekbar.setProgress(j / this.videoPlayer.getDuration(), true);
                this.videoPlayerSeekbarView.invalidate();
                return;
            }
            if (url.startsWith("#")) {
                if (this.parentActivity instanceof LaunchActivity) {
                    DialogsActivity dialogsActivity = new DialogsActivity(null);
                    dialogsActivity.setSearchString(url);
                    ((LaunchActivity) this.parentActivity).presentFragment(dialogsActivity, false, true);
                    closePhoto(false, false);
                    return;
                }
                return;
            }
            if (this.parentChatActivity != null && ((clickableSpan instanceof URLSpanReplacement) || AndroidUtilities.shouldShowUrlInAlert(url))) {
                AlertsCreator.showOpenUrlAlert(this.parentChatActivity, url, true, true);
                return;
            }
        }
        clickableSpan.onClick(textView);
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Can't wrap try/catch for region: R(10:7|(3:9|63|10)(1:13)|14|(1:16)(2:18|(6:20|56|61|57|58|59)(1:(11:26|(1:37)|38|(2:40|(1:42)(2:43|(1:45)))|46|(2:48|(2:50|51))(2:52|(2:55|51))|56|61|57|58|59)))|17|56|61|57|58|59) */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void onLinkLongPress(final ClickableSpan clickableSpan, final TextView textView, final Runnable runnable) {
        int i;
        MessageObject messageObject;
        StringBuilder sb;
        MessageObject messageObject2;
        final String strSubstring;
        final boolean z;
        if (!(clickableSpan instanceof URLSpan)) {
            if (runnable != null) {
                runnable.run();
                return;
            }
            return;
        }
        String url = ((URLSpan) clickableSpan).getURL();
        BottomSheet.Builder builder = new BottomSheet.Builder(this.parentActivity, false, this.resourcesProvider, -14933463);
        if (url.startsWith("video?")) {
            try {
                i = Integer.parseInt(url.substring(url.indexOf(63) + 1));
            } catch (Throwable unused) {
            }
        } else {
            i = -1;
        }
        if (url.startsWith("mailto:")) {
            url = url.substring(7);
        } else {
            if (url.startsWith("tel:")) {
                strSubstring = url.substring(4);
                z = true;
                builder.setTitle(strSubstring);
                builder.setItems(new CharSequence[]{LocaleController.getString(R.string.Open), LocaleController.getString(R.string.CopyLink)}, new DialogInterface.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda157
                    @Override // android.content.DialogInterface.OnClickListener
                    public final void onClick(DialogInterface dialogInterface, int i2) {
                        this.f$0.lambda$onLinkLongPress$1(clickableSpan, textView, strSubstring, z, dialogInterface, i2);
                    }
                });
                builder.setOnPreDismissListener(new DialogInterface.OnDismissListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda158
                    @Override // android.content.DialogInterface.OnDismissListener
                    public final void onDismiss(DialogInterface dialogInterface) {
                        runnable.run();
                    }
                });
                BottomSheet bottomSheetCreate = builder.create();
                bottomSheetCreate.scrollNavBar = true;
                bottomSheetCreate.show();
                this.containerView.performHapticFeedback(0, 2);
                bottomSheetCreate.setItemColor(0, -1, -1);
                bottomSheetCreate.setItemColor(1, -1, -1);
                bottomSheetCreate.setBackgroundColor(-14933463);
                bottomSheetCreate.setTitleColor(-7697782);
                bottomSheetCreate.setCalcMandatoryInsets(true);
                AndroidUtilities.setNavigationBarColor(bottomSheetCreate.getWindow(), -14933463, false);
                AndroidUtilities.setLightNavigationBar(bottomSheetCreate.getWindow(), false);
                bottomSheetCreate.scrollNavBar = true;
            }
            if (i >= 0 && (messageObject = this.currentMessageObject) != null && !messageObject.scheduled) {
                if (!messageObject.isVideo() && !this.currentMessageObject.isRoundVideo() && !this.currentMessageObject.isVoice() && !this.currentMessageObject.isMusic() && (messageObject2 = this.currentMessageObject.replyMessageObject) != null) {
                    messageObject = messageObject2;
                }
                long dialogId = messageObject.getDialogId();
                int id = messageObject.getId();
                TLRPC.MessageFwdHeader messageFwdHeader = messageObject.messageOwner.fwd_from;
                if (messageFwdHeader != null) {
                    TLRPC.Peer peer = messageFwdHeader.saved_from_peer;
                    if (peer != null) {
                        dialogId = MessageObject.getPeerId(peer);
                        id = messageObject.messageOwner.fwd_from.saved_from_msg_id;
                    } else {
                        TLRPC.Peer peer2 = messageFwdHeader.from_id;
                        if (peer2 != null) {
                            dialogId = MessageObject.getPeerId(peer2);
                            id = messageObject.messageOwner.fwd_from.channel_post;
                        }
                    }
                }
                if (DialogObject.isChatDialog(dialogId)) {
                    String publicUsername = ChatObject.getPublicUsername(MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(-dialogId)));
                    if (publicUsername != null) {
                        sb = new StringBuilder();
                        sb.append("https://t.me/");
                        sb.append(publicUsername);
                        sb.append("/");
                        sb.append(id);
                        sb.append("?t=");
                        sb.append(AndroidUtilities.formatTimestamp(i));
                        url = sb.toString();
                    }
                } else {
                    TLRPC.User user = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(dialogId));
                    String publicUsername2 = UserObject.getPublicUsername(user);
                    if (user != null && publicUsername2 != null) {
                        sb = new StringBuilder();
                        sb.append("https://t.me/");
                        sb.append(publicUsername2);
                        sb.append("/");
                        sb.append(id);
                        sb.append("?t=");
                        sb.append(AndroidUtilities.formatTimestamp(i));
                        url = sb.toString();
                    }
                }
                builder.setTitle(strSubstring);
                builder.setItems(new CharSequence[]{LocaleController.getString(R.string.Open), LocaleController.getString(R.string.CopyLink)}, new DialogInterface.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda157
                    @Override // android.content.DialogInterface.OnClickListener
                    public final void onClick(DialogInterface dialogInterface, int i2) {
                        this.f$0.lambda$onLinkLongPress$1(clickableSpan, textView, strSubstring, z, dialogInterface, i2);
                    }
                });
                builder.setOnPreDismissListener(new DialogInterface.OnDismissListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda158
                    @Override // android.content.DialogInterface.OnDismissListener
                    public final void onDismiss(DialogInterface dialogInterface) {
                        runnable.run();
                    }
                });
                BottomSheet bottomSheetCreate2 = builder.create();
                bottomSheetCreate2.scrollNavBar = true;
                bottomSheetCreate2.show();
                this.containerView.performHapticFeedback(0, 2);
                bottomSheetCreate2.setItemColor(0, -1, -1);
                bottomSheetCreate2.setItemColor(1, -1, -1);
                bottomSheetCreate2.setBackgroundColor(-14933463);
                bottomSheetCreate2.setTitleColor(-7697782);
                bottomSheetCreate2.setCalcMandatoryInsets(true);
                AndroidUtilities.setNavigationBarColor(bottomSheetCreate2.getWindow(), -14933463, false);
                AndroidUtilities.setLightNavigationBar(bottomSheetCreate2.getWindow(), false);
                bottomSheetCreate2.scrollNavBar = true;
            }
        }
        strSubstring = url;
        z = false;
        builder.setTitle(strSubstring);
        builder.setItems(new CharSequence[]{LocaleController.getString(R.string.Open), LocaleController.getString(R.string.CopyLink)}, new DialogInterface.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda157
            @Override // android.content.DialogInterface.OnClickListener
            public final void onClick(DialogInterface dialogInterface, int i2) {
                this.f$0.lambda$onLinkLongPress$1(clickableSpan, textView, strSubstring, z, dialogInterface, i2);
            }
        });
        builder.setOnPreDismissListener(new DialogInterface.OnDismissListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda158
            @Override // android.content.DialogInterface.OnDismissListener
            public final void onDismiss(DialogInterface dialogInterface) {
                runnable.run();
            }
        });
        BottomSheet bottomSheetCreate22 = builder.create();
        bottomSheetCreate22.scrollNavBar = true;
        bottomSheetCreate22.show();
        this.containerView.performHapticFeedback(0, 2);
        bottomSheetCreate22.setItemColor(0, -1, -1);
        bottomSheetCreate22.setItemColor(1, -1, -1);
        bottomSheetCreate22.setBackgroundColor(-14933463);
        bottomSheetCreate22.setTitleColor(-7697782);
        bottomSheetCreate22.setCalcMandatoryInsets(true);
        AndroidUtilities.setNavigationBarColor(bottomSheetCreate22.getWindow(), -14933463, false);
        AndroidUtilities.setLightNavigationBar(bottomSheetCreate22.getWindow(), false);
        bottomSheetCreate22.scrollNavBar = true;
    }

    private void onPhotoClosed(final PlaceProviderObject placeProviderObject) {
        if (this.doneButtonPressed) {
            releasePlayer(true);
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && !messageObject.putInDownloadsStore) {
            FileLoader.getInstance(this.currentAccount).cancelLoadFile(this.currentMessageObject.getDocument());
        }
        this.isVisible = false;
        this.isVisibleOrAnimating = false;
        this.cropInitied = false;
        this.disableShowCheck = true;
        this.currentMessageObject = null;
        this.currentBotInlineResult = null;
        this.currentFileLocation = null;
        this.currentFileLocationVideo = null;
        this.currentSecureDocument = null;
        this.currentPageBlock = null;
        this.currentPathObject = null;
        this.dialogPhotos = null;
        VideoAds videoAds = this.ads;
        if (videoAds != null) {
            videoAds.stop();
            this.ads = null;
        }
        if (this.videoPlayerControlFrameLayout != null) {
            setVideoPlayerControlVisible(false, false);
        }
        CaptionScrollView captionScrollView = this.captionScrollView;
        if (captionScrollView != null) {
            captionScrollView.reset();
        }
        this.sendPhotoType = 0;
        this.isDocumentsPicker = false;
        ImageReceiver.BitmapHolder bitmapHolder = this.currentThumb;
        if (bitmapHolder != null) {
            bitmapHolder.release();
            this.currentThumb = null;
        }
        this.parentAlert = null;
        AnimatedFileDrawable animatedFileDrawable = this.currentAnimation;
        if (animatedFileDrawable != null) {
            animatedFileDrawable.removeSecondParentView(this.containerView);
            this.currentAnimation = null;
        }
        for (int i = 0; i < 3; i++) {
            PhotoProgressView photoProgressView = this.photoProgressViews[i];
            if (photoProgressView != null) {
                photoProgressView.setBackgroundState(-1, false, true);
            }
        }
        requestVideoPreview(0);
        VideoTimelinePlayView videoTimelinePlayView = this.videoTimelineView;
        if (videoTimelinePlayView != null) {
            videoTimelinePlayView.destroy();
        }
        this.hintView.hide(false, 0);
        this.centerImage.setImageBitmap((Bitmap) null);
        this.centerBlur.destroy();
        this.leftImage.setImageBitmap((Bitmap) null);
        this.leftBlur.destroy();
        this.rightImage.setImageBitmap((Bitmap) null);
        this.rightBlur.destroy();
        this.containerView.post(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda117
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$onPhotoClosed$140(placeProviderObject);
            }
        });
        PhotoViewerProvider photoViewerProvider = this.placeProvider;
        if (photoViewerProvider != null) {
            photoViewerProvider.willHidePhotoViewer();
        }
        this.groupedPhotosListView.clear();
        PhotoViewerProvider photoViewerProvider2 = this.placeProvider;
        if (photoViewerProvider2 != null) {
            photoViewerProvider2.onClose();
        }
        this.placeProvider = null;
        this.selectedPhotosAdapter.notifyDataSetChanged();
        this.pageBlocksAdapter = null;
        this.disableShowCheck = false;
        this.shownControlsByEnd = false;
        this.videoCutStart = BitmapDescriptorFactory.HUE_RED;
        this.videoCutEnd = 1.0f;
        if (placeProviderObject != null) {
            placeProviderObject.imageReceiver.setVisible(true, true);
        }
        ChatActivity chatActivity = this.parentChatActivity;
        if (chatActivity != null) {
            chatActivity.getFragmentView().invalidate();
        }
        Bitmap bitmap = this.videoFrameBitmap;
        if (bitmap != null) {
            bitmap.recycle();
            this.videoFrameBitmap = null;
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:156:0x046f  */
    /* JADX WARN: Removed duplicated region for block: B:203:0x053d  */
    /* JADX WARN: Removed duplicated region for block: B:435:0x0972  */
    /* JADX WARN: Removed duplicated region for block: B:442:0x0986  */
    /* JADX WARN: Removed duplicated region for block: B:493:0x0a97  */
    /* JADX WARN: Removed duplicated region for block: B:500:0x0acb  */
    /* JADX WARN: Removed duplicated region for block: B:504:0x0ad4  */
    /* JADX WARN: Removed duplicated region for block: B:518:0x0b03  */
    /* JADX WARN: Removed duplicated region for block: B:523:0x0b1f  */
    /* JADX WARN: Removed duplicated region for block: B:551:0x0b6b  */
    /* JADX WARN: Removed duplicated region for block: B:561:0x0b8b  */
    /* JADX WARN: Removed duplicated region for block: B:562:0x0b90  */
    /* JADX WARN: Removed duplicated region for block: B:566:0x0ba1 A[Catch: Exception -> 0x0bad, TryCatch #0 {Exception -> 0x0bad, blocks: (B:564:0x0b94, B:566:0x0ba1, B:569:0x0baf, B:571:0x0bb3), top: B:575:0x0b94 }] */
    /* JADX WARN: Removed duplicated region for block: B:571:0x0bb3 A[Catch: Exception -> 0x0bad, TRY_LEAVE, TryCatch #0 {Exception -> 0x0bad, blocks: (B:564:0x0b94, B:566:0x0ba1, B:569:0x0baf, B:571:0x0bb3), top: B:575:0x0b94 }] */
    /* JADX WARN: Removed duplicated region for block: B:592:? A[RETURN, SYNTHETIC] */
    /* JADX WARN: Type inference failed for: r11v19 */
    /* JADX WARN: Type inference failed for: r11v2 */
    /* JADX WARN: Type inference failed for: r11v3, types: [android.animation.AnimatorSet, java.lang.String] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void onPhotoShow(MessageObject messageObject, TLRPC.FileLocation fileLocation, ImageLocation imageLocation, ImageLocation imageLocation2, ArrayList arrayList, ArrayList arrayList2, List list, int i, PlaceProviderObject placeProviderObject) throws Resources.NotFoundException {
        ?? r11;
        boolean z;
        int i2;
        ImageView imageView;
        MentionsContainerView mentionsContainerView;
        MentionsContainerView mentionsContainerView2;
        PhotoViewerProvider photoViewerProvider;
        ChatActivity chatActivity;
        ActionBarMenuSubItem actionBarMenuSubItem;
        String string;
        ImageLocation forUserOrChat;
        int i3;
        TLObject chat;
        ImageView imageView2;
        MessageObject messageObject2;
        TLRPC.BotInlineResult botInlineResult;
        PageBlocksAdapter pageBlocksAdapter;
        ChatActivity chatActivity2;
        VideoPlayer videoPlayer;
        MessageObject messageObject3;
        PhotoViewerProvider photoViewerProvider2;
        ChatActivity chatActivity3;
        boolean z2;
        ActionBarMenuSubItem actionBarMenuSubItem2;
        String string2;
        TLRPC.MessageAction messageAction;
        int i4;
        PhotoViewerWebView photoViewerWebView;
        TLRPC.WebPage webPage;
        String str;
        TLRPC.Message message;
        this.classGuid = ConnectionsManager.generateClassGuid();
        this.customTitle = null;
        this.currentMessageObject = null;
        this.currentFileLocation = null;
        this.currentFileLocationVideo = null;
        this.currentSecureDocument = null;
        this.currentPathObject = null;
        this.currentPageBlock = null;
        this.fromCamera = false;
        this.currentBotInlineResult = null;
        this.avatarStartProgress = BitmapDescriptorFactory.HUE_RED;
        this.avatarStartTime = 0L;
        this.currentIndex = -1;
        String[] strArr = this.currentFileNames;
        strArr[0] = null;
        strArr[1] = null;
        strArr[2] = null;
        this.avatarsDialogId = 0L;
        this.canEditAvatar = false;
        this.totalImagesCount = 0;
        this.totalImagesCountMerge = 0;
        this.currentEditMode = 0;
        getCaptionView().keyboardNotifier.ignore(this.currentEditMode != 0);
        KeyboardNotifier keyboardNotifier = this.paintKeyboardNotifier;
        if (keyboardNotifier != null) {
            keyboardNotifier.ignore(this.currentEditMode != 3);
        }
        this.isFirstLoading = true;
        this.needSearchImageInArr = false;
        this.loadingMoreImages = false;
        boolean[] zArr = this.endReached;
        zArr[0] = false;
        zArr[1] = this.mergeDialogId == 0;
        this.opennedFromMedia = false;
        this.openedFromProfile = false;
        this.needCaptionLayout = false;
        this.containerView.setTag(1);
        this.playerAutoStarted = false;
        this.isCurrentVideo = false;
        this.shownControlsByEnd = false;
        this.imagesArr.clear();
        this.imagesArrLocations.clear();
        this.imagesArrLocationsSizes.clear();
        this.imagesArrLocationsVideo.clear();
        this.imagesArrMessages.clear();
        this.avatarsArr.clear();
        this.secureDocuments.clear();
        this.imagesArrLocals.clear();
        VideoAds videoAds = this.ads;
        if (videoAds != null) {
            videoAds.stop();
            this.ads = null;
        }
        BlurringShader.BlurManager blurManager = this.blurManager;
        if (blurManager != null) {
            blurManager.resetBitmap();
        }
        if (Build.VERSION.SDK_INT > 21) {
            this.actionBar.setElevation(BitmapDescriptorFactory.HUE_RED);
        }
        for (int i5 = 0; i5 < 2; i5++) {
            this.imagesByIds[i5].clear();
            this.imagesByIdsTemp[i5].clear();
        }
        this.imagesArrTemp.clear();
        this.currentAvatarLocation = null;
        this.containerView.setPadding(0, 0, 0, 0);
        ImageReceiver.BitmapHolder bitmapHolder = this.currentThumb;
        if (bitmapHolder != null) {
            bitmapHolder.release();
        }
        this.currentThumb = placeProviderObject != null ? placeProviderObject.thumb : null;
        this.isEvent = placeProviderObject != null && placeProviderObject.isEvent;
        this.sharedMediaType = 0;
        this.allMediaItem.setText(LocaleController.getString("ShowAllMedia", R.string.ShowAllMedia));
        setItemVisible(this.sendItem, false, false);
        setItemVisible(this.pipItem, false, true);
        PhotoCropView photoCropView = this.photoCropView;
        if (photoCropView != null) {
            photoCropView.setSubtitle(null);
        }
        this.actionBar.setBackgroundColor(2130706432);
        int i6 = 8;
        this.bottomLayout.setVisibility(8);
        this.bottomLayout.setTag(0);
        PhotoCountView photoCountView = this.countView;
        if (photoCountView != null) {
            photoCountView.updateShow(false, false);
        }
        if (this.sendPhotoType != 11 && this.stickerMakerView != null) {
            this.stickerEmpty = false;
            ImageView imageView3 = this.tuneItem;
            if (imageView3 != null) {
                imageView3.setAlpha(1.0f);
            }
            BlurButton blurButton = this.outlineBtn;
            if (blurButton != null) {
                blurButton.setActive(false, false);
            }
            this.stickerMakerView.clean();
            ArrayList arrayList3 = this.selectedEmojis;
            if (arrayList3 != null) {
                arrayList3.clear();
            }
        }
        this.bottomLayout.setTranslationY(BitmapDescriptorFactory.HUE_RED);
        this.captionTextViewSwitcher.setTranslationY(BitmapDescriptorFactory.HUE_RED);
        setItemVisible(this.editItem, false, false);
        QualityChooseView qualityChooseView = this.qualityChooseView;
        if (qualityChooseView != null) {
            qualityChooseView.setVisibility(4);
            this.qualityPicker.setVisibility(4);
            r11 = 0;
            this.qualityChooseView.setTag(null);
        } else {
            r11 = 0;
        }
        AnimatorSet animatorSet = this.qualityChooseViewAnimation;
        if (animatorSet != null) {
            animatorSet.cancel();
            this.qualityChooseViewAnimation = r11;
        }
        setDoubleTapEnabled(true);
        this.allowShare = false;
        this.slideshowMessageId = 0;
        this.nameOverride = r11;
        this.dateOverride = 0;
        this.menuItem.hideSubItem(3);
        this.menuItem.hideSubItem(5);
        this.menuItem.hideSubItem(21);
        this.menuItem.hideSubItem(23);
        this.menuItem.hideSubItem(9);
        this.menuItem.hideSubItem(10);
        this.menuItem.hideSubItem(12);
        this.menuItem.hideSubItem(13);
        this.menuItem.hideSubItem(15);
        this.menuItem.hideSubItem(14);
        this.menuItem.hideSubItem(7);
        this.speedItem.setVisibility(8);
        this.speedGap.setVisibility(8);
        this.videoItem.setVisibility(8);
        this.actionBar.setTranslationY(BitmapDescriptorFactory.HUE_RED);
        this.dialogPhotos = null;
        this.checkImageView.setAlpha(1.0f);
        this.checkImageView.setTranslationY(BitmapDescriptorFactory.HUE_RED);
        this.checkImageView.setVisibility(8);
        this.actionBar.setTitleRightMargin(0);
        this.photosCounterView.setAlpha(1.0f);
        this.photosCounterView.setTranslationY(BitmapDescriptorFactory.HUE_RED);
        this.photosCounterView.setVisibility(8);
        updateActionBarTitlePadding();
        this.pickerView.setVisibility(8);
        this.pickerViewSendButton.setVisibility(8);
        this.doneButtonFullWidth.setVisibility(8);
        this.pickerViewSendButton.setTranslationY(BitmapDescriptorFactory.HUE_RED);
        this.pickerView.setAlpha(1.0f);
        this.pickerViewSendButton.setAlpha(1.0f);
        this.pickerView.setTranslationY(BitmapDescriptorFactory.HUE_RED);
        this.paintItem.setVisibility(8);
        this.paintItem.setTag(null);
        this.cropItem.setVisibility(8);
        this.tuneItem.setVisibility(8);
        this.tuneItem.setTag(null);
        this.captionEdit.setTimerVisible(false, false);
        this.captionEdit.setShowMoveButtonVisible(false, false);
        this.topCaptionEdit.setTimerVisible(false, false);
        this.rotateItem.setVisibility(8);
        this.mirrorItem.setVisibility(8);
        this.pickerView.getLayoutParams().height = -2;
        this.docInfoTextView.setVisibility(8);
        this.docNameTextView.setVisibility(8);
        showVideoTimeline(false, false);
        showEditCaption(false, false);
        showStickerMode(false, false);
        this.videoAvatarTooltip.setVisibility(8);
        this.compressItem.setVisibility(8);
        AndroidUtilities.updateViewVisibilityAnimated(this.muteButton, false, 1.0f, false);
        AndroidUtilities.updateViewVisibilityAnimated(this.editCoverButton, false, 1.0f, false);
        this.actionBarContainer.setSubtitle(null);
        setItemVisible(this.masksItem, false, true);
        this.muteVideo = false;
        this.muteDrawable.setMuted(false, false);
        this.editorDoneLayout.setVisibility(8);
        this.captionTextViewSwitcher.setTag(null);
        this.captionTextViewSwitcher.setVisibility(4);
        PhotoCropView photoCropView2 = this.photoCropView;
        if (photoCropView2 != null) {
            photoCropView2.setVisibility(8);
        }
        PhotoFilterView photoFilterView = this.photoFilterView;
        if (photoFilterView != null) {
            photoFilterView.setVisibility(8);
        }
        for (int i7 = 0; i7 < 3; i7++) {
            PhotoProgressView photoProgressView = this.photoProgressViews[i7];
            if (photoProgressView != null) {
                photoProgressView.setBackgroundState(-1, false, true);
            }
        }
        GroupedPhotosListView groupedPhotosListView = this.groupedPhotosListView;
        if (groupedPhotosListView != null) {
            groupedPhotosListView.reset();
            this.groupedPhotosListView.setAnimateBackground(!ApplicationLoader.isNetworkOnline());
        }
        PhotoViewerProvider photoViewerProvider3 = this.placeProvider;
        if (photoViewerProvider3 != null && photoViewerProvider3.getTotalImageCount() > 0) {
            this.totalImagesCount = this.placeProvider.getTotalImageCount();
        }
        if (messageObject != null) {
            this.currentVideoSpeed = ApplicationLoader.applicationContext.getSharedPreferences("playback_speed", 0).getFloat("speed" + messageObject.getDialogId() + "_" + messageObject.getId(), 1.0f);
        } else {
            this.currentVideoSpeed = 1.0f;
        }
        setMenuItemIcon(false, true);
        boolean z3 = messageObject != null && (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId()) || (((message = messageObject.messageOwner) != null && message.noforwards) || messageObject.hasRevealedExtendedMedia()));
        try {
            if (messageObject != null && arrayList == null) {
                TLRPC.Message message2 = messageObject.messageOwner;
                if (message2 != null && (MessageObject.getMedia(message2) instanceof TLRPC.TL_messageMediaWebPage) && MessageObject.getMedia(messageObject.messageOwner).webpage != null && (str = (webPage = MessageObject.getMedia(messageObject.messageOwner).webpage).site_name) != null) {
                    String lowerCase = str.toLowerCase();
                    if (lowerCase.equals("instagram") || lowerCase.equals("twitter") || "telegram_album".equals(webPage.type)) {
                        if (!TextUtils.isEmpty(webPage.author)) {
                            this.nameOverride = webPage.author;
                        }
                        if (webPage.cached_page instanceof TLRPC.TL_page) {
                            int i8 = 0;
                            while (true) {
                                if (i8 >= webPage.cached_page.blocks.size()) {
                                    break;
                                }
                                TLRPC.PageBlock pageBlock = (TLRPC.PageBlock) webPage.cached_page.blocks.get(i8);
                                if (pageBlock instanceof TLRPC.TL_pageBlockAuthorDate) {
                                    this.dateOverride = ((TLRPC.TL_pageBlockAuthorDate) pageBlock).published_date;
                                    break;
                                }
                                i8++;
                            }
                        }
                        ArrayList<MessageObject> webPagePhotos = messageObject.getWebPagePhotos(null, null);
                        if (!webPagePhotos.isEmpty()) {
                            this.slideshowMessageId = messageObject.getId();
                            this.needSearchImageInArr = false;
                            this.imagesArr.addAll(webPagePhotos);
                            this.totalImagesCount = this.imagesArr.size();
                            int iIndexOf = this.imagesArr.indexOf(messageObject);
                            if (iIndexOf < 0) {
                                iIndexOf = 0;
                            }
                            setImageIndex(iIndexOf);
                        }
                    }
                }
                if (messageObject.canPreviewDocument()) {
                    this.sharedMediaType = 1;
                    actionBarMenuSubItem2 = this.allMediaItem;
                    string2 = LocaleController.getString("ShowAllFiles", R.string.ShowAllFiles);
                } else {
                    if (messageObject.isGif()) {
                        this.sharedMediaType = 5;
                        actionBarMenuSubItem2 = this.allMediaItem;
                        string2 = LocaleController.getString("ShowAllGIFs", R.string.ShowAllGIFs);
                    }
                    if (this.isEmbedVideo && ((photoViewerWebView = this.photoViewerWebView) == null || !photoViewerWebView.isControllable())) {
                        this.bottomLayout.setTag(null);
                        this.bottomLayout.setVisibility(8);
                    }
                    if (this.slideshowMessageId == 0) {
                        this.imagesArr.add(messageObject);
                        int i9 = 0;
                        if (messageObject.eventId != 0) {
                            this.needSearchImageInArr = false;
                        } else if (this.currentAnimation != null) {
                            this.needSearchImageInArr = false;
                            if (!messageObject.canForwardMessage() || z3) {
                                i9 = 0;
                            } else {
                                i9 = 0;
                                setItemVisible(this.sendItem, true, false);
                            }
                        } else {
                            if (!messageObject.scheduled && !messageObject.isQuickReply() && !messageObject.isSponsored() && !(MessageObject.getMedia(messageObject.messageOwner) instanceof TLRPC.TL_messageMediaInvoice) && !(MessageObject.getMedia(messageObject.messageOwner) instanceof TLRPC.TL_messageMediaWebPage) && ((messageAction = messageObject.messageOwner.action) == null || (messageAction instanceof TLRPC.TL_messageActionEmpty))) {
                                this.needSearchImageInArr = true;
                                this.imagesByIds[0].put(messageObject.getId(), messageObject);
                                ChatActivity chatActivity4 = this.parentChatActivity;
                                if (chatActivity4 != null) {
                                    if (!chatActivity4.isThreadChat() && this.parentChatActivity.getChatMode() != 3) {
                                        i4 = 5;
                                        if (this.parentChatActivity.getChatMode() != 5) {
                                        }
                                    }
                                    setItemVisible(this.sendItem, !z3, false);
                                } else {
                                    i4 = 5;
                                }
                                this.menuItem.showSubItem(i4);
                                long dialogId = messageObject.getDialogId();
                                if (dialogId < 0 ? ChatObject.canWriteToChat(MessagesController.getInstance(messageObject.currentAccount).getChat(Long.valueOf(-dialogId))) : true) {
                                    this.menuItem.showSubItem(21);
                                } else {
                                    this.menuItem.hideSubItem(21);
                                }
                                this.menuItem.showSubItem(3);
                                setItemVisible(this.sendItem, !z3, false);
                            } else if (!this.isEmbedVideo || messageObject.eventId != 0) {
                            }
                            i9 = 0;
                        }
                        setImageIndex(i9);
                    }
                }
                actionBarMenuSubItem2.setText(string2);
                if (this.isEmbedVideo) {
                    this.bottomLayout.setTag(null);
                    this.bottomLayout.setVisibility(8);
                }
                if (this.slideshowMessageId == 0) {
                }
            } else if (arrayList2 != null) {
                this.secureDocuments.addAll(arrayList2);
                setImageIndex(i);
            } else if (fileLocation != null) {
                long j = placeProviderObject != null ? placeProviderObject.dialogId : 0L;
                this.avatarsDialogId = j;
                this.canEditAvatar = placeProviderObject != null && placeProviderObject.canEdit;
                if (imageLocation != null || j == 0) {
                    forUserOrChat = imageLocation;
                } else {
                    if (j > 0) {
                        chat = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(this.avatarsDialogId));
                        i3 = 0;
                    } else {
                        i3 = 0;
                        chat = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(-this.avatarsDialogId));
                    }
                    forUserOrChat = ImageLocation.getForUserOrChat(chat, i3);
                }
                if (forUserOrChat == null) {
                    return;
                }
                this.imagesArrLocations.add(forUserOrChat);
                this.imagesArrLocationsVideo.add(imageLocation2 != null ? imageLocation2 : forUserOrChat);
                this.currentAvatarLocation = forUserOrChat;
                this.imagesArrLocationsSizes.add(Long.valueOf(placeProviderObject != null ? placeProviderObject.size : 0L));
                this.imagesArrMessages.add(null);
                this.avatarsArr.add(new TLRPC.TL_photoEmpty());
                this.allowShare = true;
                this.menuItem.hideSubItem(3);
                this.menuItem.showSubItem(9);
                setImageIndex(0);
                if (this.sendPhotoType == 1) {
                    (useFullWidthSendButton() ? this.doneButtonFullWidth : this.pickerViewSendButton).setVisibility(0);
                    this.pickerViewSendButton.setTranslationY(BitmapDescriptorFactory.HUE_RED);
                    this.pickerViewSendButton.setAlpha(1.0f);
                    View view = this.navigationBar;
                    if (view != null) {
                        view.setVisibility(0);
                        this.navigationBar.setAlpha(1.0f);
                    }
                    this.bottomLayout.setVisibility(8);
                    this.bottomLayout.setTag(null);
                    this.containerView.setTag(null);
                }
            } else {
                if (arrayList != null) {
                    this.imagesArr.addAll(arrayList);
                    for (int i10 = 0; i10 < this.imagesArr.size(); i10++) {
                        MessageObject messageObject4 = (MessageObject) this.imagesArr.get(i10);
                        this.imagesByIds[messageObject4.getDialogId() == this.currentDialogId ? (char) 0 : (char) 1].put(messageObject4.getId(), messageObject4);
                    }
                    MessageObject messageObject5 = (MessageObject) this.imagesArr.get(i);
                    if (messageObject5.scheduled || messageObject5.isQuickReply() || messageObject5.isSponsored() || ((chatActivity = this.parentChatActivity) != null && chatActivity.isThreadChat())) {
                        this.totalImagesCount = this.imagesArr.size();
                    } else {
                        this.opennedFromMedia = this.parentChatActivity == null;
                        if (this.parentFragment instanceof ProfileActivity) {
                            this.openedFromProfile = true;
                        }
                        if (placeProviderObject != null) {
                            this.startOffset = placeProviderObject.starOffset;
                        }
                        this.menuItem.showSubItem(5);
                        long dialogId2 = messageObject5.getDialogId();
                        if (dialogId2 < 0 ? ChatObject.canWriteToChat(MessagesController.getInstance(messageObject5.currentAccount).getChat(Long.valueOf(-dialogId2))) : true) {
                            this.menuItem.showSubItem(21);
                        } else {
                            this.menuItem.hideSubItem(21);
                        }
                        if (messageObject5.canForwardMessage() && !z3) {
                            setItemVisible(this.sendItem, true, false);
                        }
                        if (messageObject5.canPreviewDocument()) {
                            this.sharedMediaType = 1;
                            actionBarMenuSubItem = this.allMediaItem;
                            string = LocaleController.getString("ShowAllFiles", R.string.ShowAllFiles);
                        } else if (messageObject5.isGif()) {
                            this.sharedMediaType = 5;
                            actionBarMenuSubItem = this.allMediaItem;
                            string = LocaleController.getString("ShowAllGIFs", R.string.ShowAllGIFs);
                        }
                        actionBarMenuSubItem.setText(string);
                    }
                } else {
                    if (list != null) {
                        int i11 = this.sendPhotoType;
                        if (i11 != -1 && (i11 == 0 || i11 == 4 || ((i11 == 2 || i11 == 5) && list.size() > 1))) {
                            this.checkImageView.setVisibility(0);
                            this.photosCounterView.setVisibility(0);
                            updateActionBarTitlePadding();
                        }
                        CaptionPhotoViewer captionPhotoViewer = this.captionEdit;
                        int i12 = this.sendPhotoType;
                        captionPhotoViewer.setAddPhotoVisible(i12 != -1 && (i12 == 2 || i12 == 5) && this.placeProvider.canCaptureMorePhotos(), false);
                        CaptionPhotoViewer captionPhotoViewer2 = this.topCaptionEdit;
                        int i13 = this.sendPhotoType;
                        captionPhotoViewer2.setAddPhotoVisible(i13 != -1 && (i13 == 2 || i13 == 5) && this.placeProvider.canCaptureMorePhotos(), false);
                        this.menuItem.setVisibility(8);
                        this.imagesArrLocals.addAll(list);
                        Object obj = this.imagesArrLocals.get(i);
                        int i14 = this.sendPhotoType;
                        if (i14 == -1 || !(obj instanceof MediaController.PhotoEntry)) {
                            if (obj instanceof TLRPC.BotInlineResult) {
                                this.cropItem.setVisibility(8);
                                this.rotateItem.setVisibility(8);
                                this.mirrorItem.setVisibility(8);
                            } else {
                                this.cropItem.setVisibility(((obj instanceof MediaController.SearchImage) && ((MediaController.SearchImage) obj).type == 0) ? 0 : 8);
                                this.rotateItem.setVisibility(8);
                                this.mirrorItem.setVisibility(8);
                                if (this.cropItem.getVisibility() == 0) {
                                    z = true;
                                }
                            }
                            z = false;
                        } else {
                            if (i14 == 10) {
                                this.cropItem.setVisibility(8);
                                this.rotateItem.setVisibility(8);
                                this.mirrorItem.setVisibility(8);
                            } else if (this.isDocumentsPicker) {
                                this.cropItem.setVisibility(8);
                                this.rotateItem.setVisibility(8);
                                this.mirrorItem.setVisibility(8);
                                this.docInfoTextView.setVisibility(0);
                                this.docNameTextView.setVisibility(0);
                                this.pickerView.getLayoutParams().height = AndroidUtilities.dp(84.0f);
                            } else if (((MediaController.PhotoEntry) obj).isVideo) {
                                this.cropItem.setVisibility(8);
                                this.rotateItem.setVisibility(8);
                                this.mirrorItem.setVisibility(8);
                                this.bottomLayout.setVisibility(0);
                                this.bottomLayout.setTag(1);
                                this.bottomLayout.setTranslationY(-AndroidUtilities.dp(48.0f));
                            } else {
                                this.cropItem.setVisibility(i14 != 1 ? 0 : 8);
                                this.rotateItem.setVisibility(this.sendPhotoType != 1 ? 8 : 0);
                                this.mirrorItem.setVisibility(this.sendPhotoType != 1 ? 8 : 0);
                            }
                            z = !this.isDocumentsPicker;
                        }
                        this.needCaptionLayout = z && ((photoViewerProvider = this.placeProvider) == null || photoViewerProvider.allowCaption());
                        if (this.parentChatActivity != null && (mentionsContainerView2 = this.captionEdit.mentionContainer) != null) {
                            mentionsContainerView2.getAdapter().setChatInfo(this.parentChatActivity.chatInfo);
                            this.captionEdit.mentionContainer.getAdapter().setNeedUsernames(this.parentChatActivity.currentChat != null);
                            this.captionEdit.mentionContainer.getAdapter().setNeedBotContext(false);
                        }
                        if (this.parentChatActivity == null || (mentionsContainerView = this.topCaptionEdit.mentionContainer) == null) {
                            i2 = 0;
                        } else {
                            mentionsContainerView.getAdapter().setChatInfo(this.parentChatActivity.chatInfo);
                            this.topCaptionEdit.mentionContainer.getAdapter().setNeedUsernames(this.parentChatActivity.currentChat != null);
                            i2 = 0;
                            this.topCaptionEdit.mentionContainer.getAdapter().setNeedBotContext(false);
                        }
                        if (this.sendPhotoType != -1) {
                            this.pickerView.setVisibility(i2);
                            if (useFullWidthSendButton()) {
                                this.doneButtonFullWidth.setVisibility(i2);
                            } else {
                                this.pickerViewSendButton.setVisibility(i2);
                                this.pickerViewSendButton.setTranslationY(BitmapDescriptorFactory.HUE_RED);
                                this.pickerViewSendButton.setAlpha(1.0f);
                            }
                            View view2 = this.navigationBar;
                            if (view2 != null && (!this.fancyShadows || this.sendPhotoType == 11)) {
                                view2.setVisibility(0);
                                this.navigationBar.setAlpha(1.0f);
                            }
                            this.bottomLayout.setVisibility(8);
                            this.bottomLayout.setTag(null);
                            this.containerView.setTag(null);
                        }
                        setImageIndex(i);
                        int i15 = this.sendPhotoType;
                        if (i15 == 1) {
                            this.paintItem.setVisibility(0);
                            this.tuneItem.setVisibility(0);
                        } else {
                            if (i15 == 4 || i15 == 5) {
                                this.paintItem.setVisibility(8);
                                imageView = this.tuneItem;
                            } else {
                                ImageView imageView4 = this.paintItem;
                                imageView4.setVisibility(imageView4.getTag() != null ? 0 : 8);
                                imageView = this.tuneItem;
                                if (imageView.getTag() != null) {
                                    i6 = 0;
                                }
                            }
                            imageView.setVisibility(i6);
                        }
                        updateSelectedCount();
                    }
                    imageView2 = this.tuneItem;
                    if (imageView2 != null) {
                        imageView2.setAlpha(this.stickerEmpty ? 0.4f : 1.0f);
                    }
                    this.dialogPhotos = null;
                    if (this.currentAnimation == null && !this.isEvent) {
                        if (this.currentDialogId != 0 || this.totalImagesCount != 0 || (messageObject3 = this.currentMessageObject) == null || messageObject3.scheduled) {
                            if (this.avatarsDialogId != 0 && this.placeProvider.canLoadMoreAvatars()) {
                                this.dialogPhotos = MessagesController.getInstance(this.currentAccount).getDialogPhotos(this.avatarsDialogId);
                                NotificationCenter.getInstance(this.currentAccount).lambda$postNotificationNameOnUIThread$1(NotificationCenter.dialogPhotosUpdate, this.dialogPhotos);
                            }
                        } else if (this.currentFiltered && (chatActivity3 = this.parentChatActivity) != null) {
                            ArrayList filteredMessages = chatActivity3.getFilteredMessages();
                            if (filteredMessages != null) {
                                this.imagesArr.clear();
                                for (int i16 = 0; i16 < filteredMessages.size(); i16++) {
                                    MessageObject messageObject6 = (MessageObject) filteredMessages.get(i16);
                                    if (MediaDataController.getMediaType(messageObject6.messageOwner) == this.sharedMediaType) {
                                        this.imagesArr.add(messageObject6);
                                        this.imagesByIds[0].put(messageObject6.getId(), messageObject6);
                                    }
                                }
                                Collections.sort(this.imagesArr, new Comparator() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda5
                                    @Override // java.util.Comparator
                                    public final int compare(Object obj2, Object obj3) {
                                        return PhotoViewer.lambda$onPhotoShow$119((MessageObject) obj2, (MessageObject) obj3);
                                    }
                                });
                                this.currentIndex = -1;
                                for (int i17 = 0; i17 < this.imagesArr.size(); i17++) {
                                    if (this.imagesArr.get(i17) == this.currentMessageObject || ((MessageObject) this.imagesArr.get(i17)).getId() == this.currentMessageObject.getId()) {
                                        this.currentIndex = i17;
                                    }
                                }
                                if (this.currentIndex < 0) {
                                    this.currentIndex = this.imagesArr.size();
                                    this.imagesArr.add(this.currentMessageObject);
                                    z2 = false;
                                    this.imagesByIds[0].put(this.currentMessageObject.getId(), this.currentMessageObject);
                                } else {
                                    z2 = false;
                                }
                                setImages();
                                PhotoCountView photoCountView2 = this.countView;
                                if (photoCountView2 != null) {
                                    photoCountView2.updateShow(true, z2);
                                    this.countView.set(this.currentIndex + 1, this.imagesArr.size(), z2);
                                }
                            } else {
                                z2 = false;
                            }
                            this.isFirstLoading = z2;
                        } else if (MediaDataController.getMediaType(messageObject3.messageOwner) == this.sharedMediaType && ((photoViewerProvider2 = this.placeProvider) == null || !photoViewerProvider2.forceAllInGroup())) {
                            MediaDataController.getInstance(this.currentAccount).getMediaCount(this.currentDialogId, this.topicId, this.sharedMediaType, this.classGuid, true);
                            if (this.mergeDialogId != 0) {
                                MediaDataController.getInstance(this.currentAccount).getMediaCount(this.mergeDialogId, this.topicId, this.sharedMediaType, this.classGuid, true);
                            }
                        }
                    }
                    messageObject2 = this.currentMessageObject;
                    if ((messageObject2 == null || !messageObject2.isVideo()) && (((botInlineResult = this.currentBotInlineResult) == null || (!botInlineResult.type.equals(MediaStreamTrack.VIDEO_TRACK_KIND) && !MessageObject.isVideoDocument(this.currentBotInlineResult.document))) && ((pageBlocksAdapter = this.pageBlocksAdapter) == null || (!pageBlocksAdapter.isVideo(i) && !this.pageBlocksAdapter.isHardwarePlayer(i))))) {
                        if (this.sendPhotoType == -1 || !((MediaController.PhotoEntry) this.imagesArrLocals.get(i)).isVideo) {
                            if (!this.imagesArrLocals.isEmpty()) {
                                Object obj2 = this.imagesArrLocals.get(i);
                                ChatActivity chatActivity5 = this.parentChatActivity;
                                TLRPC.User currentUser = chatActivity5 != null ? chatActivity5.getCurrentUser() : null;
                                boolean z4 = (this.isDocumentsPicker || (chatActivity2 = this.parentChatActivity) == null || chatActivity2.isSecretChat() || this.parentChatActivity.isInScheduleMode() || currentUser == null || currentUser.bot || UserObject.isUserSelf(currentUser) || this.parentChatActivity.isEditingMessageMedia()) ? false : true;
                                PhotoViewerProvider photoViewerProvider4 = this.placeProvider;
                                if (photoViewerProvider4 != null && photoViewerProvider4.getEditingMessageObject() != null) {
                                    z4 = false;
                                }
                                if (!(obj2 instanceof TLRPC.BotInlineResult)) {
                                    if (z4 && (obj2 instanceof MediaController.SearchImage)) {
                                        z4 = ((MediaController.SearchImage) obj2).type == 0;
                                    }
                                    this.captionEdit.setTimerVisible(z4, true);
                                    this.topCaptionEdit.setTimerVisible(z4, true);
                                }
                            }
                        }
                        checkFullscreenButton();
                        VideoPlayer videoPlayer2 = this.videoPlayer;
                        this.lastQualityIndexSelected = videoPlayer2 == null ? videoPlayer2.getCurrentQualityIndex() : -1;
                        CastSync.check(0);
                        if (ChromecastController.getInstance().isCasting()) {
                            ChromecastController.getInstance().setCurrentMediaAndCastIfNeeded(getCurrentChromecastMedia());
                        }
                        videoPlayer = this.videoPlayer;
                        if (videoPlayer == null) {
                            CastSync.setPlaying(videoPlayer.isPlaying());
                            return;
                        }
                        return;
                    }
                    this.playerAutoStarted = true;
                    onActionClick(false);
                    checkFullscreenButton();
                    VideoPlayer videoPlayer22 = this.videoPlayer;
                    this.lastQualityIndexSelected = videoPlayer22 == null ? videoPlayer22.getCurrentQualityIndex() : -1;
                    CastSync.check(0);
                    if (ChromecastController.getInstance().isCasting()) {
                    }
                    videoPlayer = this.videoPlayer;
                    if (videoPlayer == null) {
                    }
                }
                setImageIndex(i);
                imageView2 = this.tuneItem;
                if (imageView2 != null) {
                }
                this.dialogPhotos = null;
                if (this.currentAnimation == null) {
                    if (this.currentDialogId != 0) {
                        if (this.avatarsDialogId != 0) {
                            this.dialogPhotos = MessagesController.getInstance(this.currentAccount).getDialogPhotos(this.avatarsDialogId);
                            NotificationCenter.getInstance(this.currentAccount).lambda$postNotificationNameOnUIThread$1(NotificationCenter.dialogPhotosUpdate, this.dialogPhotos);
                        }
                    }
                }
                messageObject2 = this.currentMessageObject;
                if (messageObject2 == null) {
                    if (this.sendPhotoType == -1) {
                    }
                    if (!this.imagesArrLocals.isEmpty()) {
                    }
                } else {
                    if (this.sendPhotoType == -1) {
                    }
                    if (!this.imagesArrLocals.isEmpty()) {
                    }
                }
                checkFullscreenButton();
                VideoPlayer videoPlayer222 = this.videoPlayer;
                this.lastQualityIndexSelected = videoPlayer222 == null ? videoPlayer222.getCurrentQualityIndex() : -1;
                CastSync.check(0);
                if (ChromecastController.getInstance().isCasting()) {
                }
                videoPlayer = this.videoPlayer;
                if (videoPlayer == null) {
                }
            }
            CastSync.check(0);
            if (ChromecastController.getInstance().isCasting()) {
            }
            videoPlayer = this.videoPlayer;
            if (videoPlayer == null) {
            }
        } catch (Exception e) {
            FileLog.e(e);
            return;
        }
        imageView2 = this.tuneItem;
        if (imageView2 != null) {
        }
        this.dialogPhotos = null;
        if (this.currentAnimation == null) {
        }
        messageObject2 = this.currentMessageObject;
        if (messageObject2 == null) {
        }
        checkFullscreenButton();
        VideoPlayer videoPlayer2222 = this.videoPlayer;
        this.lastQualityIndexSelected = videoPlayer2222 == null ? videoPlayer2222.getCurrentQualityIndex() : -1;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void onSharePressed() {
        File file;
        boolean zIsVideo;
        String mimeType;
        if (this.parentActivity == null || !this.allowShare) {
            return;
        }
        try {
            MessageObject messageObject = this.currentMessageObject;
            File pathToAttach = null;
            if (messageObject != null) {
                zIsVideo = messageObject.isVideo();
                if (!TextUtils.isEmpty(this.currentMessageObject.messageOwner.attachPath)) {
                    File file2 = new File(this.currentMessageObject.messageOwner.attachPath);
                    if (file2.exists()) {
                        pathToAttach = file2;
                    }
                }
                if (pathToAttach == null) {
                    pathToAttach = FileLoader.getInstance(this.currentAccount).getPathToMessage(this.currentMessageObject.messageOwner);
                }
            } else if (this.currentFileLocationVideo != null) {
                pathToAttach = FileLoader.getInstance(this.currentAccount).getPathToAttach(getFileLocation(this.currentFileLocationVideo), getFileLocationExt(this.currentFileLocationVideo), this.avatarsDialogId != 0 || this.isEvent);
                if (pathToAttach != null) {
                    if (!pathToAttach.exists()) {
                    }
                    zIsVideo = false;
                }
                file = FileLoader.getInstance(this.currentAccount).getPathToAttach(getFileLocation(this.currentFileLocationVideo), getFileLocationExt(this.currentFileLocationVideo), false);
                pathToAttach = file;
                zIsVideo = false;
            } else {
                PageBlocksAdapter pageBlocksAdapter = this.pageBlocksAdapter;
                if (pageBlocksAdapter != null) {
                    file = pageBlocksAdapter.getFile(this.currentIndex);
                    pathToAttach = file;
                }
                zIsVideo = false;
            }
            if (pathToAttach != null && !pathToAttach.exists()) {
                pathToAttach = new File(FileLoader.getDirectory(4), pathToAttach.getName());
            }
            if (pathToAttach == null || !pathToAttach.exists()) {
                showDownloadAlert();
                return;
            }
            Intent intent = new Intent("android.intent.action.SEND");
            if (zIsVideo) {
                mimeType = "video/mp4";
            } else {
                MessageObject messageObject2 = this.currentMessageObject;
                mimeType = messageObject2 != null ? messageObject2.getMimeType() : "image/jpeg";
            }
            intent.setType(mimeType);
            if (Build.VERSION.SDK_INT >= 24) {
                try {
                    intent.putExtra("android.intent.extra.STREAM", FileProvider.getUriForFile(this.parentActivity, ApplicationLoader.getApplicationId() + ".provider", pathToAttach));
                    intent.setFlags(1);
                } catch (Exception unused) {
                }
            } else {
                intent.putExtra("android.intent.extra.STREAM", Uri.fromFile(pathToAttach));
            }
            this.parentActivity.startActivityForResult(Intent.createChooser(intent, LocaleController.getString("ShareFile", R.string.ShareFile)), 500);
        } catch (Exception e) {
            FileLog.e(e);
        }
    }

    private void onShowView() {
        Activity activity = this.parentActivity;
        if (activity instanceof LaunchActivity) {
            ((LaunchActivity) activity).addOnUserLeaveHintListener(this.onUserLeaveHintListener);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:216:0x0400  */
    /* JADX WARN: Removed duplicated region for block: B:221:0x040d  */
    /* JADX WARN: Removed duplicated region for block: B:229:0x0424  */
    /* JADX WARN: Removed duplicated region for block: B:265:0x050e A[PHI: r4
      0x050e: PHI (r4v53 float) = (r4v48 float), (r4v49 float) binds: [B:264:0x050c, B:267:0x0514] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:271:0x051d A[PHI: r4
      0x051d: PHI (r4v52 float) = (r4v50 float), (r4v51 float) binds: [B:270:0x051b, B:273:0x0523] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:272:0x051f  */
    /* JADX WARN: Removed duplicated region for block: B:280:0x0542 A[PHI: r4
      0x0542: PHI (r4v34 float) = (r4v29 float), (r4v30 float) binds: [B:279:0x0540, B:282:0x0548] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:286:0x0553 A[PHI: r4
      0x0553: PHI (r4v33 float) = (r4v31 float), (r4v32 float) binds: [B:285:0x0551, B:288:0x0559] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:287:0x0555  */
    /* JADX WARN: Removed duplicated region for block: B:337:0x0634 A[PHI: r4
      0x0634: PHI (r4v20 float) = (r4v15 float), (r4v16 float) binds: [B:336:0x0632, B:339:0x063a] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:343:0x0645 A[PHI: r4
      0x0645: PHI (r4v19 float) = (r4v17 float), (r4v18 float) binds: [B:342:0x0643, B:345:0x064b] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:344:0x0647  */
    /* JADX WARN: Removed duplicated region for block: B:391:0x07c9 A[PHI: r2
      0x07c9: PHI (r2v41 android.view.VelocityTracker) = (r2v29 android.view.VelocityTracker), (r2v64 android.view.VelocityTracker) binds: [B:390:0x07c7, B:371:0x072c] A[DONT_GENERATE, DONT_INLINE]] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public boolean onTouchEvent(MotionEvent motionEvent) {
        VelocityTracker velocityTracker;
        float f;
        float f2;
        int i;
        float f3;
        float f4;
        float f5;
        int i2;
        int i3;
        MaskPaintView maskPaintView;
        LPhotoPaintView lPhotoPaintView;
        this.lastX = motionEvent.getX();
        if (this.currentEditMode == 3 && this.animationStartTime != 0 && (motionEvent.getActionMasked() == 0 || motionEvent.getActionMasked() == 5)) {
            if (motionEvent.getPointerCount() < 2) {
                return true;
            }
            cancelMoveZoomAnimation();
        }
        if (this.animationInProgress != 0 || this.animationStartTime != 0) {
            return false;
        }
        if (this.longVideoPlayerRewinder.rewindCount > 0) {
            if (motionEvent.getAction() != 1 && motionEvent.getAction() != 3) {
                return true;
            }
            this.longVideoPlayerRewinder.cancelRewind();
            return false;
        }
        if (this.videoPlayerRewinder.rewinding) {
            if (motionEvent.getAction() == 1 || motionEvent.getAction() == 3) {
                this.videoPlayerRewinder.cancelRewind();
                return false;
            }
            if (motionEvent.getAction() == 2) {
                this.videoPlayerRewinder.setX(motionEvent.getX());
                return true;
            }
        }
        int i4 = this.currentEditMode;
        if (i4 == 2) {
            this.photoFilterView.onTouch(motionEvent);
            return true;
        }
        if (i4 != 1 && (i4 == 3 || this.sendPhotoType != 1)) {
            if (!getCaptionView().editText.isPopupShowing() && !getCaptionView().editText.isKeyboardVisible()) {
                if (this.currentEditMode == 0 && this.sendPhotoType != 1 && motionEvent.getPointerCount() == 1 && this.gestureDetector.onTouchEvent(motionEvent) && this.doubleTap) {
                    this.doubleTap = false;
                    this.moving = false;
                    this.zooming = false;
                    checkMinMax(false);
                    return true;
                }
                Tooltip tooltip = this.tooltip;
                if (tooltip != null) {
                    tooltip.hide();
                }
                if (motionEvent.getActionMasked() == 0 || motionEvent.getActionMasked() == 5) {
                    this.discardTap = false;
                    if (!this.scroller.isFinished()) {
                        this.scroller.abortAnimation();
                    }
                    if (!this.draggingDown && !this.changingPage) {
                        if (this.canZoom && motionEvent.getPointerCount() == 2) {
                            if (this.paintViewTouched == 1) {
                                MotionEvent motionEventObtain = MotionEvent.obtain(0L, 0L, 3, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 0);
                                this.photoPaintView.onTouch(motionEventObtain);
                                motionEventObtain.recycle();
                                this.paintViewTouched = 2;
                            } else if (this.maskPaintViewTouched == 1) {
                                MotionEvent motionEventObtain2 = MotionEvent.obtain(0L, 0L, 3, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 0);
                                this.maskPaintView.onTouch(motionEventObtain2);
                                motionEventObtain2.recycle();
                                this.maskPaintViewTouched = 2;
                            }
                            this.pinchStartDistance = (float) Math.hypot(motionEvent.getX(1) - motionEvent.getX(0), motionEvent.getY(1) - motionEvent.getY(0));
                            this.pinchStartAngle = (float) Math.atan2(motionEvent.getY(1) - motionEvent.getY(0), motionEvent.getX(1) - motionEvent.getX(0));
                            this.pinchStartScale = this.scale;
                            this.pinchStartRotate = this.rotate;
                            this.pinchCenterX = (motionEvent.getX(0) + motionEvent.getX(1)) / 2.0f;
                            float y = (motionEvent.getY(0) + motionEvent.getY(1)) / 2.0f;
                            this.pinchCenterY = y;
                            this.pinchStartX = this.translationX;
                            this.pinchStartY = this.translationY;
                            this.zooming = true;
                            this.moving = false;
                            if (this.currentEditMode == 3 || this.sendPhotoType == 11) {
                                this.moveStartX = this.pinchCenterX;
                                this.moveStartY = y;
                                this.draggingDown = false;
                                this.canDragDown = false;
                            }
                            hidePressedDrawables();
                            velocityTracker = this.velocityTracker;
                            if (velocityTracker != null) {
                            }
                        } else if (motionEvent.getPointerCount() == 1) {
                            int i5 = this.currentEditMode;
                            if (i5 == 3) {
                                if (this.paintViewTouched == 0) {
                                    View view = this.photoPaintView.getView();
                                    view.getHitRect(this.hitRect);
                                    if (this.hitRect.contains((int) motionEvent.getX(), (int) motionEvent.getY())) {
                                        MotionEvent motionEventObtain3 = MotionEvent.obtain(motionEvent);
                                        motionEventObtain3.offsetLocation(-view.getX(), -view.getY());
                                        this.photoPaintView.onTouch(motionEventObtain3);
                                        motionEventObtain3.recycle();
                                        this.paintViewTouched = 1;
                                    }
                                }
                            } else if (i5 != 4) {
                                this.moveStartX = motionEvent.getX();
                                float y2 = motionEvent.getY();
                                this.moveStartY = y2;
                                this.dragY = y2;
                                this.draggingDown = false;
                                this.canDragDown = true;
                                velocityTracker = this.velocityTracker;
                                if (velocityTracker != null) {
                                    velocityTracker.clear();
                                }
                            } else if (this.maskPaintViewTouched == 0) {
                                MaskPaintView maskPaintView2 = this.maskPaintView;
                                maskPaintView2.getHitRect(this.hitRect);
                                if (this.hitRect.contains((int) motionEvent.getX(), (int) motionEvent.getY())) {
                                    MotionEvent motionEventObtain4 = MotionEvent.obtain(motionEvent);
                                    motionEventObtain4.offsetLocation(-maskPaintView2.getX(), -maskPaintView2.getY());
                                    this.maskPaintView.onTouch(motionEventObtain4);
                                    motionEventObtain4.recycle();
                                    this.maskPaintViewTouched = 1;
                                }
                            }
                        }
                    }
                    if (motionEvent.getActionMasked() == 0) {
                        this.longPressX = motionEvent.getX();
                        AndroidUtilities.runOnUIThread(this.longPressRunnable, 300L);
                    } else {
                        AndroidUtilities.cancelRunOnUIThread(this.longPressRunnable);
                    }
                } else {
                    int actionMasked = motionEvent.getActionMasked();
                    float xVelocity = BitmapDescriptorFactory.HUE_RED;
                    if (actionMasked == 2) {
                        if (Math.abs(this.longPressX - this.lastX) > AndroidUtilities.touchSlop) {
                            AndroidUtilities.cancelRunOnUIThread(this.longPressRunnable);
                        }
                        if (this.canZoom && motionEvent.getPointerCount() == 2 && !this.draggingDown && this.zooming && !this.changingPage) {
                            this.discardTap = true;
                            if (this.currentEditMode == 3 || this.sendPhotoType == 11) {
                                float x = (motionEvent.getX(0) + motionEvent.getX(1)) / 2.0f;
                                float y3 = (motionEvent.getY(0) + motionEvent.getY(1)) / 2.0f;
                                float f6 = this.moveStartX - x;
                                float f7 = this.moveStartY - y3;
                                this.moveStartX = x;
                                this.moveStartY = y3;
                                float f8 = this.translationX;
                                if (f8 < this.minX || f8 > this.maxX) {
                                    f6 /= 3.0f;
                                }
                                float f9 = this.translationY;
                                if (f9 < this.minY || f9 > this.maxY) {
                                    f7 /= 3.0f;
                                }
                                this.pinchStartX = ((this.pinchCenterX - (getContainerViewWidth() / 2)) - (((this.pinchCenterX - (getContainerViewWidth() / 2)) - this.translationX) / (this.scale / this.pinchStartScale))) - f6;
                                this.pinchStartY = ((this.pinchCenterY - (getContainerViewHeight() / 2)) - (((this.pinchCenterY - (getContainerViewHeight() / 2)) - this.translationY) / (this.scale / this.pinchStartScale))) - f7;
                                this.pinchCenterX = x;
                                this.pinchCenterY = y3;
                            }
                            if (this.sendPhotoType == 11 && this.currentEditMode == 0) {
                                double dAtan2 = Math.atan2(motionEvent.getY(1) - motionEvent.getY(0), motionEvent.getX(1) - motionEvent.getX(0));
                                double d = this.pinchStartAngle;
                                Double.isNaN(d);
                                double d2 = ((dAtan2 - d) / 3.141592653589793d) * 180.0d;
                                double d3 = this.pinchStartRotate;
                                Double.isNaN(d3);
                                this.rotate = (float) (d2 + d3);
                            }
                            this.scale = (((float) Math.hypot(motionEvent.getX(1) - motionEvent.getX(0), motionEvent.getY(1) - motionEvent.getY(0))) / this.pinchStartDistance) * this.pinchStartScale;
                            this.translationX = (this.pinchCenterX - (getContainerViewWidth() / 2)) - (((this.pinchCenterX - (getContainerViewWidth() / 2)) - this.pinchStartX) * (this.scale / this.pinchStartScale));
                            float containerViewHeight = this.pinchCenterY - (getContainerViewHeight() / 2);
                            float containerViewHeight2 = (this.pinchCenterY - (getContainerViewHeight() / 2)) - this.pinchStartY;
                            float f10 = this.scale;
                            this.translationY = containerViewHeight - (containerViewHeight2 * (f10 / this.pinchStartScale));
                            updateMinMax(f10);
                        } else if (motionEvent.getPointerCount() == 1) {
                            if (this.paintViewTouched == 1 && (lPhotoPaintView = this.photoPaintView) != null) {
                                View view2 = lPhotoPaintView.getView();
                                MotionEvent motionEventObtain5 = MotionEvent.obtain(motionEvent);
                                motionEventObtain5.offsetLocation(-view2.getX(), -view2.getY());
                                this.photoPaintView.onTouch(motionEventObtain5);
                                motionEventObtain5.recycle();
                                return true;
                            }
                            if (this.maskPaintViewTouched == 1 && (maskPaintView = this.maskPaintView) != null) {
                                MotionEvent motionEventObtain6 = MotionEvent.obtain(motionEvent);
                                motionEventObtain6.offsetLocation(-maskPaintView.getX(), -maskPaintView.getY());
                                this.maskPaintView.onTouch(motionEventObtain6);
                                motionEventObtain6.recycle();
                                return true;
                            }
                            VelocityTracker velocityTracker2 = this.velocityTracker;
                            if (velocityTracker2 != null) {
                                velocityTracker2.addMovement(motionEvent);
                            }
                            float fAbs = Math.abs(motionEvent.getX() - this.moveStartX);
                            float fAbs2 = Math.abs(motionEvent.getY() - this.dragY);
                            float f11 = this.touchSlop;
                            if (fAbs > f11 || fAbs2 > f11) {
                                this.discardTap = true;
                                hidePressedDrawables();
                                AndroidUtilities.cancelRunOnUIThread(this.longPressRunnable);
                                QualityChooseView qualityChooseView = this.qualityChooseView;
                                if (qualityChooseView != null && qualityChooseView.getVisibility() == 0) {
                                    return true;
                                }
                            }
                            if (this.placeProvider.canScrollAway() && this.currentEditMode == 0 && (i3 = this.sendPhotoType) != 1 && i3 != 11 && this.canDragDown && !this.draggingDown && this.scale == 1.0f && fAbs2 >= AndroidUtilities.dp(30.0f) && fAbs2 / 2.0f > fAbs) {
                                this.draggingDown = true;
                                hidePressedDrawables();
                                this.moving = false;
                                this.dragY = motionEvent.getY();
                                if (this.isActionBarVisible && this.containerView.getTag() != null) {
                                    toggleActionBar(false, true);
                                } else if (this.pickerView.getVisibility() == 0) {
                                    toggleActionBar(false, true);
                                    togglePhotosListView(false, true);
                                    toggleCheckImageView(false);
                                }
                                return true;
                            }
                            if (this.draggingDown) {
                                this.translationY = motionEvent.getY() - this.dragY;
                                this.containerView.invalidate();
                            } else if (this.invalidCoords || this.animationStartTime != 0) {
                                this.invalidCoords = false;
                                this.moveStartX = motionEvent.getX();
                                this.moveStartY = motionEvent.getY();
                            } else {
                                float x2 = this.moveStartX - motionEvent.getX();
                                float y4 = this.moveStartY - motionEvent.getY();
                                if (this.moving || this.currentEditMode != 0 || this.sendPhotoType == 11 || ((this.scale == 1.0f && Math.abs(y4) + AndroidUtilities.dp(12.0f) < Math.abs(x2)) || this.scale != 1.0f)) {
                                    if (!this.moving) {
                                        this.moving = true;
                                        this.canDragDown = false;
                                        hidePressedDrawables();
                                        x2 = BitmapDescriptorFactory.HUE_RED;
                                        y4 = BitmapDescriptorFactory.HUE_RED;
                                    }
                                    this.moveStartX = motionEvent.getX();
                                    this.moveStartY = motionEvent.getY();
                                    updateMinMax(this.scale);
                                    if ((this.translationX < this.minX && (this.currentEditMode != 0 || !this.rightImage.hasImageSet())) || (this.translationX > this.maxX && (this.currentEditMode != 0 || !this.leftImage.hasImageSet()))) {
                                        x2 /= 3.0f;
                                    }
                                    float f12 = this.maxY;
                                    if (f12 == BitmapDescriptorFactory.HUE_RED) {
                                        float f13 = this.minY;
                                        if (f13 != BitmapDescriptorFactory.HUE_RED || this.currentEditMode != 0 || (i2 = this.sendPhotoType) == 1 || i2 == 11) {
                                            float f14 = this.translationY;
                                            xVelocity = (f14 < this.minY || f14 > f12) ? y4 / 3.0f : y4;
                                            this.translationX -= x2;
                                            if (this.scale == 1.0f || this.currentEditMode != 0 || this.sendPhotoType == 11) {
                                                this.translationY -= xVelocity;
                                            }
                                        } else {
                                            float f15 = this.translationY - y4;
                                            if (f15 < f13) {
                                                this.translationY = f13;
                                            } else if (f15 > f12) {
                                                this.translationY = f12;
                                            }
                                            this.translationX -= x2;
                                            if (this.scale == 1.0f) {
                                                this.translationY -= xVelocity;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        invalidateBlur();
                        this.containerView.invalidate();
                    } else if (motionEvent.getActionMasked() == 3 || motionEvent.getActionMasked() == 1 || motionEvent.getActionMasked() == 6) {
                        hidePressedDrawables();
                        AndroidUtilities.cancelRunOnUIThread(this.longPressRunnable);
                        if (this.paintViewTouched == 1) {
                            LPhotoPaintView lPhotoPaintView2 = this.photoPaintView;
                            if (lPhotoPaintView2 != null) {
                                View view3 = lPhotoPaintView2.getView();
                                MotionEvent motionEventObtain7 = MotionEvent.obtain(motionEvent);
                                motionEventObtain7.offsetLocation(-view3.getX(), -view3.getY());
                                this.photoPaintView.onTouch(motionEventObtain7);
                                motionEventObtain7.recycle();
                            }
                            this.paintViewTouched = 0;
                            this.maskPaintViewTouched = 0;
                            return true;
                        }
                        if (this.maskPaintViewTouched == 1) {
                            MaskPaintView maskPaintView3 = this.maskPaintView;
                            if (maskPaintView3 != null) {
                                MotionEvent motionEventObtain8 = MotionEvent.obtain(motionEvent);
                                motionEventObtain8.offsetLocation(-maskPaintView3.getX(), -maskPaintView3.getY());
                                this.maskPaintView.onTouch(motionEventObtain8);
                                motionEventObtain8.recycle();
                            }
                            this.paintViewTouched = 0;
                            this.maskPaintViewTouched = 0;
                            return true;
                        }
                        this.paintViewTouched = 0;
                        this.maskPaintViewTouched = 0;
                        if (this.zooming) {
                            this.invalidCoords = true;
                            int i6 = this.sendPhotoType;
                            float f16 = i6 == 11 ? 10.0f : 3.0f;
                            float f17 = i6 == 11 ? 0.33f : 1.0f;
                            float f18 = this.scale;
                            if (f18 < f17) {
                                updateMinMax(f17);
                                animateTo(f17, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, true);
                            } else if (f18 > f16) {
                                float containerViewWidth = (this.pinchCenterX - (getContainerViewWidth() / 2)) - (((this.pinchCenterX - (getContainerViewWidth() / 2)) - this.pinchStartX) * (f16 / this.pinchStartScale));
                                float containerViewHeight3 = (this.pinchCenterY - (getContainerViewHeight() / 2)) - (((this.pinchCenterY - (getContainerViewHeight() / 2)) - this.pinchStartY) * (f16 / this.pinchStartScale));
                                updateMinMax(f16);
                                float f19 = this.minX;
                                if (containerViewWidth < f19) {
                                    containerViewWidth = f19;
                                    f5 = this.minY;
                                    if (containerViewHeight3 >= f5) {
                                        containerViewHeight3 = f5;
                                        animateTo(f16, containerViewWidth, containerViewHeight3, true);
                                    } else {
                                        f5 = this.maxY;
                                        if (containerViewHeight3 > f5) {
                                        }
                                        animateTo(f16, containerViewWidth, containerViewHeight3, true);
                                    }
                                } else {
                                    f19 = this.maxX;
                                    if (containerViewWidth > f19) {
                                    }
                                    f5 = this.minY;
                                    if (containerViewHeight3 >= f5) {
                                    }
                                }
                            } else {
                                checkMinMax(true);
                                if (this.currentEditMode == 3) {
                                    float f20 = this.translationX;
                                    float f21 = this.translationY;
                                    updateMinMax(this.scale);
                                    float f22 = this.translationX;
                                    float f23 = this.minX;
                                    if (f22 < f23) {
                                        f20 = f23;
                                        f3 = this.translationY;
                                        f4 = this.minY;
                                        if (f3 >= f4) {
                                            f21 = f4;
                                            animateTo(this.scale, f20, f21, false);
                                        } else {
                                            f4 = this.maxY;
                                            if (f3 > f4) {
                                            }
                                            animateTo(this.scale, f20, f21, false);
                                        }
                                    } else {
                                        f23 = this.maxX;
                                        if (f22 > f23) {
                                        }
                                        f3 = this.translationY;
                                        f4 = this.minY;
                                        if (f3 >= f4) {
                                        }
                                    }
                                }
                            }
                            this.zooming = false;
                            this.moving = false;
                        } else if (this.draggingDown) {
                            if (Math.abs(this.dragY - motionEvent.getY()) <= getContainerViewHeight() / 6.0f) {
                                if (this.pickerView.getVisibility() == 0) {
                                    toggleActionBar(true, true);
                                    toggleCheckImageView(true);
                                }
                                animateTo(1.0f, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, false);
                            } else if (!enableSwipeToPiP() || this.dragY - motionEvent.getY() <= BitmapDescriptorFactory.HUE_RED) {
                                closePhoto(true, false);
                            } else {
                                switchToPip(true);
                            }
                            this.draggingDown = false;
                        } else if (this.moving) {
                            float f24 = this.translationX;
                            float f25 = this.translationY;
                            updateMinMax(this.scale);
                            this.moving = false;
                            this.canDragDown = true;
                            VelocityTracker velocityTracker3 = this.velocityTracker;
                            if (velocityTracker3 != null && this.scale == 1.0f) {
                                velocityTracker3.computeCurrentVelocity(1000);
                                xVelocity = this.velocityTracker.getXVelocity();
                            }
                            if (this.currentEditMode == 0 && (i = this.sendPhotoType) != 1 && i != 11) {
                                if ((this.translationX < this.minX - (getContainerViewWidth() / 3) || xVelocity < (-AndroidUtilities.dp(650.0f))) && this.rightImage.hasImageSet()) {
                                    goToNext();
                                    return true;
                                }
                                if ((this.translationX > this.maxX + (getContainerViewWidth() / 3) || xVelocity > AndroidUtilities.dp(650.0f)) && this.leftImage.hasImageSet()) {
                                    goToPrev();
                                    return true;
                                }
                            }
                            float f26 = this.translationX;
                            float f27 = this.minX;
                            if (f26 < f27) {
                                f24 = f27;
                                f = this.translationY;
                                f2 = this.minY;
                                if (f >= f2) {
                                    f25 = f2;
                                    animateTo(this.scale, f24, f25, false);
                                } else {
                                    f2 = this.maxY;
                                    if (f > f2) {
                                    }
                                    animateTo(this.scale, f24, f25, false);
                                }
                            } else {
                                f27 = this.maxX;
                                if (f26 > f27) {
                                }
                                f = this.translationY;
                                f2 = this.minY;
                                if (f >= f2) {
                                }
                            }
                        }
                    }
                }
                return false;
            }
            if (motionEvent.getAction() == 1) {
                closeCaptionEnter(true);
            }
        }
        return true;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void onUserLeaveHint() {
        if (this.pipItem.isEnabled() && AndroidUtilities.checkInlinePermissions(this.parentActivity) && !PipVideoOverlay.isVisible() && this.isPlaying) {
            if (!this.isEmbedVideo) {
                this.pipVideoOverlayAnimateFlag = false;
                switchToPip(false);
                return;
            }
            PhotoViewerWebView photoViewerWebView = this.photoViewerWebView;
            if (photoViewerWebView == null || photoViewerWebView.isInAppOnly() || !this.photoViewerWebView.openInPip()) {
                return;
            }
            this.pipVideoOverlayAnimateFlag = false;
            if (PipInstance != null) {
                PipInstance.destroyPhotoViewer();
            }
            this.isInline = true;
            PipInstance = Instance;
            Instance = null;
            this.isVisible = false;
            PlaceProviderObject placeProviderObject = this.currentPlaceObject;
            if (placeProviderObject != null && !placeProviderObject.imageReceiver.getVisible()) {
                this.currentPlaceObject.imageReceiver.setVisible(true, true);
            }
            this.clippingImageProgress = 1.0f;
            this.containerView.invalidate();
            dismissInternal();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void openCurrentPhotoInPaintModeForSelect() {
        final File file;
        final MessageObject messageObject;
        final boolean z;
        final boolean z2;
        final boolean z3;
        if (canSendMediaToParentChatActivity()) {
            MessageObject messageObject2 = this.currentMessageObject;
            File pathToMessage = null;
            if (messageObject2 != null) {
                boolean z4 = messageObject2.canEditMedia() && !this.currentMessageObject.isDocument();
                boolean z5 = z4 && this.currentMessageObject.isOutOwner();
                boolean zIsVideo = this.currentMessageObject.isVideo();
                if (!TextUtils.isEmpty(this.currentMessageObject.messageOwner.attachPath)) {
                    File file2 = new File(this.currentMessageObject.messageOwner.attachPath);
                    if (file2.exists()) {
                        pathToMessage = file2;
                    }
                }
                if (pathToMessage == null) {
                    pathToMessage = FileLoader.getInstance(this.currentAccount).getPathToMessage(this.currentMessageObject.messageOwner);
                }
                messageObject = messageObject2;
                file = pathToMessage;
                z2 = z4;
                z3 = z5;
                z = zIsVideo;
            } else {
                file = null;
                messageObject = null;
                z = false;
                z2 = false;
                z3 = false;
            }
            if (file == null || !file.exists()) {
                showDownloadAlert();
                return;
            }
            this.savedState = new SavedState(this.currentIndex, new ArrayList(this.imagesArr), this.placeProvider);
            toggleActionBar(false, true, new ActionBarToggleParams().enableStatusBarAnimation(false));
            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda159
                @Override // java.lang.Runnable
                public final void run() throws Resources.NotFoundException {
                    this.f$0.lambda$openCurrentPhotoInPaintModeForSelect$130(file, z, messageObject, z2, z3);
                }
            }, r0.animationDuration);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void pauseVideoOrWeb() {
        VideoPlayer videoPlayer = this.videoPlayer;
        if (videoPlayer != null) {
            videoPlayer.pause();
            return;
        }
        PhotoViewerWebView photoViewerWebView = this.photoViewerWebView;
        if (photoViewerWebView != null) {
            photoViewerWebView.pauseVideo();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void pipInvalidateAvailability() {
        PipSource pipSource = this.pipSource;
        if (pipSource != null) {
            pipSource.invalidateAvailability();
        }
        if (PipVideoOverlay.getPipSource() != null) {
            PipVideoOverlay.getPipSource().invalidateAvailability();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void playOrStopAnimatedStickers(boolean z) {
        RLottieDrawable lottieAnimation;
        ArrayList arrayList = this.editState.mediaEntities;
        if (arrayList != null) {
            int size = arrayList.size();
            for (int i = 0; i < size; i++) {
                VideoEditedInfo.MediaEntity mediaEntity = (VideoEditedInfo.MediaEntity) this.editState.mediaEntities.get(i);
                if (mediaEntity.type == 0 && (mediaEntity.subType & 1) != 0) {
                    View view = mediaEntity.view;
                    if ((view instanceof BackupImageView) && (lottieAnimation = ((BackupImageView) view).getImageReceiver().getLottieAnimation()) != null) {
                        if (z) {
                            lottieAnimation.start();
                        } else {
                            lottieAnimation.stop();
                        }
                    }
                }
            }
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void playVideoOrWeb() {
        VideoPlayer videoPlayer = this.videoPlayer;
        if (videoPlayer != null) {
            videoPlayer.play();
            return;
        }
        PhotoViewerWebView photoViewerWebView = this.photoViewerWebView;
        if (photoViewerWebView != null) {
            photoViewerWebView.playVideo();
        }
    }

    private CharSequence postProcessTranslated(MessageObject messageObject) {
        boolean zIsOutOwner;
        int duration;
        int i;
        if (messageObject == null || messageObject.messageOwner == null) {
            return "";
        }
        Spannable spannableReplaceAnimatedEmoji = MessageObject.replaceAnimatedEmoji(Emoji.replaceEmoji(new SpannableStringBuilder(messageObject.messageOwner.translatedText.text), Theme.chat_msgTextPaint.getFontMetricsInt(), false), messageObject.messageOwner.translatedText.entities, Theme.chat_msgTextPaint.getFontMetricsInt(), false);
        if (MessageObject.containsUrls(spannableReplaceAnimatedEmoji)) {
            try {
                AndroidUtilities.addLinksSafe(spannableReplaceAnimatedEmoji, 5, false, true);
            } catch (Exception e) {
                FileLog.e(e);
            }
        }
        MessageObject.addUrlsByPattern(messageObject.isOutOwner(), spannableReplaceAnimatedEmoji, true, 0, 0, true);
        MessageObject.addEntitiesToText(spannableReplaceAnimatedEmoji, messageObject.messageOwner.translatedText.entities, messageObject.isOutOwner(), true, true, true);
        if (!messageObject.isVideo()) {
            if (messageObject.isMusic() || messageObject.isVoice()) {
                zIsOutOwner = messageObject.isOutOwner();
                duration = (int) messageObject.getDuration();
                i = 4;
            }
            return spannableReplaceAnimatedEmoji;
        }
        zIsOutOwner = messageObject.isOutOwner();
        duration = (int) messageObject.getDuration();
        i = 3;
        MessageObject.addUrlsByPattern(zIsOutOwner, spannableReplaceAnimatedEmoji, true, i, duration, false);
        return spannableReplaceAnimatedEmoji;
    }

    private void preparePlayer(ArrayList arrayList, Uri uri, boolean z, boolean z2) {
        preparePlayer(arrayList, uri, z, z2, null);
    }

    private void preparePlayer(ArrayList arrayList, Uri uri, boolean z, boolean z2, MediaController.SavedFilterState savedFilterState) {
        boolean z3;
        PageBlocksAdapter pageBlocksAdapter;
        boolean zBooleanValue;
        VideoSize videoSize;
        int i;
        int i2;
        if (!z2) {
            this.currentPlayingVideoFile = uri;
            this.currentPlayingVideoQualityFiles = arrayList;
        }
        if (this.parentActivity == null) {
            return;
        }
        this.streamingAlertShown = false;
        this.startedPlayTime = SystemClock.elapsedRealtime();
        this.currentVideoFinishedLoading = false;
        this.lastBufferedPositionCheck = 0L;
        this.firstAnimationDelay = true;
        this.inPreview = z2;
        releasePlayer(false);
        if (this.imagesArrLocals.isEmpty()) {
            createVideoTextureView(null);
        }
        if (Build.VERSION.SDK_INT >= 21 && this.textureImageView == null) {
            ImageView imageView = new ImageView(this.parentActivity);
            this.textureImageView = imageView;
            imageView.setBackgroundColor(-65536);
            this.textureImageView.setPivotX(BitmapDescriptorFactory.HUE_RED);
            this.textureImageView.setPivotY(BitmapDescriptorFactory.HUE_RED);
            this.textureImageView.setVisibility(4);
            this.containerView.addView(this.textureImageView);
        }
        checkFullscreenButton();
        if (this.orientationEventListener == null) {
            OrientationEventListener orientationEventListener = new OrientationEventListener(ApplicationLoader.applicationContext) { // from class: org.telegram.ui.PhotoViewer.53
                @Override // android.view.OrientationEventListener
                public void onOrientationChanged(int i3) {
                    if (PhotoViewer.this.orientationEventListener == null || PhotoViewer.this.aspectRatioFrameLayout == null || PhotoViewer.this.aspectRatioFrameLayout.getVisibility() != 0 || PhotoViewer.this.parentActivity == null || PhotoViewer.this.fullscreenedByButton == 0) {
                        return;
                    }
                    if (PhotoViewer.this.fullscreenedByButton != 1) {
                        if (i3 <= 0 || (i3 < 330 && i3 > 30)) {
                            if (!PhotoViewer.this.wasRotated || i3 < 240 || i3 > 300) {
                                return;
                            }
                            PhotoViewer.this.parentActivity.setRequestedOrientation(PhotoViewer.this.prevOrientation);
                            PhotoViewer.this.fullscreenedByButton = 0;
                            PhotoViewer.this.wasRotated = false;
                            return;
                        }
                        PhotoViewer.this.wasRotated = true;
                    }
                    if (i3 < 240 || i3 > 300) {
                        if (!PhotoViewer.this.wasRotated || i3 <= 0) {
                            return;
                        }
                        if (i3 < 330 && i3 > 30) {
                            return;
                        }
                        PhotoViewer.this.parentActivity.setRequestedOrientation(PhotoViewer.this.prevOrientation);
                        PhotoViewer.this.fullscreenedByButton = 0;
                        PhotoViewer.this.wasRotated = false;
                        return;
                    }
                    PhotoViewer.this.wasRotated = true;
                }
            };
            this.orientationEventListener = orientationEventListener;
            if (orientationEventListener.canDetectOrientation()) {
                this.orientationEventListener.enable();
            } else {
                this.orientationEventListener.disable();
                this.orientationEventListener = null;
            }
        }
        this.textureUploaded = false;
        this.videoSizeSet = false;
        this.videoCrossfadeStarted = false;
        this.playerWasReady = false;
        this.playerWasPlaying = false;
        this.captureFrameReadyAtTime = -1L;
        this.captureFrameAtTime = -1L;
        this.needCaptureFrameReadyAtTime = -1L;
        this.firstFrameRendered = false;
        PipSource pipSource = this.pipSource;
        if (pipSource != null) {
            pipSource.destroy();
            this.pipSource = null;
        }
        if (this.videoPlayer == null) {
            VideoPlayer videoPlayer = this.injectingVideoPlayer;
            if (videoPlayer != null) {
                this.videoPlayer = videoPlayer;
                this.injectingVideoPlayer = null;
                this.playerInjected = true;
                updatePlayerState(videoPlayer.getPlayWhenReady(), this.videoPlayer.getPlaybackState());
                z3 = false;
            } else {
                VideoPlayer videoPlayer2 = new VideoPlayer() { // from class: org.telegram.ui.PhotoViewer.54
                    @Override // org.telegram.ui.Components.VideoPlayer, com.google.android.exoplayer2.Player.Listener
                    public void onRenderedFirstFrame() {
                        super.onRenderedFirstFrame();
                        boolean z4 = true;
                        PhotoViewer.this.firstFrameRendered = true;
                        if (PhotoViewer.this.usedSurfaceView) {
                            PhotoViewer.this.containerView.invalidate();
                        }
                        PhotoViewer.this.updateQualityItems();
                        if (!CastSync.isActive() && !PhotoViewer.this.muteVideo) {
                            z4 = false;
                        }
                        setMute(z4);
                        if (PhotoViewer.this.ignorePlayerUpdate) {
                            return;
                        }
                        CastSync.syncPosition(getCurrentPosition());
                        CastSync.setSpeed(getPlaybackSpeed());
                    }

                    @Override // org.telegram.ui.Components.VideoPlayer
                    public void pause() {
                        super.pause();
                        if (PhotoViewer.this.currentEditMode == 0) {
                            PhotoViewer.this.playOrStopAnimatedStickers(false);
                        }
                        if (PhotoViewer.this.ignorePlayerUpdate) {
                            return;
                        }
                        CastSync.syncPosition(getCurrentPosition());
                        CastSync.setPlaying(false);
                    }

                    @Override // org.telegram.ui.Components.VideoPlayer
                    public void play() {
                        super.play();
                        PhotoViewer.this.playOrStopAnimatedStickers(true);
                        if (PhotoViewer.this.ignorePlayerUpdate) {
                            return;
                        }
                        CastSync.syncPosition(getCurrentPosition());
                        CastSync.setPlaying(true);
                    }

                    @Override // org.telegram.ui.Components.VideoPlayer
                    public void seekTo(long j) {
                        super.seekTo(j);
                        if (PhotoViewer.this.isCurrentVideo) {
                            PhotoViewer.this.seekAnimatedStickersTo(j);
                        }
                        if (PhotoViewer.this.ignorePlayerUpdate) {
                            return;
                        }
                        CastSync.syncPosition(j);
                    }

                    @Override // org.telegram.ui.Components.VideoPlayer
                    public void setPlaybackSpeed(float f) {
                        super.setPlaybackSpeed(f);
                        if (PhotoViewer.this.ignorePlayerUpdate) {
                            return;
                        }
                        CastSync.setSpeed(f);
                    }
                };
                this.videoPlayer = videoPlayer2;
                videoPlayer2.setOnQualityChangeListener(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda16
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.updateQualityItems();
                    }
                });
                if (PipUtils.checkPermissions(this.parentActivity) == 1) {
                    this.pipSource = new PipSource.Builder(this.parentActivity, this).setTagPrefix("photo-viewer-" + this.videoPlayer.playerId).setContentView(this.aspectRatioFrameLayout).setPlaceholderView(this.pipPlaceholderView).setNeedMediaSession(true).build();
                }
                z3 = true;
            }
            TextureView textureView = this.videoTextureView;
            if (textureView != null) {
                this.videoPlayer.setTextureView(textureView);
            } else {
                SurfaceView surfaceView = this.videoSurfaceView;
                if (surfaceView != null) {
                    this.videoPlayer.setSurfaceView(surfaceView);
                }
            }
            FirstFrameView firstFrameView = this.firstFrameView;
            if (firstFrameView != null) {
                firstFrameView.clear();
            }
            this.videoPlayer.setDelegate(new AnonymousClass55());
        } else {
            z3 = false;
        }
        if (!this.imagesArrLocals.isEmpty()) {
            createVideoTextureView(savedFilterState);
        }
        this.videoCrossfadeAlpha = BitmapDescriptorFactory.HUE_RED;
        TextureView textureView2 = this.videoTextureView;
        if (textureView2 != null) {
            textureView2.setAlpha(BitmapDescriptorFactory.HUE_RED);
        }
        SurfaceView surfaceView2 = this.videoSurfaceView;
        if (surfaceView2 != null) {
            surfaceView2.setVisibility(4);
        }
        PaintingOverlay paintingOverlay = this.paintingOverlay;
        if (paintingOverlay != null) {
            paintingOverlay.setAlpha(this.videoCrossfadeAlpha);
        }
        this.shouldSavePositionForCurrentVideo = null;
        this.shouldSavePositionForCurrentVideoShortTerm = null;
        this.lastSaveTime = 0L;
        if (z3) {
            this.seekToProgressPending = this.seekToProgressPending2;
            this.videoPlayerSeekbar.setProgress(BitmapDescriptorFactory.HUE_RED);
            VideoTimelinePlayView videoTimelinePlayView = this.videoTimelineView;
            videoTimelinePlayView.setProgress(videoTimelinePlayView.getLeftProgress());
            this.videoPlayerSeekbar.setBufferedProgress(BitmapDescriptorFactory.HUE_RED);
            MessageObject messageObject = this.currentMessageObject;
            if (messageObject != null) {
                int duration = (int) messageObject.getDuration();
                String fileNameFast = this.currentMessageObject.getFileNameFast();
                if (!TextUtils.isEmpty(fileNameFast)) {
                    if (duration >= 10) {
                        SavedVideoPosition savedVideoPosition = (SavedVideoPosition) savedVideoPositions.get(fileNameFast);
                        MessageObject messageObject2 = this.currentMessageObject;
                        if (messageObject2.forceSeekTo < BitmapDescriptorFactory.HUE_RED && savedVideoPosition != null) {
                            float f = savedVideoPosition.position;
                            if (f > BitmapDescriptorFactory.HUE_RED && f < 0.999f) {
                                messageObject2.forceSeekTo = f;
                                this.videoPlayerSeekbar.setProgress(f);
                            }
                        }
                        this.shouldSavePositionForCurrentVideoShortTerm = fileNameFast;
                    }
                    if (duration >= 300) {
                        if (this.currentMessageObject.forceSeekTo < BitmapDescriptorFactory.HUE_RED) {
                            float f2 = ApplicationLoader.applicationContext.getSharedPreferences("media_saved_pos", 0).getFloat(fileNameFast, -1.0f);
                            if (f2 > BitmapDescriptorFactory.HUE_RED && f2 < 0.999f) {
                                this.currentMessageObject.forceSeekTo = f2;
                                this.videoPlayerSeekbar.setProgress(f2);
                            }
                        }
                        this.shouldSavePositionForCurrentVideo = fileNameFast;
                    }
                }
            }
            if (arrayList != null) {
                this.videoPlayer.preparePlayer(arrayList, VideoPlayer.getSavedQuality(arrayList, this.currentMessageObject));
            } else {
                this.videoPlayer.preparePlayer(uri, "other");
            }
            updateQualityItems();
            this.videoPlayer.setPlayWhenReady(z);
            PipSource pipSource2 = this.pipSource;
            if (pipSource2 != null) {
                pipSource2.setPlayer(this.videoPlayer.player);
                ExoPlayer exoPlayer = this.videoPlayer.player;
                if (exoPlayer != null && (videoSize = exoPlayer.getVideoSize()) != null && (i = videoSize.width) > 0 && (i2 = videoSize.height) > 0) {
                    int i3 = videoSize.unappliedRotationDegrees;
                    if (i3 == 90 || i3 == 270) {
                        this.pipSource.setContentRatio(i2, i);
                    } else {
                        this.pipSource.setContentRatio(i, i2);
                    }
                }
            }
        }
        Boolean looping = VideoPlayer.getLooping(this.currentMessageObject);
        if (looping != null) {
            zBooleanValue = looping.booleanValue();
        } else {
            MessageObject messageObject3 = this.currentMessageObject;
            zBooleanValue = (messageObject3 != null && messageObject3.getDuration() <= 30.0d) || ((pageBlocksAdapter = this.pageBlocksAdapter) != null && pageBlocksAdapter.isHardwarePlayer(this.currentIndex));
        }
        this.playerLooping = zBooleanValue;
        this.videoPlayerControlFrameLayout.setSeekBarTransitionEnabled(this.playerLooping);
        this.videoPlayer.setLooping(this.playerLooping);
        this.loopItem.setEnabledByColor(this.playerLooping, -1, -9194260);
        this.loopItem.setSelectorColor(this.playerLooping ? 259241196 : 268435455);
        MessageObject messageObject4 = this.currentMessageObject;
        if (messageObject4 != null) {
            float f3 = messageObject4.forceSeekTo;
            if (f3 >= BitmapDescriptorFactory.HUE_RED) {
                this.seekToProgressPending = f3;
                messageObject4.forceSeekTo = -1.0f;
            }
        }
        TLRPC.BotInlineResult botInlineResult = this.currentBotInlineResult;
        if (botInlineResult == null || !(botInlineResult.type.equals(MediaStreamTrack.VIDEO_TRACK_KIND) || MessageObject.isVideoDocument(this.currentBotInlineResult.document))) {
            this.bottomLayout.setPadding(0, 0, 0, 0);
        } else {
            this.bottomLayout.setVisibility(0);
            this.bottomLayout.setPadding(0, 0, AndroidUtilities.dp(84.0f), 0);
            this.pickerView.setVisibility(8);
        }
        if (this.pageBlocksAdapter != null) {
            this.bottomLayout.setVisibility(0);
        }
        PageBlocksAdapter pageBlocksAdapter2 = this.pageBlocksAdapter;
        if (pageBlocksAdapter2 == null || !pageBlocksAdapter2.isHardwarePlayer(this.currentIndex) || this.pageBlocksAdapter.isVideo(this.currentIndex)) {
            setVideoPlayerControlVisible(!this.isCurrentVideo, true);
        } else {
            setVideoPlayerControlVisible(false, true);
        }
        if (!this.isCurrentVideo) {
            scheduleActionBarHide(this.playerAutoStarted ? 3000 : 1000);
        }
        if (this.currentMessageObject != null) {
            this.videoPlayer.setPlaybackSpeed(this.currentVideoSpeed);
        }
        this.inPreview = z2;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void prepareRealEncoderBitrate() {
        if (this.bitrate == 0 || this.sendPhotoType == 1) {
            return;
        }
        Size sizeCalculateResultVideoSize = calculateResultVideoSize();
        if (sizeCalculateResultVideoSize.getWidth() == this.originalWidth && sizeCalculateResultVideoSize.getHeight() == this.originalHeight) {
            MediaController.extractRealEncoderBitrate(sizeCalculateResultVideoSize.getWidth(), sizeCalculateResultVideoSize.getHeight(), this.originalBitrate, false);
        } else {
            MediaController.extractRealEncoderBitrate(sizeCalculateResultVideoSize.getWidth(), sizeCalculateResultVideoSize.getHeight(), MediaController.makeVideoBitrate(this.originalHeight, this.originalWidth, this.originalBitrate, sizeCalculateResultVideoSize.getHeight(), sizeCalculateResultVideoSize.getWidth()), false);
        }
    }

    private void processOpenVideo(String str, boolean z, float f, float f2, int i) {
        if (this.currentLoadingVideoRunnable != null) {
            Utilities.globalQueue.cancelRunnable(this.currentLoadingVideoRunnable);
            this.currentLoadingVideoRunnable = null;
        }
        this.videoTimelineView.setVideoPath(str, f, f2);
        this.videoPreviewMessageObject = null;
        boolean z2 = true;
        if (!z && this.sendPhotoType != 1) {
            z2 = false;
        }
        this.muteVideo = z2;
        this.compressionsCount = -1;
        this.rotationValue = 0;
        this.videoFramerate = 25;
        this.originalSize = new File(str).length();
        DispatchQueue dispatchQueue = Utilities.globalQueue;
        AnonymousClass85 anonymousClass85 = new AnonymousClass85(str, i);
        this.currentLoadingVideoRunnable = anonymousClass85;
        dispatchQueue.postRunnable(anonymousClass85);
    }

    private void redraw(final int i) {
        FrameLayoutDrawer frameLayoutDrawer;
        if (i >= 6 || (frameLayoutDrawer = this.containerView) == null) {
            return;
        }
        frameLayoutDrawer.invalidate();
        AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda80
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$redraw$141(i);
            }
        }, 100L);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void releasePlayer(boolean z) {
        this.usedSurfaceView = false;
        PipSource pipSource = this.pipSource;
        if (pipSource != null) {
            pipSource.destroy();
            this.pipSource = null;
        }
        if (this.videoPlayer != null) {
            cancelVideoPlayRunnable();
            AndroidUtilities.cancelRunOnUIThread(this.setLoadingRunnable);
            AndroidUtilities.cancelRunOnUIThread(this.hideActionBarRunnable);
            if (this.shouldSavePositionForCurrentVideoShortTerm != null) {
                float currentPosition = this.videoPlayer.getCurrentPosition() / this.videoPlayer.getDuration();
                savedVideoPositions.put(this.shouldSavePositionForCurrentVideoShortTerm, new SavedVideoPosition(currentPosition, SystemClock.elapsedRealtime()));
                MessageObject messageObject = this.currentMessageObject;
                if (messageObject != null) {
                    messageObject.cachedSavedTimestamp = Float.valueOf(currentPosition);
                }
            }
            this.videoPlayer.releasePlayer(true);
            this.videoPlayer = null;
        } else {
            this.playerWasPlaying = false;
        }
        if (this.photoViewerWebView != null) {
            AndroidUtilities.cancelRunOnUIThread(this.hideActionBarRunnable);
            if (this.shouldSavePositionForCurrentVideoShortTerm != null) {
                float currentVideoPosition = getCurrentVideoPosition() / getVideoDuration();
                savedVideoPositions.put(this.shouldSavePositionForCurrentVideoShortTerm, new SavedVideoPosition(currentVideoPosition, SystemClock.elapsedRealtime()));
                MessageObject messageObject2 = this.currentMessageObject;
                if (messageObject2 != null) {
                    messageObject2.cachedSavedTimestamp = Float.valueOf(currentVideoPosition);
                }
            }
        }
        OrientationEventListener orientationEventListener = this.orientationEventListener;
        if (orientationEventListener != null) {
            orientationEventListener.disable();
            this.orientationEventListener = null;
        }
        this.videoPreviewFrame.close();
        toggleMiniProgress(false, false);
        this.pipAvailable = false;
        this.playerInjected = false;
        if (this.pipItem.isEnabled()) {
            this.pipItem.setEnabled(false);
            this.pipItem.animate().alpha(0.5f).setDuration(175L).withEndAction(null).start();
        }
        if (this.keepScreenOnFlagSet) {
            try {
                this.parentActivity.getWindow().clearFlags(128);
                this.keepScreenOnFlagSet = false;
            } catch (Exception e) {
                FileLog.e(e);
            }
        }
        AspectRatioFrameLayout aspectRatioFrameLayout = this.aspectRatioFrameLayout;
        if (aspectRatioFrameLayout != null) {
            try {
                this.containerView.removeView(aspectRatioFrameLayout);
            } catch (Throwable unused) {
            }
            this.aspectRatioFrameLayout = null;
        }
        cancelFlashAnimations();
        this.flashView = null;
        TextureView textureView = this.videoTextureView;
        if (textureView != null) {
            if (textureView instanceof VideoEditTextureView) {
                ((VideoEditTextureView) textureView).release();
            }
            this.videoTextureView = null;
        }
        this.blurManager.resetBitmap();
        if (this.videoSurfaceView != null) {
            this.videoSurfaceView = null;
        }
        if (this.isPlaying) {
            this.isPlaying = false;
            AndroidUtilities.cancelRunOnUIThread(this.updateProgressRunnable);
        }
        if (!z && !this.inPreview && !this.requestingPreview) {
            setVideoPlayerControlVisible(false, true);
        }
        this.photoProgressViews[0].resetAlphas();
    }

    private void removeObservers() {
        NotificationCenter.getInstance(this.currentAccount).removeObserver(this, NotificationCenter.fileLoadFailed);
        NotificationCenter.getInstance(this.currentAccount).removeObserver(this, NotificationCenter.fileLoaded);
        NotificationCenter.getInstance(this.currentAccount).removeObserver(this, NotificationCenter.customStickerCreated);
        NotificationCenter.getInstance(this.currentAccount).removeObserver(this, NotificationCenter.fileLoadProgressChanged);
        NotificationCenter.getInstance(this.currentAccount).removeObserver(this, NotificationCenter.mediaCountDidLoad);
        NotificationCenter.getInstance(this.currentAccount).removeObserver(this, NotificationCenter.mediaDidLoad);
        NotificationCenter.getInstance(this.currentAccount).removeObserver(this, NotificationCenter.dialogPhotosUpdate);
        NotificationCenter.getInstance(this.currentAccount).removeObserver(this, NotificationCenter.messagesDeleted);
        NotificationCenter.getGlobalInstance().removeObserver(this, NotificationCenter.emojiLoaded);
        NotificationCenter.getInstance(this.currentAccount).removeObserver(this, NotificationCenter.filePreparingFailed);
        NotificationCenter.getInstance(this.currentAccount).removeObserver(this, NotificationCenter.fileNewChunkAvailable);
        NotificationCenter.getInstance(this.currentAccount).removeObserver(this, NotificationCenter.replaceMessagesObjects);
        NotificationCenter.getInstance(this.currentAccount).removeObserver(this, NotificationCenter.dialogDeleted);
        ConnectionsManager.getInstance(this.currentAccount).cancelRequestsForGuid(this.classGuid);
    }

    private void replacePressed() {
        sendPressed(false, 0, true, false, false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void requestAdjust() {
        this.windowLayoutParams.softInputMode = 272;
        try {
            ((WindowManager) this.parentActivity.getSystemService("window")).updateViewLayout(this.windowView, this.windowLayoutParams);
        } catch (Exception e) {
            FileLog.e(e);
        }
    }

    private void requestAdjustToNothing() {
        this.windowLayoutParams.softInputMode = 48;
        try {
            ((WindowManager) this.parentActivity.getSystemService("window")).updateViewLayout(this.windowView, this.windowLayoutParams);
        } catch (Exception e) {
            FileLog.e(e);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:53:0x0157  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void requestVideoPreview(int i) {
        if (this.videoPreviewMessageObject != null) {
            MediaController.getInstance().cancelVideoConvert(this.videoPreviewMessageObject);
        }
        boolean z = this.requestingPreview && !this.tryStartRequestPreviewOnFinish;
        this.requestingPreview = false;
        this.loadInitialVideo = false;
        this.progressView.setVisibility(4);
        if (i != 1) {
            this.tryStartRequestPreviewOnFinish = false;
            this.photoProgressViews[0].setBackgroundState(3, false, true);
            if (i == 2) {
            }
        } else if (this.resultHeight == this.originalHeight && this.resultWidth == this.originalWidth) {
            this.tryStartRequestPreviewOnFinish = false;
            PhotoProgressView photoProgressView = this.photoProgressViews[0];
            photoProgressView.setProgress(BitmapDescriptorFactory.HUE_RED, photoProgressView.backgroundState == 0 || this.photoProgressViews[0].previousBackgroundState == 0);
            this.photoProgressViews[0].setBackgroundState(3, false, true);
            if (z) {
                this.loadInitialVideo = true;
            } else {
                preparePlayer(this.currentPlayingVideoQualityFiles, this.currentPlayingVideoFile, false, false, this.editState.savedFilterState);
                this.videoPlayer.seekTo((long) (this.videoTimelineView.getLeftProgress() * this.videoDuration));
            }
        } else {
            releasePlayer(false);
            if (this.videoPreviewMessageObject == null) {
                TLRPC.TL_message tL_message = new TLRPC.TL_message();
                tL_message.id = 0;
                tL_message.message = "";
                tL_message.media = new TLRPC.TL_messageMediaEmpty();
                tL_message.action = new TLRPC.TL_messageActionEmpty();
                tL_message.dialog_id = this.currentDialogId;
                MessageObject messageObject = new MessageObject(UserConfig.selectedAccount, tL_message, false, false);
                this.videoPreviewMessageObject = messageObject;
                messageObject.messageOwner.attachPath = new File(FileLoader.getDirectory(4), "video_preview.mp4").getAbsolutePath();
                this.videoPreviewMessageObject.videoEditedInfo = new VideoEditedInfo();
                VideoEditedInfo videoEditedInfo = this.videoPreviewMessageObject.videoEditedInfo;
                videoEditedInfo.rotationValue = this.rotationValue;
                videoEditedInfo.originalWidth = this.originalWidth;
                this.videoPreviewMessageObject.videoEditedInfo.originalHeight = this.originalHeight;
                VideoEditedInfo videoEditedInfo2 = this.videoPreviewMessageObject.videoEditedInfo;
                videoEditedInfo2.framerate = this.videoFramerate;
                videoEditedInfo2.originalPath = this.currentPlayingVideoFile.getPath();
            }
            VideoEditedInfo videoEditedInfo3 = this.videoPreviewMessageObject.videoEditedInfo;
            long j = this.startTime;
            videoEditedInfo3.startTime = j;
            long j2 = this.endTime;
            videoEditedInfo3.endTime = j2;
            if (j == -1) {
                j = 0;
            }
            if (j2 == -1) {
                j2 = (long) (this.videoDuration * 1000.0f);
            }
            if (j2 - j > 5000000) {
                videoEditedInfo3.endTime = j + 5000000;
            }
            videoEditedInfo3.bitrate = this.bitrate;
            this.videoPreviewMessageObject.videoEditedInfo.resultWidth = this.resultWidth;
            this.videoPreviewMessageObject.videoEditedInfo.resultHeight = this.resultHeight;
            VideoEditedInfo videoEditedInfo4 = this.videoPreviewMessageObject.videoEditedInfo;
            videoEditedInfo4.needUpdateProgress = true;
            videoEditedInfo4.originalDuration = (long) (this.videoDuration * 1000.0f);
            if (!MediaController.getInstance().scheduleVideoConvert(this.videoPreviewMessageObject, true, true, true)) {
                this.tryStartRequestPreviewOnFinish = true;
            }
            this.requestingPreview = true;
            PhotoProgressView photoProgressView2 = this.photoProgressViews[0];
            photoProgressView2.setProgress(BitmapDescriptorFactory.HUE_RED, photoProgressView2.backgroundState == 0 || this.photoProgressViews[0].previousBackgroundState == 0);
            this.photoProgressViews[0].setBackgroundState(0, false, true);
        }
        this.containerView.invalidate();
    }

    private void resetIndexForDeferredImageLoading() throws Resources.NotFoundException {
        Object mark = this.centerImage.getMark();
        if (mark == null || !mark.equals(1)) {
            return;
        }
        setIndexToImage(this.centerImage, this.currentIndex, null);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public float scale1() {
        return scale1(true);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public float scale1(boolean z) {
        int i;
        if (this.sendPhotoType != 11) {
            return 1.0f;
        }
        int containerViewWidth = getContainerViewWidth();
        if (containerViewWidth == 0) {
            containerViewWidth = AndroidUtilities.displaySize.x;
        }
        float fDp = ((containerViewWidth - AndroidUtilities.dp(20.0f)) + 1) / containerViewWidth;
        if (!z) {
            return fDp;
        }
        int bitmapWidth = this.centerImage.getBitmapWidth();
        int bitmapHeight = this.centerImage.getBitmapHeight();
        if ((bitmapWidth <= 1 || bitmapHeight <= 1) && (i = this.currentIndex) >= 0 && i < this.imagesArrLocals.size()) {
            Object obj = this.imagesArrLocals.get(this.currentIndex);
            if (obj instanceof MediaController.PhotoEntry) {
                MediaController.PhotoEntry photoEntry = (MediaController.PhotoEntry) obj;
                if ((photoEntry.orientation / 90) % 2 != 0) {
                    bitmapWidth = photoEntry.height;
                    bitmapHeight = photoEntry.width;
                } else {
                    bitmapWidth = photoEntry.width;
                    bitmapHeight = photoEntry.height;
                }
            }
        }
        return (bitmapWidth <= 1 || bitmapHeight <= 1 || bitmapWidth <= bitmapHeight) ? fDp : fDp * (bitmapWidth / bitmapHeight);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void scheduleActionBarHide() {
        scheduleActionBarHide(3000);
    }

    private void scheduleActionBarHide(int i) {
        if (isAccessibilityEnabled()) {
            return;
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || !messageObject.isSponsored()) {
            AndroidUtilities.cancelRunOnUIThread(this.hideActionBarRunnable);
            AndroidUtilities.runOnUIThread(this.hideActionBarRunnable, i);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void seekAnimatedStickersTo(long j) {
        RLottieDrawable lottieAnimation;
        ArrayList arrayList = this.editState.mediaEntities;
        if (arrayList != null) {
            int size = arrayList.size();
            for (int i = 0; i < size; i++) {
                VideoEditedInfo.MediaEntity mediaEntity = (VideoEditedInfo.MediaEntity) this.editState.mediaEntities.get(i);
                if (mediaEntity.type == 0 && (mediaEntity.subType & 1) != 0) {
                    View view = mediaEntity.view;
                    if ((view instanceof BackupImageView) && (lottieAnimation = ((BackupImageView) view).getImageReceiver().getLottieAnimation()) != null) {
                        long j2 = this.startTime;
                        lottieAnimation.setProgressMs(j - (j2 > 0 ? j2 / 1000 : 0L));
                    }
                }
            }
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void seekVideoOrWebTo(long j) {
        PhotoViewerWebView photoViewerWebView = this.photoViewerWebView;
        if (photoViewerWebView == null || !photoViewerWebView.isControllable()) {
            VideoPlayer videoPlayer = this.videoPlayer;
            if (videoPlayer != null) {
                videoPlayer.seekTo(j);
            }
        } else {
            this.photoViewerWebView.seekTo(j);
        }
        updateVideoPlayerTime();
    }

    private void seekVideoOrWebToProgress(float f) {
        VideoPlayer videoPlayer = this.videoPlayer;
        if (videoPlayer != null) {
            videoPlayer.seekTo((long) (f * videoPlayer.getDuration()));
            return;
        }
        PhotoViewerWebView photoViewerWebView = this.photoViewerWebView;
        if (photoViewerWebView != null) {
            photoViewerWebView.seekTo((long) (f * photoViewerWebView.getVideoDuration()));
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int selectCompression() {
        if (this.originalSize > 1048576000) {
            return this.compressionsCount - 1;
        }
        SharedPreferences globalMainSettings = MessagesController.getGlobalMainSettings();
        int i = this.compressionsCount;
        while (i < 5) {
            int i2 = globalMainSettings.getInt(String.format(Locale.US, "compress_video_%d", Integer.valueOf(i)), -1);
            if (i2 >= 0) {
                return Math.min(i2, 2);
            }
            i++;
        }
        return Math.min(2, Math.round(DownloadController.getInstance(this.currentAccount).getMaxVideoBitrate() / (100.0f / i)) - 1);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void sendPressed(boolean z, int i) {
        sendPressed(z, i, false, false, false);
    }

    private void sendPressed(final boolean z, final int i, final boolean z2, final boolean z3, boolean z4) {
        String str;
        ArrayList arrayList;
        String str2;
        Object obj;
        MediaController.CropState cropState;
        int i2;
        ChatActivity chatActivity;
        ImageUpdater.AvatarFor avatarFor;
        String str3;
        long j;
        int i3;
        String str4;
        TextureView textureView;
        final PhotoViewer photoViewer = this;
        int i4 = 8;
        char c = 1;
        if (isCaptionOpen() || photoViewer.placeProvider == null || photoViewer.doneButtonPressed) {
            return;
        }
        VideoEditedInfo videoEditedInfo = null;
        if (photoViewer.sendPhotoType == 1) {
            if (!z4 && (avatarFor = photoViewer.setAvatarFor) != null) {
                TLObject tLObject = avatarFor.object;
                if (tLObject instanceof TLRPC.User) {
                    TLRPC.User user = (TLRPC.User) tLObject;
                    str3 = user.first_name;
                    j = user.id;
                } else {
                    str3 = "";
                    j = 0;
                }
                AlertDialog.Builder builder = new AlertDialog.Builder(photoViewer.containerView.getContext());
                builder.setAdditionalHorizontalPadding(AndroidUtilities.dp(8.0f));
                SuggestUserPhotoView suggestUserPhotoView = new SuggestUserPhotoView(photoViewer.containerView.getContext());
                suggestUserPhotoView.setImages(photoViewer.setAvatarFor.object, photoViewer.containerView, photoViewer.photoCropView);
                builder.setTopView(suggestUserPhotoView);
                if (photoViewer.setAvatarFor.type == 1) {
                    builder.setMessage(AndroidUtilities.replaceTags(UserConfig.getInstance(photoViewer.currentAccount).clientUserId == j ? LocaleController.getString("SetUserPhotoSelfAlertMessage", R.string.SetUserPhotoSelfAlertMessage) : LocaleController.formatString("SetUserPhotoAlertMessage", R.string.SetUserPhotoAlertMessage, str3, str3)));
                    if (photoViewer.centerImageIsVideo) {
                        i3 = R.string.SetVideo;
                        str4 = "SetVideo";
                    } else {
                        i3 = R.string.SetPhoto;
                        str4 = "SetPhoto";
                    }
                } else {
                    builder.setMessage(AndroidUtilities.replaceTags(photoViewer.centerImageIsVideo ? LocaleController.formatString("SuggestVideoAlertMessage", R.string.SuggestVideoAlertMessage, str3) : LocaleController.formatString("SuggestPhotoAlertMessage", R.string.SuggestPhotoAlertMessage, str3)));
                    i3 = R.string.SuggestPhotoShort;
                    str4 = "SuggestPhotoShort";
                }
                String string = LocaleController.getString(str4, i3);
                builder.setNegativeButton(LocaleController.getString("Cancel", R.string.Cancel), new AlertDialog.OnButtonClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda111
                    @Override // org.telegram.ui.ActionBar.AlertDialog.OnButtonClickListener
                    public final void onClick(AlertDialog alertDialog, int i5) {
                        PhotoViewer.lambda$sendPressed$75(alertDialog, i5);
                    }
                });
                builder.setPositiveButton(string, new AlertDialog.OnButtonClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda112
                    @Override // org.telegram.ui.ActionBar.AlertDialog.OnButtonClickListener
                    public final void onClick(AlertDialog alertDialog, int i5) {
                        this.f$0.lambda$sendPressed$76(z, i, z2, z3, alertDialog, i5);
                    }
                });
                builder.setDialogButtonColorKey(Theme.key_voipgroup_listeningText);
                AlertDialog alertDialogCreate = builder.create();
                alertDialogCreate.setBlurParams(0.8f, false, true);
                alertDialogCreate.setBackgroundColor(ColorUtils.setAlphaComponent(-15461356, 204));
                alertDialogCreate.show();
                alertDialogCreate.setTextColor(Theme.getColor(Theme.key_voipgroup_nameText));
                alertDialogCreate.setOnDismissListener(photoViewer.new AnonymousClass38());
                if (!photoViewer.isCurrentVideo || (textureView = photoViewer.videoTextureView) == null) {
                    return;
                }
                try {
                    photoViewer.lastFrameBitmap = textureView.getBitmap();
                    ImageView imageView = photoViewer.lastFrameImageView;
                    if (imageView != null) {
                        photoViewer.aspectRatioFrameLayout.removeView(imageView);
                        photoViewer.lastFrameImageView = null;
                    }
                    ImageView imageView2 = new ImageView(photoViewer.videoTextureView.getContext());
                    photoViewer.lastFrameImageView = imageView2;
                    imageView2.setBackground(new BitmapDrawable(photoViewer.lastFrameBitmap));
                    photoViewer.aspectRatioFrameLayout.addView(photoViewer.lastFrameImageView);
                    return;
                } catch (Throwable th) {
                    Bitmap bitmap = photoViewer.currentBitmap;
                    if (bitmap != null) {
                        bitmap.recycle();
                        photoViewer.currentBitmap = null;
                    }
                    FileLog.e(th);
                    return;
                }
            }
            applyCurrentEditMode();
        }
        if (!z2 && (chatActivity = photoViewer.parentChatActivity) != null) {
            TLRPC.Chat currentChat = chatActivity.getCurrentChat();
            if (photoViewer.parentChatActivity.getCurrentUser() != null || ((ChatObject.isChannel(currentChat) && currentChat.megagroup) || !ChatObject.isChannel(currentChat))) {
                MessagesController.getNotificationsSettings(photoViewer.currentAccount).edit().putBoolean(NotificationsSettingsFacade.PROPERTY_SILENT + photoViewer.parentChatActivity.getDialogId(), !z).commit();
            }
        }
        VideoEditedInfo currentVideoEditedInfo = getCurrentVideoEditedInfo();
        if (!photoViewer.imagesArrLocals.isEmpty() && (i2 = photoViewer.currentIndex) >= 0 && i2 < photoViewer.imagesArrLocals.size()) {
            Object obj2 = photoViewer.imagesArrLocals.get(photoViewer.currentIndex);
            if (obj2 instanceof MediaController.MediaEditState) {
                ((MediaController.MediaEditState) obj2).editedInfo = currentVideoEditedInfo;
            }
        }
        ChatActivity chatActivity2 = photoViewer.parentChatActivity;
        if (chatActivity2 != null && chatActivity2.getCurrentChat() != null) {
            boolean z5 = photoViewer.isCurrentVideo || currentVideoEditedInfo != null;
            if (z5 && !ChatObject.canSendVideo(photoViewer.parentChatActivity.getCurrentChat())) {
                BulletinFactory.of(photoViewer.containerView, photoViewer.resourcesProvider).createErrorBulletin(LocaleController.getString(R.string.GlobalAttachVideoRestricted)).show();
                return;
            } else if (!z5 && !ChatObject.canSendPhoto(photoViewer.parentChatActivity.getCurrentChat())) {
                BulletinFactory.of(photoViewer.containerView, photoViewer.resourcesProvider).createErrorBulletin(LocaleController.getString(R.string.GlobalAttachPhotoRestricted)).show();
                return;
            }
        }
        photoViewer.doneButtonPressed = true;
        if (currentVideoEditedInfo != null) {
            long j2 = (long) (currentVideoEditedInfo.estimatedSize * 0.9f);
            if ((j2 > FileLoader.DEFAULT_MAX_FILE_SIZE && !UserConfig.getInstance(photoViewer.currentAccount).isPremium()) || j2 > 4194304000L) {
                if (photoViewer.parentAlert != null) {
                    new LimitReachedBottomSheet(photoViewer.parentAlert.getBaseFragment(), photoViewer.parentAlert.getContainer().getContext(), 6, UserConfig.selectedAccount, null).show();
                    return;
                }
                return;
            }
        }
        if (z2) {
            photoViewer.placeProvider.replaceButtonPressed(photoViewer.currentIndex, currentVideoEditedInfo);
        } else {
            if (photoViewer.sendPhotoType == 11) {
                Object obj3 = photoViewer.imagesArrLocals.get(photoViewer.currentIndex);
                if (obj3 instanceof MediaController.PhotoEntry) {
                    final MediaController.PhotoEntry photoEntry = (MediaController.PhotoEntry) obj3;
                    Bitmap bitmapCreateBitmap = Bitmap.createBitmap(LiteMode.FLAG_CALLS_ANIMATIONS, LiteMode.FLAG_CALLS_ANIMATIONS, Bitmap.Config.ARGB_8888);
                    Canvas canvas = new Canvas(bitmapCreateBitmap);
                    Path path = new Path();
                    RectF rectF = new RectF();
                    rectF.set(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, bitmapCreateBitmap.getWidth(), bitmapCreateBitmap.getHeight());
                    float width = bitmapCreateBitmap.getWidth() / 8;
                    path.addRoundRect(rectF, width, width, Path.Direction.CW);
                    canvas.clipPath(path);
                    int containerViewWidth = getContainerViewWidth();
                    getContainerViewHeight();
                    float fDp = containerViewWidth - AndroidUtilities.dp(20.0f);
                    StickerMakerView stickerMakerView = photoViewer.stickerMakerView;
                    if (stickerMakerView == null || !stickerMakerView.outlineVisible || stickerMakerView.getSourceBitmap() == null) {
                        canvas.save();
                        canvas.translate(bitmapCreateBitmap.getWidth() / 2.0f, bitmapCreateBitmap.getHeight() / 2.0f);
                        canvas.scale(bitmapCreateBitmap.getWidth() / fDp, bitmapCreateBitmap.getHeight() / fDp);
                        photoViewer.applyTransformToOutline(canvas);
                        photoViewer.centerImage.draw(canvas);
                    } else {
                        canvas.save();
                        canvas.translate(bitmapCreateBitmap.getWidth() / 2.0f, bitmapCreateBitmap.getHeight() / 2.0f);
                        canvas.scale(bitmapCreateBitmap.getWidth() / fDp, bitmapCreateBitmap.getHeight() / fDp);
                        photoViewer.applyTransformToOutline(canvas);
                        photoViewer.stickerMakerView.drawOutline(canvas, false, null, false);
                        canvas.restore();
                        canvas.save();
                        canvas.translate(bitmapCreateBitmap.getWidth() / 2.0f, bitmapCreateBitmap.getHeight() / 2.0f);
                        canvas.scale(bitmapCreateBitmap.getWidth() / fDp, bitmapCreateBitmap.getHeight() / fDp);
                        photoViewer.applyTransformToOutline(canvas);
                        photoViewer.centerImage.draw(canvas);
                        canvas.restore();
                        canvas.save();
                        canvas.translate(bitmapCreateBitmap.getWidth() / 2.0f, bitmapCreateBitmap.getHeight() / 2.0f);
                        canvas.scale(bitmapCreateBitmap.getWidth() / fDp, bitmapCreateBitmap.getHeight() / fDp);
                        photoViewer.applyTransformToOutline(canvas);
                        photoViewer.stickerMakerView.drawOutline(canvas, true, null, false);
                    }
                    canvas.restore();
                    if (photoViewer.paintingOverlay != null) {
                        canvas.save();
                        canvas.translate(bitmapCreateBitmap.getWidth() / 2.0f, bitmapCreateBitmap.getHeight() / 2.0f);
                        canvas.scale(bitmapCreateBitmap.getWidth() / fDp, bitmapCreateBitmap.getHeight() / fDp);
                        photoViewer.applyTransformToOutline(canvas);
                        canvas.translate((-photoViewer.centerImage.getImageWidth()) / 2.0f, (-photoViewer.centerImage.getImageHeight()) / 2.0f);
                        canvas.scale(photoViewer.centerImage.getImageWidth() / photoViewer.paintingOverlay.getMeasuredWidth(), photoViewer.centerImage.getImageHeight() / photoViewer.paintingOverlay.getMeasuredHeight());
                        photoViewer.paintingOverlay.drawChildren = !hasAnimatedMediaEntities();
                        photoViewer.paintingOverlay.draw(canvas);
                        photoViewer.paintingOverlay.drawChildren = true;
                        canvas.restore();
                    }
                    if (hasAnimatedMediaEntities()) {
                        Matrix matrix = new Matrix();
                        matrix.reset();
                        float f = fDp / 2.0f;
                        matrix.preTranslate(f, f);
                        photoViewer.applyTransformToMatrix(matrix);
                        matrix.preTranslate((-photoViewer.centerImage.getImageWidth()) / 2.0f, (-photoViewer.centerImage.getImageHeight()) / 2.0f);
                        matrix.preScale(photoViewer.centerImage.getImageWidth(), photoViewer.centerImage.getImageHeight());
                        ArrayList<VideoEditedInfo.MediaEntity> arrayList2 = new ArrayList<>();
                        Iterator<VideoEditedInfo.MediaEntity> it = photoEntry.mediaEntities.iterator();
                        String strFindAnimatedEmojiEmoticon = null;
                        while (it.hasNext()) {
                            VideoEditedInfo.MediaEntity mediaEntityCopy = it.next().copy();
                            float f2 = mediaEntityCopy.x;
                            float f3 = mediaEntityCopy.y;
                            float f4 = mediaEntityCopy.width + f2;
                            float f5 = mediaEntityCopy.height + f3;
                            Iterator<VideoEditedInfo.MediaEntity> it2 = it;
                            float[] fArr = new float[i4];
                            fArr[0] = f2;
                            fArr[c] = f3;
                            fArr[2] = f4;
                            fArr[3] = f3;
                            fArr[4] = f4;
                            fArr[5] = f5;
                            fArr[6] = f2;
                            fArr[7] = f5;
                            matrix.mapPoints(fArr);
                            mediaEntityCopy.width = ((float) Math.sqrt(Math.pow(fArr[0] - fArr[2], 2.0d) + Math.pow(fArr[c] - fArr[3], 2.0d))) / fDp;
                            float fSqrt = ((float) Math.sqrt(Math.pow(fArr[0] - fArr[6], 2.0d) + Math.pow(fArr[1] - fArr[7], 2.0d))) / fDp;
                            mediaEntityCopy.height = fSqrt;
                            mediaEntityCopy.x = (((fArr[0] + fArr[4]) / 2.0f) / fDp) - (mediaEntityCopy.width / 2.0f);
                            mediaEntityCopy.y = (((fArr[1] + fArr[5]) / 2.0f) / fDp) - (fSqrt / 2.0f);
                            mediaEntityCopy.scale = 1.0f;
                            mediaEntityCopy.customTextView = true;
                            if (photoEntry.isCropped && (cropState = photoEntry.cropState) != null) {
                                double d = mediaEntityCopy.rotation;
                                double d2 = cropState.transformRotation / 180.0f;
                                Double.isNaN(d2);
                                Double.isNaN(d);
                                mediaEntityCopy.rotation = (float) (d - (d2 * 3.141592653589793d));
                            }
                            double d3 = mediaEntityCopy.rotation;
                            photoViewer = this;
                            double d4 = photoViewer.rotate / 180.0f;
                            Double.isNaN(d4);
                            Double.isNaN(d3);
                            mediaEntityCopy.rotation = (float) (d3 - (d4 * 3.141592653589793d));
                            arrayList2.add(mediaEntityCopy);
                            TLRPC.Document document = mediaEntityCopy.document;
                            if (document == null || strFindAnimatedEmojiEmoticon != null) {
                                obj = null;
                            } else {
                                obj = null;
                                strFindAnimatedEmojiEmoticon = MessageObject.findAnimatedEmojiEmoticon(document, null);
                            }
                            it = it2;
                            i4 = 8;
                            c = 1;
                        }
                        videoEditedInfo = new VideoEditedInfo();
                        videoEditedInfo.isPhoto = true;
                        videoEditedInfo.resultWidth = LiteMode.FLAG_CALLS_ANIMATIONS;
                        videoEditedInfo.originalWidth = LiteMode.FLAG_CALLS_ANIMATIONS;
                        videoEditedInfo.resultHeight = LiteMode.FLAG_CALLS_ANIMATIONS;
                        videoEditedInfo.originalHeight = LiteMode.FLAG_CALLS_ANIMATIONS;
                        videoEditedInfo.mediaEntities = arrayList2;
                        long jClamp = Utilities.clamp(photoEntry.averageDuration, 2999L, 800L);
                        videoEditedInfo.estimatedDuration = jClamp;
                        videoEditedInfo.originalDuration = jClamp;
                        videoEditedInfo.bitrate = 200000;
                        videoEditedInfo.framerate = 30;
                        videoEditedInfo.isSticker = true;
                        videoEditedInfo.estimatedSize = 262144L;
                        str = strFindAnimatedEmojiEmoticon;
                    } else {
                        str = null;
                    }
                    Bitmap.CompressFormat compressFormat = Bitmap.CompressFormat.WEBP;
                    float f6 = LiteMode.FLAG_CALLS_ANIMATIONS;
                    final String string2 = FileLoader.getInstance(UserConfig.selectedAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmapCreateBitmap, compressFormat, f6, f6, 100, false, 101, 101), "webp", true).toString();
                    if (videoEditedInfo != null) {
                        videoEditedInfo.originalPath = string2;
                    }
                    if (photoViewer.selectedEmojis == null) {
                        photoViewer.selectedEmojis = new ArrayList();
                    }
                    if (photoViewer.selectedEmojis.isEmpty()) {
                        String str5 = photoViewer.stickerMakerView.detectedEmoji;
                        if (str5 == null || Emoji.getEmojiDrawable(str5) == null) {
                            arrayList = photoViewer.selectedEmojis;
                            if (str != null) {
                                arrayList.add(str);
                            } else {
                                str2 = "";
                            }
                        } else {
                            arrayList = photoViewer.selectedEmojis;
                            str2 = photoViewer.stickerMakerView.detectedEmoji;
                        }
                        arrayList.add(str2);
                    }
                    photoViewer.doneButtonPressed = false;
                    final VideoEditedInfo videoEditedInfo2 = videoEditedInfo;
                    ContentPreviewViewer.getInstance().showCustomStickerActions(string2, videoEditedInfo, photoViewer.stickerMakerView, photoViewer.selectedEmojis, new ContentPreviewViewer.ContentPreviewViewerDelegate() { // from class: org.telegram.ui.PhotoViewer.39
                        private void generateThumb() {
                            ContentPreviewViewer contentPreviewViewer = ContentPreviewViewer.getInstance();
                            if (photoEntry.thumbPath != null) {
                                try {
                                    new File(photoEntry.thumbPath).delete();
                                } catch (Exception e) {
                                    FileLog.e(e);
                                }
                                photoEntry.thumbPath = null;
                            }
                            Bitmap bitmapCreateBitmap2 = Bitmap.createBitmap(LiteMode.FLAG_CALLS_ANIMATIONS, LiteMode.FLAG_CALLS_ANIMATIONS, Bitmap.Config.ARGB_8888);
                            Canvas canvas2 = new Canvas(bitmapCreateBitmap2);
                            ImageReceiver imageReceiver = contentPreviewViewer.centerImage;
                            if (imageReceiver != null) {
                                imageReceiver.setAlpha(1.0f);
                                contentPreviewViewer.centerImage.setImageCoords(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, bitmapCreateBitmap2.getWidth(), bitmapCreateBitmap2.getHeight());
                                contentPreviewViewer.centerImage.draw(canvas2);
                            }
                            if (contentPreviewViewer.paintingOverlay != null) {
                                canvas2.save();
                                canvas2.scale(bitmapCreateBitmap2.getWidth() / contentPreviewViewer.paintingOverlay.getWidth(), bitmapCreateBitmap2.getHeight() / contentPreviewViewer.paintingOverlay.getHeight());
                                contentPreviewViewer.paintingOverlay.setAlpha(1.0f);
                                Path path2 = new Path();
                                path2.rewind();
                                RectF rectF2 = AndroidUtilities.rectTmp;
                                rectF2.set(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, contentPreviewViewer.paintingOverlay.getWidth(), contentPreviewViewer.paintingOverlay.getHeight());
                                path2.addRoundRect(rectF2, contentPreviewViewer.paintingOverlay.getWidth() / 8.0f, contentPreviewViewer.paintingOverlay.getHeight() / 8.0f, Path.Direction.CW);
                                canvas2.clipPath(path2);
                                contentPreviewViewer.paintingOverlay.draw(canvas2);
                                canvas2.restore();
                            }
                            photoEntry.thumbPath = FileLoader.getInstance(PhotoViewer.this.currentAccount).getPathToAttach(ImageLoader.scaleAndSaveImage(bitmapCreateBitmap2, PhotoViewer.this.getCompressFormat(), 512.0f, 512.0f, 83, false, 101, 101), true).toString();
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public void addToFavoriteSelected(String str6) {
                            PhotoViewer.this.stickerEmptySent = true;
                            generateThumb();
                            PhotoViewer.this.stickerMakerView.uploadStickerFile(string2, videoEditedInfo2, str6, null, true, null, null, photoEntry.thumbPath, null, null);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ boolean can() {
                            return ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$can(this);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ boolean canDeleteSticker(TLRPC.Document document2) {
                            return ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$canDeleteSticker(this, document2);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ boolean canEditSticker() {
                            return ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$canEditSticker(this);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ boolean canSchedule() {
                            return ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$canSchedule(this);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ Boolean canSetAsStatus(TLRPC.Document document2) {
                            return ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$canSetAsStatus(this, document2);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ void copyEmoji(TLRPC.Document document2) {
                            ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$copyEmoji(this, document2);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ void deleteSticker(TLRPC.Document document2) {
                            ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$deleteSticker(this, document2);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ void editSticker(TLRPC.Document document2) {
                            ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$editSticker(this, document2);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public long getDialogId() {
                            return PhotoViewer.this.currentDialogId;
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ String getQuery(boolean z6) {
                            return ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$getQuery(this, z6);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ void gifAddedOrDeleted() {
                            ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$gifAddedOrDeleted(this);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ boolean isInScheduleMode() {
                            return ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$isInScheduleMode(this);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ boolean isPhotoEditor() {
                            return ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$isPhotoEditor(this);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public boolean isReplacedSticker() {
                            return PhotoViewer.this.replacedSticker != null;
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public boolean isSettingIntroSticker() {
                            return PhotoViewer.this.customStickerHandler != null;
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public boolean isStickerEditor() {
                            return true;
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ boolean needCopy(TLRPC.Document document2) {
                            return ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$needCopy(this, document2);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ boolean needMenu() {
                            return ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$needMenu(this);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ boolean needOpen() {
                            return ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$needOpen(this);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ boolean needRemove() {
                            return ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$needRemove(this);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ boolean needRemoveFromRecent(TLRPC.Document document2) {
                            return ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$needRemoveFromRecent(this, document2);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ boolean needSend(int i5) {
                            return ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$needSend(this, i5);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public void newStickerPackSelected(CharSequence charSequence, String str6, Utilities.Callback callback) {
                            PhotoViewer.this.stickerEmptySent = true;
                            generateThumb();
                            PhotoViewer.this.stickerMakerView.uploadStickerFile(string2, videoEditedInfo2, str6, charSequence, false, null, null, photoEntry.thumbPath, callback, null);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ void openSet(TLRPC.InputStickerSet inputStickerSet, boolean z6) {
                            ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$openSet(this, inputStickerSet, z6);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ void remove(SendMessagesHelper.ImportingSticker importingSticker) {
                            ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$remove(this, importingSticker);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ void removeFromRecent(TLRPC.Document document2) {
                            ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$removeFromRecent(this, document2);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ void resetTouch() {
                            ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$resetTouch(this);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ void sendEmoji(TLRPC.Document document2) {
                            ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$sendEmoji(this, document2);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ void sendGif(Object obj4, Object obj5, boolean z6, int i5) {
                            ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$sendGif(this, obj4, obj5, z6, i5);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public void sendSticker() {
                            if (PhotoViewer.this.placeProvider == null) {
                                return;
                            }
                            PhotoViewer.this.stickerEmptySent = true;
                            generateThumb();
                            photoEntry.imagePath = string2;
                            PhotoViewer.this.placeProvider.sendButtonPressed(PhotoViewer.this.currentIndex, videoEditedInfo2, z, i, z3);
                            NotificationCenter.getInstance(UserConfig.selectedAccount).postNotificationNameOnUIThread(NotificationCenter.customStickerCreated, Boolean.TRUE);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ void sendSticker(TLRPC.Document document2, String str6, Object obj4, boolean z6, int i5) {
                            ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$sendSticker(this, document2, str6, obj4, z6, i5);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public /* synthetic */ void setAsEmojiStatus(TLRPC.Document document2, Integer num) {
                            ContentPreviewViewer.ContentPreviewViewerDelegate.CC.$default$setAsEmojiStatus(this, document2, num);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public void setIntroSticker(String str6) {
                            PhotoViewer.this.stickerEmptySent = true;
                            generateThumb();
                            PhotoViewer photoViewer2 = PhotoViewer.this;
                            photoViewer2.stickerMakerView.uploadStickerFile(string2, videoEditedInfo2, str6, null, false, null, null, photoEntry.thumbPath, null, photoViewer2.customStickerHandler);
                        }

                        @Override // org.telegram.ui.ContentPreviewViewer.ContentPreviewViewerDelegate
                        public void stickerSetSelected(TLRPC.StickerSet stickerSet, String str6) {
                            PhotoViewer.this.stickerEmptySent = true;
                            generateThumb();
                            PhotoViewer photoViewer2 = PhotoViewer.this;
                            photoViewer2.stickerMakerView.uploadStickerFile(string2, videoEditedInfo2, str6, null, false, stickerSet, photoViewer2.replacedSticker, photoEntry.thumbPath, null, null);
                        }
                    });
                    return;
                }
            }
            photoViewer.placeProvider.sendButtonPressed(photoViewer.currentIndex, currentVideoEditedInfo, z, i, z3);
        }
        if (photoViewer.closePhotoAfterSelect) {
            if (photoViewer.closePhotoAfterSelectWithAnimation) {
                AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda113
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$sendPressed$77();
                    }
                }, 200L);
            } else {
                photoViewer.closePhoto(false, false);
            }
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void setCaptionHwLayerEnabled(boolean z) {
        if (this.captionHwLayerEnabled != z) {
            this.captionHwLayerEnabled = z;
            this.captionTextViewSwitcher.setLayerType(2, null);
            this.captionTextViewSwitcher.getCurrentView().setLayerType(2, null);
            this.captionTextViewSwitcher.getNextView().setLayerType(2, null);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void setCropBitmap() {
        VideoEditTextureView videoEditTextureView;
        if (this.cropInitied || this.sendPhotoType != 1) {
            return;
        }
        if (!this.isCurrentVideo || ((videoEditTextureView = (VideoEditTextureView) this.videoTextureView) != null && videoEditTextureView.getVideoWidth() > 0 && videoEditTextureView.getVideoHeight() > 0)) {
            this.cropInitied = true;
            Bitmap bitmap = this.centerImage.getBitmap();
            int orientation = this.centerImage.getOrientation();
            if (bitmap == null) {
                bitmap = this.animatingImageView.getBitmap();
                orientation = this.animatingImageView.getOrientation();
            }
            Bitmap bitmap2 = bitmap;
            int i = orientation;
            if (bitmap2 == null && this.videoTextureView == null) {
                return;
            }
            this.photoCropView.setBitmap(bitmap2, i, false, false, this.paintingOverlay, this.cropTransform, this.isCurrentVideo ? (VideoEditTextureView) this.videoTextureView : null, this.editState.cropState);
        }
    }

    private void setCurrentCaption(MessageObject messageObject, CharSequence charSequence, boolean z, boolean z2) {
        int i;
        boolean z3;
        CharSequence spannableStringBuilder;
        TLRPC.Message message;
        CharSequence charSequenceCloneSpans = AnimatedEmojiSpan.cloneSpans(charSequence, 3);
        showEditCaption(this.editing, z2);
        if (!this.editing) {
            if (this.sendPhotoType != 1) {
                this.captionEdit.setVisibility(8);
                this.topCaptionEdit.setVisibility(8);
                if (!this.needCaptionLayout) {
                    if (this.captionScrollView == null) {
                        FrameLayout frameLayout = new FrameLayout(this.containerView.getContext());
                        this.captionContainer = frameLayout;
                        this.captionTextViewSwitcher.setContainer(frameLayout);
                        CaptionScrollView captionScrollView = new CaptionScrollView(this.containerView.getContext(), this.captionTextViewSwitcher, this.captionContainer) { // from class: org.telegram.ui.PhotoViewer.71
                            @Override // android.view.View
                            public void invalidate() {
                                ViewPropertyAnimator duration;
                                super.invalidate();
                                if (PhotoViewer.this.isActionBarVisible) {
                                    int scrollY = getScrollY();
                                    float translationY = PhotoViewer.this.captionTextViewSwitcher.getTranslationY();
                                    float f = BitmapDescriptorFactory.HUE_RED;
                                    boolean z4 = scrollY == 0 && translationY == BitmapDescriptorFactory.HUE_RED;
                                    boolean z5 = scrollY == 0 && translationY == BitmapDescriptorFactory.HUE_RED;
                                    if (!z4) {
                                        int y = PhotoViewer.this.photoProgressViews[0].getY() + PhotoViewer.this.photoProgressViews[0].size;
                                        int top = (((PhotoViewer.this.captionContainer.getTop() + ((int) translationY)) - scrollY) + ((isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0) + ActionBar.getCurrentActionBarHeight())) - AndroidUtilities.dp(12.0f);
                                        z5 = top > ((int) PhotoViewer.this.fullscreenButton[0].getY()) + AndroidUtilities.dp(32.0f);
                                        z4 = top > y;
                                    }
                                    if (PhotoViewer.this.allowShowFullscreenButton) {
                                        if (PhotoViewer.this.fullscreenButton[0].getTag() != null && ((Integer) PhotoViewer.this.fullscreenButton[0].getTag()).intValue() == 3 && z5) {
                                            PhotoViewer.this.fullscreenButton[0].setTag(2);
                                            duration = PhotoViewer.this.fullscreenButton[0].animate().alpha(1.0f).setDuration(150L).setListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.71.1
                                                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                                                public void onAnimationEnd(Animator animator) {
                                                    PhotoViewer.this.fullscreenButton[0].setTag(null);
                                                }
                                            });
                                        } else if (PhotoViewer.this.fullscreenButton[0].getTag() == null && !z5) {
                                            PhotoViewer.this.fullscreenButton[0].setTag(3);
                                            duration = PhotoViewer.this.fullscreenButton[0].animate().alpha(BitmapDescriptorFactory.HUE_RED).setListener(null).setDuration(150L);
                                        }
                                        duration.start();
                                    }
                                    PhotoProgressView photoProgressView = PhotoViewer.this.photoProgressViews[0];
                                    if (z4) {
                                        f = 1.0f;
                                    }
                                    photoProgressView.setIndexedAlpha(2, f, true);
                                }
                            }

                            @Override // org.telegram.ui.PhotoViewer.CaptionScrollView
                            protected boolean isStatusBarVisible() {
                                return Build.VERSION.SDK_INT >= 21 && !PhotoViewer.this.inBubbleMode;
                            }
                        };
                        this.captionScrollView = captionScrollView;
                        this.captionTextViewSwitcher.setScrollView(captionScrollView);
                        this.captionContainer.setClipChildren(false);
                        this.captionScrollView.addView(this.captionContainer, new ViewGroup.LayoutParams(-1, -2));
                        this.containerView.addView(this.captionScrollView, LayoutHelper.createFrame(-1, -1, 80));
                    }
                    if (this.captionTextViewSwitcher.getParent() != this.captionContainer) {
                        this.pickerView.removeView(this.captionTextViewSwitcher);
                        this.captionTextViewSwitcher.setMeasureAllChildren(true);
                        this.captionContainer.addView(this.captionTextViewSwitcher, -1, -2);
                        this.videoPreviewFrame.bringToFront();
                    }
                    if (messageObject == null || !messageObject.isSponsored()) {
                        FrameLayout frameLayout2 = this.adButtonView;
                        if (frameLayout2 != null) {
                            AndroidUtilities.removeFromParent(frameLayout2);
                            this.captionTextViewSwitcher.setPadding(0, 0, 0, 0);
                        }
                    } else {
                        createAdButtonView();
                        AndroidUtilities.removeFromParent(this.adButtonView);
                        this.adButtonTextView.setText(messageObject.sponsoredButtonText);
                        this.captionContainer.addView(this.adButtonView, LayoutHelper.createFrame(-1, 44.0f, 87, 16.0f, BitmapDescriptorFactory.HUE_RED, 16.0f, 12.0f));
                        this.captionTextViewSwitcher.setPadding(0, 0, 0, AndroidUtilities.dp(64.0f));
                        this.adButtonView.bringToFront();
                    }
                } else if (this.captionTextViewSwitcher.getParent() != this.pickerView) {
                    FrameLayout frameLayout3 = this.captionContainer;
                    if (frameLayout3 != null) {
                        frameLayout3.removeView(this.captionTextViewSwitcher);
                    }
                    this.captionTextViewSwitcher.setMeasureAllChildren(false);
                    this.pickerView.addView(this.captionTextViewSwitcher, LayoutHelper.createFrame(-1, -2.0f, 83, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 76.0f, 48.0f));
                }
                boolean zIsEmpty = TextUtils.isEmpty(charSequenceCloneSpans);
                boolean zIsEmpty2 = TextUtils.isEmpty(this.captionTextViewSwitcher.getCurrentView().getText());
                CaptionTextViewSwitcher captionTextViewSwitcher = this.captionTextViewSwitcher;
                TextView nextView = z2 ? captionTextViewSwitcher.getNextView() : captionTextViewSwitcher.getCurrentView();
                if (!this.isCurrentVideo) {
                    int maxLines = nextView.getMaxLines();
                    if (maxLines == 1) {
                        this.captionTextViewSwitcher.getCurrentView().setSingleLine(false);
                        this.captionTextViewSwitcher.getNextView().setSingleLine(false);
                    }
                    if (this.needCaptionLayout) {
                        Point point = AndroidUtilities.displaySize;
                        i = point.x > point.y ? 5 : 10;
                    } else {
                        i = Integer.MAX_VALUE;
                    }
                    if (maxLines != i) {
                        this.captionTextViewSwitcher.getCurrentView().setMaxLines(i);
                        this.captionTextViewSwitcher.getNextView().setMaxLines(i);
                        this.captionTextViewSwitcher.getCurrentView().setEllipsize(null);
                        this.captionTextViewSwitcher.getNextView().setEllipsize(null);
                    }
                } else if (nextView.getMaxLines() != 1) {
                    this.captionTextViewSwitcher.getCurrentView().setMaxLines(1);
                    this.captionTextViewSwitcher.getNextView().setMaxLines(1);
                    this.captionTextViewSwitcher.getCurrentView().setSingleLine(true);
                    this.captionTextViewSwitcher.getNextView().setSingleLine(true);
                    TextView currentView = this.captionTextViewSwitcher.getCurrentView();
                    TextUtils.TruncateAt truncateAt = TextUtils.TruncateAt.END;
                    currentView.setEllipsize(truncateAt);
                    this.captionTextViewSwitcher.getNextView().setEllipsize(truncateAt);
                }
                nextView.setScrollX(0);
                boolean z4 = this.needCaptionLayout;
                this.dontChangeCaptionPosition = !z4 && z2 && zIsEmpty;
                if (!z4) {
                    this.captionScrollView.dontChangeTopMargin = false;
                }
                if (z2) {
                    if (Build.VERSION.SDK_INT >= 23) {
                        TransitionManager.endTransitions(z4 ? this.pickerView : this.captionScrollView);
                    }
                    if (this.needCaptionLayout) {
                        TransitionSet transitionSet = new TransitionSet();
                        transitionSet.setOrdering(0);
                        transitionSet.addTransition(new ChangeBounds());
                        transitionSet.addTransition(new Fade(2));
                        transitionSet.addTransition(new Fade(1));
                        transitionSet.setDuration(200L);
                        TransitionManager.beginDelayedTransition(this.pickerView, transitionSet);
                    } else {
                        TransitionSet duration = new TransitionSet().addTransition(new AnonymousClass73(2, zIsEmpty2, zIsEmpty)).addTransition(new AnonymousClass72(1, zIsEmpty2, zIsEmpty)).setDuration(200L);
                        if (!zIsEmpty2) {
                            this.captionScrollView.dontChangeTopMargin = true;
                            duration.addTransition(new AnonymousClass74());
                        }
                        if (zIsEmpty2 && !zIsEmpty) {
                            duration.addTarget((View) this.captionTextViewSwitcher);
                        }
                        TransitionManager.beginDelayedTransition(this.captionScrollView, duration);
                    }
                    z3 = true;
                } else {
                    this.captionTextViewSwitcher.getCurrentView().setText((CharSequence) null);
                    CaptionScrollView captionScrollView2 = this.captionScrollView;
                    if (captionScrollView2 != null) {
                        captionScrollView2.scrollTo(0, 0);
                    }
                    z3 = false;
                }
                if (!zIsEmpty) {
                    Theme.createChatResources(null, true);
                    if (messageObject == null || !this.captionTranslated || (message = messageObject.messageOwner) == null || message.translatedText == null || !TextUtils.equals(message.translatedToLanguage, TranslateAlert2.getToLanguage())) {
                        if (messageObject == null || messageObject.messageOwner.entities.isEmpty()) {
                            spannableStringBuilder = new SpannableStringBuilder(charSequenceCloneSpans);
                        } else {
                            spannableStringBuilder = new SpannableString(charSequenceCloneSpans);
                            messageObject.addEntitiesToText(spannableStringBuilder, true, false);
                            if (messageObject.isVideo()) {
                                MessageObject.addUrlsByPattern(messageObject.isOutOwner(), spannableStringBuilder, false, 3, (int) messageObject.getDuration(), false);
                            }
                        }
                        charSequenceCloneSpans = Emoji.replaceEmoji(spannableStringBuilder, nextView.getPaint().getFontMetricsInt(), false);
                    }
                    if (messageObject != null && messageObject.isSponsored()) {
                        charSequenceCloneSpans = sponsoredCaption(messageObject, charSequenceCloneSpans);
                    }
                    this.captionTextViewSwitcher.setTag(charSequenceCloneSpans);
                    try {
                        this.captionTextViewSwitcher.setText(charSequenceCloneSpans, z2, this.lastCaptionTranslating != z);
                        CaptionScrollView captionScrollView3 = this.captionScrollView;
                        if (captionScrollView3 != null) {
                            captionScrollView3.updateTopMargin();
                        }
                    } catch (Exception e) {
                        FileLog.e(e);
                    }
                    nextView.setScrollY(0);
                    nextView.setTextColor(-1);
                    this.captionTextViewSwitcher.setVisibility(this.isActionBarVisible && (!this.isCurrentVideo || this.pickerView.getVisibility() == 0 || this.pageBlocksAdapter != null) ? 0 : 4);
                } else if (this.needCaptionLayout) {
                    this.captionTextViewSwitcher.setText(LocaleController.getString("AddCaption", R.string.AddCaption), z2);
                    this.captionTextViewSwitcher.getCurrentView().setTextColor(-1291845633);
                    this.captionTextViewSwitcher.setTag("empty");
                    this.captionTextViewSwitcher.setVisibility(0);
                } else {
                    this.captionTextViewSwitcher.setText(null, z2);
                    this.captionTextViewSwitcher.getCurrentView().setTextColor(-1);
                    this.captionTextViewSwitcher.setVisibility(4, !z3 || zIsEmpty2);
                    this.captionTextViewSwitcher.setTag(null);
                }
                if (this.captionTextViewSwitcher.getCurrentView() instanceof CaptionTextView) {
                    ((CaptionTextView) this.captionTextViewSwitcher.getCurrentView()).setLoading(z);
                }
                this.lastCaptionTranslating = !zIsEmpty && z;
                return;
            }
        }
        getCaptionView().setText(charSequenceCloneSpans);
        this.captionTextViewSwitcher.setVisibility(8);
    }

    private void setDoubleTapEnabled(boolean z) {
        this.doubleTapEnabled = z;
        this.gestureDetector.setOnDoubleTapListener(z ? this : null);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void setImageIndex(int i) throws Resources.NotFoundException {
        setImageIndex(i, true, false);
    }

    private void setImageIndex(int i, boolean z, boolean z2) throws Resources.NotFoundException {
        setImageIndex(i, z, z2, false);
    }

    /* JADX WARN: Multi-variable type inference failed */
    /* JADX WARN: Removed duplicated region for block: B:116:0x0203  */
    /* JADX WARN: Removed duplicated region for block: B:222:0x047a  */
    /* JADX WARN: Removed duplicated region for block: B:228:0x04a4  */
    /* JADX WARN: Removed duplicated region for block: B:232:0x04b4  */
    /* JADX WARN: Removed duplicated region for block: B:234:0x04b7  */
    /* JADX WARN: Removed duplicated region for block: B:251:0x0538  */
    /* JADX WARN: Removed duplicated region for block: B:253:0x053d A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:256:0x0546  */
    /* JADX WARN: Removed duplicated region for block: B:257:0x0548  */
    /* JADX WARN: Removed duplicated region for block: B:262:0x055d  */
    /* JADX WARN: Removed duplicated region for block: B:265:0x0569 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:283:0x0687  */
    /* JADX WARN: Removed duplicated region for block: B:285:0x068e A[LOOP:0: B:284:0x068c->B:285:0x068e, LOOP_END] */
    /* JADX WARN: Removed duplicated region for block: B:288:0x069c  */
    /* JADX WARN: Removed duplicated region for block: B:302:0x06c2  */
    /* JADX WARN: Removed duplicated region for block: B:327:? A[RETURN, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:46:0x00c6  */
    /* JADX WARN: Type inference failed for: r3v22 */
    /* JADX WARN: Type inference failed for: r3v23, types: [boolean, int] */
    /* JADX WARN: Type inference failed for: r3v24 */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void setImageIndex(int i, boolean z, boolean z2, boolean z3) throws Resources.NotFoundException {
        int i2;
        boolean z4;
        boolean z5;
        Uri uri;
        boolean z6;
        boolean z7;
        Uri uriFromFile;
        String str;
        boolean z8;
        float f;
        float f2;
        boolean z9;
        float f3;
        float f4;
        CropTransform cropTransform;
        float f5;
        float f6;
        float f7;
        int i3;
        float f8;
        float f9;
        float f10;
        boolean z10;
        boolean zEquals;
        PlaceProviderObject placeProviderObject;
        PlaceProviderObject placeForPhoto;
        boolean z11;
        boolean z12;
        long j;
        int i4;
        int i5;
        int selectedCount;
        int i6;
        MessageObject messageObject;
        MessageObject messageObject2;
        char c;
        ?? r3;
        char c2;
        MessageObject messageObject3;
        MessageObject messageObject4;
        MediaController.CropState cropState;
        ImageReceiver.BitmapHolder bitmapHolder;
        boolean z13 = false;
        if ((!z3 && this.currentIndex == i) || this.placeProvider == null) {
            return;
        }
        if (!z && (bitmapHolder = this.currentThumb) != null) {
            bitmapHolder.release();
            this.currentThumb = null;
        }
        this.currentFileNames[0] = getFileName(i);
        this.currentFileNames[1] = getFileName(i + 1);
        this.currentFileNames[2] = getFileName(i - 1);
        this.placeProvider.willSwitchFromPhoto(this.currentMessageObject, getFileLocation(this.currentFileLocation), this.currentIndex);
        this.lastPhotoSetTime = SystemClock.elapsedRealtime();
        int i7 = this.currentIndex;
        this.currentIndex = i;
        setIsAboutToSwitchToIndex(i, z, z2);
        CropTransform cropTransformClone = this.cropTransform.clone();
        EditState editState = this.editState;
        MediaController.CropState cropStateM380clone = (editState == null || (cropState = editState.cropState) == null) ? null : cropState.clone();
        boolean z14 = this.centerImageIsVideo;
        this.editState.reset();
        if (!this.imagesArr.isEmpty()) {
            int i8 = this.currentIndex;
            if (i8 < 0 || i8 >= this.imagesArr.size()) {
                closePhoto(false, false);
                return;
            }
            MessageObject messageObject5 = (MessageObject) this.imagesArr.get(this.currentIndex);
            z4 = z && (messageObject4 = this.currentMessageObject) != null && messageObject4.getId() == messageObject5.getId();
            if (z4) {
                messageObject5.putInDownloadsStore = this.currentMessageObject.putInDownloadsStore;
            }
            if (this.ads == null || messageObject5 == null || ((messageObject3 = this.currentMessageObject) != null && messageObject3.getDialogId() != messageObject5.getDialogId())) {
                VideoAds videoAds = this.ads;
                if (videoAds != null) {
                    videoAds.stop();
                    this.ads = null;
                }
                if (messageObject5 != null) {
                    i2 = i7;
                    VideoAds videoAdsMake = VideoAds.make(messageObject5.currentAccount, messageObject5.getDialogId(), messageObject5.getId(), BulletinFactory.of(this.containerView, this.resourcesProvider));
                    this.ads = videoAdsMake;
                    VideoPlayer videoPlayer = this.videoPlayer;
                    videoAdsMake.setWaitingPaused(videoPlayer == null || (videoPlayer.isPlaying() && this.videoPlayer.getPlaybackState() == 3));
                    this.ads.setPauseOnPopupCallback(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda76
                        @Override // java.lang.Runnable
                        public final void run() {
                            this.f$0.lambda$setImageIndex$125();
                        }
                    });
                } else {
                    i2 = i7;
                }
                this.currentMessageObject = messageObject5;
                if (messageObject5 != null) {
                    messageObject5.openedInViewer = true;
                }
                boolean zIsVideo = messageObject5.isVideo();
                if (messageObject5.isSponsored()) {
                    AndroidUtilities.cancelRunOnUIThread(this.hideActionBarRunnable);
                }
                if (this.sharedMediaType == 1) {
                    boolean zCanPreviewDocument = messageObject5.canPreviewDocument();
                    this.canZoom = zCanPreviewDocument;
                    if (zCanPreviewDocument) {
                        if (this.allowShare) {
                            this.galleryButton.setVisibility(0);
                            this.galleryGap.setVisibility(0);
                        } else {
                            this.galleryButton.setVisibility(8);
                            this.galleryGap.setVisibility(8);
                        }
                        setDoubleTapEnabled(true);
                    } else {
                        this.galleryButton.setVisibility(8);
                        this.galleryGap.setVisibility(8);
                        setDoubleTapEnabled(false);
                    }
                }
                if (zIsVideo || this.isEmbedVideo) {
                    this.speedItem.setVisibility(0);
                    this.videoItem.setVisibility(0);
                    this.menuItem.showSubItem(17);
                    this.speedGap.setVisibility(this.menuItem.getVisibleSubItemsCount() > 1 ? 0 : 8);
                } else {
                    this.speedItem.setVisibility(8);
                    this.videoItem.setVisibility(8);
                    this.speedGap.setVisibility(8);
                    this.menuItem.checkHideMenuItem();
                }
                updateQualityItems();
                z13 = zIsVideo;
            }
            setMenuItemIcon(z5, z6);
            placeProviderObject = this.currentPlaceObject;
            if (placeProviderObject != null) {
                if (this.animationInProgress == 0) {
                    placeProviderObject.imageReceiver.setVisible(z6, z6);
                } else {
                    this.showAfterAnimation = placeProviderObject;
                }
            }
            placeForPhoto = this.placeProvider.getPlaceForPhoto(this.currentMessageObject, getFileLocation(this.currentFileLocation), this.currentIndex, false, false);
            this.currentPlaceObject = placeForPhoto;
            if (placeForPhoto == null) {
                z11 = false;
            } else if (this.animationInProgress == 0) {
                z11 = false;
                placeForPhoto.imageReceiver.setVisible(false, true);
            } else {
                z11 = false;
                this.hideAfterAnimation = placeForPhoto;
            }
            if (z4) {
                z12 = false;
                j = 0;
            } else {
                this.draggingDown = z11;
                this.translationX = BitmapDescriptorFactory.HUE_RED;
                this.translationY = BitmapDescriptorFactory.HUE_RED;
                this.animateToX = BitmapDescriptorFactory.HUE_RED;
                this.animateToY = BitmapDescriptorFactory.HUE_RED;
                float fScale1 = scale1();
                this.animateToScale = fScale1;
                this.scale = fScale1;
                this.animateToRotate = BitmapDescriptorFactory.HUE_RED;
                j = 0;
                this.animationStartTime = 0L;
                this.zoomAnimation = z11;
                this.imageMoveAnimation = null;
                this.changeModeAnimation = null;
                AspectRatioFrameLayout aspectRatioFrameLayout = this.aspectRatioFrameLayout;
                if (aspectRatioFrameLayout != null) {
                    aspectRatioFrameLayout.setVisibility(4);
                }
                this.pinchStartDistance = BitmapDescriptorFactory.HUE_RED;
                this.pinchStartAngle = BitmapDescriptorFactory.HUE_RED;
                this.pinchStartScale = 1.0f;
                this.pinchStartRotate = BitmapDescriptorFactory.HUE_RED;
                this.pinchCenterX = BitmapDescriptorFactory.HUE_RED;
                this.pinchCenterY = BitmapDescriptorFactory.HUE_RED;
                this.pinchStartX = BitmapDescriptorFactory.HUE_RED;
                this.pinchStartY = BitmapDescriptorFactory.HUE_RED;
                this.moveStartX = BitmapDescriptorFactory.HUE_RED;
                this.moveStartY = BitmapDescriptorFactory.HUE_RED;
                this.zooming = false;
                this.moving = false;
                this.paintViewTouched = 0;
                this.maskPaintViewTouched = 0;
                this.doubleTap = false;
                this.invalidCoords = false;
                this.canDragDown = true;
                this.changingPage = false;
                this.switchImageAfterAnimation = 0;
                if (this.sharedMediaType != 1) {
                    this.canZoom = (this.isEmbedVideo || (this.imagesArrLocals.isEmpty() && (this.currentFileNames[0] == null || this.photoProgressViews[0].backgroundState == 0))) ? false : true;
                }
                updateMinMax(this.scale);
                z12 = false;
                releasePlayer(false);
            }
            if (z13 && uri != null) {
                this.isStreaming = z12;
                preparePlayer(null, uri, this.sendPhotoType != 1, false, this.editState.savedFilterState);
            }
            if (this.imagesArrLocals.isEmpty()) {
                this.editState.reset();
            }
            this.centerImageIsVideo = z13;
            i4 = i2;
            if (i4 == -1 || z3) {
                setImages();
                for (i5 = 0; i5 < 3; i5++) {
                    checkProgress(i5, false, false);
                }
            } else {
                checkProgress(0, true, false);
                int i9 = this.currentIndex;
                if (i4 > i9) {
                    ImageReceiver imageReceiver = this.rightImage;
                    this.rightImage = this.centerImage;
                    this.centerImage = this.leftImage;
                    this.leftImage = imageReceiver;
                    BlurringShader.ThumbBlurer thumbBlurer = this.rightBlur;
                    this.rightBlur = this.centerBlur;
                    this.centerBlur = this.leftBlur;
                    this.leftBlur = thumbBlurer;
                    AnimatedFloat[] animatedFloatArr = this.centerImageInsideBlur;
                    if (animatedFloatArr != null) {
                        AnimatedFloat animatedFloat = animatedFloatArr[0];
                        animatedFloatArr[0] = animatedFloatArr[1];
                        c2 = 2;
                        animatedFloatArr[1] = animatedFloatArr[2];
                        animatedFloatArr[2] = animatedFloat;
                    } else {
                        c2 = 2;
                    }
                    this.rightImageIsVideo = z14;
                    this.rightCropTransform = cropTransformClone;
                    this.rightCropState = cropStateM380clone;
                    PhotoProgressView[] photoProgressViewArr = this.photoProgressViews;
                    PhotoProgressView photoProgressView = photoProgressViewArr[0];
                    photoProgressViewArr[0] = photoProgressViewArr[c2];
                    photoProgressViewArr[c2] = photoProgressView;
                    ImageView[] imageViewArr = this.fullscreenButton;
                    ImageView imageView = imageViewArr[0];
                    ImageView imageView2 = imageViewArr[c2];
                    imageViewArr[0] = imageView2;
                    imageViewArr[c2] = imageView;
                    imageView2.setTranslationY(imageView.getTranslationY());
                    this.leftCropState = null;
                    setIndexToPaintingOverlay(this.currentIndex - 1, this.leftPaintingOverlay);
                    setIndexToPaintingOverlay(this.currentIndex, this.paintingOverlay);
                    setIndexToPaintingOverlay(this.currentIndex + 1, this.rightPaintingOverlay);
                    setIndexToImage(this.leftImage, this.currentIndex - 1, this.leftCropTransform);
                    resetIndexForDeferredImageLoading();
                    updateAccessibilityOverlayVisibility();
                    checkProgress(1, true, false);
                    checkProgress(2, true, false);
                } else if (i4 < i9) {
                    ImageReceiver imageReceiver2 = this.leftImage;
                    this.leftImage = this.centerImage;
                    this.centerImage = this.rightImage;
                    this.rightImage = imageReceiver2;
                    BlurringShader.ThumbBlurer thumbBlurer2 = this.leftBlur;
                    this.leftBlur = this.centerBlur;
                    this.centerBlur = this.rightBlur;
                    this.rightBlur = thumbBlurer2;
                    AnimatedFloat[] animatedFloatArr2 = this.centerImageInsideBlur;
                    if (animatedFloatArr2 != null) {
                        AnimatedFloat animatedFloat2 = animatedFloatArr2[2];
                        r3 = 1;
                        animatedFloatArr2[2] = animatedFloatArr2[1];
                        c = 0;
                        animatedFloatArr2[1] = animatedFloatArr2[0];
                        animatedFloatArr2[0] = animatedFloat2;
                    } else {
                        c = 0;
                        r3 = 1;
                    }
                    this.leftImageIsVideo = z14;
                    this.leftCropTransform = cropTransformClone;
                    this.leftCropState = cropStateM380clone;
                    PhotoProgressView[] photoProgressViewArr2 = this.photoProgressViews;
                    PhotoProgressView photoProgressView2 = photoProgressViewArr2[c];
                    photoProgressViewArr2[c] = photoProgressViewArr2[r3];
                    photoProgressViewArr2[r3] = photoProgressView2;
                    ImageView[] imageViewArr2 = this.fullscreenButton;
                    ImageView imageView3 = imageViewArr2[c];
                    ImageView imageView4 = imageViewArr2[r3];
                    imageViewArr2[c] = imageView4;
                    imageViewArr2[r3] = imageView3;
                    imageView4.setTranslationY(imageView3.getTranslationY());
                    this.rightCropState = null;
                    setIndexToPaintingOverlay(this.currentIndex - r3, this.leftPaintingOverlay);
                    setIndexToPaintingOverlay(this.currentIndex, this.paintingOverlay);
                    setIndexToPaintingOverlay(this.currentIndex + r3, this.rightPaintingOverlay);
                    setIndexToImage(this.rightImage, this.currentIndex + r3, this.rightCropTransform);
                    resetIndexForDeferredImageLoading();
                    updateAccessibilityOverlayVisibility();
                    checkProgress(r3, r3, false);
                    checkProgress(2, r3, false);
                }
                Bitmap bitmap = this.videoFrameBitmap;
                if (bitmap != null) {
                    bitmap.recycle();
                    this.videoFrameBitmap = null;
                }
            }
            detectFaces();
            if (this.captionEdit != null) {
                PhotoViewerProvider photoViewerProvider = this.placeProvider;
                long dialogId = photoViewerProvider != null ? photoViewerProvider.getDialogId() : j;
                if (dialogId == j && (messageObject2 = this.currentMessageObject) != null) {
                    dialogId = messageObject2.getDialogId();
                }
                this.captionEdit.setDialogId(dialogId);
                CaptionPhotoViewer captionPhotoViewer = this.topCaptionEdit;
                if (captionPhotoViewer != null) {
                    captionPhotoViewer.setDialogId(dialogId);
                }
            }
            if (this.pickerViewSendButton != null) {
                PhotoViewerProvider photoViewerProvider2 = this.placeProvider;
                long dialogId2 = photoViewerProvider2 != null ? photoViewerProvider2.getDialogId() : j;
                if (dialogId2 == j && (messageObject = this.currentMessageObject) != null) {
                    dialogId2 = messageObject.getDialogId();
                }
                ChatActivityEnterView.SendButton sendButton = this.pickerViewSendButton;
                PhotoViewerProvider photoViewerProvider3 = this.placeProvider;
                long sendPaidMessagesStars = (photoViewerProvider3 == null || !photoViewerProvider3.isEditingMessage() || this.placeProvider.isEditingMessageResend()) ? MessagesController.getInstance(this.currentAccount).getSendPaidMessagesStars(dialogId2) : j;
                PhotoViewerProvider photoViewerProvider4 = this.placeProvider;
                if (photoViewerProvider4 == null) {
                    i6 = 1;
                    selectedCount = 1;
                } else {
                    selectedCount = photoViewerProvider4.getSelectedCount();
                    i6 = 1;
                }
                sendButton.setStarsPrice(sendPaidMessagesStars, Math.max(i6, selectedCount));
                return;
            }
            return;
        }
        i2 = i7;
        if (!this.secureDocuments.isEmpty()) {
            if (i < 0 || i >= this.secureDocuments.size()) {
                closePhoto(false, false);
                return;
            }
            this.currentSecureDocument = (SecureDocument) this.secureDocuments.get(i);
        } else if (!this.imagesArrLocations.isEmpty()) {
            if (i < 0 || i >= this.imagesArrLocations.size()) {
                closePhoto(false, false);
                return;
            }
            ImageLocation imageLocation = this.currentFileLocation;
            ImageLocation imageLocation2 = (ImageLocation) this.imagesArrLocations.get(i);
            if (!z || imageLocation == null || imageLocation2 == null) {
                z4 = false;
                this.currentFileLocation = (ImageLocation) this.imagesArrLocations.get(i);
                this.currentFileLocationVideo = (ImageLocation) this.imagesArrLocationsVideo.get(i);
            } else {
                TLRPC.TL_fileLocationToBeDeprecated tL_fileLocationToBeDeprecated = imageLocation.location;
                int i10 = tL_fileLocationToBeDeprecated.local_id;
                TLRPC.TL_fileLocationToBeDeprecated tL_fileLocationToBeDeprecated2 = imageLocation2.location;
                if (i10 == tL_fileLocationToBeDeprecated2.local_id && tL_fileLocationToBeDeprecated.volume_id == tL_fileLocationToBeDeprecated2.volume_id) {
                    z4 = true;
                }
                this.currentFileLocation = (ImageLocation) this.imagesArrLocations.get(i);
                this.currentFileLocationVideo = (ImageLocation) this.imagesArrLocationsVideo.get(i);
            }
            setMenuItemIcon(z5, z6);
            placeProviderObject = this.currentPlaceObject;
            if (placeProviderObject != null) {
            }
            placeForPhoto = this.placeProvider.getPlaceForPhoto(this.currentMessageObject, getFileLocation(this.currentFileLocation), this.currentIndex, false, false);
            this.currentPlaceObject = placeForPhoto;
            if (placeForPhoto == null) {
            }
            if (z4) {
            }
            if (z13) {
                this.isStreaming = z12;
                preparePlayer(null, uri, this.sendPhotoType != 1, false, this.editState.savedFilterState);
            }
            if (this.imagesArrLocals.isEmpty()) {
            }
            this.centerImageIsVideo = z13;
            i4 = i2;
            if (i4 == -1) {
                setImages();
                while (i5 < 3) {
                }
            }
            detectFaces();
            if (this.captionEdit != null) {
            }
            if (this.pickerViewSendButton != null) {
            }
        } else if (this.imagesArrLocals.isEmpty()) {
            PageBlocksAdapter pageBlocksAdapter = this.pageBlocksAdapter;
            if (pageBlocksAdapter != null) {
                int i11 = this.currentIndex;
                if (i11 < 0 || i11 >= pageBlocksAdapter.getItemsCount()) {
                    closePhoto(false, false);
                    return;
                }
                TLRPC.PageBlock pageBlock = this.pageBlocksAdapter.get(this.currentIndex);
                TLRPC.PageBlock pageBlock2 = this.currentPageBlock;
                z4 = pageBlock2 != null && pageBlock2 == pageBlock;
                this.currentPageBlock = pageBlock;
                if (this.pageBlocksAdapter.isVideo(this.currentIndex) || this.pageBlocksAdapter.isHardwarePlayer(this.currentIndex)) {
                    z5 = false;
                    uri = null;
                    z6 = true;
                    z13 = true;
                    setMenuItemIcon(z5, z6);
                    placeProviderObject = this.currentPlaceObject;
                    if (placeProviderObject != null) {
                    }
                    placeForPhoto = this.placeProvider.getPlaceForPhoto(this.currentMessageObject, getFileLocation(this.currentFileLocation), this.currentIndex, false, false);
                    this.currentPlaceObject = placeForPhoto;
                    if (placeForPhoto == null) {
                    }
                    if (z4) {
                    }
                    if (z13) {
                    }
                    if (this.imagesArrLocals.isEmpty()) {
                    }
                    this.centerImageIsVideo = z13;
                    i4 = i2;
                    if (i4 == -1) {
                    }
                    detectFaces();
                    if (this.captionEdit != null) {
                    }
                    if (this.pickerViewSendButton != null) {
                    }
                } else {
                    z5 = false;
                }
            }
            uri = null;
            z6 = true;
            z13 = false;
            setMenuItemIcon(z5, z6);
            placeProviderObject = this.currentPlaceObject;
            if (placeProviderObject != null) {
            }
            placeForPhoto = this.placeProvider.getPlaceForPhoto(this.currentMessageObject, getFileLocation(this.currentFileLocation), this.currentIndex, false, false);
            this.currentPlaceObject = placeForPhoto;
            if (placeForPhoto == null) {
            }
            if (z4) {
            }
            if (z13) {
            }
            if (this.imagesArrLocals.isEmpty()) {
            }
            this.centerImageIsVideo = z13;
            i4 = i2;
            if (i4 == -1) {
            }
            detectFaces();
            if (this.captionEdit != null) {
            }
            if (this.pickerViewSendButton != null) {
            }
        } else {
            if (i < 0 || i >= this.imagesArrLocals.size()) {
                closePhoto(false, false);
                return;
            }
            Object obj = this.imagesArrLocals.get(i);
            if (obj instanceof TLRPC.BotInlineResult) {
                TLRPC.BotInlineResult botInlineResult = (TLRPC.BotInlineResult) obj;
                this.currentBotInlineResult = botInlineResult;
                if (botInlineResult.document != null) {
                    this.currentPathObject = FileLoader.getInstance(this.currentAccount).getPathToAttach(botInlineResult.document).getAbsolutePath();
                    zEquals = MessageObject.isVideoDocument(botInlineResult.document);
                } else {
                    if (botInlineResult.photo != null) {
                        this.currentPathObject = FileLoader.getInstance(this.currentAccount).getPathToAttach(FileLoader.getClosestPhotoSizeWithSize(botInlineResult.photo.sizes, AndroidUtilities.getPhotoSize())).getAbsolutePath();
                    } else {
                        TLRPC.WebDocument webDocument = botInlineResult.content;
                        if (webDocument instanceof TLRPC.TL_webDocument) {
                            this.currentPathObject = webDocument.url;
                            zEquals = botInlineResult.type.equals(MediaStreamTrack.VIDEO_TRACK_KIND);
                        }
                    }
                    z4 = false;
                    z7 = false;
                    uriFromFile = null;
                }
                z7 = zEquals;
                z4 = false;
                uriFromFile = null;
            } else {
                if (obj instanceof MediaController.PhotoEntry) {
                    MediaController.PhotoEntry photoEntry = (MediaController.PhotoEntry) obj;
                    String str2 = photoEntry.path;
                    this.currentPathObject = str2;
                    if (str2 == null) {
                        closePhoto(false, false);
                        return;
                    }
                    boolean z15 = photoEntry.isVideo;
                    EditState editState2 = this.editState;
                    editState2.savedFilterState = photoEntry.savedFilterState;
                    editState2.paintPath = photoEntry.paintPath;
                    editState2.croppedPaintPath = photoEntry.croppedPaintPath;
                    editState2.croppedMediaEntities = photoEntry.croppedMediaEntities;
                    editState2.averageDuration = photoEntry.averageDuration;
                    editState2.mediaEntities = photoEntry.mediaEntities;
                    editState2.cropState = photoEntry.cropState;
                    File file = new File(photoEntry.path);
                    uriFromFile = Uri.fromFile(file);
                    if (this.isDocumentsPicker) {
                        StringBuilder sb = new StringBuilder();
                        if (photoEntry.width == 0 || photoEntry.height == 0) {
                            z8 = z15;
                        } else {
                            if (sb.length() > 0) {
                                sb.append(", ");
                            }
                            z8 = z15;
                            sb.append(String.format(Locale.US, "%dx%d", Integer.valueOf(photoEntry.width), Integer.valueOf(photoEntry.height)));
                        }
                        if (photoEntry.isVideo) {
                            if (sb.length() > 0) {
                                sb.append(", ");
                            }
                            sb.append(AndroidUtilities.formatShortDuration(photoEntry.duration));
                        }
                        if (photoEntry.size != 0) {
                            if (sb.length() > 0) {
                                sb.append(", ");
                            }
                            sb.append(AndroidUtilities.formatFileSize(photoEntry.size));
                        }
                        this.docNameTextView.setText(file.getName());
                        this.docInfoTextView.setText(sb);
                    } else {
                        z8 = z15;
                    }
                    z7 = z8;
                    z4 = this.savedState != null;
                } else {
                    if (obj instanceof MediaController.SearchImage) {
                        MediaController.SearchImage searchImage = (MediaController.SearchImage) obj;
                        this.currentPathObject = searchImage.getPathToAttach();
                        EditState editState3 = this.editState;
                        editState3.savedFilterState = searchImage.savedFilterState;
                        editState3.paintPath = searchImage.paintPath;
                        editState3.croppedPaintPath = searchImage.croppedPaintPath;
                        editState3.croppedMediaEntities = searchImage.croppedMediaEntities;
                        editState3.averageDuration = searchImage.averageDuration;
                        editState3.mediaEntities = searchImage.mediaEntities;
                        editState3.cropState = searchImage.cropState;
                    }
                    z4 = false;
                    z7 = false;
                    uriFromFile = null;
                }
                if (obj instanceof MediaController.MediaEditState) {
                    MediaController.MediaEditState mediaEditState = (MediaController.MediaEditState) obj;
                    if (hasAnimatedMediaEntities()) {
                        str = mediaEditState.imagePath;
                    } else {
                        str = mediaEditState.filterPath;
                        if (str == null) {
                            str = this.currentPathObject;
                        }
                    }
                    this.currentImagePath = str;
                }
            }
            MediaController.CropState cropState2 = this.editState.cropState;
            if (cropState2 != null) {
                this.previousHasTransform = true;
                float f11 = cropState2.cropPx;
                this.previousCropPx = f11;
                float f12 = cropState2.cropPy;
                this.previousCropPy = f12;
                float f13 = cropState2.cropScale;
                this.previousCropScale = f13;
                float f14 = cropState2.cropRotate;
                this.previousCropRotation = f14;
                int i12 = cropState2.transformRotation;
                this.previousCropOrientation = i12;
                float f15 = cropState2.cropPw;
                this.previousCropPw = f15;
                float f16 = cropState2.cropPh;
                this.previousCropPh = f16;
                boolean z16 = cropState2.mirrored;
                this.previousCropMirrored = z16;
                CropTransform cropTransform2 = this.cropTransform;
                f = BitmapDescriptorFactory.HUE_RED;
                f2 = BitmapDescriptorFactory.HUE_RED;
                z9 = true;
                f3 = 1.0f;
                f4 = 1.0f;
                cropTransform = cropTransform2;
                f5 = f11;
                f6 = f12;
                f7 = f14;
                i3 = i12;
                f8 = f13;
                f9 = f15;
                f10 = f16;
                z10 = z16;
            } else {
                this.previousHasTransform = false;
                CropTransform cropTransform3 = this.cropTransform;
                float f17 = this.previousCropPx;
                float f18 = this.previousCropPy;
                float f19 = this.previousCropRotation;
                int i13 = this.previousCropOrientation;
                float f20 = this.previousCropScale;
                float f21 = this.previousCropPw;
                float f22 = this.previousCropPh;
                boolean z17 = this.previousCropMirrored;
                f = BitmapDescriptorFactory.HUE_RED;
                f2 = BitmapDescriptorFactory.HUE_RED;
                z9 = false;
                f3 = 1.0f;
                f4 = 1.0f;
                cropTransform = cropTransform3;
                f5 = f17;
                f6 = f18;
                f7 = f19;
                i3 = i13;
                f8 = f20;
                f9 = f21;
                f10 = f22;
                z10 = z17;
            }
            cropTransform.setViewTransform(z9, f5, f6, f7, i3, f8, f3, f4, f9, f10, f, f2, z10);
            z13 = z7;
            uri = uriFromFile;
            z5 = false;
            z6 = true;
            setMenuItemIcon(z5, z6);
            placeProviderObject = this.currentPlaceObject;
            if (placeProviderObject != null) {
            }
            placeForPhoto = this.placeProvider.getPlaceForPhoto(this.currentMessageObject, getFileLocation(this.currentFileLocation), this.currentIndex, false, false);
            this.currentPlaceObject = placeForPhoto;
            if (placeForPhoto == null) {
            }
            if (z4) {
            }
            if (z13) {
            }
            if (this.imagesArrLocals.isEmpty()) {
            }
            this.centerImageIsVideo = z13;
            i4 = i2;
            if (i4 == -1) {
            }
            detectFaces();
            if (this.captionEdit != null) {
            }
            if (this.pickerViewSendButton != null) {
            }
        }
        z5 = false;
        z4 = false;
        uri = null;
        z6 = true;
        z13 = false;
        setMenuItemIcon(z5, z6);
        placeProviderObject = this.currentPlaceObject;
        if (placeProviderObject != null) {
        }
        placeForPhoto = this.placeProvider.getPlaceForPhoto(this.currentMessageObject, getFileLocation(this.currentFileLocation), this.currentIndex, false, false);
        this.currentPlaceObject = placeForPhoto;
        if (placeForPhoto == null) {
        }
        if (z4) {
        }
        if (z13) {
        }
        if (this.imagesArrLocals.isEmpty()) {
        }
        this.centerImageIsVideo = z13;
        i4 = i2;
        if (i4 == -1) {
        }
        detectFaces();
        if (this.captionEdit != null) {
        }
        if (this.pickerViewSendButton != null) {
        }
        z5 = false;
        uri = null;
        z6 = true;
        setMenuItemIcon(z5, z6);
        placeProviderObject = this.currentPlaceObject;
        if (placeProviderObject != null) {
        }
        placeForPhoto = this.placeProvider.getPlaceForPhoto(this.currentMessageObject, getFileLocation(this.currentFileLocation), this.currentIndex, false, false);
        this.currentPlaceObject = placeForPhoto;
        if (placeForPhoto == null) {
        }
        if (z4) {
        }
        if (z13) {
        }
        if (this.imagesArrLocals.isEmpty()) {
        }
        this.centerImageIsVideo = z13;
        i4 = i2;
        if (i4 == -1) {
        }
        detectFaces();
        if (this.captionEdit != null) {
        }
        if (this.pickerViewSendButton != null) {
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void setImages() throws Resources.NotFoundException {
        if (this.animationInProgress == 0) {
            setIndexToImage(this.centerImage, this.currentIndex, null);
            setIndexToPaintingOverlay(this.currentIndex, this.paintingOverlay);
            setIndexToImage(this.rightImage, this.currentIndex + 1, this.rightCropTransform);
            setIndexToPaintingOverlay(this.currentIndex + 1, this.rightPaintingOverlay);
            setIndexToImage(this.leftImage, this.currentIndex - 1, this.leftCropTransform);
            setIndexToPaintingOverlay(this.currentIndex - 1, this.leftPaintingOverlay);
        }
    }

    /* JADX WARN: Code restructure failed: missing block: B:238:0x0500, code lost:
    
        if (r2[0] == 0) goto L435;
     */
    /* JADX WARN: Code restructure failed: missing block: B:434:0x080d, code lost:
    
        if (r5[0] == 0) goto L435;
     */
    /* JADX WARN: Removed duplicated region for block: B:113:0x027c  */
    /* JADX WARN: Removed duplicated region for block: B:134:0x0320  */
    /* JADX WARN: Removed duplicated region for block: B:166:0x03bc  */
    /* JADX WARN: Removed duplicated region for block: B:171:0x03f7  */
    /* JADX WARN: Removed duplicated region for block: B:172:0x03fd  */
    /* JADX WARN: Removed duplicated region for block: B:390:0x0760  */
    /* JADX WARN: Removed duplicated region for block: B:402:0x0796  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void setIndexToImage(ImageReceiver imageReceiver, int i, CropTransform cropTransform) throws Resources.NotFoundException {
        Bitmap bitmap;
        MessageObject messageObject;
        TLRPC.PhotoSize closestPhotoSizeWithSize;
        TLObject tLObject;
        ImageLocation forDocument;
        Object obj;
        int i2;
        TLRPC.Document document;
        TLRPC.VideoSize documentVideoThumb;
        TLRPC.Photo photo;
        AnimatedFileDrawable animatedFileDrawable;
        Drawable drawable;
        Object objValueOf;
        ImageLocation forDocument2;
        BitmapDrawable bitmapDrawable;
        Object parentObject;
        String str;
        int i3;
        ImageLocation imageLocation;
        String str2;
        String str3;
        long j;
        ImageReceiver imageReceiver2;
        AnimatedFileDrawable animatedFileDrawable2;
        String str4;
        ImageReceiver.BitmapHolder bitmapHolder;
        WebFile webFileCreateWithWebDocument;
        ImageLocation forWebFile;
        TLRPC.PhotoSize photoSize;
        TLObject tLObject2;
        TLRPC.Document document2;
        boolean z;
        String str5;
        long j2;
        int i4;
        long j3;
        TLRPC.Document document3;
        MediaController.CropState cropState;
        String str6;
        TLRPC.Document document4;
        boolean z2;
        boolean z3;
        boolean z4;
        Drawable drawable2;
        Activity activity;
        Drawable drawable3;
        Drawable drawable4;
        Activity activity2;
        String str7;
        imageReceiver.setOrientation(0, false);
        if (this.secureDocuments.isEmpty()) {
            if (this.imagesArrLocals.isEmpty()) {
                PageBlocksAdapter pageBlocksAdapter = this.pageBlocksAdapter;
                if (pageBlocksAdapter != null) {
                    int[] iArr = new int[1];
                    TLObject media = pageBlocksAdapter.getMedia(i);
                    TLRPC.PhotoSize fileLocation = this.pageBlocksAdapter.getFileLocation(media, iArr);
                    if (fileLocation == null) {
                        bitmap = null;
                    } else if (media instanceof TLRPC.Photo) {
                        TLRPC.Photo photo2 = (TLRPC.Photo) media;
                        ImageReceiver.BitmapHolder bitmapHolder2 = this.currentThumb;
                        if (bitmapHolder2 == null || imageReceiver != this.centerImage) {
                            bitmapHolder2 = null;
                        }
                        if (iArr[0] == 0) {
                            iArr[0] = -1;
                        }
                        boolean z5 = (DownloadController.getInstance(this.currentAccount).getAutodownloadMask() & 1) != 0 || this.currentIndex == i || FileLoader.getInstance(this.currentAccount).getPathToAttach(fileLocation, true).exists();
                        bitmap = null;
                        imageReceiver.setImage(z5 ? ImageLocation.getForPhoto(fileLocation, photo2) : null, null, ImageLocation.getForPhoto(FileLoader.getClosestPhotoSizeWithSize(photo2.sizes, 80), photo2), "b", bitmapHolder2 != null ? new BitmapDrawable(bitmapHolder2.bitmap) : null, iArr[0], null, this.pageBlocksAdapter.getParentObject(), 1);
                        if (!z5) {
                            i2 = 1;
                        }
                    } else {
                        if (!this.pageBlocksAdapter.isVideo(i) && !this.pageBlocksAdapter.isHardwarePlayer(i)) {
                            if (imageReceiver != this.centerImage || (animatedFileDrawable2 = this.currentAnimation) == null) {
                                return;
                            }
                            imageReceiver.setImageBitmap(animatedFileDrawable2);
                            this.currentAnimation.addSecondParentView(this.containerView);
                            return;
                        }
                        if (!(fileLocation.location instanceof TLRPC.TL_fileLocationUnavailable)) {
                            ImageReceiver.BitmapHolder bitmapHolder3 = this.currentThumb;
                            if (bitmapHolder3 == null || imageReceiver != this.centerImage) {
                                bitmapHolder3 = null;
                            }
                            forDocument2 = bitmapHolder3 == null ? ImageLocation.getForDocument(fileLocation, (TLRPC.Document) media) : null;
                            bitmapDrawable = bitmapHolder3 != null ? new BitmapDrawable(bitmapHolder3.bitmap) : null;
                            parentObject = this.pageBlocksAdapter.getParentObject();
                            str = null;
                            i3 = 1;
                            imageLocation = null;
                            str2 = null;
                            str3 = "b";
                            j = 0;
                            imageReceiver2 = imageReceiver;
                        }
                    }
                    imageReceiver.setImageBitmap(this.parentActivity.getResources().getDrawable(R.drawable.photoview_placeholder));
                    return;
                }
                bitmap = null;
                if (this.imagesArr.isEmpty() || i < 0 || i >= this.imagesArr.size()) {
                    messageObject = null;
                } else {
                    MessageObject messageObject2 = (MessageObject) this.imagesArr.get(i);
                    imageReceiver.setShouldGenerateQualityThumb(true);
                    messageObject = messageObject2;
                }
                if (messageObject != null) {
                    if (!TextUtils.isEmpty(MessagesController.getInstance(messageObject.currentAccount).getRestrictionReason(messageObject.messageOwner.restriction_reason))) {
                        drawable = this.parentActivity.getResources().getDrawable(R.drawable.photoview_placeholder);
                    } else {
                        if (messageObject.isVideo()) {
                            ArrayList<TLRPC.PhotoSize> arrayList = messageObject.photoThumbs;
                            if (arrayList == null || arrayList.isEmpty()) {
                                imageReceiver.setImageBitmap(this.parentActivity.getResources().getDrawable(R.drawable.photoview_placeholder));
                                return;
                            }
                            ImageReceiver.BitmapHolder bitmapHolder4 = this.currentThumb;
                            if (bitmapHolder4 == null || imageReceiver != this.centerImage) {
                                bitmapHolder4 = null;
                            }
                            TLRPC.PhotoSize closestPhotoSizeWithSize2 = FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, 320);
                            imageReceiver.setNeedsQualityThumb(closestPhotoSizeWithSize2.w < 100 && closestPhotoSizeWithSize2.h < 100);
                            imageReceiver.setImage(null, null, bitmapHolder4 == null ? ImageLocation.getForObject(closestPhotoSizeWithSize2, messageObject.photoThumbsObject) : null, "b", bitmapHolder4 != null ? new BitmapDrawable(bitmapHolder4.bitmap) : null, 0L, null, messageObject, 1);
                            ImageReceiver.BitmapHolder bitmapHolder5 = this.currentThumb;
                            if (bitmapHolder5 != null) {
                                imageReceiver.setOrientation(bitmapHolder5.orientation, false);
                                return;
                            }
                            return;
                        }
                        if (imageReceiver == this.centerImage && (animatedFileDrawable = this.currentAnimation) != null) {
                            animatedFileDrawable.addSecondParentView(this.containerView);
                            drawable = this.currentAnimation;
                        } else if (this.sharedMediaType == 1) {
                            if (!messageObject.canPreviewDocument()) {
                                imageReceiver.setImageBitmap(new OtherDocumentPlaceholderDrawable(this.parentActivity, this.containerView, messageObject));
                                return;
                            }
                            TLRPC.Document document5 = messageObject.getDocument();
                            imageReceiver.setNeedsQualityThumb(true);
                            ImageReceiver.BitmapHolder bitmapHolder6 = this.currentThumb;
                            if (bitmapHolder6 == null || imageReceiver != this.centerImage) {
                                bitmapHolder6 = null;
                            }
                            int i5 = (int) (2048.0f / AndroidUtilities.density);
                            boolean z6 = (DownloadController.getInstance(this.currentAccount).getAutodownloadMask() & 8) != 0 || this.currentIndex == i || FileLoader.getInstance(this.currentAccount).getPathToAttach(document5).exists();
                            imageReceiver.setImage(z6 ? ImageLocation.getForDocument(document5) : null, String.format(Locale.US, "%d_%d", Integer.valueOf(i5), Integer.valueOf(i5)), bitmapHolder6 == null ? ImageLocation.getForDocument(FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, 100), document5) : null, "b", bitmapHolder6 != null ? new BitmapDrawable(bitmapHolder6.bitmap) : null, document5.size, null, messageObject, 0);
                            imageReceiver.setMark(z6 ? null : 1);
                            return;
                        }
                    }
                    imageReceiver.setImageBitmap(drawable);
                    return;
                }
                long[] jArr = new long[1];
                ImageLocation imageLocation2 = getImageLocation(i, jArr);
                TLObject fileLocation2 = getFileLocation(i, jArr);
                imageReceiver.setNeedsQualityThumb(true);
                if (imageLocation2 != null) {
                    ImageReceiver.BitmapHolder bitmapHolder7 = this.currentThumb;
                    if (bitmapHolder7 == null || imageReceiver != this.centerImage) {
                        bitmapHolder7 = null;
                    }
                    if (jArr[0] == 0) {
                        jArr[0] = -1;
                    }
                    if (messageObject != null) {
                        closestPhotoSizeWithSize = FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, 100);
                        tLObject = messageObject.photoThumbsObject;
                    } else {
                        closestPhotoSizeWithSize = null;
                        tLObject = null;
                    }
                    if (closestPhotoSizeWithSize != null && closestPhotoSizeWithSize == fileLocation2) {
                        closestPhotoSizeWithSize = null;
                    }
                    if (closestPhotoSizeWithSize == null && (photo = imageLocation2.photo) != null && photo.sizes != null) {
                        int i6 = 0;
                        while (true) {
                            if (i6 >= imageLocation2.photo.sizes.size()) {
                                break;
                            }
                            if (imageLocation2.photo.sizes.get(i6) instanceof TLRPC.TL_photoStrippedSize) {
                                closestPhotoSizeWithSize = (TLRPC.PhotoSize) imageLocation2.photo.sizes.get(i6);
                                tLObject = imageLocation2.photo;
                                break;
                            }
                            i6++;
                        }
                    }
                    int i7 = ((messageObject == null || !messageObject.isWebpage()) && this.avatarsDialogId == 0 && !this.isEvent) ? 0 : 1;
                    if (messageObject == null) {
                        long j4 = this.avatarsDialogId;
                        if (j4 != 0) {
                            MessagesController messagesController = MessagesController.getInstance(this.currentAccount);
                            Object user = j4 > 0 ? messagesController.getUser(Long.valueOf(this.avatarsDialogId)) : messagesController.getChat(Long.valueOf(-this.avatarsDialogId));
                            if (tLObject != null) {
                                user = tLObject;
                            }
                            if (bitmapHolder7 == null && (closestPhotoSizeWithSize instanceof TLRPC.TL_photoStrippedSize)) {
                                bitmapHolder7 = new ImageReceiver.BitmapHolder(ImageLoader.getStrippedPhotoBitmap(closestPhotoSizeWithSize.bytes, "b"));
                            }
                            obj = user;
                            forDocument = null;
                            String str8 = ImageLoader.AUTOPLAY_FILTER;
                            if (forDocument == null) {
                            }
                        } else {
                            forDocument = null;
                            obj = null;
                            String str82 = ImageLoader.AUTOPLAY_FILTER;
                            if (forDocument == null) {
                            }
                        }
                    } else if (this.sharedMediaType != 5 || (documentVideoThumb = MessageObject.getDocumentVideoThumb((document = messageObject.getDocument()))) == null) {
                        obj = messageObject;
                        forDocument = null;
                        String str822 = ImageLoader.AUTOPLAY_FILTER;
                        if (forDocument == null) {
                            if (this.sharedMediaType != 5) {
                                str822 = null;
                            }
                            imageReceiver.setImage(imageLocation2, str822, forDocument, null, bitmapHolder7 == null ? ImageLocation.getForObject(closestPhotoSizeWithSize, tLObject) : null, "b", bitmapHolder7 != null ? new BitmapDrawable(bitmapHolder7.bitmap) : null, jArr[0], null, obj, i7);
                            imageReceiver.setAllowStartAnimation(true);
                            return;
                        }
                        i2 = 1;
                        if (this.avatarsDialogId == 0 || imageLocation2.imageType != 2) {
                            str822 = null;
                        }
                        boolean z7 = (DownloadController.getInstance(this.currentAccount).getAutodownloadMask() & 1) != 0 || this.currentIndex == i || FileLoader.getInstance(this.currentAccount).getPathToAttach(fileLocation2).exists();
                        imageReceiver.setImage(z7 ? imageLocation2 : null, str822, bitmapHolder7 == null ? ImageLocation.getForObject(closestPhotoSizeWithSize, tLObject) : null, "b", bitmapHolder7 != null ? new BitmapDrawable(bitmapHolder7.bitmap) : null, jArr[0], null, obj, i7);
                        objValueOf = z7 ? bitmap : Integer.valueOf(i2);
                    } else {
                        forDocument = ImageLocation.getForDocument(documentVideoThumb, document);
                        obj = messageObject;
                        String str8222 = ImageLoader.AUTOPLAY_FILTER;
                        if (forDocument == null) {
                        }
                    }
                }
                imageReceiver.setMark(objValueOf);
                return;
            }
            if (i < 0 || i >= this.imagesArrLocals.size()) {
                bitmap = null;
            } else {
                Object obj2 = this.imagesArrLocals.get(i);
                int photoSize2 = (int) (AndroidUtilities.getPhotoSize() / AndroidUtilities.density);
                ImageReceiver.BitmapHolder bitmapHolder8 = this.currentThumb;
                if (bitmapHolder8 == null || imageReceiver != this.centerImage) {
                    bitmapHolder8 = null;
                }
                if (bitmapHolder8 == null) {
                    bitmapHolder8 = this.placeProvider.getThumbForPhoto(null, null, i);
                }
                if (obj2 instanceof MediaController.PhotoEntry) {
                    MediaController.PhotoEntry photoEntry = (MediaController.PhotoEntry) obj2;
                    MediaController.CropState cropState2 = photoEntry.cropState;
                    boolean z8 = photoEntry.isVideo;
                    if (z8) {
                        str7 = photoEntry.thumbPath;
                        if (str7 == null) {
                            str7 = "vthumb://" + photoEntry.imageId + ":" + photoEntry.path;
                        } else if (this.fromCamera) {
                            Bitmap bitmapDecodeFile = BitmapFactory.decodeFile(str7);
                            if (bitmapDecodeFile != null) {
                                bitmapHolder8 = new ImageReceiver.BitmapHolder(bitmapDecodeFile);
                                photoEntry.thumbPath = null;
                            }
                            str6 = null;
                            str7 = null;
                        }
                        str6 = null;
                    } else {
                        str7 = photoEntry.filterPath;
                        if (str7 == null) {
                            imageReceiver.setOrientation(photoEntry.orientation, photoEntry.invert, false);
                            str7 = photoEntry.path;
                        }
                        str6 = String.format(Locale.US, "%d_%d", Integer.valueOf(photoSize2), Integer.valueOf(photoSize2));
                    }
                    z = z8;
                    str5 = str7;
                    bitmapHolder = bitmapHolder8;
                    cropState = cropState2;
                    forWebFile = null;
                    photoSize = null;
                    tLObject2 = null;
                    document2 = null;
                    j2 = 0;
                    i4 = 0;
                } else {
                    str4 = "d";
                    if (obj2 instanceof TLRPC.BotInlineResult) {
                        TLRPC.BotInlineResult botInlineResult = (TLRPC.BotInlineResult) obj2;
                        if (botInlineResult.type.equals(MediaStreamTrack.VIDEO_TRACK_KIND) || MessageObject.isVideoDocument(botInlineResult.document)) {
                            TLRPC.Document document6 = botInlineResult.document;
                            if (document6 != null) {
                                TLRPC.PhotoSize closestPhotoSizeWithSize3 = FileLoader.getClosestPhotoSizeWithSize(document6.thumbs, 90);
                                tLObject2 = botInlineResult.document;
                                bitmapHolder = bitmapHolder8;
                                webFileCreateWithWebDocument = null;
                                forWebFile = null;
                                document2 = null;
                                z = false;
                                str5 = null;
                                j2 = 0;
                                i4 = 1;
                                cropState = null;
                                photoSize = closestPhotoSizeWithSize3;
                                str4 = null;
                            } else {
                                TLRPC.WebDocument webDocument = botInlineResult.thumb;
                                if (webDocument instanceof TLRPC.TL_webDocument) {
                                    webFileCreateWithWebDocument = WebFile.createWithWebDocument(webDocument);
                                    bitmapHolder = bitmapHolder8;
                                }
                                str4 = null;
                                forWebFile = null;
                                photoSize = null;
                                tLObject2 = null;
                                document2 = null;
                                z = false;
                                str5 = null;
                                j2 = 0;
                                i4 = 1;
                                cropState = null;
                            }
                        } else if (!botInlineResult.type.equals("gif") || (document4 = botInlineResult.document) == null) {
                            TLRPC.Photo photo3 = botInlineResult.photo;
                            if (photo3 != null) {
                                TLRPC.PhotoSize closestPhotoSizeWithSize4 = FileLoader.getClosestPhotoSizeWithSize(photo3.sizes, AndroidUtilities.getPhotoSize());
                                TLObject tLObject3 = botInlineResult.photo;
                                long j5 = closestPhotoSizeWithSize4.size;
                                str6 = String.format(Locale.US, "%d_%d", Integer.valueOf(photoSize2), Integer.valueOf(photoSize2));
                                bitmapHolder = bitmapHolder8;
                                tLObject2 = tLObject3;
                                forWebFile = null;
                                str5 = null;
                                i4 = 1;
                                cropState = null;
                                photoSize = closestPhotoSizeWithSize4;
                                j2 = j5;
                                document2 = null;
                                z = false;
                            } else if (botInlineResult.content instanceof TLRPC.TL_webDocument) {
                                if (botInlineResult.type.equals("gif")) {
                                    TLRPC.WebDocument webDocument2 = botInlineResult.thumb;
                                    if ((webDocument2 instanceof TLRPC.TL_webDocument) && "video/mp4".equals(webDocument2.mime_type)) {
                                        forWebFile = ImageLocation.getForWebFile(WebFile.createWithWebDocument(botInlineResult.thumb));
                                    }
                                    webFileCreateWithWebDocument = WebFile.createWithWebDocument(botInlineResult.content);
                                    bitmapHolder = bitmapHolder8;
                                    photoSize = null;
                                    tLObject2 = null;
                                    document2 = null;
                                    z = false;
                                    str5 = null;
                                    j2 = 0;
                                    i4 = 1;
                                    cropState = null;
                                } else {
                                    str4 = String.format(Locale.US, "%d_%d", Integer.valueOf(photoSize2), Integer.valueOf(photoSize2));
                                }
                                forWebFile = null;
                                webFileCreateWithWebDocument = WebFile.createWithWebDocument(botInlineResult.content);
                                bitmapHolder = bitmapHolder8;
                                photoSize = null;
                                tLObject2 = null;
                                document2 = null;
                                z = false;
                                str5 = null;
                                j2 = 0;
                                i4 = 1;
                                cropState = null;
                            }
                        } else {
                            long j6 = document4.size;
                            TLRPC.VideoSize documentVideoThumb2 = MessageObject.getDocumentVideoThumb(document4);
                            bitmapHolder = bitmapHolder8;
                            j2 = j6;
                            photoSize = null;
                            tLObject2 = null;
                            z = false;
                            str5 = null;
                            i4 = 1;
                            cropState = null;
                            document2 = document4;
                            forWebFile = documentVideoThumb2 != null ? ImageLocation.getForDocument(documentVideoThumb2, document4) : null;
                            webFileCreateWithWebDocument = null;
                        }
                        bitmapHolder = bitmapHolder8;
                        webFileCreateWithWebDocument = null;
                        str4 = null;
                        forWebFile = null;
                        photoSize = null;
                        tLObject2 = null;
                        document2 = null;
                        z = false;
                        str5 = null;
                        j2 = 0;
                        i4 = 1;
                        cropState = null;
                    } else if (obj2 instanceof MediaController.SearchImage) {
                        MediaController.SearchImage searchImage = (MediaController.SearchImage) obj2;
                        TLRPC.PhotoSize photoSize3 = searchImage.photoSize;
                        if (photoSize3 != null) {
                            tLObject2 = searchImage.photo;
                            j3 = photoSize3.size;
                            str5 = null;
                        } else {
                            String str9 = searchImage.filterPath;
                            if (str9 != null) {
                                str5 = str9;
                                photoSize3 = null;
                                tLObject2 = null;
                                j3 = 0;
                            } else {
                                TLRPC.Document document7 = searchImage.document;
                                if (document7 != null) {
                                    j3 = document7.size;
                                    document3 = document7;
                                    photoSize3 = null;
                                    tLObject2 = null;
                                    str5 = null;
                                    cropState = searchImage.cropState;
                                    bitmapHolder = bitmapHolder8;
                                    webFileCreateWithWebDocument = null;
                                    i4 = 1;
                                    photoSize = photoSize3;
                                    forWebFile = null;
                                    long j7 = j3;
                                    document2 = document3;
                                    j2 = j7;
                                    z = false;
                                } else {
                                    String str10 = searchImage.imageUrl;
                                    j3 = searchImage.size;
                                    str5 = str10;
                                    photoSize3 = null;
                                    tLObject2 = null;
                                }
                            }
                        }
                        document3 = null;
                        cropState = searchImage.cropState;
                        bitmapHolder = bitmapHolder8;
                        webFileCreateWithWebDocument = null;
                        i4 = 1;
                        photoSize = photoSize3;
                        forWebFile = null;
                        long j72 = j3;
                        document2 = document3;
                        j2 = j72;
                        z = false;
                    } else {
                        bitmapHolder = bitmapHolder8;
                        webFileCreateWithWebDocument = null;
                        str4 = null;
                        forWebFile = null;
                        photoSize = null;
                        tLObject2 = null;
                        document2 = null;
                        z = false;
                        str5 = null;
                        j2 = 0;
                        i4 = 0;
                        cropState = null;
                    }
                    if (document2 == null) {
                        TLRPC.PhotoSize closestPhotoSizeWithSize5 = FileLoader.getClosestPhotoSizeWithSize(document2.thumbs, 90);
                        if (forWebFile != null) {
                            z2 = z;
                            z3 = false;
                            imageReceiver.setImage(ImageLocation.getForDocument(document2), "d", forWebFile, null, bitmapHolder == null ? ImageLocation.getForDocument(closestPhotoSizeWithSize5, document2) : null, String.format(Locale.US, "%d_%d", Integer.valueOf(photoSize2), Integer.valueOf(photoSize2)), bitmapHolder != null ? new BitmapDrawable(bitmapHolder.bitmap) : null, j2, null, obj2, i4);
                        } else {
                            z2 = z;
                            z3 = false;
                            imageReceiver.setImage(ImageLocation.getForDocument(document2), "d", bitmapHolder == null ? ImageLocation.getForDocument(closestPhotoSizeWithSize5, document2) : null, String.format(Locale.US, "%d_%d", Integer.valueOf(photoSize2), Integer.valueOf(photoSize2)), bitmapHolder != null ? new BitmapDrawable(bitmapHolder.bitmap) : null, j2, null, obj2, i4);
                        }
                    } else {
                        z2 = z;
                        z3 = false;
                        if (photoSize == null) {
                            if (webFileCreateWithWebDocument != null) {
                                ImageLocation forWebFile2 = ImageLocation.getForWebFile(webFileCreateWithWebDocument);
                                if (forWebFile != null) {
                                    imageReceiver.setImage(forWebFile2, str4, forWebFile, (String) null, (Drawable) null, obj2, i4);
                                } else {
                                    if (bitmapHolder != null) {
                                        drawable4 = new BitmapDrawable(bitmapHolder.bitmap);
                                        z4 = z2;
                                    } else {
                                        z4 = z2;
                                        drawable4 = (!z4 || (activity2 = this.parentActivity) == null) ? null : activity2.getResources().getDrawable(R.drawable.nophotos);
                                    }
                                    imageReceiver.setImage(forWebFile2, str4, drawable4, null, obj2, i4);
                                }
                            } else {
                                z4 = z2;
                                if (bitmapHolder != null) {
                                    drawable3 = new BitmapDrawable(bitmapHolder.bitmap);
                                } else if (!z4 || (activity = this.parentActivity) == null) {
                                    drawable2 = null;
                                    imageReceiver.setImage(str5, str4, drawable2, null, j2);
                                } else {
                                    drawable3 = activity.getResources().getDrawable(R.drawable.nophotos);
                                }
                                drawable2 = drawable3;
                                imageReceiver.setImage(str5, str4, drawable2, null, j2);
                            }
                            MediaController.CropState cropState3 = cropState;
                            if (cropTransform != null) {
                                if (cropState3 != null) {
                                    cropTransform.setViewTransform(true, cropState3.cropPx, cropState3.cropPy, cropState3.cropRotate, cropState3.transformRotation, cropState3.cropScale, 1.0f, 1.0f, cropState3.cropPw, cropState3.cropPh, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, cropState3.mirrored);
                                } else {
                                    cropTransform.setViewTransform(z3);
                                }
                            }
                            if (imageReceiver == this.leftImage) {
                                this.leftCropState = cropState3;
                                this.leftImageIsVideo = z4;
                                return;
                            } else {
                                if (imageReceiver == this.rightImage) {
                                    this.rightCropState = cropState3;
                                    this.rightImageIsVideo = z4;
                                    return;
                                }
                                return;
                            }
                        }
                        imageReceiver.setImage(ImageLocation.getForObject(photoSize, tLObject2), str4, bitmapHolder != null ? new BitmapDrawable(bitmapHolder.bitmap) : null, j2, (String) null, obj2, i4);
                    }
                    z4 = z2;
                    MediaController.CropState cropState32 = cropState;
                    if (cropTransform != null) {
                    }
                    if (imageReceiver == this.leftImage) {
                    }
                }
                str4 = str6;
                webFileCreateWithWebDocument = null;
                if (document2 == null) {
                }
                z4 = z2;
                MediaController.CropState cropState322 = cropState;
                if (cropTransform != null) {
                }
                if (imageReceiver == this.leftImage) {
                }
            }
            imageReceiver.setImageBitmap(bitmap);
            return;
        }
        if (i < 0 || i >= this.secureDocuments.size()) {
            return;
        }
        this.secureDocuments.get(i);
        AndroidUtilities.getPhotoSize();
        ImageReceiver.BitmapHolder thumbForPhoto = this.currentThumb;
        if (thumbForPhoto == null || imageReceiver != this.centerImage) {
            thumbForPhoto = null;
        }
        if (thumbForPhoto == null) {
            thumbForPhoto = this.placeProvider.getThumbForPhoto(null, null, i);
        }
        SecureDocument secureDocument = (SecureDocument) this.secureDocuments.get(i);
        j = secureDocument.secureFile.size;
        ImageLocation forSecureDocument = ImageLocation.getForSecureDocument(secureDocument);
        bitmapDrawable = thumbForPhoto != null ? new BitmapDrawable(thumbForPhoto.bitmap) : null;
        parentObject = null;
        i3 = 0;
        imageReceiver2 = imageReceiver;
        imageLocation = forSecureDocument;
        str2 = "d";
        forDocument2 = null;
        str3 = null;
        str = null;
        imageReceiver2.setImage(imageLocation, str2, forDocument2, str3, bitmapDrawable, j, str, parentObject, i3);
    }

    private void setIndexToPaintingOverlay(int i, PaintingOverlay paintingOverlay) {
        String str;
        ArrayList<VideoEditedInfo.MediaEntity> arrayList;
        boolean z;
        if (paintingOverlay == null) {
            return;
        }
        paintingOverlay.reset();
        paintingOverlay.setVisibility(8);
        if (this.imagesArrLocals.isEmpty() || i < 0 || i >= this.imagesArrLocals.size()) {
            return;
        }
        Object obj = this.imagesArrLocals.get(i);
        if (obj instanceof MediaController.PhotoEntry) {
            MediaController.PhotoEntry photoEntry = (MediaController.PhotoEntry) obj;
            boolean z2 = photoEntry.isVideo;
            String str2 = photoEntry.paintPath;
            arrayList = photoEntry.mediaEntities;
            z = z2;
            str = str2;
        } else {
            if (obj instanceof MediaController.SearchImage) {
                MediaController.SearchImage searchImage = (MediaController.SearchImage) obj;
                String str3 = searchImage.paintPath;
                arrayList = searchImage.mediaEntities;
                str = str3;
            } else {
                str = null;
                arrayList = null;
            }
            z = false;
        }
        paintingOverlay.setVisibility(0);
        paintingOverlay.setData(str, arrayList, z, false, this.sendPhotoType != 11);
    }

    private void setIsAboutToSwitchToIndex(int i, boolean z, boolean z2) {
        setIsAboutToSwitchToIndex(i, z, z2, false);
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Multi-variable type inference failed */
    /* JADX WARN: Removed duplicated region for block: B:110:0x01f4  */
    /* JADX WARN: Removed duplicated region for block: B:111:0x0206  */
    /* JADX WARN: Removed duplicated region for block: B:187:0x034b  */
    /* JADX WARN: Removed duplicated region for block: B:199:0x0371  */
    /* JADX WARN: Removed duplicated region for block: B:211:0x03ac  */
    /* JADX WARN: Removed duplicated region for block: B:214:0x03b1  */
    /* JADX WARN: Removed duplicated region for block: B:220:0x03c0 A[PHI: r5
      0x03c0: PHI (r5v101 org.telegram.ui.PhotoViewer$PhotoCountView) = (r5v100 org.telegram.ui.PhotoViewer$PhotoCountView), (r5v104 org.telegram.ui.PhotoViewer$PhotoCountView) binds: [B:219:0x03be, B:212:0x03ae] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:255:0x046a  */
    /* JADX WARN: Removed duplicated region for block: B:356:0x0656  */
    /* JADX WARN: Removed duplicated region for block: B:358:0x065a A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:362:0x0666  */
    /* JADX WARN: Removed duplicated region for block: B:367:0x0671  */
    /* JADX WARN: Removed duplicated region for block: B:413:0x07b9  */
    /* JADX WARN: Removed duplicated region for block: B:420:0x07e6  */
    /* JADX WARN: Removed duplicated region for block: B:423:0x07eb  */
    /* JADX WARN: Removed duplicated region for block: B:426:0x07f2  */
    /* JADX WARN: Removed duplicated region for block: B:433:0x0813  */
    /* JADX WARN: Removed duplicated region for block: B:434:0x0815  */
    /* JADX WARN: Removed duplicated region for block: B:442:0x0838  */
    /* JADX WARN: Removed duplicated region for block: B:444:0x083b  */
    /* JADX WARN: Removed duplicated region for block: B:446:0x0849  */
    /* JADX WARN: Removed duplicated region for block: B:454:0x0879  */
    /* JADX WARN: Removed duplicated region for block: B:542:0x0af0  */
    /* JADX WARN: Removed duplicated region for block: B:569:0x0b63  */
    /* JADX WARN: Removed duplicated region for block: B:571:0x0b88  */
    /* JADX WARN: Removed duplicated region for block: B:594:0x0bea  */
    /* JADX WARN: Removed duplicated region for block: B:597:0x0bf8  */
    /* JADX WARN: Removed duplicated region for block: B:600:0x0c00  */
    /* JADX WARN: Removed duplicated region for block: B:604:0x0c0c  */
    /* JADX WARN: Removed duplicated region for block: B:607:0x0c11  */
    /* JADX WARN: Removed duplicated region for block: B:627:0x0c78  */
    /* JADX WARN: Removed duplicated region for block: B:638:0x0c8f  */
    /* JADX WARN: Removed duplicated region for block: B:641:0x0cc5  */
    /* JADX WARN: Removed duplicated region for block: B:642:0x0cc7  */
    /* JADX WARN: Removed duplicated region for block: B:645:0x0ccf  */
    /* JADX WARN: Removed duplicated region for block: B:646:0x0cd1  */
    /* JADX WARN: Removed duplicated region for block: B:649:0x0cd9  */
    /* JADX WARN: Removed duplicated region for block: B:650:0x0cdb  */
    /* JADX WARN: Removed duplicated region for block: B:653:0x0ce3  */
    /* JADX WARN: Removed duplicated region for block: B:663:0x0cf6  */
    /* JADX WARN: Removed duplicated region for block: B:667:0x0cfe A[PHI: r0
      0x0cfe: PHI (r0v122 android.widget.ImageView) = (r0v113 android.widget.ImageView), (r0v123 android.widget.ImageView), (r0v123 android.widget.ImageView) binds: [B:666:0x0cfc, B:661:0x0cf3, B:658:0x0ced] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:668:0x0d00 A[PHI: r0
      0x0d00: PHI (r0v114 android.widget.ImageView) = 
      (r0v113 android.widget.ImageView)
      (r0v113 android.widget.ImageView)
      (r0v123 android.widget.ImageView)
      (r0v123 android.widget.ImageView)
      (r0v123 android.widget.ImageView)
     binds: [B:664:0x0cf8, B:666:0x0cfc, B:654:0x0ce5, B:659:0x0cef, B:661:0x0cf3] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:674:0x0d0e  */
    /* JADX WARN: Removed duplicated region for block: B:684:0x0d22  */
    /* JADX WARN: Removed duplicated region for block: B:83:0x01a0  */
    /* JADX WARN: Removed duplicated region for block: B:89:0x01b2  */
    /* JADX WARN: Type inference failed for: r3v132 */
    /* JADX WARN: Type inference failed for: r3v133, types: [boolean, int] */
    /* JADX WARN: Type inference failed for: r3v148 */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void setIsAboutToSwitchToIndex(final int i, boolean z, boolean z2, boolean z3) {
        int i2;
        int i3;
        MessageObject messageObject;
        CharSequence restrictionReason;
        boolean z4;
        String string;
        boolean z5;
        MessageObject messageObject2;
        MediaController.CropState cropState;
        boolean z6;
        boolean z7;
        int i4;
        boolean z8;
        String str;
        int i5;
        int i6;
        MediaController.PhotoEntry photoEntry;
        boolean z9;
        boolean zIsVideoDocument;
        int i7;
        boolean z10;
        CharSequence charSequence;
        MediaController.SearchImage searchImage;
        boolean z11;
        boolean z12;
        int i8;
        boolean z13;
        float f;
        float f2;
        Object obj;
        int i9;
        String str2;
        TLRPC.Photo photo;
        boolean z14;
        int i10;
        int i11;
        boolean z15;
        String str3;
        PhotoCountView photoCountView;
        String string2;
        ChatActivity chatActivity;
        String userName;
        int i12;
        ImageView imageView;
        PorterDuffColorFilter porterDuffColorFilter;
        int i13;
        boolean z16;
        TLRPC.User currentUser;
        TLRPC.Chat currentChat;
        int i14;
        int i15;
        ActionBarMenuItem actionBarMenuItem;
        long j;
        CharSequence string3;
        MessagesController.DialogPhotos dialogPhotos;
        PhotoCountView photoCountView2;
        CharSequence charSequence2;
        boolean z17;
        int i16;
        TLRPC.Photo photo2;
        boolean z18;
        int i17;
        ChatActivity chatActivity2;
        int i18;
        TLRPC.Message message;
        String string4;
        ?? r3;
        int i19;
        int id;
        int i20;
        boolean z19;
        int id2;
        int i21;
        boolean z20;
        PhotoCountView photoCountView3;
        int i22;
        TLRPC.Message message2;
        TLRPC.Message message3;
        if (z || this.switchingToIndex != i || z3) {
            int i23 = this.switchingToIndex;
            boolean z21 = i >= i23;
            this.switchingToIndex = i;
            getFileName(i);
            if (z2) {
                TransitionSet transitionSet = new TransitionSet();
                transitionSet.addTransition(new Fade());
                transitionSet.addTransition(new ChangeBounds());
                transitionSet.setOrdering(0);
                transitionSet.setDuration(220L);
                transitionSet.setInterpolator((TimeInterpolator) CubicBezierInterpolator.DEFAULT);
                TransitionManager.beginDelayedTransition(this.itemsLayout, transitionSet);
            }
            this.menuItem.hideSubItem(23);
            this.editing = false;
            MediaController.CropState cropState2 = null;
            CharSequence charSequence3 = null;
            if (this.imagesArr.isEmpty()) {
                float f3 = BitmapDescriptorFactory.HUE_RED;
                if (!this.secureDocuments.isEmpty()) {
                    this.allowShare = false;
                    this.menuItem.showSubItem(7);
                    this.galleryButton.setVisibility(8);
                    this.galleryGap.setVisibility(8);
                    this.menuItem.hideSubItem(19);
                    this.menuItem.hideSubItem(20);
                    PhotoCountView photoCountView4 = this.countView;
                    if (photoCountView4 != null) {
                        photoCountView4.updateShow(this.secureDocuments.size() > 1, true);
                        this.countView.set(this.switchingToIndex + 1, this.secureDocuments.size());
                    }
                    this.actionBarContainer.setTitle("");
                    this.actionBarContainer.setSubtitle("", z2);
                    restrictionReason = null;
                    messageObject = null;
                    z4 = z2;
                    i2 = i23;
                    i3 = 8;
                } else if (this.imagesArrLocations.isEmpty()) {
                    if (this.imagesArrLocals.isEmpty()) {
                        i2 = i23;
                        PageBlocksAdapter pageBlocksAdapter = this.pageBlocksAdapter;
                        if (pageBlocksAdapter != null) {
                            int itemsCount = pageBlocksAdapter.getItemsCount();
                            int i24 = this.switchingToIndex;
                            if (i24 < 0 || i24 >= itemsCount) {
                                return;
                            }
                            this.menuItem.hideSubItem(19);
                            this.menuItem.hideSubItem(20);
                            this.allowShare = !MessagesController.getInstance(this.currentAccount).isChatNoForwards(-this.currentDialogId) && ((messageObject2 = this.currentMessageObject) == null || !messageObject2.hasRevealedExtendedMedia());
                            TLRPC.PageBlock pageBlock = this.pageBlocksAdapter.get(this.switchingToIndex);
                            CharSequence caption = this.pageBlocksAdapter.getCaption(this.switchingToIndex);
                            boolean zIsVideo = this.pageBlocksAdapter.isVideo(this.switchingToIndex);
                            if (zIsVideo) {
                                if (this.allowShare) {
                                    this.menuItem.showSubItem(10);
                                } else {
                                    this.menuItem.hideSubItem(10);
                                }
                                this.menuItem.checkHideMenuItem();
                                if (this.pipAvailable) {
                                    setItemVisible(this.pipItem, true, true);
                                } else {
                                    this.pipItem.setEnabled(false);
                                    setItemVisible(this.pipItem, true, true, 0.5f);
                                    pipInvalidateAvailability();
                                }
                            } else {
                                this.menuItem.hideSubItem(10);
                                setItemVisible(this.pipItem, false, true);
                            }
                            if (this.bottomLayout.getVisibility() != 8) {
                                this.bottomLayout.setVisibility(8);
                            }
                            messageObject = null;
                            this.bottomLayout.setTag(null);
                            PhotoCountView photoCountView5 = this.countView;
                            if (photoCountView5 != null) {
                                photoCountView5.updateShow(itemsCount > 1, true);
                                this.countView.set(this.switchingToIndex + 1, itemsCount);
                            }
                            if (this.currentAnimation != null || (!this.pageBlocksAdapter.isVideo(i) && this.pageBlocksAdapter.isHardwarePlayer(i))) {
                                i3 = 8;
                                this.galleryButton.setVisibility(8);
                                this.galleryGap.setVisibility(8);
                                if (this.allowShare) {
                                    this.menuItem.showSubItem(12);
                                } else {
                                    this.menuItem.hideSubItem(12);
                                }
                                this.menuItem.checkHideMenuItem();
                                string = LocaleController.getString(R.string.AttachGif);
                            } else {
                                if (itemsCount == 1) {
                                    string = LocaleController.getString(zIsVideo ? R.string.AttachVideo : R.string.AttachPhoto);
                                } else {
                                    string = null;
                                }
                                this.galleryButton.setVisibility(0);
                                this.galleryGap.setVisibility(0);
                                this.menuItem.hideSubItem(12);
                                this.menuItem.checkHideMenuItem();
                                i3 = 8;
                            }
                            this.groupedPhotosListView.fillList();
                            this.pageBlocksAdapter.updateSlideshowCell(pageBlock);
                            restrictionReason = caption;
                            z4 = z2;
                            z5 = false;
                            charSequence3 = string;
                        } else {
                            i3 = 8;
                            messageObject = null;
                            this.menuItem.hideSubItem(19);
                            this.menuItem.hideSubItem(20);
                            restrictionReason = null;
                            charSequence3 = null;
                            z4 = z2;
                        }
                    } else {
                        if (i < 0 || i >= this.imagesArrLocals.size()) {
                            return;
                        }
                        this.menuItem.hideSubItem(19);
                        this.menuItem.hideSubItem(20);
                        Object obj2 = this.imagesArrLocals.get(i);
                        if (obj2 instanceof TLRPC.BotInlineResult) {
                            TLRPC.BotInlineResult botInlineResult = (TLRPC.BotInlineResult) obj2;
                            this.currentBotInlineResult = botInlineResult;
                            TLRPC.Document document = botInlineResult.document;
                            zIsVideoDocument = document != null ? MessageObject.isVideoDocument(document) : botInlineResult.content instanceof TLRPC.TL_webDocument ? botInlineResult.type.equals(MediaStreamTrack.VIDEO_TRACK_KIND) : false;
                            restrictionReason = null;
                            str = null;
                            z4 = z2;
                            i2 = i23;
                            i7 = 0;
                            z10 = false;
                            i5 = 8;
                        } else {
                            boolean z22 = obj2 instanceof MediaController.PhotoEntry;
                            if (z22) {
                                MediaController.PhotoEntry photoEntry2 = (MediaController.PhotoEntry) obj2;
                                this.currentPathObject = photoEntry2.path;
                                boolean z23 = photoEntry2.isVideo;
                                i4 = photoEntry2.duration;
                                MediaController.CropState cropState3 = photoEntry2.cropState;
                                z6 = photoEntry2.highQuality;
                                z8 = z23;
                                cropState = cropState3;
                                z7 = false;
                            } else {
                                if (obj2 instanceof MediaController.SearchImage) {
                                    MediaController.SearchImage searchImage2 = (MediaController.SearchImage) obj2;
                                    this.currentPathObject = searchImage2.getPathToAttach();
                                    cropState = searchImage2.cropState;
                                    if (searchImage2.type == 1) {
                                        z6 = false;
                                        z7 = true;
                                    }
                                    i4 = 0;
                                    z8 = false;
                                } else {
                                    cropState = null;
                                }
                                z6 = false;
                                z7 = false;
                                i4 = 0;
                                z8 = false;
                            }
                            if (z8) {
                                boolean z24 = !this.isCurrentVideo ? false : z2;
                                int i25 = this.sendPhotoType;
                                if (i25 != -1) {
                                    this.isCurrentVideo = true;
                                }
                                if (z22) {
                                    MediaController.PhotoEntry photoEntry3 = (MediaController.PhotoEntry) obj2;
                                    VideoEditedInfo videoEditedInfo = photoEntry3.editedInfo;
                                    if (videoEditedInfo != null) {
                                        boolean z25 = videoEditedInfo.muted;
                                        float f4 = videoEditedInfo.start;
                                        f2 = videoEditedInfo.end;
                                        i11 = videoEditedInfo.compressQuality;
                                        str3 = photoEntry3.coverPath;
                                        f3 = f4;
                                        z15 = z25;
                                    } else {
                                        i11 = -1;
                                        z15 = false;
                                        f2 = 1.0f;
                                        str3 = null;
                                    }
                                    photo = photoEntry3.coverPhoto;
                                    i9 = i11;
                                    z13 = z15;
                                    f = f3;
                                    str2 = str3;
                                    obj = photoEntry3.coverPhotoParentObject;
                                    i8 = -1;
                                } else {
                                    i8 = -1;
                                    z13 = false;
                                    f = BitmapDescriptorFactory.HUE_RED;
                                    f2 = 1.0f;
                                    obj = null;
                                    i9 = -1;
                                    str2 = null;
                                    photo = null;
                                }
                                if (i25 != i8) {
                                    z14 = z24;
                                    TLRPC.Photo photo3 = photo;
                                    i2 = i23;
                                    i5 = 8;
                                    int i26 = i4;
                                    processOpenVideo(this.currentPathObject, z13, f, f2, i9);
                                    if (this.isDocumentsPicker) {
                                        str = null;
                                        showVideoTimeline(false, z2);
                                        this.videoAvatarTooltip.setVisibility(8);
                                        this.cropItem.setVisibility(8);
                                        this.cropItem.setTag(null);
                                        this.tuneItem.setVisibility(8);
                                        this.tuneItem.setTag(null);
                                        this.paintItem.setVisibility(8);
                                        this.paintItem.setTag(null);
                                        this.rotateItem.setVisibility(8);
                                        this.rotateItem.setTag(null);
                                        this.mirrorItem.setVisibility(8);
                                        this.mirrorItem.setTag(null);
                                        AndroidUtilities.updateViewVisibilityAnimated(this.muteButton, false, 1.0f, z2);
                                        AndroidUtilities.updateViewVisibilityAnimated(this.editCoverButton, false, 1.0f, z2);
                                        this.compressItem.setVisibility(8);
                                    } else {
                                        showVideoTimeline(true, z2);
                                        if (this.sendPhotoType != 1) {
                                            this.videoAvatarTooltip.setVisibility(8);
                                            this.cropItem.setVisibility(0);
                                            this.cropItem.setTag(1);
                                            this.rotateItem.setVisibility(8);
                                            str = null;
                                            this.rotateItem.setTag(null);
                                            this.mirrorItem.setVisibility(8);
                                            this.mirrorItem.setTag(null);
                                            AndroidUtilities.updateViewVisibilityAnimated(this.muteButton, true, 1.0f, z2);
                                            EditCoverButton editCoverButton = this.editCoverButton;
                                            ChatActivity chatActivity3 = this.parentChatActivity;
                                            AndroidUtilities.updateViewVisibilityAnimated(editCoverButton, chatActivity3 != null && (UserObject.isUserSelf(chatActivity3.getCurrentUser()) || (ChatObject.isChannelAndNotMegaGroup(this.parentChatActivity.getCurrentChat()) && !(i26 < 20 && photo3 == null && str2 == null))), 1.0f, z2);
                                            EditCoverButton editCoverButton2 = this.editCoverButton;
                                            if (photo3 != null) {
                                                editCoverButton2.setImage(photo3, obj);
                                            } else {
                                                editCoverButton2.setImage(str2);
                                            }
                                            i10 = 0;
                                            this.compressItem.setVisibility(0);
                                        } else {
                                            i10 = 0;
                                            str = null;
                                            this.videoAvatarTooltip.setVisibility(0);
                                            this.cropItem.setVisibility(8);
                                            this.cropItem.setTag(null);
                                            this.rotateItem.setVisibility(0);
                                            this.rotateItem.setTag(1);
                                            this.mirrorItem.setVisibility(0);
                                            this.mirrorItem.setTag(1);
                                            AndroidUtilities.updateViewVisibilityAnimated(this.muteButton, false, 1.0f, z2);
                                            AndroidUtilities.updateViewVisibilityAnimated(this.editCoverButton, false, 1.0f, z2);
                                            this.compressItem.setVisibility(8);
                                        }
                                        this.tuneItem.setVisibility(i10);
                                        this.tuneItem.setTag(1);
                                        this.paintItem.setVisibility(i10);
                                        this.paintItem.setTag(1);
                                    }
                                } else {
                                    i2 = i23;
                                    z14 = z24;
                                    str = null;
                                    i5 = 8;
                                }
                                z4 = z14;
                            } else {
                                str = null;
                                i2 = i23;
                                i5 = 8;
                                showVideoTimeline(false, z2);
                                this.videoAvatarTooltip.setVisibility(8);
                                AndroidUtilities.updateViewVisibilityAnimated(this.muteButton, false, 1.0f, z2);
                                AndroidUtilities.updateViewVisibilityAnimated(this.editCoverButton, false, 1.0f, z2);
                                boolean z26 = this.isCurrentVideo ? false : z2;
                                this.isCurrentVideo = false;
                                if (!z22 || (z9 = (photoEntry = (MediaController.PhotoEntry) obj2).isVideo) || z9) {
                                    this.compressItem.setVisibility(8);
                                    if (!z7 || (i6 = this.sendPhotoType) == 10 || this.isDocumentsPicker) {
                                        this.paintItem.setVisibility(8);
                                        this.paintItem.setTag(null);
                                        this.cropItem.setVisibility(8);
                                        this.rotateItem.setVisibility(8);
                                        this.mirrorItem.setVisibility(8);
                                        this.tuneItem.setVisibility(8);
                                        this.tuneItem.setTag(null);
                                    } else {
                                        if (i6 == 4 || i6 == 5) {
                                            this.paintItem.setVisibility(8);
                                            this.paintItem.setTag(null);
                                            this.tuneItem.setVisibility(8);
                                            this.tuneItem.setTag(null);
                                        } else {
                                            this.paintItem.setVisibility(0);
                                            this.paintItem.setTag(1);
                                            this.tuneItem.setVisibility(0);
                                            this.tuneItem.setTag(1);
                                        }
                                        this.cropItem.setVisibility(this.sendPhotoType != 1 ? 0 : 8);
                                        this.rotateItem.setVisibility(this.sendPhotoType != 1 ? 8 : 0);
                                        this.mirrorItem.setVisibility(this.sendPhotoType != 1 ? 8 : 0);
                                    }
                                    if (z2) {
                                        this.actionBar.beginDelayedTransition();
                                    }
                                    this.actionBarContainer.setSubtitle("");
                                    z4 = z26;
                                } else {
                                    if ((this.currentIndex == i ? getCurrentVideoEditedInfo() : photoEntry.editedInfo) == null) {
                                        this.compressItem.setVisibility(0);
                                        this.compressItem.setPhotoState(z6);
                                    }
                                    if (z7) {
                                        this.paintItem.setVisibility(8);
                                        this.paintItem.setTag(null);
                                        this.cropItem.setVisibility(8);
                                        this.rotateItem.setVisibility(8);
                                        this.mirrorItem.setVisibility(8);
                                        this.tuneItem.setVisibility(8);
                                        this.tuneItem.setTag(null);
                                        if (z2) {
                                        }
                                        this.actionBarContainer.setSubtitle("");
                                        z4 = z26;
                                    }
                                }
                            }
                            if (z22) {
                                MediaController.PhotoEntry photoEntry4 = (MediaController.PhotoEntry) obj2;
                                this.fromCamera = photoEntry4.bucketId == 0 && photoEntry4.dateTaken == 0 && this.imagesArrLocals.size() == 1;
                                charSequence = this.hasCaptionForAllMedia ? this.captionForAllMedia : photoEntry4.caption;
                                searchImage = photoEntry4;
                            } else if (obj2 instanceof MediaController.SearchImage) {
                                MediaController.SearchImage searchImage3 = (MediaController.SearchImage) obj2;
                                charSequence = searchImage3.caption;
                                searchImage = searchImage3;
                            } else {
                                restrictionReason = str;
                                cropState2 = cropState;
                                zIsVideoDocument = z8;
                                i7 = 0;
                                z10 = false;
                            }
                            int i27 = searchImage.ttl;
                            boolean z27 = searchImage.isFiltered;
                            boolean z28 = searchImage.isPainted;
                            z11 = searchImage.isCropped;
                            z12 = z28;
                            zIsVideoDocument = z8;
                            z10 = z27;
                            i7 = i27;
                            restrictionReason = charSequence;
                            cropState2 = cropState;
                            if (this.bottomLayout.getVisibility() != i5) {
                                this.bottomLayout.setVisibility(i5);
                            }
                            this.bottomLayout.setTag(str);
                            photoCountView = this.countView;
                            if (photoCountView != null) {
                                photoCountView.updateShow(false, z2);
                            }
                            if (this.fromCamera) {
                                string2 = str;
                            } else {
                                string2 = LocaleController.getString(zIsVideoDocument ? R.string.AttachVideo : R.string.AttachPhoto);
                            }
                            chatActivity = this.parentChatActivity;
                            if (chatActivity == null) {
                                if (chatActivity.getChatMode() == 3) {
                                    long savedDialogId = this.parentChatActivity.getSavedDialogId();
                                    MessagesController messagesController = this.parentChatActivity.getMessagesController();
                                    if (savedDialogId >= 0) {
                                        currentUser = messagesController.getUser(Long.valueOf(savedDialogId));
                                        currentChat = null;
                                    } else {
                                        currentChat = messagesController.getChat(Long.valueOf(-savedDialogId));
                                        currentUser = null;
                                    }
                                } else {
                                    currentUser = this.parentChatActivity.getCurrentUser();
                                    currentChat = this.parentChatActivity.getCurrentChat();
                                }
                                if (currentChat != null) {
                                    userName = currentChat.title;
                                } else {
                                    if (UserObject.isUserSelf(currentUser)) {
                                        i14 = this.parentChatActivity.getChatMode() == 3 ? R.string.MyNotes : R.string.SavedMessages;
                                    } else if (UserObject.isAnonymous(currentUser)) {
                                        i14 = R.string.AnonymousForward;
                                    } else {
                                        userName = UserObject.getUserName(currentUser);
                                    }
                                    userName = LocaleController.getString(i14);
                                }
                            } else {
                                userName = string2;
                            }
                            i12 = this.sendPhotoType;
                            if (i12 != 0 || i12 == 4 || ((i12 == 2 || i12 == 5) && this.imagesArrLocals.size() > 1)) {
                                this.checkImageView.setChecked(this.placeProvider.isPhotoChecked(this.switchingToIndex), false);
                            }
                            updateCaptionTextForCurrentPhoto(obj2);
                            PorterDuffColorFilter porterDuffColorFilter2 = new PorterDuffColorFilter(getThemedColor(Theme.key_chat_editMediaButton), PorterDuff.Mode.MULTIPLY);
                            this.captionEdit.setIsVideo(zIsVideoDocument);
                            this.captionEdit.setTimer(i7);
                            this.topCaptionEdit.setIsVideo(zIsVideoDocument);
                            this.topCaptionEdit.setTimer(i7);
                            this.paintItem.setColorFilter(!z12 ? porterDuffColorFilter2 : null);
                            this.cropItem.setColorFilter(!z11 ? porterDuffColorFilter2 : null);
                            this.tuneItem.setColorFilter(!z10 ? porterDuffColorFilter2 : null);
                            if (this.fromCamera) {
                                imageView = this.mirrorItem;
                                if (cropState2 == null || !cropState2.mirrored) {
                                }
                            } else {
                                imageView = this.mirrorItem;
                                porterDuffColorFilter = (cropState2 == null || ((!(z16 = this.isCurrentVideo) || cropState2.mirrored) && (z16 || !cropState2.mirrored))) ? null : porterDuffColorFilter2;
                            }
                            imageView.setColorFilter(porterDuffColorFilter);
                            this.rotateItem.setColorFilter((cropState2 != null || cropState2.transformRotation == 0) ? null : porterDuffColorFilter2);
                            this.editing = !this.needCaptionLayout && ((i13 = this.sendPhotoType) == 0 || i13 == 2 || i13 == -1);
                            charSequence3 = userName;
                            i3 = 8;
                            messageObject = null;
                        }
                        z12 = false;
                        z11 = false;
                        if (this.bottomLayout.getVisibility() != i5) {
                        }
                        this.bottomLayout.setTag(str);
                        photoCountView = this.countView;
                        if (photoCountView != null) {
                        }
                        if (this.fromCamera) {
                        }
                        chatActivity = this.parentChatActivity;
                        if (chatActivity == null) {
                        }
                        i12 = this.sendPhotoType;
                        if (i12 != 0) {
                            this.checkImageView.setChecked(this.placeProvider.isPhotoChecked(this.switchingToIndex), false);
                            updateCaptionTextForCurrentPhoto(obj2);
                            PorterDuffColorFilter porterDuffColorFilter22 = new PorterDuffColorFilter(getThemedColor(Theme.key_chat_editMediaButton), PorterDuff.Mode.MULTIPLY);
                            this.captionEdit.setIsVideo(zIsVideoDocument);
                            this.captionEdit.setTimer(i7);
                            this.topCaptionEdit.setIsVideo(zIsVideoDocument);
                            this.topCaptionEdit.setTimer(i7);
                            this.paintItem.setColorFilter(!z12 ? porterDuffColorFilter22 : null);
                            this.cropItem.setColorFilter(!z11 ? porterDuffColorFilter22 : null);
                            this.tuneItem.setColorFilter(!z10 ? porterDuffColorFilter22 : null);
                            if (this.fromCamera) {
                            }
                            imageView.setColorFilter(porterDuffColorFilter);
                            if (cropState2 != null) {
                                this.rotateItem.setColorFilter((cropState2 != null || cropState2.transformRotation == 0) ? null : porterDuffColorFilter22);
                                if (this.needCaptionLayout) {
                                    this.editing = !this.needCaptionLayout && ((i13 = this.sendPhotoType) == 0 || i13 == 2 || i13 == -1);
                                    charSequence3 = userName;
                                    i3 = 8;
                                    messageObject = null;
                                }
                            }
                        }
                    }
                } else {
                    if (i < 0 || i >= this.imagesArrLocations.size()) {
                        return;
                    }
                    this.menuItem.hideSubItem(19);
                    this.menuItem.hideSubItem(20);
                    if (!this.canEditAvatar || this.avatarsArr.isEmpty()) {
                        i15 = 7;
                        this.menuItem.hideSubItem(15);
                        this.menuItem.hideSubItem(14);
                        actionBarMenuItem = this.menuItem;
                    } else {
                        this.menuItem.showSubItem(15);
                        if (isCurrentAvatarSet()) {
                            this.menuItem.hideSubItem(14);
                        } else {
                            this.menuItem.showSubItem(14);
                        }
                        if (this.avatarsDialogId <= 0) {
                            TLRPC.Chat chat = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(-this.avatarsDialogId));
                            if (!isCurrentAvatarSet() && !MessageObject.canDeleteMessage(this.currentAccount, false, (TLRPC.Message) this.imagesArrMessages.get(i), chat)) {
                                actionBarMenuItem = this.menuItem;
                                i15 = 7;
                            }
                        }
                        this.menuItem.showSubItem(7);
                        j = this.avatarsDialogId;
                        if (j == 0) {
                            string3 = DialogObject.getName(j);
                            ImageLocation imageLocation = (ImageLocation) this.imagesArrLocations.get(i);
                            if (imageLocation == null || (photo2 = imageLocation.photo) == null) {
                                this.actionBarContainer.setSubtitle("", z2);
                            } else {
                                this.actionBarContainer.setSubtitle(LocaleController.formatDateTime(photo2.date, true), z2);
                            }
                            this.menuItem.showSubItem(23);
                        } else {
                            string3 = null;
                        }
                        dialogPhotos = this.dialogPhotos;
                        if (dialogPhotos != null) {
                            dialogPhotos.loadAfter(i, z21);
                        }
                        photoCountView2 = this.countView;
                        if (photoCountView2 != null) {
                            photoCountView2.updateShow(this.imagesArrLocations.size() > 1, true);
                            this.countView.set(this.switchingToIndex + 1, this.imagesArrLocations.size());
                        }
                        charSequence2 = this.customTitle;
                        if (charSequence2 == null) {
                            string3 = charSequence2;
                        } else if (this.isEvent) {
                            string3 = LocaleController.getString(R.string.AttachPhoto);
                        }
                        z17 = this.avatarsDialogId == 0 && MessagesController.getInstance(this.currentAccount).isChatNoForwards(-this.avatarsDialogId);
                        if (z17) {
                            this.galleryButton.setVisibility(0);
                            this.galleryGap.setVisibility(0);
                        } else {
                            this.galleryButton.setVisibility(8);
                            this.galleryGap.setVisibility(8);
                        }
                        this.allowShare = !z17;
                        this.menuItem.showSubItem(9);
                        this.menuItem.checkHideMenuItem();
                        this.groupedPhotosListView.fillList();
                        this.editing = !this.needCaptionLayout && ((i16 = this.sendPhotoType) == 0 || i16 == 2 || i16 == -1);
                        messageObject = null;
                        z4 = z2;
                        i2 = i23;
                        i3 = 8;
                        z5 = false;
                        charSequence3 = string3;
                        restrictionReason = null;
                    }
                    actionBarMenuItem.hideSubItem(i15);
                    j = this.avatarsDialogId;
                    if (j == 0) {
                    }
                    dialogPhotos = this.dialogPhotos;
                    if (dialogPhotos != null) {
                    }
                    photoCountView2 = this.countView;
                    if (photoCountView2 != null) {
                    }
                    charSequence2 = this.customTitle;
                    if (charSequence2 == null) {
                    }
                    if (this.avatarsDialogId == 0) {
                        if (z17) {
                        }
                        this.allowShare = !z17;
                        this.menuItem.showSubItem(9);
                        this.menuItem.checkHideMenuItem();
                        this.groupedPhotosListView.fillList();
                        if (this.needCaptionLayout) {
                            this.editing = !this.needCaptionLayout && ((i16 = this.sendPhotoType) == 0 || i16 == 2 || i16 == -1);
                            messageObject = null;
                            z4 = z2;
                            i2 = i23;
                            i3 = 8;
                            z5 = false;
                            charSequence3 = string3;
                            restrictionReason = null;
                        }
                    }
                }
                z5 = false;
            } else {
                int i28 = this.switchingToIndex;
                if (i28 < 0 || i28 >= this.imagesArr.size()) {
                    return;
                }
                final MessageObject messageObject3 = (MessageObject) this.imagesArr.get(this.switchingToIndex);
                messageObject3.updateTranslation();
                boolean zIsVideo2 = messageObject3.isVideo();
                CharSequence charSequenceCreateFromInfoString = FilteredSearchView.createFromInfoString(messageObject3, this.opennedFromMedia && !this.openedFromProfile, 0);
                this.actionBarContainer.setSubtitle((messageObject3.isQuickReply() || messageObject3.isSponsored() || (message3 = messageObject3.messageOwner) == null) ? null : LocaleController.formatDateAudio(message3.date, false), z2);
                boolean zIsInvoice = messageObject3.isInvoice();
                boolean z29 = MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject3.getChatId()) || ((message2 = messageObject3.messageOwner) != null && message2.noforwards) || messageObject3.hasRevealedExtendedMedia();
                FrameLayout frameLayout = this.bottomLayout;
                if (zIsVideo2) {
                    frameLayout.setVisibility(0);
                    this.bottomLayout.setTag(1);
                } else {
                    frameLayout.setVisibility(8);
                    this.bottomLayout.setTag(null);
                }
                if (zIsInvoice) {
                    setItemVisible(this.masksItem, false, z2);
                    setItemVisible(this.editItem, false, z2);
                    this.menuItem.hideSubItem(7);
                    this.menuItem.hideSubItem(10);
                    restrictionReason = MessageObject.getMedia(messageObject3.messageOwner).description;
                    this.allowShare = false;
                    this.menuItem.hideSubItem(19);
                    this.menuItem.hideSubItem(20);
                } else {
                    final TranslateController translateController = MessagesController.getInstance(this.currentAccount).getTranslateController();
                    if (i23 != this.switchingToIndex) {
                        this.captionTranslated = false;
                        this.captionDetectedLanguage = null;
                    }
                    if (translateController.isContextTranslateEnabled()) {
                        translateController.detectPhotoLanguage(messageObject3, new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda66
                            @Override // org.telegram.messenger.Utilities.Callback
                            public final void run(Object obj3) {
                                this.f$0.lambda$setIsAboutToSwitchToIndex$120(i, translateController, messageObject3, (String) obj3);
                            }
                        });
                    }
                    if (!translateController.isContextTranslateEnabled() || !translateController.canTranslatePhoto(messageObject3, this.captionDetectedLanguage)) {
                        i17 = 20;
                        this.menuItem.hideSubItem(19);
                    } else if (this.captionTranslated) {
                        this.menuItem.showSubItem(20);
                        this.menuItem.hideSubItem(19);
                        this.allowShare = !z29;
                        if (messageObject3.isNewGif() && this.allowShare && !DialogObject.isEncryptedDialog(messageObject3.getDialogId())) {
                            this.menuItem.showSubItem(12);
                        }
                        chatActivity2 = this.parentChatActivity;
                        if (messageObject3.canDeleteMessage(chatActivity2 == null && chatActivity2.isInScheduleMode(), null) || this.slideshowMessageId != 0) {
                            this.menuItem.hideSubItem(7);
                        } else {
                            this.menuItem.showSubItem(7);
                        }
                        this.menuItem.checkHideMenuItem();
                        boolean z30 = (messageObject3.getDocument() != null || messageObject3.canPreviewDocument() || messageObject3.getMimeType().startsWith("video/")) && !this.isEmbedVideo && ((i18 = messageObject3.messageOwner.ttl) == 0 || i18 >= 3600) && !z29 && canSendMediaToParentChatActivity() && !this.opennedFromMedia;
                        if (this.isEmbedVideo) {
                            this.menuItem.showSubItem(10);
                            setItemVisible(this.editItem, false, false);
                            setItemVisible(this.pipItem, true, false);
                        } else if (zIsVideo2) {
                            if (!z29 || (this.slideshowMessageId != 0 ? !(MessageObject.getMedia(((MessageObject) this.imagesArr.get(0)).messageOwner).webpage == null || MessageObject.getMedia(((MessageObject) this.imagesArr.get(0)).messageOwner).webpage.url == null) : !(MessageObject.getMedia(messageObject3.messageOwner).webpage == null || MessageObject.getMedia(messageObject3.messageOwner).webpage.url == null))) {
                                this.menuItem.showSubItem(10);
                            } else {
                                this.menuItem.hideSubItem(10);
                            }
                            boolean z31 = this.masksItem.getVisibility() == 0;
                            if (z31) {
                                setItemVisible(this.masksItem, false, false);
                            }
                            if (z29) {
                                setItemVisible(this.pipItem, false, true);
                            } else if (this.pipAvailable) {
                                setItemVisible(this.pipItem, true, !z31 && this.editItem.getAlpha() <= BitmapDescriptorFactory.HUE_RED);
                            } else {
                                this.pipItem.setEnabled(false);
                                setItemVisible(this.pipItem, true, !z31 && this.editItem.getAlpha() <= BitmapDescriptorFactory.HUE_RED, 0.5f);
                                pipInvalidateAvailability();
                            }
                            setItemVisible(this.editItem, false, false);
                            if (!messageObject3.hasAttachedStickers() || DialogObject.isEncryptedDialog(messageObject3.getDialogId())) {
                                this.menuItem.hideSubItem(13);
                            } else {
                                this.menuItem.showSubItem(13);
                            }
                            this.menuItem.checkHideMenuItem();
                        } else {
                            this.speedItem.setVisibility(8);
                            this.videoItem.setVisibility(8);
                            this.speedGap.setVisibility(8);
                            this.menuItem.hideSubItem(10);
                            this.menuItem.checkHideMenuItem();
                            boolean z32 = this.pipItem.getVisibility() == 0;
                            boolean z33 = messageObject3.hasAttachedStickers() && !DialogObject.isEncryptedDialog(messageObject3.getDialogId());
                            if (z32) {
                                setItemVisible(this.pipItem, false, (z33 || z30) ? false : true);
                            }
                            setItemVisible(this.editItem, z30, (!z2 || z32 || z33) ? false : true);
                            setItemVisible(this.masksItem, z33, !z32);
                        }
                        restrictionReason = MessagesController.getInstance(messageObject3.currentAccount).getRestrictionReason(messageObject3.messageOwner.restriction_reason);
                        if (TextUtils.isEmpty(restrictionReason)) {
                            if (!this.captionTranslated || (message = messageObject3.messageOwner) == null || message.translatedText == null || !TextUtils.equals(message.translatedToLanguage, TranslateAlert2.getToLanguage())) {
                                restrictionReason = messageObject3.caption;
                                z5 = this.captionTranslated;
                                if (this.currentAnimation != null) {
                                    this.galleryButton.setVisibility(8);
                                    this.galleryGap.setVisibility(8);
                                    this.menuItem.hideSubItem(9);
                                    setItemVisible(this.editItem, false, z2);
                                    ChatActivity chatActivity4 = this.parentChatActivity;
                                    if (!messageObject3.canDeleteMessage(chatActivity4 != null && chatActivity4.isInScheduleMode(), null)) {
                                        this.menuItem.hideSubItem(7);
                                    }
                                    this.allowShare = !z29;
                                }
                                if (messageObject3.isSponsored()) {
                                    ChatActivity chatActivity5 = this.parentChatActivity;
                                    if (chatActivity5 != null && chatActivity5.getChatMode() == 5) {
                                        photoCountView3 = this.countView;
                                        if (photoCountView3 != null) {
                                        }
                                    } else if (this.currentFiltered && (this.currentFilterTag != null || !TextUtils.isEmpty(this.currentFilterQuery))) {
                                        PhotoCountView photoCountView6 = this.countView;
                                        if (photoCountView6 != null) {
                                            photoCountView6.updateShow(true, z2);
                                            this.countView.set(this.switchingToIndex + 1, this.imagesArr.size());
                                        }
                                    } else if (this.totalImagesCount + this.totalImagesCountMerge == 0 || this.needSearchImageInArr) {
                                        if (this.slideshowMessageId == 0 && (MessageObject.getMedia(messageObject3.messageOwner) instanceof TLRPC.TL_messageMediaWebPage)) {
                                            PhotoCountView photoCountView7 = this.countView;
                                            if (photoCountView7 != null) {
                                                photoCountView7.updateShow(false, z2);
                                            }
                                            if (this.isEmbedVideo) {
                                                string4 = "YouTube";
                                                charSequence3 = string4;
                                            } else {
                                                int i29 = messageObject3.canPreviewDocument() ? R.string.AttachDocument : messageObject3.isVideo() ? R.string.AttachVideo : messageObject3.isGif() ? R.string.AttachGif : R.string.AttachPhoto;
                                                string4 = LocaleController.getString(i29);
                                                charSequence3 = string4;
                                            }
                                        } else if (zIsInvoice) {
                                            PhotoCountView photoCountView8 = this.countView;
                                            if (photoCountView8 != null) {
                                                photoCountView8.updateShow(false, z2);
                                            }
                                            string4 = MessageObject.getMedia(messageObject3.messageOwner).title;
                                            charSequence3 = string4;
                                        } else if (messageObject3.isVideo()) {
                                            PhotoCountView photoCountView9 = this.countView;
                                            if (photoCountView9 != null) {
                                                photoCountView9.updateShow(false, z2);
                                            }
                                            string4 = LocaleController.getString(i29);
                                            charSequence3 = string4;
                                        } else if (messageObject3.isGif()) {
                                            PhotoCountView photoCountView10 = this.countView;
                                            if (photoCountView10 != null) {
                                                photoCountView10.updateShow(false, z2);
                                            }
                                            string4 = LocaleController.getString(i29);
                                            charSequence3 = string4;
                                        } else if (messageObject3.getDocument() != null) {
                                            PhotoCountView photoCountView11 = this.countView;
                                            if (photoCountView11 != null) {
                                                photoCountView11.updateShow(false, z2);
                                            }
                                            string4 = LocaleController.getString(i29);
                                            charSequence3 = string4;
                                        }
                                        if (DialogObject.isEncryptedDialog(this.currentDialogId)) {
                                            setItemVisible(this.sendItem, false, false);
                                            if (this.isEmbedVideo) {
                                                this.allowShare = false;
                                                this.galleryButton.setVisibility(8);
                                                this.galleryGap.setVisibility(8);
                                                this.menuItem.hideSubItem(9);
                                                setItemVisible(this.editItem, false, z2);
                                                this.groupedPhotosListView.fillList();
                                                messageObject = messageObject3;
                                                z4 = z2;
                                                i2 = i23;
                                                i3 = 8;
                                            }
                                        } else {
                                            setItemVisible(this.sendItem, false, false);
                                            if (this.isEmbedVideo) {
                                            }
                                        }
                                    } else if (this.opennedFromMedia) {
                                        if (this.startOffset + this.imagesArr.size() < this.totalImagesCount + this.totalImagesCountMerge && !this.loadingMoreImages && this.switchingToIndex > this.imagesArr.size() - 5) {
                                            if (this.imagesArr.isEmpty()) {
                                                id2 = 0;
                                            } else {
                                                ArrayList arrayList = this.imagesArr;
                                                id2 = ((MessageObject) arrayList.get(arrayList.size() - 1)).getId();
                                            }
                                            if (!this.endReached[0] || this.mergeDialogId == 0) {
                                                i21 = id2;
                                                z20 = false;
                                            } else if (!this.imagesArr.isEmpty()) {
                                                ArrayList arrayList2 = this.imagesArr;
                                                if (((MessageObject) arrayList2.get(arrayList2.size() - 1)).getDialogId() != this.mergeDialogId) {
                                                    z20 = true;
                                                    i21 = 0;
                                                } else {
                                                    i21 = id2;
                                                    z20 = true;
                                                }
                                            }
                                            if (!this.placeProvider.loadMore()) {
                                                MediaDataController.getInstance(this.currentAccount).loadMedia(!z20 ? this.currentDialogId : this.mergeDialogId, 40, i21, 0, this.sharedMediaType, this.topicId, 1, this.classGuid, 0, this.currentFilterTag, null);
                                                this.loadingMoreImages = true;
                                            }
                                        }
                                        if (this.startOffset > 0 && this.switchingToIndex < 5 && !this.imagesArr.isEmpty()) {
                                            int id3 = ((MessageObject) this.imagesArr.get(0)).getId();
                                            if (!this.placeProvider.loadMore()) {
                                                MediaDataController.getInstance(this.currentAccount).loadMedia(this.currentDialogId, 40, 0, id3, this.sharedMediaType, this.topicId, 1, this.classGuid, 0, this.currentFilterTag, null);
                                                this.loadingMoreImages = true;
                                            }
                                        }
                                        PhotoCountView photoCountView12 = this.countView;
                                        if (photoCountView12 != null) {
                                            photoCountView12.updateShow(this.openedFromProfile, z2);
                                            PhotoCountView photoCountView13 = this.countView;
                                            int i30 = this.totalImagesCount + this.totalImagesCountMerge;
                                            photoCountView13.set(i30 - (this.startOffset + this.switchingToIndex), i30);
                                        }
                                    } else {
                                        if (this.imagesArr.size() >= this.totalImagesCount + this.totalImagesCountMerge || this.loadingMoreImages || this.switchingToIndex >= 5) {
                                            r3 = 1;
                                        } else {
                                            if (this.imagesArr.isEmpty()) {
                                                id = 0;
                                                i19 = 0;
                                            } else {
                                                i19 = 0;
                                                id = ((MessageObject) this.imagesArr.get(0)).getId();
                                            }
                                            if (!this.endReached[i19] || this.mergeDialogId == 0) {
                                                i20 = id;
                                                z19 = false;
                                            } else if (this.imagesArr.isEmpty() || ((MessageObject) this.imagesArr.get(i19)).getDialogId() == this.mergeDialogId) {
                                                i20 = id;
                                                z19 = true;
                                            } else {
                                                z19 = true;
                                                i20 = 0;
                                            }
                                            MediaDataController.getInstance(this.currentAccount).loadMedia(!z19 ? this.currentDialogId : this.mergeDialogId, 80, i20, 0, this.sharedMediaType, this.topicId, 1, this.classGuid, 0, this.currentFilterTag, null);
                                            r3 = 1;
                                            this.loadingMoreImages = true;
                                        }
                                        PhotoCountView photoCountView14 = this.countView;
                                        if (photoCountView14 != 0) {
                                            photoCountView14.updateShow(r3, z2);
                                            this.countView.set(((this.totalImagesCount + this.totalImagesCountMerge) - this.imagesArr.size()) + this.switchingToIndex + r3, this.totalImagesCount + this.totalImagesCountMerge);
                                        }
                                    }
                                    charSequence3 = charSequenceCreateFromInfoString;
                                    if (DialogObject.isEncryptedDialog(this.currentDialogId)) {
                                    }
                                } else {
                                    photoCountView3 = this.countView;
                                    if (photoCountView3 != null) {
                                        photoCountView3.updateShow(false, z2);
                                    }
                                    charSequence3 = charSequenceCreateFromInfoString;
                                    if ((DialogObject.isEncryptedDialog(this.currentDialogId) && !this.isEmbedVideo) || z29) {
                                        setItemVisible(this.sendItem, false, false);
                                    }
                                    if (this.isEmbedVideo || (((i22 = messageObject3.messageOwner.ttl) != 0 && i22 < 3600) || z29)) {
                                        this.allowShare = false;
                                        this.galleryButton.setVisibility(8);
                                        this.galleryGap.setVisibility(8);
                                        this.menuItem.hideSubItem(9);
                                        setItemVisible(this.editItem, false, z2);
                                    } else {
                                        this.allowShare = true;
                                        this.galleryButton.setVisibility(0);
                                        this.galleryGap.setVisibility(0);
                                        this.menuItem.showSubItem(9);
                                    }
                                    this.groupedPhotosListView.fillList();
                                    messageObject = messageObject3;
                                    z4 = z2;
                                    i2 = i23;
                                    i3 = 8;
                                }
                            } else {
                                restrictionReason = postProcessTranslated(messageObject3);
                            }
                        }
                    } else {
                        i17 = 20;
                        this.menuItem.showSubItem(19);
                    }
                    this.menuItem.hideSubItem(i17);
                    this.allowShare = !z29;
                    if (messageObject3.isNewGif()) {
                        this.menuItem.showSubItem(12);
                    }
                    chatActivity2 = this.parentChatActivity;
                    if (chatActivity2 == null) {
                        if (messageObject3.canDeleteMessage(chatActivity2 == null && chatActivity2.isInScheduleMode(), null)) {
                            this.menuItem.hideSubItem(7);
                            this.menuItem.checkHideMenuItem();
                            if (messageObject3.getDocument() != null) {
                                if (this.isEmbedVideo) {
                                }
                                restrictionReason = MessagesController.getInstance(messageObject3.currentAccount).getRestrictionReason(messageObject3.messageOwner.restriction_reason);
                                if (TextUtils.isEmpty(restrictionReason)) {
                                }
                            } else {
                                if (this.isEmbedVideo) {
                                }
                                restrictionReason = MessagesController.getInstance(messageObject3.currentAccount).getRestrictionReason(messageObject3.messageOwner.restriction_reason);
                                if (TextUtils.isEmpty(restrictionReason)) {
                                }
                            }
                        }
                    }
                }
                z5 = false;
                if (this.currentAnimation != null) {
                }
                if (messageObject3.isSponsored()) {
                }
            }
            boolean z34 = (this.editing && this.setAvatarFor == null) || this.sendPhotoType == 11;
            this.fancyShadows = z34;
            this.actionBar.setBackgroundColor((z34 || this.setAvatarFor != null) ? 0 : 2130706432);
            this.actionBarContainer.setTextShadows(this.fancyShadows);
            View view = this.navigationBar;
            if (!this.fancyShadows || this.sendPhotoType == 11) {
                i3 = 0;
            }
            view.setVisibility(i3);
            if (this.currentEditMode == 0) {
                this.navigationBar.setBackgroundColor(this.fancyShadows ? this.sendPhotoType == 11 ? 1711276032 : 0 : this.sendPhotoType == 11 ? -16777216 : 2130706432);
            }
            if (charSequence3 != null) {
                if (z2) {
                    int i31 = i2;
                    if (i31 == i) {
                        this.actionBarContainer.setTitleAnimated(charSequence3, true, true);
                    } else {
                        boolean z35 = true;
                        PhotoViewerActionBarContainer photoViewerActionBarContainer = this.actionBarContainer;
                        if (i31 > i) {
                            z18 = false;
                        } else {
                            z18 = false;
                            z35 = false;
                        }
                        photoViewerActionBarContainer.setTitleAnimated(charSequence3, z18, z35);
                    }
                } else {
                    this.actionBarContainer.setTitle(charSequence3);
                }
            }
            setCurrentCaption(messageObject, restrictionReason, z5, z4);
        }
    }

    private void setItemVisible(View view, boolean z, boolean z2) {
        setItemVisible(view, z, z2, 1.0f);
    }

    private void setItemVisible(final View view, final boolean z, boolean z2, float f) {
        Boolean bool = (Boolean) this.actionBarItemsVisibility.get(view);
        if (bool == null || bool.booleanValue() != z) {
            this.actionBarItemsVisibility.put(view, Boolean.valueOf(z));
            view.animate().cancel();
            float f2 = (z ? 1.0f : BitmapDescriptorFactory.HUE_RED) * f;
            if (!z2 || bool == null) {
                view.setVisibility(z ? 0 : 8);
                view.setAlpha(f2);
                updateActionBarTitlePadding();
            } else {
                if (z) {
                    view.setVisibility(0);
                }
                view.animate().alpha(f2).setDuration(100L).setUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda137
                    @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                    public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                        this.f$0.lambda$setItemVisible$117(valueAnimator);
                    }
                }).setInterpolator(new LinearInterpolator()).withEndAction(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda138
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$setItemVisible$118(z, view);
                    }
                }).start();
            }
        }
    }

    private void setMenuItemIcon(boolean z, boolean z2) {
        AnimatedTextView.AnimatedTextDrawable animatedTextDrawable;
        String str;
        if (this.speedItem.getVisibility() == 0 && Math.abs(this.currentVideoSpeed - 1.0f) >= 0.001f) {
            animatedTextDrawable = this.videoItemIcon.topText;
            str = SpeedIconDrawable.formatNumber(this.currentVideoSpeed) + "x";
        } else {
            animatedTextDrawable = this.videoItemIcon.topText;
            str = "";
        }
        animatedTextDrawable.setText(str, z);
        this.speedItem.setSpeed(this.currentVideoSpeed, z);
        this.chooseSpeedLayout.update(this.currentVideoSpeed, z2);
    }

    private void setPhotoChecked() {
        ChatActivity chatActivity;
        TLRPC.Chat currentChat;
        PhotoViewerProvider photoViewerProvider = this.placeProvider;
        if (photoViewerProvider != null) {
            if (photoViewerProvider.getSelectedPhotos() != null && this.maxSelectedPhotos > 0 && this.placeProvider.getSelectedPhotos().size() >= this.maxSelectedPhotos && !this.placeProvider.isPhotoChecked(this.currentIndex)) {
                if (!this.allowOrder || (chatActivity = this.parentChatActivity) == null || (currentChat = chatActivity.getCurrentChat()) == null || ChatObject.hasAdminRights(currentChat) || !currentChat.slowmode_enabled) {
                    return;
                }
                AlertsCreator.createSimpleAlert(this.parentActivity, LocaleController.getString("Slowmode", R.string.Slowmode), LocaleController.getString("SlowmodeSelectSendError", R.string.SlowmodeSelectSendError)).show();
                return;
            }
            int photoChecked = this.placeProvider.setPhotoChecked(this.currentIndex, getCurrentVideoEditedInfo());
            boolean zIsPhotoChecked = this.placeProvider.isPhotoChecked(this.currentIndex);
            this.checkImageView.setChecked(zIsPhotoChecked, true);
            if (photoChecked >= 0) {
                if (zIsPhotoChecked) {
                    this.selectedPhotosAdapter.notifyItemInserted(photoChecked);
                    this.selectedPhotosListView.smoothScrollToPosition(photoChecked);
                } else {
                    this.selectedPhotosAdapter.notifyItemRemoved(photoChecked);
                    if (photoChecked == 0) {
                        this.selectedPhotosAdapter.notifyItemChanged(0);
                    }
                }
            }
            updateSelectedCount();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void setScaleToFill() {
        float bitmapWidth = this.centerImage.getBitmapWidth();
        float bitmapHeight = this.centerImage.getBitmapHeight();
        if (bitmapWidth == BitmapDescriptorFactory.HUE_RED || bitmapHeight == BitmapDescriptorFactory.HUE_RED) {
            return;
        }
        float containerViewWidth = getContainerViewWidth();
        float containerViewHeight = getContainerViewHeight();
        float fMin = Math.min(containerViewHeight / bitmapHeight, containerViewWidth / bitmapWidth);
        float fMax = Math.max(containerViewWidth / ((int) (bitmapWidth * fMin)), containerViewHeight / ((int) (bitmapHeight * fMin)));
        this.scale = fMax;
        updateMinMax(fMax);
    }

    private void setVideoPlayerControlVisible(final boolean z, boolean z2) {
        if (this.videoPlayerControlVisible != z) {
            this.bottomLayout.setTag(z ? 1 : null);
            Animator animator = this.videoPlayerControlAnimator;
            if (animator != null) {
                animator.cancel();
            }
            this.videoPlayerControlVisible = z;
            float f = BitmapDescriptorFactory.HUE_RED;
            if (z2) {
                if (z) {
                    this.videoPlayerControlFrameLayout.setVisibility(0);
                }
                float alpha = this.videoPlayerControlFrameLayout.getAlpha();
                if (z) {
                    f = 1.0f;
                }
                ValueAnimator valueAnimatorOfFloat = ValueAnimator.ofFloat(alpha, f);
                valueAnimatorOfFloat.setDuration(200L);
                valueAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda6
                    @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                    public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                        this.f$0.lambda$setVideoPlayerControlVisible$92(valueAnimator);
                    }
                });
                valueAnimatorOfFloat.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.57
                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationEnd(Animator animator2) {
                        if (z) {
                            return;
                        }
                        PhotoViewer.this.videoPlayerControlFrameLayout.setVisibility(8);
                    }
                });
                this.videoPlayerControlAnimator = valueAnimatorOfFloat;
                valueAnimatorOfFloat.start();
            } else {
                this.videoPlayerControlFrameLayout.setVisibility(z ? 0 : 8);
                VideoPlayerControlFrameLayout videoPlayerControlFrameLayout = this.videoPlayerControlFrameLayout;
                if (z) {
                    f = 1.0f;
                }
                videoPlayerControlFrameLayout.setAlpha(f);
            }
            if (this.allowShare && this.pageBlocksAdapter == null) {
                if (z) {
                    this.menuItem.showSubItem(9);
                } else {
                    this.menuItem.hideSubItem(9);
                }
            }
        }
    }

    private boolean shouldIndexAutoPlayed(int i) {
        File file;
        PageBlocksAdapter pageBlocksAdapter = this.pageBlocksAdapter;
        if (pageBlocksAdapter != null) {
            return (pageBlocksAdapter.isVideo(i) || this.pageBlocksAdapter.isHardwarePlayer(i)) && SharedConfig.isAutoplayVideo() && (file = this.pageBlocksAdapter.getFile(i)) != null && file.exists();
        }
        return false;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public boolean shouldMessageObjectAutoPlayed(MessageObject messageObject) {
        return messageObject != null && messageObject.isVideo() && (messageObject.mediaExists || messageObject.attachPathExists || messageObject.hasVideoQualities() || (messageObject.canStreamVideo() && SharedConfig.streamMedia)) && SharedConfig.isAutoplayVideo();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void showDownloadAlert() {
        AlertDialog.Builder builder = new AlertDialog.Builder(this.parentActivity, this.resourcesProvider);
        builder.setTitle(LocaleController.getString("AppName", R.string.AppName));
        builder.setPositiveButton(LocaleController.getString("OK", R.string.OK), null);
        MessageObject messageObject = this.currentMessageObject;
        builder.setMessage(LocaleController.getString((messageObject != null && messageObject.isVideo() && FileLoader.getInstance(this.currentMessageObject.currentAccount).isLoadingFile(this.currentFileNames[0])) ? R.string.PleaseStreamDownload : R.string.PleaseDownload));
        showAlertDialog(builder);
    }

    private void showEditCaption(final View view, boolean z, boolean z2, final float[] fArr) {
        ViewPropertyAnimator viewPropertyAnimatorWithEndAction;
        PhotoViewerProvider photoViewerProvider = this.placeProvider;
        float fDp = AndroidUtilities.dp((photoViewerProvider == null || !photoViewerProvider.canMoveCaptionAbove()) ? 58.0f : 175.0f) * (view == this.topCaptionEdit ? -1.0f : 1.0f);
        if (z2) {
            if (z && view.getTag() == null) {
                if (view.getVisibility() != 0) {
                    view.setVisibility(0);
                    view.setAlpha(this.pickerView.getAlpha());
                    view.setTranslationY(fDp);
                }
                viewPropertyAnimatorWithEndAction = view.animate().translationY(BitmapDescriptorFactory.HUE_RED).setUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda88
                    @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                    public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                        this.f$0.lambda$showEditCaption$122(view, fArr, valueAnimator);
                    }
                }).setDuration(420L).setInterpolator(CubicBezierInterpolator.EASE_OUT_QUINT);
            } else if (!z && view.getTag() != null) {
                viewPropertyAnimatorWithEndAction = view.animate().translationY(fDp).setUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda89
                    @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                    public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                        this.f$0.lambda$showEditCaption$123(view, fArr, valueAnimator);
                    }
                }).setDuration(420L).setInterpolator(CubicBezierInterpolator.EASE_OUT_QUINT).withEndAction(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda90
                    @Override // java.lang.Runnable
                    public final void run() {
                        view.setVisibility(8);
                    }
                });
            }
            viewPropertyAnimatorWithEndAction.start();
        } else {
            view.animate().setListener(null).cancel();
            view.setVisibility(z ? 0 : 8);
            if (z) {
                fDp = BitmapDescriptorFactory.HUE_RED;
            }
            view.setTranslationY(fDp);
            float alpha = this.pickerView.getAlpha();
            float f = z ? 1.0f : BitmapDescriptorFactory.HUE_RED;
            fArr[0] = f;
            view.setAlpha(alpha * f);
        }
        view.setTag(z ? 1 : null);
    }

    private void showEditCaption(boolean z, boolean z2) {
        PhotoViewerProvider photoViewerProvider = this.placeProvider;
        boolean z3 = false;
        boolean z4 = photoViewerProvider != null && photoViewerProvider.isCaptionAbove();
        showEditCaption(this.captionEdit, z && !z4, z2, this.captionEditAlpha);
        CaptionPhotoViewer captionPhotoViewer = this.topCaptionEdit;
        if (z && z4) {
            z3 = true;
        }
        showEditCaption(captionPhotoViewer, z3, z2, this.topCaptionEditAlpha);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void showEditStickerMode(boolean z, boolean z2) {
        ViewPropertyAnimator listener;
        CubicBezierInterpolator cubicBezierInterpolator;
        ViewPropertyAnimator listener2;
        StickerMakerView stickerMakerView;
        MaskPaintView maskPaintView;
        boolean z3 = true;
        if (!z || (stickerMakerView = this.stickerMakerView) == null || (stickerMakerView.empty && !stickerMakerView.overriddenPaths() && ((maskPaintView = this.maskPaintView) == null || !maskPaintView.canUndo()))) {
            z3 = false;
        }
        float f = BitmapDescriptorFactory.HUE_RED;
        if (!z2) {
            this.undoBtn.animate().setListener(null).cancel();
            this.undoBtn.setVisibility(z3 ? 0 : 8);
            this.undoBtn.setAlpha(z3 ? 1.0f : BitmapDescriptorFactory.HUE_RED);
            this.undoBtn.setScaleX(z3 ? 1.0f : 0.8f);
            this.undoBtn.setScaleY(z3 ? 1.0f : 0.8f);
        } else if (z3 && this.undoBtn.getTag() == null) {
            this.undoBtn.animate().setListener(null).cancel();
            if (this.undoBtn.getVisibility() != 0) {
                this.undoBtn.setVisibility(0);
                listener = this.undoBtn.animate().alpha(1.0f).scaleX(1.0f).scaleY(1.0f);
                listener.setInterpolator(CubicBezierInterpolator.EASE_OUT_QUINT).setDuration(400L).start();
            }
        } else if (!z3 && this.undoBtn.getTag() != null) {
            this.undoBtn.animate().setListener(null).cancel();
            listener = this.undoBtn.animate().alpha(BitmapDescriptorFactory.HUE_RED).scaleX(0.8f).scaleY(0.8f).setListener(new HideViewAfterAnimation(this.undoBtn));
            listener.setInterpolator(CubicBezierInterpolator.EASE_OUT_QUINT).setDuration(400L).start();
        }
        this.undoBtn.setTag(z3 ? num : null);
        if (!z2) {
            this.eraseBtn.animate().setListener(null).cancel();
            this.eraseBtn.setVisibility(z ? 0 : 8);
            this.eraseBtn.setAlpha(z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
            this.eraseBtn.setScaleX(z ? 1.0f : 0.8f);
            this.eraseBtn.setScaleY(z ? 1.0f : 0.8f);
            this.restoreBtn.animate().setListener(null).cancel();
            this.restoreBtn.setVisibility(z ? 0 : 8);
            BlurButton blurButton = this.restoreBtn;
            if (z) {
                f = 1.0f;
            }
            blurButton.setAlpha(f);
            this.restoreBtn.setScaleX(z ? 1.0f : 0.8f);
            this.restoreBtn.setScaleY(z ? 1.0f : 0.8f);
        } else if (z && this.eraseBtn.getTag() == null) {
            this.eraseBtn.animate().setListener(null).cancel();
            this.restoreBtn.animate().setListener(null).cancel();
            if (this.eraseBtn.getVisibility() != 0) {
                this.eraseBtn.setVisibility(0);
                ViewPropertyAnimator viewPropertyAnimatorScaleY = this.eraseBtn.animate().alpha(1.0f).scaleX(1.0f).scaleY(1.0f);
                cubicBezierInterpolator = CubicBezierInterpolator.EASE_OUT_QUINT;
                viewPropertyAnimatorScaleY.setInterpolator(cubicBezierInterpolator).setDuration(400L).start();
                this.restoreBtn.setVisibility(0);
                listener2 = this.restoreBtn.animate().alpha(1.0f).scaleX(1.0f).scaleY(1.0f);
                listener2.setInterpolator(cubicBezierInterpolator).setDuration(400L).start();
            }
        } else if (!z && this.eraseBtn.getTag() != null) {
            this.eraseBtn.animate().setListener(null).cancel();
            ViewPropertyAnimator listener3 = this.eraseBtn.animate().alpha(BitmapDescriptorFactory.HUE_RED).scaleX(0.8f).scaleY(0.8f).setListener(new HideViewAfterAnimation(this.eraseBtn));
            cubicBezierInterpolator = CubicBezierInterpolator.EASE_OUT_QUINT;
            listener3.setInterpolator(cubicBezierInterpolator).setDuration(400L).start();
            this.restoreBtn.animate().setListener(null).cancel();
            listener2 = this.restoreBtn.animate().alpha(BitmapDescriptorFactory.HUE_RED).scaleX(0.8f).scaleY(0.8f).setListener(new HideViewAfterAnimation(this.restoreBtn));
            listener2.setInterpolator(cubicBezierInterpolator).setDuration(400L).start();
        }
        this.eraseBtn.setTag(z ? 1 : null);
    }

    private void showPhotoQualityHint(boolean z) {
        HintView2 hintView2 = this.compressPhotoHint;
        if (hintView2 != null) {
            hintView2.hide();
            this.compressPhotoHint = null;
        }
        if (this.activityContext == null) {
            return;
        }
        this.compressPhotoHint = new HintView2(this.activityContext, 3);
        SpannableStringBuilder spannableStringBuilderAppend = new SpannableStringBuilder("x ").append((CharSequence) LocaleController.getString(z ? R.string.PhotoWillBeSentInHD : R.string.PhotoWillBeSentInSD));
        spannableStringBuilderAppend.setSpan(new ColoredImageSpan(z ? R.drawable.menu_quality_hd_filled : R.drawable.menu_quality_sd_filled), 0, 1, 33);
        this.compressPhotoHint.setText(spannableStringBuilderAppend);
        this.containerView.addView(this.compressPhotoHint, LayoutHelper.createFrame(-1, 100.0f, 87, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 48.0f));
        this.compressPhotoHint.setTranslationY(this.pickerView.getTranslationY());
        this.compressPhotoHint.setJointPx(BitmapDescriptorFactory.HUE_RED, this.itemsLayout.getX() + this.compressItem.getX() + (this.compressItem.getWidth() / 2.0f));
        final HintView2 hintView22 = this.compressPhotoHint;
        hintView22.setOnHiddenListener(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda120
            @Override // java.lang.Runnable
            public final void run() {
                AndroidUtilities.removeFromParent(hintView22);
            }
        });
        this.compressPhotoHint.setDuration(3500L);
        this.compressPhotoHint.show();
    }

    private void showQualityView(final boolean z) {
        TextureView textureView;
        if (z && this.textureUploaded && this.videoSizeSet && !this.changingTextureView && (textureView = this.videoTextureView) != null) {
            this.videoFrameBitmap = textureView.getBitmap();
        }
        if (z) {
            this.previousCompression = this.selectedCompression;
        }
        AnimatorSet animatorSet = this.qualityChooseViewAnimation;
        if (animatorSet != null) {
            animatorSet.cancel();
        }
        this.qualityChooseViewAnimation = new AnimatorSet();
        float f = BitmapDescriptorFactory.HUE_RED;
        if (z) {
            if (this.fancyShadows) {
                this.navigationBar.setVisibility(0);
                this.navigationBar.setAlpha(this.sendPhotoType == 11 ? 1.0f : BitmapDescriptorFactory.HUE_RED);
                this.navigationBar.setBackgroundColor(this.sendPhotoType == 11 ? 1711276032 : 2130706432);
            }
            this.qualityChooseView.setTag(1);
            AnimatorSet animatorSet2 = this.qualityChooseViewAnimation;
            FrameLayout frameLayout = this.pickerView;
            Property property = View.TRANSLATION_Y;
            ObjectAnimator objectAnimatorOfFloat = ObjectAnimator.ofFloat(frameLayout, (Property<FrameLayout, Float>) property, BitmapDescriptorFactory.HUE_RED, frameLayout.getHeight() + this.captionEdit.getEditTextHeight() + (this.isCurrentVideo ? AndroidUtilities.dp(58.0f) : 0));
            FrameLayout frameLayout2 = this.pickerView;
            Property property2 = View.ALPHA;
            animatorSet2.playTogether(objectAnimatorOfFloat, ObjectAnimator.ofFloat(frameLayout2, (Property<FrameLayout, Float>) property2, BitmapDescriptorFactory.HUE_RED), ObjectAnimator.ofFloat(this.pickerViewSendButton, (Property<ChatActivityEnterView.SendButton, Float>) property, BitmapDescriptorFactory.HUE_RED, AndroidUtilities.dp(158.0f)), ObjectAnimator.ofFloat(this.navigationBar, (Property<View, Float>) property2, this.fancyShadows ? BitmapDescriptorFactory.HUE_RED : 1.0f, 1.0f));
        } else {
            this.qualityChooseView.setTag(null);
            AnimatorSet animatorSet3 = this.qualityChooseViewAnimation;
            QualityChooseView qualityChooseView = this.qualityChooseView;
            Property property3 = View.TRANSLATION_Y;
            animatorSet3.playTogether(ObjectAnimator.ofFloat(qualityChooseView, (Property<QualityChooseView, Float>) property3, BitmapDescriptorFactory.HUE_RED, AndroidUtilities.dp(166.0f)), ObjectAnimator.ofFloat(this.qualityPicker, (Property<PickerBottomLayoutViewer, Float>) property3, BitmapDescriptorFactory.HUE_RED, AndroidUtilities.dp(166.0f)), ObjectAnimator.ofFloat(this.navigationBar, (Property<View, Float>) View.ALPHA, 1.0f, this.fancyShadows ? BitmapDescriptorFactory.HUE_RED : 1.0f));
        }
        this.qualityChooseViewAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.84
            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
            public void onAnimationCancel(Animator animator) {
                PhotoViewer.this.qualityChooseViewAnimation = null;
            }

            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
            public void onAnimationEnd(Animator animator) {
                if (animator.equals(PhotoViewer.this.qualityChooseViewAnimation)) {
                    PhotoViewer.this.qualityChooseViewAnimation = new AnimatorSet();
                    if (z) {
                        PhotoViewer.this.qualityChooseView.setVisibility(0);
                        PhotoViewer.this.qualityPicker.setVisibility(0);
                        AnimatorSet animatorSet4 = PhotoViewer.this.qualityChooseViewAnimation;
                        QualityChooseView qualityChooseView2 = PhotoViewer.this.qualityChooseView;
                        Property property4 = View.TRANSLATION_Y;
                        animatorSet4.playTogether(ObjectAnimator.ofFloat(qualityChooseView2, (Property<QualityChooseView, Float>) property4, BitmapDescriptorFactory.HUE_RED), ObjectAnimator.ofFloat(PhotoViewer.this.qualityPicker, (Property<PickerBottomLayoutViewer, Float>) property4, BitmapDescriptorFactory.HUE_RED));
                    } else {
                        if (PhotoViewer.this.fancyShadows) {
                            PhotoViewer.this.navigationBar.setVisibility(8);
                            PhotoViewer.this.navigationBar.setAlpha(BitmapDescriptorFactory.HUE_RED);
                            PhotoViewer.this.navigationBar.setBackgroundColor(PhotoViewer.this.sendPhotoType == 11 ? -16777216 : 2130706432);
                        }
                        PhotoViewer.this.qualityChooseView.setVisibility(4);
                        PhotoViewer.this.qualityPicker.setVisibility(4);
                        AnimatorSet animatorSet5 = PhotoViewer.this.qualityChooseViewAnimation;
                        FrameLayout frameLayout3 = PhotoViewer.this.pickerView;
                        Property property5 = View.TRANSLATION_Y;
                        animatorSet5.playTogether(ObjectAnimator.ofFloat(frameLayout3, (Property<FrameLayout, Float>) property5, BitmapDescriptorFactory.HUE_RED), ObjectAnimator.ofFloat(PhotoViewer.this.pickerView, (Property<FrameLayout, Float>) View.ALPHA, 1.0f), ObjectAnimator.ofFloat(PhotoViewer.this.pickerViewSendButton, (Property<ChatActivityEnterView.SendButton, Float>) property5, BitmapDescriptorFactory.HUE_RED));
                    }
                    PhotoViewer.this.qualityChooseViewAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.84.1
                        @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                        public void onAnimationEnd(Animator animator2) {
                            if (animator2.equals(PhotoViewer.this.qualityChooseViewAnimation)) {
                                PhotoViewer.this.qualityChooseViewAnimation = null;
                            }
                        }
                    });
                    PhotoViewer.this.qualityChooseViewAnimation.setDuration(200L);
                    PhotoViewer.this.qualityChooseViewAnimation.setInterpolator(AndroidUtilities.decelerateInterpolator);
                    PhotoViewer.this.qualityChooseViewAnimation.start();
                }
            }
        });
        this.qualityChooseViewAnimation.setDuration(200L);
        this.qualityChooseViewAnimation.setInterpolator(AndroidUtilities.accelerateInterpolator);
        this.qualityChooseViewAnimation.start();
        if (this.muteButton.getVisibility() == 0) {
            this.muteButton.animate().scaleX(z ? 0.25f : 1.0f).scaleY(z ? 0.25f : 1.0f).alpha(z ? BitmapDescriptorFactory.HUE_RED : 1.0f).setDuration(200L);
        }
        if (this.editCoverButton.getVisibility() == 0) {
            ViewPropertyAnimator viewPropertyAnimatorScaleY = this.editCoverButton.animate().scaleX(z ? 0.25f : 1.0f).scaleY(z ? 0.25f : 1.0f);
            if (!z) {
                f = 1.0f;
            }
            viewPropertyAnimatorScaleY.alpha(f).setDuration(200L);
        }
    }

    private void showScheduleDatePickerDialog() {
        if (this.parentChatActivity == null) {
            return;
        }
        AlertsCreator.createScheduleDatePickerDialog(this.parentActivity, this.parentChatActivity.getDialogId(), new AlertsCreator.ScheduleDatePickerDelegate() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda136
            @Override // org.telegram.ui.Components.AlertsCreator.ScheduleDatePickerDelegate
            public final void didSelectDate(boolean z, int i) {
                this.f$0.sendPressed(z, i);
            }
        }, new AlertsCreator.ScheduleDatePickerColors(-1, -14342875, -1, 520093695, -1, -115203550, 620756991));
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void showShareAlert(ArrayList arrayList) {
        boolean z;
        VideoPlayer videoPlayer;
        MessageObject messageObject;
        boolean z2;
        FrameLayoutDrawer frameLayoutDrawer = this.containerView;
        requestAdjustToNothing();
        ChatActivity chatActivity = this.parentChatActivity;
        if (chatActivity == null || chatActivity.getChatActivityEnterView() == null || this.parentChatActivity.getFragmentView() == null) {
            z = false;
        } else {
            if (this.parentChatActivity.getChatActivityEnterView().isKeyboardVisible()) {
                this.parentChatActivity.getChatActivityEnterView().showEmojiView();
                z2 = true;
            } else {
                z2 = false;
            }
            AndroidUtilities.setAdjustResizeToNothing(this.parentChatActivity.getParentActivity(), this.classGuid);
            this.parentChatActivity.getFragmentView().requestLayout();
            z = z2;
        }
        String str = null;
        Integer numValueOf = (arrayList == null || arrayList.size() != 1 || (videoPlayer = this.videoPlayer) == null || videoPlayer.getCurrentPosition() <= 1500 || (messageObject = this.currentMessageObject) == null || !messageObject.isVideo()) ? null : Integer.valueOf((int) (this.videoPlayer.getCurrentPosition() / 1000));
        if (arrayList != null && arrayList.size() == 1) {
            MessageObject messageObject2 = (MessageObject) arrayList.get(0);
            String publicUsername = ChatObject.getPublicUsername(MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(-messageObject2.getDialogId())));
            if (!TextUtils.isEmpty(publicUsername)) {
                str = "https://" + MessagesController.getInstance(this.currentAccount).linkPrefix + "/" + publicUsername + "/" + messageObject2.getId();
            }
        }
        final AnonymousClass40 anonymousClass40 = new AnonymousClass40(this.parentActivity, this.parentChatActivity, arrayList, null, null, false, str, null, false, true, false, numValueOf, null, frameLayoutDrawer, z);
        anonymousClass40.setFocusable(false);
        anonymousClass40.getWindow().setSoftInputMode(48);
        AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda140
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$showShareAlert$78(anonymousClass40);
            }
        }, 250L);
        anonymousClass40.show();
    }

    private void showStickerMode(boolean z, boolean z2) {
        showStickerMode(z, z, z2);
    }

    private void showStickerMode(boolean z, boolean z2, boolean z3) {
        ViewPropertyAnimator listener;
        ViewPropertyAnimator listener2;
        ViewPropertyAnimator listener3;
        float f = BitmapDescriptorFactory.HUE_RED;
        if (!z3) {
            this.stickerMakerView.animate().setListener(null).cancel();
            this.stickerMakerView.setVisibility(z ? 0 : 8);
            this.stickerMakerView.setAlpha(this.pickerView.getAlpha());
            this.stickerMakerBackgroundView.animate().setListener(null).cancel();
            this.stickerMakerBackgroundView.setVisibility(z ? 0 : 8);
            this.stickerMakerBackgroundView.setAlpha(z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
        } else if (z && this.stickerMakerView.getTag() == null) {
            this.stickerMakerView.animate().setListener(null).cancel();
            this.stickerMakerBackgroundView.animate().setListener(null).cancel();
            if (this.stickerMakerView.getVisibility() != 0) {
                this.stickerMakerView.setVisibility(0);
                this.stickerMakerView.animate().alpha(1.0f).start();
                this.stickerMakerBackgroundView.setVisibility(0);
                listener = this.stickerMakerBackgroundView.animate().alpha(1.0f);
                listener.start();
            }
        } else if (!z && this.stickerMakerView.getTag() != null) {
            this.stickerMakerView.animate().setListener(null).cancel();
            this.stickerMakerView.animate().alpha(BitmapDescriptorFactory.HUE_RED).setListener(new HideViewAfterAnimation(this.stickerMakerView)).start();
            this.stickerMakerBackgroundView.animate().setListener(null).cancel();
            listener = this.stickerMakerBackgroundView.animate().alpha(BitmapDescriptorFactory.HUE_RED).setListener(new HideViewAfterAnimation(this.stickerMakerBackgroundView));
            listener.start();
        }
        this.stickerMakerView.setTag(z ? 1 : null);
        boolean z4 = (!z || this.cutOutBtn.isUndoCutState() || this.stickerEmpty) ? false : true;
        if (z3) {
            if (z4 && this.cutOutBtn.getTag() == null) {
                this.cutOutBtn.animate().setListener(null).cancel();
                if (this.cutOutBtn.getVisibility() != 0) {
                    this.cutOutBtn.setVisibility(0);
                }
                listener2 = this.cutOutBtn.animate().alpha(1.0f);
            } else if (!z4 && this.cutOutBtn.getTag() != null) {
                this.cutOutBtn.animate().setListener(null).cancel();
                listener2 = this.cutOutBtn.animate().alpha(BitmapDescriptorFactory.HUE_RED).setListener(new HideViewAfterAnimation(this.cutOutBtn));
            }
            listener2.start();
        } else {
            this.cutOutBtn.animate().setListener(null).cancel();
            this.cutOutBtn.setVisibility(z4 ? 0 : 8);
            this.cutOutBtn.setAlpha(z4 ? 1.0f : BitmapDescriptorFactory.HUE_RED);
        }
        this.cutOutBtn.setTag(z4 ? 1 : null);
        showEditStickerMode(z && this.cutOutBtn.isUndoCutState() && !this.stickerEmpty, z3);
        this.stickerMakerView.setOutlineVisible(z && this.cutOutBtn.isUndoCutState() && this.outlineBtn.isActive() && !this.eraseBtn.isActive() && !this.restoreBtn.isActive());
        boolean z5 = z && this.cutOutBtn.isUndoCutState() && !this.eraseBtn.isActive() && !this.restoreBtn.isActive();
        if (z3) {
            if (z5 && this.outlineBtn.getTag() == null) {
                this.outlineBtn.animate().setListener(null).cancel();
                if (this.outlineBtn.getVisibility() != 0) {
                    this.outlineBtn.setVisibility(0);
                }
                listener3 = this.outlineBtn.animate().alpha(1.0f).scaleX(1.0f).scaleY(1.0f);
            } else if (!z5 && this.outlineBtn.getTag() != null) {
                this.outlineBtn.animate().setListener(null).cancel();
                listener3 = this.outlineBtn.animate().alpha(BitmapDescriptorFactory.HUE_RED).scaleX(0.8f).scaleY(0.8f).setListener(new HideViewAfterAnimation(this.outlineBtn));
            }
            listener3.setInterpolator(CubicBezierInterpolator.EASE_OUT_QUINT).setDuration(400L).start();
        } else {
            this.outlineBtn.animate().setListener(null).cancel();
            this.outlineBtn.setVisibility(z5 ? 0 : 8);
            BlurButton blurButton = this.outlineBtn;
            if (z5) {
                f = 1.0f;
            }
            blurButton.setAlpha(f);
            this.outlineBtn.setScaleX(z5 ? 1.0f : 0.8f);
            this.outlineBtn.setScaleY(z5 ? 1.0f : 0.8f);
        }
        this.outlineBtn.setTag(z5 ? 1 : null);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void showVideoSeekPreviewPosition(boolean z) {
        PhotoViewerWebView photoViewerWebView;
        if (!z || this.videoPreviewFrame.getTag() == null) {
            if (z || this.videoPreviewFrame.getTag() != null) {
                if (z && !this.videoPreviewFrame.isReady() && ((photoViewerWebView = this.photoViewerWebView) == null || !photoViewerWebView.isYouTube() || !this.photoViewerWebView.hasYoutubeStoryboards())) {
                    this.needShowOnReady = true;
                    return;
                }
                AnimatorSet animatorSet = this.videoPreviewFrameAnimation;
                if (animatorSet != null) {
                    animatorSet.cancel();
                }
                this.videoPreviewFrame.setTag(z ? 1 : null);
                AnimatorSet animatorSet2 = new AnimatorSet();
                this.videoPreviewFrameAnimation = animatorSet2;
                VideoSeekPreviewImage videoSeekPreviewImage = this.videoPreviewFrame;
                Property property = View.ALPHA;
                float fDp = BitmapDescriptorFactory.HUE_RED;
                ObjectAnimator objectAnimatorOfFloat = ObjectAnimator.ofFloat(videoSeekPreviewImage, (Property<VideoSeekPreviewImage, Float>) property, z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
                ObjectAnimator objectAnimatorOfFloat2 = ObjectAnimator.ofFloat(this.videoPreviewFrame, (Property<VideoSeekPreviewImage, Float>) View.SCALE_X, z ? 1.0f : 0.5f);
                ObjectAnimator objectAnimatorOfFloat3 = ObjectAnimator.ofFloat(this.videoPreviewFrame, (Property<VideoSeekPreviewImage, Float>) View.SCALE_Y, z ? 1.0f : 0.5f);
                VideoSeekPreviewImage videoSeekPreviewImage2 = this.videoPreviewFrame;
                Property property2 = View.TRANSLATION_Y;
                if (!z) {
                    fDp = AndroidUtilities.dp(12.0f);
                }
                animatorSet2.playTogether(objectAnimatorOfFloat, objectAnimatorOfFloat2, objectAnimatorOfFloat3, ObjectAnimator.ofFloat(videoSeekPreviewImage2, (Property<VideoSeekPreviewImage, Float>) property2, fDp));
                this.videoPreviewFrameAnimation.setDuration(380L);
                this.videoPreviewFrameAnimation.setInterpolator(CubicBezierInterpolator.EASE_OUT_QUINT);
                this.videoPreviewFrameAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.48
                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationEnd(Animator animator) {
                        PhotoViewer.this.videoPreviewFrameAnimation = null;
                    }
                });
                this.videoPreviewFrameAnimation.start();
            }
        }
    }

    private void showVideoTimeline(boolean z, boolean z2) {
        ObjectAnimator objectAnimatorOfFloat;
        if (z2) {
            if (z && this.videoTimelineViewContainer.getTag() == null) {
                if (this.videoTimelineViewContainer.getVisibility() != 0) {
                    this.videoTimelineViewContainer.setVisibility(0);
                    this.videoTimelineViewContainer.setAlpha(this.pickerView.getAlpha());
                    this.videoTimelineView.setTranslationY(AndroidUtilities.dp(58.0f));
                }
                ObjectAnimator objectAnimator = this.videoTimelineAnimator;
                if (objectAnimator != null) {
                    objectAnimator.removeAllListeners();
                    this.videoTimelineAnimator.cancel();
                }
                VideoTimelinePlayView videoTimelinePlayView = this.videoTimelineView;
                objectAnimatorOfFloat = ObjectAnimator.ofFloat(videoTimelinePlayView, (Property<VideoTimelinePlayView, Float>) View.TRANSLATION_Y, videoTimelinePlayView.getTranslationY(), BitmapDescriptorFactory.HUE_RED);
                this.videoTimelineAnimator = objectAnimatorOfFloat;
            } else if (!z && this.videoTimelineViewContainer.getTag() != null) {
                ObjectAnimator objectAnimator2 = this.videoTimelineAnimator;
                if (objectAnimator2 != null) {
                    objectAnimator2.removeAllListeners();
                    this.videoTimelineAnimator.cancel();
                }
                VideoTimelinePlayView videoTimelinePlayView2 = this.videoTimelineView;
                ObjectAnimator objectAnimatorOfFloat2 = ObjectAnimator.ofFloat(videoTimelinePlayView2, (Property<VideoTimelinePlayView, Float>) View.TRANSLATION_Y, videoTimelinePlayView2.getTranslationY(), AndroidUtilities.dp(58.0f));
                this.videoTimelineAnimator = objectAnimatorOfFloat2;
                objectAnimatorOfFloat2.addListener(new HideViewAfterAnimation(this.videoTimelineViewContainer));
                objectAnimatorOfFloat = this.videoTimelineAnimator;
            }
            objectAnimatorOfFloat.setDuration(220L);
            this.videoTimelineAnimator.setInterpolator(CubicBezierInterpolator.DEFAULT);
            this.videoTimelineAnimator.start();
        } else {
            this.videoTimelineViewContainer.animate().setListener(null).cancel();
            this.videoTimelineViewContainer.setVisibility(z ? 0 : 8);
            this.videoTimelineView.setTranslationY(BitmapDescriptorFactory.HUE_RED);
            this.videoTimelineViewContainer.setAlpha(this.pickerView.getAlpha());
        }
        FrameLayout frameLayout = this.videoTimelineViewContainer;
        if (frameLayout != null && frameLayout.getVisibility() != 8) {
            this.videoTimelineViewContainer.setTranslationY(this.pickerView.getTranslationY() - (Math.max(0, this.captionEdit.getEditTextHeight() - AndroidUtilities.dp(46.0f)) * this.captionEdit.getAlpha()));
        }
        this.videoTimelineViewContainer.setTag(z ? 1 : null);
    }

    private static CharSequence sponsoredCaption(MessageObject messageObject, CharSequence charSequence) {
        SpannableStringBuilder spannableStringBuilder = new SpannableStringBuilder();
        if (!TextUtils.isEmpty(messageObject.sponsoredTitle)) {
            spannableStringBuilder.append((CharSequence) messageObject.sponsoredTitle);
            spannableStringBuilder.setSpan(new TypefaceSpan(AndroidUtilities.bold()), 0, spannableStringBuilder.length(), 33);
            spannableStringBuilder.setSpan(new LineHeightSpan() { // from class: org.telegram.ui.PhotoViewer.86
                @Override // android.text.style.LineHeightSpan
                public void chooseHeight(CharSequence charSequence2, int i, int i2, int i3, int i4, Paint.FontMetricsInt fontMetricsInt) {
                    fontMetricsInt.descent += AndroidUtilities.dp(4.0f);
                    fontMetricsInt.ascent = fontMetricsInt.ascent;
                }
            }, 0, spannableStringBuilder.length(), 33);
            spannableStringBuilder.append((CharSequence) "\n");
        }
        spannableStringBuilder.append(charSequence);
        return spannableStringBuilder;
    }

    private void startVideoPlayer() {
        VideoPlayer videoPlayer;
        if (!this.isCurrentVideo || (videoPlayer = this.videoPlayer) == null || videoPlayer.isPlaying()) {
            return;
        }
        if (!this.muteVideo || this.sendPhotoType == 1) {
            this.videoPlayer.setVolume(BitmapDescriptorFactory.HUE_RED);
        }
        this.manuallyPaused = false;
        toggleVideoPlayer();
    }

    private boolean supportsSendingNewEntities() {
        TLRPC.EncryptedChat encryptedChat;
        ChatActivity chatActivity = this.parentChatActivity;
        return chatActivity != null && ((encryptedChat = chatActivity.currentEncryptedChat) == null || AndroidUtilities.getPeerLayerVersion(encryptedChat.layer) >= 101);
    }

    private void switchToNextIndex(int i, boolean z) throws Resources.NotFoundException {
        if (this.currentMessageObject != null) {
            releasePlayer(false);
            FileLoader.getInstance(this.currentAccount).cancelLoadFile(this.currentMessageObject.getDocument());
        } else if (this.currentPageBlock != null) {
            TLObject media = this.pageBlocksAdapter.getMedia(this.currentIndex);
            if (media instanceof TLRPC.Document) {
                releasePlayer(false);
                FileLoader.getInstance(this.currentAccount).cancelLoadFile((TLRPC.Document) media);
            }
        }
        GroupedPhotosListView groupedPhotosListView = this.groupedPhotosListView;
        if (groupedPhotosListView != null) {
            groupedPhotosListView.setAnimateBackground(true);
        }
        this.playerAutoStarted = false;
        setImageIndex(this.currentIndex + i, z, true);
        if (shouldMessageObjectAutoPlayed(this.currentMessageObject) || shouldIndexAutoPlayed(this.currentIndex)) {
            this.playerAutoStarted = true;
            onActionClick(true);
            checkProgress(0, false, true);
        }
        checkFullscreenButton();
        try {
            CastSync.check(0);
            if (ChromecastController.getInstance().isCasting()) {
                ChromecastController.getInstance().setCurrentMediaAndCastIfNeeded(getCurrentChromecastMedia());
            }
        } catch (Exception e) {
            FileLog.e(e);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void switchToPaintMode() {
        EditState editState;
        this.changeModeAnimation = null;
        this.pickerView.setVisibility(8);
        this.pickerViewSendButton.setVisibility(8);
        this.doneButtonFullWidth.setVisibility(8);
        this.muteButton.setVisibility(8);
        this.editCoverButton.setVisibility(8);
        PhotoCropView photoCropView = this.photoCropView;
        if (photoCropView != null) {
            photoCropView.setVisibility(4);
        }
        this.selectedPhotosListView.setVisibility(8);
        this.selectedPhotosListView.setAlpha(BitmapDescriptorFactory.HUE_RED);
        this.selectedPhotosListView.setTranslationY(-AndroidUtilities.dp(10.0f));
        this.photosCounterView.setRotationX(BitmapDescriptorFactory.HUE_RED);
        this.selectedPhotosListView.setEnabled(false);
        this.isPhotosListViewVisible = false;
        if (this.needCaptionLayout) {
            this.captionTextViewSwitcher.setVisibility(4);
        }
        int i = this.sendPhotoType;
        if (i == 0 || i == 4 || ((i == 2 || i == 5) && this.imagesArrLocals.size() > 1)) {
            this.checkImageView.setVisibility(8);
            this.photosCounterView.setVisibility(8);
            updateActionBarTitlePadding();
        }
        showEditCaption(false, true);
        showStickerMode(false, false, true);
        Bitmap bitmap = this.centerImage.getBitmap();
        float f = this.scale;
        if (this.sendPhotoType == 11) {
            this.savedTy = this.translationY;
            this.savedTx = this.translationX;
            this.savedScale = f;
            this.savedRotation = this.rotate;
            this.animateToRotate = BitmapDescriptorFactory.HUE_RED;
        }
        if (bitmap != null) {
            int bitmapWidth = this.centerImage.getBitmapWidth();
            int bitmapHeight = this.centerImage.getBitmapHeight();
            if (this.sendPhotoType == 1) {
                float fDp = AndroidUtilities.dp(12.0f);
                this.animateToY = fDp;
                if (this.photoPaintView != null) {
                    this.animateToY = fDp + (r15.getAdditionalTop() / 2.0f);
                }
                if (this.cropTransform.getOrientation() == 90 || this.cropTransform.getOrientation() == 270) {
                    int i2 = bitmapHeight;
                    bitmapHeight = bitmapWidth;
                    bitmapWidth = i2;
                }
                float f2 = bitmapWidth;
                float f3 = bitmapHeight;
                this.animateToScale = (Math.min(getContainerViewWidth(3) / f2, getContainerViewHeight(3) / f3) / Math.min(getContainerViewWidth() / f2, getContainerViewHeight() / f3)) * scale1(false);
                this.animateToX = (getLeftInset() / 2) - (getRightInset() / 2);
                this.animationStartTime = System.currentTimeMillis();
                this.zoomAnimation = true;
            } else {
                float f4 = (-AndroidUtilities.dp(44.0f)) + (isStatusBarVisible() ? AndroidUtilities.statusBarHeight / 2 : 0);
                this.animateToY = f4;
                if (this.photoPaintView != null) {
                    float additionalTop = f4 + (r15.getAdditionalTop() / 2.0f);
                    this.animateToY = additionalTop;
                    this.animateToY = additionalTop - (this.photoPaintView.getAdditionalBottom() / 2.0f);
                }
                MediaController.CropState cropState = this.editState.cropState;
                if (cropState != null) {
                    int i3 = cropState.transformRotation;
                    if (i3 != 90 && i3 != 270) {
                        bitmapHeight = bitmapWidth;
                        bitmapWidth = bitmapHeight;
                    }
                    bitmapHeight = (int) (bitmapHeight * cropState.cropPw);
                    bitmapWidth = (int) (bitmapWidth * cropState.cropPh);
                    int i22 = bitmapHeight;
                    bitmapHeight = bitmapWidth;
                    bitmapWidth = i22;
                }
                float f22 = bitmapWidth;
                float f32 = bitmapHeight;
                this.animateToScale = (Math.min(getContainerViewWidth(3) / f22, getContainerViewHeight(3) / f32) / Math.min(getContainerViewWidth() / f22, getContainerViewHeight() / f32)) * scale1(false);
                this.animateToX = (getLeftInset() / 2) - (getRightInset() / 2);
                this.animationStartTime = System.currentTimeMillis();
                this.zoomAnimation = true;
            }
        }
        LPhotoPaintView lPhotoPaintView = this.photoPaintView;
        if (lPhotoPaintView != null) {
            lPhotoPaintView.setDrawShadow(this.sendPhotoType == 11 && ((editState = this.editState) == null || editState.cropState == null));
        }
        this.windowView.setClipChildren(true);
        this.navigationBar.setVisibility(4);
        this.imageMoveAnimation = new AnimatorSet();
        ValueAnimator valueAnimatorOfFloat = ValueAnimator.ofFloat(AndroidUtilities.dp(126.0f), BitmapDescriptorFactory.HUE_RED);
        ValueAnimator valueAnimatorOfFloat2 = ValueAnimator.ofFloat(-AndroidUtilities.dp(12.0f), BitmapDescriptorFactory.HUE_RED);
        valueAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda155
            @Override // android.animation.ValueAnimator.AnimatorUpdateListener
            public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                this.f$0.lambda$switchToPaintMode$113(valueAnimator);
            }
        });
        valueAnimatorOfFloat2.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda156
            @Override // android.animation.ValueAnimator.AnimatorUpdateListener
            public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                this.f$0.lambda$switchToPaintMode$114(valueAnimator);
            }
        });
        this.imageMoveAnimation.playTogether(ObjectAnimator.ofFloat(this, (Property<PhotoViewer, Float>) AnimationProperties.PHOTO_VIEWER_ANIMATION_VALUE, BitmapDescriptorFactory.HUE_RED, 1.0f), valueAnimatorOfFloat, valueAnimatorOfFloat2);
        this.photoPaintView.onAnimationStateChanged(true);
        this.imageMoveAnimation.setDuration(200L);
        this.imageMoveAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.67
            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
            public void onAnimationEnd(Animator animator) {
                PhotoViewer.this.photoPaintView.onAnimationStateChanged(false);
                PhotoViewer.this.photoPaintView.init();
                PhotoViewer.this.paintingOverlay.hideEntities();
                PhotoViewer.this.imageMoveAnimation = null;
                PhotoViewer.this.currentEditMode = 3;
                PhotoViewer.this.getCaptionView().keyboardNotifier.ignore(PhotoViewer.this.currentEditMode != 0);
                if (PhotoViewer.this.paintKeyboardNotifier != null) {
                    PhotoViewer.this.paintKeyboardNotifier.ignore(PhotoViewer.this.currentEditMode != 3);
                }
                PhotoViewer.this.switchingToMode = -1;
                PhotoViewer photoViewer = PhotoViewer.this;
                photoViewer.animateToScale = photoViewer.scale = photoViewer.scale1(false);
                PhotoViewer.this.animateToX = BitmapDescriptorFactory.HUE_RED;
                PhotoViewer.this.animateToY = BitmapDescriptorFactory.HUE_RED;
                PhotoViewer photoViewer2 = PhotoViewer.this;
                photoViewer2.updateMinMax(photoViewer2.scale);
                PhotoViewer.this.padImageForHorizontalInsets = true;
                PhotoViewer.this.containerView.invalidate();
                if (PhotoViewer.this.placeProvider == null || !PhotoViewer.this.placeProvider.closeKeyboard()) {
                    PhotoViewer.this.makeFocusable();
                }
            }
        });
        this.imageMoveAnimation.start();
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:59:0x01e3  */
    /* JADX WARN: Removed duplicated region for block: B:64:0x0214  */
    /* JADX WARN: Removed duplicated region for block: B:67:0x0298  */
    /* JADX WARN: Removed duplicated region for block: B:69:0x02a3  */
    /* JADX WARN: Removed duplicated region for block: B:72:0x02b8  */
    /* JADX WARN: Removed duplicated region for block: B:74:0x02bd  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void switchToPip(boolean z) {
        float translationX;
        float translationY;
        float translationY2;
        final Runnable runnable;
        boolean z2;
        final CubicBezierInterpolator cubicBezierInterpolator;
        long j;
        if (this.videoPlayer == null || !this.textureUploaded || !checkInlinePermissions() || this.changingTextureView || this.switchingInlineMode || this.isInline) {
            return;
        }
        if (PipInstance != null) {
            PipInstance.destroyPhotoViewer();
        }
        this.openedFullScreenVideo = false;
        PipInstance = Instance;
        Instance = null;
        this.switchingInlineMode = true;
        this.isVisible = false;
        this.isVisibleOrAnimating = false;
        AndroidUtilities.cancelRunOnUIThread(this.hideActionBarRunnable);
        PlaceProviderObject placeProviderObject = this.currentPlaceObject;
        if (placeProviderObject != null && !placeProviderObject.imageReceiver.getVisible()) {
            this.currentPlaceObject.imageReceiver.setVisible(true, true);
            final AnimatedFileDrawable animation = this.currentPlaceObject.imageReceiver.getAnimation();
            if (animation != null) {
                Bitmap animatedBitmap = animation.getAnimatedBitmap();
                if (animatedBitmap != null) {
                    try {
                        if (this.usedSurfaceView) {
                            final Bitmap bitmapCreateBitmap = Bitmap.createBitmap(animatedBitmap);
                            AndroidUtilities.getBitmapFromSurface(this.videoSurfaceView, bitmapCreateBitmap, new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda91
                                @Override // java.lang.Runnable
                                public final void run() {
                                    PhotoViewer.lambda$switchToPip$81(animation, bitmapCreateBitmap);
                                }
                            });
                        } else {
                            Bitmap bitmap = this.videoTextureView.getBitmap(animatedBitmap.getWidth(), animatedBitmap.getHeight());
                            new Canvas(animatedBitmap).drawBitmap(bitmap, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, (Paint) null);
                            bitmap.recycle();
                        }
                    } catch (Throwable th) {
                        FileLog.e(th);
                    }
                }
                animation.seekTo(this.videoPlayer.getCurrentPosition(), true);
                if (z) {
                    this.currentPlaceObject.imageReceiver.setAlpha(BitmapDescriptorFactory.HUE_RED);
                    final ImageReceiver imageReceiver = this.currentPlaceObject.imageReceiver;
                    ValueAnimator valueAnimatorOfFloat = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f);
                    valueAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda92
                        @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                        public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                            PhotoViewer.lambda$switchToPip$82(imageReceiver, valueAnimator);
                        }
                    });
                    valueAnimatorOfFloat.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.42
                        @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                        public void onAnimationEnd(Animator animator) {
                            imageReceiver.setAlpha(1.0f);
                        }
                    });
                    valueAnimatorOfFloat.setDuration(250L);
                    valueAnimatorOfFloat.start();
                }
                this.currentPlaceObject.imageReceiver.setAllowStartAnimation(true);
                this.currentPlaceObject.imageReceiver.startAnimation();
            }
        }
        if (Build.VERSION.SDK_INT >= 21) {
            this.pipAnimationInProgress = true;
            org.telegram.ui.Components.Rect pipRect = PipVideoOverlay.getPipRect(true, this.aspectRatioFrameLayout.getAspectRatio());
            final View view = this.usedSurfaceView ? this.videoSurfaceView : this.videoTextureView;
            final float width = pipRect.width / view.getWidth();
            final ValueAnimator valueAnimatorOfFloat2 = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f);
            if (this.usedSurfaceView) {
                translationX = this.aspectRatioFrameLayout.getLeft() + view.getTranslationX();
                translationY = this.aspectRatioFrameLayout.getTop() + view.getTranslationY() + this.translationY;
                translationY2 = this.aspectRatioFrameLayout.getTop() + this.textureImageView.getTranslationY();
            } else {
                translationX = view.getTranslationX();
                translationY = view.getTranslationY() + this.translationY;
                translationY2 = this.textureImageView.getTranslationY();
            }
            final float f = translationY2 + this.translationY;
            final float f2 = translationX;
            final float f3 = translationY;
            final float f4 = pipRect.x;
            final float x = (f4 - this.aspectRatioFrameLayout.getX()) + getLeftInset();
            final float f5 = pipRect.y;
            final float y = f5 - this.aspectRatioFrameLayout.getY();
            final ViewOutlineProvider viewOutlineProvider = new ViewOutlineProvider() { // from class: org.telegram.ui.PhotoViewer.43
                @Override // android.view.ViewOutlineProvider
                public void getOutline(View view2, Outline outline) {
                    outline.setRoundRect(0, 0, view2.getMeasuredWidth(), view2.getMeasuredHeight(), ((Float) valueAnimatorOfFloat2.getAnimatedValue()).floatValue() * AndroidUtilities.dp(10.0f) * (1.0f / width));
                }
            };
            final AnimatorSet animatorSet = new AnimatorSet();
            Runnable runnable2 = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda93
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$switchToPip$83(view, viewOutlineProvider, f, f3, animatorSet);
                }
            };
            if (this.videoSurfaceView != null) {
                this.videoPlayer.player.pause();
                if (this.usedSurfaceView) {
                    final Bitmap bitmapCreateBitmap2 = Bitmaps.createBitmap(this.videoSurfaceView.getWidth(), this.videoSurfaceView.getHeight(), Bitmap.Config.ARGB_8888);
                    final boolean[] zArr = new boolean[1];
                    runnable = runnable2;
                    AndroidUtilities.getBitmapFromSurface(this.videoSurfaceView, bitmapCreateBitmap2, new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda94
                        @Override // java.lang.Runnable
                        public final void run() {
                            this.f$0.lambda$switchToPip$84(bitmapCreateBitmap2, zArr, runnable);
                        }
                    });
                    AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda95
                        @Override // java.lang.Runnable
                        public final void run() {
                            this.f$0.lambda$switchToPip$85(zArr, runnable);
                        }
                    }, 600L);
                    z2 = true;
                    if (z) {
                        cubicBezierInterpolator = null;
                    } else {
                        cubicBezierInterpolator = f3 < y ? new CubicBezierInterpolator(0.5d, 0.0d, 0.9d, 0.9d) : new CubicBezierInterpolator(0.0d, 0.5d, 0.9d, 0.9d);
                    }
                    Runnable runnable3 = runnable;
                    valueAnimatorOfFloat2.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda96
                        @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                        public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                            this.f$0.lambda$switchToPip$86(cubicBezierInterpolator, f2, f4, f, f5, view, x, f3, y, valueAnimator);
                        }
                    });
                    ValueAnimator valueAnimatorOfFloat3 = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f);
                    valueAnimatorOfFloat3.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda97
                        @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                        public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                            this.f$0.lambda$switchToPip$87(valueAnimator);
                        }
                    });
                    ImageView imageView = this.textureImageView;
                    Property property = View.SCALE_X;
                    ObjectAnimator objectAnimatorOfFloat = ObjectAnimator.ofFloat(imageView, (Property<ImageView, Float>) property, width);
                    ImageView imageView2 = this.textureImageView;
                    Property property2 = View.SCALE_Y;
                    animatorSet.playTogether(valueAnimatorOfFloat3, objectAnimatorOfFloat, ObjectAnimator.ofFloat(imageView2, (Property<ImageView, Float>) property2, width), ObjectAnimator.ofFloat(view, (Property<View, Float>) property, width), ObjectAnimator.ofFloat(view, (Property<View, Float>) property2, width), ObjectAnimator.ofInt(this.backgroundDrawable, (Property<BackgroundDrawable, Integer>) AnimationProperties.COLOR_DRAWABLE_ALPHA, 0), valueAnimatorOfFloat2);
                    if (z) {
                        animatorSet.setInterpolator(new DecelerateInterpolator());
                        j = 250;
                    } else {
                        animatorSet.setInterpolator(CubicBezierInterpolator.EASE_OUT);
                        j = 300;
                    }
                    animatorSet.setDuration(j);
                    animatorSet.addListener(new AnonymousClass44(view));
                    if (!z2) {
                        runnable3.run();
                    }
                    if (!z) {
                        toggleActionBar(false, true, new ActionBarToggleParams().enableStatusBarAnimation(false).enableTranslationAnimation(false).animationDuration(MediaDataController.MAX_LINKS_COUNT).animationInterpolator(new DecelerateInterpolator()));
                    }
                } else {
                    runnable = runnable2;
                    this.textureImageView.setVisibility(0);
                    this.videoSurfaceView.setVisibility(4);
                }
            } else {
                runnable = runnable2;
            }
            z2 = false;
            if (z) {
            }
            Runnable runnable32 = runnable;
            valueAnimatorOfFloat2.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda96
                @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                    this.f$0.lambda$switchToPip$86(cubicBezierInterpolator, f2, f4, f, f5, view, x, f3, y, valueAnimator);
                }
            });
            ValueAnimator valueAnimatorOfFloat32 = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f);
            valueAnimatorOfFloat32.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda97
                @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                    this.f$0.lambda$switchToPip$87(valueAnimator);
                }
            });
            ImageView imageView3 = this.textureImageView;
            Property property3 = View.SCALE_X;
            ObjectAnimator objectAnimatorOfFloat2 = ObjectAnimator.ofFloat(imageView3, (Property<ImageView, Float>) property3, width);
            ImageView imageView22 = this.textureImageView;
            Property property22 = View.SCALE_Y;
            animatorSet.playTogether(valueAnimatorOfFloat32, objectAnimatorOfFloat2, ObjectAnimator.ofFloat(imageView22, (Property<ImageView, Float>) property22, width), ObjectAnimator.ofFloat(view, (Property<View, Float>) property3, width), ObjectAnimator.ofFloat(view, (Property<View, Float>) property22, width), ObjectAnimator.ofInt(this.backgroundDrawable, (Property<BackgroundDrawable, Integer>) AnimationProperties.COLOR_DRAWABLE_ALPHA, 0), valueAnimatorOfFloat2);
            if (z) {
            }
            animatorSet.setDuration(j);
            animatorSet.addListener(new AnonymousClass44(view));
            if (!z2) {
            }
            if (!z) {
            }
        } else {
            this.switchToInlineRunnable.run();
            dismissInternal();
        }
        ChatActivity chatActivity = this.parentChatActivity;
        if (chatActivity == null || chatActivity.getFragmentView() == null) {
            return;
        }
        this.parentChatActivity.getFragmentView().invalidate();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void toggleActionBar(boolean z, boolean z2) {
        toggleActionBar(z, z2, ActionBarToggleParams.DEFAULT);
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:186:0x02e4  */
    /* JADX WARN: Removed duplicated region for block: B:51:0x00aa  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void toggleActionBar(final boolean z, boolean z2, ActionBarToggleParams actionBarToggleParams) {
        float f;
        CaptionScrollView captionScrollView;
        float f2;
        CaptionScrollView captionScrollView2;
        if (this.currentEditMode == 0) {
            int i = this.switchingToMode;
            if (i == 0 || i == -1) {
                AnimatorSet animatorSet = this.actionBarAnimator;
                if (animatorSet != null) {
                    animatorSet.cancel();
                }
                if (z) {
                    this.actionBar.setVisibility(0);
                    if (this.bottomLayout.getTag() != null) {
                        this.bottomLayout.setVisibility(0);
                    }
                    if (this.captionTextViewSwitcher.getTag() != null) {
                        this.captionTextViewSwitcher.setVisibility(0);
                        VideoSeekPreviewImage videoSeekPreviewImage = this.videoPreviewFrame;
                        if (videoSeekPreviewImage != null) {
                            videoSeekPreviewImage.requestLayout();
                        }
                    }
                }
                this.isActionBarVisible = z;
                PhotoViewerWebView photoViewerWebView = this.photoViewerWebView;
                if (photoViewerWebView != null) {
                    photoViewerWebView.setTouchDisabled(z);
                }
                if (actionBarToggleParams.enableStatusBarAnimation) {
                    updateContainerFlags(z);
                }
                if (this.videoPlayerControlVisible && this.isPlaying && z) {
                    scheduleActionBarHide();
                } else {
                    AndroidUtilities.cancelRunOnUIThread(this.hideActionBarRunnable);
                }
                if (!z) {
                    Bulletin.hide(this.containerView);
                }
                float fDpf2 = AndroidUtilities.dpf2(24.0f);
                this.videoPlayerControlFrameLayout.setSeekBarTransitionEnabled(actionBarToggleParams.enableTranslationAnimation && this.playerLooping);
                this.videoPlayerControlFrameLayout.setTranslationYAnimationEnabled(actionBarToggleParams.enableTranslationAnimation);
                if (!z2) {
                    ActionBar actionBar = this.actionBar;
                    if (z) {
                        CaptionContainerView captionView = getCaptionView();
                        CaptionPhotoViewer captionPhotoViewer = this.topCaptionEdit;
                        f = (captionView != captionPhotoViewer || captionPhotoViewer.keyboardNotifier.keyboardVisible()) ? 1.0f : BitmapDescriptorFactory.HUE_RED;
                    }
                    actionBar.setAlpha(f);
                    if (this.fullscreenButton[0].getTranslationX() != BitmapDescriptorFactory.HUE_RED && this.allowShowFullscreenButton) {
                        this.fullscreenButton[0].setAlpha(z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
                    }
                    for (int i2 = 0; i2 < 3; i2++) {
                        this.fullscreenButton[i2].setTranslationY(z ? BitmapDescriptorFactory.HUE_RED : fDpf2);
                    }
                    this.actionBar.setTranslationY(z ? BitmapDescriptorFactory.HUE_RED : -fDpf2);
                    PhotoCountView photoCountView = this.countView;
                    if (photoCountView != null) {
                        photoCountView.setAlpha(z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
                        this.countView.setTranslationY(z ? BitmapDescriptorFactory.HUE_RED : -fDpf2);
                    }
                    this.bottomLayout.setAlpha(z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
                    this.bottomLayout.setTranslationY(z ? BitmapDescriptorFactory.HUE_RED : fDpf2);
                    this.navigationBar.setAlpha(z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
                    this.groupedPhotosListView.setAlpha((!z || this.aboutToSwitchTo == 3) ? BitmapDescriptorFactory.HUE_RED : 1.0f);
                    this.groupedPhotosListView.setTranslationY((!z || this.aboutToSwitchTo == 3) ? fDpf2 : BitmapDescriptorFactory.HUE_RED);
                    if (!this.needCaptionLayout && (captionScrollView = this.captionScrollView) != null) {
                        captionScrollView.setAlpha(z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
                        CaptionScrollView captionScrollView3 = this.captionScrollView;
                        if (z) {
                            fDpf2 = BitmapDescriptorFactory.HUE_RED;
                        }
                        captionScrollView3.setTranslationY(fDpf2);
                    }
                    this.videoPlayerControlFrameLayout.setProgress(z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
                    if (this.muteButton.getTag() != null) {
                        this.muteButton.setAlpha(z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
                    }
                    if (this.videoPlayerControlVisible && this.isPlaying) {
                        this.photoProgressViews[0].setIndexedAlpha(1, z ? 1.0f : BitmapDescriptorFactory.HUE_RED, false);
                        return;
                    }
                    return;
                }
                ArrayList arrayList = new ArrayList();
                ActionBar actionBar2 = this.actionBar;
                Property property = View.ALPHA;
                if (z) {
                    CaptionContainerView captionView2 = getCaptionView();
                    CaptionPhotoViewer captionPhotoViewer2 = this.topCaptionEdit;
                    f2 = (captionView2 != captionPhotoViewer2 || captionPhotoViewer2.keyboardNotifier.keyboardVisible()) ? 1.0f : BitmapDescriptorFactory.HUE_RED;
                }
                arrayList.add(ObjectAnimator.ofFloat(actionBar2, (Property<ActionBar, Float>) property, f2));
                if (actionBarToggleParams.enableTranslationAnimation) {
                    arrayList.add(ObjectAnimator.ofFloat(this.actionBar, (Property<ActionBar, Float>) View.TRANSLATION_Y, z ? BitmapDescriptorFactory.HUE_RED : -fDpf2));
                } else {
                    this.actionBar.setTranslationY(BitmapDescriptorFactory.HUE_RED);
                }
                if (this.allowShowFullscreenButton) {
                    arrayList.add(ObjectAnimator.ofFloat(this.fullscreenButton[0], (Property<ImageView, Float>) property, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
                }
                for (int i3 = 1; i3 < 3; i3++) {
                    this.fullscreenButton[i3].setTranslationY(z ? BitmapDescriptorFactory.HUE_RED : fDpf2);
                }
                if (actionBarToggleParams.enableTranslationAnimation) {
                    arrayList.add(ObjectAnimator.ofFloat(this.fullscreenButton[0], (Property<ImageView, Float>) View.TRANSLATION_Y, z ? BitmapDescriptorFactory.HUE_RED : fDpf2));
                } else {
                    this.fullscreenButton[0].setTranslationY(BitmapDescriptorFactory.HUE_RED);
                }
                FrameLayout frameLayout = this.bottomLayout;
                if (frameLayout != null) {
                    arrayList.add(ObjectAnimator.ofFloat(frameLayout, (Property<FrameLayout, Float>) View.ALPHA, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
                    if (actionBarToggleParams.enableTranslationAnimation) {
                        arrayList.add(ObjectAnimator.ofFloat(this.bottomLayout, (Property<FrameLayout, Float>) View.TRANSLATION_Y, z ? BitmapDescriptorFactory.HUE_RED : fDpf2));
                    } else {
                        this.bottomLayout.setTranslationY(BitmapDescriptorFactory.HUE_RED);
                    }
                }
                PhotoCountView photoCountView2 = this.countView;
                if (photoCountView2 != null) {
                    arrayList.add(ObjectAnimator.ofFloat(photoCountView2, (Property<PhotoCountView, Float>) View.ALPHA, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
                    if (actionBarToggleParams.enableTranslationAnimation) {
                        arrayList.add(ObjectAnimator.ofFloat(this.countView, (Property<PhotoCountView, Float>) View.TRANSLATION_Y, z ? BitmapDescriptorFactory.HUE_RED : -fDpf2));
                    } else {
                        this.countView.setTranslationY(BitmapDescriptorFactory.HUE_RED);
                    }
                }
                View view = this.navigationBar;
                if (view != null) {
                    arrayList.add(ObjectAnimator.ofFloat(view, (Property<View, Float>) View.ALPHA, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
                }
                if (this.videoPlayerControlVisible) {
                    arrayList.add(ObjectAnimator.ofFloat(this.videoPlayerControlFrameLayout, (Property<VideoPlayerControlFrameLayout, Float>) VPC_PROGRESS, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
                } else {
                    this.videoPlayerControlFrameLayout.setProgress(z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
                }
                GroupedPhotosListView groupedPhotosListView = this.groupedPhotosListView;
                Property property2 = View.ALPHA;
                arrayList.add(ObjectAnimator.ofFloat(groupedPhotosListView, (Property<GroupedPhotosListView, Float>) property2, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
                ValueAnimator valueAnimatorOfFloat = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f);
                valueAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda17
                    @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                    public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                        Bulletin.updateCurrentPosition();
                    }
                });
                arrayList.add(valueAnimatorOfFloat);
                if (actionBarToggleParams.enableTranslationAnimation) {
                    arrayList.add(ObjectAnimator.ofFloat(this.groupedPhotosListView, (Property<GroupedPhotosListView, Float>) View.TRANSLATION_Y, z ? BitmapDescriptorFactory.HUE_RED : fDpf2));
                } else {
                    this.groupedPhotosListView.setTranslationY(BitmapDescriptorFactory.HUE_RED);
                }
                if (!this.needCaptionLayout && (captionScrollView2 = this.captionScrollView) != null) {
                    arrayList.add(ObjectAnimator.ofFloat(captionScrollView2, (Property<CaptionScrollView, Float>) property2, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
                    if (actionBarToggleParams.enableTranslationAnimation) {
                        CaptionScrollView captionScrollView4 = this.captionScrollView;
                        Property property3 = View.TRANSLATION_Y;
                        if (z) {
                            fDpf2 = BitmapDescriptorFactory.HUE_RED;
                        }
                        arrayList.add(ObjectAnimator.ofFloat(captionScrollView4, (Property<CaptionScrollView, Float>) property3, fDpf2));
                    } else {
                        this.captionScrollView.setTranslationY(BitmapDescriptorFactory.HUE_RED);
                    }
                }
                if (this.videoPlayerControlVisible && this.isPlaying) {
                    ValueAnimator valueAnimatorOfFloat2 = ValueAnimator.ofFloat(this.photoProgressViews[0].animAlphas[1], z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
                    valueAnimatorOfFloat2.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda18
                        @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                        public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                            this.f$0.lambda$toggleActionBar$116(valueAnimator);
                        }
                    });
                    arrayList.add(valueAnimatorOfFloat2);
                }
                if (this.muteButton.getTag() != null) {
                    arrayList.add(ObjectAnimator.ofFloat(this.muteButton, (Property<ImageView, Float>) property2, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
                }
                if (this.editCoverButton.getTag() != null) {
                    arrayList.add(ObjectAnimator.ofFloat(this.editCoverButton, (Property<EditCoverButton, Float>) property2, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
                }
                AnimatorSet animatorSet2 = new AnimatorSet();
                this.actionBarAnimator = animatorSet2;
                animatorSet2.playTogether(arrayList);
                this.actionBarAnimator.setDuration(actionBarToggleParams.animationDuration);
                this.actionBarAnimator.setInterpolator(actionBarToggleParams.animationInterpolator);
                this.actionBarAnimator.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.69
                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationCancel(Animator animator) {
                        if (animator.equals(PhotoViewer.this.actionBarAnimator)) {
                            PhotoViewer.this.actionBarAnimator = null;
                        }
                    }

                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationEnd(Animator animator) {
                        if (animator.equals(PhotoViewer.this.actionBarAnimator)) {
                            if (!z) {
                                PhotoViewer.this.actionBar.setVisibility(4);
                                if (PhotoViewer.this.bottomLayout.getTag() != null) {
                                    PhotoViewer.this.bottomLayout.setVisibility(4);
                                }
                                if (PhotoViewer.this.captionTextViewSwitcher.getTag() != null) {
                                    PhotoViewer.this.captionTextViewSwitcher.setVisibility(4);
                                }
                            }
                            PhotoViewer.this.actionBarAnimator = null;
                        }
                    }
                });
                this.actionBarAnimator.start();
            }
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:23:0x00a6  */
    /* JADX WARN: Removed duplicated region for block: B:33:0x00cc  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void toggleCaptionAbove() {
        PhotoViewerProvider photoViewerProvider = this.placeProvider;
        if (photoViewerProvider != null && photoViewerProvider.canMoveCaptionAbove()) {
            CaptionContainerView captionView = getCaptionView();
            this.placeProvider.moveCaptionAbove(!r1.isCaptionAbove());
            showEditCaption(true, true);
            CaptionContainerView captionView2 = getCaptionView();
            boolean zIsCaptionAbove = this.placeProvider.isCaptionAbove();
            if (captionView != captionView2) {
                captionView.editText.hidePopup(true);
                captionView2.setText(AnimatedEmojiSpan.cloneSpans(captionView.getText()));
                captionView2.editText.getEditText().setAllowTextEntitiesIntersection(captionView.editText.getEditText().getAllowTextEntitiesIntersection());
                if (captionView.editText.getEditText().isFocused()) {
                    captionView2.editText.getEditText().requestFocus();
                    captionView2.editText.getEditText().setSelection(captionView.editText.getEditText().getSelectionStart(), captionView.editText.getEditText().getSelectionEnd());
                }
                MentionsContainerView mentionsContainerView = captionView.mentionContainer;
                if (mentionsContainerView != null) {
                    AndroidUtilities.removeFromParent(mentionsContainerView);
                    captionView.mentionContainer = null;
                }
                ViewPropertyAnimator viewPropertyAnimatorAnimate = this.actionBar.animate();
                if (this.isActionBarVisible) {
                    CaptionContainerView captionView3 = getCaptionView();
                    CaptionPhotoViewer captionPhotoViewer = this.topCaptionEdit;
                    float f = (captionView3 == captionPhotoViewer && captionPhotoViewer.keyboardNotifier.keyboardVisible()) ? BitmapDescriptorFactory.HUE_RED : 1.0f;
                    viewPropertyAnimatorAnimate.alpha(f).start();
                    if (this.pickerView.getVisibility() == 0) {
                        if (this.isActionBarVisible) {
                            CaptionContainerView captionView4 = getCaptionView();
                            CaptionPhotoViewer captionPhotoViewer2 = this.topCaptionEdit;
                            boolean z = (captionView4 == captionPhotoViewer2 && captionPhotoViewer2.keyboardNotifier.keyboardVisible()) ? false : true;
                            toggleOnlyCheckImageView(z);
                        }
                    }
                }
            }
            if (MessagesController.getInstance(this.currentAccount).shouldShowMoveCaptionHint()) {
                MessagesController.getInstance(this.currentAccount).incrementMoveCaptionHint();
                BulletinFactory.of(zIsCaptionAbove ? this.bottomBulletinUnderCaption : this.topBulletinUnderCaption, new DarkThemeResourceProvider()).createSimpleBulletin(zIsCaptionAbove ? R.raw.caption_up : R.raw.caption_down, LocaleController.getString(zIsCaptionAbove ? R.string.MovedCaptionUp : R.string.MovedCaptionDown), LocaleController.getString(zIsCaptionAbove ? R.string.MovedCaptionUpText : R.string.MovedCaptionDownText)).setImageScale(0.8f).show(!zIsCaptionAbove);
            }
            CaptionPhotoViewer captionPhotoViewer3 = this.captionEdit;
            if (captionPhotoViewer3 != null) {
                captionPhotoViewer3.closeKeyboard();
            }
        }
    }

    private void toggleCheckImageView(boolean z) {
        AnimatorSet animatorSet = new AnimatorSet();
        ArrayList arrayList = new ArrayList();
        float fDpf2 = AndroidUtilities.dpf2(24.0f);
        FrameLayout frameLayout = this.pickerView;
        Property property = View.ALPHA;
        float f = BitmapDescriptorFactory.HUE_RED;
        arrayList.add(ObjectAnimator.ofFloat(frameLayout, (Property<FrameLayout, Float>) property, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
        FrameLayout frameLayout2 = this.pickerView;
        Property property2 = View.TRANSLATION_Y;
        arrayList.add(ObjectAnimator.ofFloat(frameLayout2, (Property<FrameLayout, Float>) property2, z ? BitmapDescriptorFactory.HUE_RED : fDpf2));
        StickerMakerView stickerMakerView = this.stickerMakerView;
        if (stickerMakerView != null) {
            arrayList.add(ObjectAnimator.ofFloat(stickerMakerView, (Property<StickerMakerView, Float>) property, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
        }
        if (this.stickerMakerView != null) {
            arrayList.add(ObjectAnimator.ofFloat(this.stickerMakerBackgroundView, (Property<StickerMakerBackgroundView, Float>) property, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
        }
        arrayList.add(ObjectAnimator.ofFloat(this.pickerViewSendButton, (Property<ChatActivityEnterView.SendButton, Float>) property, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
        arrayList.add(ObjectAnimator.ofFloat(this.pickerViewSendButton, (Property<ChatActivityEnterView.SendButton, Float>) property2, z ? BitmapDescriptorFactory.HUE_RED : fDpf2));
        int i = this.sendPhotoType;
        if (i == 0 || i == 4) {
            arrayList.add(ObjectAnimator.ofFloat(this.checkImageView, (Property<CheckBox, Float>) property, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
            arrayList.add(ObjectAnimator.ofFloat(this.checkImageView, (Property<CheckBox, Float>) property2, z ? BitmapDescriptorFactory.HUE_RED : -fDpf2));
            arrayList.add(ObjectAnimator.ofFloat(this.photosCounterView, (Property<CounterView, Float>) property, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
            CounterView counterView = this.photosCounterView;
            if (!z) {
                f = -fDpf2;
            }
            arrayList.add(ObjectAnimator.ofFloat(counterView, (Property<CounterView, Float>) property2, f));
        }
        animatorSet.playTogether(arrayList);
        animatorSet.setDuration(200L);
        animatorSet.start();
        if (z || !isCaptionOpen()) {
            return;
        }
        closeCaptionEnter(true);
        if (this.captionEdit.editText.isPopupShowing()) {
            this.captionEdit.editText.hidePopup(true);
        }
        if (this.topCaptionEdit.editText.isPopupShowing()) {
            this.topCaptionEdit.editText.hidePopup(true);
        }
        this.captionEdit.editText.closeKeyboard();
        this.topCaptionEdit.editText.closeKeyboard();
    }

    private void toggleMiniProgress(boolean z, boolean z2) {
        AndroidUtilities.cancelRunOnUIThread(this.miniProgressShowRunnable);
        if (!z2) {
            AnimatorSet animatorSet = this.miniProgressAnimator;
            if (animatorSet != null) {
                animatorSet.cancel();
                this.miniProgressAnimator = null;
            }
            this.miniProgressView.setAlpha(z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
            this.miniProgressView.setVisibility(z ? 0 : 4);
            return;
        }
        toggleMiniProgressInternal(z);
        if (!z) {
            AnimatorSet animatorSet2 = this.miniProgressAnimator;
            if (animatorSet2 != null) {
                animatorSet2.cancel();
                toggleMiniProgressInternal(false);
                return;
            }
            return;
        }
        AnimatorSet animatorSet3 = this.miniProgressAnimator;
        if (animatorSet3 != null) {
            animatorSet3.cancel();
            this.miniProgressAnimator = null;
        }
        if (!this.firstAnimationDelay) {
            AndroidUtilities.runOnUIThread(this.miniProgressShowRunnable, 500L);
        } else {
            this.firstAnimationDelay = false;
            toggleMiniProgressInternal(true);
        }
    }

    private void toggleMiniProgressInternal(final boolean z) {
        if (z) {
            this.miniProgressView.setVisibility(0);
        }
        AnimatorSet animatorSet = new AnimatorSet();
        this.miniProgressAnimator = animatorSet;
        animatorSet.playTogether(ObjectAnimator.ofFloat(this.miniProgressView, (Property<RadialProgressView, Float>) View.ALPHA, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
        this.miniProgressAnimator.setDuration(200L);
        this.miniProgressAnimator.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.68
            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
            public void onAnimationCancel(Animator animator) {
                if (animator.equals(PhotoViewer.this.miniProgressAnimator)) {
                    PhotoViewer.this.miniProgressAnimator = null;
                }
            }

            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
            public void onAnimationEnd(Animator animator) {
                if (animator.equals(PhotoViewer.this.miniProgressAnimator)) {
                    if (!z) {
                        PhotoViewer.this.miniProgressView.setVisibility(4);
                    }
                    PhotoViewer.this.miniProgressAnimator = null;
                }
            }
        });
        this.miniProgressAnimator.start();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void toggleOnlyCheckImageView(boolean z) {
        AnimatorSet animatorSet = new AnimatorSet();
        ArrayList arrayList = new ArrayList();
        float fDpf2 = AndroidUtilities.dpf2(24.0f);
        int i = this.sendPhotoType;
        if (i == 0 || i == 4) {
            CheckBox checkBox = this.checkImageView;
            Property property = View.ALPHA;
            float f = BitmapDescriptorFactory.HUE_RED;
            arrayList.add(ObjectAnimator.ofFloat(checkBox, (Property<CheckBox, Float>) property, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
            CheckBox checkBox2 = this.checkImageView;
            Property property2 = View.TRANSLATION_Y;
            arrayList.add(ObjectAnimator.ofFloat(checkBox2, (Property<CheckBox, Float>) property2, z ? BitmapDescriptorFactory.HUE_RED : -fDpf2));
            arrayList.add(ObjectAnimator.ofFloat(this.photosCounterView, (Property<CounterView, Float>) property, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
            CounterView counterView = this.photosCounterView;
            if (!z) {
                f = -fDpf2;
            }
            arrayList.add(ObjectAnimator.ofFloat(counterView, (Property<CounterView, Float>) property2, f));
        }
        animatorSet.playTogether(arrayList);
        animatorSet.setDuration(200L);
        animatorSet.start();
    }

    private void togglePhotosListView(boolean z, boolean z2) {
        if (z == this.isPhotosListViewVisible) {
            return;
        }
        if (z) {
            this.selectedPhotosListView.setVisibility(0);
        }
        this.isPhotosListViewVisible = z;
        this.selectedPhotosListView.setEnabled(z);
        if (!z2) {
            this.selectedPhotosListView.setAlpha(z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
            this.selectedPhotosListView.setTranslationY(z ? BitmapDescriptorFactory.HUE_RED : -AndroidUtilities.dp(10.0f));
            this.photosCounterView.setRotationX(z ? 1.0f : BitmapDescriptorFactory.HUE_RED);
            if (z) {
                return;
            }
            this.selectedPhotosListView.setVisibility(8);
            return;
        }
        ArrayList arrayList = new ArrayList();
        arrayList.add(ObjectAnimator.ofFloat(this.selectedPhotosListView, (Property<SelectedPhotosListView, Float>) View.ALPHA, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
        arrayList.add(ObjectAnimator.ofFloat(this.selectedPhotosListView, (Property<SelectedPhotosListView, Float>) View.TRANSLATION_Y, z ? BitmapDescriptorFactory.HUE_RED : -AndroidUtilities.dp(10.0f)));
        arrayList.add(ObjectAnimator.ofFloat(this.photosCounterView, (Property<CounterView, Float>) View.ROTATION_X, z ? 1.0f : BitmapDescriptorFactory.HUE_RED));
        AnimatorSet animatorSet = new AnimatorSet();
        this.currentListViewAnimation = animatorSet;
        animatorSet.playTogether(arrayList);
        if (!z) {
            this.currentListViewAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.70
                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                public void onAnimationEnd(Animator animator) {
                    if (PhotoViewer.this.currentListViewAnimation == null || !PhotoViewer.this.currentListViewAnimation.equals(animator)) {
                        return;
                    }
                    PhotoViewer.this.selectedPhotosListView.setVisibility(8);
                    PhotoViewer.this.currentListViewAnimation = null;
                }
            });
        }
        this.currentListViewAnimation.setDuration(200L);
        this.currentListViewAnimation.start();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void toggleVideoPlayer() {
        VideoPlayer videoPlayer;
        VideoPlayer videoPlayer2;
        PhotoViewerWebView photoViewerWebView;
        if (this.videoPlayer != null || ((photoViewerWebView = this.photoViewerWebView) != null && photoViewerWebView.isControllable())) {
            boolean zIsPlaying = this.videoPlayer != null ? this.isPlaying : this.photoViewerWebView.isPlaying();
            cancelVideoPlayRunnable();
            AndroidUtilities.cancelRunOnUIThread(this.hideActionBarRunnable);
            if (zIsPlaying) {
                pauseVideoOrWeb();
            } else {
                if (!this.isCurrentVideo) {
                    if (Math.abs(this.videoPlayerSeekbar.getProgress() - this.videoTimelineView.getRightProgress()) < 0.01f || ((videoPlayer = this.videoPlayer) != null && videoPlayer.getCurrentPosition() == this.videoPlayer.getDuration())) {
                        seekVideoOrWebToProgress(BitmapDescriptorFactory.HUE_RED);
                    }
                    scheduleActionBarHide();
                } else if (Math.abs(this.videoTimelineView.getProgress() - this.videoTimelineView.getRightProgress()) < 0.01f || ((videoPlayer2 = this.videoPlayer) != null && videoPlayer2.getCurrentPosition() == this.videoPlayer.getDuration())) {
                    seekVideoOrWebToProgress(this.videoTimelineView.getLeftProgress());
                }
                playVideoOrWeb();
            }
            this.containerView.invalidate();
        }
    }

    private void translateY(float f) {
        ValueAnimator valueAnimator = this.translateYAnimator;
        if (valueAnimator != null) {
            valueAnimator.cancel();
            this.translateYAnimator = null;
        }
        if (this.currentEditMode != 3) {
            f = BitmapDescriptorFactory.HUE_RED;
        }
        ValueAnimator valueAnimatorOfFloat = ValueAnimator.ofFloat(this.translateY, f);
        this.translateYAnimator = valueAnimatorOfFloat;
        valueAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda172
            @Override // android.animation.ValueAnimator.AnimatorUpdateListener
            public final void onAnimationUpdate(ValueAnimator valueAnimator2) {
                this.f$0.lambda$translateY$111(valueAnimator2);
            }
        });
        this.translateYAnimator.setDuration(320L);
        this.translateYAnimator.setInterpolator(CubicBezierInterpolator.EASE_OUT_QUINT);
        this.translateYAnimator.start();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void updateAccessibilityOverlayVisibility() {
        View view;
        int i;
        String str;
        if (this.playButtonAccessibilityOverlay != null) {
            int i2 = this.photoProgressViews[0].backgroundState;
            if (!this.photoProgressViews[0].isVisible() || (i2 != 3 && i2 != 4 && i2 != 2 && i2 != 1)) {
                this.playButtonAccessibilityOverlay.setVisibility(4);
                return;
            }
            if (i2 == 3) {
                view = this.playButtonAccessibilityOverlay;
                i = R.string.AccActionPlay;
                str = "AccActionPlay";
            } else if (i2 == 2) {
                view = this.playButtonAccessibilityOverlay;
                i = R.string.AccActionDownload;
                str = "AccActionDownload";
            } else if (i2 == 1) {
                view = this.playButtonAccessibilityOverlay;
                i = R.string.AccActionCancelDownload;
                str = "AccActionCancelDownload";
            } else {
                view = this.playButtonAccessibilityOverlay;
                i = R.string.AccActionPause;
                str = "AccActionPause";
            }
            view.setContentDescription(LocaleController.getString(str, i));
            this.playButtonAccessibilityOverlay.setVisibility(0);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void updateActionBarTitlePadding() {
        if (this.menu == null || this.actionBarContainer == null) {
            return;
        }
        float fMax = BitmapDescriptorFactory.HUE_RED;
        for (int i = 0; i < this.menu.getChildCount(); i++) {
            View childAt = this.menu.getChildAt(i);
            if (childAt.getVisibility() == 0) {
                fMax += Math.min(0.5f, childAt.getAlpha()) * 2.0f * childAt.getWidth();
            }
        }
        CheckBox checkBox = this.checkImageView;
        if (checkBox != null && checkBox.getVisibility() == 0) {
            fMax = Math.max(fMax, AndroidUtilities.dp(48.0f));
        }
        CounterView counterView = this.photosCounterView;
        if (counterView != null && counterView.getVisibility() == 0) {
            fMax = Math.max(fMax, AndroidUtilities.dp(100.0f));
        }
        this.actionBarContainer.updateRightPadding(fMax, false);
    }

    private void updateCaptionTextForCurrentPhoto(Object obj) {
        CharSequence charSequence = this.hasCaptionForAllMedia ? this.captionForAllMedia : obj instanceof MediaController.PhotoEntry ? ((MediaController.PhotoEntry) obj).caption : (!(obj instanceof TLRPC.BotInlineResult) && (obj instanceof MediaController.SearchImage)) ? ((MediaController.SearchImage) obj).caption : null;
        if (TextUtils.isEmpty(charSequence)) {
            getCaptionView().setText("");
        } else {
            getCaptionView().setText(AnimatedEmojiSpan.cloneSpans(charSequence, 3));
        }
        getCaptionView().editText.getEditText().setAllowTextEntitiesIntersection(supportsSendingNewEntities());
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void updateCaptionTranslated() {
        int i;
        MessageObject messageObject;
        CharSequence charSequencePostProcessTranslated;
        boolean z;
        TLRPC.Message message;
        if (this.imagesArr.isEmpty() || (i = this.switchingToIndex) < 0 || i >= this.imagesArr.size() || (messageObject = (MessageObject) this.imagesArr.get(this.switchingToIndex)) == null) {
            return;
        }
        if (!this.captionTranslated || (message = messageObject.messageOwner) == null || message.translatedText == null || !TextUtils.equals(message.translatedToLanguage, TranslateAlert2.getToLanguage())) {
            charSequencePostProcessTranslated = messageObject.caption;
            z = this.captionTranslated;
        } else {
            charSequencePostProcessTranslated = postProcessTranslated(messageObject);
            z = false;
        }
        setCurrentCaption(messageObject, charSequencePostProcessTranslated, z, true);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void updateCompressionsCount(int i, int i2) {
        int iMax = Math.max(i, i2);
        this.compressionsCount = iMax > 1280 ? 4 : iMax > 854 ? 3 : iMax > 640 ? 2 : 1;
    }

    private void updateContainerFlags(boolean z) {
        FrameLayoutDrawer frameLayoutDrawer;
        if (Build.VERSION.SDK_INT < 21 || this.sendPhotoType == 1 || (frameLayoutDrawer = this.containerView) == null) {
            return;
        }
        this.containerView.setSystemUiVisibility(!z ? (frameLayoutDrawer.getPaddingLeft() > 0 || this.containerView.getPaddingRight() > 0) ? 5894 : 1796 : 1792);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void updateMinMax(float f) {
        AspectRatioFrameLayout aspectRatioFrameLayout = this.aspectRatioFrameLayout;
        if (aspectRatioFrameLayout != null && aspectRatioFrameLayout.getVisibility() == 0 && this.textureUploaded) {
            View view = this.usedSurfaceView ? this.videoSurfaceView : this.videoTextureView;
            f *= Math.min(getContainerViewWidth() / view.getMeasuredWidth(), getContainerViewHeight() / view.getMeasuredHeight());
        }
        float imageWidth = this.centerImage.getImageWidth();
        float imageHeight = this.centerImage.getImageHeight();
        MediaController.CropState cropState = this.editState.cropState;
        if (cropState != null) {
            imageWidth *= cropState.cropPw;
            imageHeight *= cropState.cropPh;
        }
        int containerViewWidth = this.sendPhotoType == 11 ? (int) (imageWidth * f) : ((int) ((imageWidth * f) - getContainerViewWidth())) / 2;
        int containerViewHeight = this.sendPhotoType == 11 ? (int) (imageHeight * f) : ((int) ((imageHeight * f) - getContainerViewHeight())) / 2;
        if (containerViewWidth > 0) {
            this.minX = -containerViewWidth;
            this.maxX = containerViewWidth;
        } else {
            this.maxX = BitmapDescriptorFactory.HUE_RED;
            this.minX = BitmapDescriptorFactory.HUE_RED;
        }
        if (containerViewHeight > 0) {
            this.minY = -containerViewHeight;
            this.maxY = containerViewHeight;
        } else {
            this.maxY = BitmapDescriptorFactory.HUE_RED;
            this.minY = BitmapDescriptorFactory.HUE_RED;
        }
        LPhotoPaintView lPhotoPaintView = this.photoPaintView;
        if (lPhotoPaintView != null) {
            lPhotoPaintView.updateZoom(f <= 1.1f);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:175:0x024f  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void updatePlayerState(boolean z, int i) {
        VideoPlayer videoPlayer;
        MessageObject messageObject;
        TLRPC.MessageMedia messageMedia;
        TLRPC.WebPage webPage;
        PhotoViewerWebView photoViewerWebView;
        if (this.videoPlayer != null || ((photoViewerWebView = this.photoViewerWebView) != null && photoViewerWebView.isControllable())) {
            VideoAds videoAds = this.ads;
            if (videoAds != null) {
                videoAds.setWaitingPaused((z && i == 3) ? false : true);
            }
            PhotoViewerWebView photoViewerWebView2 = this.photoViewerWebView;
            if (photoViewerWebView2 != null && photoViewerWebView2.isControllable() && !z) {
                toggleActionBar(true, true);
            }
            PhotoViewerWebView photoViewerWebView3 = this.photoViewerWebView;
            float f = BitmapDescriptorFactory.HUE_RED;
            if (photoViewerWebView3 != null && photoViewerWebView3.isControllable() && i == 3 && getVideoDuration() >= 10000 && this.shouldSavePositionForCurrentVideo == null && this.shouldSavePositionForCurrentVideoShortTerm == null) {
                if (this.currentMessageObject != null) {
                    long videoDuration = getVideoDuration() / 1000;
                    TLRPC.Message message = this.currentMessageObject.messageOwner;
                    String str = (message == null || (messageMedia = message.media) == null || (webPage = messageMedia.webpage) == null) ? null : webPage.url;
                    if (!TextUtils.isEmpty(str)) {
                        if (videoDuration >= 10) {
                            SavedVideoPosition savedVideoPosition = (SavedVideoPosition) savedVideoPositions.get(str);
                            MessageObject messageObject2 = this.currentMessageObject;
                            if (messageObject2.forceSeekTo < BitmapDescriptorFactory.HUE_RED && savedVideoPosition != null) {
                                float f2 = savedVideoPosition.position;
                                if (f2 > BitmapDescriptorFactory.HUE_RED && f2 < 0.999f) {
                                    messageObject2.forceSeekTo = f2;
                                    this.videoPlayerSeekbar.setProgress(f2);
                                }
                            }
                            this.shouldSavePositionForCurrentVideoShortTerm = str;
                        }
                        if (videoDuration >= 300) {
                            if (this.currentMessageObject.forceSeekTo < BitmapDescriptorFactory.HUE_RED) {
                                float f3 = ApplicationLoader.applicationContext.getSharedPreferences("media_saved_pos", 0).getFloat(str, -1.0f);
                                if (f3 > BitmapDescriptorFactory.HUE_RED && f3 < 0.999f) {
                                    this.currentMessageObject.forceSeekTo = f3;
                                    this.videoPlayerSeekbar.setProgress(f3);
                                }
                            }
                            this.shouldSavePositionForCurrentVideo = str;
                        }
                    }
                }
                MessageObject messageObject3 = this.currentMessageObject;
                if (messageObject3 != null) {
                    float f4 = messageObject3.forceSeekTo;
                    if (f4 >= BitmapDescriptorFactory.HUE_RED) {
                        seekVideoOrWebToProgress(f4);
                        this.currentMessageObject.forceSeekTo = -1.0f;
                    }
                }
            }
            if (this.isStreaming) {
                if (i != 2 || !this.skipFirstBufferingProgress) {
                    boolean z2 = this.seekToProgressPending != BitmapDescriptorFactory.HUE_RED || i == 2;
                    if (z2) {
                        AndroidUtilities.cancelRunOnUIThread(this.hideActionBarRunnable);
                    } else {
                        scheduleActionBarHide();
                    }
                    toggleMiniProgress(z2, true);
                } else if (z) {
                    this.skipFirstBufferingProgress = false;
                }
            }
            AspectRatioFrameLayout aspectRatioFrameLayout = this.aspectRatioFrameLayout;
            if (aspectRatioFrameLayout != null) {
                aspectRatioFrameLayout.setKeepScreenOn((!z || i == 4 || i == 1) ? false : true);
            }
            try {
                if (!z || i == 4 || i == 1) {
                    this.parentActivity.getWindow().clearFlags(128);
                    this.keepScreenOnFlagSet = false;
                } else {
                    this.parentActivity.getWindow().addFlags(128);
                    this.keepScreenOnFlagSet = true;
                }
            } catch (Exception e) {
                FileLog.e(e);
            }
            if (i == 3 || i == 1) {
                MessageObject messageObject4 = this.currentMessageObject;
                if (messageObject4 != null && (videoPlayer = this.videoPlayer) != null) {
                    this.videoPreviewFrame.open(messageObject4, videoPlayer);
                }
                float f5 = this.seekToProgressPending;
                if (f5 != BitmapDescriptorFactory.HUE_RED) {
                    seekVideoOrWebToProgress(f5);
                    this.seekToProgressPending = BitmapDescriptorFactory.HUE_RED;
                    MessageObject messageObject5 = this.currentMessageObject;
                    if (messageObject5 != null && !FileLoader.getInstance(messageObject5.currentAccount).isLoadingVideoAny(this.currentMessageObject.getDocument())) {
                        this.skipFirstBufferingProgress = true;
                    }
                }
            }
            if (i == 3) {
                AspectRatioFrameLayout aspectRatioFrameLayout2 = this.aspectRatioFrameLayout;
                if (aspectRatioFrameLayout2 != null && aspectRatioFrameLayout2.getVisibility() != 0) {
                    this.aspectRatioFrameLayout.setVisibility(0);
                }
                if (!this.pipItem.isEnabled() && this.pipItem.getVisibility() == 0) {
                    this.pipAvailable = true;
                    this.pipItem.setEnabled(true);
                    this.pipItem.animate().alpha(1.0f).setDuration(175L).withEndAction(null).start();
                }
                this.playerWasReady = true;
                MessageObject messageObject6 = this.currentMessageObject;
                if (messageObject6 != null && messageObject6.isVideo()) {
                    AndroidUtilities.cancelRunOnUIThread(this.setLoadingRunnable);
                    FileLoader.getInstance(this.currentMessageObject.currentAccount).removeLoadingVideo(this.currentMessageObject.getDocument(), true, false);
                }
            } else if (i == 2 && z && (messageObject = this.currentMessageObject) != null && messageObject.isVideo()) {
                if (this.playerWasReady) {
                    this.setLoadingRunnable.run();
                } else {
                    AndroidUtilities.runOnUIThread(this.setLoadingRunnable, 1000L);
                }
            }
            VideoPlayer videoPlayer2 = this.videoPlayer;
            if (videoPlayer2 == null ? !this.photoViewerWebView.isPlaying() : !videoPlayer2.isPlaying()) {
                if (this.isPlaying || i == 4) {
                    if (this.currentEditMode != 3) {
                        this.photoProgressViews[0].setIndexedAlpha(1, 1.0f, i == 4);
                        PhotoProgressView photoProgressView = this.photoProgressViews[0];
                        photoProgressView.setBackgroundState(3, false, photoProgressView.animAlphas[1] > BitmapDescriptorFactory.HUE_RED);
                    }
                    this.isPlaying = false;
                    AndroidUtilities.cancelRunOnUIThread(this.updateProgressRunnable);
                    if (i == 4) {
                        if (!this.isCurrentVideo) {
                            this.videoPlayerSeekbar.setProgress(BitmapDescriptorFactory.HUE_RED);
                            this.videoPlayerSeekbarView.invalidate();
                            if (this.inPreview || this.videoTimelineViewContainer.getVisibility() != 0) {
                                seekVideoOrWebToProgress(BitmapDescriptorFactory.HUE_RED);
                            } else {
                                seekVideoOrWebToProgress(this.videoTimelineView.getLeftProgress());
                            }
                            this.manuallyPaused = false;
                            pauseVideoOrWeb();
                            if (!this.isActionBarVisible) {
                                toggleActionBar(true, true);
                            }
                        } else if (!this.videoTimelineView.isDragging()) {
                            VideoTimelinePlayView videoTimelinePlayView = this.videoTimelineView;
                            videoTimelinePlayView.setProgress(videoTimelinePlayView.getLeftProgress());
                            if (this.inPreview || (this.currentEditMode == 0 && this.videoTimelineViewContainer.getVisibility() != 0)) {
                                seekVideoOrWebToProgress(BitmapDescriptorFactory.HUE_RED);
                            } else {
                                seekVideoOrWebToProgress(this.videoTimelineView.getLeftProgress());
                            }
                            this.manuallyPaused = false;
                            cancelVideoPlayRunnable();
                            if (this.sendPhotoType == 1 || this.currentEditMode != 0 || this.switchingToMode > 0) {
                                playVideoOrWeb();
                            } else {
                                pauseVideoOrWeb();
                            }
                            this.containerView.invalidate();
                        }
                        PipVideoOverlay.onVideoCompleted();
                    }
                }
            } else if (i != 4) {
                if (!this.isPlaying) {
                    this.isPlaying = true;
                    this.photoProgressViews[0].setBackgroundState(this.isCurrentVideo ? -1 : 4, false, true);
                    PhotoProgressView photoProgressView2 = this.photoProgressViews[0];
                    if (this.isCurrentVideo || ((isAccessibilityEnabled() && !this.playerWasPlaying) || ((!this.playerAutoStarted || this.playerWasPlaying) && this.isActionBarVisible))) {
                        f = 1.0f;
                    }
                    photoProgressView2.setIndexedAlpha(1, f, false);
                    this.playerWasPlaying = true;
                    AndroidUtilities.runOnUIThread(this.updateProgressRunnable);
                }
            }
            PipVideoOverlay.updatePlayButton();
            this.videoPlayerSeekbar.updateTimestamps(this.currentMessageObject, getVideoDuration());
            updateVideoPlayerTime();
            AndroidUtilities.runOnUIThread(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda130
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.pipInvalidateAvailability();
                }
            });
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Removed duplicated region for block: B:126:0x03c2  */
    /* JADX WARN: Removed duplicated region for block: B:127:0x03da  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void updateQualityItems() {
        int i;
        int i2;
        VideoPlayer.Quality quality;
        int i3;
        String str;
        String str2;
        String str3;
        MessageObject messageObject;
        VideoPlayer videoPlayer;
        int i4;
        VideoPlayer.Quality quality2;
        int i5;
        String str4;
        String str5;
        VideoPlayer videoPlayer2 = this.videoPlayer;
        String string = "";
        int i6 = -1;
        if (videoPlayer2 == null || videoPlayer2.getQualitiesCount() <= 1) {
            this.videoQualityLayout.setVisibility(8);
            this.chooseSpeedLayout.setVisibility(0);
            this.galleryButton.setRightIcon(0);
            this.videoItemIcon.bottomText.setText("", true);
            this.lastQualityIndexSelected = -1;
            return;
        }
        this.galleryButton.setRightIcon(R.drawable.msg_arrowright);
        this.chooseSpeedLayout.setVisibility(8);
        this.videoQualityLayout.setVisibility(0);
        VideoPlayer.Quality currentQuality = this.videoPlayer.getCurrentQuality();
        int currentQualityIndex = this.videoPlayer.getCurrentQualityIndex();
        String str6 = ", ";
        String str7 = "\n";
        String str8 = "x";
        if (this.videoPlayer.getQualitiesCount() + 1 != this.videoQualityItems.size()) {
            this.videoQualityLayout.removeAllViews();
            this.videoQualityItems.clear();
            TextView textView = new TextView(this.activityContext);
            textView.setText(LocaleController.getString(R.string.QualityList));
            textView.setTypeface(AndroidUtilities.bold());
            textView.setPadding(AndroidUtilities.dp(16.0f), AndroidUtilities.dp(9.0f), AndroidUtilities.dp(16.0f), AndroidUtilities.dp(8.0f));
            textView.setTextSize(1, 14.0f);
            textView.setTextColor(-1);
            this.videoQualityLayout.addView(textView, LayoutHelper.createLinear(-1, -2));
            final int i7 = -1;
            while (i7 < this.videoPlayer.getQualitiesCount()) {
                SpannableStringBuilder spannableStringBuilder = new SpannableStringBuilder();
                if (i7 == i6) {
                    spannableStringBuilder.append((CharSequence) LocaleController.getString(R.string.QualityAuto));
                    if (i7 != this.videoPlayer.getSelectedQuality() || currentQuality == null) {
                        quality2 = null;
                    } else {
                        spannableStringBuilder.append((CharSequence) " ");
                        int length = spannableStringBuilder.length();
                        if (SharedConfig.debugVideoQualities) {
                            spannableStringBuilder.append((CharSequence) Integer.toString(currentQuality.width)).append((CharSequence) "x").append((CharSequence) Integer.toString(currentQuality.height));
                        } else {
                            spannableStringBuilder.append((CharSequence) String.valueOf(currentQuality.p())).append((CharSequence) "p");
                        }
                        spannableStringBuilder.setSpan(new ForegroundColorSpan(Theme.multAlpha(i6, 0.5f)), length, spannableStringBuilder.length(), 33);
                        quality2 = currentQuality;
                    }
                } else {
                    VideoPlayer.Quality quality3 = this.videoPlayer.getQuality(i7);
                    spannableStringBuilder.append((CharSequence) LocaleController.getString(quality3.original ? R.string.QualityOriginal : quality3.p() >= 2000 ? R.string.Quality2160 : quality3.p() >= 1400 ? R.string.Quality1440 : quality3.p() >= 1000 ? R.string.Quality1080 : quality3.p() >= 700 ? R.string.Quality720 : quality3.p() >= 400 ? R.string.Quality480 : quality3.p() >= 340 ? R.string.Quality360 : quality3.p() >= 200 ? R.string.Quality240 : R.string.Quality144));
                    spannableStringBuilder.append((CharSequence) " ");
                    int length2 = spannableStringBuilder.length();
                    if (SharedConfig.debugVideoQualities) {
                        spannableStringBuilder.append((CharSequence) Integer.toString(quality3.width)).append((CharSequence) "x").append((CharSequence) Integer.toString(quality3.height));
                    } else {
                        spannableStringBuilder.append((CharSequence) String.valueOf(quality3.p())).append((CharSequence) "p");
                    }
                    spannableStringBuilder.setSpan(new ForegroundColorSpan(Theme.multAlpha(i6, 0.5f)), length2, spannableStringBuilder.length(), 33);
                    quality2 = quality3;
                }
                ActionBarMenuSubItem actionBarMenuSubItemAddItem = ActionBarMenuItem.addItem(this.videoQualityLayout, 0, spannableStringBuilder, true, null);
                if (!SharedConfig.debugVideoQualities || quality2 == null) {
                    i5 = currentQualityIndex;
                    str4 = str6;
                    str5 = str7;
                    actionBarMenuSubItemAddItem.setSubtext("");
                } else {
                    StringBuilder sb = new StringBuilder();
                    Iterator it = quality2.uris.iterator();
                    while (it.hasNext()) {
                        VideoPlayer.VideoUri videoUri = (VideoPlayer.VideoUri) it.next();
                        if (sb.length() > 0) {
                            sb.append(str7);
                        }
                        if (!TextUtils.isEmpty(videoUri.codec)) {
                            sb.append(videoUri.codec);
                            sb.append(str6);
                        }
                        int i8 = currentQualityIndex;
                        sb.append(AndroidUtilities.formatFileSize(videoUri.size).replace(" ", ""));
                        sb.append("(");
                        StringBuilder sb2 = new StringBuilder();
                        String str9 = str6;
                        String str10 = str7;
                        sb2.append(AndroidUtilities.formatFileSize((long) videoUri.bitrate).replace(" ", ""));
                        sb2.append("/s)");
                        sb.append(sb2.toString());
                        sb.append(videoUri.isManifestCached() ? "!" : " ");
                        sb.append(videoUri.isCached() ? "!" : " ");
                        str6 = str9;
                        currentQualityIndex = i8;
                        str7 = str10;
                    }
                    i5 = currentQualityIndex;
                    str4 = str6;
                    str5 = str7;
                    actionBarMenuSubItemAddItem.setSubtext(sb.toString());
                }
                actionBarMenuSubItemAddItem.setChecked(i7 == this.videoPlayer.getSelectedQuality());
                actionBarMenuSubItemAddItem.setColors(-328966, -328966);
                actionBarMenuSubItemAddItem.setVisibility(0);
                actionBarMenuSubItemAddItem.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda78
                    @Override // android.view.View.OnClickListener
                    public final void onClick(View view) throws NumberFormatException {
                        this.f$0.lambda$updateQualityItems$79(i7, view);
                    }
                });
                actionBarMenuSubItemAddItem.setSelectorColor(268435455);
                this.videoQualityItems.add(actionBarMenuSubItemAddItem);
                i7++;
                str6 = str4;
                currentQualityIndex = i5;
                str7 = str5;
                i6 = -1;
            }
            i = currentQualityIndex;
            ActionBarPopupWindow.GapView gapView = new ActionBarPopupWindow.GapView(this.activityContext, this.resourcesProvider, Theme.key_actionBarDefaultSubmenuSeparator);
            gapView.setTag(R.id.fit_width_tag, 1);
            gapView.setColor(-15198184);
            this.videoQualityLayout.addView(gapView, LayoutHelper.createLinear(-1, 8));
        } else {
            i = currentQualityIndex;
            String str11 = "\n";
            final int i9 = -1;
            while (i9 < this.videoPlayer.getQualitiesCount()) {
                int i10 = i9 + 1;
                ActionBarMenuSubItem actionBarMenuSubItem = (ActionBarMenuSubItem) this.videoQualityItems.get(i10);
                SpannableStringBuilder spannableStringBuilder2 = new SpannableStringBuilder();
                if (i9 == -1) {
                    spannableStringBuilder2.append((CharSequence) LocaleController.getString(R.string.QualityAuto));
                    if (i9 != this.videoPlayer.getSelectedQuality() || currentQuality == null) {
                        i2 = i10;
                        str = str8;
                        quality = null;
                    } else {
                        spannableStringBuilder2.append((CharSequence) " ");
                        int length3 = spannableStringBuilder2.length();
                        if (SharedConfig.debugVideoQualities) {
                            spannableStringBuilder2.append((CharSequence) Integer.toString(currentQuality.width)).append((CharSequence) str8).append((CharSequence) Integer.toString(currentQuality.height));
                        } else {
                            spannableStringBuilder2.append((CharSequence) String.valueOf(currentQuality.p())).append((CharSequence) "p");
                        }
                        i2 = i10;
                        spannableStringBuilder2.setSpan(new ForegroundColorSpan(Theme.multAlpha(-1, 0.5f)), length3, spannableStringBuilder2.length(), 33);
                        quality = currentQuality;
                        str = str8;
                    }
                } else {
                    i2 = i10;
                    quality = this.videoPlayer.getQuality(i9);
                    if (quality.original) {
                        i3 = R.string.QualityOriginal;
                    } else if (quality.p() >= 2000) {
                        i3 = R.string.Quality2160;
                    } else if (quality.p() >= 1400) {
                        i3 = R.string.Quality1440;
                    } else if (quality.p() >= 1000) {
                        i3 = R.string.Quality1080;
                    } else if (quality.p() >= 700) {
                        i3 = R.string.Quality720;
                    } else if (quality.p() >= 400) {
                        i3 = R.string.Quality480;
                        spannableStringBuilder2.append((CharSequence) LocaleController.getString(i3));
                        spannableStringBuilder2.append((CharSequence) " ");
                        int length4 = spannableStringBuilder2.length();
                        if (SharedConfig.debugVideoQualities) {
                            spannableStringBuilder2.append((CharSequence) Integer.toString(quality.width)).append((CharSequence) str8).append((CharSequence) Integer.toString(quality.height));
                        } else {
                            spannableStringBuilder2.append((CharSequence) String.valueOf(quality.p())).append((CharSequence) "p");
                        }
                        str = str8;
                        spannableStringBuilder2.setSpan(new ForegroundColorSpan(Theme.multAlpha(-1, 0.5f)), length4, spannableStringBuilder2.length(), 33);
                    } else {
                        i3 = quality.p() >= 340 ? R.string.Quality360 : quality.p() >= 200 ? R.string.Quality240 : R.string.Quality144;
                        spannableStringBuilder2.append((CharSequence) LocaleController.getString(i3));
                        spannableStringBuilder2.append((CharSequence) " ");
                        int length42 = spannableStringBuilder2.length();
                        if (SharedConfig.debugVideoQualities) {
                        }
                        str = str8;
                        spannableStringBuilder2.setSpan(new ForegroundColorSpan(Theme.multAlpha(-1, 0.5f)), length42, spannableStringBuilder2.length(), 33);
                    }
                    spannableStringBuilder2.append((CharSequence) LocaleController.getString(i3));
                    spannableStringBuilder2.append((CharSequence) " ");
                    int length422 = spannableStringBuilder2.length();
                    if (SharedConfig.debugVideoQualities) {
                    }
                    str = str8;
                    spannableStringBuilder2.setSpan(new ForegroundColorSpan(Theme.multAlpha(-1, 0.5f)), length422, spannableStringBuilder2.length(), 33);
                }
                actionBarMenuSubItem.setText(spannableStringBuilder2);
                actionBarMenuSubItem.setVisibility(0);
                if (!SharedConfig.debugVideoQualities || quality == null) {
                    str2 = str11;
                    actionBarMenuSubItem.setSubtext("");
                } else {
                    StringBuilder sb3 = new StringBuilder();
                    Iterator it2 = quality.uris.iterator();
                    while (it2.hasNext()) {
                        VideoPlayer.VideoUri videoUri2 = (VideoPlayer.VideoUri) it2.next();
                        if (sb3.length() > 0) {
                            str3 = str11;
                            sb3.append(str3);
                        } else {
                            str3 = str11;
                        }
                        if (!TextUtils.isEmpty(videoUri2.codec)) {
                            sb3.append(videoUri2.codec);
                            sb3.append(", ");
                        }
                        sb3.append(AndroidUtilities.formatFileSize(videoUri2.size).replace(" ", ""));
                        sb3.append(" (");
                        sb3.append(AndroidUtilities.formatFileSize((long) videoUri2.bitrate).replace(" ", "") + "/s)");
                        sb3.append(videoUri2.isManifestCached() ? "!" : " ");
                        sb3.append(videoUri2.isCached() ? "!" : " ");
                        str11 = str3;
                    }
                    str2 = str11;
                    actionBarMenuSubItem.setSubtext(sb3.toString());
                }
                actionBarMenuSubItem.setChecked(i9 == this.videoPlayer.getSelectedQuality());
                actionBarMenuSubItem.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda79
                    @Override // android.view.View.OnClickListener
                    public final void onClick(View view) throws NumberFormatException {
                        this.f$0.lambda$updateQualityItems$80(i9, view);
                    }
                });
                str11 = str2;
                i9 = i2;
                str8 = str;
            }
        }
        if (currentQuality != null) {
            if (currentQuality.p() >= 2000) {
                i4 = R.string.Quality2160Short;
            } else if (currentQuality.p() >= 1000) {
                i4 = R.string.Quality1080Short;
            } else if (currentQuality.p() >= 700) {
                i4 = R.string.Quality720Short;
            } else {
                string = currentQuality.p() + "p";
            }
            string = LocaleController.getString(i4);
        }
        this.videoItemIcon.bottomText.setText(string, true);
        VideoSeekPreviewImage videoSeekPreviewImage = this.videoPreviewFrame;
        if (videoSeekPreviewImage != null && (messageObject = this.currentMessageObject) != null && (videoPlayer = this.videoPlayer) != null) {
            videoSeekPreviewImage.open(messageObject, videoPlayer);
        }
        if (this.lastQualityIndexSelected != i) {
            try {
                CastSync.check(0);
                if (ChromecastController.getInstance().isCasting()) {
                    ChromecastController.getInstance().setCurrentMediaAndCastIfNeeded(getCurrentChromecastMedia());
                }
                VideoPlayer videoPlayer3 = this.videoPlayer;
                if (videoPlayer3 != null) {
                    CastSync.setPlaying(videoPlayer3.isPlaying());
                }
            } catch (Exception e) {
                FileLog.e(e);
            }
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void updateResetButtonVisibility(final boolean z) {
        if (this.resetButton.isClickable() != z) {
            this.resetButton.setClickable(z);
            this.resetButton.setVisibility(0);
            this.resetButton.clearAnimation();
            this.resetButton.animate().alpha(z ? 1.0f : BitmapDescriptorFactory.HUE_RED).setInterpolator(CubicBezierInterpolator.DEFAULT).setDuration(150L).withEndAction(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda70
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$updateResetButtonVisibility$94(z);
                }
            });
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void updateSelectedCount() {
        MessageObject messageObject;
        PhotoViewerProvider photoViewerProvider = this.placeProvider;
        if (photoViewerProvider == null) {
            return;
        }
        int selectedCount = photoViewerProvider.getSelectedCount();
        this.photosCounterView.setCount(selectedCount);
        if (selectedCount == 0) {
            togglePhotosListView(false, true);
        }
        if (this.pickerViewSendButton != null) {
            PhotoViewerProvider photoViewerProvider2 = this.placeProvider;
            long dialogId = photoViewerProvider2 != null ? photoViewerProvider2.getDialogId() : 0L;
            if (dialogId == 0 && (messageObject = this.currentMessageObject) != null) {
                dialogId = messageObject.getDialogId();
            }
            ChatActivityEnterView.SendButton sendButton = this.pickerViewSendButton;
            PhotoViewerProvider photoViewerProvider3 = this.placeProvider;
            long sendPaidMessagesStars = (photoViewerProvider3 == null || !photoViewerProvider3.isEditingMessage() || this.placeProvider.isEditingMessageResend()) ? MessagesController.getInstance(this.currentAccount).getSendPaidMessagesStars(dialogId) : 0L;
            PhotoViewerProvider photoViewerProvider4 = this.placeProvider;
            sendButton.setStarsPrice(sendPaidMessagesStars, Math.max(1, photoViewerProvider4 == null ? 1 : photoViewerProvider4.getSelectedCount()));
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void updateVideoInfo() {
        int i;
        if (this.actionBar == null) {
            return;
        }
        if (this.compressionsCount == 0) {
            this.actionBarContainer.setSubtitle(null);
            return;
        }
        this.compressItem.setState(this.videoConvertSupported && this.compressionsCount > 1, this.muteVideo, Math.min(this.resultWidth, this.resultHeight));
        this.itemsLayout.requestLayout();
        this.estimatedDuration = (long) Math.ceil((this.videoTimelineView.getRightProgress() - this.videoTimelineView.getLeftProgress()) * this.videoDuration);
        this.videoCutStart = this.videoTimelineView.getLeftProgress();
        this.videoCutEnd = this.videoTimelineView.getRightProgress();
        int i2 = this.rotationValue;
        int i3 = (i2 == 90 || i2 == 270) ? this.resultHeight : this.resultWidth;
        int i4 = this.rotationValue;
        int i5 = (i4 == 90 || i4 == 270) ? this.resultWidth : this.resultHeight;
        boolean zNeedEncoding = needEncoding();
        if (this.muteVideo) {
            if (this.sendPhotoType == 1) {
                long j = this.estimatedDuration;
                i = j <= 2000 ? 2600000 : j <= 5000 ? 2200000 : 1560000;
            } else {
                i = 921600;
            }
            long j2 = (long) ((i / 8) * (this.estimatedDuration / 1000.0f));
            this.estimatedSize = j2 + ((j2 / 32768) * 16);
        } else {
            calculateEstimatedVideoSize(zNeedEncoding, this.sendPhotoType == 1);
        }
        float f = this.videoCutStart;
        if (f == BitmapDescriptorFactory.HUE_RED) {
            this.startTime = -1L;
        } else {
            this.startTime = ((long) (f * this.videoDuration)) * 1000;
        }
        float f2 = this.videoCutEnd;
        if (f2 == 1.0f) {
            this.endTime = -1L;
        } else {
            this.endTime = ((long) (f2 * this.videoDuration)) * 1000;
        }
        this.currentSubtitle = String.format("%s, %s", String.format("%dx%d", Integer.valueOf(i3), Integer.valueOf(i5)), String.format("%s, ~%s", AndroidUtilities.formatShortDuration((int) (this.estimatedDuration / 1000)), AndroidUtilities.formatFileSize(this.estimatedSize)));
        this.actionBar.beginDelayedTransition();
        if (this.customTitle == null) {
            this.actionBarContainer.setSubtitle(this.muteVideo ? LocaleController.getString("SoundMuted", R.string.SoundMuted) : this.currentSubtitle);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void updateVideoPlayerTime() {
        Arrays.fill(this.videoPlayerCurrentTime, 0);
        Arrays.fill(this.videoPlayerTotalTime, 0);
        VideoPlayer videoPlayer = this.videoPlayer;
        if (videoPlayer != null) {
            long jMax = Math.max(0L, videoPlayer.getCurrentPosition());
            if (this.shownControlsByEnd && !this.actionBarWasShownBeforeByEnd) {
                jMax = 0;
            }
            long jMax2 = Math.max(0L, this.videoPlayer.getDuration());
            if (!this.inPreview && this.videoTimelineViewContainer.getVisibility() == 0) {
                jMax2 = (long) (jMax2 * (this.videoTimelineView.getRightProgress() - this.videoTimelineView.getLeftProgress()));
                jMax = (long) (jMax - (this.videoTimelineView.getLeftProgress() * jMax2));
                if (jMax > jMax2) {
                    jMax = jMax2;
                }
            }
            long j = jMax / 1000;
            long j2 = jMax2 / 1000;
            int[] iArr = this.videoPlayerCurrentTime;
            iArr[0] = (int) (j / 60);
            iArr[1] = (int) (j % 60);
            int[] iArr2 = this.videoPlayerTotalTime;
            iArr2[0] = (int) (j2 / 60);
            iArr2[1] = (int) (j2 % 60);
        } else {
            PhotoViewerWebView photoViewerWebView = this.photoViewerWebView;
            if (photoViewerWebView != null && photoViewerWebView.isControllable()) {
                long jMax3 = (!this.shownControlsByEnd || this.actionBarWasShownBeforeByEnd) ? Math.max(0, this.photoViewerWebView.getCurrentPosition()) : 0L;
                long jMax4 = Math.max(0, this.photoViewerWebView.getVideoDuration());
                if (!this.inPreview && this.videoTimelineViewContainer.getVisibility() == 0) {
                    jMax4 = (long) (jMax4 * (this.videoTimelineView.getRightProgress() - this.videoTimelineView.getLeftProgress()));
                    jMax3 = (long) (jMax3 - (this.videoTimelineView.getLeftProgress() * jMax4));
                    if (jMax3 > jMax4) {
                        jMax3 = jMax4;
                    }
                }
                long j3 = jMax3 / 1000;
                long j4 = jMax4 / 1000;
                int[] iArr3 = this.videoPlayerCurrentTime;
                iArr3[0] = (int) (j3 / 60);
                iArr3[1] = (int) (j3 % 60);
                int[] iArr4 = this.videoPlayerTotalTime;
                iArr4[0] = (int) (j4 / 60);
                iArr4[1] = (int) (j4 % 60);
            }
        }
        int[] iArr5 = this.videoPlayerCurrentTime;
        int i = iArr5[0];
        String str = i >= 60 ? format(i / 60, i % 60, iArr5[1]) : format(i, iArr5[1]);
        int[] iArr6 = this.videoPlayerTotalTime;
        int i2 = iArr6[0];
        String str2 = i2 >= 60 ? format(i2 / 60, i2 % 60, iArr6[1]) : format(i2, iArr6[1]);
        this.videoPlayerTime.setText(str + " / " + str2);
        if (Objects.equals(this.lastControlFrameDuration, str2)) {
            return;
        }
        this.lastControlFrameDuration = str2;
        this.videoPlayerControlFrameLayout.requestLayout();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void updateVideoSeekPreviewPosition() {
        int thumbX = (this.videoPlayerSeekbar.getThumbX() + AndroidUtilities.dp(2.0f)) - (this.videoPreviewFrame.getMeasuredWidth() / 2);
        int iDp = AndroidUtilities.dp(10.0f);
        int measuredWidth = (this.videoPlayerControlFrameLayout.getMeasuredWidth() - AndroidUtilities.dp(10.0f)) - (this.videoPreviewFrame.getMeasuredWidth() / 2);
        if (thumbX < iDp) {
            this.videoPreviewFrame.setPivotX(Utilities.clamp((r4.getMeasuredWidth() / 2.0f) - (iDp - thumbX), this.videoPreviewFrame.getMeasuredWidth(), BitmapDescriptorFactory.HUE_RED));
            thumbX = iDp;
        } else if (thumbX >= measuredWidth) {
            this.videoPreviewFrame.setPivotX(Utilities.clamp((r3.getMeasuredWidth() / 2.0f) + (thumbX - measuredWidth), this.videoPreviewFrame.getMeasuredWidth(), BitmapDescriptorFactory.HUE_RED));
            thumbX = measuredWidth;
        } else {
            this.videoPreviewFrame.setPivotX(r2.getMeasuredWidth() / 2.0f);
        }
        this.videoPreviewFrame.setTranslationX(thumbX);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void updateWidthHeightBitrateForCompression() {
        int height;
        int iExtractRealEncoderBitrate;
        if (this.compressionsCount <= 0) {
            return;
        }
        if (this.selectedCompression >= this.compressionsCount) {
            this.selectedCompression = this.compressionsCount - 1;
        }
        if (this.sendPhotoType == 1) {
            float fMax = Math.max(800.0f / this.originalWidth, 800.0f / this.originalHeight);
            this.resultWidth = Math.round((this.originalWidth * fMax) / 2.0f) * 2;
            height = Math.round((this.originalHeight * fMax) / 2.0f) * 2;
        } else {
            Size sizeCalculateResultVideoSize = calculateResultVideoSize();
            this.resultWidth = sizeCalculateResultVideoSize.getWidth();
            height = sizeCalculateResultVideoSize.getHeight();
        }
        this.resultHeight = height;
        if (this.bitrate != 0) {
            if (this.sendPhotoType == 1) {
                this.bitrate = 1560000;
                iExtractRealEncoderBitrate = this.bitrate;
            } else {
                this.bitrate = (this.resultWidth == this.originalWidth && this.resultHeight == this.originalHeight) ? this.originalBitrate : MediaController.makeVideoBitrate(this.originalHeight, this.originalWidth, this.originalBitrate, this.resultHeight, this.resultWidth);
                iExtractRealEncoderBitrate = MediaController.extractRealEncoderBitrate(this.resultWidth, this.resultHeight, this.bitrate, false);
            }
            this.videoFramesSize = (long) (((iExtractRealEncoderBitrate / 8) * this.videoDuration) / 1000.0f);
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public boolean useFullWidthSendButton() {
        ImageUpdater.AvatarFor avatarFor = this.setAvatarFor;
        return (avatarFor == null || !avatarFor.self || avatarFor.isVideo) ? false : true;
    }

    public boolean BLUR_RENDERNODE() {
        return !this.textureViewSkipRender && Build.VERSION.SDK_INT >= 31 && SharedConfig.useNewBlur && SharedConfig.getDevicePerformanceClass() >= 2 && !AndroidUtilities.makingGlobalBlurBitmap;
    }

    public void addPhoto(MessageObject messageObject, int i) throws Resources.NotFoundException {
        if (i != this.classGuid) {
            return;
        }
        if (this.imagesByIds[0].indexOfKey(messageObject.getId()) < 0) {
            if (this.opennedFromMedia) {
                this.imagesArr.add(messageObject);
            } else {
                this.imagesArr.add(0, messageObject);
            }
            this.imagesByIds[0].put(messageObject.getId(), messageObject);
        }
        this.endReached[0] = this.imagesArr.size() == this.totalImagesCount;
        setImages();
    }

    @Override // org.telegram.ui.Components.GestureDetector2.OnDoubleTapListener
    public boolean canDoubleTap(MotionEvent motionEvent) {
        MessageObject messageObject;
        PhotoViewerWebView photoViewerWebView;
        if (this.checkImageView.getVisibility() == 0) {
            return true;
        }
        boolean[] zArr = this.drawPressedDrawable;
        if (zArr[0] || zArr[1]) {
            return true;
        }
        float x = motionEvent.getX();
        if ((x < Math.min(135, this.containerView.getMeasuredWidth() / 8) || x > this.containerView.getMeasuredWidth() - r3) && (messageObject = this.currentMessageObject) != null) {
            return (messageObject.isVideo() || ((photoViewerWebView = this.photoViewerWebView) != null && photoViewerWebView.isControllable())) && SystemClock.elapsedRealtime() - this.lastPhotoSetTime >= 500 && canDoubleTapSeekVideo(motionEvent);
        }
        return true;
    }

    public void checkCurrentImageVisibility() {
        PlaceProviderObject placeProviderObject = this.currentPlaceObject;
        if (placeProviderObject != null) {
            placeProviderObject.imageReceiver.setVisible(true, true);
        }
        PhotoViewerProvider photoViewerProvider = this.placeProvider;
        PlaceProviderObject placeForPhoto = photoViewerProvider == null ? null : photoViewerProvider.getPlaceForPhoto(this.currentMessageObject, getFileLocation(this.currentFileLocation), this.currentIndex, false, false);
        this.currentPlaceObject = placeForPhoto;
        if (placeForPhoto != null) {
            placeForPhoto.imageReceiver.setVisible(false, true);
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:80:0x014a  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void checkFullscreenButton() {
        MessageObject messageObject;
        ImageView imageView;
        TextureView textureView;
        TextureView textureView2;
        float f;
        float fDp;
        MessageObject messageObject2;
        if (this.imagesArr.isEmpty() || ((messageObject = this.currentMessageObject) != null && messageObject.isSponsored())) {
            for (int i = 0; i < 3; i++) {
                this.fullscreenButton[i].setVisibility(4);
            }
            return;
        }
        int i2 = 0;
        while (i2 < 3) {
            int i3 = this.currentIndex;
            if (i2 == 1) {
                i3++;
            } else if (i2 == 2) {
                i3--;
            }
            if (i3 < 0 || i3 >= this.imagesArr.size()) {
                imageView = this.fullscreenButton[i2];
            } else {
                MessageObject messageObject3 = (MessageObject) this.imagesArr.get(i3);
                if (messageObject3.isVideo() || messageObject3.isYouTubeVideo()) {
                    boolean z = messageObject3.isYouTubeVideo() && (messageObject2 = this.currentMessageObject) != null && messageObject2.getId() == messageObject3.getId();
                    int measuredWidth = z ? messageObject3.messageOwner.media.webpage.embed_width : (i2 != 0 || (textureView = this.videoTextureView) == null) ? 0 : textureView.getMeasuredWidth();
                    int measuredHeight = z ? messageObject3.messageOwner.media.webpage.embed_height : (i2 != 0 || (textureView2 = this.videoTextureView) == null) ? 0 : textureView2.getMeasuredHeight();
                    TLRPC.Document document = messageObject3.getDocument();
                    if (document != null) {
                        int size = document.attributes.size();
                        int i4 = 0;
                        while (true) {
                            if (i4 >= size) {
                                break;
                            }
                            TLRPC.DocumentAttribute documentAttribute = document.attributes.get(i4);
                            if (documentAttribute instanceof TLRPC.TL_documentAttributeVideo) {
                                measuredWidth = documentAttribute.w;
                                measuredHeight = documentAttribute.h;
                                break;
                            }
                            i4++;
                        }
                    }
                    Point point = AndroidUtilities.displaySize;
                    if (point.y > point.x && measuredWidth > measuredHeight) {
                        if (this.fullscreenButton[i2].getVisibility() != 0) {
                            this.fullscreenButton[i2].setVisibility(0);
                        }
                        if (this.isActionBarVisible) {
                            this.fullscreenButton[i2].setAlpha(1.0f);
                        }
                        ((FrameLayout.LayoutParams) this.fullscreenButton[i2].getLayoutParams()).topMargin = ((this.containerView.getMeasuredHeight() + ((int) (measuredHeight / (measuredWidth / this.containerView.getMeasuredWidth())))) / 2) - AndroidUtilities.dp(48.0f);
                    } else if (this.fullscreenButton[i2].getVisibility() != 4) {
                        this.fullscreenButton[i2].setVisibility(4);
                    }
                    if (this.imageMoveAnimation != null) {
                        float f2 = this.translationX;
                        f = f2 + ((this.animateToX - f2) * this.animationValue);
                    } else {
                        f = this.translationX;
                    }
                    if (i2 != 1) {
                        if (i2 == 2) {
                            fDp = ((-AndroidUtilities.displaySize.x) - AndroidUtilities.dp(15.0f)) + (f - this.maxX);
                        } else {
                            float f3 = this.minX;
                            fDp = f < f3 ? f - f3 : BitmapDescriptorFactory.HUE_RED;
                        }
                        this.fullscreenButton[i2].setTranslationX((fDp + AndroidUtilities.displaySize.x) - AndroidUtilities.dp(48.0f));
                    }
                    i2++;
                } else {
                    imageView = this.fullscreenButton[i2];
                }
            }
            imageView.setVisibility(4);
            i2++;
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:108:0x01da  */
    /* JADX WARN: Removed duplicated region for block: B:111:0x01e7  */
    /* JADX WARN: Removed duplicated region for block: B:112:0x01e9  */
    /* JADX WARN: Removed duplicated region for block: B:136:0x0272  */
    /* JADX WARN: Removed duplicated region for block: B:142:0x029a  */
    /* JADX WARN: Removed duplicated region for block: B:145:0x02af  */
    /* JADX WARN: Removed duplicated region for block: B:153:0x02d9  */
    /* JADX WARN: Removed duplicated region for block: B:156:0x02e2  */
    /* JADX WARN: Removed duplicated region for block: B:159:0x02fe  */
    /* JADX WARN: Removed duplicated region for block: B:286:0x0763  */
    /* JADX WARN: Removed duplicated region for block: B:300:0x0278 A[EXC_TOP_SPLITTER, SYNTHETIC] */
    /* JADX WARN: Type inference failed for: r11v0 */
    /* JADX WARN: Type inference failed for: r11v1, types: [android.view.VelocityTracker, org.telegram.ui.ChatActivity, org.telegram.ui.Components.PhotoViewerWebView] */
    /* JADX WARN: Type inference failed for: r11v41 */
    /* JADX WARN: Type inference failed for: r12v1 */
    /* JADX WARN: Type inference failed for: r12v3 */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void closePhoto(boolean z, boolean z2) {
        float scaleX;
        float f;
        float f2;
        float f3;
        PhotoViewerProvider photoViewerProvider;
        boolean[] zArr;
        PlaceProviderObject placeForPhoto;
        float f4;
        boolean[] zArr2;
        final PlaceProviderObject placeProviderObject;
        ?? r11;
        float f5;
        int i;
        int i2;
        char c;
        char c2;
        PhotoViewerWebView photoViewerWebView;
        ChatActivity chatActivity;
        VelocityTracker velocityTracker;
        Runnable runnable;
        AnimatedFileDrawable animatedFileDrawable;
        PhotoViewerProvider photoViewerProvider2;
        RectF drawRegion;
        float fMin;
        float[][] fArr;
        BaseFragment baseFragment;
        final AnimatedFileDrawable animation;
        TLRPC.Document currentDocument;
        TLRPC.Document document;
        Bitmap animatedBitmap;
        int i3;
        int i4;
        StickerMakerView stickerMakerView = this.stickerMakerView;
        if (stickerMakerView != null) {
            stickerMakerView.isThanosInProgress = false;
            if (this.cutOutBtn.isCancelState()) {
                this.cutOutBtn.setCutOutState(true);
                showEditStickerMode(false, true);
                this.stickerMakerView.disableClippingMode();
                this.containerView.invalidate();
            }
        }
        if (!z2 && (i4 = this.currentEditMode) != 0) {
            if (i4 == 3 && this.photoPaintView != null) {
                closePaintMode();
                return;
            }
            if (i4 == 1) {
                this.cropTransform.setViewTransform(this.previousHasTransform, this.previousCropPx, this.previousCropPy, this.previousCropRotation, this.previousCropOrientation, this.previousCropScale, 1.0f, 1.0f, this.previousCropPw, this.previousCropPh, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, this.previousCropMirrored);
            }
            if (this.currentEditMode == 4) {
                applyCurrentEditMode();
            }
            switchToEditMode(0);
            return;
        }
        QualityChooseView qualityChooseView = this.qualityChooseView;
        if (qualityChooseView != null && qualityChooseView.getTag() != null) {
            this.qualityPicker.cancelButton.callOnClick();
            return;
        }
        this.isVisibleOrAnimating = false;
        this.openedFullScreenVideo = false;
        try {
            AlertDialog alertDialog = this.visibleDialog;
            if (alertDialog != null) {
                alertDialog.dismiss();
                this.visibleDialog = null;
            }
        } catch (Exception e) {
            FileLog.e(e);
        }
        if (Build.VERSION.SDK_INT >= 21 && this.containerView != null) {
            AndroidUtilities.cancelRunOnUIThread(this.updateContainerFlagsRunnable);
            updateContainerFlags(true);
        }
        int i5 = this.currentEditMode;
        if (i5 != 0) {
            if (i5 == 2) {
                this.photoFilterView.shutdown();
                this.containerView.removeView(this.photoFilterView);
                this.photoFilterView = null;
            } else if (i5 == 1) {
                this.editorDoneLayout.setVisibility(8);
                this.photoCropView.setVisibility(8);
            } else if (i5 == 3) {
                this.photoPaintView.shutdown();
                this.containerView.removeView(this.photoPaintView.getView());
                this.photoPaintView = null;
                this.savedState = null;
            } else if (i5 == 4) {
                this.maskPaintViewShuttingDown = true;
                FrameLayoutDrawer frameLayoutDrawer = this.containerView;
                if (frameLayoutDrawer != null) {
                    frameLayoutDrawer.invalidate();
                    final MaskPaintView maskPaintView = this.maskPaintView;
                    this.containerView.post(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda7
                        @Override // java.lang.Runnable
                        public final void run() {
                            this.f$0.lambda$closePhoto$131(maskPaintView);
                        }
                    });
                } else {
                    this.maskPaintView.shutdown();
                }
                this.maskPaintView = null;
            }
            this.currentEditMode = 0;
            getCaptionView().keyboardNotifier.ignore(false);
            KeyboardNotifier keyboardNotifier = this.paintKeyboardNotifier;
            if (keyboardNotifier != null) {
                keyboardNotifier.ignore(this.currentEditMode != 3);
            }
        }
        View view = this.navigationBar;
        if (view != null) {
            view.setVisibility(0);
        }
        FrameLayout frameLayout = this.windowView;
        if (frameLayout != null) {
            frameLayout.setClipChildren(false);
        }
        if (this.parentActivity != null) {
            if ((!this.isInline && !this.isVisible) || checkAnimation() || this.placeProvider == null) {
                return;
            }
            Activity activity = this.parentActivity;
            if (activity != null && this.fullscreenedByButton != 0) {
                activity.setRequestedOrientation(this.prevOrientation);
                this.fullscreenedByButton = 0;
                this.wasRotated = false;
            }
            if (!this.doneButtonPressed && !this.imagesArrLocals.isEmpty() && (i3 = this.currentIndex) >= 0 && i3 < this.imagesArrLocals.size()) {
                Object obj = this.imagesArrLocals.get(this.currentIndex);
                if (obj instanceof MediaController.MediaEditState) {
                    MediaController.MediaEditState mediaEditState = (MediaController.MediaEditState) obj;
                    mediaEditState.editedInfo = getCurrentVideoEditedInfo();
                    if (this.sendPhotoType == 11) {
                        mediaEditState.reset();
                    }
                }
            }
            BaseFragment baseFragment2 = this.parentFragment;
            if (baseFragment2 == null || baseFragment2.getFragmentView() == null) {
                scaleX = 1.0f;
                f = 1.0f;
            } else {
                View fragmentView = this.parentFragment.getFragmentView();
                scaleX = fragmentView.getScaleX();
                float scaleY = fragmentView.getScaleY();
                fragmentView.setScaleX(1.0f);
                fragmentView.setScaleY(1.0f);
                ChatAttachAlert chatAttachAlert = this.parentAlert;
                if (chatAttachAlert != null) {
                    BottomSheet.ContainerView container = chatAttachAlert.getContainer();
                    float scaleX2 = container.getScaleX();
                    float scaleY2 = container.getScaleY();
                    container.setScaleX(1.0f);
                    container.setScaleY(1.0f);
                    f = scaleY;
                    f2 = scaleX2;
                    f3 = scaleY2;
                    photoViewerProvider = this.placeProvider;
                    if (photoViewerProvider != null) {
                        photoViewerProvider.onReleasePlayerBeforeClose(this.currentIndex);
                    }
                    zArr = new boolean[]{true};
                    PhotoViewerProvider photoViewerProvider3 = this.placeProvider;
                    placeForPhoto = photoViewerProvider3 != null ? null : photoViewerProvider3.getPlaceForPhoto(this.currentMessageObject, getFileLocation(this.currentFileLocation), this.currentIndex, true, true);
                    if (this.videoPlayer != null || placeForPhoto == null || (animation = placeForPhoto.imageReceiver.getAnimation()) == null) {
                        f4 = scaleX;
                        zArr2 = zArr;
                        placeProviderObject = placeForPhoto;
                        r11 = 0;
                        f5 = 1.0f;
                        i = 0;
                        i2 = 21;
                        c = 11;
                        c2 = '\b';
                    } else {
                        long startTime = animation.getStartTime();
                        long currentPosition = this.videoPlayer.getCurrentPosition();
                        if (startTime <= 0) {
                            startTime = 0;
                        }
                        final long j = currentPosition + startTime;
                        if (this.videoPlayer.getCurrentDocument() == null) {
                            MessageObject messageObject = this.currentMessageObject;
                            if (messageObject != null) {
                                currentDocument = messageObject.getDocument();
                            } else {
                                document = null;
                                zArr2 = zArr;
                                f5 = 1.0f;
                                f4 = scaleX;
                                c = 11;
                                placeProviderObject = placeForPhoto;
                                c2 = '\b';
                                final TLRPC.Document document2 = document;
                                r11 = 0;
                                i2 = 21;
                                i = 0;
                                Runnable runnable2 = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda8
                                    @Override // java.lang.Runnable
                                    public final void run() {
                                        this.f$0.lambda$closePhoto$132(animation, document2, j, placeProviderObject);
                                    }
                                };
                                if (this.textureUploaded && (animatedBitmap = animation.getAnimatedBitmap()) != null) {
                                    if (this.usedSurfaceView) {
                                        try {
                                            Bitmap bitmap = this.videoTextureView.getBitmap(animatedBitmap.getWidth(), animatedBitmap.getHeight());
                                            new Canvas(animatedBitmap).drawBitmap(bitmap, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, (Paint) null);
                                            bitmap.recycle();
                                        } catch (Throwable th) {
                                            FileLog.e(th);
                                        }
                                    } else {
                                        AndroidUtilities.getBitmapFromSurface(this.videoSurfaceView, animatedBitmap);
                                    }
                                }
                                runnable2.run();
                            }
                        } else {
                            currentDocument = this.videoPlayer.getCurrentDocument();
                        }
                        document = currentDocument;
                        zArr2 = zArr;
                        f5 = 1.0f;
                        f4 = scaleX;
                        c = 11;
                        placeProviderObject = placeForPhoto;
                        c2 = '\b';
                        final TLRPC.Document document22 = document;
                        r11 = 0;
                        i2 = 21;
                        i = 0;
                        Runnable runnable22 = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda8
                            @Override // java.lang.Runnable
                            public final void run() {
                                this.f$0.lambda$closePhoto$132(animation, document22, j, placeProviderObject);
                            }
                        };
                        if (this.textureUploaded) {
                            if (this.usedSurfaceView) {
                            }
                        }
                        runnable22.run();
                    }
                    photoViewerWebView = this.photoViewerWebView;
                    if (photoViewerWebView != null) {
                        photoViewerWebView.release();
                        this.containerView.removeView(this.photoViewerWebView);
                        this.photoViewerWebView = r11;
                    }
                    chatActivity = this.parentChatActivity;
                    if (chatActivity != null && chatActivity.getFragmentView() != null) {
                        this.parentChatActivity.getFragmentView().invalidate();
                    }
                    this.parentChatActivity = r11;
                    removeObservers();
                    this.isActionBarVisible = i;
                    velocityTracker = this.velocityTracker;
                    if (velocityTracker != null) {
                        velocityTracker.recycle();
                        this.velocityTracker = r11;
                    }
                    if (this.isInline) {
                        final PlaceProviderObject placeProviderObject2 = placeProviderObject;
                        if (z) {
                            ClippingImageView[] animatingImageViews = getAnimatingImageViews(placeProviderObject2);
                            for (int i6 = 0; i6 < animatingImageViews.length; i6++) {
                                animatingImageViews[i6].setAnimationValues(this.animationValues);
                                animatingImageViews[i6].setVisibility(i);
                            }
                            final AnimatorSet animatorSet = new AnimatorSet();
                            ViewGroup.LayoutParams layoutParams = this.animatingImageView.getLayoutParams();
                            if (placeProviderObject2 != null) {
                                drawRegion = placeProviderObject2.imageReceiver.getDrawRegion();
                                layoutParams.width = (int) drawRegion.width();
                                layoutParams.height = (int) drawRegion.height();
                                int orientation = placeProviderObject2.imageReceiver.getOrientation();
                                int animatedOrientation = placeProviderObject2.imageReceiver.getAnimatedOrientation();
                                if (animatedOrientation != 0) {
                                    orientation = animatedOrientation;
                                }
                                for (int i7 = 0; i7 < animatingImageViews.length; i7++) {
                                    animatingImageViews[i7].setOrientation(orientation, placeProviderObject2.imageReceiver.getInvert());
                                    animatingImageViews[i7].setImageBitmap(placeProviderObject2.thumb);
                                }
                            } else {
                                layoutParams.width = (int) this.centerImage.getImageWidth();
                                layoutParams.height = (int) this.centerImage.getImageHeight();
                                for (int i8 = 0; i8 < animatingImageViews.length; i8++) {
                                    animatingImageViews[i8].setOrientation(this.centerImage.getOrientation(), this.centerImage.getInvert());
                                    animatingImageViews[i8].setImageBitmap(this.centerImage.getBitmapSafe());
                                }
                                drawRegion = null;
                            }
                            if (layoutParams.width <= 0) {
                                layoutParams.width = 100;
                            }
                            if (layoutParams.height <= 0) {
                                layoutParams.height = 100;
                            }
                            if (this.sendPhotoType == 1) {
                                float fMin2 = Math.min(this.photoCropView.getMeasuredWidth(), (this.photoCropView.getMeasuredHeight() - AndroidUtilities.dp(64.0f)) - (isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0)) - (AndroidUtilities.dp(16.0f) * 2);
                                fMin = Math.max(fMin2 / layoutParams.width, fMin2 / layoutParams.height);
                            } else {
                                fMin = Math.min(this.windowView.getMeasuredWidth() / layoutParams.width, (AndroidUtilities.displaySize.y + (isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0)) / layoutParams.height);
                            }
                            float f6 = layoutParams.width;
                            float f7 = this.scale;
                            float f8 = layoutParams.height * f7 * fMin;
                            float measuredWidth = (this.windowView.getMeasuredWidth() - ((f6 * f7) * fMin)) / 2.0f;
                            float measuredHeight = ((this.sendPhotoType == 1 ? this.photoCropView.getMeasuredHeight() - (isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0) : AndroidUtilities.displaySize.y + (isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0)) - f8) / 2.0f;
                            for (int i9 = 0; i9 < animatingImageViews.length; i9++) {
                                animatingImageViews[i9].setLayoutParams(layoutParams);
                                animatingImageViews[i9].setTranslationX(this.translationX + measuredWidth);
                                animatingImageViews[i9].setTranslationY(this.translationY + measuredHeight);
                                animatingImageViews[i9].setScaleX(this.scale * fMin);
                                animatingImageViews[i9].setScaleY(this.scale * fMin);
                            }
                            if (placeProviderObject2 != null) {
                                int iAbs = (int) Math.abs(drawRegion.left - placeProviderObject2.imageReceiver.getImageX());
                                int iAbs2 = (int) Math.abs(drawRegion.top - placeProviderObject2.imageReceiver.getImageY());
                                if (placeProviderObject2.imageReceiver.isAspectFit()) {
                                    iAbs = 0;
                                }
                                int[] iArr = new int[2];
                                placeProviderObject2.parentView.getLocationInWindow(iArr);
                                int i10 = iArr[1];
                                int i11 = Build.VERSION.SDK_INT;
                                int i12 = i11 >= i2 ? 0 : AndroidUtilities.statusBarHeight;
                                float f9 = placeProviderObject2.viewY;
                                float f10 = drawRegion.top;
                                float f11 = f9 + f10;
                                int i13 = (int) (((i10 - i12) - f11) + placeProviderObject2.clipTopAddition);
                                if (i13 < 0) {
                                    i13 = 0;
                                }
                                int height = (int) (((f11 + (drawRegion.bottom - f10)) - ((i10 + placeProviderObject2.parentView.getHeight()) - (i11 >= i2 ? 0 : AndroidUtilities.statusBarHeight))) + placeProviderObject2.clipBottomAddition);
                                if (height < 0) {
                                    height = 0;
                                }
                                int iMax = Math.max(i13, iAbs2);
                                int iMax2 = Math.max(height, iAbs2);
                                this.animationValues[i][i] = this.animatingImageView.getScaleX();
                                this.animationValues[i][1] = this.animatingImageView.getScaleY();
                                this.animationValues[i][2] = this.animatingImageView.getTranslationX();
                                this.animationValues[i][3] = this.animatingImageView.getTranslationY();
                                float[][] fArr2 = this.animationValues;
                                float[] fArr3 = fArr2[i];
                                fArr3[4] = 0.0f;
                                fArr3[5] = 0.0f;
                                fArr3[6] = 0.0f;
                                fArr3[7] = 0.0f;
                                fArr3[c2] = 0.0f;
                                fArr3[9] = 0.0f;
                                fArr3[10] = 0.0f;
                                fArr3[c] = 0.0f;
                                fArr3[12] = 0.0f;
                                float[] fArr4 = fArr2[1];
                                float f12 = placeProviderObject2.scale;
                                fArr4[i] = f12;
                                fArr4[1] = f12;
                                fArr4[2] = placeProviderObject2.viewX + (drawRegion.left * f12);
                                fArr4[3] = placeProviderObject2.viewY + (drawRegion.top * f12);
                                float f13 = iAbs;
                                int i14 = 4;
                                fArr4[4] = f13 * f12;
                                fArr4[5] = iMax * f12;
                                fArr4[6] = iMax2 * f12;
                                int i15 = 0;
                                while (true) {
                                    fArr = this.animationValues;
                                    if (i15 >= i14) {
                                        break;
                                    }
                                    fArr[1][i15 + 7] = placeProviderObject2.radius != null ? r10[i15] : BitmapDescriptorFactory.HUE_RED;
                                    i15++;
                                    i14 = 4;
                                }
                                float[] fArr5 = fArr[1];
                                float f14 = placeProviderObject2.scale;
                                fArr5[c] = iAbs2 * f14;
                                fArr5[12] = f13 * f14;
                                ArrayList arrayList = new ArrayList((this.sendPhotoType == 1 ? 3 : 2) + animatingImageViews.length + (animatingImageViews.length > 1 ? 1 : 0));
                                for (int i16 = 0; i16 < animatingImageViews.length; i16++) {
                                    ObjectAnimator objectAnimatorOfFloat = ObjectAnimator.ofFloat(animatingImageViews[i16], (Property<ClippingImageView, Float>) AnimationProperties.CLIPPING_IMAGE_VIEW_PROGRESS, BitmapDescriptorFactory.HUE_RED, 1.0f);
                                    if (i16 == 0) {
                                        objectAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda9
                                            @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                                            public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                                                this.f$0.lambda$closePhoto$133(valueAnimator);
                                            }
                                        });
                                    }
                                    arrayList.add(objectAnimatorOfFloat);
                                }
                                if (animatingImageViews.length > 1) {
                                    ClippingImageView clippingImageView = this.animatingImageView;
                                    Property property = View.ALPHA;
                                    float[] fArr6 = new float[1];
                                    fArr6[i] = 0.0f;
                                    arrayList.add(ObjectAnimator.ofFloat(clippingImageView, (Property<ClippingImageView, Float>) property, fArr6));
                                    animatingImageViews[1].setAdditionalTranslationX(-getLeftInset());
                                }
                                arrayList.add(ObjectAnimator.ofInt(this.backgroundDrawable, (Property<BackgroundDrawable, Integer>) AnimationProperties.COLOR_DRAWABLE_ALPHA, i));
                                FrameLayoutDrawer frameLayoutDrawer2 = this.containerView;
                                Property property2 = View.ALPHA;
                                float[] fArr7 = new float[1];
                                fArr7[i] = 0.0f;
                                arrayList.add(ObjectAnimator.ofFloat(frameLayoutDrawer2, (Property<FrameLayoutDrawer, Float>) property2, fArr7));
                                View view2 = this.navigationBar;
                                float[] fArr8 = new float[1];
                                fArr8[i] = 0.0f;
                                arrayList.add(ObjectAnimator.ofFloat(view2, (Property<View, Float>) property2, fArr8));
                                if (this.sendPhotoType == 1) {
                                    PhotoCropView photoCropView = this.photoCropView;
                                    float[] fArr9 = new float[1];
                                    fArr9[i] = 0.0f;
                                    arrayList.add(ObjectAnimator.ofFloat(photoCropView, (Property<PhotoCropView, Float>) property2, fArr9));
                                }
                                animatorSet.playTogether(arrayList);
                            } else {
                                int i17 = AndroidUtilities.displaySize.y + (isStatusBarVisible() ? AndroidUtilities.statusBarHeight : 0);
                                ValueAnimator valueAnimatorOfFloat = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f);
                                valueAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda10
                                    @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                                    public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                                        this.f$0.lambda$closePhoto$134(valueAnimator);
                                    }
                                });
                                ObjectAnimator objectAnimatorOfInt = ObjectAnimator.ofInt(this.backgroundDrawable, (Property<BackgroundDrawable, Integer>) AnimationProperties.COLOR_DRAWABLE_ALPHA, i);
                                ClippingImageView clippingImageView2 = this.animatingImageView;
                                Property property3 = View.ALPHA;
                                float[] fArr10 = new float[1];
                                fArr10[i] = 0.0f;
                                ObjectAnimator objectAnimatorOfFloat2 = ObjectAnimator.ofFloat(clippingImageView2, (Property<ClippingImageView, Float>) property3, fArr10);
                                ClippingImageView clippingImageView3 = this.animatingImageView;
                                Property property4 = View.TRANSLATION_Y;
                                if (this.translationY < BitmapDescriptorFactory.HUE_RED) {
                                    i17 = -i17;
                                }
                                float[] fArr11 = new float[1];
                                fArr11[i] = i17;
                                ObjectAnimator objectAnimatorOfFloat3 = ObjectAnimator.ofFloat(clippingImageView3, (Property<ClippingImageView, Float>) property4, fArr11);
                                FrameLayoutDrawer frameLayoutDrawer3 = this.containerView;
                                float[] fArr12 = new float[1];
                                fArr12[i] = 0.0f;
                                ObjectAnimator objectAnimatorOfFloat4 = ObjectAnimator.ofFloat(frameLayoutDrawer3, (Property<FrameLayoutDrawer, Float>) property3, fArr12);
                                View view3 = this.navigationBar;
                                float[] fArr13 = new float[1];
                                fArr13[i] = 0.0f;
                                ObjectAnimator objectAnimatorOfFloat5 = ObjectAnimator.ofFloat(view3, (Property<View, Float>) property3, fArr13);
                                Animator[] animatorArr = new Animator[6];
                                animatorArr[i] = valueAnimatorOfFloat;
                                animatorArr[1] = objectAnimatorOfInt;
                                animatorArr[2] = objectAnimatorOfFloat2;
                                animatorArr[3] = objectAnimatorOfFloat3;
                                animatorArr[4] = objectAnimatorOfFloat4;
                                animatorArr[5] = objectAnimatorOfFloat5;
                                animatorSet.playTogether(animatorArr);
                            }
                            PhotoViewerProvider photoViewerProvider4 = this.placeProvider;
                            if (photoViewerProvider4 != null) {
                                photoViewerProvider4.onPreClose();
                            }
                            this.animationEndRunnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda11
                                @Override // java.lang.Runnable
                                public final void run() {
                                    this.f$0.lambda$closePhoto$135(placeProviderObject2);
                                }
                            };
                            animatorSet.setDuration(200L);
                            animatorSet.addListener(new AnonymousClass79());
                            runnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda12
                                @Override // java.lang.Runnable
                                public final void run() {
                                    this.f$0.lambda$closePhoto$136(placeProviderObject2, animatorSet);
                                }
                            };
                            if (zArr2[i]) {
                                runnable.run();
                            }
                            animatedFileDrawable = this.currentAnimation;
                            if (animatedFileDrawable != null) {
                                animatedFileDrawable.removeSecondParentView(this.containerView);
                                this.currentAnimation = null;
                                this.centerImage.setImageBitmap((Drawable) null);
                                this.centerBlur.destroy();
                            }
                            photoViewerProvider2 = this.placeProvider;
                            if (photoViewerProvider2 != null && !photoViewerProvider2.canScrollAway()) {
                                this.placeProvider.cancelButtonPressed();
                            }
                        } else {
                            final AnimatorSet animatorSet2 = new AnimatorSet();
                            ValueAnimator valueAnimatorOfFloat2 = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f);
                            valueAnimatorOfFloat2.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda13
                                @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                                public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                                    this.f$0.lambda$closePhoto$137(valueAnimator);
                                }
                            });
                            FrameLayoutDrawer frameLayoutDrawer4 = this.containerView;
                            Property property5 = View.SCALE_X;
                            float[] fArr14 = new float[1];
                            fArr14[i] = 0.9f;
                            ObjectAnimator objectAnimatorOfFloat6 = ObjectAnimator.ofFloat(frameLayoutDrawer4, (Property<FrameLayoutDrawer, Float>) property5, fArr14);
                            FrameLayoutDrawer frameLayoutDrawer5 = this.containerView;
                            Property property6 = View.SCALE_Y;
                            float[] fArr15 = new float[1];
                            fArr15[i] = 0.9f;
                            ObjectAnimator objectAnimatorOfFloat7 = ObjectAnimator.ofFloat(frameLayoutDrawer5, (Property<FrameLayoutDrawer, Float>) property6, fArr15);
                            ObjectAnimator objectAnimatorOfInt2 = ObjectAnimator.ofInt(this.backgroundDrawable, (Property<BackgroundDrawable, Integer>) AnimationProperties.COLOR_DRAWABLE_ALPHA, i);
                            FrameLayoutDrawer frameLayoutDrawer6 = this.containerView;
                            Property property7 = View.ALPHA;
                            float[] fArr16 = new float[1];
                            fArr16[i] = 0.0f;
                            ObjectAnimator objectAnimatorOfFloat8 = ObjectAnimator.ofFloat(frameLayoutDrawer6, (Property<FrameLayoutDrawer, Float>) property7, fArr16);
                            View view4 = this.navigationBar;
                            float[] fArr17 = new float[1];
                            fArr17[i] = 0.0f;
                            ObjectAnimator objectAnimatorOfFloat9 = ObjectAnimator.ofFloat(view4, (Property<View, Float>) property7, fArr17);
                            Animator[] animatorArr2 = new Animator[6];
                            animatorArr2[i] = valueAnimatorOfFloat2;
                            animatorArr2[1] = objectAnimatorOfFloat6;
                            animatorArr2[2] = objectAnimatorOfFloat7;
                            animatorArr2[3] = objectAnimatorOfInt2;
                            animatorArr2[4] = objectAnimatorOfFloat8;
                            animatorArr2[5] = objectAnimatorOfFloat9;
                            animatorSet2.playTogether(animatorArr2);
                            PhotoViewerProvider photoViewerProvider5 = this.placeProvider;
                            if (photoViewerProvider5 != null) {
                                photoViewerProvider5.onPreClose();
                            }
                            this.animationEndRunnable = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda14
                                @Override // java.lang.Runnable
                                public final void run() {
                                    this.f$0.lambda$closePhoto$138(placeProviderObject2);
                                }
                            };
                            animatorSet2.setDuration(200L);
                            animatorSet2.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.80
                                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                                public void onAnimationEnd(Animator animator) {
                                    PhotoViewer.this.clippingImageProgress = 1.0f;
                                    if (PhotoViewer.this.animationEndRunnable != null) {
                                        ChatActivity chatActivity2 = PhotoViewer.this.parentChatActivity;
                                        if (chatActivity2 == null && PhotoViewer.this.parentAlert != null) {
                                            BaseFragment baseFragment3 = PhotoViewer.this.parentAlert.getBaseFragment();
                                            if (baseFragment3 instanceof ChatActivity) {
                                                chatActivity2 = (ChatActivity) baseFragment3;
                                            }
                                        }
                                        if (chatActivity2 != null) {
                                            chatActivity2.lambda$openDiscussionMessageChat$372(PhotoViewer.this.animationEndRunnable);
                                        } else {
                                            PhotoViewer.this.animationEndRunnable.run();
                                            PhotoViewer.this.animationEndRunnable = null;
                                        }
                                    }
                                }
                            });
                            Runnable runnable3 = new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda15
                                @Override // java.lang.Runnable
                                public final void run() {
                                    this.f$0.lambda$closePhoto$139(animatorSet2, placeProviderObject2);
                                }
                            };
                            if (zArr2[i]) {
                                runnable = runnable3;
                                runnable.run();
                            }
                            animatedFileDrawable = this.currentAnimation;
                            if (animatedFileDrawable != null) {
                            }
                            photoViewerProvider2 = this.placeProvider;
                            if (photoViewerProvider2 != null) {
                                this.placeProvider.cancelButtonPressed();
                            }
                        }
                    } else {
                        this.isInline = i;
                        this.animationInProgress = i;
                        onPhotoClosed(placeProviderObject);
                        this.containerView.setScaleX(f5);
                        this.containerView.setScaleY(f5);
                        if (!this.doneButtonPressed) {
                            releasePlayer(true);
                        }
                    }
                    baseFragment = this.parentFragment;
                    if (baseFragment != null || baseFragment.getFragmentView() == null) {
                    }
                    View fragmentView2 = this.parentFragment.getFragmentView();
                    fragmentView2.setScaleX(f4);
                    fragmentView2.setScaleY(f);
                    ChatAttachAlert chatAttachAlert2 = this.parentAlert;
                    if (chatAttachAlert2 != null) {
                        BottomSheet.ContainerView container2 = chatAttachAlert2.getContainer();
                        container2.setScaleX(f2);
                        container2.setScaleY(f3);
                        return;
                    }
                    return;
                }
                f = scaleY;
            }
            f2 = 1.0f;
            f3 = 1.0f;
            photoViewerProvider = this.placeProvider;
            if (photoViewerProvider != null) {
            }
            zArr = new boolean[]{true};
            PhotoViewerProvider photoViewerProvider32 = this.placeProvider;
            if (photoViewerProvider32 != null) {
            }
            if (this.videoPlayer != null) {
                f4 = scaleX;
                zArr2 = zArr;
                placeProviderObject = placeForPhoto;
                r11 = 0;
                f5 = 1.0f;
                i = 0;
                i2 = 21;
                c = 11;
                c2 = '\b';
            }
            photoViewerWebView = this.photoViewerWebView;
            if (photoViewerWebView != null) {
            }
            chatActivity = this.parentChatActivity;
            if (chatActivity != null) {
                this.parentChatActivity.getFragmentView().invalidate();
            }
            this.parentChatActivity = r11;
            removeObservers();
            this.isActionBarVisible = i;
            velocityTracker = this.velocityTracker;
            if (velocityTracker != null) {
            }
            if (this.isInline) {
            }
            baseFragment = this.parentFragment;
            if (baseFragment != null) {
            }
        }
    }

    public void destroyPhotoViewer() {
        if (this.parentActivity == null || this.windowView == null) {
            return;
        }
        if (PipVideoOverlay.isVisible()) {
            PipVideoOverlay.dismiss();
        }
        removeObservers();
        releasePlayer(false);
        try {
            if (this.windowView.getParent() != null) {
                ((WindowManager) this.parentActivity.getSystemService("window")).removeViewImmediate(this.windowView);
                onHideView();
            }
            this.windowView = null;
        } catch (Exception e) {
            FileLog.e(e);
        }
        ImageReceiver.BitmapHolder bitmapHolder = this.currentThumb;
        if (bitmapHolder != null) {
            bitmapHolder.release();
            this.currentThumb = null;
        }
        this.animatingImageView.setImageBitmap(null);
        if (this == PipInstance) {
            PipInstance = null;
        } else {
            Instance = null;
        }
        onHideView();
    }

    /* JADX WARN: Removed duplicated region for block: B:317:0x05ea  */
    /* JADX WARN: Removed duplicated region for block: B:407:0x07a7  */
    /* JADX WARN: Removed duplicated region for block: B:508:0x07b1 A[SYNTHETIC] */
    @Override // org.telegram.messenger.NotificationCenter.NotificationCenterDelegate
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void didReceivedNotification(int i, int i2, Object... objArr) throws Resources.NotFoundException {
        int size;
        MessageObject messageObject;
        Uri uriFromFile;
        MediaController.SavedFilterState savedFilterState;
        boolean z;
        boolean z2;
        ArrayList arrayList;
        int size2;
        int i3;
        int id;
        int i4;
        TLRPC.Chat chat;
        TLRPC.User user;
        ArrayList arrayList2;
        MessageObject messageObject2;
        TLRPC.BotInlineResult botInlineResult;
        PageBlocksAdapter pageBlocksAdapter;
        float bufferedProgressFromPosition = 1.0f;
        int i5 = 3;
        int i6 = 2;
        int i7 = 0;
        if (i == NotificationCenter.fileLoadFailed) {
            String str = (String) objArr[0];
            int i8 = 0;
            while (i8 < 3) {
                String str2 = this.currentFileNames[i8];
                if (str2 != null && str2.equals(str)) {
                    this.photoProgressViews[i8].setProgress(1.0f, i8 == 0 || (i8 == 1 && this.sideImage == this.rightImage) || (i8 == 2 && this.sideImage == this.leftImage));
                    checkProgress(i8, false, true);
                    return;
                }
                i8++;
            }
            return;
        }
        if (i == NotificationCenter.customStickerCreated) {
            closePhoto(false, false);
            return;
        }
        if (i == NotificationCenter.fileLoaded) {
            String str3 = (String) objArr[0];
            int i9 = 0;
            while (i9 < 3) {
                String str4 = this.currentFileNames[i9];
                if (str4 != null && str4.equals(str3)) {
                    boolean z3 = i9 == 0 || (i9 == 1 && this.sideImage == this.rightImage) || (i9 == 2 && this.sideImage == this.leftImage);
                    this.photoProgressViews[i9].setProgress(1.0f, z3);
                    checkProgress(i9, false, z3);
                    if (this.videoPlayer == null && i9 == 0 && (((messageObject2 = this.currentMessageObject) != null && messageObject2.isVideo()) || (((botInlineResult = this.currentBotInlineResult) != null && (botInlineResult.type.equals(MediaStreamTrack.VIDEO_TRACK_KIND) || MessageObject.isVideoDocument(this.currentBotInlineResult.document))) || ((pageBlocksAdapter = this.pageBlocksAdapter) != null && (pageBlocksAdapter.isVideo(this.currentIndex) || this.pageBlocksAdapter.isHardwarePlayer(this.currentIndex)))))) {
                        onActionClick(false);
                    }
                    if (i9 != 0 || this.videoPlayer == null) {
                        return;
                    }
                    this.currentVideoFinishedLoading = true;
                    return;
                }
                i9++;
            }
            return;
        }
        if (i == NotificationCenter.fileLoadProgressChanged) {
            String str5 = (String) objArr[0];
            int i10 = 0;
            while (i10 < i5) {
                String str6 = this.currentFileNames[i10];
                if (str6 != null && str6.equals(str5)) {
                    float fMin = Math.min(bufferedProgressFromPosition, ((Long) objArr[1]).longValue() / ((Long) objArr[i6]).longValue());
                    this.photoProgressViews[i10].setProgress(fMin, i10 == 0 || (i10 == 1 && this.sideImage == this.rightImage) || (i10 == i6 && this.sideImage == this.leftImage));
                    if (i10 == 0 && this.videoPlayer != null && this.videoPlayerSeekbar != null) {
                        if (!this.currentVideoFinishedLoading) {
                            long jElapsedRealtime = SystemClock.elapsedRealtime();
                            if (Math.abs(jElapsedRealtime - this.lastBufferedPositionCheck) >= 500) {
                                float f = this.seekToProgressPending;
                                if (f == BitmapDescriptorFactory.HUE_RED) {
                                    long duration = this.videoPlayer.getDuration();
                                    long currentPosition = this.videoPlayer.getCurrentPosition();
                                    f = (duration < 0 || duration == -9223372036854775807L || currentPosition < 0) ? BitmapDescriptorFactory.HUE_RED : currentPosition / duration;
                                }
                                bufferedProgressFromPosition = this.isStreaming ? FileLoader.getInstance(this.currentAccount).getBufferedProgressFromPosition(f, this.currentFileNames[0]) : 1.0f;
                                this.lastBufferedPositionCheck = jElapsedRealtime;
                            } else {
                                bufferedProgressFromPosition = -1.0f;
                            }
                        }
                        if (bufferedProgressFromPosition != -1.0f) {
                            this.videoPlayerSeekbar.setBufferedProgress(bufferedProgressFromPosition);
                            PipVideoOverlay.setBufferedProgress(bufferedProgressFromPosition);
                            this.videoPlayerSeekbarView.invalidate();
                        }
                        checkBufferedProgress(fMin);
                    }
                }
                i10++;
                bufferedProgressFromPosition = 1.0f;
                i5 = 3;
                i6 = 2;
            }
            return;
        }
        if (i == NotificationCenter.dialogPhotosUpdate) {
            MessagesController.DialogPhotos dialogPhotos = (MessagesController.DialogPhotos) objArr[0];
            if (this.avatarsDialogId == dialogPhotos.dialogId) {
                this.dialogPhotos = dialogPhotos;
                ArrayList arrayList3 = new ArrayList(dialogPhotos.photos);
                this.imagesArrLocations.clear();
                this.imagesArrLocationsSizes.clear();
                this.imagesArrLocationsVideo.clear();
                this.imagesArrMessages.clear();
                this.avatarsArr.clear();
                int size3 = -1;
                for (int i11 = 0; i11 < arrayList3.size(); i11++) {
                    TLRPC.Photo photo = (TLRPC.Photo) arrayList3.get(i11);
                    if (photo == null || (photo instanceof TLRPC.TL_photoEmpty) || (arrayList2 = photo.sizes) == null) {
                        this.imagesArrLocations.add(null);
                        this.imagesArrLocationsSizes.add(null);
                        this.imagesArrLocationsVideo.add(null);
                        this.imagesArrMessages.add(null);
                        this.avatarsArr.add(null);
                    } else {
                        TLRPC.PhotoSize closestPhotoSizeWithSize = FileLoader.getClosestPhotoSizeWithSize(arrayList2, 640);
                        TLRPC.VideoSize closestVideoSizeWithSize = photo.video_sizes.isEmpty() ? null : FileLoader.getClosestVideoSizeWithSize(photo.video_sizes, 1000);
                        if (closestPhotoSizeWithSize != null) {
                            if (size3 == -1 && this.currentFileLocation != null) {
                                int i12 = 0;
                                while (true) {
                                    if (i12 >= photo.sizes.size()) {
                                        break;
                                    }
                                    TLRPC.FileLocation fileLocation = ((TLRPC.PhotoSize) photo.sizes.get(i12)).location;
                                    if (fileLocation != null) {
                                        int i13 = fileLocation.local_id;
                                        TLRPC.TL_fileLocationToBeDeprecated tL_fileLocationToBeDeprecated = this.currentFileLocation.location;
                                        if (i13 == tL_fileLocationToBeDeprecated.local_id && fileLocation.volume_id == tL_fileLocationToBeDeprecated.volume_id) {
                                            size3 = this.imagesArrLocations.size();
                                            break;
                                        }
                                    }
                                    i12++;
                                }
                            }
                            if (size3 == -1 && this.currentFileLocation != null) {
                                int i14 = 0;
                                while (true) {
                                    if (i14 >= photo.video_sizes.size()) {
                                        break;
                                    }
                                    TLRPC.FileLocation fileLocation2 = ((TLRPC.VideoSize) photo.video_sizes.get(i14)).location;
                                    if (fileLocation2 != null) {
                                        int i15 = fileLocation2.local_id;
                                        TLRPC.TL_fileLocationToBeDeprecated tL_fileLocationToBeDeprecated2 = this.currentFileLocation.location;
                                        if (i15 == tL_fileLocationToBeDeprecated2.local_id && fileLocation2.volume_id == tL_fileLocationToBeDeprecated2.volume_id) {
                                            size3 = this.imagesArrLocations.size();
                                            break;
                                        }
                                    }
                                    i14++;
                                }
                            }
                            int i16 = photo.dc_id;
                            if (i16 != 0) {
                                TLRPC.FileLocation fileLocation3 = closestPhotoSizeWithSize.location;
                                fileLocation3.dc_id = i16;
                                fileLocation3.file_reference = photo.file_reference;
                            }
                            ImageLocation forPhoto = ImageLocation.getForPhoto(closestPhotoSizeWithSize, photo);
                            ImageLocation forPhoto2 = closestVideoSizeWithSize != null ? ImageLocation.getForPhoto(closestVideoSizeWithSize, photo) : forPhoto;
                            if (forPhoto != null) {
                                this.imagesArrLocations.add(forPhoto);
                                this.imagesArrLocationsSizes.add(forPhoto2 != null ? Long.valueOf(forPhoto2.currentSize) : null);
                                this.imagesArrLocationsVideo.add(forPhoto2);
                                this.imagesArrMessages.add(null);
                                this.avatarsArr.add(photo);
                            }
                        }
                    }
                }
                if (this.avatarsArr.isEmpty()) {
                    this.menuItem.hideSubItem(7);
                } else {
                    this.menuItem.showSubItem(7);
                }
                this.needSearchImageInArr = false;
                this.currentIndex = -1;
                if (size3 != -1) {
                    setImageIndex(size3);
                    return;
                }
                long j = this.avatarsDialogId;
                MessagesController messagesController = MessagesController.getInstance(this.currentAccount);
                if (j > 0) {
                    user = messagesController.getUser(Long.valueOf(this.avatarsDialogId));
                    chat = null;
                } else {
                    chat = messagesController.getChat(Long.valueOf(-this.avatarsDialogId));
                    user = null;
                }
                if (user == null && chat == null) {
                    return;
                }
                ImageLocation forUserOrChat = user != null ? ImageLocation.getForUserOrChat(user, 0) : ImageLocation.getForUserOrChat(chat, 0);
                if (forUserOrChat != null) {
                    if (!this.imagesArrLocations.isEmpty() && this.imagesArrLocations.get(0) != null && ((ImageLocation) this.imagesArrLocations.get(0)).photoId == forUserOrChat.photoId) {
                        this.imagesArrLocations.remove(0);
                        this.avatarsArr.remove(0);
                        this.imagesArrLocationsSizes.remove(0);
                        this.imagesArrLocationsVideo.remove(0);
                        this.imagesArrMessages.remove(0);
                    }
                    this.imagesArrLocations.add(0, forUserOrChat);
                    this.avatarsArr.add(0, new TLRPC.TL_photoEmpty());
                    ArrayList arrayList4 = this.imagesArrLocationsSizes;
                    ImageLocation imageLocation = this.currentFileLocationVideo;
                    arrayList4.add(0, imageLocation != null ? Long.valueOf(imageLocation.currentSize) : null);
                    this.imagesArrLocationsVideo.add(0, this.currentFileLocationVideo);
                    this.imagesArrMessages.add(0, null);
                    setImageIndex(0);
                    return;
                }
                return;
            }
            return;
        }
        if (i == NotificationCenter.mediaCountDidLoad) {
            long jLongValue = ((Long) objArr[0]).longValue();
            long jLongValue2 = ((Long) objArr[1]).longValue();
            if (this.topicId == jLongValue2) {
                if (jLongValue == this.currentDialogId || jLongValue == this.mergeDialogId) {
                    MessageObject messageObject3 = this.currentMessageObject;
                    if (messageObject3 == null || MediaDataController.getMediaType(messageObject3.messageOwner) == this.sharedMediaType) {
                        if (jLongValue == this.currentDialogId) {
                            this.totalImagesCount = ((Integer) objArr[2]).intValue();
                        } else {
                            this.totalImagesCountMerge = ((Integer) objArr[2]).intValue();
                        }
                        if (this.needSearchImageInArr && this.isFirstLoading) {
                            this.isFirstLoading = false;
                            this.loadingMoreImages = true;
                            MediaDataController.getInstance(this.currentAccount).loadMedia(this.currentDialogId, 20, 0, 0, this.sharedMediaType, jLongValue2, 1, this.classGuid, 0, this.currentFilterTag, null);
                            return;
                        } else {
                            if (this.imagesArr.isEmpty()) {
                                return;
                            }
                            setIsAboutToSwitchToIndex(this.switchingToIndex, true, true);
                            return;
                        }
                    }
                    return;
                }
                return;
            }
            return;
        }
        if (i == NotificationCenter.mediaDidLoad) {
            long jLongValue3 = ((Long) objArr[0]).longValue();
            int iIntValue = ((Integer) objArr[3]).intValue();
            long j2 = this.currentDialogId;
            if ((jLongValue3 == j2 || jLongValue3 == this.mergeDialogId) && iIntValue == this.classGuid) {
                this.loadingMoreImages = false;
                char c = jLongValue3 == j2 ? (char) 0 : (char) 1;
                ArrayList arrayList5 = (ArrayList) objArr[2];
                this.endReached[c] = ((Boolean) objArr[5]).booleanValue();
                boolean zBooleanValue = ((Boolean) objArr[6]).booleanValue();
                if (!this.needSearchImageInArr) {
                    int i17 = 0;
                    for (int i18 = 0; i18 < arrayList5.size(); i18++) {
                        MessageObject messageObject4 = (MessageObject) arrayList5.get(zBooleanValue ? (arrayList5.size() - 1) - i18 : i18);
                        if (this.imagesByIds[c].indexOfKey(messageObject4.getId()) < 0) {
                            i17++;
                            if (this.opennedFromMedia) {
                                ArrayList arrayList6 = this.imagesArr;
                                if (zBooleanValue) {
                                    arrayList6.add(0, messageObject4);
                                    int i19 = this.startOffset - 1;
                                    this.startOffset = i19;
                                    this.currentIndex++;
                                    if (i19 < 0) {
                                        this.startOffset = 0;
                                    }
                                } else {
                                    arrayList6.add(messageObject4);
                                }
                            } else {
                                this.imagesArr.add(0, messageObject4);
                            }
                            this.imagesByIds[c].put(messageObject4.getId(), messageObject4);
                        }
                    }
                    if (this.opennedFromMedia) {
                        if (i17 != 0 || zBooleanValue) {
                            return;
                        } else {
                            size2 = this.startOffset + this.imagesArr.size();
                        }
                    } else if (i17 != 0) {
                        int i20 = this.currentIndex;
                        this.currentIndex = -1;
                        size = i20 + i17;
                    } else {
                        size2 = this.imagesArr.size();
                    }
                    this.totalImagesCount = size2;
                    this.totalImagesCountMerge = 0;
                    return;
                }
                if ((arrayList5.isEmpty() && (c != 0 || this.mergeDialogId == 0)) || (i3 = this.currentIndex) < 0 || i3 >= this.imagesArr.size()) {
                    this.needSearchImageInArr = false;
                    return;
                }
                MessageObject messageObject5 = (MessageObject) this.imagesArr.get(this.currentIndex);
                int i21 = 0;
                int size4 = -1;
                for (int i22 = 0; i22 < arrayList5.size(); i22++) {
                    MessageObject messageObject6 = (MessageObject) arrayList5.get(i22);
                    if (this.imagesByIdsTemp[c].indexOfKey(messageObject6.getId()) < 0) {
                        this.imagesByIdsTemp[c].put(messageObject6.getId(), messageObject6);
                        if (this.opennedFromMedia) {
                            this.imagesArrTemp.add(messageObject6);
                            if (messageObject6.getId() == messageObject5.getId()) {
                                size4 = i21;
                            }
                            i21++;
                        } else {
                            i21++;
                            this.imagesArrTemp.add(0, messageObject6);
                            if (messageObject6.getId() == messageObject5.getId()) {
                                size4 = arrayList5.size() - i21;
                            }
                        }
                    }
                }
                if (i21 == 0 && (c != 0 || this.mergeDialogId == 0)) {
                    this.totalImagesCount = this.imagesArr.size();
                    this.totalImagesCountMerge = 0;
                }
                if (size4 != -1) {
                    this.imagesArr.clear();
                    this.imagesArr.addAll(this.imagesArrTemp);
                    int i23 = 0;
                    for (int i24 = 2; i23 < i24; i24 = 2) {
                        this.imagesByIds[i23] = this.imagesByIdsTemp[i23].clone();
                        this.imagesByIdsTemp[i23].clear();
                        i23++;
                    }
                    this.imagesArrTemp.clear();
                    this.needSearchImageInArr = false;
                    this.currentIndex = -1;
                    if (size4 >= this.imagesArr.size()) {
                        size4 = this.imagesArr.size() - 1;
                    }
                    setImageIndex(size4);
                    return;
                }
                if (this.opennedFromMedia) {
                    if (this.imagesArrTemp.isEmpty()) {
                        id = 0;
                    } else {
                        ArrayList arrayList7 = this.imagesArrTemp;
                        id = ((MessageObject) arrayList7.get(arrayList7.size() - 1)).getId();
                    }
                    if (c == 0 && this.endReached[c] && this.mergeDialogId != 0) {
                        if (!this.imagesArrTemp.isEmpty()) {
                            ArrayList arrayList8 = this.imagesArrTemp;
                            if (((MessageObject) arrayList8.get(arrayList8.size() - 1)).getDialogId() != this.mergeDialogId) {
                                c = 1;
                                i4 = 0;
                            }
                        }
                        i4 = id;
                        c = 1;
                    }
                    i4 = id;
                } else {
                    id = this.imagesArrTemp.isEmpty() ? 0 : ((MessageObject) this.imagesArrTemp.get(0)).getId();
                    if (c == 0 && this.endReached[c] && this.mergeDialogId != 0) {
                        if (this.imagesArrTemp.isEmpty() || ((MessageObject) this.imagesArrTemp.get(0)).getDialogId() == this.mergeDialogId) {
                            i4 = id;
                            c = 1;
                        }
                    }
                    i4 = id;
                }
                if (this.endReached[c]) {
                    return;
                }
                this.loadingMoreImages = true;
                MediaDataController.getInstance(this.currentAccount).loadMedia(c == 0 ? this.currentDialogId : this.mergeDialogId, 40, i4, 0, this.sharedMediaType, this.topicId, 1, this.classGuid, 0, this.currentFilterTag, null);
                return;
            }
            return;
        }
        if (i == NotificationCenter.emojiLoaded) {
            CaptionTextViewSwitcher captionTextViewSwitcher = this.captionTextViewSwitcher;
            if (captionTextViewSwitcher != null) {
                captionTextViewSwitcher.invalidateViews();
                return;
            }
            return;
        }
        if (i == NotificationCenter.filePreparingFailed) {
            MessageObject messageObject7 = (MessageObject) objArr[0];
            if (!this.loadInitialVideo) {
                if (this.tryStartRequestPreviewOnFinish) {
                    releasePlayer(false);
                    this.tryStartRequestPreviewOnFinish = !MediaController.getInstance().scheduleVideoConvert(this.videoPreviewMessageObject, true, true, false);
                    return;
                } else {
                    if (messageObject7 == this.videoPreviewMessageObject) {
                        this.requestingPreview = false;
                        this.progressView.setVisibility(4);
                        return;
                    }
                    return;
                }
            }
            this.loadInitialVideo = false;
            this.progressView.setVisibility(4);
            arrayList = this.currentPlayingVideoQualityFiles;
            uriFromFile = this.currentPlayingVideoFile;
            savedFilterState = this.editState.savedFilterState;
            z = false;
            z2 = false;
        } else if (i == NotificationCenter.fileNewChunkAvailable) {
            if (((MessageObject) objArr[0]) != this.videoPreviewMessageObject) {
                return;
            }
            String str7 = (String) objArr[1];
            long jLongValue4 = ((Long) objArr[3]).longValue();
            this.photoProgressViews[0].setProgress(((Float) objArr[4]).floatValue(), true);
            if (jLongValue4 == 0) {
                return;
            }
            this.requestingPreview = false;
            this.photoProgressViews[0].setProgress(1.0f, true);
            this.photoProgressViews[0].setBackgroundState(3, true, true);
            uriFromFile = Uri.fromFile(new File(str7));
            savedFilterState = this.editState.savedFilterState;
            z = false;
            z2 = true;
            arrayList = null;
        } else {
            if (i == NotificationCenter.replaceMessagesObjects) {
                if (this.currentDialogId != ((Long) objArr[0]).longValue()) {
                    return;
                }
                ArrayList arrayList9 = (ArrayList) objArr[1];
                boolean z4 = false;
                for (int i25 = 0; i25 < arrayList9.size(); i25++) {
                    MessageObject messageObject8 = (MessageObject) arrayList9.get(i25);
                    if (messageObject8 != null) {
                        if (this.imagesArr != null) {
                            int i26 = 0;
                            while (i26 < this.imagesArr.size()) {
                                messageObject = (MessageObject) this.imagesArr.get(i26);
                                if (messageObject != null && messageObject.getDialogId() == messageObject8.getDialogId() && messageObject.getId() == messageObject8.getId()) {
                                    break;
                                } else {
                                    i26++;
                                }
                            }
                            messageObject = null;
                            i26 = -1;
                            if (messageObject == null) {
                                this.imagesArr.set(i26, messageObject8);
                                if (this.currentIndex == i26) {
                                    z4 = true;
                                }
                            }
                        } else {
                            messageObject = null;
                            i26 = -1;
                            if (messageObject == null) {
                            }
                        }
                    }
                }
                if (z4) {
                    setImageIndex(this.currentIndex, false, true, true);
                    return;
                }
                return;
            }
            if (i == NotificationCenter.dialogDeleted) {
                if (this.currentDialogId != ((Long) objArr[0]).longValue()) {
                    return;
                }
                closePhoto(true, false);
                return;
            }
            if (i != NotificationCenter.messagesDeleted) {
                return;
            }
            int i27 = 2;
            if (((Boolean) objArr[2]).booleanValue()) {
                return;
            }
            long jLongValue5 = ((Long) objArr[1]).longValue();
            ArrayList arrayList10 = (ArrayList) objArr[0];
            int i28 = 0;
            boolean z5 = false;
            boolean z6 = false;
            while (i28 < i27) {
                ArrayList arrayList11 = i28 == 0 ? this.imagesArr : this.imagesArrTemp;
                SparseArray[] sparseArrayArr = i28 == 0 ? this.imagesByIds : this.imagesByIdsTemp;
                if (!arrayList11.isEmpty()) {
                    int i29 = 0;
                    for (int i30 = 2; i29 < i30; i30 = 2) {
                        if (sparseArrayArr[i29].size() > 0 && ((MessageObject) sparseArrayArr[i29].valueAt(i7)).messageOwner.peer_id.channel_id == jLongValue5) {
                            int size5 = arrayList10.size();
                            for (int i31 = 0; i31 < size5; i31++) {
                                int iIntValue2 = ((Integer) arrayList10.get(i31)).intValue();
                                MessageObject messageObject9 = (MessageObject) sparseArrayArr[i29].get(((Integer) arrayList10.get(i31)).intValue());
                                if (messageObject9 != null) {
                                    sparseArrayArr[i29].remove(iIntValue2);
                                    arrayList11.remove(messageObject9);
                                    if (i29 == 0) {
                                        this.totalImagesCount--;
                                    } else {
                                        this.totalImagesCountMerge--;
                                    }
                                    if (messageObject9 == this.currentMessageObject) {
                                        z6 = true;
                                    }
                                    z5 = true;
                                }
                            }
                        }
                        i29++;
                        i7 = 0;
                    }
                }
                i28++;
                i27 = 2;
                i7 = 0;
            }
            if (!z5) {
                return;
            }
            if (z6 && this == PipInstance) {
                destroyPhotoViewer();
                return;
            } else {
                if (this.imagesArr.isEmpty()) {
                    closePhoto(false, true);
                    return;
                }
                size = this.currentIndex;
                this.currentIndex = -1;
                if (size >= this.imagesArr.size()) {
                    size = this.imagesArr.size() - 1;
                }
            }
        }
        preparePlayer(arrayList, uriFromFile, z, z2, savedFilterState);
        return;
        setImageIndex(size);
    }

    /* JADX WARN: Removed duplicated region for block: B:100:0x0290  */
    /* JADX WARN: Removed duplicated region for block: B:123:0x033d  */
    /* JADX WARN: Removed duplicated region for block: B:126:0x0347  */
    /* JADX WARN: Removed duplicated region for block: B:127:0x034f  */
    /* JADX WARN: Removed duplicated region for block: B:130:0x035b  */
    /* JADX WARN: Removed duplicated region for block: B:134:0x03c0  */
    /* JADX WARN: Removed duplicated region for block: B:136:0x03c5  */
    /* JADX WARN: Removed duplicated region for block: B:146:0x03f5  */
    /* JADX WARN: Removed duplicated region for block: B:223:0x0595  */
    /* JADX WARN: Removed duplicated region for block: B:244:0x0759  */
    /* JADX WARN: Removed duplicated region for block: B:269:0x0797  */
    /* JADX WARN: Removed duplicated region for block: B:271:0x079a  */
    /* JADX WARN: Removed duplicated region for block: B:308:0x07ed  */
    /* JADX WARN: Removed duplicated region for block: B:312:0x081f  */
    /* JADX WARN: Removed duplicated region for block: B:324:0x0843  */
    /* JADX WARN: Removed duplicated region for block: B:330:0x086d  */
    /* JADX WARN: Removed duplicated region for block: B:352:0x08b3  */
    /* JADX WARN: Removed duplicated region for block: B:354:0x08b7  */
    /* JADX WARN: Removed duplicated region for block: B:363:0x08ee  */
    /* JADX WARN: Removed duplicated region for block: B:366:0x08f9  */
    /* JADX WARN: Removed duplicated region for block: B:377:0x094d  */
    /* JADX WARN: Removed duplicated region for block: B:380:0x0992  */
    /* JADX WARN: Removed duplicated region for block: B:390:0x09a9  */
    /* JADX WARN: Removed duplicated region for block: B:392:0x09b0 A[PHI: r0
      0x09b0: PHI (r0v61 float) = (r0v60 float), (r0v59 float) binds: [B:391:0x09ae, B:388:0x09a6] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:393:0x09b6  */
    /* JADX WARN: Removed duplicated region for block: B:395:0x09bc  */
    /* JADX WARN: Removed duplicated region for block: B:407:0x09da  */
    /* JADX WARN: Removed duplicated region for block: B:410:0x09e4  */
    /* JADX WARN: Removed duplicated region for block: B:411:0x09f1  */
    /* JADX WARN: Removed duplicated region for block: B:414:0x09f9  */
    /* JADX WARN: Removed duplicated region for block: B:423:0x0a26  */
    /* JADX WARN: Removed duplicated region for block: B:424:0x0a2a  */
    /* JADX WARN: Removed duplicated region for block: B:425:0x0a2c  */
    /* JADX WARN: Removed duplicated region for block: B:426:0x0ad0  */
    /* JADX WARN: Removed duplicated region for block: B:429:0x0ada  */
    /* JADX WARN: Removed duplicated region for block: B:431:0x0ae4  */
    /* JADX WARN: Removed duplicated region for block: B:436:0x0b4b  */
    /* JADX WARN: Removed duplicated region for block: B:438:0x0b50  */
    /* JADX WARN: Removed duplicated region for block: B:481:0x0ce2  */
    /* JADX WARN: Removed duplicated region for block: B:484:0x0cef  */
    /* JADX WARN: Removed duplicated region for block: B:487:0x0cfc  */
    /* JADX WARN: Removed duplicated region for block: B:493:0x0d64  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawCaptionBlur(Canvas canvas, BlurringShader.StoryBlurDrawer storyBlurDrawer, int i, int i2, boolean z, boolean z2, boolean z3) {
        float f;
        float f2;
        float fLerp;
        float fLerp2;
        float fLerp3;
        float f3;
        float f4;
        ImageReceiver imageReceiver;
        ImageReceiver imageReceiver2;
        int i3;
        int i4;
        int i5;
        float f5;
        float f6;
        float f7;
        float f8;
        float f9;
        int i6;
        float f10;
        float f11;
        float f12;
        int bitmapWidth;
        int bitmapHeight;
        int i7;
        float f13;
        float f14;
        ImageReceiver imageReceiver3;
        float f15;
        int i8;
        float f16;
        float f17;
        boolean z4;
        float f18;
        float f19;
        boolean z5;
        boolean zIsMirrored;
        float f20;
        float f21;
        boolean z6;
        PhotoViewerWebView photoViewerWebView;
        float f22;
        Bitmap bitmap;
        float f23;
        int i9;
        int i10;
        float f24;
        int i11;
        float f25;
        float f26;
        float f27;
        float f28;
        float f29;
        float f30;
        TextureView textureView;
        float f31;
        float f32;
        float minScale;
        int i12;
        float rotation;
        int i13;
        int i14;
        float fMin;
        float f33;
        float f34;
        Bitmap bitmap2;
        Bitmap bitmap3;
        float f35;
        int i15;
        ImageReceiver imageReceiver4;
        float f36;
        boolean zIsMirrored2;
        Bitmap bitmap4;
        AspectRatioFrameLayout aspectRatioFrameLayout;
        float fDp;
        float f37;
        float f38;
        int i16;
        int i17;
        ImageReceiver imageReceiver5;
        boolean zIsMirrored3;
        Bitmap bitmap5;
        ImageReceiver imageReceiver6;
        BlurringShader.StoryBlurDrawer storyBlurDrawer2 = storyBlurDrawer;
        if (BLUR_RENDERNODE()) {
            if (this.renderNode != null) {
                if (storyBlurDrawer2.renderNode == null) {
                    RenderNode renderNode = new RenderNode("photoviewer blur");
                    storyBlurDrawer2.renderNode = renderNode;
                    renderNode.setRenderEffect(RenderEffect.createChainEffect(RenderEffect.createColorFilterEffect(new ColorMatrixColorFilter(storyBlurDrawer2.colorMatrix)), RenderEffect.createBlurEffect(AndroidUtilities.dp(35.0f), AndroidUtilities.dp(35.0f), Shader.TileMode.DECAL)));
                }
                storyBlurDrawer2.renderNode.setPosition(0, 0, this.renderNode.getWidth(), this.renderNode.getHeight());
                RecordingCanvas recordingCanvasBeginRecording = storyBlurDrawer2.renderNode.beginRecording();
                recordingCanvasBeginRecording.drawColor(i);
                recordingCanvasBeginRecording.drawRenderNode(this.renderNode);
                storyBlurDrawer2.renderNode.endRecording();
            }
            RenderNode renderNode2 = storyBlurDrawer2.renderNode;
            if (renderNode2 != null && renderNode2.hasDisplayList()) {
                canvas.drawColor(i);
                canvas.drawRenderNode(storyBlurDrawer2.renderNode);
            }
            canvas.drawColor(i2);
            return;
        }
        if (SharedConfig.photoViewerBlur) {
            AnimatedFloat animatedFloat = this.blurAlpha;
            int i18 = this.animationInProgress;
            f = animatedFloat.set(i18 == 0 || i18 == 2 || i18 == 3);
        } else {
            f = 1.0f;
        }
        storyBlurDrawer2.paint.setShader(null);
        if (i != 0) {
            storyBlurDrawer2.paint.setColor(i);
            storyBlurDrawer2.paint.setAlpha((int) (r0.getAlpha() * AndroidUtilities.lerp(0.7f, 1.0f, z2 ? f : 1.0f)));
            canvas.drawPaint(storyBlurDrawer2.paint);
        }
        if (!SharedConfig.photoViewerBlur || this.animationInProgress != 0) {
            float f39 = f;
            this.blurAlpha.set(BitmapDescriptorFactory.HUE_RED, true);
            if (i2 != 0) {
                storyBlurDrawer2.paint.setColor(i2);
                Paint paint = storyBlurDrawer2.paint;
                float alpha = paint.getAlpha();
                if (!z2) {
                    f39 = 1.0f;
                }
                paint.setAlpha((int) (alpha * AndroidUtilities.lerp(0.7f, 1.0f, f39)));
                canvas.drawPaint(storyBlurDrawer2.paint);
                return;
            }
            return;
        }
        if (z3) {
            if (this.centerImageInsideBlur == null) {
                AnimatedFloat[] animatedFloatArr = new AnimatedFloat[3];
                this.centerImageInsideBlur = animatedFloatArr;
                PhotoViewer$$ExternalSyntheticLambda74 photoViewer$$ExternalSyntheticLambda74 = new PhotoViewer$$ExternalSyntheticLambda74(this);
                CubicBezierInterpolator cubicBezierInterpolator = CubicBezierInterpolator.EASE_OUT;
                f2 = f;
                animatedFloatArr[0] = new AnimatedFloat(photoViewer$$ExternalSyntheticLambda74, 180L, cubicBezierInterpolator);
                this.centerImageInsideBlur[1] = new AnimatedFloat(new PhotoViewer$$ExternalSyntheticLambda74(this), 180L, cubicBezierInterpolator);
                this.centerImageInsideBlur[2] = new AnimatedFloat(new PhotoViewer$$ExternalSyntheticLambda74(this), 180L, cubicBezierInterpolator);
            } else {
                f2 = f;
            }
            this.centerImageInsideBlur[0].set(1.0f, true);
            this.centerImageInsideBlur[2].set(1.0f, true);
            if (this.blurBounds == null) {
                this.blurBounds = new RectF();
            }
            if (this.imageBounds == null) {
                this.imageBounds = new RectF();
            }
            if (this.imageBoundsMatrix == null) {
                this.imageBoundsMatrix = new Matrix();
            }
            if (this.imageBoundsPoints == null) {
                this.imageBoundsPoints = new float[8];
            }
            this.blurBounds.set(this.captionEdit.getBounds());
            this.blurBounds.offset(this.captionEditContainer.getX(), this.captionEditContainer.getY());
            this.blurBounds.offset(this.captionEdit.getX(), this.captionEdit.getY());
            this.imageBoundsMatrix.reset();
        } else {
            f2 = f;
        }
        int saveCount = canvas.getSaveCount();
        if (this.padImageForHorizontalInsets) {
            canvas.save();
            canvas.translate((getLeftInset() / 2) - (getRightInset() / 2), BitmapDescriptorFactory.HUE_RED);
            if (z3) {
                this.imageBoundsMatrix.preTranslate((getLeftInset() / 2) - (getRightInset() / 2), BitmapDescriptorFactory.HUE_RED);
            }
        }
        if (this.imageMoveAnimation != null) {
            float fLerp4 = AndroidUtilities.lerp(this.mirror, this.animateToMirror, this.animationValue);
            float fLerp5 = AndroidUtilities.lerp(this.scale, this.animateToScale, this.animationValue);
            fLerp = AndroidUtilities.lerp(this.rotate, this.animateToRotate, this.animationValue);
            fLerp2 = AndroidUtilities.lerp(this.translationY, this.animateToY, this.animationValue);
            fLerp3 = AndroidUtilities.lerp(this.translationX, this.animateToX, this.animationValue);
            f4 = fLerp4;
            f3 = fLerp5;
        } else {
            float f40 = this.scale;
            float f41 = this.mirror;
            fLerp = this.rotate;
            fLerp2 = this.translationY;
            fLerp3 = this.translationX;
            if (this.animationStartTime != 0) {
                fLerp3 = this.animateToX;
                fLerp2 = this.animateToY;
                f40 = this.animateToScale;
            }
            f3 = f40;
            f4 = f41;
        }
        float f42 = fLerp;
        float f43 = fLerp3;
        float f44 = fLerp2;
        int containerViewWidth = getContainerViewWidth();
        int containerViewHeight = getContainerViewHeight();
        if (this.currentEditMode != 0 || this.sendPhotoType == 1 || this.scale < 1.0f || this.zoomAnimation || this.zooming) {
            imageReceiver = null;
        } else {
            if (f43 > this.maxX + AndroidUtilities.dp(5.0f)) {
                imageReceiver6 = this.leftImage;
            } else {
                if (f43 < this.minX - AndroidUtilities.dp(5.0f)) {
                    imageReceiver6 = this.rightImage;
                }
                imageReceiver = null;
            }
            imageReceiver = imageReceiver6;
        }
        if (imageReceiver != this.rightImage) {
            imageReceiver2 = imageReceiver;
            i3 = containerViewHeight;
            i4 = containerViewWidth;
            i5 = saveCount;
            f5 = f4;
            f6 = f2;
            f7 = BitmapDescriptorFactory.HUE_RED;
            f8 = 1.0f;
            f9 = f42;
            i6 = 1;
        } else {
            float f45 = z3 ? this.centerImageInsideBlur[0].set(1.0f, true) : 1.0f;
            if (!this.zoomAnimation) {
                float f46 = this.minX;
                if (f43 < f46) {
                    float fMin2 = Math.min(1.0f, (f46 - f43) / containerViewWidth);
                    f37 = (1.0f - fMin2) * 0.3f;
                    fDp = (-containerViewWidth) - (AndroidUtilities.dp(30.0f) / 2);
                    f38 = fMin2;
                } else {
                    fDp = f43;
                    f37 = BitmapDescriptorFactory.HUE_RED;
                    f38 = 1.0f;
                }
                if (imageReceiver.hasBitmapImage()) {
                    canvas.save();
                    canvas.translate(containerViewWidth / 2, containerViewHeight / 2);
                    canvas.translate((AndroidUtilities.dp(30.0f) / 2) + containerViewWidth + fDp, BitmapDescriptorFactory.HUE_RED);
                    float f47 = 1.0f - f37;
                    canvas.scale(f47, f47);
                    int bitmapWidth2 = imageReceiver.getBitmapWidth();
                    int bitmapHeight2 = imageReceiver.getBitmapHeight();
                    if (this.rightImageIsVideo || this.rightCropState == null || !this.rightCropTransform.hasViewTransform()) {
                        i16 = bitmapHeight2;
                        i17 = bitmapWidth2;
                        imageReceiver5 = imageReceiver;
                        i3 = containerViewHeight;
                        i4 = containerViewWidth;
                        i5 = saveCount;
                        f5 = f4;
                        f6 = f2;
                        f9 = f42;
                        i6 = 1;
                    } else {
                        i16 = bitmapHeight2;
                        i17 = bitmapWidth2;
                        imageReceiver5 = imageReceiver;
                        i3 = containerViewHeight;
                        i4 = containerViewWidth;
                        i5 = saveCount;
                        f5 = f4;
                        f6 = f2;
                        f9 = f42;
                        i6 = 1;
                        applyCrop(canvas, containerViewWidth, containerViewHeight, i17, i16, 1.0f, this.rightCropTransform, this.rightCropState);
                    }
                    float f48 = i17;
                    float f49 = i16;
                    float fMin3 = Math.min(i4 / f48, i3 / f49);
                    int i19 = (int) (f48 * fMin3);
                    int i20 = (int) (f49 * fMin3);
                    if (this.imagesArrLocals.isEmpty()) {
                        zIsMirrored3 = false;
                        if (zIsMirrored3) {
                            f8 = 1.0f;
                        } else {
                            f8 = 1.0f;
                            canvas.scale(-1.0f, 1.0f);
                        }
                        imageReceiver2 = imageReceiver5;
                        bitmap5 = this.rightBlur.getBitmap(imageReceiver2);
                        if (bitmap5 == null) {
                            storyBlurDrawer2.paint.setShader(null);
                            storyBlurDrawer2.paint.setAlpha((int) (f38 * 255.0f * f6 * f45));
                            canvas.scale(bitmap5.getWidth() / (bitmap5.getWidth() - 3.0f), bitmap5.getHeight() / (bitmap5.getHeight() - 3.0f));
                            canvas.translate((-i19) / 2, (-i20) / 2);
                            canvas.scale((i19 * f8) / bitmap5.getWidth(), (i20 * f8) / bitmap5.getHeight());
                            f7 = BitmapDescriptorFactory.HUE_RED;
                            if (z) {
                                int i21 = (int) BitmapDescriptorFactory.HUE_RED;
                                canvas.clipRect(i21, i21, bitmap5.getWidth() - i21, bitmap5.getHeight() - i21);
                            }
                            canvas.drawBitmap(bitmap5, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, storyBlurDrawer2.paint);
                        } else {
                            f7 = BitmapDescriptorFactory.HUE_RED;
                        }
                        canvas.restore();
                    } else {
                        if (this.currentEditMode == i6 || this.sendPhotoType == i6) {
                            zIsMirrored3 = this.rightCropTransform.isMirrored();
                        } else {
                            MediaController.CropState cropState = this.rightCropState;
                            if (cropState != null && cropState.mirrored) {
                                zIsMirrored3 = true;
                            }
                        }
                        if (zIsMirrored3) {
                        }
                        imageReceiver2 = imageReceiver5;
                        bitmap5 = this.rightBlur.getBitmap(imageReceiver2);
                        if (bitmap5 == null) {
                        }
                        canvas.restore();
                    }
                }
            }
        }
        if (!this.zoomAnimation) {
            float f50 = this.maxX;
            if (f43 <= f50 || this.currentEditMode != 0 || this.sendPhotoType == i6) {
                f10 = f43;
                f11 = 1.0f;
                f12 = BitmapDescriptorFactory.HUE_RED;
            } else {
                float fMin4 = Math.min(f8, (f43 - f50) / i4);
                f12 = fMin4 * 0.3f;
                f11 = f8 - fMin4;
                f10 = this.maxX;
            }
        }
        boolean z7 = this.videoSizeSet && (aspectRatioFrameLayout = this.aspectRatioFrameLayout) != null && aspectRatioFrameLayout.getVisibility() == 0;
        if (this.centerImage.hasBitmapImage() || (z7 && this.textureUploaded)) {
            canvas.save();
            int i22 = i4 / 2;
            int i23 = i3 / 2;
            canvas.translate(getAdditionX(this.currentEditMode) + i22, i23 + getAdditionY(this.currentEditMode));
            canvas.translate(f10, f44 + (this.currentEditMode != 3 ? this.currentPanTranslationY : BitmapDescriptorFactory.HUE_RED));
            float f51 = f3 - f12;
            canvas.scale(f51, f51);
            float f52 = f9;
            canvas.rotate(f52);
            if (z3) {
                this.imageBoundsMatrix.preTranslate(i22 + getAdditionX(this.currentEditMode), i23 + getAdditionY(this.currentEditMode));
                this.imageBoundsMatrix.preTranslate(f10, f44 + (this.currentEditMode != 3 ? this.currentPanTranslationY : BitmapDescriptorFactory.HUE_RED));
                this.imageBoundsMatrix.preScale(f51, f51, f7, f7);
                this.imageBoundsMatrix.preRotate(f52);
            }
            if (this.currentEditMode == 3 && this.photoPaintView != null) {
                float emojiPadding = ((r5 - this.photoPaintView.getEmojiPadding(Math.abs((AndroidUtilities.displaySize.y + AndroidUtilities.statusBarHeight) - getContainerViewHeight(true, 0)) < AndroidUtilities.dp(20.0f))) - getContainerViewHeight(false, 0)) / 2.0f;
                canvas.translate(f7, (1.0f - this.photoPaintView.adjustPanLayoutHelperProgress()) * emojiPadding);
                if (z3) {
                    this.imageBoundsMatrix.preTranslate(f7, emojiPadding * (1.0f - this.photoPaintView.adjustPanLayoutHelperProgress()));
                }
            }
            if (z7 && this.textureUploaded && this.videoSizeSet) {
                View view = this.usedSurfaceView ? this.videoSurfaceView : this.videoTextureView;
                bitmapWidth = view.getMeasuredWidth();
                bitmapHeight = view.getMeasuredHeight();
            } else {
                bitmapWidth = this.centerImage.getBitmapWidth();
                bitmapHeight = this.centerImage.getBitmapHeight();
            }
            float f53 = i4;
            float f54 = bitmapWidth;
            float f55 = f53 / f54;
            float f56 = i3;
            int i24 = bitmapWidth;
            float f57 = bitmapHeight;
            int i25 = bitmapHeight;
            float f58 = f56 / f57;
            float fMin5 = Math.min(f55, f58);
            float f59 = f58;
            i7 = i3;
            float f60 = (int) (f54 * fMin5);
            float f61 = (int) (f57 * fMin5);
            if (this.pipAnimationInProgress || ((z7 && ((this.textureUploaded || this.videoSizeSet) && this.videoCrossfadeStarted && this.videoCrossfadeAlpha == 1.0f)) || (this.videoFrameBitmap != null && this.isCurrentVideo))) {
                f13 = f51;
                f14 = f57;
                imageReceiver3 = imageReceiver2;
                f15 = f54;
                i8 = i4;
                f16 = f55;
                f17 = f60;
            } else {
                float bitmapWidth3 = this.centerImage.getBitmapWidth();
                float bitmapHeight3 = this.centerImage.getBitmapHeight();
                if (this.isCurrentVideo && this.currentEditMode == 0) {
                    i8 = i4;
                    if (this.sendPhotoType == 1) {
                        fMin = getCropFillScale(false);
                    }
                    f17 = bitmapWidth3 * fMin;
                    f61 = fMin * bitmapHeight3;
                    if (this.isCurrentVideo) {
                        f13 = f51;
                        f14 = f57;
                        imageReceiver3 = imageReceiver2;
                        f15 = f54;
                        f16 = f55;
                    } else {
                        if (z3) {
                            imageReceiver3 = imageReceiver2;
                            this.imageBoundsMatrix.preTranslate((-f17) / 2.0f, (-f61) / 2.0f);
                            float[] fArr = this.imageBoundsPoints;
                            fArr[0] = 0.0f;
                            fArr[1] = 0.0f;
                            fArr[2] = f17;
                            fArr[3] = 0.0f;
                            fArr[4] = f17;
                            fArr[5] = f61;
                            fArr[6] = 0.0f;
                            fArr[7] = f61;
                            this.imageBoundsMatrix.mapPoints(fArr);
                            RectF rectF = this.imageBounds;
                            float[] fArr2 = this.imageBoundsPoints;
                            f13 = f51;
                            float fMin6 = Math.min(fArr2[0], fArr2[2]);
                            float[] fArr3 = this.imageBoundsPoints;
                            float fMin7 = Math.min(fMin6, Math.min(fArr3[4], fArr3[6]));
                            float[] fArr4 = this.imageBoundsPoints;
                            f15 = f54;
                            float fMin8 = Math.min(fArr4[1], fArr4[3]);
                            float[] fArr5 = this.imageBoundsPoints;
                            float fMin9 = Math.min(fMin8, Math.min(fArr5[5], fArr5[7]));
                            float[] fArr6 = this.imageBoundsPoints;
                            f14 = f57;
                            float fMax = Math.max(fArr6[0], fArr6[2]);
                            float[] fArr7 = this.imageBoundsPoints;
                            float fMax2 = Math.max(fMax, Math.max(fArr7[4], fArr7[6]));
                            float[] fArr8 = this.imageBoundsPoints;
                            f16 = f55;
                            float fMax3 = Math.max(fArr8[1], fArr8[3]);
                            float[] fArr9 = this.imageBoundsPoints;
                            rectF.set(fMin7, fMin9, fMax2, Math.max(fMax3, Math.max(fArr9[5], fArr9[7])));
                            f33 = this.centerImageInsideBlur[1].set(this.blurBounds.intersect(this.imageBounds));
                        } else {
                            f13 = f51;
                            f14 = f57;
                            imageReceiver3 = imageReceiver2;
                            f15 = f54;
                            f16 = f55;
                            f33 = 1.0f;
                        }
                        if (this.videoCrossfadeAlpha >= 1.0f || (bitmap3 = this.centerBlur.getBitmap(this.centerImage)) == null) {
                            f34 = BitmapDescriptorFactory.HUE_RED;
                        } else {
                            canvas.save();
                            storyBlurDrawer2.paint.setShader(null);
                            storyBlurDrawer2.paint.setAlpha((int) (f33 * 255.0f * f11 * (1.0f - this.videoCrossfadeAlpha) * f6));
                            canvas.scale(bitmap3.getWidth() / (bitmap3.getWidth() - 3.0f), bitmap3.getHeight() / (bitmap3.getHeight() - 3.0f));
                            canvas.translate((-f17) / 2.0f, (-f61) / 2.0f);
                            canvas.scale((f17 * 1.0f) / bitmap3.getWidth(), (f61 * 1.0f) / bitmap3.getHeight());
                            f34 = BitmapDescriptorFactory.HUE_RED;
                            if (z) {
                                int i26 = (int) BitmapDescriptorFactory.HUE_RED;
                                canvas.clipRect(i26, i26, bitmap3.getWidth() - i26, bitmap3.getHeight() - i26);
                            }
                            canvas.drawBitmap(bitmap3, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, storyBlurDrawer2.paint);
                            canvas.restore();
                        }
                        if (this.videoCrossfadeAlpha > f34 && (bitmap2 = this.blurManager.getBitmap()) != null) {
                            canvas.save();
                            storyBlurDrawer2.paint.setShader(null);
                            storyBlurDrawer2.paint.setAlpha((int) (f33 * 255.0f * f11 * this.videoCrossfadeAlpha * f6));
                            canvas.scale(bitmap2.getWidth() / (bitmap2.getWidth() - 3.0f), bitmap2.getHeight() / (bitmap2.getHeight() - 3.0f));
                            canvas.translate((-f17) / 2.0f, (-f61) / 2.0f);
                            canvas.scale((f17 * 1.0f) / bitmap2.getWidth(), (f61 * 1.0f) / bitmap2.getHeight());
                            if (z) {
                                int i27 = (int) BitmapDescriptorFactory.HUE_RED;
                                canvas.clipRect(i27, i27, bitmap2.getWidth() - i27, bitmap2.getHeight() - i27);
                            }
                            canvas.drawBitmap(bitmap2, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, storyBlurDrawer2.paint);
                            canvas.restore();
                        }
                        z4 = true;
                        if (this.imagesArrLocals.isEmpty() && ((i13 = this.currentEditMode) == 3 || (i14 = this.switchingToMode) == 3 || (this.sendPhotoType != 1 ? !((this.imageMoveAnimation == null || i14 == -1) && i13 != 0 && i13 != 1 && i14 == -1) : !(i14 != 0 && (i13 == 3 || i13 == 2))))) {
                            f18 = f11;
                            f19 = f6;
                        } else {
                            int orientation = this.cropTransform.getOrientation();
                            if (orientation == 90 || orientation == 270) {
                                i9 = i24;
                                i10 = i25;
                            } else {
                                i10 = i24;
                                i9 = i25;
                            }
                            if (this.sendPhotoType == 1 || (this.currentEditMode != 3 && this.switchingToMode != 3)) {
                                if (this.imageMoveAnimation == null || (i11 = this.switchingToMode) == -1) {
                                    int i28 = this.currentEditMode;
                                    f24 = (i28 == 2 || i28 == 3) ? BitmapDescriptorFactory.HUE_RED : 1.0f;
                                    float cropPw = this.cropTransform.getCropPw();
                                    float cropPh = this.cropTransform.getCropPh();
                                    f25 = i10;
                                    f26 = 1.0f - f24;
                                    f27 = i9;
                                    f28 = (int) ((cropPw + ((1.0f - cropPw) * f26)) * f25);
                                    f29 = f53 / f28;
                                    f30 = (int) ((cropPh + ((1.0f - cropPh) * f26)) * f27);
                                    if (f29 * f30 > f56) {
                                        f29 = f56 / f30;
                                    }
                                    f19 = f6;
                                    f18 = f11;
                                    if (this.sendPhotoType != 1 && ((this.currentEditMode != 1 || this.switchingToMode == 0) && this.editState.cropState != null)) {
                                        float f62 = f28 * f29;
                                        float f63 = f30 * f29;
                                        if (f16 * f14 <= f56) {
                                            f59 = f16;
                                        }
                                        float f64 = f62 + ((((f15 * f59) / f13) - f62) * f26);
                                        float f65 = f63 + ((((f14 * f59) / f13) - f63) * f26);
                                        canvas.clipRect((-f64) / 2.0f, (-f65) / 2.0f, f64 / 2.0f, f65 / 2.0f);
                                    }
                                    if (this.sendPhotoType != 1 || this.cropTransform.hasViewTransform()) {
                                        if (this.currentEditMode != 1 || this.sendPhotoType == 1) {
                                            textureView = this.videoTextureView;
                                            if (textureView != null) {
                                                textureView.setScaleX(this.cropTransform.isMirrored() ? -1.0f : 1.0f);
                                                FirstFrameView firstFrameView = this.firstFrameView;
                                                if (firstFrameView != null) {
                                                    firstFrameView.setScaleX(this.videoTextureView.getScaleX());
                                                }
                                            }
                                            float scale = this.cropTransform.getScale() / (((this.cropTransform.getTrueCropScale() - 1.0f) * f26) + 1.0f);
                                            f31 = f53 / f25;
                                            if (f31 * f27 > f56) {
                                                f31 = f56 / f27;
                                            }
                                            f32 = scale * (f31 / fMin5);
                                            if (this.sendPhotoType == 1) {
                                                if (this.currentEditMode == 3 || (i12 = this.switchingToMode) == 3) {
                                                    minScale = ((this.cropTransform.getMinScale() - 1.0f) * f26) + 1.0f;
                                                } else if (i12 == 0) {
                                                    minScale = this.cropTransform.getMinScale();
                                                }
                                                f32 /= minScale;
                                            }
                                        } else {
                                            TextureView textureView2 = this.videoTextureView;
                                            if (textureView2 != null) {
                                                MediaController.CropState cropState2 = this.editState.cropState;
                                                textureView2.setScaleX((cropState2 == null || !cropState2.mirrored) ? 1.0f : -1.0f);
                                                FirstFrameView firstFrameView2 = this.firstFrameView;
                                                if (firstFrameView2 != null) {
                                                    firstFrameView2.setScaleX(this.videoTextureView.getScaleX());
                                                }
                                            }
                                            MediaController.CropState cropState3 = this.editState.cropState;
                                            float f66 = cropState3 != null ? cropState3.cropScale : 1.0f;
                                            f32 = f66 * ((f29 / fMin5) / (((f66 - 1.0f) * f26) + 1.0f));
                                        }
                                        canvas.translate(this.cropTransform.getCropAreaX() * f24, this.cropTransform.getCropAreaY() * f24);
                                        canvas.scale(f32, f32);
                                        canvas.translate(this.cropTransform.getCropPx() * f25 * fMin5 * f24, this.cropTransform.getCropPy() * f27 * fMin5 * f24);
                                        if (z3) {
                                            this.imageBoundsMatrix.preTranslate(this.cropTransform.getCropAreaX() * f24, this.cropTransform.getCropAreaY() * f24);
                                            this.imageBoundsMatrix.preScale(f32, f32);
                                            this.imageBoundsMatrix.preTranslate(this.cropTransform.getCropPx() * f25 * fMin5 * f24, this.cropTransform.getCropPy() * f27 * fMin5 * f24);
                                        }
                                        rotation = this.cropTransform.getRotation() + orientation;
                                        if (rotation > 180.0f) {
                                            rotation -= 360.0f;
                                        }
                                        if (this.sendPhotoType == 1 || !(this.currentEditMode == 3 || this.switchingToMode == 3)) {
                                            rotation *= f24;
                                            canvas.rotate(rotation);
                                            if (z3) {
                                                this.imageBoundsMatrix.preRotate(rotation);
                                            }
                                        } else {
                                            canvas.rotate(rotation);
                                            if (z3) {
                                            }
                                        }
                                    }
                                } else {
                                    int i29 = this.currentEditMode;
                                    if (i29 != 1 && i11 != 1 && ((i29 != 2 && i29 != 3) || i11 != -1)) {
                                        f24 = this.animationValue;
                                        if (i11 != 0) {
                                            f24 = 1.0f - f24;
                                        }
                                    }
                                    float cropPw2 = this.cropTransform.getCropPw();
                                    float cropPh2 = this.cropTransform.getCropPh();
                                    f25 = i10;
                                    f26 = 1.0f - f24;
                                    f27 = i9;
                                    f28 = (int) ((cropPw2 + ((1.0f - cropPw2) * f26)) * f25);
                                    f29 = f53 / f28;
                                    f30 = (int) ((cropPh2 + ((1.0f - cropPh2) * f26)) * f27);
                                    if (f29 * f30 > f56) {
                                    }
                                    f19 = f6;
                                    f18 = f11;
                                    if (this.sendPhotoType != 1) {
                                        float f622 = f28 * f29;
                                        float f632 = f30 * f29;
                                        if (f16 * f14 <= f56) {
                                        }
                                        float f642 = f622 + ((((f15 * f59) / f13) - f622) * f26);
                                        float f652 = f632 + ((((f14 * f59) / f13) - f632) * f26);
                                        canvas.clipRect((-f642) / 2.0f, (-f652) / 2.0f, f642 / 2.0f, f652 / 2.0f);
                                    }
                                    if (this.sendPhotoType != 1) {
                                        if (this.currentEditMode != 1) {
                                            textureView = this.videoTextureView;
                                            if (textureView != null) {
                                            }
                                            float scale2 = this.cropTransform.getScale() / (((this.cropTransform.getTrueCropScale() - 1.0f) * f26) + 1.0f);
                                            f31 = f53 / f25;
                                            if (f31 * f27 > f56) {
                                            }
                                            f32 = scale2 * (f31 / fMin5);
                                            if (this.sendPhotoType == 1) {
                                            }
                                            canvas.translate(this.cropTransform.getCropAreaX() * f24, this.cropTransform.getCropAreaY() * f24);
                                            canvas.scale(f32, f32);
                                            canvas.translate(this.cropTransform.getCropPx() * f25 * fMin5 * f24, this.cropTransform.getCropPy() * f27 * fMin5 * f24);
                                            if (z3) {
                                            }
                                            rotation = this.cropTransform.getRotation() + orientation;
                                            if (rotation > 180.0f) {
                                            }
                                            if (this.sendPhotoType == 1) {
                                                rotation *= f24;
                                                canvas.rotate(rotation);
                                                if (z3) {
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        if (!z4) {
                            storyBlurDrawer2 = storyBlurDrawer;
                        } else if (this.imagesArrLocals.isEmpty()) {
                            zIsMirrored = false;
                            if (zIsMirrored) {
                                f20 = 1.0f;
                                f21 = BitmapDescriptorFactory.HUE_RED;
                                z6 = false;
                            } else {
                                canvas.save();
                                f20 = 1.0f;
                                canvas.scale(-1.0f, 1.0f);
                                f21 = BitmapDescriptorFactory.HUE_RED;
                                z6 = true;
                            }
                            if (f5 > f21) {
                                if (z6) {
                                    f23 = 2.0f;
                                } else {
                                    canvas.save();
                                    f23 = 2.0f;
                                    z6 = true;
                                }
                                canvas.scale(f20 - (f5 * f23), f20);
                                canvas.skew(BitmapDescriptorFactory.HUE_RED, f5 * 4.0f * (f20 - f5) * 0.25f);
                            }
                            photoViewerWebView = this.photoViewerWebView;
                            if (photoViewerWebView != null || !photoViewerWebView.isLoaded()) {
                                if (z3) {
                                    f22 = 1.0f;
                                } else {
                                    this.imageBoundsMatrix.preTranslate((-f17) / 2.0f, (-f61) / 2.0f);
                                    float[] fArr10 = this.imageBoundsPoints;
                                    fArr10[0] = 0.0f;
                                    fArr10[1] = 0.0f;
                                    fArr10[2] = f17;
                                    fArr10[3] = 0.0f;
                                    fArr10[4] = f17;
                                    fArr10[5] = f61;
                                    fArr10[6] = 0.0f;
                                    fArr10[7] = f61;
                                    this.imageBoundsMatrix.mapPoints(fArr10);
                                    RectF rectF2 = this.imageBounds;
                                    float[] fArr11 = this.imageBoundsPoints;
                                    float fMin10 = Math.min(fArr11[0], fArr11[2]);
                                    float[] fArr12 = this.imageBoundsPoints;
                                    float fMin11 = Math.min(fMin10, Math.min(fArr12[4], fArr12[6]));
                                    float[] fArr13 = this.imageBoundsPoints;
                                    float fMin12 = Math.min(fArr13[1], fArr13[3]);
                                    float[] fArr14 = this.imageBoundsPoints;
                                    float fMin13 = Math.min(fMin12, Math.min(fArr14[5], fArr14[7]));
                                    float[] fArr15 = this.imageBoundsPoints;
                                    float fMax4 = Math.max(fArr15[0], fArr15[2]);
                                    float[] fArr16 = this.imageBoundsPoints;
                                    float fMax5 = Math.max(fMax4, Math.max(fArr16[4], fArr16[6]));
                                    float[] fArr17 = this.imageBoundsPoints;
                                    float fMax6 = Math.max(fArr17[1], fArr17[3]);
                                    float[] fArr18 = this.imageBoundsPoints;
                                    rectF2.set(fMin11, fMin13, fMax5, Math.max(fMax6, Math.max(fArr18[5], fArr18[7])));
                                    f22 = this.centerImageInsideBlur[1].set(this.blurBounds.intersect(this.imageBounds));
                                }
                                bitmap = this.blurManager.getBitmap();
                                if (bitmap == null) {
                                    bitmap = this.centerBlur.getBitmap(this.centerImage);
                                }
                                if (bitmap == null) {
                                    storyBlurDrawer2 = storyBlurDrawer;
                                    storyBlurDrawer2.paint.setShader(null);
                                    storyBlurDrawer2.paint.setAlpha((int) (f18 * 255.0f * f22 * f19));
                                    canvas.scale(bitmap.getWidth() / (bitmap.getWidth() - 3.0f), bitmap.getHeight() / (bitmap.getHeight() - 3.0f));
                                    canvas.translate((-f17) / 2.0f, (-f61) / 2.0f);
                                    canvas.scale((f17 * 1.0f) / bitmap.getWidth(), (f61 * 1.0f) / bitmap.getHeight());
                                    if (z) {
                                        int i30 = (int) BitmapDescriptorFactory.HUE_RED;
                                        canvas.clipRect(i30, i30, bitmap.getWidth() - i30, bitmap.getHeight() - i30);
                                    }
                                    canvas.drawBitmap(bitmap, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, storyBlurDrawer2.paint);
                                } else {
                                    storyBlurDrawer2 = storyBlurDrawer;
                                }
                                if (z6) {
                                    canvas.restore();
                                }
                                z4 = true;
                            }
                        } else {
                            if (this.currentEditMode == 1 || this.sendPhotoType == 1) {
                                zIsMirrored = this.cropTransform.isMirrored();
                            } else {
                                MediaController.CropState cropState4 = this.editState.cropState;
                                if (cropState4 != null && cropState4.mirrored) {
                                    zIsMirrored = true;
                                }
                            }
                            if (zIsMirrored) {
                            }
                            if (f5 > f21) {
                            }
                            photoViewerWebView = this.photoViewerWebView;
                            if (photoViewerWebView != null) {
                                if (z3) {
                                }
                                bitmap = this.blurManager.getBitmap();
                                if (bitmap == null) {
                                }
                                if (bitmap == null) {
                                }
                                if (z6) {
                                }
                                z4 = true;
                            }
                        }
                        canvas.restore();
                        z5 = z4;
                    }
                } else {
                    i8 = i4;
                }
                fMin = Math.min(f53 / bitmapWidth3, f56 / bitmapHeight3);
                f17 = bitmapWidth3 * fMin;
                f61 = fMin * bitmapHeight3;
                if (this.isCurrentVideo) {
                }
            }
            z4 = false;
            if (this.imagesArrLocals.isEmpty()) {
                if (this.imagesArrLocals.isEmpty() && ((i13 = this.currentEditMode) == 3 || (i14 = this.switchingToMode) == 3 || (this.sendPhotoType != 1 ? !((this.imageMoveAnimation == null || i14 == -1) && i13 != 0 && i13 != 1 && i14 == -1) : !(i14 != 0 && (i13 == 3 || i13 == 2))))) {
                }
                if (!z4) {
                }
                canvas.restore();
                z5 = z4;
            }
        } else {
            imageReceiver3 = imageReceiver2;
            i8 = i4;
            f19 = f6;
            i7 = i3;
            z5 = false;
        }
        if (!z5 && this.animatingImageView.getVisibility() == 0) {
            canvas.save();
            if (this.padImageForHorizontalInsets) {
                canvas.translate((getRightInset() / 2) - (getLeftInset() / 2), BitmapDescriptorFactory.HUE_RED);
            }
            canvas.translate(this.animatingImageView.getX(), this.animatingImageView.getY());
            canvas.scale(this.animatingImageView.getScaleX(), this.animatingImageView.getScaleY(), this.animatingImageView.getPivotX(), this.animatingImageView.getPivotY());
            Bitmap bitmap6 = this.centerBlur.getBitmap(this.animatingImageView.getBitmapHolder());
            if (bitmap6 != null) {
                canvas.save();
                storyBlurDrawer2.paint.setShader(null);
                storyBlurDrawer2.paint.setAlpha((int) (f19 * 255.0f));
                canvas.scale((this.animatingImageView.getWidth() * 1.0f) / bitmap6.getWidth(), (this.animatingImageView.getHeight() * 1.0f) / bitmap6.getHeight());
                canvas.scale(bitmap6.getWidth() / (bitmap6.getWidth() - 3.0f), bitmap6.getHeight() / (bitmap6.getHeight() - 3.0f), bitmap6.getWidth() / 2.0f, bitmap6.getHeight() / 2.0f);
                canvas.drawBitmap(bitmap6, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, storyBlurDrawer2.paint);
                if (z) {
                    int i31 = (int) BitmapDescriptorFactory.HUE_RED;
                    canvas.clipRect(i31, i31, bitmap6.getWidth() - i31, bitmap6.getHeight() - i31);
                }
                canvas.restore();
            }
            canvas.restore();
        }
        ImageReceiver imageReceiver7 = imageReceiver3;
        if (imageReceiver7 != this.leftImage) {
            f35 = 1.0f;
        } else {
            float f67 = z3 ? this.centerImageInsideBlur[0].set(1.0f, true) : 1.0f;
            if (imageReceiver7 != null && imageReceiver7.hasBitmapImage()) {
                canvas.save();
                canvas.translate(i8 / 2, i7 / 2);
                int i32 = i8;
                float f68 = i32;
                canvas.translate(((-(((this.scale + 1.0f) * f68) + AndroidUtilities.dp(30.0f))) / 2.0f) + f43, BitmapDescriptorFactory.HUE_RED);
                int bitmapWidth4 = imageReceiver7.getBitmapWidth();
                int bitmapHeight4 = imageReceiver7.getBitmapHeight();
                if (this.leftImageIsVideo || this.leftCropState == null || !this.leftCropTransform.hasViewTransform()) {
                    i15 = bitmapHeight4;
                    imageReceiver4 = imageReceiver7;
                    f36 = f67;
                    f35 = 1.0f;
                } else {
                    i15 = bitmapHeight4;
                    imageReceiver4 = imageReceiver7;
                    f36 = f67;
                    f35 = 1.0f;
                    applyCrop(canvas, i32, i7, bitmapWidth4, bitmapHeight4, f3, this.leftCropTransform, this.leftCropState);
                }
                float f69 = bitmapWidth4;
                float f70 = i15;
                float fMin14 = Math.min(f68 / f69, i7 / f70);
                int i33 = (int) (f69 * fMin14);
                int i34 = (int) (f70 * fMin14);
                if (this.imagesArrLocals.isEmpty()) {
                    zIsMirrored2 = false;
                    if (zIsMirrored2) {
                        canvas.scale(-1.0f, f35);
                    }
                    bitmap4 = this.leftBlur.getBitmap(imageReceiver4);
                    if (bitmap4 != null) {
                        storyBlurDrawer2.paint.setShader(null);
                        storyBlurDrawer2.paint.setAlpha((int) (f19 * 255.0f * f36));
                        canvas.scale(bitmap4.getWidth() / (bitmap4.getWidth() - 3.0f), bitmap4.getHeight() / (bitmap4.getHeight() - 3.0f));
                        canvas.translate((-i33) / 2, (-i34) / 2);
                        canvas.scale((i33 * f35) / bitmap4.getWidth(), (i34 * f35) / bitmap4.getHeight());
                        if (z) {
                            int i35 = (int) BitmapDescriptorFactory.HUE_RED;
                            canvas.clipRect(i35, i35, bitmap4.getWidth() - i35, bitmap4.getHeight() - i35);
                        }
                        canvas.drawBitmap(bitmap4, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, storyBlurDrawer2.paint);
                    }
                    canvas.restore();
                } else {
                    if (this.currentEditMode == 1 || this.sendPhotoType == 1) {
                        zIsMirrored2 = this.leftCropTransform.isMirrored();
                    } else {
                        MediaController.CropState cropState5 = this.leftCropState;
                        if (cropState5 != null && cropState5.mirrored) {
                            zIsMirrored2 = true;
                        }
                    }
                    if (zIsMirrored2) {
                    }
                    bitmap4 = this.leftBlur.getBitmap(imageReceiver4);
                    if (bitmap4 != null) {
                    }
                    canvas.restore();
                }
            }
        }
        canvas.restoreToCount(i5);
        if (i2 != 0) {
            storyBlurDrawer2.paint.setColor(i2);
            storyBlurDrawer2.paint.setAlpha((int) (r0.getAlpha() * AndroidUtilities.lerp(0.7f, f35, f19)));
            canvas.drawPaint(storyBlurDrawer2.paint);
        }
    }

    public void enableStickerMode(TLRPC.Document document, boolean z, Utilities.Callback2 callback2) {
        this.replacedSticker = document;
        this.stickerEmpty = z;
        this.stickerEmptySent = false;
        this.customStickerHandler = callback2;
        this.rotate = BitmapDescriptorFactory.HUE_RED;
        this.animateToRotate = BitmapDescriptorFactory.HUE_RED;
        if (this.stickerMakerView != null) {
            BlurButton blurButton = this.outlineBtn;
            if (blurButton != null) {
                blurButton.setActive(false, false);
            }
            this.stickerMakerView.clean();
            ArrayList arrayList = this.selectedEmojis;
            if (arrayList != null) {
                arrayList.clear();
            }
        }
        if (this.replacedSticker != null) {
            ArrayList arrayList2 = this.selectedEmojis;
            if (arrayList2 == null) {
                this.selectedEmojis = new ArrayList();
            } else {
                arrayList2.clear();
            }
            ArrayList<String> arrayListFindStickerEmoticons = MessageObject.findStickerEmoticons(document, Integer.valueOf(this.currentAccount));
            if (arrayListFindStickerEmoticons != null) {
                this.selectedEmojis.addAll(arrayListFindStickerEmoticons);
            }
        }
        BlurButton blurButton2 = this.cutOutBtn;
        if (blurButton2 != null) {
            blurButton2.clean();
        }
        showStickerMode(true, false);
        ImageView imageView = this.tuneItem;
        if (imageView != null) {
            imageView.setAlpha(this.stickerEmpty ? 0.4f : 1.0f);
        }
    }

    public void exitFromPip() {
        if (this.isInline) {
            if (Instance != null) {
                Instance.closePhoto(false, true);
            }
            PhotoViewerWebView photoViewerWebView = this.photoViewerWebView;
            if (photoViewerWebView != null) {
                photoViewerWebView.exitFromPip();
            }
            Instance = PipInstance;
            PipInstance = null;
            if (this.photoViewerWebView == null) {
                this.switchingInlineMode = true;
                Bitmap bitmap = this.currentBitmap;
                if (bitmap != null) {
                    bitmap.recycle();
                    this.currentBitmap = null;
                }
                this.changingTextureView = true;
            }
            this.isInline = false;
            View view = this.usedSurfaceView ? this.videoSurfaceView : this.videoTextureView;
            if (this.photoViewerWebView == null && view != null) {
                AndroidUtilities.removeFromParent(view);
                view.setVisibility(4);
                this.aspectRatioFrameLayout.addView(view);
            }
            if (ApplicationLoader.mainInterfacePaused) {
                try {
                    this.parentActivity.startService(new Intent(ApplicationLoader.applicationContext, (Class<?>) BringAppForegroundService.class));
                } catch (Throwable th) {
                    FileLog.e(th);
                }
            }
            if (this.photoViewerWebView != null) {
                this.clippingImageProgress = BitmapDescriptorFactory.HUE_RED;
            } else if (Build.VERSION.SDK_INT < 21 || view == null) {
                PipVideoOverlay.dismiss(true);
            } else {
                this.pipAnimationInProgress = true;
                org.telegram.ui.Components.Rect pipRect = PipVideoOverlay.getPipRect(false, this.aspectRatioFrameLayout.getAspectRatio());
                final float f = pipRect.width / this.textureImageView.getLayoutParams().width;
                this.textureImageView.setScaleX(f);
                this.textureImageView.setScaleY(f);
                this.textureImageView.setTranslationX(pipRect.x);
                this.textureImageView.setTranslationY(pipRect.y);
                view.setScaleX(f);
                view.setScaleY(f);
                view.setTranslationX(pipRect.x - this.aspectRatioFrameLayout.getX());
                view.setTranslationY(pipRect.y - this.aspectRatioFrameLayout.getY());
                FirstFrameView firstFrameView = this.firstFrameView;
                if (firstFrameView != null) {
                    firstFrameView.setScaleX(f);
                    this.firstFrameView.setScaleY(f);
                    this.firstFrameView.setTranslationX(view.getTranslationX());
                    this.firstFrameView.setTranslationY(view.getTranslationY());
                }
                this.inlineOutAnimationProgress = BitmapDescriptorFactory.HUE_RED;
                ViewOutlineProvider viewOutlineProvider = new ViewOutlineProvider() { // from class: org.telegram.ui.PhotoViewer.47
                    @Override // android.view.ViewOutlineProvider
                    public void getOutline(View view2, Outline outline) {
                        outline.setRoundRect(0, 0, view2.getMeasuredWidth(), view2.getMeasuredHeight(), (1.0f - PhotoViewer.this.inlineOutAnimationProgress) * AndroidUtilities.dp(10.0f) * (1.0f / f));
                    }
                };
                view.setOutlineProvider(viewOutlineProvider);
                view.setClipToOutline(true);
                this.textureImageView.setOutlineProvider(viewOutlineProvider);
                this.textureImageView.setClipToOutline(true);
                FirstFrameView firstFrameView2 = this.firstFrameView;
                if (firstFrameView2 != null) {
                    firstFrameView2.setOutlineProvider(viewOutlineProvider);
                    this.firstFrameView.setClipToOutline(true);
                }
            }
            try {
                this.isVisible = true;
                this.isVisibleOrAnimating = true;
                ((WindowManager) this.parentActivity.getSystemService("window")).addView(this.windowView, this.windowLayoutParams);
                onShowView();
                PlaceProviderObject placeProviderObject = this.currentPlaceObject;
                if (placeProviderObject != null) {
                    placeProviderObject.imageReceiver.setVisible(false, false);
                }
            } catch (Exception e) {
                FileLog.e(e);
            }
            if (this.usedSurfaceView) {
                ExoPlayer exoPlayer = this.videoPlayer.player;
                if (exoPlayer != null) {
                    exoPlayer.setVideoTextureView(null);
                }
                this.videoPlayer.setSurfaceView(this.videoSurfaceView);
                this.videoSurfaceView.setVisibility(4);
                this.waitingForFirstTextureUpload = 2;
                this.changingTextureView = false;
                this.containerView.invalidate();
                if (Build.VERSION.SDK_INT < 21) {
                    return;
                }
            } else if (Build.VERSION.SDK_INT < 21) {
                return;
            }
            this.waitingForDraw = 4;
        }
    }

    public float getAnimationValue() {
        return this.animationValue;
    }

    public int getClassGuid() {
        return this.classGuid;
    }

    public int getCurrentIndex() {
        return this.currentIndex;
    }

    public long getCurrentPosition() {
        VideoPlayer videoPlayer = this.videoPlayer;
        if (videoPlayer == null) {
            return -1L;
        }
        return videoPlayer.getCurrentPosition();
    }

    public float getCurrentVideoSpeed() {
        return this.currentVideoSpeed;
    }

    public List getImagesArrLocals() {
        return this.imagesArrLocals;
    }

    public Activity getParentActivity() {
        return this.parentActivity;
    }

    public int getSelectionLength() {
        if (getCaptionView().editText != null) {
            return getCaptionView().getSelectionLength();
        }
        return 0;
    }

    public VideoPlayer getVideoPlayer() {
        return this.videoPlayer;
    }

    public VideoPlayerRewinder getVideoPlayerRewinder() {
        return this.videoPlayerRewinder;
    }

    public SurfaceView getVideoSurfaceView() {
        return this.videoSurfaceView;
    }

    public TextureView getVideoTextureView() {
        return this.videoTextureView;
    }

    public void injectVideoPlayer(VideoPlayer videoPlayer) {
        this.injectingVideoPlayer = videoPlayer;
    }

    public void injectVideoPlayerSurface(SurfaceTexture surfaceTexture) {
        this.injectingVideoPlayerSurface = surfaceTexture;
    }

    public void injectVideoPlayerToMediaController() {
        if (this.videoPlayer.isPlaying()) {
            if (this.playerLooping) {
                this.videoPlayer.setLooping(false);
            }
            MediaController.getInstance().injectVideoPlayer(this.videoPlayer, this.currentMessageObject);
            this.videoPlayer = null;
        }
    }

    public boolean isInjectingVideoPlayer() {
        return this.injectingVideoPlayer != null;
    }

    public boolean isOpenedFullScreenVideo() {
        return this.openedFullScreenVideo;
    }

    public boolean isVisible() {
        return this.isVisible && this.placeProvider != null;
    }

    public boolean isVisibleOrAnimating() {
        return this.isVisibleOrAnimating;
    }

    public void mergeImages(String str, String str2, Bitmap bitmap, Bitmap bitmap2, float f, boolean z) {
        mergeImages(str, str2, bitmap, bitmap2, getCompressFormat(), f, z);
    }

    public void onConfigurationChanged(Configuration configuration) {
    }

    /* JADX WARN: Removed duplicated region for block: B:32:0x0060  */
    /* JADX WARN: Removed duplicated region for block: B:64:0x0156 A[PHI: r3
      0x0156: PHI (r3v19 float) = (r3v14 float), (r3v15 float) binds: [B:63:0x0154, B:66:0x015c] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:70:0x0165 A[PHI: r3
      0x0165: PHI (r3v18 float) = (r3v16 float), (r3v17 float) binds: [B:69:0x0163, B:72:0x016b] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:71:0x0167  */
    @Override // org.telegram.ui.Components.GestureDetector2.OnDoubleTapListener
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public boolean onDoubleTap(MotionEvent motionEvent) {
        boolean z;
        float f;
        PhotoViewerWebView photoViewerWebView;
        long j = 0;
        if ((this.videoPlayer != null || ((photoViewerWebView = this.photoViewerWebView) != null && photoViewerWebView.isControllable())) && this.videoPlayerControlVisible) {
            long currentVideoPosition = getCurrentVideoPosition();
            long videoDuration = getVideoDuration();
            float x = motionEvent.getX();
            int containerViewWidth = getContainerViewWidth() / 3;
            float f2 = containerViewWidth * 2;
            if (canDoubleTapSeekVideo(motionEvent)) {
                long j2 = x >= f2 ? currentVideoPosition + 10000 : x < ((float) containerViewWidth) ? currentVideoPosition - 10000 : currentVideoPosition;
                if (currentVideoPosition != j2) {
                    if (j2 > videoDuration) {
                        j = videoDuration;
                    } else {
                        if (j2 < 0) {
                            z = j2 >= -9000;
                            if (z) {
                                this.videoForwardDrawable.setOneShootAnimation(true);
                                this.videoForwardDrawable.setLeftSide(x < ((float) containerViewWidth));
                                this.videoForwardDrawable.addTime(10000L);
                                seekVideoOrWebTo(j);
                                this.containerView.invalidate();
                                this.videoPlayerSeekbar.setProgress(j / videoDuration, true);
                                this.videoPlayerSeekbarView.invalidate();
                            }
                            return true;
                        }
                        j = j2;
                    }
                    if (z) {
                    }
                    return true;
                }
            }
        }
        if (!this.canZoom || ((this.scale == 1.0f && (this.translationY != BitmapDescriptorFactory.HUE_RED || this.translationX != BitmapDescriptorFactory.HUE_RED)) || this.animationStartTime != 0 || this.animationInProgress != 0)) {
            return false;
        }
        PhotoProgressView photoProgressView = this.photoProgressViews[0];
        if (photoProgressView != null && photoProgressView.isVisible() && this.photoProgressViews[0].backgroundState != -1 && Math.sqrt(Math.pow((AndroidUtilities.displaySize.x / 2.0f) - motionEvent.getX(), 2.0d) + Math.pow(((AndroidUtilities.displaySize.y + AndroidUtilities.statusBarHeight) / 2.0f) - motionEvent.getY(), 2.0d)) < AndroidUtilities.dp(40.0f)) {
            return false;
        }
        if (this.scale == 1.0f) {
            float x2 = (motionEvent.getX() - (getContainerViewWidth() / 2)) - (((motionEvent.getX() - (getContainerViewWidth() / 2)) - this.translationX) * (3.0f / this.scale));
            float y = (motionEvent.getY() - (getContainerViewHeight() / 2)) - (((motionEvent.getY() - (getContainerViewHeight() / 2)) - this.translationY) * (3.0f / this.scale));
            updateMinMax(3.0f);
            float f3 = this.minX;
            if (x2 < f3) {
                x2 = f3;
                f = this.minY;
                if (y >= f) {
                    y = f;
                    animateTo(3.0f, x2, y, true);
                } else {
                    f = this.maxY;
                    if (y > f) {
                    }
                    animateTo(3.0f, x2, y, true);
                }
            } else {
                f3 = this.maxX;
                if (x2 > f3) {
                }
                f = this.minY;
                if (y >= f) {
                }
            }
        } else {
            animateTo(1.0f, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, true);
        }
        this.doubleTap = true;
        hidePressedDrawables();
        return true;
    }

    @Override // org.telegram.ui.Components.GestureDetector2.OnDoubleTapListener
    public boolean onDoubleTapEvent(MotionEvent motionEvent) {
        return false;
    }

    @Override // org.telegram.ui.Components.GestureDetector2.OnGestureListener
    public boolean onDown(MotionEvent motionEvent) {
        if (!this.doubleTap && this.checkImageView.getVisibility() != 0) {
            boolean[] zArr = this.drawPressedDrawable;
            if (!zArr[0] && !zArr[1]) {
                float x = motionEvent.getX();
                if (x < Math.min(135, this.containerView.getMeasuredWidth() / 8)) {
                    if (this.leftImage.hasImageSet()) {
                        this.drawPressedDrawable[0] = true;
                        this.containerView.invalidate();
                    }
                } else if (x > this.containerView.getMeasuredWidth() - r0 && this.rightImage.hasImageSet()) {
                    this.drawPressedDrawable[1] = true;
                    this.containerView.invalidate();
                }
            }
        }
        return false;
    }

    @Override // org.telegram.ui.Components.GestureDetector2.OnGestureListener
    public boolean onFling(MotionEvent motionEvent, MotionEvent motionEvent2, float f, float f2) {
        if (this.scale == 1.0f || this.sendPhotoType == 11) {
            return false;
        }
        this.scroller.abortAnimation();
        this.scroller.fling(Math.round(this.translationX), Math.round(this.translationY), Math.round(f), Math.round(f2), (int) this.minX, (int) this.maxX, (int) this.minY, (int) this.maxY);
        this.containerView.postInvalidate();
        return false;
    }

    public void onLongPress() {
        VideoPlayer videoPlayer = this.videoPlayer;
        if (videoPlayer == null || this.scale > 1.35f) {
            return;
        }
        long currentPosition = videoPlayer.getCurrentPosition();
        long duration = this.videoPlayer.getDuration();
        if (currentPosition == -9223372036854775807L || duration < 8000) {
            return;
        }
        float f = this.longPressX;
        boolean z = false;
        int containerViewWidth = getContainerViewWidth() / 3;
        if (duration <= 180000) {
            this.videoPlayerRewinder.startRewind(this.videoPlayer, f > ((float) containerViewWidth), this.longPressX, this.currentVideoSpeed, this.seekSpeedDrawable);
            return;
        }
        if (f >= containerViewWidth * 2) {
            z = true;
        } else if (f >= containerViewWidth) {
            return;
        }
        this.longVideoPlayerRewinder.startRewind(this.videoPlayer, z, this.currentVideoSpeed);
    }

    @Override // org.telegram.ui.Components.GestureDetector2.OnGestureListener
    public void onLongPress(MotionEvent motionEvent) {
    }

    public void onPause() {
        if (this.currentAnimation != null) {
            closePhoto(false, false);
            return;
        }
        if (this.lastTitle != null) {
            closeCaptionEnter(true);
        }
        VideoPlayer videoPlayer = this.videoPlayer;
        if (videoPlayer == null || !this.playerLooping) {
            return;
        }
        videoPlayer.setLooping(allowLoopingOnPause());
    }

    public void onResume() {
        redraw(0);
        VideoPlayer videoPlayer = this.videoPlayer;
        if (videoPlayer != null) {
            videoPlayer.seekTo(videoPlayer.getCurrentPosition() + 1);
            if (this.playerLooping) {
                this.videoPlayer.setLooping(true);
            }
        }
        LPhotoPaintView lPhotoPaintView = this.photoPaintView;
        if (lPhotoPaintView != null) {
            lPhotoPaintView.onResume();
        }
    }

    @Override // org.telegram.ui.Components.GestureDetector2.OnGestureListener
    public boolean onScroll(MotionEvent motionEvent, MotionEvent motionEvent2, float f, float f2) {
        return false;
    }

    @Override // org.telegram.ui.Components.GestureDetector2.OnGestureListener
    public void onShowPress(MotionEvent motionEvent) {
    }

    @Override // org.telegram.ui.Components.GestureDetector2.OnDoubleTapListener
    public boolean onSingleTapConfirmed(MotionEvent motionEvent) throws Resources.NotFoundException {
        PhotoViewerWebView photoViewerWebView;
        MessageObject messageObject;
        MessageObject messageObject2;
        if (this.discardTap) {
            return false;
        }
        float x = motionEvent.getX();
        float y = motionEvent.getY();
        if (this.checkImageView.getVisibility() != 0 && SharedConfig.nextMediaTap && this.sendPhotoType != 11 && y > ActionBar.getCurrentActionBarHeight() + AndroidUtilities.statusBarHeight + AndroidUtilities.dp(40.0f)) {
            if (x < Math.min(135, this.containerView.getMeasuredWidth() / 8)) {
                if (this.leftImage.hasImageSet()) {
                    switchToNextIndex(-1, true);
                    return true;
                }
            } else if (x > this.containerView.getMeasuredWidth() - r4 && this.rightImage.hasImageSet()) {
                switchToNextIndex(1, true);
                return true;
            }
        }
        MessageObject messageObject3 = this.currentMessageObject;
        if (messageObject3 != null && messageObject3.isSponsored() && x >= (getContainerViewWidth() - this.centerImage.getImageWidth()) / 2.0f && x <= (getContainerViewWidth() + this.centerImage.getImageWidth()) / 2.0f && y >= (getContainerViewHeight() - this.centerImage.getImageHeight()) / 2.0f && y <= (getContainerViewHeight() + this.centerImage.getImageHeight()) / 2.0f) {
            BaseFragment baseFragment = this.parentFragment;
            if (baseFragment instanceof ChatActivity) {
                ((ChatActivity) baseFragment).logSponsoredClicked(this.currentMessageObject, true, true);
            }
            closePhoto(true, false);
            String str = this.currentMessageObject.sponsoredUrl;
            if (str != null) {
                Context context = LaunchActivity.instance;
                if (context == null) {
                    context = this.activityContext;
                }
                Browser.openUrl(context, Uri.parse(str), true, false, false, null, null, false, MessagesController.getInstance(this.currentAccount).sponsoredLinksInappAllow, false);
            }
            return true;
        }
        PhotoViewerWebView photoViewerWebView2 = this.photoViewerWebView;
        if (photoViewerWebView2 != null && photoViewerWebView2.isControllable() && this.isActionBarVisible) {
            WebView webView = this.photoViewerWebView.getWebView();
            if (x >= webView.getX() && x <= webView.getX() + webView.getWidth() && y >= webView.getY() && y <= webView.getY() + webView.getHeight()) {
                MotionEvent motionEventObtain = MotionEvent.obtain(motionEvent);
                motionEventObtain.setAction(0);
                motionEventObtain.offsetLocation(-webView.getX(), -webView.getY());
                webView.dispatchTouchEvent(motionEventObtain);
                motionEventObtain.setAction(1);
                webView.dispatchTouchEvent(motionEventObtain);
                motionEventObtain.recycle();
                scheduleActionBarHide();
                return true;
            }
        }
        if (this.containerView.getTag() != null) {
            AspectRatioFrameLayout aspectRatioFrameLayout = this.aspectRatioFrameLayout;
            boolean z = (aspectRatioFrameLayout != null && aspectRatioFrameLayout.getVisibility() == 0) || ((photoViewerWebView = this.photoViewerWebView) != null && photoViewerWebView.isControllable());
            if (this.sharedMediaType != 1 || (messageObject2 = this.currentMessageObject) == null) {
                PhotoProgressView photoProgressView = this.photoProgressViews[0];
                if (photoProgressView != null && this.containerView != null) {
                    int i = photoProgressView.backgroundState;
                    if (x >= (getContainerViewWidth() - AndroidUtilities.dp(100.0f)) / 2.0f && x <= (getContainerViewWidth() + AndroidUtilities.dp(100.0f)) / 2.0f && y >= (getContainerViewHeight() - AndroidUtilities.dp(100.0f)) / 2.0f && y <= (getContainerViewHeight() + AndroidUtilities.dp(100.0f)) / 2.0f) {
                        if (z) {
                            if ((i == 3 || i == 4) && this.photoProgressViews[0].isVisible()) {
                                this.manuallyPaused = true;
                                toggleVideoPlayer();
                                return true;
                            }
                        } else if (i > 0 && i <= 3) {
                            onActionClick(true);
                            checkProgress(0, false, true);
                            return true;
                        }
                    }
                }
            } else if (!messageObject2.canPreviewDocument()) {
                float containerViewHeight = (getContainerViewHeight() - AndroidUtilities.dp(360.0f)) / 2.0f;
                if (y >= containerViewHeight && y <= containerViewHeight + AndroidUtilities.dp(360.0f)) {
                    onActionClick(true);
                    return true;
                }
            }
            PhotoViewerWebView photoViewerWebView3 = this.photoViewerWebView;
            if ((photoViewerWebView3 == null || !photoViewerWebView3.isControllable() || this.photoViewerWebView.isPlaying() || !this.isActionBarVisible) && ((messageObject = this.currentMessageObject) == null || !messageObject.isSponsored())) {
                toggleActionBar(!this.isActionBarVisible, true);
            }
        } else {
            int i2 = this.sendPhotoType;
            if (i2 != 0 && i2 != 4) {
                TLRPC.BotInlineResult botInlineResult = this.currentBotInlineResult;
                if (botInlineResult != null && (botInlineResult.type.equals(MediaStreamTrack.VIDEO_TRACK_KIND) || MessageObject.isVideoDocument(this.currentBotInlineResult.document))) {
                    int i3 = this.photoProgressViews[0].backgroundState;
                    if (i3 > 0 && i3 <= 3 && x >= (getContainerViewWidth() - AndroidUtilities.dp(100.0f)) / 2.0f && x <= (getContainerViewWidth() + AndroidUtilities.dp(100.0f)) / 2.0f && y >= (getContainerViewHeight() - AndroidUtilities.dp(100.0f)) / 2.0f && y <= (getContainerViewHeight() + AndroidUtilities.dp(100.0f)) / 2.0f) {
                        onActionClick(true);
                        checkProgress(0, false, true);
                        return true;
                    }
                } else if (this.sendPhotoType == 2 && this.isCurrentVideo) {
                    this.manuallyPaused = true;
                    toggleVideoPlayer();
                }
            } else if (this.isCurrentVideo) {
                VideoPlayer videoPlayer = this.videoPlayer;
                if (videoPlayer != null && !this.muteVideo && i2 != 1) {
                    videoPlayer.setVolume(1.0f);
                }
                this.manuallyPaused = true;
                toggleVideoPlayer();
            } else {
                this.checkImageView.performClick();
            }
        }
        return true;
    }

    @Override // org.telegram.ui.Components.GestureDetector2.OnGestureListener
    public boolean onSingleTapUp(MotionEvent motionEvent) {
        if (!this.canZoom && !this.doubleTapEnabled) {
            return onSingleTapConfirmed(motionEvent);
        }
        FrameLayoutDrawer frameLayoutDrawer = this.containerView;
        if (frameLayoutDrawer != null && frameLayoutDrawer.getTag() != null && this.photoProgressViews[0] != null) {
            float x = motionEvent.getX();
            float y = motionEvent.getY();
            if ((x < ((float) (getContainerViewWidth() - AndroidUtilities.dp(100.0f))) / 2.0f || x > ((float) (getContainerViewWidth() + AndroidUtilities.dp(100.0f))) / 2.0f || y < ((float) (getContainerViewHeight() - AndroidUtilities.dp(100.0f))) / 2.0f || y > ((float) (getContainerViewHeight() + AndroidUtilities.dp(100.0f))) / 2.0f) ? false : onSingleTapConfirmed(motionEvent)) {
                this.discardTap = true;
                return true;
            }
        }
        return false;
    }

    @Override // org.telegram.ui.Components.GestureDetector2.OnGestureListener
    public void onUp(MotionEvent motionEvent) {
        hidePressedDrawables();
    }

    /* JADX WARN: Removed duplicated region for block: B:17:0x0069  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void openAdsMenu() {
        int i;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || !messageObject.isSponsored() || this.menuItem.getAlpha() <= 0.5f) {
            return;
        }
        final int i2 = this.currentMessageObject.currentAccount;
        final DarkThemeResourceProvider darkThemeResourceProvider = new DarkThemeResourceProvider();
        final ItemOptions itemOptionsMakeOptions = ItemOptions.makeOptions((ViewGroup) this.containerView, (Theme.ResourcesProvider) darkThemeResourceProvider, (View) this.menuItem, true);
        itemOptionsMakeOptions.translate(BitmapDescriptorFactory.HUE_RED, -AndroidUtilities.dp(46.0f));
        itemOptionsMakeOptions.setGravity(5);
        MessageObject messageObject2 = this.currentMessageObject;
        if (messageObject2.sponsoredInfo == null && messageObject2.sponsoredAdditionalInfo == null) {
            String str = messageObject2.sponsoredUrl;
            if (str != null) {
                if (!str.startsWith("https://" + MessagesController.getInstance(this.currentAccount).linkPrefix)) {
                }
            }
        } else {
            final ItemOptions itemOptionsMakeSwipeback = itemOptionsMakeOptions.makeSwipeback();
            ActionBarMenuSubItem actionBarMenuSubItem = new ActionBarMenuSubItem(this.activityContext, true, false, (Theme.ResourcesProvider) darkThemeResourceProvider);
            actionBarMenuSubItem.setItemHeight(44);
            actionBarMenuSubItem.setTextAndIcon(LocaleController.getString(R.string.Back), R.drawable.msg_arrow_back);
            actionBarMenuSubItem.getTextView().setPadding(LocaleController.isRTL ? 0 : AndroidUtilities.dp(40.0f), 0, LocaleController.isRTL ? AndroidUtilities.dp(40.0f) : 0, 0);
            actionBarMenuSubItem.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda121
                @Override // android.view.View.OnClickListener
                public final void onClick(View view) {
                    itemOptionsMakeOptions.closeSwipeback();
                }
            });
            itemOptionsMakeSwipeback.addView(actionBarMenuSubItem, LayoutHelper.createLinear(-1, -2));
            itemOptionsMakeSwipeback.addView(new ActionBarPopupWindow.GapView(this.activityContext, darkThemeResourceProvider), LayoutHelper.createLinear(-1, 8));
            ArrayList arrayList = new ArrayList();
            String str2 = this.currentMessageObject.sponsoredUrl;
            if (str2 != null && !TextUtils.equals(AndroidUtilities.getHostAuthority(str2), MessagesController.getInstance(this.currentAccount).linkPrefix)) {
                TextView textView = new TextView(this.activityContext);
                textView.setTextColor(Theme.getColor(Theme.key_chat_messageLinkIn, darkThemeResourceProvider));
                textView.setTextSize(1, 14.0f);
                textView.setPadding(AndroidUtilities.dp(18.0f), AndroidUtilities.dp(10.0f), AndroidUtilities.dp(18.0f), AndroidUtilities.dp(10.0f));
                textView.setMaxWidth(AndroidUtilities.dp(300.0f));
                Uri uri = Uri.parse(this.currentMessageObject.sponsoredUrl);
                textView.setText(Browser.replaceHostname(uri, Browser.IDN_toUnicode(uri.getHost()), null));
                textView.setBackground(Theme.createRadSelectorDrawable(getThemedColor(Theme.key_dialogButtonSelector), 0, this.currentMessageObject.sponsoredAdditionalInfo == null ? 6 : 0));
                textView.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda122
                    @Override // android.view.View.OnClickListener
                    public final void onClick(View view) {
                        this.f$0.lambda$openAdsMenu$146(itemOptionsMakeOptions, view);
                    }
                });
                textView.setOnLongClickListener(new View.OnLongClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda123
                    @Override // android.view.View.OnLongClickListener
                    public final boolean onLongClick(View view) {
                        return this.f$0.lambda$openAdsMenu$147(darkThemeResourceProvider, view);
                    }
                });
                arrayList.add(textView);
            }
            if (this.currentMessageObject.sponsoredInfo != null) {
                TextView textView2 = new TextView(this.activityContext);
                textView2.setTextColor(Theme.getColor(Theme.key_actionBarDefaultSubmenuItem, darkThemeResourceProvider));
                textView2.setTextSize(1, 14.0f);
                textView2.setPadding(AndroidUtilities.dp(18.0f), AndroidUtilities.dp(10.0f), AndroidUtilities.dp(18.0f), AndroidUtilities.dp(10.0f));
                textView2.setMaxWidth(AndroidUtilities.dp(300.0f));
                textView2.setText(this.currentMessageObject.sponsoredInfo);
                textView2.setBackground(Theme.createRadSelectorDrawable(getThemedColor(Theme.key_dialogButtonSelector), 0, this.currentMessageObject.sponsoredAdditionalInfo == null ? 6 : 0));
                textView2.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda124
                    @Override // android.view.View.OnClickListener
                    public final void onClick(View view) {
                        this.f$0.lambda$openAdsMenu$148(darkThemeResourceProvider, view);
                    }
                });
                arrayList.add(textView2);
            }
            if (this.currentMessageObject.sponsoredAdditionalInfo != null) {
                TextView textView3 = new TextView(this.activityContext);
                textView3.setTextColor(Theme.getColor(Theme.key_actionBarDefaultSubmenuItem, darkThemeResourceProvider));
                textView3.setTextSize(1, 14.0f);
                textView3.setPadding(AndroidUtilities.dp(18.0f), AndroidUtilities.dp(10.0f), AndroidUtilities.dp(18.0f), AndroidUtilities.dp(10.0f));
                textView3.setMaxWidth(AndroidUtilities.dp(300.0f));
                textView3.setText(this.currentMessageObject.sponsoredAdditionalInfo);
                textView3.setBackground(Theme.createRadSelectorDrawable(getThemedColor(Theme.key_dialogButtonSelector), 0, 6));
                textView3.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda125
                    @Override // android.view.View.OnClickListener
                    public final void onClick(View view) {
                        this.f$0.lambda$openAdsMenu$149(darkThemeResourceProvider, view);
                    }
                });
                arrayList.add(textView3);
            }
            for (int i3 = 0; i3 < arrayList.size(); i3++) {
                View view = (View) arrayList.get(i3);
                if (i3 > 0) {
                    FrameLayout frameLayout = new FrameLayout(this.activityContext);
                    frameLayout.setBackgroundColor(Theme.getColor(Theme.key_divider, darkThemeResourceProvider));
                    i = -1;
                    LinearLayout.LayoutParams layoutParamsCreateLinear = LayoutHelper.createLinear(-1, 1);
                    layoutParamsCreateLinear.height = 1;
                    itemOptionsMakeSwipeback.addView(frameLayout, layoutParamsCreateLinear);
                } else {
                    i = -1;
                }
                itemOptionsMakeSwipeback.addView(view, LayoutHelper.createLinear(i, -2));
            }
            itemOptionsMakeOptions.add(R.drawable.msg_channel, LocaleController.getString(R.string.SponsoredMessageSponsorReportable), new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda126
                @Override // java.lang.Runnable
                public final void run() {
                    itemOptionsMakeOptions.openSwipeback(itemOptionsMakeSwipeback);
                }
            });
        }
        if (!UserConfig.getInstance(i2).isPremium() && !MessagesController.getInstance(this.currentAccount).premiumFeaturesBlocked() && !this.currentMessageObject.sponsoredCanReport) {
            itemOptionsMakeOptions.add(R.drawable.msg_block2, LocaleController.getString(R.string.HideAd), new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda127
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$openAdsMenu$151(i2, darkThemeResourceProvider);
                }
            });
        }
        if (this.currentMessageObject.sponsoredCanReport) {
            itemOptionsMakeOptions.add(R.drawable.msg_info, LocaleController.getString(R.string.AboutRevenueSharingAds), new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda128
                @Override // java.lang.Runnable
                public final void run() {
                    this.f$0.lambda$openAdsMenu$152(darkThemeResourceProvider);
                }
            });
            if ((this.parentFragment instanceof ChatActivity) && !MessagesController.getInstance(i2).premiumFeaturesBlocked()) {
                itemOptionsMakeOptions.addGap();
                itemOptionsMakeOptions.add(R.drawable.msg_cancel, LocaleController.getString(R.string.RemoveAds), new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda129
                    @Override // java.lang.Runnable
                    public final void run() {
                        this.f$0.lambda$openAdsMenu$153(i2, darkThemeResourceProvider);
                    }
                });
            }
        }
        if (itemOptionsMakeOptions.getItemsCount() <= 0) {
            return;
        }
        itemOptionsMakeOptions.show();
    }

    public boolean openPhoto(int i, PageBlocksAdapter pageBlocksAdapter, PhotoViewerProvider photoViewerProvider) {
        return openPhoto(null, null, null, null, null, null, null, i, photoViewerProvider, null, 0L, 0L, 0L, true, pageBlocksAdapter, null);
    }

    public boolean openPhoto(ArrayList arrayList, int i, long j, long j2, long j3, PhotoViewerProvider photoViewerProvider) {
        return openPhoto((MessageObject) arrayList.get(i), null, null, null, arrayList, null, null, i, photoViewerProvider, null, j, j2, j3, true, null, null);
    }

    public boolean openPhoto(ArrayList arrayList, int i, PhotoViewerProvider photoViewerProvider) {
        return openPhoto(null, null, null, null, null, arrayList, null, i, photoViewerProvider, null, 0L, 0L, 0L, true, null, null);
    }

    public boolean openPhoto(MessageObject messageObject, int i, ChatActivity chatActivity, long j, long j2, long j3, PhotoViewerProvider photoViewerProvider) {
        return openPhoto(messageObject, null, null, null, null, null, null, 0, photoViewerProvider, chatActivity, j, j2, j3, true, null, Integer.valueOf(i));
    }

    public boolean openPhoto(MessageObject messageObject, long j, long j2, long j3, PhotoViewerProvider photoViewerProvider, boolean z) {
        return openPhoto(messageObject, null, null, null, null, null, null, 0, photoViewerProvider, null, j, j2, j3, z, null, null);
    }

    /* JADX WARN: Removed duplicated region for block: B:118:0x02bd  */
    /* JADX WARN: Removed duplicated region for block: B:121:0x02e5  */
    /* JADX WARN: Removed duplicated region for block: B:125:0x02f2 A[LOOP:0: B:123:0x02ef->B:125:0x02f2, LOOP_END] */
    /* JADX WARN: Removed duplicated region for block: B:128:0x0321  */
    /* JADX WARN: Removed duplicated region for block: B:131:0x0342  */
    /* JADX WARN: Removed duplicated region for block: B:133:0x0346  */
    /* JADX WARN: Removed duplicated region for block: B:136:0x034b  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public boolean openPhoto(MessageObject messageObject, TLRPC.FileLocation fileLocation, ImageLocation imageLocation, ImageLocation imageLocation2, ArrayList arrayList, ArrayList arrayList2, ArrayList arrayList3, int i, final PhotoViewerProvider photoViewerProvider, ChatActivity chatActivity, long j, long j2, long j3, boolean z, PageBlocksAdapter pageBlocksAdapter, final Integer num) throws Resources.NotFoundException {
        WindowManager.LayoutParams layoutParams;
        int i2;
        TLRPC.Message message;
        boolean z2;
        PhotoViewerProvider photoViewerProvider2;
        int animatedOrientation;
        ClippingImageView[] animatingImageViews;
        int i3;
        ViewGroup.LayoutParams layoutParams2;
        int iHeight;
        float f;
        if (this.parentActivity != null && !this.isVisible && ((photoViewerProvider != null || !checkAnimation()) && (messageObject != null || fileLocation != null || arrayList != null || arrayList3 != null || arrayList2 != null || imageLocation != null || pageBlocksAdapter != null))) {
            PlaceProviderObject placeForPhoto = photoViewerProvider.getPlaceForPhoto(messageObject, fileLocation, i, true, false);
            if (Build.VERSION.SDK_INT < 21) {
                Rect rect = this.insets;
                rect.top = AndroidUtilities.statusBarHeight;
                rect.bottom = AndroidUtilities.navigationBarHeight;
            }
            WindowManager windowManager = (WindowManager) this.parentActivity.getSystemService("window");
            if (this.attachedToWindow) {
                try {
                    windowManager.removeView(this.windowView);
                    onHideView();
                } catch (Exception unused) {
                }
            }
            try {
                WindowManager.LayoutParams layoutParams3 = this.windowLayoutParams;
                layoutParams3.type = 99;
                if (Build.VERSION.SDK_INT >= 21) {
                    layoutParams3.flags = -2147286784;
                } else {
                    layoutParams3.flags = 131072;
                }
                if ((chatActivity == null || chatActivity.getCurrentEncryptedChat() == null) && ((this.avatarsDialogId == 0 || !MessagesController.getInstance(this.currentAccount).isChatNoForwards(-this.avatarsDialogId)) && ((messageObject == null || (!MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId()) && ((message = messageObject.messageOwner) == null || !message.noforwards))) && (messageObject == null || !messageObject.hasRevealedExtendedMedia())))) {
                    layoutParams = this.windowLayoutParams;
                    i2 = layoutParams.flags & (-8193);
                } else {
                    layoutParams = this.windowLayoutParams;
                    i2 = layoutParams.flags | LiteMode.FLAG_ANIMATED_EMOJI_REACTIONS_NOT_PREMIUM;
                }
                layoutParams.flags = i2;
                AndroidUtilities.logFlagSecure();
                this.windowLayoutParams.softInputMode = 272;
                this.windowView.setFocusable(false);
                this.containerView.setFocusable(false);
                windowManager.addView(this.windowView, this.windowLayoutParams);
                onShowView();
                this.hasCaptionForAllMedia = false;
                this.doneButtonPressed = false;
                this.closePhotoAfterSelect = true;
                this.closePhotoAfterSelectWithAnimation = false;
                this.allowShowFullscreenButton = true;
                this.usedSurfaceView = false;
                this.parentChatActivity = chatActivity;
                AnimatedFileDrawable animation = null;
                this.lastTitle = null;
                this.isEmbedVideo = num != null;
                EditCoverButton editCoverButton = this.editCoverButton;
                if (editCoverButton != null) {
                    editCoverButton.lambda$setImage$0((Bitmap) null);
                }
                this.actionBarContainer.setTitle("");
                this.actionBarContainer.setSubtitle("", false);
                PhotoCountView photoCountView = this.countView;
                if (photoCountView != null) {
                    photoCountView.set(0, 0, false);
                    this.countView.updateShow(false, false);
                }
                this.actionBar.setTitleScrollNonFitText(false);
                NotificationCenter.getInstance(this.currentAccount).addObserver(this, NotificationCenter.fileLoadFailed);
                NotificationCenter.getInstance(this.currentAccount).addObserver(this, NotificationCenter.fileLoaded);
                NotificationCenter.getInstance(this.currentAccount).addObserver(this, NotificationCenter.customStickerCreated);
                NotificationCenter.getInstance(this.currentAccount).addObserver(this, NotificationCenter.fileLoadProgressChanged);
                NotificationCenter.getInstance(this.currentAccount).addObserver(this, NotificationCenter.mediaCountDidLoad);
                NotificationCenter.getInstance(this.currentAccount).addObserver(this, NotificationCenter.mediaDidLoad);
                NotificationCenter.getInstance(this.currentAccount).addObserver(this, NotificationCenter.dialogPhotosUpdate);
                NotificationCenter.getInstance(this.currentAccount).addObserver(this, NotificationCenter.messagesDeleted);
                NotificationCenter.getGlobalInstance().addObserver(this, NotificationCenter.emojiLoaded);
                NotificationCenter.getInstance(this.currentAccount).addObserver(this, NotificationCenter.filePreparingFailed);
                NotificationCenter.getInstance(this.currentAccount).addObserver(this, NotificationCenter.fileNewChunkAvailable);
                NotificationCenter.getInstance(this.currentAccount).addObserver(this, NotificationCenter.replaceMessagesObjects);
                NotificationCenter.getInstance(this.currentAccount).addObserver(this, NotificationCenter.dialogDeleted);
                this.placeProvider = photoViewerProvider;
                this.mergeDialogId = j2;
                this.currentDialogId = j;
                this.currentFilterTag = chatActivity != null ? chatActivity.getFilterTag() : null;
                this.currentFilterQuery = chatActivity != null ? chatActivity.getFilterQuery() : null;
                this.currentFiltered = chatActivity != null && chatActivity.isFiltered();
                this.topicId = j3;
                this.selectedPhotosAdapter.notifyDataSetChanged();
                this.pageBlocksAdapter = pageBlocksAdapter;
                this.setAvatarFor = null;
                if (this.velocityTracker == null) {
                    this.velocityTracker = VelocityTracker.obtain();
                }
                this.isVisible = true;
                this.isVisibleOrAnimating = true;
                togglePhotosListView(false, false);
                boolean z3 = !z;
                this.openedFullScreenVideo = z3;
                if (z3) {
                    toggleActionBar(false, false);
                } else if (this.sendPhotoType == 1) {
                    createCropView();
                    toggleActionBar(false, false);
                } else {
                    toggleActionBar(true, false);
                }
                this.windowView.setClipChildren(false);
                this.navigationBar.setVisibility(0);
                this.seekToProgressPending2 = BitmapDescriptorFactory.HUE_RED;
                this.skipFirstBufferingProgress = false;
                this.playerInjected = false;
                if (placeForPhoto != null) {
                    this.disableShowCheck = true;
                    this.animationInProgress = 1;
                    if (messageObject != null) {
                        AnimatedFileDrawable animation2 = placeForPhoto.allowTakeAnimation ? placeForPhoto.imageReceiver.getAnimation() : null;
                        this.currentAnimation = animation2;
                        if (animation2 != null) {
                            if (messageObject.isVideo()) {
                                placeForPhoto.imageReceiver.setAllowStartAnimation(false);
                                placeForPhoto.imageReceiver.stopAnimation();
                                if (MediaController.getInstance().isPlayingMessage(messageObject)) {
                                    this.seekToProgressPending2 = messageObject.audioProgress;
                                }
                                this.skipFirstBufferingProgress = this.injectingVideoPlayer == null && !FileLoader.getInstance(messageObject.currentAccount).isLoadingVideo(messageObject.getDocument(), true) && (this.currentAnimation.hasBitmap() || !FileLoader.getInstance(messageObject.currentAccount).isLoadingVideo(messageObject.getDocument(), false));
                            } else if (messageObject.getWebPagePhotos(null, null).size() > 1) {
                            }
                            this.currentAnimation = animation;
                        }
                        z2 = true;
                        onPhotoShow(messageObject, fileLocation, imageLocation, imageLocation2, arrayList, arrayList2, arrayList3, i, placeForPhoto);
                        if (this.sendPhotoType == 1) {
                            this.photoCropView.setVisibility(0);
                            this.photoCropView.setAlpha(BitmapDescriptorFactory.HUE_RED);
                            this.photoCropView.setFreeform(false);
                        }
                        RectF drawRegion = placeForPhoto.imageReceiver.getDrawRegion();
                        float f2 = drawRegion.left;
                        float f3 = drawRegion.top;
                        int orientation = placeForPhoto.imageReceiver.getOrientation();
                        animatedOrientation = placeForPhoto.imageReceiver.getAnimatedOrientation();
                        if (animatedOrientation != 0) {
                            orientation = animatedOrientation;
                        }
                        animatingImageViews = getAnimatingImageViews(placeForPhoto);
                        this.clippingImageProgress = 1.0f;
                        for (i3 = 0; i3 < animatingImageViews.length; i3++) {
                            animatingImageViews[i3].setAnimationValues(this.animationValues);
                            animatingImageViews[i3].setVisibility(0);
                            animatingImageViews[i3].setRadius(placeForPhoto.radius);
                            animatingImageViews[i3].setOrientation(orientation, placeForPhoto.imageReceiver.getInvert());
                            animatingImageViews[i3].setImageBitmap(placeForPhoto.thumb);
                        }
                        initCropView();
                        if (this.sendPhotoType == 1) {
                            this.photoCropView.setAspectRatio(1.0f);
                        }
                        layoutParams2 = this.animatingImageView.getLayoutParams();
                        layoutParams2.width = (int) drawRegion.width();
                        iHeight = (int) drawRegion.height();
                        layoutParams2.height = iHeight;
                        if (layoutParams2.width <= 0) {
                            layoutParams2.width = 100;
                        }
                        if (iHeight <= 0) {
                            layoutParams2.height = 100;
                        }
                        for (int i4 = 0; i4 < animatingImageViews.length; i4++) {
                            if (animatingImageViews.length > 1) {
                                ClippingImageView clippingImageView = animatingImageViews[i4];
                                f = BitmapDescriptorFactory.HUE_RED;
                                clippingImageView.setAlpha(BitmapDescriptorFactory.HUE_RED);
                            } else {
                                f = BitmapDescriptorFactory.HUE_RED;
                                animatingImageViews[i4].setAlpha(1.0f);
                            }
                            animatingImageViews[i4].setPivotX(f);
                            animatingImageViews[i4].setPivotY(f);
                            animatingImageViews[i4].setScaleX(placeForPhoto.scale);
                            animatingImageViews[i4].setScaleY(placeForPhoto.scale);
                            animatingImageViews[i4].setTranslationX(placeForPhoto.viewX + (drawRegion.left * placeForPhoto.scale));
                            animatingImageViews[i4].setTranslationY(placeForPhoto.viewY + (drawRegion.top * placeForPhoto.scale));
                            animatingImageViews[i4].setLayoutParams(layoutParams2);
                        }
                        this.windowView.getViewTreeObserver().addOnPreDrawListener(new AnonymousClass76(animatingImageViews, layoutParams2, f2, placeForPhoto, f3, photoViewerProvider, arrayList3, num));
                    } else {
                        if (pageBlocksAdapter != null) {
                            animation = placeForPhoto.imageReceiver.getAnimation();
                            this.currentAnimation = animation;
                        }
                        z2 = true;
                        onPhotoShow(messageObject, fileLocation, imageLocation, imageLocation2, arrayList, arrayList2, arrayList3, i, placeForPhoto);
                        if (this.sendPhotoType == 1) {
                        }
                        RectF drawRegion2 = placeForPhoto.imageReceiver.getDrawRegion();
                        float f22 = drawRegion2.left;
                        float f32 = drawRegion2.top;
                        int orientation2 = placeForPhoto.imageReceiver.getOrientation();
                        animatedOrientation = placeForPhoto.imageReceiver.getAnimatedOrientation();
                        if (animatedOrientation != 0) {
                        }
                        animatingImageViews = getAnimatingImageViews(placeForPhoto);
                        this.clippingImageProgress = 1.0f;
                        while (i3 < animatingImageViews.length) {
                        }
                        initCropView();
                        if (this.sendPhotoType == 1) {
                        }
                        layoutParams2 = this.animatingImageView.getLayoutParams();
                        layoutParams2.width = (int) drawRegion2.width();
                        iHeight = (int) drawRegion2.height();
                        layoutParams2.height = iHeight;
                        if (layoutParams2.width <= 0) {
                        }
                        if (iHeight <= 0) {
                        }
                        while (i4 < animatingImageViews.length) {
                        }
                        this.windowView.getViewTreeObserver().addOnPreDrawListener(new AnonymousClass76(animatingImageViews, layoutParams2, f22, placeForPhoto, f32, photoViewerProvider, arrayList3, num));
                    }
                } else {
                    z2 = true;
                    if (arrayList3 != null && this.sendPhotoType != 3 && ((photoViewerProvider2 = this.placeProvider) == null || !photoViewerProvider2.closeKeyboard())) {
                        makeFocusable();
                    }
                    this.containerView.setAlpha(1.0f);
                    onPhotoShow(messageObject, fileLocation, imageLocation, imageLocation2, arrayList, arrayList2, arrayList3, i, placeForPhoto);
                    initCropView();
                    setCropBitmap();
                    ChatActivity chatActivity2 = this.parentChatActivity;
                    if (chatActivity2 != null) {
                        UndoView undoView = chatActivity2.getUndoView();
                        if (undoView != null) {
                            undoView.hide(false, 1);
                        }
                        this.parentChatActivity.getFragmentView().invalidate();
                    }
                    this.windowView.getViewTreeObserver().addOnPreDrawListener(new ViewTreeObserver.OnPreDrawListener() { // from class: org.telegram.ui.PhotoViewer.77
                        @Override // android.view.ViewTreeObserver.OnPreDrawListener
                        public boolean onPreDraw() {
                            PhotoViewer.this.windowView.getViewTreeObserver().removeOnPreDrawListener(this);
                            PhotoViewer.this.actionBar.setTranslationY(-AndroidUtilities.dp(32.0f));
                            ViewPropertyAnimator duration = PhotoViewer.this.actionBar.animate().alpha(1.0f).translationY(BitmapDescriptorFactory.HUE_RED).setDuration(150L);
                            CubicBezierInterpolator cubicBezierInterpolator = CubicBezierInterpolator.DEFAULT;
                            duration.setInterpolator(cubicBezierInterpolator).start();
                            PhotoViewer.this.checkImageView.setTranslationY(-AndroidUtilities.dp(32.0f));
                            PhotoViewer.this.checkImageView.animate().alpha(1.0f).translationY(BitmapDescriptorFactory.HUE_RED).setDuration(150L).setInterpolator(cubicBezierInterpolator).start();
                            PhotoViewer.this.photosCounterView.setTranslationY(-AndroidUtilities.dp(32.0f));
                            PhotoViewer.this.photosCounterView.animate().alpha(1.0f).translationY(BitmapDescriptorFactory.HUE_RED).setDuration(150L).setInterpolator(cubicBezierInterpolator).start();
                            PhotoViewer.this.pickerView.setTranslationY(AndroidUtilities.dp(32.0f));
                            PhotoViewer.this.pickerView.animate().alpha(1.0f).setDuration(150L).setInterpolator(cubicBezierInterpolator).start();
                            PhotoViewer.this.pickerViewSendButton.setTranslationY(AndroidUtilities.dp(32.0f));
                            PhotoViewer.this.pickerViewSendButton.setAlpha(BitmapDescriptorFactory.HUE_RED);
                            PhotoViewer.this.pickerViewSendButton.animate().alpha(1.0f).translationY(BitmapDescriptorFactory.HUE_RED).setDuration(150L).setInterpolator(cubicBezierInterpolator).start();
                            PhotoViewer.this.videoPreviewFrame.setTranslationY(AndroidUtilities.dp(32.0f));
                            PhotoViewer.this.videoPreviewFrame.animate().alpha(1.0f).translationY(BitmapDescriptorFactory.HUE_RED).setDuration(150L).setInterpolator(cubicBezierInterpolator).start();
                            PhotoViewer.this.containerView.setAlpha(BitmapDescriptorFactory.HUE_RED);
                            PhotoViewer.this.backgroundDrawable.setAlpha(0);
                            PhotoViewer.this.animationInProgress = 4;
                            PhotoViewer.this.containerView.invalidate();
                            AnimatorSet animatorSet = new AnimatorSet();
                            ObjectAnimator duration2 = ObjectAnimator.ofFloat(PhotoViewer.this.pickerView, (Property<FrameLayout, Float>) View.TRANSLATION_Y, PhotoViewer.this.pickerView.getTranslationY(), BitmapDescriptorFactory.HUE_RED).setDuration(220L);
                            duration2.setInterpolator(cubicBezierInterpolator);
                            FrameLayout frameLayout = PhotoViewer.this.pickerView;
                            Property property = View.ALPHA;
                            ObjectAnimator duration3 = ObjectAnimator.ofFloat(frameLayout, (Property<FrameLayout, Float>) property, 1.0f).setDuration(220L);
                            duration3.setInterpolator(cubicBezierInterpolator);
                            animatorSet.playTogether(ObjectAnimator.ofFloat(PhotoViewer.this.containerView, (Property<FrameLayoutDrawer, Float>) property, BitmapDescriptorFactory.HUE_RED, 1.0f).setDuration(220L), ObjectAnimator.ofFloat(PhotoViewer.this.navigationBar, (Property<View, Float>) property, BitmapDescriptorFactory.HUE_RED, 1.0f).setDuration(220L), duration2, duration3);
                            animatorSet.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.77.1
                                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                                public void onAnimationEnd(Animator animator) {
                                    super.onAnimationEnd(animator);
                                    PhotoViewer.this.animationInProgress = 0;
                                    PhotoViewer.this.invalidateBlur();
                                    PhotoViewer.this.backgroundDrawable.setAlpha(255);
                                    PhotoViewer.this.containerView.invalidate();
                                    PhotoViewer.this.pickerView.setTranslationY(BitmapDescriptorFactory.HUE_RED);
                                    if (PhotoViewer.this.isEmbedVideo) {
                                        AnonymousClass77 anonymousClass77 = AnonymousClass77.this;
                                        PhotoViewer.this.initEmbedVideo(num.intValue());
                                    }
                                    PhotoViewerProvider photoViewerProvider3 = photoViewerProvider;
                                    if (photoViewerProvider3 != null) {
                                        photoViewerProvider3.onOpen();
                                    }
                                }

                                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                                public void onAnimationStart(Animator animator) {
                                    super.onAnimationStart(animator);
                                    PhotoViewerProvider photoViewerProvider3 = photoViewerProvider;
                                    if (photoViewerProvider3 != null) {
                                        photoViewerProvider3.onPreOpen();
                                    }
                                }
                            });
                            animatorSet.start();
                            return true;
                        }
                    });
                }
                AccessibilityManager accessibilityManager = (AccessibilityManager) this.parentActivity.getSystemService("accessibility");
                if (accessibilityManager.isTouchExplorationEnabled()) {
                    AccessibilityEvent accessibilityEventObtain = AccessibilityEvent.obtain();
                    accessibilityEventObtain.setEventType(LiteMode.FLAG_ANIMATED_EMOJI_KEYBOARD_NOT_PREMIUM);
                    accessibilityEventObtain.getText().add(LocaleController.getString("AccDescrPhotoViewer", R.string.AccDescrPhotoViewer));
                    accessibilityManager.sendAccessibilityEvent(accessibilityEventObtain);
                }
                return z2;
            } catch (Exception e) {
                FileLog.e(e);
            }
        }
        return false;
    }

    public boolean openPhoto(MessageObject messageObject, ChatActivity chatActivity, long j, long j2, long j3, PhotoViewerProvider photoViewerProvider) {
        return openPhoto(messageObject, null, null, null, null, null, null, 0, photoViewerProvider, chatActivity, j, j2, j3, true, null, null);
    }

    public boolean openPhoto(TLRPC.FileLocation fileLocation, ImageLocation imageLocation, PhotoViewerProvider photoViewerProvider) {
        return openPhoto(null, fileLocation, imageLocation, null, null, null, null, 0, photoViewerProvider, null, 0L, 0L, 0L, true, null, null);
    }

    public boolean openPhoto(TLRPC.FileLocation fileLocation, PhotoViewerProvider photoViewerProvider) {
        return openPhoto(null, fileLocation, null, null, null, null, null, 0, photoViewerProvider, null, 0L, 0L, 0L, true, null, null);
    }

    public boolean openPhotoForSelect(ArrayList arrayList, int i, int i2, boolean z, PhotoViewerProvider photoViewerProvider, ChatActivity chatActivity) throws Resources.NotFoundException {
        return openPhotoForSelect(null, null, arrayList, i, i2, z, photoViewerProvider, chatActivity);
    }

    public boolean openPhotoForSelect(TLRPC.FileLocation fileLocation, ImageLocation imageLocation, ArrayList arrayList, int i, int i2, boolean z, PhotoViewerProvider photoViewerProvider, ChatActivity chatActivity) throws Resources.NotFoundException {
        int iDp;
        this.isDocumentsPicker = z;
        ChatActivityEnterView.SendButton sendButton = this.pickerViewSendButton;
        if (sendButton != null) {
            FrameLayout.LayoutParams layoutParams = (FrameLayout.LayoutParams) sendButton.getLayoutParams();
            if (i2 == 4 || i2 == 5) {
                this.pickerViewSendButton.setResourceId(R.drawable.msg_input_send_mini);
            } else if (i2 == 1 || i2 == 3 || i2 == 10 || i2 == 11) {
                this.pickerViewSendButton.setResourceId(R.drawable.floating_check);
                this.pickerViewSendButton.setPadding(0, AndroidUtilities.dp(1.0f), 0, 0);
            } else {
                this.pickerViewSendButton.setResourceId(R.drawable.msg_input_send_mini);
                iDp = AndroidUtilities.dp(2.33f);
                layoutParams.bottomMargin = iDp;
                this.pickerViewSendButton.setLayoutParams(layoutParams);
            }
            iDp = AndroidUtilities.dp(7.33f);
            layoutParams.bottomMargin = iDp;
            this.pickerViewSendButton.setLayoutParams(layoutParams);
        }
        if (i2 != 11 && this.stickerMakerView != null) {
            this.stickerEmpty = false;
            ImageView imageView = this.tuneItem;
            if (imageView != null) {
                imageView.setAlpha(1.0f);
            }
            BlurButton blurButton = this.outlineBtn;
            if (blurButton != null) {
                blurButton.setActive(false, false);
            }
            this.stickerMakerView.clean();
            ArrayList arrayList2 = this.selectedEmojis;
            if (arrayList2 != null) {
                arrayList2.clear();
            }
        }
        if (this.sendPhotoType == 1 || i2 != 1 || !this.isVisible) {
            this.sendPhotoType = i2;
            if (i2 == 11) {
                this.navigationBar.setBackgroundColor(-16777216);
            }
            return openPhoto(null, fileLocation, imageLocation, null, null, null, arrayList, i, photoViewerProvider, chatActivity, 0L, 0L, 0L, true, null, null);
        }
        this.sendPhotoType = i2;
        this.doneButtonPressed = false;
        this.actionBarContainer.setTitle("");
        this.actionBarContainer.setSubtitle("", false);
        this.placeProvider = photoViewerProvider;
        this.mergeDialogId = 0L;
        this.currentDialogId = 0L;
        this.selectedPhotosAdapter.notifyDataSetChanged();
        this.pageBlocksAdapter = null;
        if (this.velocityTracker == null) {
            this.velocityTracker = VelocityTracker.obtain();
        }
        this.isVisible = true;
        this.isVisibleOrAnimating = true;
        togglePhotosListView(false, false);
        this.openedFullScreenVideo = false;
        createCropView();
        toggleActionBar(false, false);
        this.seekToProgressPending2 = BitmapDescriptorFactory.HUE_RED;
        this.skipFirstBufferingProgress = false;
        this.playerInjected = false;
        makeFocusable();
        this.backgroundDrawable.setAlpha(255);
        this.containerView.setAlpha(1.0f);
        onPhotoShow(null, fileLocation, imageLocation, null, null, null, arrayList, i, null);
        initCropView();
        setCropBitmap();
        return true;
    }

    public boolean openPhotoWithVideo(TLRPC.FileLocation fileLocation, ImageLocation imageLocation, PhotoViewerProvider photoViewerProvider) {
        return openPhoto(null, fileLocation, null, imageLocation, null, null, null, 0, photoViewerProvider, null, 0L, 0L, 0L, true, null, null);
    }

    @Override // org.telegram.messenger.pip.source.IPipSourceDelegate
    public View pipCreatePictureInPictureView() {
        TextureView textureView = new TextureView(this.parentActivity);
        this.pipTextureView = textureView;
        textureView.setOpaque(false);
        View view = this.pipPlaceholderView;
        if (view != null) {
            view.bringToFront();
        }
        return this.pipTextureView;
    }

    @Override // org.telegram.messenger.pip.source.IPipSourceDelegate
    public Bitmap pipCreatePictureInPictureViewBitmap() {
        TextureView textureView = this.pipTextureView;
        if (textureView == null || !textureView.isAvailable()) {
            return null;
        }
        return this.pipTextureView.getBitmap();
    }

    @Override // org.telegram.messenger.pip.source.IPipSourceDelegate
    public Bitmap pipCreatePrimaryWindowViewBitmap() {
        TextureView textureView = this.videoTextureView;
        if (textureView != null) {
            return textureView.getBitmap();
        }
        if (!this.usedSurfaceView || Build.VERSION.SDK_INT < 24) {
            return null;
        }
        Bitmap bitmapCreateBitmap = Bitmaps.createBitmap(this.videoSurfaceView.getWidth(), this.videoSurfaceView.getHeight(), Bitmap.Config.ARGB_8888);
        AndroidUtilities.getBitmapFromSurface(this.videoSurfaceView, bitmapCreateBitmap);
        return bitmapCreateBitmap;
    }

    @Override // org.telegram.messenger.pip.source.IPipSourceDelegate
    public void pipHidePrimaryWindowView(Runnable runnable) {
        if (PipVideoOverlay.isVisible()) {
            PipVideoOverlay.dismiss(false);
        }
        this.pipFirstFrameCallback = runnable;
        VideoPlayer videoPlayer = this.videoPlayer;
        if (videoPlayer != null) {
            videoPlayer.setSurfaceView(null);
            this.videoPlayer.setTextureView(null);
            this.videoPlayer.play();
            this.videoPlayer.setTextureView(this.pipTextureView);
        }
        ((WindowManager) this.parentActivity.getSystemService("window")).removeView(this.windowView);
        this.windowViewSkipRender = true;
        this.windowView.invalidate();
    }

    @Override // org.telegram.messenger.pip.source.IPipSourceDelegate
    public boolean pipIsAvailable() {
        ActionBarMenuSubItem actionBarMenuSubItem = this.pipItem;
        return actionBarMenuSubItem != null && actionBarMenuSubItem.isEnabled() && this.isPlaying;
    }

    @Override // org.telegram.messenger.pip.source.IPipSourceDelegate
    public void pipRenderBackground(Canvas canvas) {
        canvas.drawColor(-16777216);
    }

    @Override // org.telegram.messenger.pip.source.IPipSourceDelegate
    public void pipRenderForeground(Canvas canvas) {
        this.textureViewSkipRender = true;
        this.windowView.draw(canvas);
        this.textureViewSkipRender = false;
    }

    @Override // org.telegram.messenger.pip.source.IPipSourceDelegate
    public void pipShowPrimaryWindowView(Runnable runnable) {
        this.pipFirstFrameCallback = runnable;
        this.windowViewSkipRender = false;
        if (this.windowView != null) {
            ((WindowManager) this.parentActivity.getSystemService("window")).addView(this.windowView, this.windowLayoutParams);
            this.windowView.invalidate();
        }
        VideoPlayer videoPlayer = this.videoPlayer;
        if (videoPlayer == null) {
            return;
        }
        videoPlayer.setSurfaceView(null);
        this.videoPlayer.setTextureView(null);
        this.videoPlayer.play();
        TextureView textureView = this.videoTextureView;
        if (textureView != null) {
            this.videoPlayer.setTextureView(textureView);
            return;
        }
        SurfaceView surfaceView = this.videoSurfaceView;
        if (surfaceView != null) {
            this.videoPlayer.setSurfaceView(surfaceView);
        }
    }

    public void prepareSegmentImage() {
        StickerMakerView stickerMakerView = this.stickerMakerView;
        if (stickerMakerView == null || this.sendPhotoType != 11) {
            return;
        }
        if (this.stickerEmpty) {
            stickerMakerView.clean();
        } else {
            stickerMakerView.segmentImage(this.centerImage.getBitmap(), this.centerImage.getOrientation(), getContainerViewWidth(), getContainerViewHeight(), new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda132
                @Override // org.telegram.messenger.Utilities.Callback
                public final void run(Object obj) {
                    this.f$0.lambda$prepareSegmentImage$121((StickerMakerView.SegmentedObject) obj);
                }
            });
        }
    }

    public void setAnimationValue(float f) {
        this.animationValue = f;
        this.containerView.invalidate();
        invalidateBlur();
    }

    public void setAvatarFor(ImageUpdater.AvatarFor avatarFor) {
        int i;
        String str;
        View view;
        TLRPC.User user;
        PhotoCropView photoCropView;
        String string;
        this.setAvatarFor = avatarFor;
        if (this.sendPhotoType == 1) {
            if (useFullWidthSendButton()) {
                this.doneButtonFullWidth.setVisibility(0);
                view = this.pickerViewSendButton;
            } else {
                this.pickerViewSendButton.setVisibility(0);
                view = this.doneButtonFullWidth;
            }
            view.setVisibility(8);
            if (avatarFor == null || (user = avatarFor.fromObject) == null || avatarFor.type != 1 || !this.setAvatarFor.self) {
                this.photoCropView.setSubtitle(null);
            } else {
                if (avatarFor.isVideo) {
                    photoCropView = this.photoCropView;
                    string = LocaleController.formatString("SetSuggestedVideoTooltip", R.string.SetSuggestedVideoTooltip, user.first_name);
                } else {
                    photoCropView = this.photoCropView;
                    string = LocaleController.formatString("SetSuggestedPhotoTooltip", R.string.SetSuggestedPhotoTooltip, user.first_name);
                }
                photoCropView.setSubtitle(string);
            }
        }
        if (avatarFor != null) {
            if (avatarFor.type == 2) {
                if (avatarFor.isVideo) {
                    i = R.string.SuggestVideo;
                    str = "SuggestVideo";
                } else {
                    i = R.string.SuggestPhoto;
                    str = "SuggestPhoto";
                }
                setTitle(LocaleController.getString(str, i));
            }
            if (avatarFor.isVideo) {
                this.videoAvatarTooltip.setText(LocaleController.getString("SetCover", R.string.SetCover));
            }
            this.actionBar.setBackground(null);
            if (Build.VERSION.SDK_INT >= 21) {
                this.actionBar.setElevation(2.0f);
            }
        }
    }

    public void setCaption(CharSequence charSequence) {
        this.hasCaptionForAllMedia = true;
        this.captionForAllMedia = charSequence;
        setCurrentCaption(null, charSequence, false, false);
        updateCaptionTextForCurrentPhoto(null);
    }

    public void setMaxSelectedPhotos(int i, boolean z) {
        this.maxSelectedPhotos = i;
        this.allowOrder = z;
    }

    public void setParentActivity(Activity activity) {
        setParentActivity(activity, null, null);
    }

    public void setParentActivity(Activity activity, BaseFragment baseFragment, final Theme.ResourcesProvider resourcesProvider) {
        boolean z;
        boolean z2 = true;
        final Activity parentActivity = activity != null ? activity : baseFragment.getParentActivity();
        Theme.createChatResources(parentActivity, false);
        this.resourcesProvider = resourcesProvider;
        this.parentFragment = baseFragment;
        int i = UserConfig.selectedAccount;
        this.currentAccount = i;
        this.centerImage.setCurrentAccount(i);
        this.leftImage.setCurrentAccount(this.currentAccount);
        this.rightImage.setCurrentAccount(this.currentAccount);
        CaptionPhotoViewer captionPhotoViewer = this.captionEdit;
        if (captionPhotoViewer != null) {
            captionPhotoViewer.setAccount(this.currentAccount);
        }
        StickerMakerView stickerMakerView = this.stickerMakerView;
        if (stickerMakerView != null) {
            stickerMakerView.setCurrentAccount(this.currentAccount);
        }
        if (this.parentActivity == parentActivity || parentActivity == null) {
            updateColors();
            return;
        }
        this.inBubbleMode = parentActivity instanceof BubbleActivity;
        this.parentActivity = parentActivity;
        this.activityContext = new ContextThemeWrapper(this.parentActivity, R.style.Theme_TMessages);
        this.touchSlop = ViewConfiguration.get(this.parentActivity).getScaledTouchSlop();
        if (progressDrawables == null) {
            progressDrawables = new Drawable[]{ContextCompat.getDrawable(this.parentActivity, R.drawable.circle_big), ContextCompat.getDrawable(this.parentActivity, R.drawable.cancel_big), ContextCompat.getDrawable(this.parentActivity, R.drawable.load_big)};
        }
        this.scroller = new Scroller(parentActivity);
        AnonymousClass14 anonymousClass14 = new AnonymousClass14(parentActivity);
        this.windowView = anonymousClass14;
        anonymousClass14.setBackgroundDrawable(this.backgroundDrawable);
        this.windowView.setFocusable(false);
        ClippingImageView clippingImageView = new ClippingImageView(parentActivity);
        this.animatingImageView = clippingImageView;
        clippingImageView.setAnimationValues(this.animationValues);
        this.windowView.addView(this.animatingImageView, LayoutHelper.createFrame(40, 40.0f));
        FrameLayoutDrawer frameLayoutDrawer = new FrameLayoutDrawer(parentActivity, parentActivity) { // from class: org.telegram.ui.PhotoViewer.15
            @Override // org.telegram.ui.Components.SizeNotifierFrameLayout, android.view.ViewGroup, android.view.View
            protected void dispatchDraw(Canvas canvas) {
                super.dispatchDraw(canvas);
                PhotoViewer.this.textSelectionHelper.getOverlayView(PhotoViewer.this.windowView.getContext()).draw(canvas);
            }

            @Override // android.view.ViewGroup, android.view.View
            public boolean dispatchTouchEvent(MotionEvent motionEvent) {
                PhotoViewer.this.textSelectionHelper.getOverlayView(getContext()).checkCancelAction(motionEvent);
                if (!PhotoViewer.this.textSelectionHelper.isInSelectionMode()) {
                    return super.dispatchTouchEvent(motionEvent);
                }
                PhotoViewer.this.textSelectionHelper.getOverlayView(getContext()).onTouchEvent(motionEvent);
                return true;
            }

            @Override // org.telegram.ui.PhotoViewer.FrameLayoutDrawer, android.view.ViewGroup
            protected boolean drawChild(Canvas canvas, View view, long j) {
                if (view == PhotoViewer.this.textSelectionHelper.getOverlayView(PhotoViewer.this.windowView.getContext()) || view == PhotoViewer.this.stickerMakerBackgroundView) {
                    return false;
                }
                return super.drawChild(canvas, view, j);
            }

            @Override // org.telegram.ui.Components.SizeNotifierFrameLayout
            public int getBottomPadding() {
                return PhotoViewer.this.pickerView.getHeight();
            }

            @Override // org.telegram.ui.PhotoViewer.FrameLayoutDrawer, org.telegram.ui.Components.SizeNotifierFrameLayoutPhoto, org.telegram.ui.Components.SizeNotifierFrameLayout, android.widget.FrameLayout, android.view.ViewGroup, android.view.View
            protected void onLayout(boolean z3, int i2, int i3, int i4, int i5) {
                if (PhotoViewer.this.btnLayout != null && PhotoViewer.this.undoBtn != null) {
                    int iDp = (i4 - i2) - AndroidUtilities.dp(20.0f);
                    PhotoViewer.this.undoBtn.setTranslationY(((-iDp) / 2.0f) - AndroidUtilities.dp(47.0f));
                    float f = iDp / 2.0f;
                    PhotoViewer.this.btnLayout.setTranslationY(AndroidUtilities.dp(47.0f) + f);
                    PhotoViewer.this.cutOutBtn.setTranslationY(AndroidUtilities.dp(47.0f) + f);
                    PhotoViewer.this.outlineBtn.setTranslationY(f + AndroidUtilities.dp(95.0f));
                }
                super.onLayout(z3, i2, i3, i4, i5);
            }
        };
        this.containerView = frameLayoutDrawer;
        frameLayoutDrawer.setFocusable(false);
        VideoFramesRewinder videoFramesRewinder = this.framesRewinder;
        if (videoFramesRewinder != null) {
            videoFramesRewinder.setParentView(this.containerView);
        }
        this.containerView.setClipChildren(true);
        this.containerView.setClipToPadding(true);
        this.windowView.setClipChildren(false);
        this.windowView.setClipToPadding(false);
        BlurringShader.BlurManager blurManager = new BlurringShader.BlurManager(this.containerView);
        this.blurManager = blurManager;
        blurManager.padding = 1;
        this.shadowBlurer = new BlurringShader.StoryBlurDrawer(blurManager, this.containerView, 6);
        this.windowView.addView(this.containerView, LayoutHelper.createFrame(-1, -1, 51));
        int i2 = Build.VERSION.SDK_INT;
        if (i2 >= 21) {
            this.containerView.setFitsSystemWindows(true);
            this.containerView.setOnApplyWindowInsetsListener(new View.OnApplyWindowInsetsListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda19
                @Override // android.view.View.OnApplyWindowInsetsListener
                public final WindowInsets onApplyWindowInsets(View view, WindowInsets windowInsets) {
                    return this.f$0.lambda$setParentActivity$6(view, windowInsets);
                }
            });
            this.containerView.setSystemUiVisibility(1792);
        }
        WindowManager.LayoutParams layoutParams = new WindowManager.LayoutParams();
        this.windowLayoutParams = layoutParams;
        layoutParams.height = -1;
        layoutParams.format = -3;
        layoutParams.width = -1;
        layoutParams.gravity = 51;
        layoutParams.type = 99;
        if (i2 >= 28) {
            layoutParams.layoutInDisplayCutoutMode = 1;
        }
        layoutParams.flags = i2 >= 21 ? -2147286784 : 131072;
        PaintingOverlay paintingOverlay = new PaintingOverlay(this.parentActivity);
        this.paintingOverlay = paintingOverlay;
        this.containerView.addView(paintingOverlay, LayoutHelper.createFrame(-2, -2.0f));
        PaintingOverlay paintingOverlay2 = new PaintingOverlay(this.parentActivity);
        this.leftPaintingOverlay = paintingOverlay2;
        this.containerView.addView(paintingOverlay2, LayoutHelper.createFrame(-2, -2.0f));
        PaintingOverlay paintingOverlay3 = new PaintingOverlay(this.parentActivity);
        this.rightPaintingOverlay = paintingOverlay3;
        this.containerView.addView(paintingOverlay3, LayoutHelper.createFrame(-2, -2.0f));
        ActionBar actionBar = new ActionBar(parentActivity) { // from class: org.telegram.ui.PhotoViewer.16
            @Override // android.view.View
            public void setAlpha(float f) {
                super.setAlpha(f);
                PhotoViewer.this.containerView.invalidate();
            }
        };
        this.actionBar = actionBar;
        actionBar.setOverlayTitleAnimation(true);
        this.actionBar.setTitleColor(-1);
        this.actionBar.setSubtitleColor(-1);
        this.actionBar.setBackgroundColor(2130706432);
        this.actionBar.setOccupyStatusBar(isStatusBarVisible());
        this.actionBar.setItemsBackgroundColor(1090519039, false);
        this.actionBar.setItemsColor(-1, false);
        this.actionBar.setBackButtonImage(R.drawable.ic_ab_back);
        PhotoViewerActionBarContainer photoViewerActionBarContainer = new PhotoViewerActionBarContainer(parentActivity);
        this.actionBarContainer = photoViewerActionBarContainer;
        this.actionBar.addView(photoViewerActionBarContainer, LayoutHelper.createFrame(-1, -1, R.styleable.AppCompatTheme_windowActionModeOverlay));
        this.containerView.addView(this.actionBar, LayoutHelper.createFrame(-1, -2.0f));
        PhotoCountView photoCountView = new PhotoCountView(parentActivity);
        this.countView = photoCountView;
        this.containerView.addView(photoCountView, LayoutHelper.createFrame(-1, -2, 55));
        this.actionBar.setActionBarMenuOnItemClick(new AnonymousClass17(resourcesProvider));
        ActionBarMenu actionBarMenuCreateMenu = this.actionBar.createMenu();
        this.menu = actionBarMenuCreateMenu;
        actionBarMenuCreateMenu.setOnLayoutListener(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda49
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.updateActionBarTitlePadding();
            }
        });
        ActionBarMenuItem actionBarMenuItemAddItem = this.menu.addItem(11, R.drawable.msg_mask);
        this.masksItem = actionBarMenuItemAddItem;
        actionBarMenuItemAddItem.setContentDescription(LocaleController.getString(R.string.Masks));
        ActionBarMenuItem actionBarMenuItemAddItem2 = this.menu.addItem(18, R.drawable.msg_header_draw);
        this.editItem = actionBarMenuItemAddItem2;
        actionBarMenuItemAddItem2.setContentDescription(LocaleController.getString(R.string.AccDescrPhotoEditor));
        ActionBarMenuItem actionBarMenuItemAddItem3 = this.menu.addItem(4, R.drawable.msg_header_share);
        this.sendItem = actionBarMenuItemAddItem3;
        actionBarMenuItemAddItem3.setContentDescription(LocaleController.getString(R.string.Forward));
        ActionBarMenu actionBarMenu = this.menu;
        ChooseQualityLayout$QualityIcon chooseQualityLayout$QualityIcon = new ChooseQualityLayout$QualityIcon(this.activityContext, R.drawable.video_settings, new DarkThemeResourceProvider());
        this.videoItemIcon = chooseQualityLayout$QualityIcon;
        ActionBarMenuItem actionBarMenuItemAddItem4 = actionBarMenu.addItem(1, chooseQualityLayout$QualityIcon);
        this.videoItem = actionBarMenuItemAddItem4;
        this.videoItemIcon.setCallback(actionBarMenuItemAddItem4.getIconView());
        this.videoItem.getPopupLayout().setSwipeBackForegroundColor(-14540254);
        this.videoItem.getPopupLayout().swipeBackGravityRight = true;
        this.videoItem.getPopupLayout().setFitItems(true);
        this.videoItem.setMenuXOffset(AndroidUtilities.dp(3.0f));
        ActionBarMenuSlider.SpeedSlider speedSlider = new ActionBarMenuSlider.SpeedSlider(this.activityContext, resourcesProvider);
        this.speedItem = speedSlider;
        speedSlider.setStops(new float[]{0.5f, 1.0f, 1.5f, 2.0f, 2.5f});
        this.speedItem.setMinimumWidth(AndroidUtilities.dp(196.0f));
        this.speedItem.setDrawShadow(false);
        this.speedItem.setBackgroundColor(-14540254);
        this.speedItem.setTextColor(-1);
        this.speedItem.setLabel(LocaleController.getString(R.string.VideoPlayerSpeed));
        this.speedItem.setOnValueChange(new Utilities.Callback2() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda60
            @Override // org.telegram.messenger.Utilities.Callback2
            public final void run(Object obj, Object obj2) {
                this.f$0.lambda$setParentActivity$7((Float) obj, (Boolean) obj2);
            }
        });
        this.videoItem.getPopupLayout().addView((View) this.speedItem, LayoutHelper.createLinear(-1, 44));
        ActionBarPopupWindow.GapView gapViewAddColoredGap = this.videoItem.addColoredGap();
        this.speedGap = gapViewAddColoredGap;
        gapViewAddColoredGap.setColor(-15198184);
        ActionBarPopupWindow.ActionBarPopupWindowLayout popupLayout = this.videoItem.getPopupLayout();
        SpeedButtonsLayout speedButtonsLayout = new SpeedButtonsLayout(this.activityContext, new SpeedButtonsLayout.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda61
            @Override // org.telegram.ui.SpeedButtonsLayout.Callback
            public final void onSpeedSelected(float f, boolean z3, boolean z4) {
                this.f$0.chooseSpeed(f, z3, z4);
            }
        });
        this.chooseSpeedLayout = speedButtonsLayout;
        popupLayout.addView(speedButtonsLayout);
        LinearLayout linearLayout = new LinearLayout(this.activityContext);
        this.videoQualityLayout = linearLayout;
        linearLayout.setOrientation(1);
        this.videoItem.getPopupLayout().addView(this.videoQualityLayout);
        ActionBarMenuSubItem actionBarMenuSubItemAddSubItem = this.videoItem.addSubItem(22, R.drawable.menu_video_loop, LocaleController.getString(R.string.VideoPlayerLoop));
        this.loopItem = actionBarMenuSubItemAddSubItem;
        actionBarMenuSubItemAddSubItem.setSelectorColor(268435455);
        CastMediaRouteButton castMediaRouteButton = new CastMediaRouteButton(this.activityContext) { // from class: org.telegram.ui.PhotoViewer.18
            @Override // org.telegram.ui.Components.CastMediaRouteButton
            public void stateUpdated(boolean z3) {
                if (PhotoViewer.this.castItem != null) {
                    PhotoViewer.this.castItem.setEnabledByColor(z3, -1, -9194260);
                    PhotoViewer.this.castItem.setSelectorColor(z3 ? 259241196 : 268435455);
                }
                if (PhotoViewer.this.videoPlayer != null) {
                    PhotoViewer.this.videoPlayer.setMute(CastSync.isActive() || PhotoViewer.this.muteVideo);
                }
                if (PhotoViewer.this.videoItemIcon != null) {
                    PhotoViewer.this.videoItemIcon.setCasting(CastSync.isActive(), true);
                }
            }
        };
        this.castItemButton = castMediaRouteButton;
        try {
            castMediaRouteButton.setRouteSelector(CastContext.getSharedInstance(this.activityContext).getMergedSelector());
            z = true;
        } catch (Exception e) {
            FileLog.e(e);
            z = false;
        }
        this.castItemButton.setVisibility(4);
        if (z) {
            ActionBarMenuSubItem actionBarMenuSubItemAddSubItem2 = this.videoItem.addSubItem(24, R.drawable.menu_video_chromecast, LocaleController.getString(R.string.VideoPlayerChromecast));
            this.castItem = actionBarMenuSubItemAddSubItem2;
            actionBarMenuSubItemAddSubItem2.setEnabledByColor(false, -1, -9194260);
            this.castItem.setSelectorColor(268435455);
            this.castItem.addView(this.castItemButton, 0, LayoutHelper.createFrame(-1, -1.0f));
        }
        this.videoItem.redrawPopup(-115203550);
        this.videoItem.setOnMenuDismiss(new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda62
            @Override // org.telegram.messenger.Utilities.Callback
            public final void run(Object obj) {
                this.f$0.lambda$setParentActivity$8((Boolean) obj);
            }
        });
        ActionBarMenuItem actionBarMenuItemAddItem5 = this.menu.addItem(0, R.drawable.media_more);
        this.menuItem = actionBarMenuItemAddItem5;
        actionBarMenuItemAddItem5.setContentDescription(LocaleController.getString(R.string.AccDescrMoreOptions));
        this.menuItem.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda63
            @Override // android.view.View.OnClickListener
            public final void onClick(View view) {
                this.f$0.lambda$setParentActivity$9(view);
            }
        });
        this.menuItem.setOnMenuDismiss(new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda64
            @Override // org.telegram.messenger.Utilities.Callback
            public final void run(Object obj) {
                this.f$0.lambda$setParentActivity$10((Boolean) obj);
            }
        });
        this.menuItem.getPopupLayout().setSwipeBackForegroundColor(-14540254);
        this.menuItem.getPopupLayout().swipeBackGravityRight = true;
        this.menuItem.getPopupLayout().setFitItems(true);
        this.chooseDownloadQualityLayout = new ChooseDownloadQualityLayout(this.activityContext, this.menuItem.getPopupLayout().getSwipeBack(), new ChooseDownloadQualityLayout.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda65
            @Override // org.telegram.ui.ChooseDownloadQualityLayout.Callback
            public final void onQualitySelected(MessageObject messageObject, VideoPlayer.Quality quality) {
                this.f$0.lambda$setParentActivity$13(messageObject, quality);
            }
        });
        ActionBarMenuSubItem colors = this.menuItem.addSwipeBackItem(R.drawable.msg_gallery, null, LocaleController.getString(R.string.SaveToGallery), this.chooseDownloadQualityLayout.layout).setColors(-328966, -328966);
        this.galleryButton = colors;
        colors.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda20
            @Override // android.view.View.OnClickListener
            public final void onClick(View view) {
                this.f$0.lambda$setParentActivity$14(view);
            }
        });
        ActionBarPopupWindow.GapView gapViewAddColoredGap2 = this.menuItem.addColoredGap();
        this.galleryGap = gapViewAddColoredGap2;
        gapViewAddColoredGap2.setColor(-15198184);
        this.menuItem.addSubItem(10, R.drawable.msg_openin, LocaleController.getString(R.string.OpenInExternalApp)).setColors(-328966, -328966);
        this.pipItem = this.menuItem.addSubItem(6, R.drawable.menu_video_pip, LocaleController.getString(R.string.PipMinimize)).setColors(-328966, -328966);
        ActionBarMenuSubItem actionBarMenuSubItemAddSubItem3 = this.menuItem.addSubItem(3, R.drawable.msg_media, LocaleController.getString(R.string.ShowAllMedia));
        this.allMediaItem = actionBarMenuSubItemAddSubItem3;
        actionBarMenuSubItemAddSubItem3.setColors(-328966, -328966);
        this.menuItem.addSubItem(12, R.drawable.msg_gif, LocaleController.getString(R.string.SaveToGIFs)).setColors(-328966, -328966);
        this.menuItem.addSubItem(5, R.drawable.msg_message, LocaleController.getString(R.string.ShowInChat)).setColors(-328966, -328966);
        this.menuItem.addSubItem(21, R.drawable.menu_reply, LocaleController.getString(R.string.Reply)).setColors(-328966, -328966);
        this.menuItem.addSubItem(23, R.drawable.msg_report, LocaleController.getString(R.string.ReportProfilePhoto)).setColors(-328966, -328966);
        this.menuItem.addSubItem(9, R.drawable.msg_shareout, LocaleController.getString(R.string.ShareFile)).setColors(-328966, -328966);
        this.menuItem.addSubItem(13, R.drawable.msg_sticker, LocaleController.getString(R.string.ShowStickers)).setColors(-328966, -328966);
        this.menuItem.addSubItem(14, R.drawable.msg_openprofile, LocaleController.getString(R.string.SetAsMain)).setColors(-328966, -328966);
        ActionBarMenuItem actionBarMenuItem = this.menuItem;
        int i3 = R.drawable.msg_translate;
        actionBarMenuItem.addSubItem(19, i3, LocaleController.getString(R.string.TranslateMessage)).setColors(-328966, -328966);
        this.menuItem.addSubItem(20, i3, LocaleController.getString(R.string.HideTranslation)).setColors(-328966, -328966);
        this.menuItem.addSubItem(7, R.drawable.msg_delete, LocaleController.getString(R.string.Delete)).setColors(-328966, -328966);
        this.menuItem.addSubItem(8, R.drawable.msg_cancel, LocaleController.getString(R.string.StopDownload)).setColors(-328966, -328966);
        this.menuItem.redrawPopup(-115203550);
        this.menuItem.hideSubItem(19);
        this.menuItem.hideSubItem(20);
        setMenuItemIcon(false, true);
        this.menuItem.setPopupItemsSelectorColor(268435455);
        this.menuItem.setSubMenuDelegate(new ActionBarMenuItem.ActionBarSubMenuItemDelegate() { // from class: org.telegram.ui.PhotoViewer.19
            @Override // org.telegram.ui.ActionBar.ActionBarMenuItem.ActionBarSubMenuItemDelegate
            public void onHideSubMenu() {
                if (PhotoViewer.this.videoPlayerControlVisible && PhotoViewer.this.isPlaying) {
                    PhotoViewer.this.scheduleActionBarHide();
                }
            }

            @Override // org.telegram.ui.ActionBar.ActionBarMenuItem.ActionBarSubMenuItemDelegate
            public void onShowSubMenu() {
                if (PhotoViewer.this.videoPlayerControlVisible && PhotoViewer.this.isPlaying) {
                    AndroidUtilities.cancelRunOnUIThread(PhotoViewer.this.hideActionBarRunnable);
                }
            }
        });
        FrameLayout frameLayout = new FrameLayout(this.activityContext) { // from class: org.telegram.ui.PhotoViewer.20
            @Override // android.view.ViewGroup, android.view.View
            protected void dispatchDraw(Canvas canvas) {
                super.dispatchDraw(canvas);
            }
        };
        this.bottomLayout = frameLayout;
        frameLayout.setBackgroundColor(2130706432);
        this.containerView.addView(this.bottomLayout, LayoutHelper.createFrame(-1, 48, 83));
        View view = new View(this.activityContext);
        this.navigationBar = view;
        view.setBackgroundColor(this.sendPhotoType == 11 ? -16777216 : 2130706432);
        this.windowView.addView(this.navigationBar, LayoutHelper.createFrame(-1.0f, this.navigationBarHeight / AndroidUtilities.density, 87));
        this.pressedDrawable[0] = new GradientDrawable(GradientDrawable.Orientation.LEFT_RIGHT, new int[]{838860800, 0});
        this.pressedDrawable[0].setShape(0);
        this.pressedDrawable[1] = new GradientDrawable(GradientDrawable.Orientation.RIGHT_LEFT, new int[]{838860800, 0});
        this.pressedDrawable[1].setShape(0);
        GroupedPhotosListView groupedPhotosListView = new GroupedPhotosListView(this.activityContext, AndroidUtilities.dp(10.0f));
        this.groupedPhotosListView = groupedPhotosListView;
        this.containerView.addView(groupedPhotosListView, LayoutHelper.createFrame(-1, 68, 83));
        this.groupedPhotosListView.setDelegate(new GroupedPhotosListView.GroupedPhotosListViewDelegate() { // from class: org.telegram.ui.PhotoViewer.21
            @Override // org.telegram.ui.Components.GroupedPhotosListView.GroupedPhotosListViewDelegate
            public boolean forceAll() {
                return PhotoViewer.this.placeProvider != null && PhotoViewer.this.placeProvider.forceAllInGroup();
            }

            @Override // org.telegram.ui.Components.GroupedPhotosListView.GroupedPhotosListViewDelegate
            public long getAvatarsDialogId() {
                return PhotoViewer.this.avatarsDialogId;
            }

            @Override // org.telegram.ui.Components.GroupedPhotosListView.GroupedPhotosListViewDelegate
            public int getCurrentAccount() {
                return PhotoViewer.this.currentAccount;
            }

            @Override // org.telegram.ui.Components.GroupedPhotosListView.GroupedPhotosListViewDelegate
            public int getCurrentIndex() {
                return PhotoViewer.this.currentIndex;
            }

            @Override // org.telegram.ui.Components.GroupedPhotosListView.GroupedPhotosListViewDelegate
            public ArrayList getImagesArr() {
                return PhotoViewer.this.imagesArr;
            }

            @Override // org.telegram.ui.Components.GroupedPhotosListView.GroupedPhotosListViewDelegate
            public ArrayList getImagesArrLocations() {
                return PhotoViewer.this.imagesArrLocations;
            }

            @Override // org.telegram.ui.Components.GroupedPhotosListView.GroupedPhotosListViewDelegate
            public List getPageBlockArr() {
                if (PhotoViewer.this.pageBlocksAdapter != null) {
                    return PhotoViewer.this.pageBlocksAdapter.getAll();
                }
                return null;
            }

            @Override // org.telegram.ui.Components.GroupedPhotosListView.GroupedPhotosListViewDelegate
            public Object getParentObject() {
                if (PhotoViewer.this.pageBlocksAdapter != null) {
                    return PhotoViewer.this.pageBlocksAdapter.getParentObject();
                }
                return null;
            }

            @Override // org.telegram.ui.Components.GroupedPhotosListView.GroupedPhotosListViewDelegate
            public int getSlideshowMessageId() {
                return PhotoViewer.this.slideshowMessageId;
            }

            @Override // org.telegram.ui.Components.GroupedPhotosListView.GroupedPhotosListViewDelegate
            public void onShowAnimationStart() {
                PhotoViewer.this.containerView.requestLayout();
            }

            @Override // org.telegram.ui.Components.GroupedPhotosListView.GroupedPhotosListViewDelegate
            public void onStopScrolling() {
                PhotoViewer photoViewer = PhotoViewer.this;
                if (photoViewer.shouldMessageObjectAutoPlayed(photoViewer.currentMessageObject)) {
                    PhotoViewer.this.playerAutoStarted = true;
                    PhotoViewer.this.onActionClick(true);
                    PhotoViewer.this.checkProgress(0, false, true);
                }
            }

            @Override // org.telegram.ui.Components.GroupedPhotosListView.GroupedPhotosListViewDelegate
            public void setCurrentIndex(int i4) throws Resources.NotFoundException {
                PhotoViewer.this.currentIndex = -1;
                if (PhotoViewer.this.currentThumb != null) {
                    PhotoViewer.this.currentThumb.release();
                    PhotoViewer.this.currentThumb = null;
                }
                PhotoViewer.this.dontAutoPlay = true;
                PhotoViewer.this.setImageIndex(i4);
                PhotoViewer.this.dontAutoPlay = false;
            }
        });
        for (int i4 = 0; i4 < 3; i4++) {
            this.fullscreenButton[i4] = new ImageView(this.parentActivity);
            this.fullscreenButton[i4].setImageResource(R.drawable.msg_maxvideo);
            this.fullscreenButton[i4].setContentDescription(LocaleController.getString("AccSwitchToFullscreen", R.string.AccSwitchToFullscreen));
            this.fullscreenButton[i4].setScaleType(ImageView.ScaleType.CENTER);
            this.fullscreenButton[i4].setBackground(Theme.createSelectorDrawable(1090519039));
            this.fullscreenButton[i4].setVisibility(4);
            this.fullscreenButton[i4].setAlpha(1.0f);
            this.containerView.addView(this.fullscreenButton[i4], LayoutHelper.createFrame(48, 48.0f));
            this.fullscreenButton[i4].setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda21
                @Override // android.view.View.OnClickListener
                public final void onClick(View view2) {
                    this.f$0.lambda$setParentActivity$15(view2);
                }
            });
        }
        this.textSelectionHelper = new TextSelectionHelper.SimpleTextSelectionHelper(null, new DarkThemeResourceProvider()) { // from class: org.telegram.ui.PhotoViewer.22
            @Override // org.telegram.ui.Cells.TextSelectionHelper
            public int getParentBottomPadding() {
                return 0;
            }
        };
        CaptionTextViewSwitcher captionTextViewSwitcher = new CaptionTextViewSwitcher(this.containerView.getContext());
        this.captionTextViewSwitcher = captionTextViewSwitcher;
        captionTextViewSwitcher.setFactory(new ViewSwitcher.ViewFactory() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda22
            @Override // android.widget.ViewSwitcher.ViewFactory
            public final View makeView() {
                return this.f$0.lambda$setParentActivity$16();
            }
        });
        this.captionTextViewSwitcher.setVisibility(4);
        setCaptionHwLayerEnabled(true);
        for (int i5 = 0; i5 < 3; i5++) {
            this.photoProgressViews[i5] = new PhotoProgressView(this.containerView) { // from class: org.telegram.ui.PhotoViewer.23
                @Override // org.telegram.ui.PhotoViewer.PhotoProgressView
                protected void onBackgroundStateUpdated(int i6) {
                    if (this == PhotoViewer.this.photoProgressViews[0]) {
                        PhotoViewer.this.updateAccessibilityOverlayVisibility();
                    }
                }

                @Override // org.telegram.ui.PhotoViewer.PhotoProgressView
                protected void onVisibilityChanged(boolean z3) {
                    if (this == PhotoViewer.this.photoProgressViews[0]) {
                        PhotoViewer.this.updateAccessibilityOverlayVisibility();
                    }
                }
            };
            this.photoProgressViews[i5].setBackgroundState(0, false, true);
        }
        RadialProgressView radialProgressView = new RadialProgressView(this.activityContext, resourcesProvider) { // from class: org.telegram.ui.PhotoViewer.24
            @Override // android.view.View
            public void invalidate() {
                super.invalidate();
                if (PhotoViewer.this.containerView != null) {
                    PhotoViewer.this.containerView.invalidate();
                }
            }

            @Override // org.telegram.ui.Components.RadialProgressView, android.view.View
            public void setAlpha(float f) {
                super.setAlpha(f);
                if (PhotoViewer.this.containerView != null) {
                    PhotoViewer.this.containerView.invalidate();
                }
            }
        };
        this.miniProgressView = radialProgressView;
        radialProgressView.setUseSelfAlpha(true);
        this.miniProgressView.setProgressColor(-1);
        this.miniProgressView.setSize(AndroidUtilities.dp(54.0f));
        RadialProgressView radialProgressView2 = this.miniProgressView;
        int i6 = R.drawable.circle_big;
        radialProgressView2.setBackgroundResource(i6);
        this.miniProgressView.setVisibility(4);
        this.miniProgressView.setAlpha(BitmapDescriptorFactory.HUE_RED);
        this.containerView.addView(this.miniProgressView, LayoutHelper.createFrame(64, 64, 17));
        createVideoControlsInterface();
        RadialProgressView radialProgressView3 = new RadialProgressView(this.parentActivity, resourcesProvider);
        this.progressView = radialProgressView3;
        radialProgressView3.setProgressColor(-1);
        this.progressView.setBackgroundResource(i6);
        this.progressView.setVisibility(4);
        this.containerView.addView(this.progressView, LayoutHelper.createFrame(54, 54, 17));
        PickerBottomLayoutViewer pickerBottomLayoutViewer = new PickerBottomLayoutViewer(this.parentActivity);
        this.qualityPicker = pickerBottomLayoutViewer;
        pickerBottomLayoutViewer.setBackgroundColor(2130706432);
        this.qualityPicker.updateSelectedCount(0, false);
        this.qualityPicker.setTranslationY(AndroidUtilities.dp(120.0f));
        this.qualityPicker.doneButton.setText(LocaleController.getString("Done", R.string.Done).toUpperCase());
        TextView textView = this.qualityPicker.doneButton;
        int i7 = Theme.key_chat_editMediaButton;
        textView.setTextColor(getThemedColor(i7));
        this.containerView.addView(this.qualityPicker, LayoutHelper.createFrame(-1, 48, 83));
        this.qualityPicker.cancelButton.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda23
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$17(view2);
            }
        });
        this.qualityPicker.doneButton.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda24
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$18(view2);
            }
        });
        VideoForwardDrawable videoForwardDrawable = new VideoForwardDrawable(false);
        this.videoForwardDrawable = videoForwardDrawable;
        videoForwardDrawable.setDelegate(new VideoForwardDrawable.VideoForwardDrawableDelegate() { // from class: org.telegram.ui.PhotoViewer.25
            @Override // org.telegram.ui.Components.VideoForwardDrawable.VideoForwardDrawableDelegate
            public void invalidate() {
                PhotoViewer.this.containerView.invalidate();
            }

            @Override // org.telegram.ui.Components.VideoForwardDrawable.VideoForwardDrawableDelegate
            public void onAnimationEnd() {
            }
        });
        final FrameLayoutDrawer frameLayoutDrawer2 = this.containerView;
        Objects.requireNonNull(frameLayoutDrawer2);
        this.seekSpeedDrawable = new SeekSpeedDrawable(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda25
            @Override // java.lang.Runnable
            public final void run() {
                frameLayoutDrawer2.invalidate();
            }
        }, false, false);
        QualityChooseView qualityChooseView = new QualityChooseView(this.parentActivity);
        this.qualityChooseView = qualityChooseView;
        qualityChooseView.setTranslationY(AndroidUtilities.dp(120.0f));
        this.qualityChooseView.setVisibility(4);
        this.qualityChooseView.setBackgroundColor(2130706432);
        this.containerView.addView(this.qualityChooseView, LayoutHelper.createFrame(-1, 70.0f, 83, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 48.0f));
        new Paint().setColor(2130706432);
        FrameLayout frameLayout2 = new FrameLayout(this.activityContext) { // from class: org.telegram.ui.PhotoViewer.26
            private final Paint bgPaint = new Paint(3);
            private final LinearGradient bgGradient = new LinearGradient(BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 16.0f, new int[]{0, 2130706432}, new float[]{BitmapDescriptorFactory.HUE_RED, 1.0f}, Shader.TileMode.CLAMP);
            private final Matrix bgMatrix = new Matrix();

            @Override // android.view.ViewGroup, android.view.View
            protected void dispatchDraw(Canvas canvas) {
                if (!PhotoViewer.this.fancyShadows) {
                    int measuredHeight = PhotoViewer.this.doneButtonFullWidth.getVisibility() == 0 ? getMeasuredHeight() - AndroidUtilities.dp(48.0f) : 0;
                    if (PhotoViewer.this.sendPhotoType == 0 || PhotoViewer.this.sendPhotoType == 2 || PhotoViewer.this.sendPhotoType == -1) {
                        this.bgMatrix.reset();
                        float fMin = Math.min(AndroidUtilities.dp(40.0f), getMeasuredHeight() - measuredHeight);
                        this.bgMatrix.postTranslate(BitmapDescriptorFactory.HUE_RED, measuredHeight);
                        this.bgMatrix.postScale(1.0f, fMin / 16.0f);
                        this.bgGradient.setLocalMatrix(this.bgMatrix);
                        this.bgPaint.setShader(this.bgGradient);
                    } else {
                        this.bgPaint.setShader(null);
                        this.bgPaint.setColor(2130706432);
                    }
                    canvas.drawRect(BitmapDescriptorFactory.HUE_RED, measuredHeight, getMeasuredWidth(), getMeasuredHeight(), this.bgPaint);
                }
                super.dispatchDraw(canvas);
            }

            @Override // android.widget.FrameLayout, android.view.ViewGroup, android.view.View
            protected void onLayout(boolean z3, int i8, int i9, int i10, int i11) {
                super.onLayout(z3, i8, i9, i10, i11);
                if (PhotoViewer.this.itemsLayout.getVisibility() != 8) {
                    int iDp = (((i10 - i8) - (PhotoViewer.this.pickerViewSendButton.getVisibility() == 0 ? AndroidUtilities.dp(70.0f) : 0)) - PhotoViewer.this.itemsLayout.getMeasuredWidth()) / 2;
                    PhotoViewer.this.itemsLayout.layout(iDp, PhotoViewer.this.itemsLayout.getTop(), PhotoViewer.this.itemsLayout.getMeasuredWidth() + iDp, PhotoViewer.this.itemsLayout.getTop() + PhotoViewer.this.itemsLayout.getMeasuredHeight());
                }
            }

            @Override // android.widget.FrameLayout, android.view.View
            protected void onMeasure(int i8, int i9) {
                ((FrameLayout.LayoutParams) PhotoViewer.this.itemsLayout.getLayoutParams()).rightMargin = PhotoViewer.this.pickerViewSendButton.getVisibility() == 0 ? AndroidUtilities.dp(70.0f) : 0;
                super.onMeasure(i8, i9);
            }

            @Override // android.view.View
            public void setAlpha(float f) {
                super.setAlpha(f);
                if (PhotoViewer.this.videoTimelineViewContainer != null && PhotoViewer.this.videoTimelineViewContainer.getVisibility() != 8) {
                    PhotoViewer.this.videoTimelineViewContainer.setAlpha(f);
                }
                if (PhotoViewer.this.captionEdit != null && PhotoViewer.this.captionEdit.getVisibility() != 8) {
                    PhotoViewer.this.captionEdit.setAlpha(PhotoViewer.this.captionEditAlpha[0] * f);
                }
                if (PhotoViewer.this.topCaptionEdit == null || PhotoViewer.this.topCaptionEdit.getVisibility() == 8) {
                    return;
                }
                PhotoViewer.this.topCaptionEdit.setAlpha(f * PhotoViewer.this.topCaptionEditAlpha[0]);
            }

            @Override // android.view.View
            public void setTranslationY(float f) {
                super.setTranslationY(f);
                if (PhotoViewer.this.videoTimelineViewContainer != null && PhotoViewer.this.videoTimelineViewContainer.getVisibility() != 8) {
                    PhotoViewer.this.videoTimelineViewContainer.setTranslationY(PhotoViewer.this.pickerView.getTranslationY() - (Math.max(0, PhotoViewer.this.captionEdit.getEditTextHeight() - AndroidUtilities.dp(46.0f)) * PhotoViewer.this.captionEdit.getAlpha()));
                }
                if (PhotoViewer.this.captionEditContainer != null) {
                    PhotoViewer.this.captionEditContainer.setTranslationY(f);
                }
                if (PhotoViewer.this.videoAvatarTooltip == null || PhotoViewer.this.videoAvatarTooltip.getVisibility() == 8) {
                    return;
                }
                PhotoViewer.this.videoAvatarTooltip.setTranslationY(f);
            }

            @Override // android.view.View
            public void setVisibility(int i8) {
                super.setVisibility(i8);
                if (PhotoViewer.this.videoTimelineViewContainer == null || PhotoViewer.this.videoTimelineViewContainer.getVisibility() == 8) {
                    return;
                }
                PhotoViewer.this.videoTimelineViewContainer.setVisibility(i8 == 0 ? 0 : 4);
            }
        };
        this.pickerView = frameLayout2;
        this.containerView.addView(frameLayout2, LayoutHelper.createFrame(-1, -2, 83));
        TextView textView2 = new TextView(this.containerView.getContext());
        this.docNameTextView = textView2;
        textView2.setTextSize(1, 15.0f);
        this.docNameTextView.setTypeface(AndroidUtilities.bold());
        this.docNameTextView.setSingleLine(true);
        this.docNameTextView.setMaxLines(1);
        TextView textView3 = this.docNameTextView;
        TextUtils.TruncateAt truncateAt = TextUtils.TruncateAt.END;
        textView3.setEllipsize(truncateAt);
        this.docNameTextView.setTextColor(-1);
        this.docNameTextView.setGravity(3);
        this.pickerView.addView(this.docNameTextView, LayoutHelper.createFrame(-1, -2.0f, 51, 20.0f, 23.0f, 84.0f, BitmapDescriptorFactory.HUE_RED));
        TextView textView4 = new TextView(this.containerView.getContext());
        this.docInfoTextView = textView4;
        textView4.setTextSize(1, 14.0f);
        this.docInfoTextView.setSingleLine(true);
        this.docInfoTextView.setMaxLines(1);
        this.docInfoTextView.setEllipsize(truncateAt);
        this.docInfoTextView.setTextColor(-1);
        this.docInfoTextView.setGravity(3);
        this.pickerView.addView(this.docInfoTextView, LayoutHelper.createFrame(-1, -2.0f, 51, 20.0f, 46.0f, 84.0f, BitmapDescriptorFactory.HUE_RED));
        TextView textView5 = new TextView(this.containerView.getContext());
        this.doneButtonFullWidth = textView5;
        int i8 = Theme.key_featuredStickers_addButton;
        textView5.setBackground(Theme.AdaptiveRipple.filledRect(getThemedColor(i8), 6.0f));
        TextView textView6 = this.doneButtonFullWidth;
        int i9 = Theme.key_featuredStickers_buttonText;
        textView6.setTextColor(getThemedColor(i9));
        this.doneButtonFullWidth.setEllipsize(truncateAt);
        this.doneButtonFullWidth.setGravity(17);
        this.doneButtonFullWidth.setLines(1);
        this.doneButtonFullWidth.setSingleLine(true);
        this.doneButtonFullWidth.setText(LocaleController.getString("SetAsMyPhoto", R.string.SetAsMyPhoto));
        this.doneButtonFullWidth.setTextSize(1, 15.0f);
        this.doneButtonFullWidth.setTypeface(AndroidUtilities.bold());
        this.doneButtonFullWidth.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda26
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$19(view2);
            }
        });
        this.doneButtonFullWidth.setVisibility(8);
        this.pickerView.addView(this.doneButtonFullWidth, LayoutHelper.createFrame(-1, 48.0f, 51, 20.0f, BitmapDescriptorFactory.HUE_RED, 20.0f, 64.0f));
        VideoTimelinePlayView videoTimelinePlayView = new VideoTimelinePlayView(this.parentActivity) { // from class: org.telegram.ui.PhotoViewer.27
            private final BlurringShader.StoryBlurDrawer blur;
            private final Path path = new Path();

            {
                this.blur = new BlurringShader.StoryBlurDrawer(PhotoViewer.this.blurManager, this, 0);
            }

            @Override // org.telegram.ui.Components.VideoTimelinePlayView
            protected boolean customBlur() {
                return true;
            }

            @Override // org.telegram.ui.Components.VideoTimelinePlayView
            protected void drawBlur(Canvas canvas, RectF rectF) {
                canvas.save();
                canvas.clipRect(rectF);
                canvas.translate((-getX()) - PhotoViewer.this.videoTimelineViewContainer.getX(), (-getY()) - PhotoViewer.this.videoTimelineViewContainer.getY());
                PhotoViewer.this.drawCaptionBlur(canvas, this.blur, -14803426, AndroidUtilities.DARK_STATUS_BAR_OVERLAY, false, true, false);
                canvas.restore();
            }

            @Override // android.view.View
            public void invalidate() {
                if (SharedConfig.photoViewerBlur && (PhotoViewer.this.animationInProgress == 1 || PhotoViewer.this.animationInProgress == 2 || PhotoViewer.this.animationInProgress == 3)) {
                    return;
                }
                super.invalidate();
            }

            @Override // android.view.View
            public void setTranslationY(float f) {
                if (getTranslationY() != f) {
                    super.setTranslationY(f);
                    PhotoViewer.this.containerView.invalidate();
                }
            }
        };
        this.videoTimelineView = videoTimelinePlayView;
        videoTimelinePlayView.setDelegate(new AnonymousClass28());
        FrameLayout frameLayout3 = new FrameLayout(this.parentActivity);
        this.videoTimelineViewContainer = frameLayout3;
        frameLayout3.setClipChildren(false);
        this.videoTimelineViewContainer.addView(this.videoTimelineView, LayoutHelper.createFrame(-1, 54, 83));
        showVideoTimeline(false, false);
        this.containerView.addView(this.videoTimelineViewContainer, LayoutHelper.createFrame(-1, 54.0f, 83, BitmapDescriptorFactory.HUE_RED, 8.0f, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED));
        EditCoverButton editCoverButton = new EditCoverButton(this.parentActivity, this, LocaleController.getString(R.string.EditorSetCover), true);
        this.editCoverButton = editCoverButton;
        editCoverButton.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda27
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$20(view2);
            }
        });
        this.containerView.addView(this.editCoverButton, LayoutHelper.createFrame(-1, 32.0f, 87, 60.0f, BitmapDescriptorFactory.HUE_RED, 60.0f, BitmapDescriptorFactory.HUE_RED));
        PhotoViewerCoverEditor photoViewerCoverEditor = new PhotoViewerCoverEditor(this.parentActivity, resourcesProvider, this, this.blurManager);
        this.coverEditor = photoViewerCoverEditor;
        photoViewerCoverEditor.setVisibility(8);
        this.coverEditor.setAlpha(BitmapDescriptorFactory.HUE_RED);
        this.coverEditor.setOnClose(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda28
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$setParentActivity$21();
            }
        });
        this.containerView.addView(this.coverEditor, LayoutHelper.createFrame(-1, -1, R.styleable.AppCompatTheme_windowActionModeOverlay));
        this.coverEditor.button.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda29
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$28(view2);
            }
        });
        this.coverEditor.setOnGalleryImage(new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda30
            @Override // org.telegram.messenger.Utilities.Callback
            public final void run(Object obj) {
                this.f$0.lambda$setParentActivity$33((MediaController.PhotoEntry) obj);
            }
        });
        ImageView imageView = new ImageView(this.parentActivity) { // from class: org.telegram.ui.PhotoViewer.29
            @Override // android.view.View
            public void setTranslationY(float f) {
                super.setTranslationY(f);
                if (PhotoViewer.this.muteHints != null) {
                    Iterator it = PhotoViewer.this.muteHints.iterator();
                    while (it.hasNext()) {
                        ((HintView2) it.next()).setTranslationY(f);
                    }
                }
                if (PhotoViewer.this.editCoverButton != null) {
                    PhotoViewer.this.editCoverButton.setTranslationY(f);
                }
            }
        };
        this.muteButton = imageView;
        ImageView.ScaleType scaleType = ImageView.ScaleType.CENTER;
        imageView.setScaleType(scaleType);
        ImageView imageView2 = this.muteButton;
        MuteDrawable muteDrawable = new MuteDrawable(this.parentActivity);
        this.muteDrawable = muteDrawable;
        imageView2.setImageDrawable(muteDrawable);
        this.muteButton.setColorFilter(new PorterDuffColorFilter(-1, PorterDuff.Mode.SRC_IN));
        this.muteButton.setBackground(new PhotoViewerBlurDrawable(this, this.blurManager, this.muteButton));
        ScaleStateListAnimator.apply(this.muteButton);
        this.containerView.addView(this.muteButton, LayoutHelper.createFrame(32, 32.0f, 83, 12.0f, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED));
        this.muteButton.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda31
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$35(view2);
            }
        });
        Context context = this.containerView.getContext();
        FrameLayout frameLayout4 = this.windowView;
        FrameLayoutDrawer frameLayoutDrawer3 = this.containerView;
        int i10 = 0;
        CaptionPhotoViewer captionPhotoViewer2 = new CaptionPhotoViewer(context, frameLayout4, frameLayoutDrawer3, frameLayoutDrawer3, resourcesProvider, this.blurManager, new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda32
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.applyCaption();
            }
        }) { // from class: org.telegram.ui.PhotoViewer.30
            private final Path path = new Path();

            private void updateMoveCaptionButton() {
                setShowMoveButtonVisible(PhotoViewer.this.placeProvider != null && PhotoViewer.this.placeProvider.canMoveCaptionAbove() && (PhotoViewer.this.captionEdit.keyboardNotifier.keyboardVisible() || !(PhotoViewer.this.isCurrentVideo || TextUtils.isEmpty(PhotoViewer.this.getCaptionView().getText()))), true);
            }

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            protected boolean captionLimitToast() {
                if (PhotoViewer.this.limitBulletin != null && Bulletin.getVisibleBulletin() == PhotoViewer.this.limitBulletin) {
                    return false;
                }
                PhotoViewer photoViewer = PhotoViewer.this;
                return photoViewer.showCaptionLimitBulletin(photoViewer.containerView);
            }

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            protected boolean customBlur() {
                return true;
            }

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            protected void drawBlur(BlurringShader.StoryBlurDrawer storyBlurDrawer, Canvas canvas, RectF rectF, float f, boolean z3, float f2, float f3, boolean z4, float f4) {
                canvas.save();
                this.path.rewind();
                this.path.addRoundRect(rectF, f, f, Path.Direction.CW);
                canvas.clipPath(this.path);
                if (z4) {
                    canvas.translate(((-getX()) - PhotoViewer.this.captionEditContainer.getX()) + f2, ((-getY()) - PhotoViewer.this.captionEditContainer.getY()) + f3);
                } else {
                    canvas.translate(f2, f3);
                }
                PhotoViewer.this.drawCaptionBlur(canvas, storyBlurDrawer, Theme.multAlpha(z3 ? -8882056 : -14277082, f4), Theme.multAlpha(z4 ? z3 ? 0 : AndroidUtilities.DARK_STATUS_BAR_OVERLAY : 1140850688, f4), false, !z3, !z3 && z4);
                canvas.restore();
            }

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            protected boolean ignoreTouches(float f, float f2) {
                return (this.keyboardShown || PhotoViewer.this.currentEditMode == 0) ? false : true;
            }

            @Override // android.view.View
            public void invalidate() {
                if (SharedConfig.photoViewerBlur && (PhotoViewer.this.animationInProgress == 1 || PhotoViewer.this.animationInProgress == 2 || PhotoViewer.this.animationInProgress == 3)) {
                    return;
                }
                super.invalidate();
            }

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            protected boolean isAtTop() {
                return false;
            }

            @Override // org.telegram.ui.Components.CaptionPhotoViewer
            protected void onMoveButtonClick() {
                PhotoViewer.this.toggleCaptionAbove();
            }

            @Override // org.telegram.ui.Components.CaptionPhotoViewer, org.telegram.ui.Stories.recorder.CaptionContainerView
            protected void onUpdateShowKeyboard(float f) {
                super.onUpdateShowKeyboard(f);
                float f2 = 1.0f - f;
                PhotoViewer.this.muteButton.setAlpha((PhotoViewer.this.muteButton.getTag() != null ? 1 : 0) * f2);
                PhotoViewer.this.videoTimelineViewContainer.setAlpha(f2 * (PhotoViewer.this.videoTimelineViewContainer.getTag() != null ? 1 : 0));
            }

            @Override // org.telegram.ui.Components.CaptionPhotoViewer
            protected void openedKeyboard() {
                expandMoveButton();
                if (PhotoViewer.this.topCaptionEdit != null) {
                    PhotoViewer.this.topCaptionEdit.expandMoveButton();
                }
            }

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            public void setText(CharSequence charSequence) {
                super.setText(charSequence);
                updateMoveCaptionButton();
            }

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            protected void setupMentionContainer() {
                this.mentionContainer.getAdapter().setAllowStickers(false);
                this.mentionContainer.getAdapter().setAllowBots(false);
                this.mentionContainer.getAdapter().setAllowChats(false);
                this.mentionContainer.getAdapter().setSearchInDailogs(true);
                if (PhotoViewer.this.parentChatActivity != null) {
                    this.mentionContainer.getAdapter().setChatInfo(PhotoViewer.this.parentChatActivity.chatInfo);
                    this.mentionContainer.getAdapter().setNeedUsernames(PhotoViewer.this.parentChatActivity.currentChat != null);
                } else {
                    this.mentionContainer.getAdapter().setChatInfo(null);
                    this.mentionContainer.getAdapter().setNeedUsernames(false);
                }
                this.mentionContainer.getAdapter().setNeedBotContext(false);
            }

            @Override // org.telegram.ui.Components.CaptionPhotoViewer
            protected boolean showMoveButton() {
                return PhotoViewer.this.placeProvider != null && PhotoViewer.this.placeProvider.canMoveCaptionAbove();
            }

            @Override // org.telegram.ui.Components.CaptionPhotoViewer, org.telegram.ui.Stories.recorder.CaptionContainerView
            public void updateKeyboard(int i11) {
                super.updateKeyboard(i11);
                Bulletin visibleBulletin = Bulletin.getVisibleBulletin();
                if (visibleBulletin != null) {
                    visibleBulletin.updatePosition();
                }
                updateMoveCaptionButton();
                boolean z3 = false;
                if (PhotoViewer.this.bottomBulletinUnderCaption != null) {
                    PhotoViewer.this.bottomBulletinUnderCaption.animate().translationY(-Math.max(0, i11 - PhotoViewer.this.pickerView.getHeight())).setDuration(250L).setInterpolator(AdjustPanLayoutHelper.keyboardInterpolator).start();
                }
                PhotoViewer.this.actionBar.animate().alpha((!PhotoViewer.this.isActionBarVisible || (PhotoViewer.this.getCaptionView() == PhotoViewer.this.topCaptionEdit && PhotoViewer.this.topCaptionEdit.keyboardNotifier.keyboardVisible())) ? BitmapDescriptorFactory.HUE_RED : 1.0f).start();
                if (PhotoViewer.this.pickerView.getVisibility() == 0) {
                    PhotoViewer photoViewer = PhotoViewer.this;
                    if (photoViewer.isActionBarVisible && (PhotoViewer.this.getCaptionView() != PhotoViewer.this.topCaptionEdit || !PhotoViewer.this.topCaptionEdit.keyboardNotifier.keyboardVisible())) {
                        z3 = true;
                    }
                    photoViewer.toggleOnlyCheckImageView(z3);
                }
            }

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            public void updateMentionsLayoutPosition() {
                MentionsContainerView mentionsContainerView = this.mentionContainer;
                if (mentionsContainerView != null) {
                    mentionsContainerView.setTranslationY((-getEditTextHeight()) - this.keyboardNotifier.getKeyboardHeight());
                }
            }
        };
        this.captionEdit = captionPhotoViewer2;
        captionPhotoViewer2.setOnTimerChange(new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda33
            @Override // org.telegram.messenger.Utilities.Callback
            public final void run(Object obj) {
                this.f$0.lambda$setParentActivity$36((Integer) obj);
            }
        });
        this.captionEdit.setAccount(this.currentAccount);
        this.captionEdit.setOnHeightUpdate(new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda34
            @Override // org.telegram.messenger.Utilities.Callback
            public final void run(Object obj) {
                this.f$0.lambda$setParentActivity$37((Integer) obj);
            }
        });
        this.captionEdit.setOnAddPhotoClick(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda35
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$38(view2);
            }
        });
        Context context2 = this.activityContext;
        FrameLayout frameLayout5 = this.windowView;
        FrameLayoutDrawer frameLayoutDrawer4 = this.containerView;
        CaptionPhotoViewer captionPhotoViewer3 = new CaptionPhotoViewer(context2, frameLayout5, frameLayoutDrawer4, frameLayoutDrawer4, resourcesProvider, this.blurManager, new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda32
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.applyCaption();
            }
        }) { // from class: org.telegram.ui.PhotoViewer.31
            private final Path path = new Path();

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            protected boolean captionLimitToast() {
                if (PhotoViewer.this.limitBulletin != null && Bulletin.getVisibleBulletin() == PhotoViewer.this.limitBulletin) {
                    return false;
                }
                PhotoViewer photoViewer = PhotoViewer.this;
                return photoViewer.showCaptionLimitBulletin(photoViewer.containerView);
            }

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            protected boolean customBlur() {
                return true;
            }

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            protected void drawBlur(BlurringShader.StoryBlurDrawer storyBlurDrawer, Canvas canvas, RectF rectF, float f, boolean z3, float f2, float f3, boolean z4, float f4) {
                canvas.save();
                this.path.rewind();
                this.path.addRoundRect(rectF, f, f, Path.Direction.CW);
                canvas.clipPath(this.path);
                if (z4) {
                    canvas.translate(((-getX()) - PhotoViewer.this.topCaptionEditContainer.getX()) + f2, ((-getY()) - PhotoViewer.this.topCaptionEditContainer.getY()) + f3);
                } else {
                    canvas.translate(f2, f3);
                }
                PhotoViewer.this.drawCaptionBlur(canvas, storyBlurDrawer, Theme.multAlpha(z3 ? -8882056 : -14277082, f4), Theme.multAlpha(z4 ? z3 ? 0 : AndroidUtilities.DARK_STATUS_BAR_OVERLAY : 1140850688, f4), false, !z3, !z3 && z4);
                canvas.restore();
            }

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            protected boolean ignoreTouches(float f, float f2) {
                return (this.keyboardShown || PhotoViewer.this.currentEditMode == 0) ? false : true;
            }

            @Override // android.view.View
            public void invalidate() {
                if (SharedConfig.photoViewerBlur && (PhotoViewer.this.animationInProgress == 1 || PhotoViewer.this.animationInProgress == 2 || PhotoViewer.this.animationInProgress == 3)) {
                    return;
                }
                super.invalidate();
            }

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            protected boolean isAtTop() {
                return true;
            }

            @Override // org.telegram.ui.Components.CaptionPhotoViewer
            protected void onMoveButtonClick() {
                PhotoViewer.this.toggleCaptionAbove();
            }

            @Override // org.telegram.ui.Components.CaptionPhotoViewer
            protected void openedKeyboard() {
                expandMoveButton();
                if (PhotoViewer.this.captionEdit != null) {
                    PhotoViewer.this.captionEdit.expandMoveButton();
                }
            }

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            protected void setupMentionContainer() {
                this.mentionContainer.setReversed(true);
                this.mentionContainer.getAdapter().setAllowStickers(false);
                this.mentionContainer.getAdapter().setAllowBots(false);
                this.mentionContainer.getAdapter().setAllowChats(false);
                this.mentionContainer.getAdapter().setSearchInDailogs(true);
                if (PhotoViewer.this.parentChatActivity != null) {
                    this.mentionContainer.getAdapter().setChatInfo(PhotoViewer.this.parentChatActivity.chatInfo);
                    this.mentionContainer.getAdapter().setNeedUsernames(PhotoViewer.this.parentChatActivity.currentChat != null);
                } else {
                    this.mentionContainer.getAdapter().setChatInfo(null);
                    this.mentionContainer.getAdapter().setNeedUsernames(false);
                }
                this.mentionContainer.getAdapter().setNeedBotContext(false);
                this.mentionContainer.setLayoutParams(LayoutHelper.createFrame(-1, -1, 51));
            }

            @Override // org.telegram.ui.Components.CaptionPhotoViewer
            protected boolean showMoveButton() {
                return PhotoViewer.this.placeProvider != null && PhotoViewer.this.placeProvider.canMoveCaptionAbove();
            }

            @Override // org.telegram.ui.Components.CaptionPhotoViewer, org.telegram.ui.Stories.recorder.CaptionContainerView
            public void updateKeyboard(int i11) {
                super.updateKeyboard(i11);
                PhotoViewer.this.actionBar.animate().alpha((!PhotoViewer.this.isActionBarVisible || (PhotoViewer.this.getCaptionView() == PhotoViewer.this.topCaptionEdit && PhotoViewer.this.topCaptionEdit.keyboardNotifier.keyboardVisible())) ? BitmapDescriptorFactory.HUE_RED : 1.0f).start();
                if (PhotoViewer.this.pickerView.getVisibility() == 0) {
                    PhotoViewer photoViewer = PhotoViewer.this;
                    photoViewer.toggleOnlyCheckImageView(photoViewer.isActionBarVisible && !(PhotoViewer.this.getCaptionView() == PhotoViewer.this.topCaptionEdit && PhotoViewer.this.topCaptionEdit.keyboardNotifier.keyboardVisible()));
                }
            }

            @Override // org.telegram.ui.Stories.recorder.CaptionContainerView
            public void updateMentionsLayoutPosition() {
                MentionsContainerView mentionsContainerView = this.mentionContainer;
                if (mentionsContainerView != null) {
                    mentionsContainerView.setTranslationY(getEditTextHeight());
                }
            }
        };
        this.topCaptionEdit = captionPhotoViewer3;
        captionPhotoViewer3.setShowMoveButtonVisible(true, false);
        this.topCaptionEdit.setOnTimerChange(new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda36
            @Override // org.telegram.messenger.Utilities.Callback
            public final void run(Object obj) {
                this.f$0.lambda$setParentActivity$39((Integer) obj);
            }
        });
        this.topCaptionEdit.setAccount(this.currentAccount);
        this.topCaptionEdit.setOnHeightUpdate(new Utilities.Callback() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda37
            @Override // org.telegram.messenger.Utilities.Callback
            public final void run(Object obj) {
                this.f$0.lambda$setParentActivity$40((Integer) obj);
            }
        });
        this.topCaptionEdit.setOnAddPhotoClick(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda38
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$41(view2);
            }
        });
        StickerMakerBackgroundView stickerMakerBackgroundView = new StickerMakerBackgroundView(this.activityContext) { // from class: org.telegram.ui.PhotoViewer.32
            @Override // android.view.View
            public void setAlpha(float f) {
                super.setAlpha(f);
                PhotoViewer.this.windowView.invalidate();
            }
        };
        this.stickerMakerBackgroundView = stickerMakerBackgroundView;
        stickerMakerBackgroundView.setVisibility(8);
        this.containerView.addView(this.stickerMakerBackgroundView, LayoutHelper.createFrame(-1, -1.0f, 51, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED));
        StickerMakerView stickerMakerView2 = new StickerMakerView(this.activityContext, resourcesProvider);
        this.stickerMakerView = stickerMakerView2;
        stickerMakerView2.setCurrentAccount(this.currentAccount);
        FrameLayoutDrawer frameLayoutDrawer5 = this.containerView;
        frameLayoutDrawer5.addView(this.stickerMakerView, frameLayoutDrawer5.indexOfChild(this.actionBar) - 1, LayoutHelper.createFrame(-1, -1.0f, 51, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED));
        BlurButton blurButton = new BlurButton();
        this.cutOutBtn = blurButton;
        blurButton.setRad(18);
        this.cutOutBtn.wrapContentDynamic();
        this.stickerMakerView.setStickerCutOutBtn(this.cutOutBtn);
        this.cutOutBtn.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda39
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$47(view2);
            }
        });
        this.cutOutBtn.setCutOutState(false);
        this.containerView.addView(this.cutOutBtn, LayoutHelper.createFrame(-1, 36, 17));
        LinearLayout linearLayout2 = new LinearLayout(this.parentActivity);
        this.btnLayout = linearLayout2;
        linearLayout2.setOrientation(0);
        BlurButton blurButton2 = new BlurButton();
        this.eraseBtn = blurButton2;
        blurButton2.wrapContent();
        this.eraseBtn.setRad(18);
        this.eraseBtn.setEraseState(false);
        this.eraseBtn.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda40
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$48(view2);
            }
        });
        this.btnLayout.addView(this.eraseBtn, LayoutHelper.createLinear(-2, 36));
        this.btnLayout.addView(new Space(this.parentActivity), LayoutHelper.createLinear(12, -1));
        BlurButton blurButton3 = new BlurButton();
        this.restoreBtn = blurButton3;
        blurButton3.wrapContent();
        this.restoreBtn.setRad(18);
        this.restoreBtn.setRestoreState(false);
        this.restoreBtn.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda41
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$49(view2);
            }
        });
        this.btnLayout.addView(this.restoreBtn, LayoutHelper.createLinear(-2, 36));
        this.containerView.addView(this.btnLayout, LayoutHelper.createFrame(-2, 36, 17));
        BlurButton blurButton4 = new BlurButton();
        this.undoBtn = blurButton4;
        blurButton4.setUndoState(false);
        this.undoBtn.setRad(18);
        this.undoBtn.wrapContent();
        this.undoBtn.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda42
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$50(view2);
            }
        });
        this.containerView.addView(this.undoBtn, LayoutHelper.createFrame(-2, 36, 17));
        BlurButton blurButton5 = new BlurButton();
        this.outlineBtn = blurButton5;
        blurButton5.setOutlineState(false);
        this.outlineBtn.setRad(18);
        this.outlineBtn.wrapContent();
        this.outlineBtn.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda43
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$51(view2);
            }
        });
        this.containerView.addView(this.outlineBtn, LayoutHelper.createFrame(-2, 36, 17));
        showEditCaption(false, false);
        showStickerMode(false, false);
        FrameLayout frameLayout6 = new FrameLayout(this.parentActivity) { // from class: org.telegram.ui.PhotoViewer.33
            @Override // android.view.View
            public void setTranslationY(float f) {
                super.setTranslationY(f);
                PhotoViewer.this.invalidateBlur();
            }
        };
        this.captionEditContainer = frameLayout6;
        frameLayout6.addView(this.captionEdit, LayoutHelper.createFrame(-1, -1, 83));
        this.containerView.addView(this.captionEditContainer, LayoutHelper.createFrame(-1, -1.0f, 83, BitmapDescriptorFactory.HUE_RED, 8.0f, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED));
        FrameLayout frameLayout7 = new FrameLayout(this.parentActivity);
        this.topCaptionEditContainer = frameLayout7;
        frameLayout7.addView(this.topCaptionEdit, LayoutHelper.createFrame(-1, -1, 51));
        this.containerView.addView(this.topCaptionEditContainer, LayoutHelper.createFrame(-1, -1.0f, 51, BitmapDescriptorFactory.HUE_RED, 8.0f, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED));
        FrameLayout frameLayout8 = new FrameLayout(this.parentActivity);
        this.topBulletinUnderCaption = frameLayout8;
        this.containerView.addView(frameLayout8, LayoutHelper.createFrame(-1, 120.0f, 55, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED));
        FrameLayout frameLayout9 = new FrameLayout(this.parentActivity);
        this.bottomBulletinUnderCaption = frameLayout9;
        this.containerView.addView(frameLayout9, LayoutHelper.createFrame(-1, 120.0f, 87, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED));
        TextView textView7 = new TextView(this.parentActivity);
        this.videoAvatarTooltip = textView7;
        textView7.setSingleLine(true);
        this.videoAvatarTooltip.setVisibility(8);
        this.videoAvatarTooltip.setText(LocaleController.getString("ChooseCover", R.string.ChooseCover));
        this.videoAvatarTooltip.setGravity(1);
        this.videoAvatarTooltip.setTextSize(1, 14.0f);
        this.videoAvatarTooltip.setTextColor(-7566196);
        this.containerView.addView(this.videoAvatarTooltip, LayoutHelper.createFrame(-1, -2.0f, 83, BitmapDescriptorFactory.HUE_RED, 8.0f, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED));
        ChatActivityEnterView.SendButton sendButton = new ChatActivityEnterView.SendButton(this.parentActivity, R.drawable.msg_input_send_mini, resourcesProvider) { // from class: org.telegram.ui.PhotoViewer.34
            @Override // org.telegram.ui.Components.ChatActivityEnterView.SendButton
            public int getFillColor() {
                return PhotoViewer.this.getThemedColor(Theme.key_chat_editMediaButton);
            }

            @Override // org.telegram.ui.Components.ChatActivityEnterView.SendButton
            public boolean isInScheduleMode() {
                return super.isInScheduleMode();
            }

            @Override // org.telegram.ui.Components.ChatActivityEnterView.SendButton
            public boolean isInactive() {
                return false;
            }

            @Override // org.telegram.ui.Components.ChatActivityEnterView.SendButton
            public boolean isOpen() {
                return true;
            }

            @Override // org.telegram.ui.Components.ChatActivityEnterView.SendButton
            public boolean shouldDrawBackground() {
                return true;
            }
        };
        this.pickerViewSendButton = sendButton;
        sendButton.setCircleSize(AndroidUtilities.dp(48.0f));
        this.containerView.addView(this.pickerViewSendButton, LayoutHelper.createFrame(R.styleable.AppCompatTheme_windowFixedHeightMajor, 120.0f, 85, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 14.0f, 2.33f));
        this.pickerViewSendButton.setContentDescription(LocaleController.getString("Send", R.string.Send));
        ScaleStateListAnimator.apply(this.pickerViewSendButton);
        this.pickerViewSendButton.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda44
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$52(view2);
            }
        });
        this.pickerViewSendButton.setOnLongClickListener(new View.OnLongClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda45
            @Override // android.view.View.OnLongClickListener
            public final boolean onLongClick(View view2) {
                return this.f$0.lambda$setParentActivity$56(resourcesProvider, view2);
            }
        });
        LinearLayout linearLayout3 = new LinearLayout(this.parentActivity) { // from class: org.telegram.ui.PhotoViewer.35
            boolean ignoreLayout;

            @Override // android.widget.LinearLayout, android.view.View
            protected void onMeasure(int i11, int i12) {
                int childCount = getChildCount();
                int i13 = 0;
                for (int i14 = 0; i14 < childCount; i14++) {
                    if (getChildAt(i14).getVisibility() == 0) {
                        i13++;
                    }
                }
                int size = View.MeasureSpec.getSize(i11);
                int size2 = View.MeasureSpec.getSize(i12);
                if (i13 != 0) {
                    int iMin = Math.min(AndroidUtilities.dp(70.0f), size / i13);
                    if (PhotoViewer.this.compressItem.getVisibility() == 0) {
                        this.ignoreLayout = true;
                        int iMax = Math.max(0, (iMin - AndroidUtilities.dp(PhotoViewer.this.selectedCompression < 2 ? 48 : 64)) / 2);
                        PhotoViewer.this.compressItem.setPadding(iMax, 0, iMax, 0);
                        this.ignoreLayout = false;
                    }
                    for (int i15 = 0; i15 < childCount; i15++) {
                        View childAt = getChildAt(i15);
                        if (childAt.getVisibility() != 8) {
                            childAt.measure(View.MeasureSpec.makeMeasureSpec(iMin, 1073741824), View.MeasureSpec.makeMeasureSpec(size2, 1073741824));
                        }
                    }
                    size = iMin * i13;
                }
                setMeasuredDimension(size, size2);
            }
        };
        this.itemsLayout = linearLayout3;
        linearLayout3.setOrientation(0);
        this.pickerView.addView(this.itemsLayout, LayoutHelper.createFrame(-2, 48.0f, 81, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, 70.0f, BitmapDescriptorFactory.HUE_RED));
        ImageView imageView3 = new ImageView(this.parentActivity);
        this.cropItem = imageView3;
        imageView3.setScaleType(scaleType);
        this.cropItem.setImageResource(R.drawable.media_crop);
        this.cropItem.setBackgroundDrawable(Theme.createSelectorDrawable(1090519039));
        this.itemsLayout.addView(this.cropItem, LayoutHelper.createLinear(48, 48));
        this.cropItem.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda46
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$57(view2);
            }
        });
        this.cropItem.setContentDescription(LocaleController.getString("CropImage", R.string.CropImage));
        ImageView imageView4 = new ImageView(this.parentActivity);
        this.rotateItem = imageView4;
        imageView4.setScaleType(scaleType);
        this.rotateItem.setImageResource(R.drawable.msg_photo_rotate);
        this.rotateItem.setBackgroundDrawable(Theme.createSelectorDrawable(1090519039));
        this.itemsLayout.addView(this.rotateItem, LayoutHelper.createLinear(48, 48));
        this.rotateItem.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda47
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$58(view2);
            }
        });
        this.rotateItem.setContentDescription(LocaleController.getString("AccDescrRotate", R.string.AccDescrRotate));
        ImageView imageView5 = new ImageView(this.parentActivity);
        this.mirrorItem = imageView5;
        imageView5.setScaleType(scaleType);
        this.mirrorItem.setImageResource(R.drawable.media_flip);
        this.mirrorItem.setBackgroundDrawable(Theme.createSelectorDrawable(1090519039));
        this.itemsLayout.addView(this.mirrorItem, LayoutHelper.createLinear(48, 48));
        this.mirrorItem.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda48
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$59(view2);
            }
        });
        this.mirrorItem.setContentDescription(LocaleController.getString("AccDescrMirror", R.string.AccDescrMirror));
        ImageView imageView6 = new ImageView(this.parentActivity);
        this.paintItem = imageView6;
        imageView6.setScaleType(scaleType);
        this.paintItem.setImageResource(R.drawable.media_draw);
        this.paintItem.setBackgroundDrawable(Theme.createSelectorDrawable(1090519039));
        this.itemsLayout.addView(this.paintItem, LayoutHelper.createLinear(48, 48));
        this.paintItem.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda50
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$60(view2);
            }
        });
        this.paintItem.setContentDescription(LocaleController.getString("AccDescrPhotoEditor", R.string.AccDescrPhotoEditor));
        VideoCompressButton videoCompressButton = new VideoCompressButton(this.parentActivity);
        this.compressItem = videoCompressButton;
        videoCompressButton.setTag(1);
        this.compressItem.setBackground(Theme.createSelectorDrawable(1090519039));
        this.selectedCompression = selectCompression();
        this.compressItem.setState(this.videoConvertSupported && this.compressionsCount > 1, this.muteVideo, Math.min(this.resultWidth, this.resultHeight));
        this.compressItem.setContentDescription(LocaleController.getString("AccDescrVideoQuality", R.string.AccDescrVideoQuality));
        this.itemsLayout.addView(this.compressItem, LayoutHelper.createLinear(48, 48));
        this.compressItem.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda51
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$61(parentActivity, view2);
            }
        });
        ImageView imageView7 = new ImageView(this.parentActivity);
        this.tuneItem = imageView7;
        imageView7.setScaleType(scaleType);
        this.tuneItem.setImageResource(R.drawable.media_settings);
        this.tuneItem.setBackgroundDrawable(Theme.createSelectorDrawable(1090519039));
        this.itemsLayout.addView(this.tuneItem, LayoutHelper.createLinear(48, 48));
        this.tuneItem.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda52
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$62(view2);
            }
        });
        this.tuneItem.setContentDescription(LocaleController.getString("AccDescrPhotoAdjust", R.string.AccDescrPhotoAdjust));
        PickerBottomLayoutViewer pickerBottomLayoutViewer2 = new PickerBottomLayoutViewer(this.activityContext);
        this.editorDoneLayout = pickerBottomLayoutViewer2;
        pickerBottomLayoutViewer2.setBackgroundColor(-872415232);
        this.editorDoneLayout.updateSelectedCount(0, false);
        this.editorDoneLayout.setVisibility(8);
        this.containerView.addView(this.editorDoneLayout, LayoutHelper.createFrame(-1, 48, 83));
        this.editorDoneLayout.cancelButton.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda53
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$64(view2);
            }
        });
        this.editorDoneLayout.doneButton.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda54
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$65(view2);
            }
        });
        TextView textView8 = new TextView(this.activityContext);
        this.resetButton = textView8;
        textView8.setClickable(false);
        this.resetButton.setVisibility(8);
        this.resetButton.setTextSize(1, 14.0f);
        this.resetButton.setTextColor(-1);
        this.resetButton.setGravity(17);
        this.resetButton.setBackgroundDrawable(Theme.createSelectorDrawable(-12763843, 0));
        this.resetButton.setPadding(AndroidUtilities.dp(20.0f), 0, AndroidUtilities.dp(20.0f), 0);
        this.resetButton.setText(LocaleController.getString(R.string.CropReset).toUpperCase());
        this.resetButton.setTypeface(AndroidUtilities.bold());
        this.editorDoneLayout.addView(this.resetButton, LayoutHelper.createFrame(-2, -1, 49));
        this.resetButton.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda55
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$67(view2);
            }
        });
        GestureDetector2 gestureDetector2 = new GestureDetector2(this.containerView.getContext(), this);
        this.gestureDetector = gestureDetector2;
        gestureDetector2.setIsLongpressEnabled(false);
        setDoubleTapEnabled(true);
        ImageReceiver.ImageReceiverDelegate imageReceiverDelegate = new ImageReceiver.ImageReceiverDelegate() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda56
            @Override // org.telegram.messenger.ImageReceiver.ImageReceiverDelegate
            public final void didSetImage(ImageReceiver imageReceiver, boolean z3, boolean z4, boolean z5) {
                this.f$0.lambda$setParentActivity$68(imageReceiver, z3, z4, z5);
            }

            @Override // org.telegram.messenger.ImageReceiver.ImageReceiverDelegate
            public /* synthetic */ void didSetImageBitmap(int i11, String str, Drawable drawable) {
                ImageReceiver.ImageReceiverDelegate.CC.$default$didSetImageBitmap(this, i11, str, drawable);
            }

            @Override // org.telegram.messenger.ImageReceiver.ImageReceiverDelegate
            public /* synthetic */ void onAnimationReady(ImageReceiver imageReceiver) {
                ImageReceiver.ImageReceiverDelegate.CC.$default$onAnimationReady(this, imageReceiver);
            }
        };
        this.centerImage.setParentView(this.containerView);
        this.centerImage.setCrossfadeAlpha((byte) 2);
        this.centerImage.setInvalidateAll(true);
        this.centerImage.setDelegate(imageReceiverDelegate);
        this.leftImage.setParentView(this.containerView);
        this.leftImage.setCrossfadeAlpha((byte) 2);
        this.leftImage.setInvalidateAll(true);
        this.leftImage.setDelegate(imageReceiverDelegate);
        this.rightImage.setParentView(this.containerView);
        this.rightImage.setCrossfadeAlpha((byte) 2);
        this.rightImage.setInvalidateAll(true);
        this.rightImage.setDelegate(imageReceiverDelegate);
        int rotation = ((WindowManager) ApplicationLoader.applicationContext.getSystemService("window")).getDefaultDisplay().getRotation();
        CheckBox checkBox = new CheckBox(this.containerView.getContext(), R.drawable.selectphoto_large);
        this.checkImageView = checkBox;
        checkBox.setDrawBackground(true);
        this.checkImageView.setHasBorder(true);
        this.checkImageView.setSize(34);
        this.checkImageView.setCheckOffset(AndroidUtilities.dp(1.0f));
        this.checkImageView.setColor(getThemedColor(i7), -1);
        this.checkImageView.setVisibility(8);
        this.containerView.addView(this.checkImageView, LayoutHelper.createFrame(34, 34.0f, 53, BitmapDescriptorFactory.HUE_RED, (rotation == 3 || rotation == 1) ? 61.0f : 71.0f, 11.0f, BitmapDescriptorFactory.HUE_RED));
        if (isStatusBarVisible()) {
            ((FrameLayout.LayoutParams) this.checkImageView.getLayoutParams()).topMargin += AndroidUtilities.statusBarHeight;
        }
        this.checkImageView.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda57
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$69(view2);
            }
        });
        CounterView counterView = new CounterView(this.parentActivity);
        this.photosCounterView = counterView;
        this.containerView.addView(counterView, LayoutHelper.createFrame(40, 40.0f, 53, BitmapDescriptorFactory.HUE_RED, (rotation == 3 || rotation == 1) ? 58.0f : 68.0f, 64.0f, BitmapDescriptorFactory.HUE_RED));
        if (isStatusBarVisible()) {
            ((FrameLayout.LayoutParams) this.photosCounterView.getLayoutParams()).topMargin += AndroidUtilities.statusBarHeight;
        }
        this.photosCounterView.setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda58
            @Override // android.view.View.OnClickListener
            public final void onClick(View view2) {
                this.f$0.lambda$setParentActivity$70(view2);
            }
        });
        SelectedPhotosListView selectedPhotosListView = new SelectedPhotosListView(this.parentActivity);
        this.selectedPhotosListView = selectedPhotosListView;
        selectedPhotosListView.setVisibility(8);
        this.selectedPhotosListView.setAlpha(BitmapDescriptorFactory.HUE_RED);
        this.selectedPhotosListView.setLayoutManager(new LinearLayoutManager(this.parentActivity, i10, z2) { // from class: org.telegram.ui.PhotoViewer.36
            @Override // androidx.recyclerview.widget.LinearLayoutManager, androidx.recyclerview.widget.RecyclerView.LayoutManager
            public void smoothScrollToPosition(RecyclerView recyclerView, RecyclerView.State state, int i11) {
                LinearSmoothScrollerEnd linearSmoothScrollerEnd = new LinearSmoothScrollerEnd(recyclerView.getContext()) { // from class: org.telegram.ui.PhotoViewer.36.1
                    @Override // androidx.recyclerview.widget.LinearSmoothScrollerEnd
                    protected int calculateTimeForDeceleration(int i12) {
                        return Math.max(180, super.calculateTimeForDeceleration(i12));
                    }
                };
                linearSmoothScrollerEnd.setTargetPosition(i11);
                startSmoothScroll(linearSmoothScrollerEnd);
            }
        });
        SelectedPhotosListView selectedPhotosListView2 = this.selectedPhotosListView;
        ListAdapter listAdapter = new ListAdapter(this.parentActivity);
        this.selectedPhotosAdapter = listAdapter;
        selectedPhotosListView2.setAdapter(listAdapter);
        this.containerView.addView(this.selectedPhotosListView, LayoutHelper.createFrame(-1, 103, 51));
        this.selectedPhotosListView.setOnItemClickListener(new RecyclerListView.OnItemClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda59
            @Override // org.telegram.ui.Components.RecyclerListView.OnItemClickListener
            public final void onItemClick(View view2, int i11) throws Resources.NotFoundException {
                this.f$0.lambda$setParentActivity$71(view2, i11);
            }
        });
        UndoView undoView = new UndoView(this.activityContext, null, false, resourcesProvider);
        this.hintView = undoView;
        undoView.setAdditionalTranslationY(AndroidUtilities.dp(112.0f));
        this.hintView.setColors(-115203550, -1);
        this.containerView.addView(this.hintView, LayoutHelper.createFrame(-1, -2.0f, 83, 8.0f, BitmapDescriptorFactory.HUE_RED, 8.0f, 8.0f));
        if (AndroidUtilities.isAccessibilityScreenReaderEnabled()) {
            View view2 = new View(this.activityContext);
            this.playButtonAccessibilityOverlay = view2;
            view2.setContentDescription(LocaleController.getString("AccActionPlay", R.string.AccActionPlay));
            this.playButtonAccessibilityOverlay.setFocusable(true);
            this.containerView.addView(this.playButtonAccessibilityOverlay, LayoutHelper.createFrame(64, 64, 17));
        }
        this.doneButtonFullWidth.setBackground(Theme.AdaptiveRipple.filledRect(getThemedColor(i8), 6.0f));
        this.doneButtonFullWidth.setTextColor(getThemedColor(i9));
        TextSelectionHelper.SimpleTextSelectionHelper simpleTextSelectionHelper = this.textSelectionHelper;
        simpleTextSelectionHelper.allowScrollPrentRelative = true;
        simpleTextSelectionHelper.useMovingOffset = false;
        TextSelectionHelper.TextSelectionOverlay overlayView = simpleTextSelectionHelper.getOverlayView(this.windowView.getContext());
        if (overlayView != null) {
            AndroidUtilities.removeFromParent(overlayView);
            this.containerView.addView(overlayView);
        }
        this.textSelectionHelper.setParentView(this.containerView);
        this.textSelectionHelper.setInvalidateParent();
    }

    public void setParentActivity(Activity activity, Theme.ResourcesProvider resourcesProvider) {
        setParentActivity(activity, null, resourcesProvider);
    }

    public void setParentActivity(BaseFragment baseFragment) {
        setParentActivity(baseFragment, (Theme.ResourcesProvider) null);
    }

    public void setParentActivity(BaseFragment baseFragment, Theme.ResourcesProvider resourcesProvider) {
        setParentActivity(null, baseFragment, resourcesProvider);
    }

    public void setParentAlert(ChatAttachAlert chatAttachAlert) {
        this.parentAlert = chatAttachAlert;
    }

    public void setParentChatActivity(ChatActivity chatActivity) {
        this.parentChatActivity = chatActivity;
    }

    public void setTitle(CharSequence charSequence) {
        PhotoViewerActionBarContainer photoViewerActionBarContainer = this.actionBarContainer;
        this.customTitle = charSequence;
        photoViewerActionBarContainer.setTitle(charSequence);
        toggleActionBar(true, false);
    }

    public void showAlertDialog(AlertDialog.Builder builder) {
        if (this.parentActivity == null) {
            return;
        }
        try {
            AlertDialog alertDialog = this.visibleDialog;
            if (alertDialog != null) {
                alertDialog.dismiss();
                this.visibleDialog = null;
            }
        } catch (Exception e) {
            FileLog.e(e);
        }
        try {
            AlertDialog alertDialogShow = builder.show();
            this.visibleDialog = alertDialogShow;
            alertDialogShow.setCanceledOnTouchOutside(true);
            this.visibleDialog.setOnDismissListener(new DialogInterface.OnDismissListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda154
                @Override // android.content.DialogInterface.OnDismissListener
                public final void onDismiss(DialogInterface dialogInterface) {
                    this.f$0.lambda$showAlertDialog$93(dialogInterface);
                }
            });
        } catch (Exception e2) {
            FileLog.e(e2);
        }
    }

    public boolean showCaptionLimitBulletin(FrameLayout frameLayout) {
        BaseFragment baseFragment = this.parentFragment;
        if (!(baseFragment instanceof ChatActivity) || !ChatObject.isChannelAndNotMegaGroup(((ChatActivity) baseFragment).getCurrentChat())) {
            return false;
        }
        this.limitBulletin = BulletinFactory.of(frameLayout, this.resourcesProvider).createCaptionLimitBulletin(MessagesController.getInstance(this.currentAccount).captionLengthLimitPremium, new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda81
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$showCaptionLimitBulletin$72();
            }
        }).setOnHideListener(new Runnable() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda82
            @Override // java.lang.Runnable
            public final void run() {
                this.f$0.lambda$showCaptionLimitBulletin$73();
            }
        }).show();
        return true;
    }

    public void showChromecastBulletin(String str, String str2) {
        if (this.activityContext == null || this.containerView == null || !isVisible()) {
            return;
        }
        BulletinFactory.of(this.containerView, new DarkThemeResourceProvider()).createSimpleBulletin(R.raw.forward, !TextUtils.isEmpty(str2) ? LocaleController.formatString(R.string.ChromecastStartedTo, str2) : LocaleController.getString(R.string.ChromecastStarted)).show();
    }

    /* JADX WARN: Removed duplicated region for block: B:144:0x0218  */
    /* JADX WARN: Removed duplicated region for block: B:151:0x0236  */
    /* JADX WARN: Removed duplicated region for block: B:160:0x0261  */
    /* JADX WARN: Removed duplicated region for block: B:169:0x027b  */
    /* JADX WARN: Removed duplicated region for block: B:195:0x02ff  */
    /* JADX WARN: Removed duplicated region for block: B:224:0x039d  */
    /* JADX WARN: Removed duplicated region for block: B:323:0x07e0  */
    /* JADX WARN: Removed duplicated region for block: B:368:0x0939  */
    /* JADX WARN: Removed duplicated region for block: B:371:0x094f  */
    /* JADX WARN: Removed duplicated region for block: B:374:0x0965  */
    /* JADX WARN: Removed duplicated region for block: B:418:0x0ac2  */
    /* JADX WARN: Removed duplicated region for block: B:421:0x0ad8  */
    /* JADX WARN: Removed duplicated region for block: B:424:0x0aee  */
    /* JADX WARN: Removed duplicated region for block: B:460:0x0c20  */
    /* JADX WARN: Removed duplicated region for block: B:463:0x0c36  */
    /* JADX WARN: Removed duplicated region for block: B:466:0x0c4c  */
    /* JADX WARN: Removed duplicated region for block: B:497:0x0d65  */
    /* JADX WARN: Removed duplicated region for block: B:500:0x0d7b  */
    /* JADX WARN: Removed duplicated region for block: B:503:0x0d91  */
    /* JADX WARN: Removed duplicated region for block: B:508:0x0ddf  */
    /* JADX WARN: Removed duplicated region for block: B:518:? A[RETURN, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:54:0x0099  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void switchToEditMode(final int i) {
        int i2;
        ObjectAnimator objectAnimatorOfFloat;
        int i3;
        ObjectAnimator objectAnimatorOfFloat2;
        AnimatorSet animatorSet;
        AnimatorListenerAdapter animatorListenerAdapter;
        int i4;
        ObjectAnimator objectAnimatorOfFloat3;
        ObjectAnimator objectAnimatorOfFloat4;
        String path;
        MediaController.SavedFilterState savedFilterState;
        int orientation;
        Bitmap bitmapDecodeFile;
        Bitmap bitmap;
        MediaController.CropState cropState;
        int i5;
        AnimatorSet animatorSet2;
        int i6;
        FrameLayoutDrawer frameLayoutDrawer;
        int i7;
        ValueAnimator valueAnimatorOfFloat;
        float scale;
        MediaController.CropState cropState2;
        float fMin;
        float fMin2;
        MediaController.CropState cropState3;
        int i8;
        float additionalBottom;
        int iDp;
        float f;
        float additionalTop;
        float fDp;
        int i9;
        float additionalTop2;
        int iDp2;
        float additionalBottom2;
        if (this.currentEditMode == i) {
            return;
        }
        if ((this.isCurrentVideo && this.photoProgressViews[0].backgroundState != 3 && !this.isCurrentVideo && (this.centerImage.getBitmap() == null || this.photoProgressViews[0].backgroundState != -1)) || this.changeModeAnimation != null || this.imageMoveAnimation != null || isCaptionOpen()) {
            return;
        }
        PhotoViewerProvider photoViewerProvider = this.placeProvider;
        if (photoViewerProvider != null && (this.currentEditMode == 0 || i == 0)) {
            photoViewerProvider.onEditModeChanged(i != 0);
        }
        this.windowView.setClipChildren(i == 2);
        int i10 = 2130706432;
        int color = this.navigationBar.getBackground() instanceof ColorDrawable ? ((ColorDrawable) this.navigationBar.getBackground()).getColor() : 2130706432;
        if (i == 1) {
            i10 = -872415232;
        } else if (i != 3) {
            if (i == 0 && this.fancyShadows && this.savedState == null) {
                i10 = this.sendPhotoType == 11 ? 1711276032 : 0;
            } else if (this.sendPhotoType == 11) {
                i10 = -16777216;
            }
        }
        showEditCaption(this.editing && this.savedState == null && i == 0, true);
        showStickerMode((i == 0 || i == 4 || (i == 3 && this.stickerEmpty)) && this.sendPhotoType == 11, true);
        this.navigationBar.setVisibility(i != 2 ? 0 : 4);
        this.switchingToMode = i;
        if (this.currentEditMode == 0) {
            PhotoCountView photoCountView = this.countView;
            this.wasCountViewShown = photoCountView != null && photoCountView.isShown();
        }
        PhotoCountView photoCountView2 = this.countView;
        if (photoCountView2 != null) {
            photoCountView2.updateShow(i == 0 && this.wasCountViewShown, true);
        }
        if (i == 0) {
            Bitmap bitmap2 = this.centerImage.getBitmap();
            LPhotoPaintView lPhotoPaintView = this.photoPaintView;
            if (lPhotoPaintView != null) {
                lPhotoPaintView.setDrawShadow(false);
            }
            int i11 = this.currentEditMode;
            if (i11 == 4 || i11 == 5) {
                this.animationStartTime = System.currentTimeMillis();
                float f2 = this.translationY;
                this.savedTy = f2;
                this.animateToY = f2;
                float f3 = this.translationX;
                this.savedTx = f3;
                this.animateToX = f3;
                float f4 = this.rotate;
                this.savedRotation = f4;
                this.animateToRotate = f4;
                this.animateToMirror = this.mirror;
                float f5 = this.scale;
                this.savedScale = f5;
                this.animateToScale = f5;
            } else if (bitmap2 != null) {
                int bitmapWidth = this.centerImage.getBitmapWidth();
                int bitmapHeight = this.centerImage.getBitmapHeight();
                int i12 = this.currentEditMode;
                if (i12 == 3) {
                    if (this.sendPhotoType == 1) {
                        if (this.cropTransform.getOrientation() == 90 || this.cropTransform.getOrientation() == 270) {
                            int i13 = bitmapHeight;
                            bitmapHeight = bitmapWidth;
                            bitmapWidth = i13;
                        }
                        float f6 = bitmapWidth;
                        float f7 = bitmapHeight;
                        fMin = Math.min(getContainerViewWidth(0) / f6, getContainerViewHeight(0) / f7);
                        fMin2 = Math.min(getContainerViewWidth(3) / f6, getContainerViewHeight(3) / f7);
                    } else {
                        MediaController.CropState cropState4 = this.editState.cropState;
                        if (cropState4 != null) {
                            int i14 = cropState4.transformRotation;
                            if (i14 != 90 && i14 != 270) {
                                bitmapHeight = bitmapWidth;
                                bitmapWidth = bitmapHeight;
                            }
                            bitmapHeight = (int) (bitmapHeight * cropState4.cropPw);
                            bitmapWidth = (int) (bitmapWidth * cropState4.cropPh);
                            int i132 = bitmapHeight;
                            bitmapHeight = bitmapWidth;
                            bitmapWidth = i132;
                        }
                        float f62 = bitmapWidth;
                        float f72 = bitmapHeight;
                        fMin = Math.min(getContainerViewWidth(0) / f62, getContainerViewHeight(0) / f72);
                        fMin2 = Math.min(getContainerViewWidth(3) / f62, getContainerViewHeight(3) / f72);
                    }
                    frameLayoutDrawer = this.containerView;
                    if (frameLayoutDrawer == null) {
                        frameLayoutDrawer.updateExclusionRects();
                        return;
                    }
                    return;
                }
                if (i12 == 1 || (cropState3 = this.editState.cropState) == null || !((i8 = cropState3.transformRotation) == 90 || i8 == 270)) {
                    if (this.sendPhotoType == 1 && (this.cropTransform.getOrientation() == 90 || this.cropTransform.getOrientation() == 270)) {
                        float f8 = bitmapHeight;
                        float containerViewWidth = getContainerViewWidth() / f8;
                        float f9 = bitmapWidth;
                        if (containerViewWidth * f9 > getContainerViewHeight()) {
                            containerViewWidth = getContainerViewHeight() / f9;
                        }
                        scale = 1.0f / ((((this.cropTransform.getScale() / this.cropTransform.getTrueCropScale()) * containerViewWidth) / Math.min(getContainerViewWidth() / f9, getContainerViewHeight() / f8)) / this.cropTransform.getMinScale());
                    }
                    cropState2 = this.editState.cropState;
                    if (cropState2 == null) {
                        int i15 = cropState2.transformRotation;
                        if (i15 != 90 && i15 != 270) {
                            bitmapHeight = bitmapWidth;
                            bitmapWidth = bitmapHeight;
                        }
                        bitmapHeight = (int) (bitmapHeight * cropState2.cropPw);
                        bitmapWidth = (int) (bitmapWidth * cropState2.cropPh);
                    } else {
                        if (this.sendPhotoType == 1 && (this.cropTransform.getOrientation() == 90 || this.cropTransform.getOrientation() == 270)) {
                        }
                        float f10 = bitmapWidth;
                        float f11 = bitmapHeight;
                        float fMin3 = Math.min(getContainerViewWidth() / f10, getContainerViewHeight() / f11);
                        if (this.sendPhotoType == 1) {
                            fMin = getCropFillScale(this.cropTransform.getOrientation() == 90 || this.cropTransform.getOrientation() == 270);
                        } else {
                            fMin = Math.min(getContainerViewWidth(0) / f10, getContainerViewHeight(0) / f11);
                        }
                        fMin2 = fMin3;
                    }
                    int i16 = bitmapHeight;
                    bitmapHeight = bitmapWidth;
                    bitmapWidth = i16;
                    float f102 = bitmapWidth;
                    float f112 = bitmapHeight;
                    float fMin32 = Math.min(getContainerViewWidth() / f102, getContainerViewHeight() / f112);
                    if (this.sendPhotoType == 1) {
                    }
                    fMin2 = fMin32;
                } else {
                    float f12 = bitmapHeight;
                    float containerViewWidth2 = getContainerViewWidth() / f12;
                    float f13 = bitmapWidth;
                    if (containerViewWidth2 * f13 > getContainerViewHeight()) {
                        containerViewWidth2 = getContainerViewHeight() / f13;
                    }
                    scale = 1.0f / (containerViewWidth2 / Math.min(getContainerViewWidth() / f13, getContainerViewHeight() / f12));
                }
                this.scale = scale;
                cropState2 = this.editState.cropState;
                if (cropState2 == null) {
                }
                int i162 = bitmapHeight;
                bitmapHeight = bitmapWidth;
                bitmapWidth = i162;
                float f1022 = bitmapWidth;
                float f1122 = bitmapHeight;
                float fMin322 = Math.min(getContainerViewWidth() / f1022, getContainerViewHeight() / f1122);
                if (this.sendPhotoType == 1) {
                }
                fMin2 = fMin322;
                if (this.currentEditMode == 4) {
                    this.eraseBtn.setActive(false, true);
                    this.restoreBtn.setActive(false, true);
                }
                if (this.sendPhotoType == 11 && ((i9 = this.currentEditMode) == 3 || i9 == 2 || i9 == 1)) {
                    this.animationStartTime = System.currentTimeMillis();
                    this.animateToX = this.savedTx;
                    int i17 = this.currentEditMode;
                    if (i17 == 1) {
                        additionalTop2 = this.savedTy;
                        iDp2 = AndroidUtilities.dp(56.0f);
                    } else {
                        if (i17 == 3) {
                            float fDp2 = this.savedTy + AndroidUtilities.dp(44.0f);
                            this.animateToY = fDp2;
                            if (this.photoPaintView != null) {
                                additionalTop2 = fDp2 - (r7.getAdditionalTop() / 2.0f);
                                this.animateToY = additionalTop2;
                                additionalBottom2 = this.photoPaintView.getAdditionalBottom() / 2.0f;
                                this.animateToY = additionalTop2 + additionalBottom2;
                            }
                        } else if (i17 == 2) {
                            additionalTop2 = this.savedTy;
                            iDp2 = AndroidUtilities.dp(93.0f);
                        }
                        if (isStatusBarVisible()) {
                            this.animateToY -= AndroidUtilities.statusBarHeight / 2;
                        }
                        this.animateToScale = (fMin / fMin2) * this.savedScale;
                        this.animateToRotate = this.savedRotation;
                        this.animateToMirror = this.mirror;
                    }
                    additionalBottom2 = iDp2;
                    this.animateToY = additionalTop2 + additionalBottom2;
                    if (isStatusBarVisible()) {
                    }
                    this.animateToScale = (fMin / fMin2) * this.savedScale;
                    this.animateToRotate = this.savedRotation;
                    this.animateToMirror = this.mirror;
                } else {
                    this.animateToScale = (fMin / fMin2) * scale1();
                    this.animateToX = BitmapDescriptorFactory.HUE_RED;
                    this.translationX = (getLeftInset() / 2) - (getRightInset() / 2);
                    if (this.sendPhotoType == 1) {
                        int i18 = this.currentEditMode;
                        if (i18 == 2) {
                            fDp = AndroidUtilities.dp(36.0f);
                            this.animateToY = fDp;
                        } else if (i18 == 3) {
                            f = -AndroidUtilities.dp(12.0f);
                            this.animateToY = f;
                            if (this.photoPaintView != null) {
                                additionalTop = r3.getAdditionalTop() / 2.0f;
                                fDp = f - additionalTop;
                                this.animateToY = fDp;
                            }
                        }
                    } else {
                        int i19 = this.currentEditMode;
                        if (i19 == 1) {
                            iDp = AndroidUtilities.dp(56.0f);
                        } else if (i19 == 2) {
                            iDp = AndroidUtilities.dp(93.0f);
                        } else {
                            if (i19 == 3) {
                                float fDp3 = AndroidUtilities.dp(44.0f);
                                this.animateToY = fDp3;
                                if (this.photoPaintView != null) {
                                    float additionalTop3 = fDp3 - (r3.getAdditionalTop() / 2.0f);
                                    this.animateToY = additionalTop3;
                                    additionalBottom = additionalTop3 + (this.photoPaintView.getAdditionalBottom() / 2.0f);
                                    this.animateToY = additionalBottom;
                                }
                            }
                            if (isStatusBarVisible()) {
                                f = this.animateToY;
                                additionalTop = AndroidUtilities.statusBarHeight / 2;
                                fDp = f - additionalTop;
                                this.animateToY = fDp;
                            }
                        }
                        additionalBottom = iDp;
                        this.animateToY = additionalBottom;
                        if (isStatusBarVisible()) {
                        }
                    }
                }
                this.animationStartTime = System.currentTimeMillis();
                this.zoomAnimation = true;
            }
            this.padImageForHorizontalInsets = false;
            this.imageMoveAnimation = new AnimatorSet();
            ArrayList arrayList = new ArrayList(4);
            int i20 = this.currentEditMode;
            if (i20 == 1) {
                arrayList.add(ObjectAnimator.ofFloat(this.editorDoneLayout, (Property<PickerBottomLayoutViewer, Float>) View.TRANSLATION_Y, AndroidUtilities.dp(48.0f)));
                arrayList.add(ObjectAnimator.ofFloat(this, (Property<PhotoViewer, Float>) AnimationProperties.PHOTO_VIEWER_ANIMATION_VALUE, BitmapDescriptorFactory.HUE_RED, 1.0f));
                arrayList.add(ObjectAnimator.ofFloat(this.photoCropView, (Property<PhotoCropView, Float>) View.ALPHA, BitmapDescriptorFactory.HUE_RED));
                valueAnimatorOfFloat = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, 1.0f);
                valueAnimatorOfFloat.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda102
                    @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                    public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                        this.f$0.lambda$switchToEditMode$98(valueAnimator);
                    }
                });
            } else if (i20 == 2) {
                this.photoFilterView.shutdown();
                arrayList.add(ObjectAnimator.ofFloat(this.photoFilterView.getToolsView(), (Property<FrameLayout, Float>) View.TRANSLATION_Y, AndroidUtilities.dp(186.0f)));
                PhotoFilterCurvesControl curveControl = this.photoFilterView.getCurveControl();
                Property property = View.ALPHA;
                arrayList.add(ObjectAnimator.ofFloat(curveControl, (Property<PhotoFilterCurvesControl, Float>) property, BitmapDescriptorFactory.HUE_RED));
                arrayList.add(ObjectAnimator.ofFloat(this.photoFilterView.getBlurControl(), (Property<PhotoFilterBlurControl, Float>) property, BitmapDescriptorFactory.HUE_RED));
                valueAnimatorOfFloat = ObjectAnimator.ofFloat(this, (Property<PhotoViewer, Float>) AnimationProperties.PHOTO_VIEWER_ANIMATION_VALUE, BitmapDescriptorFactory.HUE_RED, 1.0f);
            } else {
                if (i20 == 3) {
                    ValueAnimator valueAnimatorOfFloat2 = ValueAnimator.ofFloat(this.photoPaintView.getOffsetTranslationY(), AndroidUtilities.dp(126.0f));
                    ValueAnimator valueAnimatorOfFloat3 = ValueAnimator.ofFloat(BitmapDescriptorFactory.HUE_RED, -AndroidUtilities.dp(12.0f));
                    valueAnimatorOfFloat2.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda103
                        @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                        public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                            this.f$0.lambda$switchToEditMode$99(valueAnimator);
                        }
                    });
                    valueAnimatorOfFloat3.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda104
                        @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                        public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                            this.f$0.lambda$switchToEditMode$100(valueAnimator);
                        }
                    });
                    this.paintingOverlay.showAll();
                    this.containerView.invalidate();
                    this.photoPaintView.shutdown();
                    arrayList.add(valueAnimatorOfFloat2);
                    arrayList.add(valueAnimatorOfFloat3);
                    arrayList.add(ObjectAnimator.ofFloat(this, (Property<PhotoViewer, Float>) AnimationProperties.PHOTO_VIEWER_ANIMATION_VALUE, BitmapDescriptorFactory.HUE_RED, 1.0f));
                    this.photoPaintView.onAnimationStateChanged(true);
                } else if (i20 == 4) {
                    arrayList.add(ObjectAnimator.ofFloat(this.maskPaintView.buttonsLayout, (Property<FrameLayout, Float>) View.TRANSLATION_Y, AndroidUtilities.dp(18.0f)));
                    FrameLayout frameLayout = this.maskPaintView.buttonsLayout;
                    Property property2 = View.ALPHA;
                    arrayList.add(ObjectAnimator.ofFloat(frameLayout, (Property<FrameLayout, Float>) property2, BitmapDescriptorFactory.HUE_RED));
                    arrayList.add(ObjectAnimator.ofFloat(this.maskPaintView.weightChooserView, (Property<PaintWeightChooserView, Float>) View.TRANSLATION_X, AndroidUtilities.dp(-18.0f)));
                    valueAnimatorOfFloat = ObjectAnimator.ofFloat(this.maskPaintView.weightChooserView, (Property<PaintWeightChooserView, Float>) property2, BitmapDescriptorFactory.HUE_RED);
                } else {
                    if (i20 == 5) {
                        this.coverEditor.setVisibility(0);
                        i7 = 2;
                        arrayList.add(ObjectAnimator.ofFloat(this.coverEditor, (Property<PhotoViewerCoverEditor, Float>) View.ALPHA, 1.0f, BitmapDescriptorFactory.HUE_RED));
                    }
                    View view = this.navigationBar;
                    ArgbEvaluator argbEvaluator = new ArgbEvaluator();
                    Integer numValueOf = Integer.valueOf(color);
                    Integer numValueOf2 = Integer.valueOf(i10);
                    Object[] objArr = new Object[i7];
                    objArr[0] = numValueOf;
                    objArr[1] = numValueOf2;
                    arrayList.add(ObjectAnimator.ofObject(view, "backgroundColor", argbEvaluator, objArr));
                    this.imageMoveAnimation.playTogether(arrayList);
                    this.imageMoveAnimation.setDuration(200L);
                    this.imageMoveAnimation.addListener(new AnonymousClass59(i));
                    animatorSet2 = this.imageMoveAnimation;
                }
                i7 = 2;
                View view2 = this.navigationBar;
                ArgbEvaluator argbEvaluator2 = new ArgbEvaluator();
                Integer numValueOf3 = Integer.valueOf(color);
                Integer numValueOf22 = Integer.valueOf(i10);
                Object[] objArr2 = new Object[i7];
                objArr2[0] = numValueOf3;
                objArr2[1] = numValueOf22;
                arrayList.add(ObjectAnimator.ofObject(view2, "backgroundColor", argbEvaluator2, objArr2));
                this.imageMoveAnimation.playTogether(arrayList);
                this.imageMoveAnimation.setDuration(200L);
                this.imageMoveAnimation.addListener(new AnonymousClass59(i));
                animatorSet2 = this.imageMoveAnimation;
            }
            arrayList.add(valueAnimatorOfFloat);
            i7 = 2;
            View view22 = this.navigationBar;
            ArgbEvaluator argbEvaluator22 = new ArgbEvaluator();
            Integer numValueOf32 = Integer.valueOf(color);
            Integer numValueOf222 = Integer.valueOf(i10);
            Object[] objArr22 = new Object[i7];
            objArr22[0] = numValueOf32;
            objArr22[1] = numValueOf222;
            arrayList.add(ObjectAnimator.ofObject(view22, "backgroundColor", argbEvaluator22, objArr22));
            this.imageMoveAnimation.playTogether(arrayList);
            this.imageMoveAnimation.setDuration(200L);
            this.imageMoveAnimation.addListener(new AnonymousClass59(i));
            animatorSet2 = this.imageMoveAnimation;
        } else {
            if (i == 1) {
                startVideoPlayer();
                createCropView();
                this.previousHasTransform = this.cropTransform.hasViewTransform();
                this.previousCropPx = this.cropTransform.getCropPx();
                this.previousCropPy = this.cropTransform.getCropPy();
                this.previousCropScale = this.cropTransform.getScale();
                this.previousCropRotation = this.cropTransform.getRotation();
                this.previousCropOrientation = this.cropTransform.getOrientation();
                this.previousCropPw = this.cropTransform.getCropPw();
                this.previousCropPh = this.cropTransform.getCropPh();
                this.previousCropMirrored = this.cropTransform.isMirrored();
                this.photoCropView.onAppear();
                this.editorDoneLayout.doneButton.setText(LocaleController.getString(R.string.Crop));
                this.editorDoneLayout.doneButton.setTextColor(getThemedColor(Theme.key_chat_editMediaButton));
                this.changeModeAnimation = new AnimatorSet();
                ArrayList arrayList2 = new ArrayList();
                FrameLayout frameLayout2 = this.pickerView;
                Property property3 = View.TRANSLATION_Y;
                arrayList2.add(ObjectAnimator.ofFloat(frameLayout2, (Property<FrameLayout, Float>) property3, BitmapDescriptorFactory.HUE_RED, frameLayout2.getHeight() + this.captionEdit.getEditTextHeight() + (this.isCurrentVideo ? AndroidUtilities.dp(58.0f) : 0)));
                FrameLayout frameLayout3 = this.pickerView;
                Property property4 = View.ALPHA;
                arrayList2.add(ObjectAnimator.ofFloat(frameLayout3, (Property<FrameLayout, Float>) property4, BitmapDescriptorFactory.HUE_RED));
                StickerMakerView stickerMakerView = this.stickerMakerView;
                if (stickerMakerView != null) {
                    arrayList2.add(ObjectAnimator.ofFloat(stickerMakerView, (Property<StickerMakerView, Float>) property4, BitmapDescriptorFactory.HUE_RED));
                }
                StickerMakerBackgroundView stickerMakerBackgroundView = this.stickerMakerBackgroundView;
                if (stickerMakerBackgroundView != null) {
                    arrayList2.add(ObjectAnimator.ofFloat(stickerMakerBackgroundView, (Property<StickerMakerBackgroundView, Float>) property4, BitmapDescriptorFactory.HUE_RED));
                }
                arrayList2.add(ObjectAnimator.ofFloat(this.pickerViewSendButton, (Property<ChatActivityEnterView.SendButton, Float>) property3, BitmapDescriptorFactory.HUE_RED, AndroidUtilities.dp(this.isCurrentVideo ? 154.0f : 96.0f)));
                arrayList2.add(ObjectAnimator.ofFloat(this.actionBar, (Property<ActionBar, Float>) property3, BitmapDescriptorFactory.HUE_RED, -r3.getHeight()));
                arrayList2.add(ObjectAnimator.ofObject(this.navigationBar, "backgroundColor", new ArgbEvaluator(), Integer.valueOf(color), Integer.valueOf(i10)));
                if (this.needCaptionLayout) {
                    arrayList2.add(ObjectAnimator.ofFloat(this.captionTextViewSwitcher, (Property<CaptionTextViewSwitcher, Float>) property3, BitmapDescriptorFactory.HUE_RED, AndroidUtilities.dp(this.isCurrentVideo ? 154.0f : 96.0f)));
                }
                int i21 = this.sendPhotoType;
                if (i21 == 0 || i21 == 4) {
                    i6 = 2;
                    arrayList2.add(ObjectAnimator.ofFloat(this.checkImageView, (Property<CheckBox, Float>) property4, 1.0f, BitmapDescriptorFactory.HUE_RED));
                    arrayList2.add(ObjectAnimator.ofFloat(this.photosCounterView, (Property<CounterView, Float>) property4, 1.0f, BitmapDescriptorFactory.HUE_RED));
                } else {
                    i6 = 2;
                }
                if (this.selectedPhotosListView.getVisibility() == 0) {
                    float[] fArr = new float[i6];
                    // fill-array-data instruction
                    fArr[0] = 1.0f;
                    fArr[1] = 0.0f;
                    arrayList2.add(ObjectAnimator.ofFloat(this.selectedPhotosListView, (Property<SelectedPhotosListView, Float>) property4, fArr));
                }
                if (this.muteButton.getTag() != null) {
                    float[] fArr2 = new float[i6];
                    // fill-array-data instruction
                    fArr2[0] = 1.0f;
                    fArr2[1] = 0.0f;
                    arrayList2.add(ObjectAnimator.ofFloat(this.muteButton, (Property<ImageView, Float>) property4, fArr2));
                }
                if (this.editCoverButton.getTag() != null) {
                    float[] fArr3 = new float[i6];
                    // fill-array-data instruction
                    fArr3[0] = 1.0f;
                    fArr3[1] = 0.0f;
                    arrayList2.add(ObjectAnimator.ofFloat(this.editCoverButton, (Property<EditCoverButton, Float>) property4, fArr3));
                }
                View view3 = this.navigationBar;
                if (view3 != null) {
                    arrayList2.add(ObjectAnimator.ofFloat(view3, (Property<View, Float>) property4, 1.0f));
                }
                this.changeModeAnimation.playTogether(arrayList2);
                this.changeModeAnimation.setDuration(200L);
                animatorSet = this.changeModeAnimation;
                animatorListenerAdapter = new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.60
                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationEnd(Animator animator) {
                        PhotoViewer.this.changeModeAnimation = null;
                        PhotoViewer.this.pickerView.setVisibility(8);
                        PhotoViewer.this.pickerViewSendButton.setVisibility(8);
                        PhotoViewer.this.doneButtonFullWidth.setVisibility(8);
                        PhotoViewer.this.muteButton.setVisibility(8);
                        PhotoViewer.this.editCoverButton.setVisibility(8);
                        PhotoViewer.this.selectedPhotosListView.setVisibility(8);
                        PhotoViewer.this.selectedPhotosListView.setAlpha(BitmapDescriptorFactory.HUE_RED);
                        PhotoViewer.this.selectedPhotosListView.setTranslationY(-AndroidUtilities.dp(10.0f));
                        PhotoViewer.this.photosCounterView.setRotationX(BitmapDescriptorFactory.HUE_RED);
                        PhotoViewer.this.selectedPhotosListView.setEnabled(false);
                        PhotoViewer.this.isPhotosListViewVisible = false;
                        if (PhotoViewer.this.needCaptionLayout) {
                            PhotoViewer.this.captionTextViewSwitcher.setVisibility(4);
                        }
                        if (PhotoViewer.this.sendPhotoType == 0 || PhotoViewer.this.sendPhotoType == 4 || ((PhotoViewer.this.sendPhotoType == 2 || PhotoViewer.this.sendPhotoType == 5) && PhotoViewer.this.imagesArrLocals.size() > 1)) {
                            PhotoViewer.this.checkImageView.setVisibility(8);
                            PhotoViewer.this.photosCounterView.setVisibility(8);
                            PhotoViewer.this.updateActionBarTitlePadding();
                        }
                        if (PhotoViewer.this.sendPhotoType == 11) {
                            PhotoViewer photoViewer = PhotoViewer.this;
                            photoViewer.savedTy = photoViewer.translationY;
                            PhotoViewer photoViewer2 = PhotoViewer.this;
                            photoViewer2.savedTx = photoViewer2.translationX;
                            PhotoViewer photoViewer3 = PhotoViewer.this;
                            photoViewer3.savedScale = photoViewer3.scale;
                            PhotoViewer photoViewer4 = PhotoViewer.this;
                            photoViewer4.savedRotation = photoViewer4.rotate;
                            PhotoViewer.this.animateToRotate = BitmapDescriptorFactory.HUE_RED;
                        }
                        Bitmap bitmap3 = PhotoViewer.this.centerImage.getBitmap();
                        if (bitmap3 != null || PhotoViewer.this.isCurrentVideo) {
                            PhotoViewer.this.photoCropView.setBitmap(bitmap3, PhotoViewer.this.centerImage.getOrientation(), PhotoViewer.this.sendPhotoType != 1, false, PhotoViewer.this.paintingOverlay, PhotoViewer.this.cropTransform, PhotoViewer.this.isCurrentVideo ? (VideoEditTextureView) PhotoViewer.this.videoTextureView : null, PhotoViewer.this.editState.cropState);
                            PhotoViewer.this.photoCropView.onDisappear();
                            int bitmapWidth2 = PhotoViewer.this.centerImage.getBitmapWidth();
                            int bitmapHeight2 = PhotoViewer.this.centerImage.getBitmapHeight();
                            if (PhotoViewer.this.editState.cropState != null) {
                                if (PhotoViewer.this.editState.cropState.transformRotation != 90 && PhotoViewer.this.editState.cropState.transformRotation != 270) {
                                    bitmapHeight2 = bitmapWidth2;
                                    bitmapWidth2 = bitmapHeight2;
                                }
                                int i22 = (int) (bitmapHeight2 * PhotoViewer.this.editState.cropState.cropPw);
                                bitmapHeight2 = (int) (bitmapWidth2 * PhotoViewer.this.editState.cropState.cropPh);
                                bitmapWidth2 = i22;
                            }
                            float f14 = bitmapWidth2;
                            float f15 = bitmapHeight2;
                            float fMin4 = Math.min(PhotoViewer.this.getContainerViewWidth() / f14, PhotoViewer.this.getContainerViewHeight() / f15);
                            float fMin5 = Math.min(PhotoViewer.this.getContainerViewWidth(1) / f14, PhotoViewer.this.getContainerViewHeight(1) / f15);
                            if (PhotoViewer.this.sendPhotoType == 1) {
                                float fMin6 = Math.min(PhotoViewer.this.getContainerViewWidth(1), PhotoViewer.this.getContainerViewHeight(1));
                                fMin5 = Math.max(fMin6 / f14, fMin6 / f15);
                            }
                            PhotoViewer.this.animateToScale = fMin5 / fMin4;
                            PhotoViewer.this.animateToX = (r3.getLeftInset() / 2) - (PhotoViewer.this.getRightInset() / 2);
                            PhotoViewer.this.animateToY = (-AndroidUtilities.dp(56.0f)) + (PhotoViewer.this.isStatusBarVisible() ? AndroidUtilities.statusBarHeight / 2 : 0);
                            PhotoViewer.this.animationStartTime = System.currentTimeMillis();
                            PhotoViewer.this.zoomAnimation = true;
                        }
                        PhotoViewer.this.imageMoveAnimation = new AnimatorSet();
                        PhotoViewer.this.imageMoveAnimation.playTogether(ObjectAnimator.ofFloat(PhotoViewer.this.editorDoneLayout, (Property<PickerBottomLayoutViewer, Float>) View.TRANSLATION_Y, AndroidUtilities.dp(48.0f), BitmapDescriptorFactory.HUE_RED), ObjectAnimator.ofFloat(PhotoViewer.this, (Property<PhotoViewer, Float>) AnimationProperties.PHOTO_VIEWER_ANIMATION_VALUE, BitmapDescriptorFactory.HUE_RED, 1.0f), ObjectAnimator.ofFloat(PhotoViewer.this.photoCropView, (Property<PhotoCropView, Float>) View.ALPHA, BitmapDescriptorFactory.HUE_RED, 1.0f));
                        PhotoViewer.this.imageMoveAnimation.setDuration(200L);
                        PhotoViewer.this.imageMoveAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.60.1
                            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                            public void onAnimationEnd(Animator animator2) {
                                PhotoViewer.this.photoCropView.onAppeared();
                                PhotoViewer.this.photoCropView.onShow();
                                PhotoViewer.this.imageMoveAnimation = null;
                                AnonymousClass60 anonymousClass60 = AnonymousClass60.this;
                                PhotoViewer.this.currentEditMode = i;
                                PhotoViewer.this.getCaptionView().keyboardNotifier.ignore(PhotoViewer.this.currentEditMode != 0);
                                if (PhotoViewer.this.paintKeyboardNotifier != null) {
                                    PhotoViewer.this.paintKeyboardNotifier.ignore(PhotoViewer.this.currentEditMode != 3);
                                }
                                if (PhotoViewer.this.currentEditMode != 3) {
                                    PhotoViewer.this.translateY = BitmapDescriptorFactory.HUE_RED;
                                }
                                PhotoViewer.this.switchingToMode = -1;
                                PhotoViewer photoViewer5 = PhotoViewer.this;
                                photoViewer5.scale = photoViewer5.animateToScale = 1.0f;
                                PhotoViewer.this.animateToX = BitmapDescriptorFactory.HUE_RED;
                                PhotoViewer.this.animateToY = BitmapDescriptorFactory.HUE_RED;
                                PhotoViewer photoViewer6 = PhotoViewer.this;
                                photoViewer6.updateMinMax(photoViewer6.scale);
                                PhotoViewer.this.padImageForHorizontalInsets = true;
                                PhotoViewer.this.containerView.invalidate();
                            }

                            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                            public void onAnimationStart(Animator animator2) {
                                PhotoViewer.this.editorDoneLayout.setVisibility(0);
                                PhotoViewer.this.photoCropView.setVisibility(0);
                            }
                        });
                        PhotoViewer.this.imageMoveAnimation.start();
                    }
                };
            } else if (i == 2) {
                startVideoPlayer();
                if (this.photoFilterView == null) {
                    if (this.imagesArrLocals.isEmpty()) {
                        path = null;
                        savedFilterState = null;
                        orientation = 0;
                    } else {
                        Object obj = this.imagesArrLocals.get(this.currentIndex);
                        orientation = obj instanceof MediaController.PhotoEntry ? ((MediaController.PhotoEntry) obj).orientation : 0;
                        MediaController.MediaEditState mediaEditState = (MediaController.MediaEditState) obj;
                        MediaController.SavedFilterState savedFilterState2 = mediaEditState.savedFilterState;
                        path = mediaEditState.getPath();
                        savedFilterState = savedFilterState2;
                    }
                    if (this.videoTextureView != null) {
                        bitmap = null;
                    } else {
                        if (savedFilterState == null) {
                            bitmapDecodeFile = this.stickerMakerView.isSegmentedState() ? this.stickerMakerView.getSourceBitmap() : this.centerImage.getBitmap();
                            orientation = this.centerImage.getOrientation();
                        } else {
                            bitmapDecodeFile = BitmapFactory.decodeFile(path);
                        }
                        bitmap = bitmapDecodeFile;
                    }
                    int i22 = orientation;
                    if (this.sendPhotoType != 1) {
                        int i23 = (this.isCurrentVideo || (i5 = this.currentImageHasFace) == 2) ? 2 : i5 == 1 ? 1 : 0;
                        Bitmap segmentedDarkMaskImage = this.stickerMakerView.getSegmentedDarkMaskImage();
                        Activity activity = this.parentActivity;
                        TextureView textureView = this.videoTextureView;
                        PhotoFilterView photoFilterView = new PhotoFilterView(activity, textureView != null ? (VideoEditTextureView) textureView : null, bitmap, segmentedDarkMaskImage, i22, savedFilterState, this.isCurrentVideo ? null : this.paintingOverlay, i23, textureView == null && (((cropState = this.editState.cropState) != null && cropState.mirrored) || this.cropTransform.isMirrored()), true, null, this.resourcesProvider);
                        this.photoFilterView = photoFilterView;
                        this.containerView.addView(photoFilterView, LayoutHelper.createFrame(-1, -1.0f));
                        this.photoFilterView.getDoneTextView().setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda105
                            @Override // android.view.View.OnClickListener
                            public final void onClick(View view4) {
                                this.f$0.lambda$switchToEditMode$101(view4);
                            }
                        });
                        this.photoFilterView.getCancelTextView().setOnClickListener(new View.OnClickListener() { // from class: org.telegram.ui.PhotoViewer$$ExternalSyntheticLambda106
                            @Override // android.view.View.OnClickListener
                            public final void onClick(View view4) {
                                this.f$0.lambda$switchToEditMode$103(view4);
                            }
                        });
                        this.photoFilterView.getToolsView().setTranslationY(AndroidUtilities.dp(186.0f));
                    }
                    frameLayoutDrawer = this.containerView;
                    if (frameLayoutDrawer == null) {
                    }
                }
                this.changeModeAnimation = new AnimatorSet();
                ArrayList arrayList3 = new ArrayList();
                FrameLayout frameLayout4 = this.pickerView;
                Property property5 = View.TRANSLATION_Y;
                arrayList3.add(ObjectAnimator.ofFloat(frameLayout4, (Property<FrameLayout, Float>) property5, BitmapDescriptorFactory.HUE_RED, frameLayout4.getHeight() + this.captionEdit.getEditTextHeight() + (this.isCurrentVideo ? AndroidUtilities.dp(58.0f) : 0)));
                FrameLayout frameLayout5 = this.pickerView;
                Property property6 = View.ALPHA;
                arrayList3.add(ObjectAnimator.ofFloat(frameLayout5, (Property<FrameLayout, Float>) property6, BitmapDescriptorFactory.HUE_RED));
                StickerMakerView stickerMakerView2 = this.stickerMakerView;
                if (stickerMakerView2 != null) {
                    arrayList3.add(ObjectAnimator.ofFloat(stickerMakerView2, (Property<StickerMakerView, Float>) property6, BitmapDescriptorFactory.HUE_RED));
                }
                StickerMakerBackgroundView stickerMakerBackgroundView2 = this.stickerMakerBackgroundView;
                if (stickerMakerBackgroundView2 != null) {
                    arrayList3.add(ObjectAnimator.ofFloat(stickerMakerBackgroundView2, (Property<StickerMakerBackgroundView, Float>) property6, BitmapDescriptorFactory.HUE_RED));
                }
                arrayList3.add(ObjectAnimator.ofFloat(this.pickerViewSendButton, (Property<ChatActivityEnterView.SendButton, Float>) property5, BitmapDescriptorFactory.HUE_RED, AndroidUtilities.dp(this.isCurrentVideo ? 154.0f : 96.0f)));
                arrayList3.add(ObjectAnimator.ofFloat(this.actionBar, (Property<ActionBar, Float>) property5, BitmapDescriptorFactory.HUE_RED, -r3.getHeight()));
                int i24 = this.sendPhotoType;
                if (i24 == 0 || i24 == 4) {
                    arrayList3.add(ObjectAnimator.ofFloat(this.checkImageView, (Property<CheckBox, Float>) property6, 1.0f, BitmapDescriptorFactory.HUE_RED));
                    objectAnimatorOfFloat4 = ObjectAnimator.ofFloat(this.photosCounterView, (Property<CounterView, Float>) property6, 1.0f, BitmapDescriptorFactory.HUE_RED);
                } else {
                    if (i24 == 1) {
                        objectAnimatorOfFloat4 = ObjectAnimator.ofFloat(this.photoCropView, (Property<PhotoCropView, Float>) property6, 1.0f, BitmapDescriptorFactory.HUE_RED);
                    }
                    if (this.selectedPhotosListView.getVisibility() == 0) {
                        arrayList3.add(ObjectAnimator.ofFloat(this.selectedPhotosListView, (Property<SelectedPhotosListView, Float>) property6, 1.0f, BitmapDescriptorFactory.HUE_RED));
                    }
                    if (this.muteButton.getTag() != null) {
                        arrayList3.add(ObjectAnimator.ofFloat(this.muteButton, (Property<ImageView, Float>) property6, 1.0f, BitmapDescriptorFactory.HUE_RED));
                    }
                    if (this.editCoverButton.getTag() != null) {
                        arrayList3.add(ObjectAnimator.ofFloat(this.editCoverButton, (Property<EditCoverButton, Float>) property6, 1.0f, BitmapDescriptorFactory.HUE_RED));
                    }
                    arrayList3.add(ObjectAnimator.ofObject(this.navigationBar, "backgroundColor", new ArgbEvaluator(), Integer.valueOf(color), Integer.valueOf(i10)));
                    this.changeModeAnimation.playTogether(arrayList3);
                    this.changeModeAnimation.setDuration(200L);
                    animatorSet = this.changeModeAnimation;
                    animatorListenerAdapter = new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.61
                        @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                        public void onAnimationEnd(Animator animator) {
                            float fMin4;
                            PhotoViewer.this.changeModeAnimation = null;
                            PhotoViewer.this.pickerView.setVisibility(8);
                            PhotoViewer.this.pickerViewSendButton.setVisibility(8);
                            PhotoViewer.this.doneButtonFullWidth.setVisibility(8);
                            PhotoViewer.this.actionBar.setVisibility(8);
                            PhotoViewer.this.muteButton.setVisibility(8);
                            PhotoViewer.this.editCoverButton.setVisibility(8);
                            if (PhotoViewer.this.photoCropView != null) {
                                PhotoViewer.this.photoCropView.setVisibility(4);
                            }
                            PhotoViewer.this.selectedPhotosListView.setVisibility(8);
                            PhotoViewer.this.selectedPhotosListView.setAlpha(BitmapDescriptorFactory.HUE_RED);
                            PhotoViewer.this.selectedPhotosListView.setTranslationY(-AndroidUtilities.dp(10.0f));
                            PhotoViewer.this.photosCounterView.setRotationX(BitmapDescriptorFactory.HUE_RED);
                            PhotoViewer.this.selectedPhotosListView.setEnabled(false);
                            PhotoViewer.this.isPhotosListViewVisible = false;
                            if (PhotoViewer.this.needCaptionLayout) {
                                PhotoViewer.this.captionTextViewSwitcher.setVisibility(4);
                            }
                            if (PhotoViewer.this.sendPhotoType == 0 || PhotoViewer.this.sendPhotoType == 4 || ((PhotoViewer.this.sendPhotoType == 2 || PhotoViewer.this.sendPhotoType == 5) && PhotoViewer.this.imagesArrLocals.size() > 1)) {
                                PhotoViewer.this.checkImageView.setVisibility(8);
                                PhotoViewer.this.photosCounterView.setVisibility(8);
                                PhotoViewer.this.updateActionBarTitlePadding();
                            }
                            Bitmap bitmap3 = PhotoViewer.this.centerImage.getBitmap();
                            if (PhotoViewer.this.sendPhotoType == 11) {
                                PhotoViewer photoViewer = PhotoViewer.this;
                                photoViewer.savedTy = photoViewer.translationY;
                                PhotoViewer photoViewer2 = PhotoViewer.this;
                                photoViewer2.savedTx = photoViewer2.translationX;
                                PhotoViewer photoViewer3 = PhotoViewer.this;
                                photoViewer3.savedScale = photoViewer3.scale;
                                PhotoViewer photoViewer4 = PhotoViewer.this;
                                photoViewer4.savedRotation = photoViewer4.rotate;
                                PhotoViewer.this.animateToRotate = BitmapDescriptorFactory.HUE_RED;
                            }
                            if (bitmap3 != null) {
                                float bitmapWidth2 = PhotoViewer.this.centerImage.getBitmapWidth();
                                float bitmapHeight2 = PhotoViewer.this.centerImage.getBitmapHeight();
                                float fMin5 = Math.min(PhotoViewer.this.getContainerViewWidth(2) / bitmapWidth2, PhotoViewer.this.getContainerViewHeight(2) / bitmapHeight2);
                                if (PhotoViewer.this.sendPhotoType == 1) {
                                    PhotoViewer.this.animateToY = -AndroidUtilities.dp(36.0f);
                                    fMin4 = PhotoViewer.this.getCropFillScale(false);
                                } else {
                                    PhotoViewer.this.animateToY = (-AndroidUtilities.dp(93.0f)) + (PhotoViewer.this.isStatusBarVisible() ? AndroidUtilities.statusBarHeight / 2 : 0);
                                    fMin4 = (PhotoViewer.this.editState.cropState == null || !(PhotoViewer.this.editState.cropState.transformRotation == 90 || PhotoViewer.this.editState.cropState.transformRotation == 270)) ? Math.min(PhotoViewer.this.getContainerViewWidth() / bitmapWidth2, PhotoViewer.this.getContainerViewHeight() / bitmapHeight2) : Math.min(PhotoViewer.this.getContainerViewWidth() / bitmapHeight2, PhotoViewer.this.getContainerViewHeight() / bitmapWidth2);
                                }
                                PhotoViewer.this.animateToScale = fMin5 / fMin4;
                                PhotoViewer.this.animateToX = (r2.getLeftInset() / 2) - (PhotoViewer.this.getRightInset() / 2);
                                PhotoViewer.this.animationStartTime = System.currentTimeMillis();
                                PhotoViewer.this.zoomAnimation = true;
                            }
                            PhotoViewer.this.imageMoveAnimation = new AnimatorSet();
                            PhotoViewer.this.imageMoveAnimation.playTogether(ObjectAnimator.ofFloat(PhotoViewer.this, (Property<PhotoViewer, Float>) AnimationProperties.PHOTO_VIEWER_ANIMATION_VALUE, BitmapDescriptorFactory.HUE_RED, 1.0f), ObjectAnimator.ofFloat(PhotoViewer.this.photoFilterView.getToolsView(), (Property<FrameLayout, Float>) View.TRANSLATION_Y, AndroidUtilities.dp(186.0f), BitmapDescriptorFactory.HUE_RED));
                            PhotoViewer.this.imageMoveAnimation.setDuration(200L);
                            PhotoViewer.this.imageMoveAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.61.1
                                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                                public void onAnimationEnd(Animator animator2) {
                                    PhotoViewer.this.photoFilterView.init();
                                    PhotoViewer.this.imageMoveAnimation = null;
                                    AnonymousClass61 anonymousClass61 = AnonymousClass61.this;
                                    PhotoViewer.this.currentEditMode = i;
                                    PhotoViewer.this.getCaptionView().keyboardNotifier.ignore(PhotoViewer.this.currentEditMode != 0);
                                    if (PhotoViewer.this.paintKeyboardNotifier != null) {
                                        PhotoViewer.this.paintKeyboardNotifier.ignore(PhotoViewer.this.currentEditMode != 3);
                                    }
                                    if (PhotoViewer.this.currentEditMode != 3) {
                                        PhotoViewer.this.translateY = BitmapDescriptorFactory.HUE_RED;
                                    }
                                    PhotoViewer.this.switchingToMode = -1;
                                    PhotoViewer photoViewer5 = PhotoViewer.this;
                                    photoViewer5.scale = photoViewer5.animateToScale = 1.0f;
                                    PhotoViewer.this.animateToX = BitmapDescriptorFactory.HUE_RED;
                                    PhotoViewer.this.animateToY = BitmapDescriptorFactory.HUE_RED;
                                    PhotoViewer photoViewer6 = PhotoViewer.this;
                                    photoViewer6.updateMinMax(photoViewer6.scale);
                                    PhotoViewer.this.padImageForHorizontalInsets = true;
                                    PhotoViewer.this.containerView.invalidate();
                                }

                                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                                public void onAnimationStart(Animator animator2) {
                                }
                            });
                            PhotoViewer.this.imageMoveAnimation.start();
                        }
                    };
                }
                arrayList3.add(objectAnimatorOfFloat4);
                if (this.selectedPhotosListView.getVisibility() == 0) {
                }
                if (this.muteButton.getTag() != null) {
                }
                if (this.editCoverButton.getTag() != null) {
                }
                arrayList3.add(ObjectAnimator.ofObject(this.navigationBar, "backgroundColor", new ArgbEvaluator(), Integer.valueOf(color), Integer.valueOf(i10)));
                this.changeModeAnimation.playTogether(arrayList3);
                this.changeModeAnimation.setDuration(200L);
                animatorSet = this.changeModeAnimation;
                animatorListenerAdapter = new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.61
                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationEnd(Animator animator) {
                        float fMin4;
                        PhotoViewer.this.changeModeAnimation = null;
                        PhotoViewer.this.pickerView.setVisibility(8);
                        PhotoViewer.this.pickerViewSendButton.setVisibility(8);
                        PhotoViewer.this.doneButtonFullWidth.setVisibility(8);
                        PhotoViewer.this.actionBar.setVisibility(8);
                        PhotoViewer.this.muteButton.setVisibility(8);
                        PhotoViewer.this.editCoverButton.setVisibility(8);
                        if (PhotoViewer.this.photoCropView != null) {
                            PhotoViewer.this.photoCropView.setVisibility(4);
                        }
                        PhotoViewer.this.selectedPhotosListView.setVisibility(8);
                        PhotoViewer.this.selectedPhotosListView.setAlpha(BitmapDescriptorFactory.HUE_RED);
                        PhotoViewer.this.selectedPhotosListView.setTranslationY(-AndroidUtilities.dp(10.0f));
                        PhotoViewer.this.photosCounterView.setRotationX(BitmapDescriptorFactory.HUE_RED);
                        PhotoViewer.this.selectedPhotosListView.setEnabled(false);
                        PhotoViewer.this.isPhotosListViewVisible = false;
                        if (PhotoViewer.this.needCaptionLayout) {
                            PhotoViewer.this.captionTextViewSwitcher.setVisibility(4);
                        }
                        if (PhotoViewer.this.sendPhotoType == 0 || PhotoViewer.this.sendPhotoType == 4 || ((PhotoViewer.this.sendPhotoType == 2 || PhotoViewer.this.sendPhotoType == 5) && PhotoViewer.this.imagesArrLocals.size() > 1)) {
                            PhotoViewer.this.checkImageView.setVisibility(8);
                            PhotoViewer.this.photosCounterView.setVisibility(8);
                            PhotoViewer.this.updateActionBarTitlePadding();
                        }
                        Bitmap bitmap3 = PhotoViewer.this.centerImage.getBitmap();
                        if (PhotoViewer.this.sendPhotoType == 11) {
                            PhotoViewer photoViewer = PhotoViewer.this;
                            photoViewer.savedTy = photoViewer.translationY;
                            PhotoViewer photoViewer2 = PhotoViewer.this;
                            photoViewer2.savedTx = photoViewer2.translationX;
                            PhotoViewer photoViewer3 = PhotoViewer.this;
                            photoViewer3.savedScale = photoViewer3.scale;
                            PhotoViewer photoViewer4 = PhotoViewer.this;
                            photoViewer4.savedRotation = photoViewer4.rotate;
                            PhotoViewer.this.animateToRotate = BitmapDescriptorFactory.HUE_RED;
                        }
                        if (bitmap3 != null) {
                            float bitmapWidth2 = PhotoViewer.this.centerImage.getBitmapWidth();
                            float bitmapHeight2 = PhotoViewer.this.centerImage.getBitmapHeight();
                            float fMin5 = Math.min(PhotoViewer.this.getContainerViewWidth(2) / bitmapWidth2, PhotoViewer.this.getContainerViewHeight(2) / bitmapHeight2);
                            if (PhotoViewer.this.sendPhotoType == 1) {
                                PhotoViewer.this.animateToY = -AndroidUtilities.dp(36.0f);
                                fMin4 = PhotoViewer.this.getCropFillScale(false);
                            } else {
                                PhotoViewer.this.animateToY = (-AndroidUtilities.dp(93.0f)) + (PhotoViewer.this.isStatusBarVisible() ? AndroidUtilities.statusBarHeight / 2 : 0);
                                fMin4 = (PhotoViewer.this.editState.cropState == null || !(PhotoViewer.this.editState.cropState.transformRotation == 90 || PhotoViewer.this.editState.cropState.transformRotation == 270)) ? Math.min(PhotoViewer.this.getContainerViewWidth() / bitmapWidth2, PhotoViewer.this.getContainerViewHeight() / bitmapHeight2) : Math.min(PhotoViewer.this.getContainerViewWidth() / bitmapHeight2, PhotoViewer.this.getContainerViewHeight() / bitmapWidth2);
                            }
                            PhotoViewer.this.animateToScale = fMin5 / fMin4;
                            PhotoViewer.this.animateToX = (r2.getLeftInset() / 2) - (PhotoViewer.this.getRightInset() / 2);
                            PhotoViewer.this.animationStartTime = System.currentTimeMillis();
                            PhotoViewer.this.zoomAnimation = true;
                        }
                        PhotoViewer.this.imageMoveAnimation = new AnimatorSet();
                        PhotoViewer.this.imageMoveAnimation.playTogether(ObjectAnimator.ofFloat(PhotoViewer.this, (Property<PhotoViewer, Float>) AnimationProperties.PHOTO_VIEWER_ANIMATION_VALUE, BitmapDescriptorFactory.HUE_RED, 1.0f), ObjectAnimator.ofFloat(PhotoViewer.this.photoFilterView.getToolsView(), (Property<FrameLayout, Float>) View.TRANSLATION_Y, AndroidUtilities.dp(186.0f), BitmapDescriptorFactory.HUE_RED));
                        PhotoViewer.this.imageMoveAnimation.setDuration(200L);
                        PhotoViewer.this.imageMoveAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.61.1
                            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                            public void onAnimationEnd(Animator animator2) {
                                PhotoViewer.this.photoFilterView.init();
                                PhotoViewer.this.imageMoveAnimation = null;
                                AnonymousClass61 anonymousClass61 = AnonymousClass61.this;
                                PhotoViewer.this.currentEditMode = i;
                                PhotoViewer.this.getCaptionView().keyboardNotifier.ignore(PhotoViewer.this.currentEditMode != 0);
                                if (PhotoViewer.this.paintKeyboardNotifier != null) {
                                    PhotoViewer.this.paintKeyboardNotifier.ignore(PhotoViewer.this.currentEditMode != 3);
                                }
                                if (PhotoViewer.this.currentEditMode != 3) {
                                    PhotoViewer.this.translateY = BitmapDescriptorFactory.HUE_RED;
                                }
                                PhotoViewer.this.switchingToMode = -1;
                                PhotoViewer photoViewer5 = PhotoViewer.this;
                                photoViewer5.scale = photoViewer5.animateToScale = 1.0f;
                                PhotoViewer.this.animateToX = BitmapDescriptorFactory.HUE_RED;
                                PhotoViewer.this.animateToY = BitmapDescriptorFactory.HUE_RED;
                                PhotoViewer photoViewer6 = PhotoViewer.this;
                                photoViewer6.updateMinMax(photoViewer6.scale);
                                PhotoViewer.this.padImageForHorizontalInsets = true;
                                PhotoViewer.this.containerView.invalidate();
                            }

                            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                            public void onAnimationStart(Animator animator2) {
                            }
                        });
                        PhotoViewer.this.imageMoveAnimation.start();
                    }
                };
            } else if (i == 3) {
                startVideoPlayer();
                createPaintView();
                this.changeModeAnimation = new AnimatorSet();
                ArrayList arrayList4 = new ArrayList();
                FrameLayout frameLayout6 = this.pickerView;
                Property property7 = View.TRANSLATION_Y;
                arrayList4.add(ObjectAnimator.ofFloat(frameLayout6, (Property<FrameLayout, Float>) property7, frameLayout6.getHeight() + this.captionEdit.getEditTextHeight() + (this.isCurrentVideo ? AndroidUtilities.dp(58.0f) : 0)));
                FrameLayout frameLayout7 = this.pickerView;
                Property property8 = View.ALPHA;
                arrayList4.add(ObjectAnimator.ofFloat(frameLayout7, (Property<FrameLayout, Float>) property8, BitmapDescriptorFactory.HUE_RED));
                StickerMakerView stickerMakerView3 = this.stickerMakerView;
                if (stickerMakerView3 != null) {
                    arrayList4.add(ObjectAnimator.ofFloat(stickerMakerView3, (Property<StickerMakerView, Float>) property8, this.stickerEmpty ? 1.0f : BitmapDescriptorFactory.HUE_RED));
                }
                StickerMakerBackgroundView stickerMakerBackgroundView3 = this.stickerMakerBackgroundView;
                if (stickerMakerBackgroundView3 != null) {
                    arrayList4.add(ObjectAnimator.ofFloat(stickerMakerBackgroundView3, (Property<StickerMakerBackgroundView, Float>) property8, this.stickerEmpty ? 1.0f : BitmapDescriptorFactory.HUE_RED));
                }
                arrayList4.add(ObjectAnimator.ofFloat(this.pickerViewSendButton, (Property<ChatActivityEnterView.SendButton, Float>) property7, AndroidUtilities.dp(this.isCurrentVideo ? 154.0f : 96.0f)));
                arrayList4.add(ObjectAnimator.ofFloat(this.actionBar, (Property<ActionBar, Float>) property7, -r2.getHeight()));
                arrayList4.add(ObjectAnimator.ofObject(this.navigationBar, "backgroundColor", new ArgbEvaluator(), Integer.valueOf(color), Integer.valueOf(i10)));
                if (this.needCaptionLayout) {
                    arrayList4.add(ObjectAnimator.ofFloat(this.captionTextViewSwitcher, (Property<CaptionTextViewSwitcher, Float>) property7, AndroidUtilities.dp(this.isCurrentVideo ? 154.0f : 96.0f)));
                }
                int i25 = this.sendPhotoType;
                if (i25 == 0 || i25 == 4) {
                    i4 = 2;
                    arrayList4.add(ObjectAnimator.ofFloat(this.checkImageView, (Property<CheckBox, Float>) property8, 1.0f, BitmapDescriptorFactory.HUE_RED));
                    objectAnimatorOfFloat3 = ObjectAnimator.ofFloat(this.photosCounterView, (Property<CounterView, Float>) property8, 1.0f, BitmapDescriptorFactory.HUE_RED);
                } else if (i25 == 1) {
                    i4 = 2;
                    objectAnimatorOfFloat3 = ObjectAnimator.ofFloat(this.photoCropView, (Property<PhotoCropView, Float>) property8, 1.0f, BitmapDescriptorFactory.HUE_RED);
                } else {
                    i4 = 2;
                    if (this.selectedPhotosListView.getVisibility() == 0) {
                        float[] fArr4 = new float[i4];
                        // fill-array-data instruction
                        fArr4[0] = 1.0f;
                        fArr4[1] = 0.0f;
                        arrayList4.add(ObjectAnimator.ofFloat(this.selectedPhotosListView, (Property<SelectedPhotosListView, Float>) property8, fArr4));
                    }
                    if (this.muteButton.getTag() != null) {
                        float[] fArr5 = new float[i4];
                        // fill-array-data instruction
                        fArr5[0] = 1.0f;
                        fArr5[1] = 0.0f;
                        arrayList4.add(ObjectAnimator.ofFloat(this.muteButton, (Property<ImageView, Float>) property8, fArr5));
                    }
                    if (this.editCoverButton.getTag() != null) {
                        float[] fArr6 = new float[i4];
                        // fill-array-data instruction
                        fArr6[0] = 1.0f;
                        fArr6[1] = 0.0f;
                        arrayList4.add(ObjectAnimator.ofFloat(this.editCoverButton, (Property<EditCoverButton, Float>) property8, fArr6));
                    }
                    this.changeModeAnimation.playTogether(arrayList4);
                    this.changeModeAnimation.setDuration(200L);
                    this.changeModeAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.62
                        @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                        public void onAnimationEnd(Animator animator) {
                            PhotoViewer.this.switchToPaintMode();
                        }
                    });
                    animatorSet2 = this.changeModeAnimation;
                }
                arrayList4.add(objectAnimatorOfFloat3);
                if (this.selectedPhotosListView.getVisibility() == 0) {
                }
                if (this.muteButton.getTag() != null) {
                }
                if (this.editCoverButton.getTag() != null) {
                }
                this.changeModeAnimation.playTogether(arrayList4);
                this.changeModeAnimation.setDuration(200L);
                this.changeModeAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.62
                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationEnd(Animator animator) {
                        PhotoViewer.this.switchToPaintMode();
                    }
                });
                animatorSet2 = this.changeModeAnimation;
            } else if (i == 4) {
                createMaskPaintView();
                this.changeModeAnimation = new AnimatorSet();
                ArrayList arrayList5 = new ArrayList();
                FrameLayout frameLayout8 = this.pickerView;
                Property property9 = View.TRANSLATION_Y;
                arrayList5.add(ObjectAnimator.ofFloat(frameLayout8, (Property<FrameLayout, Float>) property9, frameLayout8.getHeight() + this.captionEdit.getEditTextHeight() + (this.isCurrentVideo ? AndroidUtilities.dp(58.0f) : 0)));
                FrameLayout frameLayout9 = this.pickerView;
                Property property10 = View.ALPHA;
                arrayList5.add(ObjectAnimator.ofFloat(frameLayout9, (Property<FrameLayout, Float>) property10, BitmapDescriptorFactory.HUE_RED));
                StickerMakerView stickerMakerView4 = this.stickerMakerView;
                if (stickerMakerView4 != null) {
                    arrayList5.add(ObjectAnimator.ofFloat(stickerMakerView4, (Property<StickerMakerView, Float>) property10, 1.0f));
                }
                StickerMakerBackgroundView stickerMakerBackgroundView4 = this.stickerMakerBackgroundView;
                if (stickerMakerBackgroundView4 != null) {
                    arrayList5.add(ObjectAnimator.ofFloat(stickerMakerBackgroundView4, (Property<StickerMakerBackgroundView, Float>) property10, 1.0f));
                }
                arrayList5.add(ObjectAnimator.ofFloat(this.pickerViewSendButton, (Property<ChatActivityEnterView.SendButton, Float>) property9, AndroidUtilities.dp(this.isCurrentVideo ? 154.0f : 96.0f)));
                arrayList5.add(ObjectAnimator.ofFloat(this.actionBar, (Property<ActionBar, Float>) property9, -r3.getHeight()));
                arrayList5.add(ObjectAnimator.ofObject(this.navigationBar, "backgroundColor", new ArgbEvaluator(), Integer.valueOf(color), Integer.valueOf(i10)));
                if (this.needCaptionLayout) {
                    arrayList5.add(ObjectAnimator.ofFloat(this.captionTextViewSwitcher, (Property<CaptionTextViewSwitcher, Float>) property9, AndroidUtilities.dp(this.isCurrentVideo ? 154.0f : 96.0f)));
                }
                int i26 = this.sendPhotoType;
                if (i26 == 0 || i26 == 4) {
                    i3 = 2;
                    arrayList5.add(ObjectAnimator.ofFloat(this.checkImageView, (Property<CheckBox, Float>) property10, 1.0f, BitmapDescriptorFactory.HUE_RED));
                    objectAnimatorOfFloat2 = ObjectAnimator.ofFloat(this.photosCounterView, (Property<CounterView, Float>) property10, 1.0f, BitmapDescriptorFactory.HUE_RED);
                } else if (i26 == 1) {
                    i3 = 2;
                    objectAnimatorOfFloat2 = ObjectAnimator.ofFloat(this.photoCropView, (Property<PhotoCropView, Float>) property10, 1.0f, BitmapDescriptorFactory.HUE_RED);
                } else {
                    i3 = 2;
                    if (this.selectedPhotosListView.getVisibility() == 0) {
                        float[] fArr7 = new float[i3];
                        // fill-array-data instruction
                        fArr7[0] = 1.0f;
                        fArr7[1] = 0.0f;
                        arrayList5.add(ObjectAnimator.ofFloat(this.selectedPhotosListView, (Property<SelectedPhotosListView, Float>) property10, fArr7));
                    }
                    if (this.muteButton.getTag() != null) {
                        float[] fArr8 = new float[i3];
                        // fill-array-data instruction
                        fArr8[0] = 1.0f;
                        fArr8[1] = 0.0f;
                        arrayList5.add(ObjectAnimator.ofFloat(this.muteButton, (Property<ImageView, Float>) property10, fArr8));
                    }
                    if (this.editCoverButton.getTag() != null) {
                        float[] fArr9 = new float[i3];
                        // fill-array-data instruction
                        fArr9[0] = 1.0f;
                        fArr9[1] = 0.0f;
                        arrayList5.add(ObjectAnimator.ofFloat(this.editCoverButton, (Property<EditCoverButton, Float>) property10, fArr9));
                    }
                    this.changeModeAnimation.playTogether(arrayList5);
                    this.changeModeAnimation.setDuration(200L);
                    animatorSet = this.changeModeAnimation;
                    animatorListenerAdapter = new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.63
                        @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                        public void onAnimationEnd(Animator animator) {
                            PhotoViewer.this.maskPaintView.init();
                            PhotoViewer.this.currentEditMode = i;
                            PhotoViewer.this.changeModeAnimation = null;
                            PhotoViewer.this.switchingToMode = -1;
                        }
                    };
                }
                arrayList5.add(objectAnimatorOfFloat2);
                if (this.selectedPhotosListView.getVisibility() == 0) {
                }
                if (this.muteButton.getTag() != null) {
                }
                if (this.editCoverButton.getTag() != null) {
                }
                this.changeModeAnimation.playTogether(arrayList5);
                this.changeModeAnimation.setDuration(200L);
                animatorSet = this.changeModeAnimation;
                animatorListenerAdapter = new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.63
                    @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                    public void onAnimationEnd(Animator animator) {
                        PhotoViewer.this.maskPaintView.init();
                        PhotoViewer.this.currentEditMode = i;
                        PhotoViewer.this.changeModeAnimation = null;
                        PhotoViewer.this.switchingToMode = -1;
                    }
                };
            } else {
                if (i == 5) {
                    if (this.coverEditor.button.isLoading() || (i2 = this.currentIndex) < 0 || i2 >= this.imagesArrLocals.size() || !(this.imagesArrLocals.get(this.currentIndex) instanceof MediaController.PhotoEntry)) {
                        return;
                    }
                    MediaController.PhotoEntry photoEntry = (MediaController.PhotoEntry) this.imagesArrLocals.get(this.currentIndex);
                    this.changeModeAnimation = new AnimatorSet();
                    ArrayList arrayList6 = new ArrayList();
                    FrameLayout frameLayout10 = this.pickerView;
                    Property property11 = View.TRANSLATION_Y;
                    arrayList6.add(ObjectAnimator.ofFloat(frameLayout10, (Property<FrameLayout, Float>) property11, frameLayout10.getHeight() + this.captionEdit.getEditTextHeight() + (this.isCurrentVideo ? AndroidUtilities.dp(58.0f) : 0)));
                    FrameLayout frameLayout11 = this.pickerView;
                    Property property12 = View.ALPHA;
                    arrayList6.add(ObjectAnimator.ofFloat(frameLayout11, (Property<FrameLayout, Float>) property12, BitmapDescriptorFactory.HUE_RED));
                    arrayList6.add(ObjectAnimator.ofFloat(this.pickerViewSendButton, (Property<ChatActivityEnterView.SendButton, Float>) property11, AndroidUtilities.dp(this.isCurrentVideo ? 154.0f : 96.0f)));
                    arrayList6.add(ObjectAnimator.ofFloat(this.actionBar, (Property<ActionBar, Float>) property11, -r3.getHeight()));
                    arrayList6.add(ObjectAnimator.ofObject(this.navigationBar, "backgroundColor", new ArgbEvaluator(), Integer.valueOf(color), Integer.valueOf(i10)));
                    int i27 = this.sendPhotoType;
                    if (i27 == 0 || i27 == 4) {
                        arrayList6.add(ObjectAnimator.ofFloat(this.checkImageView, (Property<CheckBox, Float>) property12, 1.0f, BitmapDescriptorFactory.HUE_RED));
                        objectAnimatorOfFloat = ObjectAnimator.ofFloat(this.photosCounterView, (Property<CounterView, Float>) property12, 1.0f, BitmapDescriptorFactory.HUE_RED);
                    } else {
                        if (i27 == 1) {
                            objectAnimatorOfFloat = ObjectAnimator.ofFloat(this.photoCropView, (Property<PhotoCropView, Float>) property12, 1.0f, BitmapDescriptorFactory.HUE_RED);
                        }
                        if (this.selectedPhotosListView.getVisibility() == 0) {
                            arrayList6.add(ObjectAnimator.ofFloat(this.selectedPhotosListView, (Property<SelectedPhotosListView, Float>) property12, 1.0f, BitmapDescriptorFactory.HUE_RED));
                        }
                        if (this.muteButton.getTag() != null) {
                            arrayList6.add(ObjectAnimator.ofFloat(this.muteButton, (Property<ImageView, Float>) property12, 1.0f, BitmapDescriptorFactory.HUE_RED));
                        }
                        if (this.editCoverButton.getTag() != null) {
                            arrayList6.add(ObjectAnimator.ofFloat(this.editCoverButton, (Property<EditCoverButton, Float>) property12, 1.0f, BitmapDescriptorFactory.HUE_RED));
                        }
                        this.coverEditor.setVisibility(0);
                        arrayList6.add(ObjectAnimator.ofFloat(this.coverEditor, (Property<PhotoViewerCoverEditor, Float>) property12, BitmapDescriptorFactory.HUE_RED, 1.0f));
                        this.changeModeAnimation.playTogether(arrayList6);
                        this.changeModeAnimation.setDuration(200L);
                        this.changeModeAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.64
                            @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                            public void onAnimationEnd(Animator animator) {
                                PhotoViewer.this.currentEditMode = i;
                                PhotoViewer.this.changeModeAnimation = null;
                                PhotoViewer.this.switchingToMode = -1;
                            }
                        });
                        this.changeModeAnimation.start();
                        pauseVideoOrWeb();
                        this.coverEditor.set(photoEntry, this.videoPlayer, this.resourcesProvider);
                    }
                    arrayList6.add(objectAnimatorOfFloat);
                    if (this.selectedPhotosListView.getVisibility() == 0) {
                    }
                    if (this.muteButton.getTag() != null) {
                    }
                    if (this.editCoverButton.getTag() != null) {
                    }
                    this.coverEditor.setVisibility(0);
                    arrayList6.add(ObjectAnimator.ofFloat(this.coverEditor, (Property<PhotoViewerCoverEditor, Float>) property12, BitmapDescriptorFactory.HUE_RED, 1.0f));
                    this.changeModeAnimation.playTogether(arrayList6);
                    this.changeModeAnimation.setDuration(200L);
                    this.changeModeAnimation.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.PhotoViewer.64
                        @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                        public void onAnimationEnd(Animator animator) {
                            PhotoViewer.this.currentEditMode = i;
                            PhotoViewer.this.changeModeAnimation = null;
                            PhotoViewer.this.switchingToMode = -1;
                        }
                    });
                    this.changeModeAnimation.start();
                    pauseVideoOrWeb();
                    this.coverEditor.set(photoEntry, this.videoPlayer, this.resourcesProvider);
                }
                frameLayoutDrawer = this.containerView;
                if (frameLayoutDrawer == null) {
                }
            }
            animatorSet.addListener(animatorListenerAdapter);
            animatorSet2 = this.changeModeAnimation;
        }
        animatorSet2.start();
        frameLayoutDrawer = this.containerView;
        if (frameLayoutDrawer == null) {
        }
    }

    public void syncCastedPlayer() {
        if (isVisible()) {
            this.ignorePlayerUpdate = true;
            VideoPlayer videoPlayer = this.videoPlayer;
            if (videoPlayer != null) {
                videoPlayer.setMute(CastSync.isActive() || this.muteVideo);
            }
            if (this.videoPlayer != null && CastSync.isActive() && !CastSync.isUpdatePending()) {
                long position = CastSync.getPosition();
                if (position >= 0 && Math.abs(this.videoPlayer.getCurrentPosition() - position) > 1000) {
                    this.videoPlayer.seekTo(position);
                }
                if (CastSync.isPlaying()) {
                    this.videoPlayer.play();
                } else {
                    this.videoPlayer.pause();
                }
                if (this.activityContext != null && Math.abs(CastSync.getDeviceVolume() - CastSync.getVolume()) > 0.05f) {
                    AudioManager audioManager = (AudioManager) this.activityContext.getSystemService(MediaStreamTrack.AUDIO_TRACK_KIND);
                    int streamMaxVolume = audioManager.getStreamMaxVolume(3);
                    int streamMinVolume = (Build.VERSION.SDK_INT >= 28 ? audioManager.getStreamMinVolume(3) : 0) + ((int) ((streamMaxVolume - r5) * CastSync.getVolume()));
                    if (streamMinVolume != audioManager.getStreamVolume(3)) {
                        audioManager.setStreamVolume(3, streamMinVolume, 1);
                    }
                }
                chooseSpeed(CastSync.getSpeed(), true, false);
            }
            ChooseQualityLayout$QualityIcon chooseQualityLayout$QualityIcon = this.videoItemIcon;
            if (chooseQualityLayout$QualityIcon != null) {
                chooseQualityLayout$QualityIcon.setCasting(CastSync.isActive(), true);
            }
            this.ignorePlayerUpdate = false;
        }
    }

    public void updateColors() {
        int i = Theme.key_chat_editMediaButton;
        int themedColor = getThemedColor(i);
        ChatActivityEnterView.SendButton sendButton = this.pickerViewSendButton;
        if (sendButton != null) {
            sendButton.updateColors();
            this.pickerViewSendButton.invalidate();
        }
        CheckBox checkBox = this.checkImageView;
        if (checkBox != null) {
            checkBox.setColor(getThemedColor(i), -1);
        }
        PorterDuffColorFilter porterDuffColorFilter = new PorterDuffColorFilter(themedColor, PorterDuff.Mode.MULTIPLY);
        ImageView imageView = this.paintItem;
        if (imageView != null && imageView.getColorFilter() != null) {
            this.paintItem.setColorFilter(porterDuffColorFilter);
        }
        ImageView imageView2 = this.cropItem;
        if (imageView2 != null && imageView2.getColorFilter() != null) {
            this.cropItem.setColorFilter(porterDuffColorFilter);
        }
        ImageView imageView3 = this.tuneItem;
        if (imageView3 != null && imageView3.getColorFilter() != null) {
            this.tuneItem.setColorFilter(porterDuffColorFilter);
        }
        ImageView imageView4 = this.rotateItem;
        if (imageView4 != null && imageView4.getColorFilter() != null) {
            this.rotateItem.setColorFilter(porterDuffColorFilter);
        }
        ImageView imageView5 = this.mirrorItem;
        if (imageView5 != null && imageView5.getColorFilter() != null) {
            this.mirrorItem.setColorFilter(porterDuffColorFilter);
        }
        PickerBottomLayoutViewer pickerBottomLayoutViewer = this.editorDoneLayout;
        if (pickerBottomLayoutViewer != null) {
            pickerBottomLayoutViewer.doneButton.setTextColor(themedColor);
        }
        PickerBottomLayoutViewer pickerBottomLayoutViewer2 = this.qualityPicker;
        if (pickerBottomLayoutViewer2 != null) {
            pickerBottomLayoutViewer2.doneButton.setTextColor(themedColor);
        }
        LPhotoPaintView lPhotoPaintView = this.photoPaintView;
        if (lPhotoPaintView != null) {
            lPhotoPaintView.updateColors();
        }
        PhotoFilterView photoFilterView = this.photoFilterView;
        if (photoFilterView != null) {
            photoFilterView.updateColors();
        }
        CaptionPhotoViewer captionPhotoViewer = this.captionEdit;
        if (captionPhotoViewer != null) {
            captionPhotoViewer.updateColors(this.resourcesProvider);
        }
        CaptionPhotoViewer captionPhotoViewer2 = this.topCaptionEdit;
        if (captionPhotoViewer2 != null) {
            captionPhotoViewer2.updateColors(this.resourcesProvider);
        }
        VideoTimelinePlayView videoTimelinePlayView = this.videoTimelineView;
        if (videoTimelinePlayView != null) {
            videoTimelinePlayView.invalidate();
        }
        SelectedPhotosListView selectedPhotosListView = this.selectedPhotosListView;
        if (selectedPhotosListView != null) {
            int childCount = selectedPhotosListView.getChildCount();
            for (int i2 = 0; i2 < childCount; i2++) {
                View childAt = this.selectedPhotosListView.getChildAt(i2);
                if (childAt instanceof PhotoPickerPhotoCell) {
                    ((PhotoPickerPhotoCell) childAt).updateColors();
                }
            }
        }
        StickersAlert stickersAlert = this.masksAlert;
        if (stickersAlert != null) {
            stickersAlert.updateColors(true);
        }
    }

    public void updateMuteButton() {
        VideoPlayer videoPlayer = this.videoPlayer;
        if (videoPlayer != null) {
            videoPlayer.setMute(CastSync.isActive() || this.muteVideo);
        }
        if (this.videoConvertSupported) {
            this.muteButton.setEnabled(true);
            this.muteButton.setClickable(true);
            this.muteButton.animate().alpha(1.0f).setDuration(180L).start();
            if (this.muteVideo) {
                if (this.customTitle == null) {
                    this.actionBarContainer.setSubtitle(LocaleController.getString("SoundMuted", R.string.SoundMuted));
                }
                this.muteDrawable.setMuted(true, true);
                if (this.compressItem.getTag() != null) {
                    this.compressItem.setAlpha(0.5f);
                    this.compressItem.setEnabled(false);
                }
                if (this.sendPhotoType == 1) {
                    this.videoTimelineView.setMaxProgressDiff(9600.0f / this.videoDuration);
                    this.videoTimelineView.setMode(1);
                    updateVideoInfo();
                    return;
                }
            } else {
                this.actionBarContainer.setSubtitle(this.currentSubtitle);
                this.muteDrawable.setMuted(false, true);
                if (this.compressItem.getTag() != null) {
                    this.compressItem.setAlpha(1.0f);
                    this.compressItem.setEnabled(true);
                }
            }
            this.videoTimelineView.setMaxProgressDiff(1.0f);
        } else {
            this.muteButton.setEnabled(false);
            this.muteButton.setClickable(false);
            this.muteButton.animate().alpha(0.5f).setDuration(180L).start();
        }
        this.videoTimelineView.setMode(0);
    }

    public void updateWebPlayerState(boolean z, int i) {
        updatePlayerState(z, i);
    }

    public void zoomOut() {
        animateTo(1.0f, BitmapDescriptorFactory.HUE_RED, BitmapDescriptorFactory.HUE_RED, false);
    }
}
